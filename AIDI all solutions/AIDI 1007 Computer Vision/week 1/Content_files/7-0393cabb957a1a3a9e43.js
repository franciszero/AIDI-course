(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{"/z4E":function(e,t,o){"use strict";o.d(t,"a",(function(){return h}));var n=o("Llzl"),i=o("Oyr+"),r=o("0JpG"),a=o("Vsv2"),s=o("zXZW"),d=o("pjml"),l=o("12mu"),c=o("lEL+"),p=o("DMV0"),u=o("ol3u");const h="ultra.directives.bbCloudStorageIntegration";class g{constructor(e,t,o,n,i,r,a,s){this.scope=e,this.$q=t,this.$exceptionHandler=o,this.bbLocalize=n,this.$modal=i,this.CloudDriveModel=r,this.CloudDriveTaskModel=a,this.timeout=s,this.bbLocalize.loadBundle("components/directives/cloudStorageIntegration")}getFileId(e){return e.account+"|"+e.id}onFileSelect(e){this.scope.$emit(i.d,e,this.scope.primaryKey&&this.scope.primaryKey()),this.scope.onFilesSelected&&this.scope.onFilesSelected(e)}getDownloadFileInfo(e){const t=this.getFileId(e);return this.CloudDriveModel.$new("CloudStorageIntegration").contents.$new(t).$fetch({accessToken:this.accessToken}).$asPromise()}downloadFiles(e,t,o,n){const r={accessToken:this.accessToken,expand:"mimeType,isMedia"};this.scope.fileLocation&&(r.fileLocation=this.scope.fileLocation),this.scope.webLocation&&(r.webLocation=this.scope.webLocation),(o?this.CloudDriveTaskModel.$new(n||e.id):this.CloudDriveModel.$new("CloudStorageIntegration").contents.$new(n||e.id).download).$fetch(r).$then((o=>{if("COMPLETE"===o.status){const n=this.scope.$on(i.e,((r,a,s)=>{s!==i.c.UploadProgressComplete||e.ui.fileId&&a!==e.ui.fileId||(this.attachHandler(o,e,t),n())}))}else this.timeout((()=>{this.downloadFiles(e,t,!0,o.taskId)}),this.scope,2e3);(o.completePercentage<100||"COMPLETE"===o.status)&&this.scope.$root.$broadcast(i.e,e.ui.index,o.completePercentage,null,i.c.UpdateProgress,e.inProgressFileId,e.ui.targetDiv,e.ui.fileId)}),(t=>{this.displayUploadError(),this.scope.$root.$broadcast(i.e,e.ui.fileId,e,i.c.Error,e.ui.targetDiv,this.scope.primaryKey&&this.scope.primaryKey()),this.$exceptionHandler(t,"source")}))}attachHandler(e,t,o){const n=this.$q.defer(),i={fileName:null,fileLocation:null};return e&&(i.fileName=e.fileName,i.fileLocation=e.fileLocation,i.webLocation=e.webLocation,i.mimeType=e.mimeType,i.isMedia=e.isMedia),this.scope.attachHandler(i,t,this.scope.isUploadMultipleFiles,void 0,o).then((e=>{n.resolve(e)}),(e=>{n.reject(e)})),n.promise}displayUploadError(){this.$modal.open({template:p,scope:this.scope})}}g.$inject=["scope","$q","$exceptionHandler",r.serviceName,l.b,d.h.serviceName,d.i.serviceName,c.b];class m{constructor(e,t,o,i,r){this.$injector=e,this.$q=t,this.$modal=o,this.CloudDriveService=i,this.bbLocalize=r,this.scope={attachHandler:"=",isFlatten:"=?",primaryKey:"&?",primaryKeyValue:"@?",fileLocation:"@?",webLocation:"@?",disableClick:"&?",allowMultiple:"=?",onFilesSelected:"=?",onCancelFocus:"=?"},this.restrict="A",this.link=(e,t,o)=>{const i=this;e.cloudStorageIntegration=this.$injector.instantiate(g,{scope:e}),e.folderBranchCounts=0,e.isInitialized=!!i.CloudDriveService.cloudDriveStorage,e.isInitialized||i.CloudDriveService.initializeCloudDrive();const r=function(t){const o=[];if(t&&t.length>0){for(let n=0;n<t.length;n++)o.push(e.cloudStorageIntegration.getDownloadFileInfo(t[n]));i.$q.all(o).then((t=>{i.CloudDriveService.isGettingFilesInfo=!1,e.cloudStorageIntegration.onFileSelect(t),t.length>1&&(e.isUploadMultipleFiles=!0)}),(()=>{i.CloudDriveService.isGettingFilesInfo=!1}))}};t.on("click",(()=>{if((!e.disableClick||!e.disableClick())&&e.isInitialized){const o=this.bbLocalize.getLocale(e);i.CloudDriveService.cloudDriveStorage.openFilePicker(o,e.allowMultiple).then((o=>{if((o||[]).length>0){if(!o[0]||!o[0].bearer_token||!o[0].bearer_token.key)return void this.$modal.open({template:u,scope:e});e.cloudStorageIntegration.accessToken=o[0].bearer_token.key,i.CloudDriveService.isGettingFilesInfo=!0,n.isDefined(e.allowMultiple)&&!1===e.allowMultiple&&o.length>1?r([o[0]]):r(o)}else e.onCancelFocus?e.onCancelFocus():t.focus()})),e.$on("$destroy",(()=>{i.CloudDriveService.isGettingFilesInfo=!1,t.off("click")}))}})),e.$on("downloadFile",((t,o,n)=>{o.ui.primaryKey===(e.primaryKey&&e.primaryKey())&&o.file.$url().indexOf("CloudStorageIntegration")>=0&&e.cloudStorageIntegration.downloadFiles(o,n)}))}}}m.$inject=["$injector","$q","$modal",a.b,r.serviceName],n.module(h,[r.moduleName,a.a,s.a,l.a,c.a]).directive("bbCloudStorageIntegration",["$injector",e=>e.instantiate(m)])},"07HN":function(e,t){e.exports='<div tabindex="-1" id="{{::addContentButton.getButtonWrapperId()}}">\n  <button\n    aria-expanded="{{addContentButton.isMenuVisible}}"\n    aria-label="{{addContentButton.addButtonAriaLabel}}"\n    ng-class="{hide: !(addContentButton.isButtonVisible || addContentButton.alwaysShow || addContentButton.isMenuVisible)}"\n    ng-focus="addContentButton.showButton()"\n    ng-blur="addContentButton.hideButton()"\n    class="button-add-content"\n    id="{{::addContentButton.getTargetId()}}"\n    ng-click="addContentButton.toggleAddContentMenu()"\n    analytics-id="components.directives.add-content-button.grades.button"\n  >\n  </button>\n</div>\n<bb-ui-contextual-menu\n  items="addContentButton.items"\n  target-id="::addContentButton.getTargetId()"\n  show="addContentButton.isMenuVisible"\n  directional-hint="::addContentButton.getDirectionalHint()"\n  dismiss="addContentButton.hideAddContentMenu"\n  analytics-id="components.directives.add-content-button.contextualMenu"\n>\n</bb-ui-contextual-menu>'},"0lMW":function(e,t,o){},"1Niw":function(e,t){e.exports='<div tabindex="-1" id="{{::addContentButton.getButtonWrapperId()}}">\n  <button\n    class="button-add-content js-show-add-options"\n    aria-expanded="{{addContentButton.isMenuVisible}}"\n    ng-class="{hide: !(addContentButton.isButtonVisible || addContentButton.alwaysShow || addContentButton.isMenuVisible)}"\n    aria-label="{{addContentButton.addButtonAriaLabel}}"\n    ng-focus="addContentButton.showButton()"\n    ng-blur="addContentButton.hideButton()"\n    id="{{::addContentButton.getTargetId()}}"\n    ng-click="addContentButton.toggleAddContentMenu()"\n    analytics-id="components.directives.add-content-button.editor.button">\n  </button>\n</div>\n<bb-ui-contextual-menu\n  items="::addContentButton.items"\n  target-id="::addContentButton.getTargetId()"\n  show="addContentButton.isMenuVisible"\n  directional-hint="::addContentButton.getDirectionalHint()"\n  dismiss="addContentButton.hideAddContentMenu"\n  analytics-id="components.directives.add-content-button.contextualMenu"\n>\n</bb-ui-contextual-menu>\n\x3c!--\n  The elements are kept around to trigger download actions.\n  The \'ng-hide\' class is added to prevent the buttons from interfering with AX (tab order, screen readers)\n--\x3e\n<ul class="element-list-add-menu angular-animate ng-hide">\n  <li>\n    <button type="button"\n            class="js-add-text-block"\n            ng-click="addContentButton.addTextBlock()"\n            analytics-id="components.directives.add-content-button.editor.addText.button">\n      <div>\n        <i class="icon-doc-pencil-2"></i>\n        <span bb-translate>components.directives.add-content-button.addContent</span>\n      </div>\n    </button>\n  </li>\n  <li ng-if="addContentButton.canEditUnsafeHtml">\n    <button type="button"\n            ng-click="addContentButton.addHtmlBlock()"\n            analytics-id="components.directives.add-content-button.editor.addHtml.button">\n      <div>\n        <bb-svg-icon size="small" icon="code"></bb-svg-icon>\n        <span bb-translate>components.directives.add-content-button.addHtml</span>\n      </div>\n    </button>\n  </li>\n  <li>\n    <bb-file-upload\n      url="/v1/files"\n      data="{}"\n      monitor-leave="true"\n      allow-multiple="true"\n      hide-transclude-during-upload="false"\n      primary-key="primaryKey && primaryKey() ? primaryKey() : fileListViewLocalId"\n      skip-zip-file-check="true"\n      click-enabled="true"\n      disable-drag="false"\n      class="js-file-upload"\n      web-location="{{webLocation}}"\n      file-location="{{fileLocation}}"\n      target-div="{{\'#\' + fileListViewId}}"\n      disallow-folder-uploads="true"\n      is-third-party-upload="false"\n      ignored-states="::ignoredStates()">\n        <button\n          type="button"\n          class="file-upload-button"\n          ng-click="addContentButton.assignPosition()"\n          aria-label="{{addContentButton.uploadAriaLabel}}"\n          analytics-id="components.directives.add-content-button.editor.fileUpload.button">\n          <div ng-if="!addContentButton.isMobile">\n            <i class="icon-arrow-upload"></i>\n            <span bb-translate>components.directives.add-content-button.uploadFromComputer</span>\n          </div>\n          <div ng-if="addContentButton.isMobile">\n            <i class="icon-arrow-upload"></i>\n            <span bb-translate>components.directives.add-content-button.uploadFromDevice</span>\n          </div>\n        </button>\n    </bb-file-upload>\n  </li>\n  <li ng-if="addContentButton.isCloudServiceAvailable">\n    <bb-file-upload\n      allow-multiple="false"\n      monitor-leave="true"\n      target-div="{{\'#\' + fileListViewId}}"\n      hide-transclude-during-upload="false"\n      click-enabled="false"\n      primary-key="primaryKey && primaryKey() ? primaryKey() : fileListViewLocalId"\n      skip-zip-file-check="true"\n      disable-drag="true"\n      is-third-party-upload="true"\n      third-party-download-handler="addContentButton.downloadFile"\n      ignored-states="::ignoredStates()">\n      <button\n        type="button"\n        class="js-upload-from-cloud-storage-integration"\n        ng-click="addContentButton.assignPosition()"\n        bb-cloud-storage-integration\n        primary-key="primaryKey && primaryKey() ? primaryKey() : fileListViewLocalId"\n        attach-handler="attachHandler || addContentButton.defaultAttachHandler"\n        web-location="{{webLocation}}"\n        file-location="{{fileLocation}}"\n        allow-multiple="false"\n        on-cancel-focus="!initialUpload ? addContentButton.focusAddButton : null"\n        analytics-id="components.directives.add-content-button.editor.uploadFromCloudStorage.button">\n          <div>\n            <i class="icon-cloud"></i>\n            <span bb-translate>components.directives.add-content-button.uploadFromCloudStorage</span>\n          </div>\n        </button>\n    </bb-file-upload>\n  </li>\n  <li>\n    <button type="button"\n            ng-class="{\'disabled\': !isDocumentSaved()}"\n            class="js-browse-content-collection-block"\n            ng-click="addContentButton.browseContentCollection()"\n            analytics-id="components.directives.add-content-collection-button.editor.addText.button">\n      <div>\n        <span bb-translate>course.contentCollection.browseContentCollection</span>\n      </div>\n    </button>\n  </li>\n</ul>\n'},"2E9T":function(e,t){e.exports='<bb-svg-icon size="small" icon="add" class="js-add-plus add-circle-default"></bb-svg-icon>\n<bb-svg-icon size="small" icon="add" status="active" class="js-add-plus add-circle-active"></bb-svg-icon>'},"2a+M":function(e,t,o){"use strict";(function(e){o.d(t,"c",(function(){return a})),o.d(t,"d",(function(){return s})),o.d(t,"b",(function(){return d})),o.d(t,"a",(function(){return l}));var n=o("nsO7"),i=o("Llzl"),r=o("0JpG");const a="ultra.services.dragDrop",s="dragDropService";var d;!function(e){e.Top="TOP",e.Bottom="BOTTOM",e.Folder="FOLDER",e.Self="SELF"}(d||(d={}));class l{constructor(e,t){this.$timeout=e,this.bbLocalize=t,this.dragHoverClass="dz-drag-hover",this.dragElementSelector=".drag-element",this.onFolderClass="on-folder",this.onNestedFolderClass="on-nested-folder",this.originalElementClass="drag-element-original",this.movableElementClass="drag-element-movable",this.queuedScreenReaderMessages="",this.bbLocalize.loadBundle("components/services/drag-drop").then((()=>{this.folderDepthMessageKey="components.services.drag-drop.folderDepthMessage"}))}createDropPlaceholderElement(t){this.dropPlaceholderElement=e('<div class="dragdropplaceholder js-no-file-drop" style="height: '+t.height()+"px; width: "+t.width()+'px"></div>')}setDropTarget(e){this.lastDropTargetId=this.currentDropTargetId,this.currentDropTargetId=e}clearDropTarget(){this.setDropTarget(void 0)}isCurrentDropTarget(e){return this.currentDropTargetId===e}isNotSameDropTarget(){return this.currentDropTargetId!==this.lastDropTargetId}scrollDragDropItemsContainer(e,t){const o=this._getScrollingContainerElement();if(o){const n=e<l.SCROLLING_CONSTANTS.scrollZoneHeight,i=e>o.height()-l.SCROLLING_CONSTANTS.scrollZoneHeight,r=o.scrollTop();n?o.scrollTop(r-t):i&&o.scrollTop(r+t)}}_getScrollingContainerElement(){const e=l.SCROLL_CONTAINERS_SELECTORS.map((e=>this.originalElement.closest(e)));return n.find(e,(e=>this._elementHasScrollbar(e)))}_elementHasScrollbar(e){return e.get(0).scrollHeight>e.innerHeight()}}l.SCROLLING_CONSTANTS={scrollZoneHeight:200,mouseInteractionDistanceToScroll:30,keyboardInteractionDistanceToScroll:200},l.SCROLL_CONTAINERS_SELECTORS=[".panel-wrap",".panel-content"],l.$inject=["$timeout",r.serviceName];i.module(a,[r.moduleName]).service(s,l)}).call(this,o("71td"))},"2i58":function(e,t,o){var n=o("ziER"),i=o("5JeM"),r=new n({id:"icon-small-content-market",use:"icon-small-content-market-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-content-market"><path d="M2 2h13l-1 8H4" stroke-width="2" stroke-linejoin="round" /><circle cx="13" cy="14" r="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><circle cx="4" cy="14" r="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><path d="M3 6h11.5M7 2v8M11 2v8M1 1h1l2 12h9" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(r);e.exports=r},"6xt4":function(e,t){e.exports='<div id="{{::addContentButton.getButtonWrapperId()}}" tabindex="-1">\n  <button\n    id="{{::addContentButton.getTargetId()}}"\n    class="button-add-content js-show-add-options"\n    data-show-add-options\n    ng-click="addContentButton.toggleOverflowMenu()"\n    ng-class="{hide: !(addContentButton.isButtonVisible || addContentButton.alwaysShow || addContentButton.isMenuVisible)}"\n    aria-expanded="{{addContentButton.isMenuVisible}}"\n    aria-haspopup="true"\n    aria-controls="{{::\'add-content-menu-\' + addMenuId}}"\n    aria-label="{{addContentButton.addButtonAriaLabel}}"\n    ng-focus="addContentButton.showButton()"\n    ng-blur="addContentButton.hideButton()"\n    analytics-id="components.directives.add-content-button.course-outline.addContentMenu.button">\n  </button>\n</div>\n<bb-ui-contextual-menu\n  items="addContentButton.items"\n  target-id="::addContentButton.getTargetId()"\n  show="addContentButton.isMenuVisible && !addContentButton.isEmptyFolder()"\n  directional-hint="::addContentButton.getDirectionalHint()"\n  dismiss="addContentButton.hideAddContentMenu"\n  aria-labelledby="{{::addContentButton.getTargetId()}}"\n  analytics-id="components.directives.add-content-button.contextualMenu">\n</bb-ui-contextual-menu>\n<ul class="element-list-add-menu angular-animate small-block-grid-2 medium-block-grid-2"\n    ng-class="\'large-block-grid-3\'"\n    ng-attr-id="{{::\'add-content-menu-\' + addMenuId}}"\n    ng-show="addContentButton.isEmptyFolder()">\n  <li ng-if="addContentButton.isEmptyFolder()">\n    <a class="js-create"\n       bb-peek-sref="content-manage.create(addContentButton.getInsertLocationData())"\n       analytics-id="components.directives.add-content-button.course-outline.link">\n      <div>\n        <bb-svg-icon size="small" icon="add"></bb-svg-icon>\n        <span bb-translate>components.directives.add-content-button.create</span>\n      </div>\n    </a>\n  </li>\n  <li ng-if="addContentButton.currentCourse.canCopy() && addContentButton.isEmptyFolder()">\n    <a class="content-import-button"\n       bb-peek-sref="content-manage.copy(addContentButton.getInsertLocationData())"\n       analytics-id="components.directives.add-content-button.course-outline.import.link">\n      <div>\n        <bb-svg-icon size="small" icon="duplicate"></bb-svg-icon>\n        <span bb-translate>components.directives.add-content-button.copy</span>\n      </div>\n    </a>\n  </li>\n  <li>\n    <bb-file-upload\n      url="/v1/files"\n      data="{}"\n      monitor-leave="true"\n      allow-multiple="true"\n      hide-transclude-during-upload="false"\n      is-content="true"\n      primary-key="fileListViewLocalId"\n      skip-zip-file-check="true"\n      class="js-file-upload"\n      depth="depth()">\n      <button ng-if="addContentButton.isEmptyFolder()"\n              class="file-upload-button"\n              analytics-id="components.directives.add-content-button.course-outline.upload.button">\n        <div>\n          <bb-svg-icon size="small" icon="upload"></bb-svg-icon>\n          <span bb-translate>components.directives.add-content-button.upload</span>\n        </div>\n      </button>\n    </bb-file-upload>\n  </li>\n  <li ng-if="addContentButton.isCloudServiceAvailable">\n    <bb-file-upload\n      allow-multiple="true"\n      monitor-leave="true"\n      is-third-party-upload="true"\n      hide-transclude-during-upload="false"\n      click-enabled="false"\n      cloud-upload-selected-content-id="addContentButton.positionForFiles.positionAfter"\n      primary-key="fileListViewId"\n      skip-zip-file-check="true"\n      third-party-download-handler="addContentButton.downloadFile"\n      target-div="{{\'#\' + fileListViewId}}"\n      disable-drag="true"\n      ignored-states="[\'content-manage.import\']">\n      <button\n        class="doc-add-media clear ng-scope"\n        bb-cloud-storage-integration\n        primary-key="fileListViewId"\n        attach-handler="addContentButton.defaultAttachHandler"\n        web-location="{{webLocation}}"\n        file-location="{{fileLocation}}"\n        allow-multiple="true"\n        on-files-selected="addContentButton.onFilesSelectedHandler"\n        analytics-id="components.directives.add-content-button.course-outline.importContentFromCloudStorage.button">\n        <bb-svg-icon size="small" icon="upload-cloud"></bb-svg-icon>\n        <span bb-translate>components.directives.add-content-button.importContentFromCloudStorage.title</span>\n      </button>\n    </bb-file-upload>\n  </li>\n  <li ng-if="addContentButton.isEmptyFolder()">\n    <a class="js-content-market"\n       href="javascript:void(0);"\n       ng-click="addContentButton.openContentMarket()"\n       analytics-id="components.directives.add-content-button.course-outline.openContentMarket.link">\n      <div>\n        <bb-ui-icon-small-content-market class="bb-ui-icon-folder"></bb-ui-icon-small-content-market>\n        <span bb-translate>components.directives.add-content-button.contentMarket</span>\n      </div>\n    </a>\n  </li>\n  <li ng-if="addContentButton.isEmptyFolder()">\n    <a class="js-content-collection"\n       bb-peek-sref="content-collection(addContentButton.getInsertLocationData())"\n       analytics-id="components.directives.add-content-button.course-outline.contentCollection.link">\n      <div>\n        <bb-svg-icon size="small" icon="content-collection"></bb-svg-icon>\n        <span bb-translate>components.directives.add-content-button.contentCollection</span>\n      </div>\n    </a>\n  </li>\n</ul>\n'},"9hVN":function(e,t,o){"use strict";o.d(t,"a",(function(){return p})),o.d(t,"b",(function(){return u}));var n=o("D57K"),i=o("Llzl"),r=o("sgjL"),a=o("TnpK"),s=o("lEL+"),d=o("nmzr"),l=o("g66W"),c=o("aHpC");const p="ultraUi.components.services.contentCollection",u="ContentCollection";let h=class{constructor(e,t,o,n){this.$q=e,this.postMessageDispatcherService=t,this.stateService=o,this.timeoutService=n}handleContentCollectionResponse(e,t=null){this.postMessageDispatcherService.registerEventHandler("classic-picker-cancel",((t,o)=>{this.timeoutService((()=>{l.d(this.stateService.current.name,"peek.content-collection-picker")&&this.stateService.leavePeekState(this.stateService.current.name),window!==o&&o.close()}),e,0)}),e),this.postMessageDispatcherService.registerEventHandler("classic-picker-submit",((o,n)=>{this.timeoutService((()=>{t?e.$emit("bb-bbml-editor-add-from-content-collection",t,o.items):this.getCcFilesDeferred.resolve(o.items),l.d(this.stateService.current.name,"peek.content-collection-picker")&&this.stateService.leavePeekState(this.stateService.current.name),window!==n&&n.close()}),e,0)}),e,!0)}getOpenContentCollectionFunction(e){return t=>{this.handleContentCollectionResponse(e),this.getCcFilesDeferred=this.$q.defer(),this.getCcFilesDeferred.promise.then((e=>{t(e)})),this.stateService.goPeekState(d.h.CONTENT_COLLECTION_PICKER,{pickerType:"File",multi:"true"})}}};h=Object(n.a)([Object(n.c)(0,Object(c.b)("$q")),Object(n.c)(1,Object(c.b)(r.b)),Object(n.c)(2,Object(c.b)(a.d)),Object(n.c)(3,Object(c.b)(s.b))],h),i.module(p,[]).service(u,h)},"9hp7":function(e,t){e.exports='<div bb-load-bundle="components/directives/add-content-button">\n  <div class="add-element no-select js-add-content-button {{::contextArea + \'-add-button\'}}"\n       ng-class="{\n         \'force-show-add-button\': addContentButton.isForceShowAddButton && addContentButton.isForceShowAddButton(),\n         \'is-active\': addContentButton.isMenuVisible,\n         \'button-visible\': addContentButton.isButtonVisible,\n         hide: hideDividerLines() && !(addContentButton.isButtonVisible || addContentButton.alwaysShow || addContentButton.isMenuVisible)\n       }"\n       ng-keydown="addContentButton.onKeydown($event)">\n    <template></template>\n  </div>\n  <div id="{{::fileListViewId}}">\n    <bb-progress display-results="false" primary-key="primaryKey && primaryKey() ? primaryKey() : fileListViewLocalId" target-div="{{::\'#\' + fileListViewId}}"></bb-progress>\n  </div>\n</div>'},BiyI:function(e,t,o){var n=o("ziER"),i=o("5JeM"),r=new n({id:"icon-small-add-plus",use:"icon-small-add-plus-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-add-plus"><path d="M8 5v6M11 8H5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(r);e.exports=r},"D8d/":function(e,t,o){"use strict";(function(e){o.d(t,"a",(function(){return p}));var n=o("Llzl"),i=o("0JpG"),r=o("A+IJ"),a=o("2a+M"),s=o("pjml"),d=o("lEL+"),l=o("GbAM"),c=o("W6wm");const p="ultra.components.directives.bbDropHandler";class u{constructor(e,t,o,n,i,r,s,d){this.scope=e,this.element=t,this.$rootScope=n,this.$q=i,this.timeout=r,this.dragDropService=s,this.bbLocalizeService=d,this.isDraggingOverFolder=!1,this.isEmptyTarget="emptyTarget"in o,this.dropTargetElement=t.closest(this.dragDropService.dragElementSelector),e.$on("bb-drag-move",(()=>{if(this.isEnabledForReordering()&&this.isNotSameDropTarget()&&this.isOnSamePanel()){const e=t.offset(),o=t.height()+e.top,n=t.width()+e.left;this.dragDropService.pointerPosition.left>=e.left&&this.dragDropService.pointerPosition.left<=n&&this.dragDropService.pointerPosition.top>=e.top&&this.dragDropService.pointerPosition.top<=o?this.dragOverFunc(this.dragDropService.pointerPosition.top):this.dragLeaveFunc()}})),e.$on("bb-drag-end",(()=>{this.isEnabledForReordering()&&this.dragDropService.isCurrentDropTarget(e.content().id)&&this.isOnSamePanel()&&this.dropHandlerFunc()})),t.on("drop",(t=>{t.originalEvent.dataTransfer.files&&t.originalEvent.dataTransfer.files.length>0&&e.onFileDropHandler&&e.onFileDropHandler()(t.originalEvent.dataTransfer.files,e.content())})),e.$on("bb-drag-cancel",(()=>{this.isEnabledForReordering()&&this.dragDropService.isCurrentDropTarget(e.content().id)&&this.isOnSamePanel()&&(e.content().id===this.dragDropService.currentDragId&&(this.dragDropService.positionBefore=e.content().id),this.dropHandlerFunc())})),e.$on("keyboard-drag-start",(()=>{this.isEnabledForReordering()&&e.content().id===this.dragDropService.currentDragId&&(this.dragPosition=a.b.Self,this.dragDropService.originalElement=t.closest(this.dragDropService.dragElementSelector),this.dragDropService.currentDragElement=this.dragDropService.originalElement.clone(),this.dragDropService.originalElement.addClass(this.dragDropService.originalElementClass),this.dragDropService.currentDragElement.addClass(this.dragDropService.movableElementClass),this.dragDropService.originalElement.addClass(this.dragDropService.dragHoverClass),this.dragDropService.setDropTarget(e.content().id))})),e.$on("keyboard-drag-end",(()=>{this.isEnabledForReordering()&&this.dragDropService.isCurrentDropTarget(e.content().id)&&this.isOnSamePanel()&&this.timeout((()=>{this.dragDropService.originalElement&&this.dragDropService.originalElement.removeClass(this.dragDropService.originalElementClass),a.b.Folder===this.dragPosition?this.dragDropService.positionAfter=e.content().id:a.b.Top===this.dragPosition?(this.dragDropService.positionBefore=e.content().id,this.dragDropService.positionAfter=null):(this.dragDropService.positionAfter=e.content().id,this.dragDropService.positionBefore=null),this.dropTargetElement.removeClass(this.dragDropService.dragHoverClass),this.dragDropService.currentDragElement&&this.dragDropService.currentDragElement.remove(),this.isDropPreventedByContentDepthRules().then((t=>{if(!this.isDnDPreventedInDiscussionContext()&&!t&&!this._isDroppingInSamePlace()){const t={dragContentId:this.dragDropService.currentDragId,dragElement:this.dragDropService.currentDragElement,parentFolderId:this.scope.content().parentId,positionAfterId:this.dragDropService.positionAfter,positionBeforeId:this.dragDropService.positionBefore,rootScope:this.$rootScope,targetFolderId:this.scope.content().id};e.onMoveHandler()(t)}this._keyboardEndDragAndClearValues()}))}),e)})),e.$on("keyboard-drag-cancel",(()=>{this.isEnabledForReordering()&&this.dragDropService.isCurrentDropTarget(e.content().id)&&(this._keyboardEndDragAndClearValues(),this.dropTargetElement.removeClass(this.dragDropService.dragHoverClass),this.dragDropService.originalElement.removeClass(this.dragDropService.originalElementClass),this.dragDropService.currentDragElement.remove())})),e.$on("keyboard-drag-up",(()=>{this.isEnabledForReordering()&&this.dragDropService.isCurrentDropTarget(e.content().id)&&(this._removeKeyboardPlaceholderAndStyling(),this.isEmptyTarget&&(this.dragPosition=a.b.Top),a.b.Self===this.dragPosition||a.b.Top===this.dragPosition?e.previousContentId&&e.previousContentId()?this.keyboardMoveUpToItem(e.previousContentId()):e.content().depth>1?(this.dragDropService.queuedScreenReaderMessages+=" ",this.dragDropService.queuedScreenReaderMessages+=this.bbLocalizeService.translateSync({locale:this.bbLocalizeService.getLocale(this.scope),key:"components.services.drag-drop.aria.reorder-leave-folder",noWrap:!0}),this.keyboardMoveOntoFolder(e.content().parentId)):(this._applyKeyboardPlaceholderAndStyling(),this._informScreenReaderOfNewLocation()):a.b.Folder===this.dragPosition?this._keyboardMoveAboveThisItem():a.b.Bottom===this.dragPosition&&this.isDropPreventedByContentDepthRules().then((t=>{this.isAFolder()?!0!==e.isFolderOpen()||!this.isNotSameDropTarget()||this.isDnDPreventedInDiscussionContext()||t?!1!==e.isFolderOpen()||!this.isNotSameDropTarget()||this.isDnDPreventedInDiscussionContext()||t||this.keyboardMoveOntoFolder(this.scope.content().id):(this.dragDropService.queuedScreenReaderMessages+=" ",this.dragDropService.queuedScreenReaderMessages+=this.bbLocalizeService.translateSync({locale:this.bbLocalizeService.getLocale(this.scope),key:"components.services.drag-drop.aria.reorder-enter-folder",noWrap:!0}),this.keyboardMoveIntoFolderAsLastItem()):this._keyboardMoveAboveThisItem()})))})),e.$on("keyboard-drag-down",(()=>{this.isEnabledForReordering()&&this.dragDropService.isCurrentDropTarget(e.content().id)&&(this._removeKeyboardPlaceholderAndStyling(),this.isEmptyTarget&&(this.dragPosition=a.b.Bottom),a.b.Self===this.dragPosition||a.b.Bottom===this.dragPosition?e.nextContentId&&e.nextContentId()?this.keyboardMoveDownToItem(e.nextContentId()):e.content().depth>1?(this.dragDropService.queuedScreenReaderMessages+=" ",this.dragDropService.queuedScreenReaderMessages+=this.bbLocalizeService.translateSync({locale:this.bbLocalizeService.getLocale(this.scope),key:"components.services.drag-drop.aria.reorder-leave-folder",noWrap:!0}),this.keyboardMoveBelowItem(e.content().parentId)):(this._applyKeyboardPlaceholderAndStyling(),this._informScreenReaderOfNewLocation()):a.b.Folder===this.dragPosition?this.isDropPreventedByContentDepthRules().then((t=>{e.isFolderOpen&&!0===e.isFolderOpen()&&this.isNotSameDropTarget()&&!this.isDnDPreventedInDiscussionContext()&&!t?(this.dragDropService.queuedScreenReaderMessages+=" ",this.dragDropService.queuedScreenReaderMessages+=this.bbLocalizeService.translateSync({locale:this.bbLocalizeService.getLocale(this.scope),key:"components.services.drag-drop.aria.reorder-enter-folder",noWrap:!0}),this.keyboardMoveIntoFolderAsFirstItem()):this._keyboardMoveBelowThisItem()})):a.b.Top===this.dragPosition&&this.isDropPreventedByContentDepthRules().then((e=>{this.isAFolder()&&this.isNotSameDropTarget()&&!this.isDnDPreventedInDiscussionContext()&&!e?this.keyboardMoveOntoFolder(this.scope.content().id):this._keyboardMoveBelowThisItem()})))})),e.$on("keyboard-drag-right",(()=>{this.isEnabledForReordering()&&this.dragDropService.isCurrentDropTarget(e.content().id)&&a.b.Folder===this.dragPosition&&e.isFolderOpen&&!1===e.isFolderOpen()&&e.$emit("toggle-folder-by-id",e.content().id)})),e.$on("keyboard-drag-left",(()=>{this.isEnabledForReordering()&&this.dragDropService.isCurrentDropTarget(e.content().id)&&a.b.Folder===this.dragPosition&&e.isFolderOpen&&!0===e.isFolderOpen()&&e.$emit("toggle-folder-by-id",e.content().id)})),e.$on("keyboard-move-up-to-item",((t,o)=>{this.isEnabledForReordering()&&e.content().id===o&&(this.dragDropService.setDropTarget(e.content().id),e.content().id===this.dragDropService.currentDragId?(this.dragPosition=a.b.Self,this._applyKeyboardPlaceholderAndStyling(),this._informScreenReaderOfNewLocation()):this.isAFolder()?this.scope.isFolderOpen&&!0===this.scope.isFolderOpen()?this.keyboardMoveIntoFolderAsLastItem():(this.dragPosition=a.b.Folder,this._applyKeyboardPlaceholderAndStyling(),this._informScreenReaderOfNewLocation()):this._keyboardMoveAboveThisItem())})),e.$on("keyboard-move-down-to-item",((t,o)=>{this.isEnabledForReordering()&&e.content().id===o&&(this.dragDropService.setDropTarget(e.content().id),e.content().id===this.dragDropService.currentDragId?(this.dragPosition=a.b.Self,this._applyKeyboardPlaceholderAndStyling(),this._informScreenReaderOfNewLocation()):this.isAFolder()?this.keyboardMoveOntoFolder(this.scope.content().id):this._keyboardMoveBelowThisItem())})),e.$on("keyboard-move-above-item",((t,o)=>{this.isEnabledForReordering()&&e.content().id===o&&(this.dragDropService.setDropTarget(e.content().id),this._keyboardMoveAboveThisItem())})),e.$on("keyboard-move-below-item",((t,o)=>{this.isEnabledForReordering()&&e.content().id===o&&(this.dragDropService.setDropTarget(e.content().id),this._keyboardMoveBelowThisItem())})),e.$on("keyboard-move-onto-folder",((t,o)=>{this.isEnabledForReordering()&&e.content().id===o&&(this.dragDropService.setDropTarget(e.content().id),this.dragPosition=a.b.Folder,this._applyKeyboardPlaceholderAndStyling(),this._informScreenReaderOfNewLocation())})),e.$on("remove-placeholder",(()=>{this.isEnabledForReordering()&&this.dragDropService.dropPlaceholderElement&&this.dragDropService.dropPlaceholderElement.remove(),this.isEmptyTarget&&this.element.children("bb-add-content-button").show()}))}_keyboardMoveBelowThisItem(){this.scope.content().id===this.dragDropService.currentDragId?this.keyboardMoveDownToItem(this.scope.content().id):this.scope.nextContentId&&this.scope.nextContentId()===this.dragDropService.currentDragId?this.keyboardMoveDownToItem(this.scope.nextContentId()):(this.dragPosition=a.b.Bottom,this._applyKeyboardPlaceholderAndStyling(),this._informScreenReaderOfNewLocation())}_keyboardMoveAboveThisItem(){this.scope.content().id===this.dragDropService.currentDragId?this.keyboardMoveUpToItem(this.scope.content().id):this.scope.previousContentId&&this.scope.previousContentId()===this.dragDropService.currentDragId?this.keyboardMoveUpToItem(this.scope.previousContentId()):(this.dragPosition=a.b.Top,this._applyKeyboardPlaceholderAndStyling(),this._informScreenReaderOfNewLocation())}_informScreenReaderOfNewLocation(){const e=this.element.find("[bb-drag-handle]").eq(0).attr("drag-item-name");let t="";if(""!==this.dragDropService.queuedScreenReaderMessages&&(t+=this.dragDropService.queuedScreenReaderMessages,t+=" "),-1!==this.dragDropService.currentDropTargetId.indexOf("blank"))return t+=this.bbLocalizeService.translateSync({locale:this.bbLocalizeService.getLocale(this.scope),key:"components.services.drag-drop.aria.reorder-only-item-in-folder",noWrap:!0}),this.$rootScope.$broadcast(l.a,t),void(this.dragDropService.queuedScreenReaderMessages="");this.scope.previousContentId&&this.scope.previousContentId()||a.b.Top!==this.dragPosition&&a.b.Self!==this.dragPosition?this.scope.nextContentId&&this.scope.nextContentId()||a.b.Bottom!==this.dragPosition&&a.b.Self!==this.dragPosition||(t+=this.bbLocalizeService.translateSync({locale:this.bbLocalizeService.getLocale(this.scope),key:"components.services.drag-drop.aria.reorder-end-of-list",noWrap:!0}),t+=" "):(t+=this.bbLocalizeService.translateSync({locale:this.bbLocalizeService.getLocale(this.scope),key:"components.services.drag-drop.aria.reorder-top-of-list",noWrap:!0}),t+=" "),a.b.Self===this.dragPosition?t+=this.bbLocalizeService.translateSync({locale:this.bbLocalizeService.getLocale(this.scope),key:"components.services.drag-drop.aria.reorder-moved-self",noWrap:!0}):a.b.Folder===this.dragPosition?t+=this.bbLocalizeService.translateSync({locale:this.bbLocalizeService.getLocale(this.scope),key:"components.services.drag-drop.aria.reorder-moved-folder",params:{itemName:e},noWrap:!0}):a.b.Top===this.dragPosition?t+=this.bbLocalizeService.translateSync({locale:this.bbLocalizeService.getLocale(this.scope),key:"components.services.drag-drop.aria.reorder-moved-above",params:{itemName:e},noWrap:!0}):a.b.Bottom===this.dragPosition&&(t+=this.bbLocalizeService.translateSync({locale:this.bbLocalizeService.getLocale(this.scope),key:"components.services.drag-drop.aria.reorder-moved-below",params:{itemName:e},noWrap:!0})),this.$rootScope.$broadcast(l.a,t),this.dragDropService.queuedScreenReaderMessages=""}_applyKeyboardPlaceholderAndStyling(){let e=this.dropTargetElement;a.b.Self===this.dragPosition?this.dropTargetElement.addClass(this.dragDropService.dragHoverClass):a.b.Folder===this.dragPosition?(this.dropTargetElement.before(this.dragDropService.currentDragElement),this.dragDropService.currentDragElement&&(1===this.scope.content().depth?this.dragDropService.currentDragElement.addClass(this.dragDropService.onFolderClass):2===this.scope.content().depth&&this.dragDropService.currentDragElement.addClass(this.dragDropService.onNestedFolderClass))):a.b.Bottom===this.dragPosition?(e=this.dragDropService.currentDragElement,this.dropTargetElement.after(this.dragDropService.currentDragElement)):a.b.Top===this.dragPosition&&(e=this.dragDropService.currentDragElement,this.dropTargetElement.before(this.dragDropService.currentDragElement)),this._scrollContainer(e)}_removeKeyboardPlaceholderAndStyling(){this.dropTargetElement.removeClass(this.dragDropService.dragHoverClass),this.dragDropService.currentDragElement&&(this.dragDropService.currentDragElement.removeClass(this.dragDropService.onFolderClass),this.dragDropService.currentDragElement.removeClass(this.dragDropService.onNestedFolderClass),this.dragDropService.currentDragElement.remove())}_scrollContainer(e){this.dragDropService.scrollDragDropItemsContainer(e.offset().top,a.a.SCROLLING_CONSTANTS.keyboardInteractionDistanceToScroll)}_keyboardEndDragAndClearValues(){this.timeout((()=>{e('[bb-drag-handle][drag-item-id="'+this.dragDropService.currentDragId+'"]').focus(),this.dragDropService.clearDropTarget(),this.dragDropService.currentDragId=void 0,this.dragDropService.currentDragType=void 0,this.dragDropService.isKeyboardDragging=!1}),this.scope,0,!1)}isDropPreventedByContentDepthRules(){const e=()=>s.p.ContentHandler.Folder.isEqualTo(this.dragDropService.currentDragType);if(void 0!==this.dragDropService.currentDragHasFolderChild)return this.dragDropService.currentDragHasFolderChild.then((t=>e()&&(this.isDraggingOverFolder&&this.scope.content().depth===r.l||this.scope.content().depth>r.l||this.isDraggingOverFolder&&t)));const t=this.$q.defer();return t.resolve(!1),t.promise}isDnDPreventedInDiscussionContext(){return(()=>c.a.Discussions===this.dragDropService.currentDragContext)()&&(()=>s.p.ContentHandler.Folder.isEqualTo(this.dragDropService.currentDragType))()&&(this.isDraggingOverFolder&&this.scope.content().depth===r.k||this.scope.content().depth>r.k)}dragOverFunc(e){if(this.dragDropService.currentDragId&&this.dragDropService.currentDragId!==this.scope.content().id){this.dragDropService.setDropTarget(this.scope.content().id),!this.folderHoverTimeout&&this.scope.isFolderOpen&&!1===this.scope.isFolderOpen()&&(this.dropTargetElement.addClass(this.dragDropService.dragHoverClass),this.folderHoverTimeout=this.timeout((()=>{this.isDropPreventedByContentDepthRules().then((e=>{e||this.isDnDPreventedInDiscussionContext()?(this.dragDropService.isShowingDepthMessage=!0,this.$rootScope.$broadcast("show-override-message",this.bbLocalizeService.translateSync({locale:this.bbLocalizeService.getLocale(this.scope),key:this.dragDropService.folderDepthMessageKey}),this.scope.content().id)):(this.scope.$emit("toggle-folder-by-id",this.scope.content().id),this.wasFolderOpened=!0)}))}),this.scope,1500)),this.dragDropService.isShowingDepthMessage&&this.dragDropService.isNotSameDropTarget()&&(this.dragDropService.isShowingDepthMessage=!1,this.broadcastShowOverrideMessage());const t=e,o=this.element.offset().top+this.element.height()/2,n=this.dragPosition;this.isAFolder()&&(this.isDraggingOverFolder=!0),this.scope.content().id.indexOf("placeholder")>-1?(this.dragDropService.positionAfter=this.scope.content().parentId,this.dragDropService.positionBefore=void 0,this.dragPosition=a.b.Bottom):t<=o?(this.dragDropService.positionBefore=this.scope.content().id,this.dragDropService.positionAfter=void 0,this.dragPosition=a.b.Top):(this.dragDropService.positionAfter=this.scope.content().id,this.dragDropService.positionBefore=void 0,this.dragPosition=a.b.Bottom),(this.dragDropService.isNotSameDropTarget()||this.dragPosition!==n)&&(this._moveDropPlaceholderElement(),this.isEmptyTarget&&this.element.children().hide())}}_moveDropPlaceholderElement(){if(this.$rootScope.$broadcast("remove-placeholder"),this.dragDropService.currentDragId===this.dragDropService.currentDropTargetId)return;(()=>this.dragDropService.positionBefore&&this.dragDropService.currentDropTargetId!==this.dragDropService.idOfNextItem)()?this.dropTargetElement.before(this.dragDropService.dropPlaceholderElement):(()=>!(this.dragDropService.currentDropTargetId.indexOf("placeholder")>-1&&this.dragDropService.idOfNextItem===this.dragDropService.currentDropTargetId)&&(this.dragDropService.positionAfter&&this.dragDropService.currentDropTargetId!==this.dragDropService.idOfPreviousItem))()&&this.dropTargetElement.after(this.dragDropService.dropPlaceholderElement)}_isDroppingInSamePlace(){if(null!=this.dragDropService.positionAfter&&this.scope.previousContentId&&this.dragDropService.positionAfter===this.scope.previousContentId()||this.dragDropService.positionAfter===this.dragDropService.currentDragId||null!=this.dragDropService.positionBefore&&this.scope.nextContentId&&this.dragDropService.positionBefore===this.scope.nextContentId()||this.dragDropService.positionBefore===this.dragDropService.currentDragId)return!0}dropHandlerFunc(){this.timeout.cancel(this.folderHoverTimeout),this.dropTargetElement.parents("[data-parent-id]").last().removeAttr("style"),this.dragDropService.clearDropTarget(),this.$rootScope.$broadcast("remove-placeholder"),this.$rootScope.$broadcast("file-drag-restore"),this.dragDropService.isShowingDepthMessage&&(this.dragDropService.isShowingDepthMessage=!1,this.broadcastShowOverrideMessage());const e={dragContentId:this.dragDropService.currentDragId,originalElement:this.dragDropService.originalElement,parentFolderId:this.scope.content().parentId,positionAfterId:this.dragDropService.positionAfter,positionBeforeId:this.dragDropService.positionBefore,rootScope:this.$rootScope,targetFolderId:this.scope.content().id};this.isDropPreventedByContentDepthRules().then((t=>{this._isDroppingInSamePlace()||this.isDnDPreventedInDiscussionContext()?this.dropCleanupFunc():!t&&this.isDraggingOverFolder?this.scope.$$phase||this.scope.$root&&this.scope.$root.$$phase?(this.scope.onMoveIntoFolderHandler()(e),this.dropCleanupFunc()):this.scope.$apply((()=>{this.scope.onMoveIntoFolderHandler()(e),this.dropCleanupFunc()})):t?this.dropCleanupFunc():this.scope.$$phase||this.scope.$root&&this.scope.$root.$$phase?(this.scope.onMoveHandler()(e),this.dropCleanupFunc()):this.scope.$apply((()=>{this.scope.onMoveHandler()(e),this.dropCleanupFunc()})),this.isDraggingOverFolder=!1}))}dropCleanupFunc(){this.wasFolderOpened&&(this.wasFolderOpened=!1,this.scope.$emit("toggle-folder-by-id",this.scope.content().id)),this.dragDropService.currentDragId=void 0,this.dragDropService.currentDragType=void 0,this.dropTargetElement.removeClass(this.dragDropService.dragHoverClass),this.dragDropService.currentDragElement&&this.dragDropService.currentDragElement.remove()}dragLeaveFunc(){this.isDraggingOverFolder=!1,this.dropTargetElement.removeClass(this.dragDropService.dragHoverClass),this.timeout.cancel(this.folderHoverTimeout),this.folderHoverTimeout=void 0,this.isDropPreventedByContentDepthRules().then((e=>{e&&(this.dragDropService.isShowingDepthMessage=!1,this.broadcastShowOverrideMessage())}))}broadcastShowOverrideMessage(){this.scope.$$phase||this.scope.$root&&this.scope.$root.$$phase?this.$rootScope.$broadcast("show-override-message",void 0,this.scope.content().id):this.scope.$apply((()=>this.$rootScope.$broadcast("show-override-message",void 0,this.scope.content().id)))}keyboardMoveUpToItem(e){this.timeout((()=>{this.dragDropService.clearDropTarget(),this.$rootScope.$broadcast("keyboard-move-up-to-item",e)}),this.scope)}keyboardMoveDownToItem(e){this.timeout((()=>{this.dragDropService.clearDropTarget(),this.$rootScope.$broadcast("keyboard-move-down-to-item",e)}),this.scope)}keyboardMoveBelowItem(e){this.timeout((()=>{this.dragDropService.clearDropTarget(),this.$rootScope.$broadcast("keyboard-move-below-item",e)}),this.scope)}keyboardMoveAboveItem(e){this.timeout((()=>{this.dragDropService.clearDropTarget(),this.$rootScope.$broadcast("keyboard-move-above-item",e)}),this.scope)}keyboardMoveOntoFolder(e){this.timeout((()=>{this.dragDropService.clearDropTarget(),this.$rootScope.$broadcast("keyboard-move-onto-folder",e)}),this.scope)}keyboardMoveIntoFolderAsLastItem(){const e=this.scope.content().children;e.length>0?this.keyboardMoveBelowItem(e[e.length-1].id):this.keyboardMoveBelowItem(this.scope.content().id+"blank")}keyboardMoveIntoFolderAsFirstItem(){const e=this.scope.content().children;e.length>0?this.keyboardMoveAboveItem(e[0].id):this.keyboardMoveAboveItem(this.scope.content().id+"blank")}isNotSameDropTarget(){return this.scope.content().id!==this.dragDropService.currentDragId}isOnSamePanel(){return this.element.closest(".panel-content").is(this.dragDropService.originalElement.closest(".panel-content"))}isEnabledForReordering(){return!(this.scope.disableForReordering&&this.scope.disableForReordering())}isAFolder(){return null!=this.scope.isFolderOpen}}u.$inject=["scope","element","attrs","$rootScope","$q",d.b,a.d,i.serviceName];class h{constructor(e){this.$injector=e,this.scope={onMoveIntoFolderHandler:"&?",onMoveHandler:"&",onFileDropHandler:"&",isFolderOpen:"&?",content:"&",previousContentId:"&?",nextContentId:"&?",disableForReordering:"&?"},this.restrict="A",this.link=(e,t,o)=>{e.dropHandlerDirective=this.$injector.instantiate(u,{scope:e,element:t,attrs:o})}}}h.$inject=["$injector"],n.module(p,[a.c,d.a]).directive("bbDropHandler",["$injector",e=>e.instantiate(h)])}).call(this,o("71td"))},DMV0:function(e,t){e.exports='<bb-modal class="notification"\n          modal-title-key="components.directives.cloudStorageIntegration.modal.errorTitle"\n          analytics-id-tag-prefix="components.directives.cloudStorageIntegration">\n  <div name="modal-contents">\n    <p bb-translate>components.directives.cloudStorageIntegration.modal.errorFull</p>\n  </div>\n  <button name="modal-footer-button-primary" class="button dismiss-button js-primary-button" ng-click="$parent.$dismiss()" analytics-id="components.directives.cloudStorageIntegration.modal.cancelUploadText">\n    <bb-translate>components.directives.cloudStorageIntegration.modal.cancelUploadText</bb-translate>\n  </button>\n</bb-modal>\n'},"H/mg":function(e,t,o){"use strict";o.d(t,"a",(function(){return s}));var n=o("Llzl"),i=o("ERkP"),r=o("1ZbL"),a=o("Dz4E");const s="ultra.components.directives.react-toolkit.contextual-menu";class d extends i.Component{render(){return this.props.show?i.createElement(a.ContextualMenu,{items:this.props.items,directionalHint:this.props.directionalHint,target:document.getElementById(this.props.targetId),onDismiss:this.props.dismiss,labelElementId:this.props.ariaLabelledby,analyticsId:this.props.analyticsId}):null}}const l={Class:d,bindingNames:["items","targetId","show","dismiss","directionalHint"],attributes:["ariaLabelledby","analyticsId"]};n.module(s,[]).component("bbUiContextualMenu",Object(r.a)(l))},J3aO:function(e,t,o){"use strict";(function(e){o.d(t,"b",(function(){return a})),o.d(t,"a",(function(){return s}));var n=o("D57K"),i=o("VAMW"),r=o("aHpC");const a="menuCloserService",s="ultra.services.menuCloser";class d{constructor(e){this.service=e,this.key=i.d.AngularMenuCloserService}closeAnyOpenAngularMenus(){this.service.closeAnyOpenAngularMenus()}}let l=class{constructor(e){this.$rootScope=e,Object(i.f)(new d(this))}closeAnyOpenAngularMenus(){const t=e(".f-open-dropdown");t.length>0&&window.Foundation.libs.dropdown.close(t),this.$rootScope.$broadcast("foundation-offcanvas-close-panel")}};l=Object(n.a)([Object(n.c)(0,Object(r.b)("$rootScope"))],l);angular.module(s,[]).service(a,l)}).call(this,o("71td"))},J8YL:function(e,t){e.exports='<div class="discussion-assignment">\n  <button class="button-add-content js-show-add-options" data-show-add-options ng-click="addContentButton.toggleMenu()"\n     ng-class="{hide: !(addContentButton.isButtonVisible || addContentButton.alwaysShow || addContentButton.isMenuVisible)}"\n     aria-expanded="{{addContentButton.isMenuVisible}}" aria-controls="{{::\'add-content-menu-\' + addMenuId}}"\n     aria-label="{{addContentButton.addButtonAriaLabel}}"\n     ng-focus="addContentButton.showButton()" ng-blur="addContentButton.hideButton()"\n     analytics-id="components.directives.add-content-button.assignment.button">\n  </button>\n  \x3c!-- use ng-show to keep the element when close add buttons, make sure the upload directive handlers will not be lost --\x3e\n  <ul role="menu" class="element-list-add-menu outline-menu angular-animate"\n      aria-expanded="{{addContentButton.isMenuVisible}}"\n      ng-attr-id="{{\'add-content-menu-\' + addMenuId}}"\n      ng-if="::addContentButton.isMenuVisible || undefined"\n      ng-show="addContentButton.isMenuVisible">\n    <li>\n      <bb-file-upload\n        url="/v1/files"\n        data="{}"\n        allow-multiple="true"\n        monitor-leave="true"\n        disable-drag="disableDrag && disableDrag()"\n        target-div="{{\'#\' + fileListViewId}}"\n        hide-transclude-during-upload="false"\n        is-third-party-upload="false"\n        disallow-folder-uploads="true"\n        skip-zip-file-check="true"\n        ignored-states="::ignoredStates()"\n        position="positionBefore ? positionBefore() : positionAfter && positionAfter() + 1">\n        <a href="javascript:void(0);"\n           role="menuitem"\n           bb-translate-attrs="{\'aria-label\':\'course.content.buildContentArea.addFiles\'}"\n           ng-click="addContentButton.toggleMenu()"\n           analytics-id="components.directives.add-content-button.assignment.fileUpload.link" >\n          <bb-svg-icon size="small" icon="upload"></bb-svg-icon><span bb-translate analytics-id="course.content.buildContentArea.addFiles">course.content.buildContentArea.addFiles</span>\n        </a>\n      </bb-file-upload>\n    </li>\n    <li ng-if="!addContentButton.isMobile">\n      \x3c!-- Skip zip file check, assignment does not support unzip file(LRN-101238) --\x3e\n      <bb-file-upload allow-multiple="true" monitor-leave="true" is-third-party-upload="true"  hide-transclude-during-upload="false" skip-zip-file-check="true"\n                      click-enabled="false" primary-key="fileListViewId" disable-drag="disableDrag && disableDrag()"\n                      third-party-download-handler="addContentButton.downloadFile" target-div="{{\'#\' + fileListViewId}}"\n                      position="positionBefore ? positionBefore() : positionAfter && positionAfter() + 1">\n        <a href="javascript:void(0);"\n           role="menuitem"\n           primary-key="fileListViewId"\n           is-flatten="false"\n           attach-handler="attachHandler || addContentButton.defaultAttachHandler"\n           ignored-states="::ignoredStates()"\n           bb-translate-attrs="{\'aria-label\':\'components.directives.add-content-button.aria-label.content.oneDrive\'}"\n           ng-click="addContentButton.toggleMenu()"\n           analytics-id="components.directives.add-content-button.assignment.oneDrive.link">\n          <div>\n            <i class="icon-cloud"></i><span bb-translate>components.directives.add-content-button.oneDrive</span>\n          </div>\n        </a>\n      </bb-file-upload>\n    </li>\n  </ul>\n</div>\n'},Ocaa:function(e,t,o){"use strict";(function(e){o.d(t,"a",(function(){return g}));o("0lMW"),o("gORw");var n=o("Llzl"),i=o("0JpG"),r=o("2a+M"),a=o("+4Px"),s=o("pjml"),d=o("lEL+"),l=o("GbAM"),c=o("Qbdf"),p=o("nYZ0"),u=o("W6wm"),h=o("J3aO");const g="ultra.components.directives.bbDragHandle";var m;!function(e){e.Vertical="vertical",e.Horizontal="horizontal",e.Omnidirectional="omnidirectional"}(m||(m={}));class b{constructor(t,o,n,i,r,s,d){this.$rootScope=t,this.bbLocalizeService=o,this.dragDropService=n,this.timeout=i,this.currentCourseService=r,this.contentService=s,this.menuCloserService=d,this.bbDragMoveTimeoutId=null,this.scope={dragItemId:"@",dragItemName:"@",dragItemType:"@",dragDirection:"@?",dragItemContext:"@?"},this.restrict="A",this.link=(t,o,n)=>{this.dragDirection=function(e){if(e)return Object.values(m).find((t=>t.toLowerCase()===e.toLowerCase()))}(t.dragDirection)||m.Vertical,this.dragDropService.currentDragContext=t.dragItemContext,e(o).parent().attr("role","application"),o.on("mousedown",(n=>{function i(e){e.stopImmediatePropagation()}n.preventDefault(),document.addEventListener("click",i,!0),this.dragStart(n,o,t),e(document).on("mousemove.reorder",(e=>{this.dragMove(e,t)})),e(document).on("mouseup.reorder",(n=>{this.dragEnd(n,o),e(document).off("mousemove.reorder"),e(document).off("mouseup.reorder"),o.on("$destroy",(()=>{document.removeEventListener("click",i,!0)})),this.timeout((()=>{document.removeEventListener("click",i,!0)}),t,0,!1)}))})),o.on("keydown",(o=>{if(o.stopPropagation(),o.keyCode===a.f||o.keyCode===a.t)if(o.preventDefault(),this.dragDropService.isKeyboardDragging){const o=this.bbLocalizeService.translateSync({locale:this.bbLocalizeService.getLocale(t),key:"components.services.drag-drop.aria.reorder-stopped",noWrap:!0});this.$rootScope.$broadcast(l.a,o),e(document.body).removeClass("bb-is-dragging"),this.$rootScope.$broadcast("keyboard-drag-end")}else{this.dragDropService.isKeyboardDragging=!0,this.dragDropService.currentDragId=t.dragItemId,this.dragDropService.currentDragType=t.dragItemType,this.contentHasFolderChild(t),this.dragDropService.currentDropTargetId=t.dragItemId,this.dragDropService.positionBefore=t.dragItemId,e(document.body).addClass("bb-is-dragging"),this.$rootScope.$broadcast("keyboard-drag-start");const o=this.bbLocalizeService.translateSync({locale:this.bbLocalizeService.getLocale(t),key:"components.services.drag-drop.aria.reorder-started",params:{itemName:t.dragItemName},noWrap:!0});this.$rootScope.$broadcast(l.a,o)}else if(o.keyCode===a.v)o.preventDefault(),this.$rootScope.$broadcast("keyboard-drag-up");else if(o.keyCode===a.d)o.preventDefault(),this.$rootScope.$broadcast("keyboard-drag-down");else if(o.keyCode===a.s)o.preventDefault(),this.$rootScope.$broadcast("keyboard-drag-right");else if(o.keyCode===a.j)o.preventDefault(),this.$rootScope.$broadcast("keyboard-drag-left");else if(o.keyCode===a.g&&(o.preventDefault(),this.dragDropService.isKeyboardDragging)){const o=this.bbLocalizeService.translateSync({locale:this.bbLocalizeService.getLocale(t),key:"components.services.drag-drop.aria.reorder-canceled"});this.$rootScope.$broadcast(l.a,o),e(document.body).removeClass("bb-is-dragging"),this.$rootScope.$broadcast("keyboard-drag-cancel")}})),o.on("blur",(()=>{this.dragDropService.isKeyboardDragging&&(e(document.body).removeClass("bb-is-dragging"),this.$rootScope.$broadcast("keyboard-drag-cancel"))}));const i=e=>{this.dragStart(e,o,t)},r=e=>{this.dragMove(e,t)},s=e=>{this.dragEnd(e,o)},d=()=>{this.dragCancel()};o[0].addEventListener("touchstart",i,!1),o[0].addEventListener("touchmove",r,!1),o[0].addEventListener("touchend",s,!1),o[0].addEventListener("touchcancel",d,!1),t.$on("$destroy",(()=>{o[0].removeEventListener("touchstart",i,!1),o[0].removeEventListener("touchmove",r,!1),o[0].removeEventListener("touchend",s,!1),o[0].removeEventListener("touchcancel",d,!1)}))}}contentHasFolderChild(e){if(s.p.ContentHandler.Folder.isEqualTo(e.dragItemType)&&!(()=>u.a.Discussions===this.dragDropService.currentDragContext)()){const e=s.p.ContentRootNode.ROOT,t=this.currentCourseService.course,o=this.contentService.findRootNode(t,e);this.contentService.getContentInContentTree(o,t.courseId,this.dragDropService.currentDragId).then((e=>{e.content&&(this.dragDropService.currentDragHasFolderChild=e.content.getChildren().$asPromise().then((e=>e.some((e=>e.isUiFolder())))))}))}}dragStart(t,o,n){if(this.dragDropService.currentDragElement){const t=e(".f-open-dropdown");t.length>0&&window.Foundation.libs.dropdown.close(t),this.dragDropService.currentDragElement.remove()}if(this.$rootScope.$broadcast("bb-drag-start"),e(document.body).addClass("bb-is-dragging"),this.dragDropService.originalElement=o.closest(this.dragDropService.dragElementSelector),this.dragDropService.currentDragElement=this.dragDropService.originalElement.clone(),this.dragDropService.idOfPreviousItem=this.dragDropService.originalElement.prev(".drag-element").find("[drag-item-id]").attr("drag-item-id"),this.dragDropService.idOfNextItem=this.dragDropService.originalElement.next(".drag-element").find("[drag-item-id]").attr("drag-item-id"),this.menuCloserService.closeAnyOpenAngularMenus(),s.p.ContentHandler.Folder.isEqualTo(n.dragItemType)){this.$rootScope.$broadcast("close-folder-immediately-by-id",n.dragItemId);this.dragDropService.currentDragElement.find(".img-icon-folder-open").removeClass("img-icon-folder-open").addClass("img-icon-folder")}this.dragDropService.originalElement.addClass(this.dragDropService.originalElementClass),this.dragDropService.currentDragElement.addClass(this.dragDropService.movableElementClass).addClass("mouse-touch-drag"),this.dragDropService.originalElement.after(this.dragDropService.currentDragElement),this.dragDropService.currentDragId=n.dragItemId,this.dragDropService.currentDragType=n.dragItemType,this.contentHasFolderChild(n),this.dragDropService.currentDropTargetId=n.dragItemId,this.dragDropService.positionBefore=n.dragItemId,this.dragDropService.createDropPlaceholderElement(this.dragDropService.currentDragElement),this.dragMove(t,n)}dragEnd(t,o){e(document.body).removeClass("bb-is-dragging"),t.preventDefault(),this.dragDropService.originalElement.removeClass(this.dragDropService.originalElementClass),this.dragDropService.currentDragElement.removeClass(this.dragDropService.movableElementClass),this.dragDropService.currentDragElement.removeAttr("style"),this.$rootScope.$broadcast("bb-drag-end")}dragCancel(){this.$rootScope.$broadcast("bb-drag-cancel"),e(document.body).removeClass("bb-is-dragging")}dragMove(e,t){e.preventDefault();const o=this.dragDropService.currentDragElement.find("[bb-drag-handle]"),n=this.dragDropService.originalElement.find("[bb-drag-handle]").offset(),i=o.offset(),a=this.dragDropService.currentDragElement.offset(),s=i.left-a.left,d=i.top-a.top,l=s+o.width()/2,c=d+o.height()/2,p=m.Horizontal===this.dragDirection||m.Omnidirectional===this.dragDirection,u=m.Vertical===this.dragDirection||m.Omnidirectional===this.dragDirection;let h,g,b,v;e.touches?(h=p?e.touches[0].pageX-l:a.left,g=u?e.touches[0].pageY-c:a.top,b=p?e.touches[0].pageX:n.left,v=u?e.touches[0].pageY:n.top):(h=p?e.pageX-l:a.left,g=u?e.pageY-c:a.top,b=p?e.pageX:n.left,v=u?e.pageY:n.top),this.dragDropService.currentDragElement.offset({left:h,top:g}),this.dragDropService.pointerPosition={left:b,top:v},this.dragDropService.scrollDragDropItemsContainer(this.dragDropService.pointerPosition.top,r.a.SCROLLING_CONSTANTS.mouseInteractionDistanceToScroll),this.timeout.cancel(this.bbDragMoveTimeoutId),this.bbDragMoveTimeoutId=this.timeout((()=>{this.$rootScope.$broadcast("bb-drag-move")}),t,150,!1)}}b.$inject=["$rootScope",i.serviceName,r.d,d.b,c.e,p.f,h.b],n.module(g,[i.moduleName,r.c,d.a,c.b,p.d,h.a]).directive("bbDragHandle",["$injector",e=>e.instantiate(b)])}).call(this,o("71td"))},SE1T:function(e,t){e.exports='<button class="button-add-content js-show-add-options"\n        data-show-add-options\n        ng-click="addContentButton.addGroup()"\n        ng-class="{hide: !(addContentButton.isButtonVisible || addContentButton.alwaysShow || addContentButton.isMenuVisible)}"\n        aria-label="{{addContentButton.addButtonAriaLabel}}"\n        ng-focus="addContentButton.showButton()"\n        ng-blur="addContentButton.hideButton()"\n        analytics-id="components.directives.add-content-button.course-group.button">\n</button>\n'},UeHE:function(e,t){e.exports='<div ng-if="addContentButton.isCloudServiceAvailable">\n  <bb-file-upload\n    allow-multiple="true"\n    monitor-leave="true"\n    target-div="{{\'#\' + fileListViewId}}"\n    hide-transclude-during-upload="false"\n    click-enabled="false"\n    primary-key="primaryKey && primaryKey() ? primaryKey() : fileListViewLocalId"\n    skip-zip-file-check="true"\n    disable-drag="true"\n    is-third-party-upload="true"\n    third-party-download-handler="addContentButton.downloadFile"\n    ignored-states="::ignoredStates()">\n    <button ng-click="addContentButton.assignPosition()"\n            class="doc-add-media clear ng-scope"\n            bb-cloud-storage-integration\n            primary-key="primaryKey && primaryKey() ? primaryKey() : fileListViewLocalId"\n            attach-handler="addContentButton.cloudUploadAttachHandler"\n            web-location="{{webLocation}}"\n            file-location="{{fileLocation}}"\n            allow-multiple="true"\n            on-files-selected="addContentButton.onFilesSelectedHandler"\n            analytics-id="components.directives.add-content-button.cloud-upload.button">\n      <div class="import-action-header">\n        <i class="icon-cloud add-content-cloud-upload-icon"></i>\n        <span bb-translate>components.directives.add-content-button.importContentFromCloudStorage.title</span>\n        <div class="action-details" bb-translate="components.directives.add-content-button.importContentFromCloudStorage.description"></div>\n      </div>\n    </button>\n  </bb-file-upload>\n</div>\n'},VCKY:function(e,t,o){var n=o("ziER"),i=o("5JeM"),r=new n({id:"icon-small-add",use:"icon-small-add-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-add"><path d="M1 8c0-3.866 3.134-7 7-7v0c3.866 0 7 3.134 7 7v0c0 3.866-3.134 7-7 7v0c-3.866 0-7-3.134-7-7v0zM11 8H5M8 5v6" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(r);e.exports=r},Ybms:function(e,t,o){var n=o("ziER"),i=o("5JeM"),r=new n({id:"icon-small-duplicate",use:"icon-small-duplicate-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-duplicate"><path stroke-width="2" stroke-linecap="round" stroke-linejoin="round" d="M1 4h11v11H1z" /><path d="M12 12h3V1H4v3" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(r);e.exports=r},"c7N/":function(e,t,o){"use strict";o.d(t,"a",(function(){return d})),o.d(t,"b",(function(){return l}));var n=o("D57K"),i=o("Fvsw"),r=o("jhBu"),a=o("aHpC"),s=o("Sa5G");const d="ultra.components.services.unsafe-html",l="unsafe-html";let c=class{constructor(e,t){this.contextService=e,this.entitlementService=t}hasEditUnsafeHtmlPermission(e){return e?this.entitlementService.hasSystemEntitlement(s.w.Modify):this.entitlementService.hasCourseEntitlement(s.w.Modify)}isAlternateDomainConfigured(){return this.contextService.getSystemInfo().alternateDomainConfigured}canEditUnsafeHtml(e=!1){return this.hasEditUnsafeHtmlPermission(e).then((e=>e&&this.isAlternateDomainConfigured()))}};c=Object(n.a)([Object(n.c)(0,Object(a.b)(i.b)),Object(n.c)(1,Object(a.b)(r.b))],c);angular.module(d,[i.a,r.a]).service(l,c)},gORw:function(e,t,o){var n=o("ziER"),i=o("5JeM"),r=new n({id:"icon-small-move-item-up-down",use:"icon-small-move-item-up-down-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-move-item-up-down"><path d="M5 11V3M7 4L5 2 3 4M11 5v8M9 12l2 2 2-2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(r);e.exports=r},jlIo:function(e,t,o){var n=o("ziER"),i=o("5JeM"),r=new n({id:"icon-small-code",use:"icon-small-code-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-code"><path d="M4 3L1 8l3 5M12 3l3 5-3 5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(r);e.exports=r},lx16:function(e,t,o){"use strict";o("zhNR"),o("JzsJ"),o("VCKY"),o("BiyI"),o("jlIo"),o("qzMN"),o("2i58"),o("Ybms"),o("wKTs"),o("vgq2");var n=o("Llzl"),i=o("dCrD");class r extends i.a{}class a extends i.a{}var s=o("D57K"),d=o("ERkP"),l=o("Sa5G"),c=o("aHpC"),p=o("c7N/"),u=o("9hVN"),h=o("0x+l");let g=class extends i.a{constructor(e,t,o){super(e,t,o),this.canEditUnsafeHtml=!1,this.isCloudServiceAvailable=!1,this.initializeItems=()=>{this.items=[{key:"addText",className:"js-add-content",name:this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.add-content-button.addContent"}),icon:d.createElement(h.Notes,null),onClick:this.addTextBlock}],this.canEditUnsafeHtml&&this.items.push({key:"addHtml",className:"js-add-html",name:this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.add-content-button.addHtml"}),icon:d.createElement(h.Editor,null),onClick:this.addHtmlBlock}),this.items.push({key:"addLocalFile",className:"js-add-local-file",name:this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.add-content-button."+(this.isMobile?"uploadFromDevice":"uploadFromComputer")}),icon:d.createElement(h.UploadFile,null),onClick:this.uploadLocalFile}),this.items.push({key:"browseContentCollectionFile",className:"js-browse-content-collection-file",name:this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"course.contentCollection.browseContentCollection"}),icon:d.createElement(h.ContentCollection,null),onClick:this.browseContentCollection}),this.isCloudServiceAvailable&&this.items.push({key:"addCloudFile",className:"js-add-cloud-file",name:this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.add-content-button.uploadFromCloudStorage"}),icon:d.createElement(h.UploadCloud,null),onClick:this.uploadCloudFile})},this.addTextBlock=()=>{this.scope.$emit("bb-bbml-editor-add-block",l.c.Text,this.getInsertLocationData())},this.addHtmlBlock=()=>{this.scope.$emit("bb-bbml-editor-add-block",l.c.Html,this.getInsertLocationData())},this.uploadLocalFile=()=>{this.element.find(".file-upload-button").click()},this.uploadCloudFile=()=>{this.element.find(".js-upload-from-cloud-storage-integration").click()},this.browseContentCollection=()=>{this.rteCollectionService.handleContentCollectionResponse(this.scope,this.getInsertLocationData()),this.ultraState.goPeekState("content-collection-picker",{pickerType:"File",multi:"true"})},this.focusAddButton=()=>{this.element.find("button").focus()},this.$q=e.get("$q"),this.unsafeHtmlService=e.get(p.b),this.rteCollectionService=e.get(u.b),this.initialize()}initialize(){return this.$q.all({canEditUnsafeHtml:this.unsafeHtmlService.canEditUnsafeHtml(),isCloudServiceAvailable:this.isCloudServiceAvailablePromise}).then((({canEditUnsafeHtml:e,isCloudServiceAvailable:t})=>{this.canEditUnsafeHtml=e,this.isCloudServiceAvailable=t})).finally(this.initializeItems)}};g.$inject=[],g=Object(s.a)([Object(s.c)(0,Object(c.b)("$injector")),Object(s.c)(1,Object(c.b)("scope")),Object(s.c)(2,Object(c.b)("element"))],g);var m=o("HjsN");class b extends i.a{addGroup(){this.toggleMenu();const e=this.scope.positionBefore?this.scope.positionBefore():this.scope.positionAfter()+1;this.scope.createFunction(e),this.closeMenu()}}var v=o("tfx2");const S="addAttendance";let f=class extends i.a{constructor(e,t,o){super(e,t,o),this.scope=t,this.element=o;const n=o.closest("[data-base-state-name]").data("baseStateName");this.$q.all([this.ultraState.peekHref("grade-item.create",this.getInsertLocationData(),n),this.ultraState.peekHref("gradebook-item.calculation",this.getInsertLocationData(),n),this.ultraState.peekHref("attendance",null,n)]).then((e=>{this.attendanceHref=e[2],this.items=[{key:"addGradebookItem",href:e[0],className:"doc-add-grade",name:this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.grade.grader-column.actions.addItem"}),icon:d.createElement(h.Add,null)},{key:"addCalculation",href:e[1],className:"doc-add-calc",name:this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.grade.grader-column.actions.addCalculation"}),icon:d.createElement(h.Calculation,null)}],this.addOrRemoveAddAttendanceMenuItem()})),t.$on("always-show-time-expires",(()=>{t.addContentButton.alwaysShow=!1})),t.$on("update-content-menu",(()=>{this.items&&this.addOrRemoveAddAttendanceMenuItem()}))}addOrRemoveAddAttendanceMenuItem(){const e=null==this.scope.showAddAttendance||!this.scope.showAddAttendance(),t=this.doesMenuItemExistByKey(S);e?this.removeMenuItemByKey(S):t||this.addAttendanceMenuItem()}doesMenuItemExistByKey(e){return this.items.some((t=>t.key===e))}removeMenuItemByKey(e){this.items=this.items.filter((t=>t.key!==e))}addAttendanceMenuItem(){this.items.push({key:S,href:this.attendanceHref,className:"doc-add-attendance",name:this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.grade.grader-column.actions.addAttendance"}),icon:d.createElement(h.Attendance,null)})}};f.$inject=[],f=Object(s.a)([Object(s.c)(0,Object(c.b)("$injector")),Object(s.c)(1,Object(c.b)("scope")),Object(s.c)(2,Object(c.b)("element"))],f);var D=o("J8YL"),C=o("tTiy"),y=o("1Niw"),k=o("UeHE"),w=o("9hp7"),I=o("SE1T"),B=o("6xt4"),L=o("07HN");class E{constructor(e){this.$injector=e,this.handlersAndTemplateTexts={assignment:{handler:r,templateText:D},attempts:{handler:a,templateText:C},"bbml-editor":{handler:g,templateText:y},"cloud-upload":{handler:m.b,templateText:k},"course-group":{handler:b,templateText:I},"course-outline":{handler:v.a,templateText:B},grades:{handler:f,templateText:L}}}getTemplateText(e){if(null==e||!(e in this.handlersAndTemplateTexts))throw new Error("valid contextArea must be provided");if(null==this.handlersAndTemplateTexts[e].templateText)throw new Error("No template for context area: "+e);return w.replace("<template></template>",this.handlersAndTemplateTexts[e].templateText)}getHandler(e,t,o){if(null==e||!(e in this.handlersAndTemplateTexts))throw new Error("valid contextArea must be provided");return this.$injector.instantiate(this.handlersAndTemplateTexts[e].handler,{scope:t,element:o})}}E.$inject=["$injector"];var T=o("2E9T"),M=o("+e2k");const $="ultra.components.directives.content.buttonAddContent";class F{constructor(){this.restrict="C",this.template=T}}F.$inject=["$injector"],n.module($,[M.a]).directive("buttonAddContent",["$injector",e=>e.instantiate(F)]);var x=o("0JpG"),A=o("/z4E"),O=o("H/mg"),j=o("nYZ0"),H=o("jx5I"),P=o("3Jgm"),z=o("TnpK"),N=o("zYa8"),R=o("wtdm");const V="ultra.components.directives.bbUiIcon.small.ContentMarket";Object(N.a)(R.a,V,"bbUiIconSmallContentMarket"),o.d(t,"a",(function(){return K}));const K="ultra.directives.addContentButton";class _{constructor(e,t,o){this.$injector=e,this.$rootScope=t,this.ultraState=o,this.compiled=Object.create(null),this.restrict="E",this.scope={attachHandler:"=?",disableDrag:"&?",content:"=",createFunction:"=?",hideDividerLines:"&?",rootContent:"&?",contextArea:"=",alwaysShow:"=",showAddAttendance:"&?",showBothButtons:"&?",isDocumentSaved:"&?",showMenuOverride:"=",positionBefore:"&?",positionAfter:"&?",parentId:"&",depth:"&",canCreateAllContents:"=?",canCopyImport:"=?",folderNestedButton:"&?",fileLocation:"@?",webLocation:"@?",initialUpload:"&?",primaryKey:"&?",ignoredStates:"&?",itemName:"&?",itemType:"&?",itemIndex:"&?",isButtonLocationChangable:"<?",isRenderByDefault:"&?"},this.compile=()=>(e,t)=>{let o;o=e.contextArea?e.contextArea:e.$parent.contextArea?e.$parent.contextArea:"course-outline";const n=this.$injector.instantiate(E,{});null==this.compiled[o]&&(this.compiled[o]=this.$injector.get("$compile")(n.getTemplateText(o))),e.addContentButton=n.getHandler(o,e,t),e.fileListViewId="fileListView-"+Math.floor(1e4*Math.random())+"-"+Math.floor(1e4*Math.random()),e.fileListViewLocalId=e.fileListViewId+"Local",this.compiled[o](e,(function(e,o){t.append(e)})),this.$rootScope.$broadcast("add-content-button-ready")}}}_.$inject=["$injector","$rootScope",z.d,j.f,u.b],n.module(K,["ngAnimate",$,A.a,x.moduleName,O.a,j.d,u.a,H.a,P.a,z.b,p.a,V]).directive("bbAddContentButton",["$injector",e=>e.instantiate(_)])},ol3u:function(e,t){e.exports='<bb-modal class="notification"\n          modal-title-key="components.directives.cloudStorageIntegration.modal.authorizationRequiredTitle"\n          analytics-id-tag-prefix="components.directives.cloudStorageIntegration.authorizationRequired">\n  <div name="modal-contents">\n    <p bb-translate>components.directives.cloudStorageIntegration.modal.authorizationRequiredMessage</p>\n  </div>\n  <button name="modal-footer-button-primary" class="button dismiss-button js-primary-button" ng-click="$parent.$dismiss()" analytics-id="global.close">\n    <bb-translate>global.close</bb-translate>\n  </button>\n</bb-modal>\n'},qzMN:function(e,t,o){var n=o("ziER"),i=o("5JeM"),r=new n({id:"icon-small-content-collection",use:"icon-small-content-collection-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-content-collection"><path d="M14 15H2V9h3v1h6V9h3v6zM13 9V4H3v5M4 4V1h8v3" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(r);e.exports=r},tTiy:function(e,t){e.exports='<div class="discussion-assignment">\n  <button class="button-add-content js-show-add-options"\n          data-show-add-options ng-click="addContentButton.toggleMenu()"\n          ng-class="{hide: !(addContentButton.isButtonVisible || addContentButton.alwaysShow || addContentButton.isMenuVisible)}"\n          aria-expanded="{{addContentButton.isMenuVisible}}"\n          aria-controls="{{::\'add-content-menu-\' + addMenuId}}"\n          aria-label="{{addContentButton.addButtonAriaLabel}}"\n          ng-focus="addContentButton.showButton()"\n          ng-blur="addContentButton.hideButton()"\n          analytics-id="components.directives.add-content-button.attempts.button">\n  </button>\n  \x3c!-- use ng-show to keep the element when close add buttons, make sure the upload directive handlers will not be lost --\x3e\n  <ul role="menu" class="element-list-add-menu outline-menu angular-animate"\n      aria-expanded="{{addContentButton.isMenuVisible}}"\n      ng-attr-id="{{::\'add-content-menu-\' + addMenuId}}"\n      ng-if="::addContentButton.isMenuVisible || undefined"\n      ng-show="addContentButton.isMenuVisible">\n    <li>\n      <bb-file-upload\n        url="/v1/files"\n        data="{}"\n        monitor-leave="true"\n        allow-multiple="true"\n        target-div="{{\'#\' + fileListViewId}}"\n        disable-drag="disableDrag && disableDrag()"\n        hide-transclude-during-upload="false"  is-third-party-upload="false"\n        third-party-download-handler="addContentButton.downloadFile"\n        skip-zip-file-check="true">\n        <div class="columns medium-12" ng-class="{\'medium-center\': attempt.isMobile}">\n          <a href="javascript:void(0);"\n             role="menuitem"\n             bb-translate-attrs="{\'aria-label\':\'course.content.buildContentArea.addFiles\'}"\n             ng-click="addContentButton.toggleMenu()"\n             analytics-id="components.directives.add-content-button.attempts.fileUpload.link">\n            <bb-svg-icon size="small" icon="upload"></bb-svg-icon>\n            <span bb-translate>course.content.fileUpload.addFiles</span>\n          </a>\n        </div>\n      </bb-file-upload>\n    </li>\n  </ul>\n</div>\n'},tfx2:function(e,t,o){"use strict";o.d(t,"b",(function(){return u})),o.d(t,"a",(function(){return h}));var n=o("D57K"),i=o("ERkP"),r=(o("FwJ5"),o("nsO7")),a=o("dCrD"),s=o("Oyr+"),d=o("0x+l"),l=o("nmzr"),c=o("aHpC"),p=o("Y+9S");const u="show-cloud-upload-progress";let h=class extends a.a{constructor(e,t,o){if(super(e,t,o),this.scope=t,this.element=o,this.uploadFile=()=>{this.saveLocationForFileUpload(),this.element.find(".file-upload").click()},this.uploadCloudFile=()=>{this.saveLocationForFileUpload(),this.scope.isButtonLocationChangable&&this.scope.$emit(u,this.positionForFiles.positionAfter),this.element.find(".doc-add-media").click(),Object(p.o)(p.c.CloudStorageOpened)},this.openContentMarket=()=>this.getLocationData().then((e=>{this.ultraState.goPeekState(l.i.CONTENT_MARKET,e)})),this.initContextMenuItems(),t.$on("always-show-time-expires",(()=>{this.turnOffAlwaysShow()})),t.isButtonLocationChangable&&t.$on("change-add-content-button-position",((e,t)=>{t.reopen&&!this.isMenuVisible&&this.toggleOverflowMenu()})),t.$on(s.e,((e,o,n)=>{if(n===s.c.OutlineAddContentButtonFileSelected&&o===t.fileListViewLocalId){const e=this.positionForFiles||this.getInsertLocationData();this.closeMenu(),t.$emit(s.e,e.parentId,e.positionBefore,e.positionAfter,e.depth,o,t.content,s.c.AssignDropTarget),this.assignPosition()}})),this.scope.isRenderByDefault&&this.scope.isRenderByDefault()){const e=this.scope.$watch("addContentButton.isMenuVisible",(t=>{t&&(this.scope.addContentButton.removeDefaultRenderClass=!0,e())}))}this.scope.$watch("parentId()",((e,t)=>{e!==t&&this.initContextMenuItems()}))}toggleOverflowMenu(){this.initContextMenuItems().then((()=>{this.toggleMenu()})).catch((()=>{}))}initContextMenuItems(){const e=this.element.closest("[data-base-state-name]").data("baseStateName"),t=this.getInsertLocationData();return this.$q.all({isCloudServiceAvailable:this.isCloudServiceAvailablePromise,createHref:this.ultraState.peekHref(l.k.CREATE_CONTENT_PEEK_PANEL,t,e),copyHref:this.ultraState.peekHref(l.k.COPY_CONTENT_PEEK_PANEL,t,e),contentCollectionHref:this.ultraState.peekHref(l.h.CONTENT_COLLECTION,t,e)}).then((e=>{const t=this.bbLocalize.getLocale(this.scope);this.items=[{key:"create",className:"js-create",href:e.createHref,name:this.bbLocalize.translateSync({locale:t,key:"components.directives.add-content-button.create"}),icon:i.createElement(d.Add,null)},{key:"copy",className:"js-copy",href:e.copyHref,name:this.bbLocalize.translateSync({locale:t,key:"components.directives.add-content-button.copy"}),icon:i.createElement(d.Duplicate,null)},{key:"upload-file",className:"js-upload-file",onClick:this.uploadFile,name:this.bbLocalize.translateSync({locale:t,key:"components.directives.add-content-button.upload"}),icon:i.createElement(d.Upload,null)},{key:"upload-cloud-file",className:"js-upload-cloud-file",onClick:this.uploadCloudFile,name:this.bbLocalize.translateSync({locale:t,key:"components.directives.add-content-button.importContentFromCloudStorage.title"}),icon:i.createElement(d.UploadCloud,null)},{key:"content-market",className:"js-content-market",onClick:this.openContentMarket,name:this.bbLocalize.translateSync({locale:t,key:"components.directives.add-content-button.contentMarket"}),icon:i.createElement(d.ContentMarket,null)},{key:"content-collection",className:"js-content-collection",href:e.contentCollectionHref,name:this.bbLocalize.translateSync({locale:t,key:"components.directives.add-content-button.contentCollection"}),icon:i.createElement(d.ContentCollection,null)}],this.isCloudServiceAvailable||Object(r.remove)(this.items,(e=>"upload-cloud-file"===e.key)),this.currentCourse.canCopy()||Object(r.remove)(this.items,(e=>"copy"===e.key))}))}saveLocationForFileUpload(){this.scope.isButtonLocationChangable&&(this.positionForFiles=this.getInsertLocationData())}getLocationData(){const e=this.scope.rootContent(),t=this.getInsertLocationData();return this.contentSvc.getParentFolder(t.parentId,this.contextCourse.courseId,e).$asPromise().then((e=>{if(e.children){return{position:""+e.children.getInsertionIndex(t.positionBefore,t.positionAfter,!0,e.hasMoreChildren),parentId:t.parentId,positionBefore:t.positionBefore,positionAfter:t.positionAfter,depth:t.depth}}}))}};h.$inject=[],h=Object(n.a)([Object(n.c)(0,Object(c.b)("$injector")),Object(n.c)(1,Object(c.b)("scope")),Object(n.c)(2,Object(c.b)("element"))],h)},wKTs:function(e,t,o){var n=o("ziER"),i=o("5JeM"),r=new n({id:"icon-small-upload",use:"icon-small-upload-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-upload"><path d="M14 5h1v9H1V5h1M6 4l2-2 2 2M8 10V2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(r);e.exports=r}}]);