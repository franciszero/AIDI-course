(window.webpackJsonp=window.webpackJsonp||[]).push([[9,751],{"367g":function(t,i,s){},"4J8k":function(t,i,s){"use strict";s.d(i,"a",(function(){return n}));var e=s("zYa8"),a=s("dmkk");const n="ultra.components.directives.bbUiIcon.large.AvatarMultiple";Object(e.a)(a.a,n,"bbUiIconLargeAvatarMultiple")},"6sUD":function(t,i){t.exports='<div>\n  \x3c!-- Display a loading spinner if page is rendering --\x3e\n  <div class="telemetry-loading-anim" ng-if="telemetryPanelHeader.showSpinner">\n    <div class="spinner bb-secondary-color-2"/>\n  </div>\n  <header class="panel-header simple-header">\n    <div class="panel-titles-container">\n      <div class="panel-sub-title">{{ ::course().name }}</div>\n      <div class="black-header-contents">\n        <button class="left-off-canvas-toggle menu-toggle standard-button dark-background"\n                type="button"\n                analytics-id="components.directives.telemetry.panel.menu.button">\n          <bb-svg-icon size="small" icon="main-menu"></bb-svg-icon>\n          <span class="sr-only" bb-translate>components.directives.telemetry.panel.menu</span>\n        </button>\n        <h1 class="panel-title" ng-if="::titleKey" bb-translate>{{::titleKey}}</h1>\n        <h1 class="panel-title" ng-if="title">{{::title}}</h1>\n        \x3c!-- BUTTON 2 (displayed to the left of Button 1) --\x3e\n        <button ng-if="buttonTwoIcon" id="button-two"\n                aria-haspopup="true"\n                class="standard-button dark-background hide-for-large-up"\n                bb-translate-attrs="{\'aria-label\': buttonTwoAriaLabel,\'title\': buttonTwoTitle}"\n                ng-click="buttonTwoCallback()"\n                ng-class="{ \'active\': mobileStudentListVisible }"\n                analytics-id="components.directives.telemetry.panel.buttonwTwo.button">\n          <i class="{{ ::buttonTwoIcon }}"></i>\n          <span class="sr-only" bb-translate>buttonTwoTitle</span>\n        </button>\n        \x3c!-- BUTTON 1 (displayed on the far right) --\x3e\n        <button ng-if="buttonOneIcon"\n                id="button-one"\n                class="standard-button dark-background hide-for-large-up"\n                bb-translate-attrs="{\'aria-label\': buttonOneAriaLabel,\'title\': buttonOneTitle}"\n                ng-click="buttonOneCallback()"\n                analytics-id="components.directives.telemetry.panel.buttonOne.button">\n          <i class="{{ ::buttonOneIcon }}"></i>\n          <span class="sr-only" bb-translate>buttonOneTitle</span>\n        </button>\n      </div>\n    </div>\n  </header>\n</div>\n'},"8+lX":function(t,i,s){var e=s("ziER"),a=s("5JeM"),n=new e({id:"icon-small-replies",use:"icon-small-replies-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-replies"><path d="M1 5h14v10H1v-4" stroke-width="2" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round" /><path d="M3 3L1 5l2 2" stroke-width="2" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});a.add(n);t.exports=n},"9Ss5":function(t,i){t.exports='<div class="element-image avatar no-select" aria-hidden="true"\n     ng-class="[avatarsClasses, {\'alert-outline\': isWarningRender}]"\n     bb-load-bundle="components/directives/avatar" bb-cache-compilation="avatar">\n  <div class="avatar-inner" ng-if="isAvatarRender && (!autoUpdate || !autoUpdate())">\n    <div ng-if="::(!first && !second)" class="first avatar-single">\n      \x3c!-- If no user is set --\x3e\n      <div class="initials">\n        <bb-translate>components.directives.avatar.notAssignedInitials</bb-translate>\n      </div>\n    </div>\n\n    <div ng-if="::(first && first.avatarUrl)" class="first avatar-single image-avatar">\n      <img ng-src="{{::first.avatarUrl}}" bb-image-grayscale="{{::isGray()}}" alt="" analytics-id="analyticsIdTagPrefix ? {{::analyticsIdTagPrefix}}.firstAvatarImg : null">\n      \x3c!-- If first user is set and has avatar image --\x3e\n    </div>\n\n    <div ng-if="::(first && !first.avatarUrl && first.userInitials)"\n         class="first avatar-single {{::first.avatarBg}}">\n      \x3c!-- If first user is set, but does not have avatar image, but has non-CJK name Will still render default--\x3e\n      <img ng-src="{{::first.avatarUrl}}" bb-image-grayscale="{{::isGray()}}" alt="" analytics-id="analyticsIdTagPrefix ? {{::analyticsIdTagPrefix}}.firstAvatarImg : null">\n    </div>\n\n    <div ng-if="::(first && !first.avatarUrl && !first.userInitials)"\n         class="first avatar-single avatar-placeholder">\n      \x3c!-- If first user is set, but does not have avatar image and name contains CJK characters --\x3e\n      \x3c!-- Show default avatar image --\x3e\n      <img ng-if="::(!first.isMultiUser)" src="./static/images/avatar-placeholder.svg" bb-image-grayscale="{{::isGray()}}" alt="" analytics-id="analyticsIdTagPrefix ? {{::analyticsIdTagPrefix}}.firstAvatarImg : null">\n      <div class="multi-user-id" ng-if="::(first.isMultiUser)">\n        <bb-ui-icon-large-users></bb-ui-icon-large-users>\n      </div>\n    </div>\n\n    <div ng-if="::(second && second.avatarUrl && participants == 2)" class="second avatar-single image-avatar">\n      <img ng-src="{{second.avatarUrl}}" bb-image-grayscale="{{::isGray()}}" alt="" analytics-id="analyticsIdTagPrefix ? {{::analyticsIdTagPrefix}}.firstAvatarImg : null">\n      \x3c!-- If second user is set and has avatar image --\x3e\n    </div>\n\n    <div ng-if="::(second && !second.avatarUrl && participants == 2 && second.userInitials)"\n         class="second avatar-single {{::second.avatarBg}}">\n      \x3c!-- If second user is set, but does not have avatar image, but has non-CJK name. Will still render default --\x3e\n      <img ng-src="{{second.avatarUrl}}" bb-image-grayscale="{{::isGray()}}" alt="" analytics-id="analyticsIdTagPrefix ? {{::analyticsIdTagPrefix}}.secondAvatarImg : null">\n    </div>\n\n    <div ng-if="::(second && !second.avatarUrl && participants == 2 && !second.userInitials)"\n         class="second avatar-single avatar-placeholder">\n      \x3c!-- If second user is set, but does not have avatar image and name contains CJK characters --\x3e\n      \x3c!-- Show default avatar image --\x3e\n      <img ng-if="::(!second.isMultiUser)" src="./static/images/avatar-placeholder.svg" bb-image-grayscale="{{::isGray()}}" alt="" analytics-id="analyticsIdTagPrefix ? {{::analyticsIdTagPrefix}}.secondAvatarImg : null">\n      <div class="multi-user-id" ng-if="::(second.isMultiUser)">\n        <bb-ui-icon-large-avatar-multiple></bb-ui-icon-large-avatar-multiple>\n      </div>\n    </div>\n\n    <div ng-if="participants > 2" class="second avatar-single">\n      \x3c!-- If more than 2 participants involved, show `+3` type of avatar for right side --\x3e\n      \x3c!-- htmlhint:analytics-id:disable --\x3e\n      <div class="initials" analytics-id="analyticsIdTagPrefix ? {{::analyticsIdTagPrefix}}.twoPlusAvatar">\n        <bb-translate translate-values=\'{num: participants - 1}\' aria-hidden="true">components.directives.avatar.twoPlusInitials</bb-translate>\n      </div>\n      \x3c!-- htmlhint:analytics-id:enable --\x3e\n    </div>\n  </div>\n\n  <div class="avatar-inner" ng-if="isAvatarRender && autoUpdate && autoUpdate()">\n\n    <div ng-if="!first && !second" class="first avatar-single">\n      \x3c!-- If no user is set --\x3e\n      \x3c!-- htmlhint:analytics-id:disable --\x3e\n      <div class="initials" analytics-id="analyticsIdTagPrefix ? {{::analyticsIdTagPrefix}}.firstAvatarImg : null">\n        <bb-translate>components.directives.avatar.notAssignedInitials</bb-translate>\n      </div>\n      \x3c!-- htmlhint:analytics-id:enable --\x3e\n    </div>\n\n    <div ng-if="first && first.avatarUrl" class="first avatar-single image-avatar">\n      <img ng-src="{{first.avatarUrl}}" bb-image-grayscale="{{isGray()}}" alt="" analytics-id="analyticsIdTagPrefix ? {{::analyticsIdTagPrefix}}.firstAvatarImg : null">\n      \x3c!-- If first user is set and has avatar image --\x3e\n    </div>\n\n    <div ng-if="first && !first.avatarUrl && first.userInitials"\n         class="first avatar-single {{first.avatarBg}}">\n      \x3c!-- If first user is set, but does not have avatar image, but has non-CJK name --\x3e\n      \x3c!-- Show default image --\x3e\n      <img src="./static/images/avatar-placeholder.svg" bb-image-grayscale="{{isGray()}}" alt="" analytics-id="analyticsIdTagPrefix ? {{::analyticsIdTagPrefix}}.firstAvatarImg : null">\n    </div>\n\n    <div ng-if="first && !first.avatarUrl && !first.userInitials"\n         class="first avatar-single avatar-placeholder">\n      \x3c!-- If first user is set, but does not have avatar image and name contains CJK characters --\x3e\n      \x3c!-- Show default avatar image --\x3e\n      <img ng-if="::(!first.isMultiUser)" src="./static/images/avatar-placeholder.svg" bb-image-grayscale="{{isGray()}}" alt="" analytics-id="analyticsIdTagPrefix ? {{::analyticsIdTagPrefix}}.firstAvatarImg : null">\n      <div class="multi-user-id" ng-if="::(first.isMultiUser)">\n        <bb-ui-icon-large-avatar-multiple></bb-ui-icon-large-avatar-multiple>\n      </div>\n    </div>\n\n    <div ng-if="second && second.avatarUrl && participants == 2" class="second avatar-single image-avatar">\n      <img ng-src="{{second.avatarUrl}}" bb-image-grayscale="{{isGray()}}" alt="" analytics-id="analyticsIdTagPrefix ? {{::analyticsIdTagPrefix}}.secondAvatarImg : null">\n      \x3c!-- If second user is set and has avatar image --\x3e\n    </div>\n\n    <div ng-if="second && !second.avatarUrl && participants == 2 && second.userInitials"\n         class="second avatar-single {{second.avatarBg}}">\n      \x3c!-- If second user is set, but does not have avatar image, but has non-CJK name --\x3e\n      \x3c!-- Show default image --\x3e\n      <img src="./static/images/avatar-placeholder.svg" bb-image-grayscale="{{isGray()}}" alt="" analytics-id="analyticsIdTagPrefix ? {{::analyticsIdTagPrefix}}.secondAvatarImg : null">\n    </div>\n\n    <div ng-if="second && !second.avatarUrl && participants == 2 && !second.userInitials"\n         class="second avatar-single avatar-placeholder">\n      \x3c!-- If second user is set, but does not have avatar image and name contains CJK characters --\x3e\n      \x3c!-- Show default avatar image --\x3e\n      <img ng-if="::(!second.isMultiUser)" src="./static/images/avatar-placeholder.svg"  bb-image-grayscale="{{isGray()}}" alt="" analytics-id="analyticsIdTagPrefix ? {{::analyticsIdTagPrefix}}.secondAvatarImg : null">\n      <div class="multi-user-id" ng-if="::(second.isMultiUser)">\n        <bb-ui-icon-large-avatar-multiple></bb-ui-icon-large-avatar-multiple>\n      </div>\n    </div>\n\n    <div ng-if="participants > 2" class="second avatar-single">\n      \x3c!-- If more than 2 participants involved, show `+3` type of avatar for right side --\x3e\n      \x3c!-- htmlhint:analytics-id:disable --\x3e\n      <div class="initials" analytics-id="analyticsIdTagPrefix ? {{::analyticsIdTagPrefix}}.twoPlusAvatar : null">\n        <bb-translate translate-values=\'{num: participants - 1}\' aria-hidden="true">components.directives.avatar.twoPlusInitials</bb-translate>\n      </div>\n      \x3c!-- htmlhint:analytics-id:enable --\x3e\n    </div>\n  </div>\n</div>\n'},"Aw+3":function(t,i,s){var e=s("ziER"),a=s("5JeM"),n=new e({id:"icon-small-feedback",use:"icon-small-feedback-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-feedback"><path d="M1 1h14v12h-4l-3 2-3-2H1V1zM4 4h8M4 7h8M4 10h4" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});a.add(n);t.exports=n},ELoy:function(t,i,s){"use strict";s("px9Z"),s("GkCm");var e=s("Llzl"),a=s("lEL+"),n=s("6sUD");s.d(i,"a",(function(){return o}));const o="ultra.directives.telemetry.panel.header";class r{constructor(t,i){this.scope=t,this.timeout=i,this.showSpinner=!1,this.spinnerTimeout=this.timeout((()=>{this.showSpinner=!0}),this.scope,r.WAIT_TIME_TO_SHOW_SPINNER),this.scope.$watch("::panelDataLoaded()",(t=>{t&&this.dataLoaded()}))}dataLoaded(){this.timeout.cancel(this.spinnerTimeout),this.showSpinner=!1}}r.$inject=["scope",a.b],r.WAIT_TIME_TO_SHOW_SPINNER=1e3;class c{constructor(t){this.$injector=t,this.restrict="E",this.template=n,this.transclude=!0,this.scope={course:"&",panelDataLoaded:"&",titleKey:"@?",title:"@?",buttonOneIcon:"@",buttonOneCallback:"&",buttonOneAriaLabel:"@",buttonOneTitle:"@",buttonTwoIcon:"@",buttonTwoCallback:"&",buttonTwoAriaLabel:"@",buttonTwoTitle:"@"},this.link=t=>{t.telemetryPanelHeader=this.$injector.instantiate(r,{scope:t})}}}c.$inject=["$injector"],e.module(o,[]).directive("bbTelemetryPanelHeader",["$injector",t=>t.instantiate(c)])},GkCm:function(t,i,s){var e=s("ziER"),a=s("5JeM"),n=new e({id:"icon-small-main-menu",use:"icon-small-main-menu-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-main-menu"><path d="M1 3h14M15 8H1M1 13h14" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});a.add(n);t.exports=n},NMEb:function(t,i,s){"use strict";var e=s("Llzl");var a=class{static convertToGrayscale(t){const i=document.createElement("canvas"),s=i.getContext("2d"),e=t.naturalWidth,a=t.naturalHeight;i.width=e,i.height=a,s.drawImage(t,0,0);const n=s.getImageData(0,0,e,a);let o;const r=n.data.length;for(let t=0;t<r;t+=4)o=(n.data[t]+n.data[t+1]+n.data[t+2])/3,n.data[t]=o,n.data[t+1]=o,n.data[t+2]=o;return s.putImageData(n,0,0,0,0,n.width,n.height),i.toDataURL()}};s.d(i,"a",(function(){return n}));const n="ultra.components.directives.imageGrayscale";class o{constructor(t,i,s){this.scope=t,this.element=i,this.attributes=s;"true"===this.attributes.bbImageGrayscale&&c()&&i.one("load",this.onLoadCallback())}onLoadCallback(){return()=>{const t=a.convertToGrayscale(this.element[0]);this.element[0].src=t}}}class r{constructor(){this.restrict="A",this.link=(t,i,s)=>new o(t,i,s)}}function c(){const t=document.documentMode;return 10===t||11===t}const l=e.module(n,[]);c()&&l.directive("bbImageGrayscale",["$injector",t=>t.instantiate(r)])},Nyb7:function(t,i){t.exports='<div class="complex-statistic-contents"></div>'},SSV0:function(t,i,s){var e=s("ziER"),a=s("5JeM"),n=new e({id:"icon-small-accommodation",use:"icon-small-accommodation-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-accommodation"><circle cx="8" cy="8" r="7" stroke-width="2" /><path d="M4 6l1 2 5-3M12 10l-1-2-5 3" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});a.add(n);t.exports=n},SY8P:function(t,i,s){var e=s("Llzl");e.module("dibari.angular-ellipsis",[]).directive("ellipsis",["$timeout","$window","$sce",function(t,i,s){var a=function(i){var s=null,e=[];this.remove=function(i){-1!==e.indexOf(i)&&(e.splice(e.indexOf(i),1),0===e.length&&(t.cancel(s),s=null))},this.add=function(a){-1===e.indexOf(a)&&e.push(a),s||(s=t((function(){var t=e.slice();s=null,e.length=0,t.forEach((function(t){t()}))}),i))}},n=new a(0),o=new a(75);return{restrict:"A",scope:{ngShow:"=",ngBind:"=",ngBindHtml:"=",ellipsisAppend:"@",ellipsisAppendClick:"&",ellipsisSymbol:"@",ellipsisSeparator:"@",useParent:"@",ellipsisSeparatorReg:"=",ellipsisFallbackFontSize:"@"},compile:function(t,a,r){return function(t,a,r){function c(){var i=t.ngBind||t.ngBindHtml,n=!1;if(s.isEnabled()&&e.isObject(i)&&s.getTrustedHtml(i)&&(n=!0,i=s.getTrustedHtml(i)),i){var o=!t.ngBind&&!!t.ngBindHtml,c=0,d=void 0!==r.ellipsisSymbol?r.ellipsisSymbol:"&hellip;",p=void 0!==t.ellipsisSeparator?r.ellipsisSeparator:" ",u=void 0!==t.ellipsisSeparatorReg&&t.ellipsisSeparatorReg,h=void 0!==t.ellipsisAppend&&""!==t.ellipsisAppend?d+"<span class='angular-ellipsis-append'>"+t.ellipsisAppend+"</span>":d,m=u?i.match(u):i.split(p);if(r.isTruncated=!1,o?a.html(i):a.text(i),void 0!==r.ellipsisFallbackFontSize&&l(a)&&a.css("font-size",r.ellipsisFallbackFontSize),l(a,t.useParent)){var g=m.length,v=t.useParent?function(t){var i=0;return e.forEach(t.parent().children(),(function(s){s!=t[0]&&(i+=s.clientHeight)})),t.parent()[0].clientHeight-i}(a):a[0].clientHeight;for(o?a.html(i+h):a.text(i).html(a.html()+h),a.attr("data-overflowed","true");c<g;c++){var b=m.pop();if(0===m.length&&(m[0]=b.substring(0,Math.min(b.length,5))),o?a.html(m.join(p)+h):a.text(m.join(p)).html(a.html()+h),(t.useParent?a.parent()[0]:a[0]).scrollHeight<v||!1===l(a,t.useParent)){r.isTruncated=!0;break}}d!=h&&void 0!==t.ellipsisAppendClick&&""!==t.ellipsisAppendClick&&a.find("span.angular-ellipsis-append").bind("click",(function(i){t.$apply((function(){t.ellipsisAppendClick.call(t,{event:i})}))})),!n&&s.isEnabled()&&s.trustAsHtml(i)}else a.attr("data-overflowed","false")}}function l(t,i){return(t=i?t.parent():t)[0].scrollHeight>t[0].clientHeight}function d(){r.lastWindowResizeWidth==window.innerWidth&&r.lastWindowResizeHeight==window.innerHeight||c(),r.lastWindowResizeWidth=window.innerWidth,r.lastWindowResizeHeight=window.innerHeight}r.lastWindowResizeTime=0,r.lastWindowResizeWidth=0,r.lastWindowResizeHeight=0,r.lastWindowTimeoutEvent=null,r.isTruncated=!1,t.$watch("ngShow",(function(){n.add(c)})),t.$watch("ngBind",(function(){n.add(c)})),t.$watch("ngBindHtml",(function(){n.add(c)})),t.$watch("ellipsisAppend",(function(){c()})),t.$watch((function(){return 0!=a[0].offsetWidth&&0!=a[0].offsetHeight}),(function(){o.add(c)}));var p=t.$on("dibari:refresh-ellipsis",(function(){n.add(c)}));function u(){o.add(d)}var h=e.element(i);h.bind("resize",u),t.$on("$destroy",(function(){h.unbind("resize",u),n.remove(c),o.remove(d),p&&(p(),p=null)}))}}}}])},Tn43:function(t,i,s){"use strict";(function(t){s.d(i,"a",(function(){return S}));s("367g"),s("Aw+3"),s("8+lX"),s("aAQ7"),s("UyCM");var e=s("Llzl"),a=s("nsO7"),n=s("en1n"),o=s("0JpG"),r=s("suMx"),c=s("jciN"),l=s("+e2k"),d=s("+g6d"),p=s("TnpK"),u=s("g7Mf"),h=s("r6lH"),m=s("ELoy"),g=s("pjml"),v=s("f4B+"),b=s("nmzr"),f=s("fvgg"),y=s("yC9S"),P=s("Wqh6"),w=s("Y+9S"),I=s("IbyE"),N=s("50Q+");const S="ultra.components.directives.discussion";class x{constructor(t,i,s,e,n,o,r,c,l,d,p){this.$window=t,this.$sce=i,this.scope=s,this.element=e,this.$stateParams=n,this.$ngRedux=o,this.bbLocalize=r,this.telemetry=c,this.discussion=l,this.ultraState=d,this.courseModel=p,s.isLoaded=!1,s.courseId=s.content().courseId,s.contentId=s.content().id,s.isGroupDiscussion=s.content().isGroupContent,this.subscribeToReduxChanges(),this.loadOtherNameAsDisplayNameSystemPreference({key:N.g}),this.createDfiReport(s.courseId,s.contentId),y.b.OnWindow("resize",a.debounce((()=>{(this.scope.displayNonParticipants||this.scope.displayNonParticipantGroup)&&(this.updateNonParticipantView(),this.scope.$apply())}),150),s),this.notifyMobileApp()}notifyMobileApp(){var t;const i={type:w.c.DiscussionTelemetryOpened,status:w.b.Success,contentId:this.scope.contentId,contentTitle:this.scope.content().title,prevState:Object(w.i)(null===(t=this.ultraState.prev)||void 0===t?void 0:t.name)};Object(w.r)(i)}createDfiReport(t,i,s){(s?this.telemetry.loadDiscussionActivityData(t,i,s):this.telemetry.loadDiscussionActivityData(t,i)).then((t=>{this.scope.discussionData=t,this.scope.header=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.discussion.insights.header",params:{title:this.scope.content().title},noEscape:!0,noWrap:!0}),this.scope.course=this.courseModel.$find(this.scope.courseId),this.scope.isSingleGroup=!!s,this.scope.groups=this.scope.discussionData.groups,this.scope.isGradable=!!this.scope.discussionData.gradeColumnId,this.scope.gradingColumn=this.scope.discussionData.gradeColumnId,this.scope.viewedOnlyCount=this.scope.discussionData.viewedOnlyCount,this.scope.avgCommentsPerStudent=this.scope.discussionData.avgCommentsPerStudent?this.scope.discussionData.avgCommentsPerStudent:0,this.scope.avgWordCountPerComment=this.scope.discussionData.avgWordCountPerComment?this.scope.discussionData.avgWordCountPerComment:0,this.scope.avgGradeOfDiscussion=this.scope.discussionData.avgGrade?this.scope.discussionData.avgGrade/100:0,this.scope.numberOfCommentsToDisplay=1,this.scope.topComments=[],this.scope.displayTopComments=!1,this.scope.topParticipants=[],this.scope.displayTopParticipants=!1,this.scope.nonParticipants=[],this.scope.showNonparticipant=[],this.scope.showLargeNonparticipantPanel=!0,this.scope.minHeightForTopBoxes="auto",this.scope.nonParticipants=this.getNonParticipants(),this.scope.displayNonParticipants=!!this.scope.nonParticipants.length&&!this.scope.isGroupDiscussion,this.scope.displayNonParticipantGroups=!!this.scope.nonParticipants.length&&this.scope.isGroupDiscussion&&!this.scope.isSingleGroup,this.scope.displayNonParticipantGroup=!!this.scope.nonParticipants.length&&this.scope.isGroupDiscussion&&this.scope.isSingleGroup,this.scope.nonParticipantGroups=this.scope.displayNonParticipantGroups?this.getNonParticipantGroups():[],this.scope.totalNonParticipants=this.scope.nonParticipants.length,this.scope.totalParticipants=this.scope.discussionData.totalParticipants+this.scope.totalNonParticipants,this.scope.displayedNonParticipants=24,this.scope.additionalNonParticipants=this.scope.totalNonParticipants,this.scope.currentPanelWidth=0,this.scope.lastPanelWidth=-1,this.scope.isLoaded=!0;for(let t=0;t<this.scope.displayedNonParticipants;t++)this.scope.showNonparticipant[t]=!0;this.getTopComments(),this.getTopParticipants(),this.getParticipantBarChart(),this.updateNonParticipantView(),this.scope.statisticsConfig=this.getSummaryInsightNumbers(),this.scope.topCommentsColumns=this.scope.displayTopComments&&this.scope.displayTopParticipants?"small-12 medium-8 large-9":"small-12",this.scope.topParticipantColumns=this.scope.displayTopComments&&this.scope.displayTopParticipants?"small-12 medium-4 large-3":"small-12"}))}getSummaryInsightNumbers(){const t=this.bbLocalize.getLocale(this.scope),i=this.bbLocalize.translateSync({locale:t,key:"components.directives.discussion.insights.numParticipants"}),s=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.discussion.insights.formattedParticipation",params:{count:this.scope.totalParticipants-this.scope.totalNonParticipants,total:this.scope.totalParticipants},noWrap:!0}),e=this.bbLocalize.translateSync({locale:t,key:"components.directives.discussion.insights.avgComments"}),a=this.bbLocalize.translateSync({locale:t,key:"components.directives.discussion.insights.avgCount"}),n=this.bbLocalize.translateSync({locale:t,key:"components.directives.discussion.insights.avgGrade"}),o=this.scope.isGradable&&this.scope.avgGradeOfDiscussion>0?this.bbLocalize.formatPercentageSync(this.scope.avgGradeOfDiscussion,this.scope):this.bbLocalize.translateSync({locale:t,key:"components.directives.discussion.insights.na"}),r=[];return r.push({title:i,data:s}),r.push({title:e,data:this.bbLocalize.formatNumberSync(this.scope.avgCommentsPerStudent,this.scope).toString()}),this.scope.avgWordCountPerComment&&this.scope.avgWordCountPerComment>0&&r.push({title:a,data:this.bbLocalize.formatNumberSync(this.scope.avgWordCountPerComment,this.scope).toString()}),this.scope.isGradable&&r.push({title:n,data:o}),r}getParticipantBarChart(){let i=0,s=0,e=100;const a=this.scope.totalParticipants-this.scope.totalNonParticipants;this.scope.totalParticipants>0?(i=Math.floor((this.scope.totalParticipants-this.scope.totalNonParticipants)/this.scope.totalParticipants*100),s=Math.floor(this.scope.viewedOnlyCount/this.scope.totalParticipants*100),e=100-(i+s)):(i=0,s=0,e=100),t(".bar-chart .participated").attr("style","width: "+i+"%"),t(".bar-chart .opened").attr("style","width: "+s+"%"),t(".bar-chart .unopened").attr("style","width: "+e+"%");const n=this.scope.totalNonParticipants-this.scope.viewedOnlyCount;this.scope.barchartNonParticipants=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.discussion.insights.barchartNonParticipants",params:{count:n},noWrap:!0}),this.scope.barchartOpenedNonParticipants=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.discussion.insights.barchartOpenedNonParticipants",params:{count:this.scope.viewedOnlyCount},noWrap:!0}),this.scope.barchartParticipants=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.discussion.insights.barchartParticipants",params:{count:a},noWrap:!0}),this.scope.percentParticipatedCaption=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.discussion.insights.percentParticipated",params:{percent:this.bbLocalize.formatPercentageSync(i/100,this.scope)},noWrap:!0}),this.scope.percentOpenedCaption=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.discussion.insights.percentOpened",params:{percent:this.bbLocalize.formatPercentageSync((s+i)/100,this.scope)},noWrap:!0})}getNonParticipantGroups(){const t=[];return this.scope.nonParticipants.length>0&&e.forEach(this.scope.groups,(i=>{const s={id:i.id,name:i.name,nonParticipants:[],total:0,hidden:0};e.forEach(this.scope.nonParticipants,(t=>{(t=this.handlePreferredDisplayName(t)).group.id===i.id&&(t.localizedName=this.bbLocalize.formatUsernameSync(t,o.ILocaleUsernameFormat.Short,null,{noWrap:!0,noEscape:!0}),s.nonParticipants.push(t),s.total++)})),s.hidden=s.total>4?s.total-4:0,s.total>0&&t.push(s)})),t}getTopComments(){this.scope.numberOfCommentsToDisplay=n.k()?3:5,this.scope.discussionData.topComments.forEach((t=>{const i={user:this.handlePreferredDisplayName(t.user),message:v.a.text(t.message),messageId:t.messageId,numReplies:t.numReplies};i.user.localizedName=this.bbLocalize.formatUsernameSync(t.user,o.ILocaleUsernameFormat.Short,null,{noWrap:!0,noEscape:!0}),i.user.avatarData=t.user,this.scope.topComments.push(i),this.scope.displayTopComments=!0}))}getTopParticipants(){this.scope.discussionData.topParticipants.forEach((t=>{const i={user:this.handlePreferredDisplayName(t.user),numComments:t.numComments,numReplies:t.numReplies};i.user.localizedName=this.bbLocalize.formatUsernameSync(t.user,o.ILocaleUsernameFormat.Short,null,{noWrap:!0,noEscape:!0}),i.user.avatarData=t.user,this.scope.topParticipants.push(i),this.scope.displayTopParticipants=!0}))}getNonParticipants(){const t=[];return this.scope.discussionData.nonParticipants.forEach((i=>{i.avatarData=i,i.localizedName=this.bbLocalize.formatUsernameSync(this.handlePreferredDisplayName(i),o.ILocaleUsernameFormat.Short,null,{noWrap:!1,noEscape:!0}),i.localizedNameWithoutWrap=this.bbLocalize.formatUsernameSync(this.handlePreferredDisplayName(i),o.ILocaleUsernameFormat.Short,null,{noWrap:!0,noEscape:!0}),i.preferredDisplayName===o.PreferredDisplayName.Both&&(i.otherName=this.bbLocalize.formatUsernameSync({...i,preferredDisplayName:o.PreferredDisplayName.Other},o.ILocaleUsernameFormat.Brief,null,{noWrap:!0,noEscape:!0}),i.fullName=this.bbLocalize.formatUsernameSync({...i,preferredDisplayName:o.PreferredDisplayName.Given},o.ILocaleUsernameFormat.Short,null,{noWrap:!0,noEscape:!0})),t.push(i)})),t}toggleIndividualNonParticipantDisplay(){a.defer((()=>{let t=e.element("#discussion-insights").find(".non-participant-box").innerWidth()-30;t=t<1118?t:1118;const i=2*Math.ceil((t+20)/126);this.scope.displayedNonParticipants=0;for(let t=0;t<18;t++)t<i&&t<this.scope.totalNonParticipants?(this.scope.showNonparticipant[t]=!0,this.scope.displayedNonParticipants++):this.scope.showNonparticipant[t]=!1;this.scope.additionalNonParticipants=this.scope.totalNonParticipants>this.scope.displayedNonParticipants?this.scope.totalNonParticipants-this.scope.displayedNonParticipants:0,this.scope.nonParticipationSummary=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.discussion.insights.nonParticipationSummary",params:{count:this.scope.displayedNonParticipants,total:this.scope.totalNonParticipants},noWrap:!0}),this.setNonParticipantMargin(t)}))}setNonParticipantMargin(i){const s=t("li.non-participant"),e=Math.floor(i/126),a=126*e+106,n=e-1>0?20+(i-a-2)/e:20+i-a;t(s).css("margin-right",n),t(s[e]).css("margin-right","2px"),2*e+1<=s.length&&t(s[2*e+1]).css("margin-right","2px")}updateNonParticipantView(){const t=this.bbLocalize.getLocale(this.scope);this.scope.nonParticipantsOptions=this.bbLocalize.translateSync({locale:t,key:"components.directives.discussion.insights.nonparticipantsOptions"}),this.scope.numberOfCommentsToDisplay=n.k()?3:5,this.scope.currentPanelWidth=e.element("#discussion-insights").find(".non-participant-box").innerWidth(),this.scope.currentPanelWidth!==this.scope.lastPanelWidth&&(n.k()?this.scope.showLargeNonparticipantPanel=!1:(this.scope.showLargeNonparticipantPanel=!0,this.toggleIndividualNonParticipantDisplay())),this.scope.lastPanelWidth=this.scope.currentPanelWidth}getSafeHtml(t){return this.$sce.trustAsHtml(t)}hasNavScrollbar(){const t=e.element(".group-selector")[0];return!!(t&&t.scrollWidth>t.clientWidth)}goToDiscussion(t){t?(this.discussion.groupId=t,this.ultraState.goPeekState("discussion.view.with-grading",{contentId:this.scope.contentId,disGroupId:t,courseId:this.scope.courseId})):this.ultraState.goPeekState("discussion.view.with-grading",{contentId:this.scope.contentId,courseId:this.scope.courseId})}goToGrade(t){this.scope.isGradable&&!this.scope.isGroupDiscussion&&this.ultraState.goPeekState("submission-list",{columnId:this.scope.gradingColumn,participantId:t,contentId:this.scope.contentId})}goToMessage(t){this.ultraState.goPeekState(b.n.COURSE_MESSAGE,{courseId:this.scope.courseId,recipientIds:t})}isFocusedNonparticipant(i){return t(document.activeElement).is(e.element(t("a#non-participant-link-"+i)))}sortNamesAlphabetically(t){let i="";return t.sort(((t,i)=>t.givenName+t.familyName<i.givenName+i.familyName?-1:1)).forEach((t=>{i+=t.id+","})),i.slice(0,-1)}goToMessageAll(){const t=this.sortNamesAlphabetically(this.scope.nonParticipants);this.ultraState.goPeekState(b.n.COURSE_MESSAGE,{courseId:this.scope.courseId,recipientIds:t,conversationPerRecipient:!0})}updateDfiPanel(i,s,e){t(".group-selector .selected").removeClass("selected"),t(i.target).addClass("selected"),s?(this.discussion.groupId=s,this.scope.currentGroupId=s,this.scope.currentGroupName=e,this.createDfiReport(this.scope.courseId,this.scope.contentId,s),this.updateNonParticipantView()):(this.discussion.groupId=void 0,this.scope.currentGroupId=void 0,this.scope.currentGroupName=void 0,this.createDfiReport(this.scope.courseId,this.scope.contentId))}isPreferedNameBoth(t){return t.preferredDisplayName===o.PreferredDisplayName.Both}subscribeToReduxChanges(){const t=this.$ngRedux.connect((t=>({otherNameAsDisplayNameSystemPreference:I.Yb.systemPreference.getSystemPreferenceByKey(t,N.g)})),(t=>({loadOtherNameAsDisplayNameSystemPreference:i=>t(I.V.systemPreference.loadSystemPreference(i))})))(this);this.scope.$on("$destroy",t)}handlePreferredDisplayName(t){var i;return t&&(null===(i=this.otherNameAsDisplayNameSystemPreference)||void 0===i?void 0:i.value)&&(t.preferredDisplayName="Y"===this.otherNameAsDisplayNameSystemPreference.value?t.preferredDisplayName:void 0),t}}x.$inject=["$window","$sce","scope","element","$stateParams","$ngRedux",o.serviceName,h.b,u.c,p.d,g.m.serviceName];class k{constructor(t){this.$injector=t,this.restrict="EA",this.template=P,this.scope={content:"&"},this.link=(t,i,s)=>{t.discussionInsights=this.$injector.instantiate(x,{scope:t,element:i,attrs:s})}}}k.$inject=["$injector"],e.module(S,[r.a,c.a,l.a,f.a,d.a,h.a,m.a,p.b]).directive("bbDiscussionInsights",["$injector",t=>t.instantiate(k)])}).call(this,s("71td"))},UyCM:function(t,i,s){var e=s("ziER"),a=s("5JeM"),n=new e({id:"icon-small-messages",use:"icon-small-messages-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-messages"><path d="M1 3h14v10H1V3z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><path d="M1 3l7 7 7-7M1 13l5-5M15 13l-5-5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});a.add(n);t.exports=n},Wqh6:function(t,i){t.exports='<div class="panel-wrap telemetry-panel">\n  <bb-telemetry-panel-header title="{{header}}"\n                           course="course"\n                           panel-data-loaded="true">\n  </bb-telemetry-panel-header>\n\n  <nav class="group-selector" ng-class="{\'horizontal-scroll\': discussionInsights.hasNavScrollbar()}" ng-if="isGroupDiscussion">\n    <ul class="group-list">\n      <li class="group-item child-is-invokable"\n          bb-click-to-invoke-child="a.overall-link"\n          tabindex="0">\n        <a href="javascript:void(0);"\n           class="overall-link selected"\n           ng-click="discussionInsights.updateDfiPanel($event)"\n           bb-translate="components.directives.discussion.insights.overall"\n           analytics-id="components.directives.discussion.insights.overall">\n        </a>\n      </li>\n      <li class="group-item child-is-invokable"\n          bb-click-to-invoke-child="a.group-menu-link"\n          tabindex="0"\n          ng-repeat="group in ::groups">\n        <a href="javascript:void(0);"\n           class="group-menu-link"\n           ng-click="discussionInsights.updateDfiPanel($event, group.id, group.name)"\n           analytics-id="components.directives.discussion.insights.group.link">\n          {{group.name}}\n        </a>\n      </li>\n    </ul>\n  </nav>\n\n  <section id="discussion-insights" class="panel-content discussion-insights" bb-foundation-defer>\n    <div class="insights">\n      <div class="insight-summary row collapse summary-box">\n        <div class="column small-12">\n          <bb-statistics\n            config="statisticsConfig"\n            ng-if="isLoaded"\n            small-per-row="1"\n            large-per-row="4"></bb-statistics>\n        </div>\n      </div>\n\n      <div class="participation-chart-container">\n        <div class="bar-chart">\n          <span class="participated"\n                aria-label="{{barchartParticipants}}"\n                title="{{barchartParticipants}}"></span>\n          <span class="opened"\n                aria-label="{{barchartOpenedNonParticipants}}"\n                title="{{barchartOpenedNonParticipants}}"></span>\n          <span class="unopened"\n                aria-label="{{barchartNonParticipants}}"\n                title="{{barchartNonParticipants}}"></span>\n        </div>\n        <div class="legend">\n          <div class="participatedCaption" data-ng-bind-html="discussionInsights.getSafeHtml(percentParticipatedCaption)"></div>\n          <div class="openedCaption" data-ng-bind-html="discussionInsights.getSafeHtml(percentOpenedCaption)"></div>\n        </div>\n      </div>\n\n      <div class="non-participant-groups row" ng-if="displayNonParticipantGroups">\n        <div class="column small-12 non-participant-box clearfix" bb-foundation-defer>\n          <h3 class="stat-title large-non-participants-title"\n              bb-translate="components.directives.discussion.insights.groupNonParticipants"\n              translate-values="{count: totalNonParticipants}"></h3>\n          <div class="float-right">\n            <button class="button super-clear message-all-non-participants-button"\n                type="button"\n                ng-click="discussionInsights.goToMessageAll()"\n                bb-translate-attrs="{\'aria-label\': \'components.directives.discussion.insights.messageNonParticipants\'}"\n                translate-attrs-values="{count: totalNonParticipants}"\n                analytics-id="components.directives.discussion.insights.messageNonParticipants.button">\n              <bb-ui-icon-medium-messages></bb-ui-icon-medium-messages>\n            </button>\n          </div>\n\n          <div class="group-nonparticipants" ng-repeat="nonParticipantGroup in nonParticipantGroups track by nonParticipantGroup.id">\n            <div class="group-heading child-is-invokable" bb-click-to-invoke-child="a.group-link">\n              <a class="group-link"\n                 href="javascript:void(0);"\n                 ng-click="discussionInsights.goToDiscussion(nonParticipantGroup.id)"\n                 analytics-id="components.directives.discussion.insights.nonParticipantGroup.link">\n                {{nonParticipantGroup.name}}\n              </a>\n            </div>\n            <div class="nonparticipant-in-group-container"\n                 ng-class="nonParticipantGroup.total > 3 ? \'space-evenly\' : \'set-margin\' ">\n              <div class="nonparticipant-in-group child-is-invokable"\n                   bb-click-to-invoke-child="a.group-non-participant-link"\n                   ng-repeat="nonParticipant in nonParticipantGroup.nonParticipants | limitTo: 4 track by nonParticipant.id">\n                <bb-avatar user="nonParticipant"></bb-avatar>\n                <a class="group-non-participant-link"\n                   href="javascript:void(0);"\n                   aria-label="{{nonParticipant.localizedName}}"\n                   ng-click="discussionInsights.goToMessage(nonParticipant.id)"\n                   analytics-id="components.directives.discussion.insights.nonParticipant.link">\n                  {{nonParticipant.localizedName}}\n                </a>\n              </div>\n            </div>\n            <div class="count-link">\n              <a ng-click="discussionInsights.goToDiscussion(nonParticipantGroup.id)"\n                 ng-show="nonParticipantGroup.hidden > 0"\n                 href="javascript:void(0);"\n                 bb-translate="components.directives.discussion.insights.moreLink"\n                 translate-values="{count: nonParticipantGroup.hidden}"\n                 analytics-id="components.directives.discussion.insights.moreLink">\n              </a>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div class="non-participants row" ng-show="(displayNonParticipants || displayNonParticipantGroup)">\n        <div class="column small-12 non-participant-box clearfix" ng-if="showLargeNonparticipantPanel" bb-foundation-defer>\n          <h3 class="stat-title large-non-participants-title" bb-translate="components.directives.discussion.insights.nonParticipants"></h3>\n          <div class="float-right">\n            <button class="button super-clear message-all-non-participants-button"\n                type="button"\n                ng-click="discussionInsights.goToMessageAll()"\n                bb-translate-attrs="{\'aria-label\': \'components.directives.discussion.insights.messageNonParticipants\'}"\n                translate-attrs-values="{count: totalNonParticipants}"\n                analytics-id="components.directives.discussion.insights.messageNonParticipants.button">\n              <bb-ui-icon-medium-messages></bb-ui-icon-medium-messages>\n            </button>\n          </div>\n          <ul class="non-participant-list clearfix">\n            <li class="non-participant child-is-invokable"\n                bb-click-to-invoke-child="a.non-participant-link"\n                tabindex="-1"\n                ng-show="showNonparticipant[$index]"\n                ng-repeat="nonParticipant in nonParticipants | limitTo: 18 track by nonParticipant.id">\n              <div class="non-participant-cell"\n                   ng-class="{\'show-focus-outline\': discussionInsights.isFocusedNonparticipant(nonParticipant.id)}">\n                <a class="non-participant-link hide-focus-outline"\n                   bb-translate-attrs="{\'aria-label\':\'{{nonParticipant.localizedNameWithoutWrap}}\'}"\n                   id="non-participant-link-{{nonParticipant.id}}"\n                   tabindex="0"\n                   href="javascript:void(0);"\n                   ng-focus="true"\n                   ng-blur="true"\n                   ng-click="discussionInsights.goToMessage(nonParticipant.id)"\n                   analytics-id="components.directives.discussion.insights.nonParticipantLink.link">\n                  <bb-avatar class="non-participant-avatar" user="nonParticipant.avatarData"></bb-avatar>\n                </a>\n                <span ng-if="!discussionInsights.isPreferedNameBoth(nonParticipant)" class="byline stacked" ng-bind-html="discussionInsights.getSafeHtml(nonParticipant.localizedName)"></span>\n\n                <div ng-if="discussionInsights.isPreferedNameBoth(nonParticipant)">\n                  <span class="byline stacked stacked-other-name" ng-bind-html="discussionInsights.getSafeHtml(nonParticipant.otherName)"></span>\n                  <span class="byline stacked stacked-other-name" ng-bind-html="discussionInsights.getSafeHtml(nonParticipant.fullName)"></span>\n                </div>\n              </div>\n            </li>\n          </ul>\n          <label class="summary-line">{{nonParticipationSummary}}</label>\n        </div>\n        <div class="column small-12 non-participant-box clearfix" ng-if="!showLargeNonparticipantPanel">\n          <h3 class="stat-title subheader">{{barchartNonParticipants}}</h3>\n          <button class="messageAllButton button"\n                  bb-translate="components.directives.discussion.insights.messageAll"\n                  bb-translate-attrs="{\'aria-label\': \'components.directives.discussion.insights.messageAll\'}"\n                  ng-click="discussionInsights.goToMessageAll()"\n                  analytics-id="components.directives.discussion.insights.messageAll">\n          </button>\n        </div>\n      </div>\n\n      <div class="row equal-height" ng-if="displayTopComments || displayTopParticipants">\n        <div class="top-comments column {{topCommentsColumns}} student-list-box" ng-if="displayTopComments">\n          <h3 class="stat-title subheader"\n              id="most-replies-heading"\n              bb-translate="components.directives.discussion.insights.mostReplies"></h3>\n          <div class="tabular-list-container">\n            <div class="tabular-row top-comment-row child-is-invokable"\n                 bb-click-to-invoke-child="a.discussion-link"\n                 ng-class="{\'last\':$last}"\n                 ng-repeat="comment in topComments | limitTo: numberOfCommentsToDisplay | orderBy: \'-numReplies\'">\n              <a href="javascript:void(0);"\n                 class="discussion-link"\n                 ng-click="discussionInsights.goToDiscussion(comment.user.group.id)"\n                 aria-labelledby="comment-user-{{comment.user.id}} most-replies-heading"\n                 aria-describedby="comment-message-{{comment.user.id}}\n                 comment-replies-{{comment.user.id}}"\n                 analytics-id="components.directives.discussion.insights.goToDiscussion.link">\n                <bb-avatar class="top-participant-avatar" user="comment.user.avatarData"></bb-avatar>\n                <div class="comment-info">\n                  <div class="comment-message ellipsis" id="comment-message-{{comment.user.id}}">{{comment.message}}</div>\n                  <div class="byline ellipsis">\n                    <span id="comment-user-{{comment.user.id}}">\n                      <bb-translate>components.directives.discussion.insights.by</bb-translate> {{comment.user.localizedName}}\n                      <span ng-show="isGroupDiscussion"><bb-translate>components.directives.discussion.insights.inGroup</bb-translate> {{comment.user.group.name}}</span>\n                    </span> |\n                    <span id="comment-replies-{{comment.user.id}}"> {{comment.numReplies}} <bb-translate>components.directives.discussion.insights.replies</bb-translate></span>\n                  </div>\n                </div>\n              </a>\n            </div>\n          </div>\n        </div>\n        <div class="top-participants column {{topParticipantColumns}} student-list-box" ng-if="displayTopParticipants">\n          <h3 id="top-heading" class="stat-title subheader" bb-translate="components.directives.discussion.insights.topParticipants"></h3>\n          <div class="tabular-list-container">\n            <div class="tabular-row top-participants-row child-is-invokable"\n                 bb-click-to-invoke-child="a.grading-panel-link"\n                 ng-class="{\'last\':$last, \'not-graded\': (!isGradable || isGroupDiscussion), \'group-row\':isGroupDiscussion}"\n                 ng-repeat="participant in topParticipants | limitTo: numberOfCommentsToDisplay | orderBy: \'-numComments\'">\n              <a href="javascript:void(0);"\n                 class="grading-panel-link"\n                 aria-labelledby="user-{{participant.user.id}} top-heading"\n                 aria-describedby="span-replies-{{participant.user.id}} span-feedback-{{participant.user.id}}"\n                 ng-class="{\'not-graded\': (!isGradable || isGroupDiscussion)}"\n                 ng-click="discussionInsights.goToGrade(participant.user.id)"\n                 analytics-id="components.directives.discussion.insights.goToGrade.link">\n                <bb-avatar class="comment-avatar" user="participant.user.avatarData"></bb-avatar>\n                <div class="top-participant-info ellipsis" ng-class="{\'not-graded\': !isGradable}">\n                  <span class="discussion-insights-heading" id="user-{{participant.user.id}}">{{participant.user.localizedName}}</span><br>\n                  <span class="ellipsis" ng-show="isGroupDiscussion">{{participant.user.group.name}}</span><br ng-show="isGroupDiscussion">\n                  <span class="byline" id="span-feedback-{{participant.user.id}}">\n                    <bb-svg-icon class="top-participant-icon" size="small" icon="feedback" bb-translate-attrs="{\'aria-label\': \'components.directives.discussion.insights.feedback\'}"></bb-svg-icon>\n                    {{participant.numComments}}\n                  </span>\n                  <span class="byline" id="span-replies-{{participant.user.id}}">\n                  <bb-svg-icon class="top-participant-icon" size="small" icon="replies" bb-translate-attrs="{\'aria-label\': \'components.directives.discussion.insights.replies\'}"></bb-svg-icon>\n                    {{participant.numReplies}}\n                  </span>\n                </div>\n              </a>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    <div ui-view="telemetry-discussion-forum-insights-base@"></div>\n  </section>\n</div>\n'},c2Z8:function(t,i){t.exports='<div class="bb-statistics">\n  <ul class="statistics-list total-items-{{::statistics.total}} small-per-row-{{::statistics.smallPerRow}} large-per-row-{{::statistics.largePerRow}}">\n    <li ng-repeat="item in statistics.config">\n      <div class="statistics-item-container" ng-class="{\'no-default-padding\': item.noDefaultPadding, \'full-height\': !item.complexScope}">\n        <div class="stat-title" ng-attr-title="{{ item.hover ? item.hover : undefined }}" bb-translate>{{::item.title}}</div>\n        <div ng-if="::!item.complexScope" bb-simple-statistic item="::item"></div>\n        <div ng-if="::item.complexScope" bb-complex-statistic item="::item"></div>\n      </div>\n    </li>\n  </ul>\n</div>'},fvgg:function(t,i,s){"use strict";s.d(i,"a",(function(){return n}));var e=s("zYa8"),a=s("LxBy");const n="ultra.components.directives.bbUiIcon.medium.Messages";Object(e.a)(a.a,n,"bbUiIconMediumMessages")},jciN:function(t,i,s){"use strict";(function(t){s.d(i,"a",(function(){return m}));var e=s("D57K"),a=(s("SSV0"),s("Llzl")),n=s("PdQf"),o=s("g66W"),r=s("5MwF"),c=s("0JpG"),l=s("NMEb"),d=s("4J8k"),p=s("aHpC"),u=s("9Ss5"),h=s("VdDF");const m="ultra.directives.avatar";class g{constructor(t,i,s,e,a){this.scope=t,this.$element=i,this.attributes=s,this.bbLocalize=e,this.$timeout=a,this.backgroundColors=12;const n=this.scope.$watchGroup(["user.givenName","user.familyName","user.ui.displayName","user.avatar.permanentUrl","user","inactive()","isWarningRender"],(()=>{void 0!==this.scope.user&&(this.renderAvatars(),this.scope.autoUpdate&&this.scope.autoUpdate()||n())})),o=this.scope.$watchCollection("users",(()=>{this.scope.users&&(this.renderAvatars(),this.scope.autoUpdate&&this.scope.autoUpdate()||o())}))}getAvatarBG(t){return"default-avatar-"+(parseInt((t&&t.id||"0").replace(/[^\d]/g,""),10)%this.backgroundColors+1)}avatarParticipantsClass(t){switch(t){case 0:return"no-participants";case 1:return"one-participant";case 2:return"two-participants";default:return"two-plus-participants"}}canDisplayAvatarForUser(t){return!!t&&(!!(t.givenName||t.familyName||this.isAnonymousStudent(t))||!(!t.avatar||!t.avatar.permanentUrl||"default"===t.avatar.permanentUrl))}getInitials(t){return!t||this.isAnonymousStudent(t)||!t.givenName||!t.familyName||Object(o.g)(t.givenName)||Object(o.g)(t.familyName)||Object(o.h)(t.givenName)||Object(o.h)(t.familyName)?null:(t.givenName.charAt(0)+t.familyName.charAt(0)).toLowerCase()}buildAvatarData(t){const i={};if(!this.canDisplayAvatarForUser(t))return null;if(i.avatarBg=this.getAvatarBG(t),i.userInitials=this.getInitials(t),t.ui&&t.ui.displayName?i.username=t.ui.displayName:t.givenName||t.familyName||this.isAnonymousStudent(t)?this.bbLocalize.formatUsername(t,c.ILocaleUsernameFormat.Long,this.scope,{noWrap:!0,noEscape:!0}).then((t=>{i.username=t})):i.username=null,t.avatar&&t.avatar.permanentUrl&&"default"!==t.avatar.permanentUrl){if(/^https?/.test(t.avatar.permanentUrl)&&-1===t.avatar.permanentUrl.indexOf("ts=")){const i=(h.a.isValidDate(t.lastModifiedAt)?t.lastModifiedAt:new Date).getTime();t.avatar.permanentUrl=t.avatar.permanentUrl+(t.avatar.permanentUrl.indexOf("?")>=0?"&ts=":"?ts=")+encodeURIComponent(i)}i.avatarUrl=t.avatar.permanentUrl}return i.isMultiUser=Object(n.k)(t),i}isAnonymousStudent(t){if(t.isAnonymousStudent)return t.isAnonymousStudent()}renderAvatars(){let t=this.scope.users;if(!t&&this.scope.user&&(t=this.scope.user),a.isArray(t)||(t=null!=t?[t]:[]),0===t.length)return this.scope.first=null,this.scope.second=null,this.scope.participants=0,void(this.scope.isAvatarRender=!0);this.scope.participants=t.length,this.scope.avatarsClasses={},a.isDefined(this.scope.inactive)&&(this.scope.avatarsClasses.inactive=this.scope.inactive()),this.scope.avatarsClasses.inactive||(this.scope.avatarsClasses.outline=!0),!this.scope.avatarsClasses.inactive&&a.isDefined(this.scope.customizedActiveStyle)&&(this.scope.avatarsClasses.outline=!0,this.scope.avatarsClasses[this.scope.customizedActiveStyle]=!0),this.scope.avatarsClasses[this.avatarParticipantsClass(t.length)]=!0,this.scope.first=this.buildAvatarData(t[0]),2===t.length?this.scope.second=this.buildAvatarData(t[1]):t.length>2&&(this.scope.second={}),this.scope.isAvatarRender=!0}}let v=class{constructor(t,i){this.bbLocalize=t,this.$timeout=i,this.restrict="E",this.template=u,this.scope={user:"=?",inactive:"&?",users:"=?",autoUpdate:"&?",isGray:"&?",hasException:"&?",customizedActiveStyle:"@?",analyticsIdTagPrefix:"@",isWarningRender:"=?"},this.link=(t,i,s)=>new g(t,i,s,this.bbLocalize,this.$timeout)}};v=Object(e.a)([Object(e.c)(0,Object(p.b)(c.serviceName)),Object(e.c)(1,Object(p.b)("$timeout"))],v),r.a.features.newAvatar?a.module(m,[d.a]).directive("bbAvatar",["$compile",i=>({restrict:"E",scope:!1,priority:Number.MAX_VALUE,terminal:!0,link(s,e,a){const n=Object.prototype.hasOwnProperty.call(a,"users")?"bb-user-avatar-group":"bb-user-avatar",o=t(e[0].outerHTML.replace(/bb\-avatar/g,n));e.replaceWith(o),i(o)(s)}})]):a.module(m,[l.a,d.a]).directive("bbAvatar",["$injector",t=>t.instantiate(v)])}).call(this,s("71td"))},px9Z:function(t,i,s){},q1bP:function(t,i,s){s("Llzl");s("SY8P"),t.exports="dibari.angular-ellipsis"},r6lH:function(t,i,s){"use strict";s.d(i,"a",(function(){return h})),s.d(i,"b",(function(){return m}));var e=s("nsO7"),a=s("Llzl"),n=s("jhBu"),o=s("Sa5G"),r=s("ZQFV"),c=s("0JpG"),l=s("pjml"),d=s("wgY5"),p=s("nmzr"),u=s("+O05");const h="ultra.service.telemetry",m="telemetry";class g{constructor(t,i,s,e,a,n,o,r,c,l,d,p,u,h,m,g,v){this.cacheFactory=t,this.$q=i,this.entitlement=s,this.bbLocalize=e,this.ActivityVsGradeModel=a,this.ContentActivityInDetailModel=n,this.CourseActivityModel=o,this.CourseGradesModel=r,this.CourseNotificationsModel=c,this.MultimediaActivityInDetailModel=l,this.MultimediaStatisticsModel=d,this.NotificationUsers=p,this.StudentActivityModel=u,this.StudentGradesModel=h,this.SufficientDataModel=m,this.TelemetryDiscussionActivityModel=g,this.TelemetryDiscussionXrayModel=v,this.SUFFICIENT_DATA_KEY="SufficientData",this.sufficientDataCache=t.createCache("sufficientTelemetryData"),this.notificationsCache=t.createCache("notifications")}loadActivityVsGradeData(t){return this.ActivityVsGradeModel.$find(t).$allow([404]).$asPromise()}loadStudentGradeData(t,i){return this.StudentGradesModel.$find(t,i?{userId:i}:{}).$allow([404,400]).$asPromise()}loadCourseGradeData(t){return this.CourseGradesModel.$find(t).$allow([404,400]).$asPromise()}loadStudentActivityData(t,i){return this.StudentActivityModel.$find(t,i?{userId:i}:{}).$allow([400]).$asPromise()}loadContentActivityInDetailData(t,i){return this.ContentActivityInDetailModel.$collection().getContentActivityInDetail(t,i).$asPromise()}loadMultimediaActivityInDetailData(t,i){return this.MultimediaActivityInDetailModel.$collection().getMultimediaActivityInDetail(t,i).$asPromise()}loadMultimediaStatisticsData(t,i){return this.MultimediaStatisticsModel.getMultimediaStatistics(t,i).$asPromise()}loadCourseActivityData(t){return this.CourseActivityModel.$find(t).$allow([400]).$asPromise()}loadNotificationUsers(t,i,s){const a={};return i&&(a.limit=i),s&&(a.offset=s),this.NotificationUsers.$find(t,a).$asPromise().then((t=>e.keyBy(t.users,"userId")))}loadNotifications(t,i,s,e){return this.getNotificationsPromise(t,i,s,e).promise}loadDiscussionActivityData(t,i,s){return s?this.TelemetryDiscussionActivityModel.getDiscussionActivityReport(t,i,s).$asPromise():this.TelemetryDiscussionActivityModel.getDiscussionActivityReport(t,i).$asPromise()}loadDiscussionXrayReport(t,i,s){return this.TelemetryDiscussionXrayModel.getDiscussionXrayReport(t,i,s).$asPromise()}hasSufficientActivityData(t){return this.getSufficientDataPromise().promise.then((i=>!(!i||!i.coursesWithActivity)&&e.includes(i.coursesWithActivity,t)))}hasSufficientGradeData(t){return this.getSufficientDataPromise().promise.then((i=>!(!i||!i.coursesWithGrades)&&e.includes(i.coursesWithGrades,t)))}canViewAllUserData(t){return this.entitlement.hasCourseEntitlement(r.q.ViewGrades,t)}formatMessageRecipients(t){return(t||[]).map((t=>t.id)).join(",")}determineContentSupportsActivityData(t){const i=this.$q.defer();return u.a.isExternalSubmissionsAssessment(t)?i.resolve(!1):this.contentSupportsActivityData(t)?this.canViewAllUserData(t.courseId).then((t=>{i.resolve(t)})).catch((t=>{i.reject(t)})):i.resolve(!1),i.promise}contentSupportsActivityData(t){return(o.g.TestLink.isEqualTo(t.contentHandler)||o.g.UltraAssignment.isEqualTo(t.contentHandler))&&t.hasGradingColumn()}determinePanelSref(t,i){return this.canViewAllUserData(t).then((s=>s?this.createPanelSref(p.L.INSTRUCTOR_CLASS,t,i):this.createPanelSref(p.L.STUDENT_PROGRESS,t,i)))}createPanelSref(t,i,s){let e='({ courseId: "'+i+'"';return s&&(e+=', notificationId: "'+s+'"'),e+=" })",t.toString()+e}exportFilename(t,i,s,e,a){let n="";t&&(n=t.courseId+"_");const o=this.bbLocalize.formatDateSync(new Date,c.ILocaleDateFormat.ISO).replace(/[^0-9]/g,"");let r="";i&&s&&i.id!==s.id&&(r=i.userName+"_");const l=e?"_"+e:"";let d="";return a&&(d=a.replace(/\s+/g,"_")+"_"),n+r+d+o+l}getSufficientDataPromise(){let t=this.sufficientDataCache.get(this.SUFFICIENT_DATA_KEY);return t||(t={promise:this.SufficientDataModel.$new().$fetch().$allow([404,400]).$asPromise()},this.sufficientDataCache.put(this.SUFFICIENT_DATA_KEY,t)),t}getNotificationsPromise(t,i,s,e){const a=t+i+s+e;let n=this.notificationsCache.get(a);if(!n){const o={};i&&(o.userId=i),s&&(o.includeDismissed=s),e&&(o.notificationType=e),n={promise:this.CourseNotificationsModel.$find(t,o).$asPromise()},n.promise.then((t=>(t.currentStudent.forEach((t=>{t.ui={createdDay:d.utc(t.created).startOf("day").toDate()}})),t))),this.notificationsCache.put(a,n)}return n}}g.$inject=["DSCacheFactory","$q",n.b,c.serviceName,l.sb.serviceName,l.tb.serviceName,l.ub.serviceName,l.vb.serviceName,l.wb.serviceName,l.zb.serviceName,l.Ab.serviceName,l.Cb.serviceName,l.Db.serviceName,l.Eb.serviceName,l.Fb.serviceName,l.xb.serviceName,l.yb.serviceName];a.module(h,[l.N,n.a]).service(m,g)},suMx:function(t,i,s){"use strict";s("q1bP");var e=s("Llzl"),a=s("Nyb7");const n="ultra.components.directives.statistics.complexStatistic";class o{constructor(t,i,s){this.scope=t,this.element=i,this.$compile=s;const e=this.$compile(this.scope.item().complexTemplate)(this.scope.item().complexScope);i.append(e)}}o.$inject=["scope","element","$compile"];class r{constructor(t){this.$injector=t,this.replace=!0,this.restrict="A",this.template=a,this.scope={item:"&"},this.link=(t,i)=>{t.complexStatistic=this.$injector.instantiate(o,{scope:t,element:i})}}}r.$inject=["$injector"],e.module(n,[]).directive("bbComplexStatistic",["$injector",t=>t.instantiate(r)]);var c=s("zphb");const l="ultra.components.directives.statistics.simpleStatistic";class d{constructor(t,i){this.scope=t,this.$sce=i,this.scope.item().trusted=i.trustAsHtml(this.scope.item().data)}}d.$inject=["scope","$sce"];class p{constructor(t){this.$injector=t,this.replace=!0,this.restrict="A",this.template=c,this.scope={item:"&"},this.link=t=>{t.simpleStatistic=this.$injector.instantiate(d,{scope:t})}}}p.$inject=["$injector"],e.module(l,[]).directive("bbSimpleStatistic",["$injector",t=>t.instantiate(p)]);var u=s("c2Z8");s.d(i,"a",(function(){return h}));const h="ultra.components.directives.statistics";class m{constructor(t){this.scope=t,this.smallPerRow=t.smallPerRow()||1,this.largePerRow=t.largePerRow()||4,this.scope.$watch("config()",(t=>{t&&(this.config=t.length>10?t.slice(0,10):t,this.total=this.config.length)}))}}m.$inject=["scope"];class g{constructor(t){this.$injector=t,this.replace=!0,this.restrict="AE",this.template=u,this.scope={config:"&",smallPerRow:"&",largePerRow:"&"},this.link=t=>{t.statistics=this.$injector.instantiate(m,{scope:t})}}}g.$inject=["$injector"],e.module(h,["dibari.angular-ellipsis",n,l]).directive("bbStatistics",["$injector",t=>t.instantiate(g)])},zphb:function(t,i){t.exports='<div class="simple-statistic-contents" ng-class="::item().cssClass">\n  <div bb-tooltip enhanced-tooltip="true" data-tooltip-on-overflow-only="true" title="{{ ::item().data }}">\n    <div class="stat-data"\n         ng-attr-aria-label="{{ item().aria ? item().aria : undefined }}"\n         data-ng-bind-html="::item().trusted"\n         data-ellipsis></div>\n  </div>\n  <div ng-if="::item().subtext" class="stat-sub-text" bb-translate>{{ ::item().subtext }}</div>\n  <div ng-if="::!item().subtext && item().reserveSubtextSpace" class="stat-sub-text" aria-hidden="true">&nbsp;</div>\n</div>'}}]);