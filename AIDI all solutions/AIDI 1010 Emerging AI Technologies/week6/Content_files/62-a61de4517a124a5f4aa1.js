(window.webpackJsonp=window.webpackJsonp||[]).push([[62,87,88,163],{"0wep":function(t,n,e){"use strict";e.d(n,"a",(function(){return s}));var o=e("zYa8"),a=e("IEHd");const s="ultra.components.directives.bbUiIcon.large.Goal";Object(o.a)(a.a,s,"bbUiIconLargeGoal")},"1jPR":function(t,n){t.exports='\x3c!-- Goals--\x3e\n<div class="goal" ng-class="{\'goal-peek\': !openPeekPanel}">\n  <div class="row hide-for-small" ng-if="!openPeekPanel">\n    <div class="goal-panel">\n      <div class="goal-white-icon" >\n        <bb-svg-icon size="medium" icon="goal" bb-translate-attrs="{\'aria-label\': \'course.goal-alignment.goal.sr-only.goalImage\'}"></bb-svg-icon>\n      </div>\n      <div class="goal-head">\n        <h3 tabindex="-1" class="goal-title" bb-translate>course.goal-alignment.goal.header</h3>\n      </div>\n      <button class="button super-clear icon"\n              ng-click="hideGoals()"\n              analytics-id="course.goalAlignment.goal.closeGoals.button">\n        <i class="icon-times-bold"></i>\n        <span class="sr-only" bb-translate>course.goal-alignment.goal.sr-only.closeGoals</span>\n      </button>\n    </div>\n  </div>\n  <div class="goal-content-container">\n    <div class="row add-goal" ng-if="canAlignGoals() && !isCourseComplete()">\n      <a href="javascript:void(0);"\n         bb-focus="shouldFocus({elementId: \'add-goals\'})"\n         tabindex="0"\n         class="button button--dashed -full-width"\n         ng-if="!isMobile"\n         ng-click="addGoals()"\n         bb-translate\n         analytics-id="course.goal-alignment.goal.addGoalsButton">\n        course.goal-alignment.goal.addGoalsButton\n      </a>\n    </div>\n\n    <div class="goal-alignable-content"\n      ng-repeat="(contentIndex, content) in contents track by content.getContentIdForGoalAlignment()"\n      ng-class="[\'goal-aligned-content-\'+$index]"\n      ng-if="content.alignedGoals.length > 0">\n\n      <h3 class="goal-aligned-label"  ng-class="{\'goal-stu\': !(canAlignGoals() && !isCourseComplete())}">\n        <span>{{content.getContentTitleForGoalAlignment()}}</span>\n        <span bb-translate translate-values="{length: content.alignedGoals.length}">course.goal-alignment.goal.alignedGoalsLength</span>\n      </h3>\n\n      <ul class="goal-ul">\n        <li class="row goal-list" id="goal-{{::alignedGoal.goalId}}"\n            ng-repeat="alignedGoal in content.alignedGoals | orderBy: [\'(alignedGoal.content || content).getContentTitleForGoalAlignment()\', \'goal.goalTitle\', \'goal.goalText\'] track by (alignedGoal.goalId + (alignedGoal.content || content).getContentIdForGoalAlignment())">\n\n          <div class="columns small-12 single-goal"\n            ng-class="{\n              \'is-compacted\': !(alignedGoal.isShowDetails = alignedGoal.isShowDetails === undefined ? false:alignedGoal.isShowDetails),\n              \'goal-specific\': !(canAlignGoals() && !isCourseComplete())\n            }">\n            <div class="goal-icon">\n              <bb-ui-icon-large-goal color="primary" bb-translate-attrs="{\'aria-label\': \'course.goal-alignment.goal.sr-only.goalImage\'}"></bb-ui-icon-large-goal>\n            </div>\n            <div class="goal-description goal-details" ng-class="{\'goal-specific\': !(canAlignGoals() && !isCourseComplete())}">\n              <span class="goal-type js-goal-title" ng-class="{\'ellipse\':!alignedGoal.isShowDetails}">{{alignedGoal.goal.goalTitle}}</span>\n              <div class="goal-content-title" ng-class="{\'ellipse\':!alignedGoal.isShowDetails}" ng-bind="(alignedGoal.content || content).getContentTitleForGoalAlignment()"></div>\n              <span class="goal-content" ng-class="{\'ellipse\':!alignedGoal.isShowDetails}">{{alignedGoal.goal.goalText}}</span>\n              <div class="goal-category" ng-show="alignedGoal.isShowDetails">\n                <span class="goal-type" bb-translate>course.goal-alignment.goal.setAndCategory</span>\n                <span class="goal-category-title vertical-bar js-goal-set">{{alignedGoal.goal.goalSetTitle}}</span>\n                <span class="goal-category-title js-goal-category">{{alignedGoal.goal.goalCategoryTitle}}</span>\n              </div>\n              <button role="button"\n                      class="button anchor js-show-details"\n                      ng-click="alignedGoal.isShowDetails=!alignedGoal.isShowDetails"\n                      analytics-id="course.goalAlignment.goal.showDetails.button">\n                <span bb-translate ng-if="alignedGoal.isShowDetails" translate-attrs-values="{goalName: alignedGoal.goal.goalTitle}" bb-translate-attrs="{\'aria-label\': \'course.goal-alignment.goal.sr-only.showLess\'}">course.goal-alignment.goal.showLess</span>\n                <span bb-translate ng-if="!alignedGoal.isShowDetails" translate-attrs-values="{goalName: alignedGoal.goal.goalTitle}" bb-translate-attrs="{\'aria-label\': \'course.goal-alignment.goal.sr-only.showMore\'}">course.goal-alignment.goal.showMore</span>\n              </button>\n            </div>\n          </div>\n          <div bb-foundation-defer>\n            <bb-overflow-menu element-id="{{ generateControlId((alignedGoal.content || content), alignedGoal) + \'-\' + contentIndex }}"\n                              element-name="{{alignedGoal.goal.goalTitle}}"\n                              is-single-mode="true"\n                              menu-items="getOverflowMenuItems(content, alignedGoal)"\n                              analytics-id-tag-prefix="course.goal-alignment.goal.overflowMenu">\n            </bb-overflow-menu>\n          </div>\n        </li>\n      </ul>\n    </div>\n  </div>\n</div>\n'},"5Yfa":function(t,n,e){"use strict";e.d(n,"a",(function(){return o})),e.d(n,"b",(function(){return a})),e.d(n,"c",(function(){return s})),e.d(n,"e",(function(){return l})),e.d(n,"d",(function(){return i}));const o="bb-goal-selection-changed",a="bb-goal-alignment-saved",s="bb-goal-alignment-legacy-picker-saved";function l(t){return o+":"+t.getContentIdForGoalAlignment()}const i=({$scope:t,contents:n,goalCount:e})=>{0===t.goalAlignedContents.length&&(t.goalAlignedContents=n),t.alignedGoalsCount=e,t.alignedGoalsIsLoaded=!0}},"Dvh/":function(t,n){t.exports='<div>\n  <div ui-view="cloud-document-goal-peek"></div>\n  <div\n    class="goals-panel"\n    ng-class="{\'goals-panel-cloud-document\': cloudDocument.showGoalsSettings, \'active-panel\': cloudDocument.showGoalsSettings}"\n  >\n    <div ng-show="cloudDocument.showGoalsSettings">\n      <bb-goal-alignment\n        contents="cloudDocument.alignedGoals"\n        hide-goals="cloudDocument.hideGoals()"\n      ></bb-goal-alignment>\n    </div>\n  </div>\n  <div>\n    <content-cloud-document-settings\n      analytics-id="course.content.CloudDocument.edit"\n      course-id="cloudDocument.courseId"\n      content-id="cloudDocument.contentId"\n      add-goals="cloudDocument.addGoals"\n      aligned-goals-count="cloudDocument.alignedGoalsCount"\n      show-goals="cloudDocument.showGoals"\n      on-close="cloudDocument.onClose"\n      allow-conversations="cloudDocument.allowConversations"\n      show-assign-to-groups="cloudDocument.showAssignToGroups"\n      assign-to-groups="cloudDocument.assignToGroups"\n      group-content-started="cloudDocument.groupContentStarted"\n    />\n  </div>\n</div>\n'},"N/2L":function(t,n,e){"use strict";e.r(n),e.d(n,"moduleName",(function(){return w})),e.d(n,"directiveName",(function(){return f})),e.d(n,"controllerName",(function(){return $})),e.d(n,"CloudDocumentEditController",(function(){return A})),e.d(n,"Controller",(function(){return y}));var o=e("D57K"),a=e("1ZbL"),s=e("Llzl"),l=e("Dvh/");e.d(n,"template",(function(){return l}));var i=e("CY5M"),c=e("nYZ0"),r=e("Qbdf"),d=e("pjml"),g=e("TnpK"),u=e("IbyE"),h=e("UD9g"),m=e("5Yfa"),p=e("zGdY"),b=e("QyCV"),v=e("nmzr"),C=e("aHpC"),G=e("NxQJ");const w="CloudDocumentEditModule",f="contentCloudDocumentSettings",$="ultra.directives.content.CloudDocumentEdit.controller";let A=class{constructor(t,n,e,o,a,s,l,i){this.$scope=t,this.$q=n,this.$injector=e,this.$stateParams=o,this.contentService=a,this.currentCourse=s,this.ultraState=l,this.noGradeGoalAlignmentService=i,this.alignedGoals=[],this.showGoalsSettings=!1,this.afterUpdate=()=>{this.$scope.$root.$broadcast("content-update",this.content)},t.cloudDocument=this,this.contentId=o.contentId,this.courseId=o.courseId,this.course=this.currentCourse.course;const c=a.findRootNode(this.course,d.p.ContentRootNode.ROOT);this.contentService.getContentInContentTree(c,this.courseId,this.contentId).then((t=>{var n,e,o,a,s,l;this.content=t.content,this.showAssignToGroups=u.D.isGroupLaunchAllowed(this.content),this.allowConversations=!!(null===(n=this.content)||void 0===n?void 0:n.attachedForumLink),this.conversationService=this.$injector.instantiate(G.a,{currentCourse:this.course,coreContent:this.content}),this.groupContentStarted=null!==(s=null===(a=null===(o=null===(e=this.content)||void 0===e?void 0:e.contentDetail)||void 0===o?void 0:o[p.t.LtiLink])||void 0===a?void 0:a.groupContentStarted)&&void 0!==s&&s,(null===(l=this.content)||void 0===l?void 0:l.canEditAvailability())?i.resolveGoalAlignableContents().then((([t,n])=>{this.alignedGoalsCount=n,0===this.alignedGoals.length&&(this.alignedGoals=t)})):this.ultraState.leavePeekState()}));const r=t.$watch((()=>this.content),(t=>{t&&(this.$scope.$on(m.e(this.content),((t,n)=>{this.content.saveAlignedGoals(n).$then((()=>{this.alignedGoalsCount=n.length}))})),this.$scope.$root.$broadcast(m.b),r())}));this.assignToGroups=()=>{this.ultraState.goPeekState(v.y.VIEW,{groupCourseId:this.courseId,groupContentId:this.contentId})},this.addGoals=()=>{this.ultraState.goPeekState(v.H.Goals.ADD_GOALS,{goalAlignableContent:this.content})},this.showGoals=()=>{this.$scope.$apply((()=>{this.showGoalsSettings=!0}))},this.hideGoals=()=>{this.showGoalsSettings=!1},this.onClose=(t,n,e)=>{this.content.description=t.description,e&&(this.content.assignedGroups=t.assignedGroups,this.content.isGroupContent=t.isGroupContent),this.content.ui.hasConversationAttached=this.content.allowConversations=n,this.conversationService.markAllConversationsForRemoval(),this.content.$patch().$asPromise().then((()=>this.conversationService.checkAndAddAllConversations())).then((()=>{this.afterUpdate(),e||this.ultraState.leavePeekState()}))}}};A=Object(o.a)([Object(o.c)(0,Object(C.b)("$scope")),Object(o.c)(1,Object(C.b)("$q")),Object(o.c)(2,Object(C.b)("$injector")),Object(o.c)(3,Object(C.b)("$stateParams")),Object(o.c)(4,Object(C.b)(c.f)),Object(o.c)(5,Object(C.b)(r.e)),Object(o.c)(6,Object(C.b)(g.d)),Object(o.c)(7,Object(C.b)(h.c))],A);class y extends A{}const k={Class:i.d,renderLocalized:!0,withProvider:!0,attributes:["analyticsId"],bindingNames:["courseId","contentId","addGoals","alignedGoalsCount","showGoals","onClose","allowConversations","showAssignToGroups","assignToGroups","groupContentStarted"]};s.module(w,[b.a]).controller($,A).component(f,Object(a.a)(k))},NxQJ:function(t,n,e){"use strict";e.d(n,"c",(function(){return i})),e.d(n,"a",(function(){return c})),e.d(n,"b",(function(){return r}));var o=e("Llzl"),a=e("pjml"),s=e("Sa5G"),l=e("fYJU");const i="ultra.components.services.courseContent.conversation";class c{constructor(t,n,e,o,a){this.currentCourse=t,this.coreContent=n,this.$q=e,this.$rootScope=o,this.contextUser=a}checkAndAddAllConversations(){const t=this.$q.defer();return this.coreContent.ui.hasConversationAttached&&!this.coreContent.attachedForumLink?(this.conversationContent=this.coreContent,this.isCourseAvailable=this.coreContent.isAvailable,this.conversationContent.forumAttacherAction=a.p.ForumAttacherAction.Add.toUpperCase(),this.conversationContent.withParams({fields:"attachedForumLink"}).$patch().$then((n=>{this.currentCourse.contents.$find(n.attachedForumLink["resource/x-bb-courselink"].courseContent).$asPromise().then((t=>this.createNewDiscussion(t))),t.resolve()}))):t.resolve(),t.promise}markAllConversationsForRemoval(){this.coreContent.ui.hasConversationAttached||this.coreContent.allowConversations||!this.coreContent.attachedForumLink||(this.coreContent.attachedForumLink=null,this.coreContent.forumAttacherAction=a.p.ForumAttacherAction.Delete.toUpperCase())}createNewDiscussion(t){const n=t.contentDetail[s.g.Discussion.handle].id,e=this.currentCourse.forums.$find(n);e.messages.$fetch().$then((o=>{if(o){const t=o.find((t=>!t.groupId));if(t)return t}return e.messages.$build({forumId:n,courseId:t.courseId,parentId:"{unset id}",userId:this.contextUser.userId,postedName:this.contextUser.userModel.userName,body:{rawText:"",displayText:""},isDeleted:!1,isAvailable:!0}).$save().$asPromise()})).$then((()=>this.initializeDiscussionStatus()))}initializeDiscussionStatus(){this.coreContent&&(this.coreContent.ui.hasConversationAttached=!0,this.coreContent.attachedForumLink&&this.currentCourse.contents.$find(this.coreContent.attachedForumLink["resource/x-bb-courselink"].courseContent).$then((t=>{const n=t.contentDetail[s.g.Discussion.handle].id;this.currentCourse.forums.$find(n).$then((t=>{t.messages.$fetch().$then((t=>{const n=t[0];n&&(n.ui.replyText="")}))}))}))),this.conversationContent.isAvailable=this.isCourseAvailable,this.conversationContent.$patch().$then((t=>{this.coreContent=t}))}static showConversations(t){return!(!t||!t.id)&&(void 0===(t.ui&&t.ui.hasConversationAttached)&&(t.ui.hasConversationAttached=null!=t.attachedForumLink),t.ui.hasConversationAttached)}}c.$inject=["currentCourse","coreContent","$q","$rootScope",l.b];class r extends c{}o.module(i,[a.N,l.a]).service("courseContentConversation",c)},QyCV:function(t,n,e){"use strict";e("q1bP"),e("sZYy"),e("dV61");var o=e("nsO7"),a=e("Llzl"),s=e("Qbdf"),l=e("5Yfa"),i=e("0JpG"),c=e("JNtI"),r=e("TnpK"),d=e("gkef"),g=e("1jPR"),u=e("0wep");e.d(n,"a",(function(){return h}));const h="ultra.components.directives.bbGoalAlignment";class m{constructor(t,n,e,s,i){this.$injector=t,this.contextCourse=n,this.localize=e,this.ultraState=s,this.windowSize=i,this.scope={contents:"=",hideGoals:"&",shouldFocus:"&"},this.restrict="E",this.template=g,this.link=(t,n,e)=>{a.extend(t,{generateControlId:(t,n)=>`x-${t.getContentIdForGoalAlignment()}-${n.goalId}`.replace(/[\.;]/g,"-"),openPeekPanel:!!e.openPeekPanel&&t.$eval(e.openPeekPanel),canAlignGoals:()=>t.primaryContent.isCurrentUserEligibleToAlignGoals(),addGoals:()=>{this.ultraState.goPeekState("goal-picker-legacy",{goalAlignableContent:t.primaryContent})},deleteGoal:(n,e)=>{o.remove(n.alignedGoals,(t=>t===e));const a=e.content||n;o.remove(a.alignedGoals,(t=>t.goalId===e.goalId));const s=o.compact(a.alignedGoals.map((t=>t.goal)));t.$root.$broadcast(l.a,a,s),t.$root.$broadcast(l.e(a),s)},isCourseComplete:()=>this.contextCourse.course&&this.contextCourse.course.isComplete(),isMobile:window.Modernizr.touch&&!this.windowSize.isLargeBreakpoint(),getOverflowMenuItems:(n,e)=>[{icon:"trash",labelKey:"global.delete",ariaLabel:()=>this.localize.translateSync({locale:this.localize.getLocale(t),key:"course.goal-alignment.goal.sr-only.delete",params:{goalName:e.goal.goalTitle},noWrap:!0}),show:()=>e.content&&e.content.isCurrentUserEligibleToAlignGoals&&e.content.isCurrentUserEligibleToAlignGoals()&&!t.isCourseComplete(),onClick:()=>{t.deleteGoal(n,e)},confirmationOptions:c.a("x-bb-delete-goal-alignment")}]});let s=a.noop;const i=function(){const n={title:"",alignedGoals:[],isCurrentUserEligibleToAlignGoals:()=>!1,getContentIdForGoalAlignment:()=>"x"};t.primaryContent=(t.contents||[n])[0]||n,t.primaryContent!==n&&t.$root.$broadcast("EVENT_GOAL_PICKER_RESTORE",t.primaryContent),s(),s=t.$on(l.c,((n,e)=>{const a=t.primaryContent.coreContent||t.primaryContent,s=o.zipObject(a.alignedGoals.map((t=>t.goalId)),a.alignedGoals),i=e.sort(((t,n)=>t.goalTitle.localeCompare(n.goalTitle))).map((t=>Object.prototype.hasOwnProperty.call(s,t.id)?s[t.id]:{goalId:t.id,isVisibleToStudent:!0,goal:t,content:a}));t.primaryContent.alignedGoals=i,t.primaryContent.coreContent&&(t.primaryContent.coreContent.alignedGoals=i),t.$root.$broadcast(l.a,a,e),t.$root.$broadcast(l.e(a),e)}))};t.$watch("contents",i),i()}}}m.$inject=["$injector",s.e,i.serviceName,r.d,d.b],a.module(h,[d.a,"dibari.angular-ellipsis",i.moduleName,c.b,u.a]).directive("bbGoalAlignment",["$injector",t=>t.instantiate(m)])},sZYy:function(t,n,e){var o=e("ziER"),a=e("5JeM"),s=new o({id:"icon-medium-goal",use:"icon-medium-goal-usage",viewBox:"0 0 24 24",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-medium-goal"><path stroke-width="2" stroke-linecap="round" stroke-linejoin="round" d="M1 1h22v4H1zM6 20h12v3H6z" /><path d="M10 14v6M14 14v6" stroke-width="2" /><path d="M4 5c0 6 3 9 8 9s8-3 8-9" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><path d="M4 8H1c0 9.5 9 9 9 9M20 8h3c0 9.5-9 9-9 9" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});a.add(s);t.exports=s}}]);