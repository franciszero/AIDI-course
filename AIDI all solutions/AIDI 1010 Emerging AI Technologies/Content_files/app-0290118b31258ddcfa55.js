!function(e){function t(t){for(var a,i,o=t[0],l=t[1],c=t[2],d=0,m=[];d<o.length;d++)i=o[d],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&m.push(r[i][0]),r[i]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);for(u&&u(t);m.length;)m.shift()();return s.push.apply(s,c||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],a=!0,i=1;i<n.length;i++){var l=n[i];0!==r[l]&&(a=!1)}a&&(s.splice(t--,1),e=o(o.s=n[0]))}return e}var a={},i={268:0,568:0},r={268:0,568:0},s=[];function o(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.e=function(e){var t=[];const n=function(n){i[e]?t.push(i[e]):0!==i[e]&&{0:1,1:1,2:1,3:1,4:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,14:1,15:1,16:1,17:1,18:1,20:1,21:1,23:1,24:1,25:1,26:1,27:1,28:1,29:1,30:1,31:1,33:1,34:1,37:1,39:1,40:1,41:1,43:1,45:1,47:1,48:1,49:1,51:1,52:1,53:1,55:1,58:1,59:1,60:1,63:1,64:1,65:1,66:1,67:1,70:1,71:1,72:1,74:1,75:1,76:1,77:1,81:1,82:1,83:1,84:1,85:1,86:1,87:1,88:1,89:1,90:1,92:1,94:1,95:1,97:1,98:1,102:1,105:1,140:1,141:1,142:1,143:1,144:1,145:1,146:1,148:1,150:1,151:1,152:1,153:1,154:1,156:1,157:1,158:1,159:1,160:1,161:1,163:1,165:1,168:1,169:1,170:1,172:1,173:1,572:1,573:1,574:1,575:1,576:1,577:1,578:1,579:1,580:1,581:1,582:1,583:1,584:1,585:1,586:1,587:1,588:1,589:1,590:1,591:1,592:1,593:1,594:1,595:1,596:1,597:1,598:1,599:1,600:1,601:1,602:1,603:1,604:1,606:1,607:1,608:1,609:1,610:1,611:1,612:1,613:1,614:1,615:1,616:1,617:1,618:1,619:1,620:1,621:1,622:1,623:1,624:1,625:1,627:1,628:1,629:1,630:1,631:1,632:1,633:1,634:1,635:1,636:1,637:1,638:1,639:1,640:1,642:1,643:1,644:1,645:1,646:1,647:1,648:1,649:1,650:1,651:1,653:1,654:1,656:1,659:1,660:1,661:1,662:1,663:1,664:1,665:1,668:1,669:1,670:1,671:1,672:1,673:1,674:1,675:1,676:1,677:1,678:1,679:1,681:1,682:1,685:1,686:1,687:1,688:1,689:1,690:1,691:1,692:1,693:1,694:1,697:1,698:1,699:1,700:1,701:1,703:1,705:1,708:1,709:1,710:1,711:1,715:1,716:1,748:1,749:1}[e]&&t.push(i[e]=new Promise((function(t,n){var a=e+"-0290118b31258ddcfa55.css";a="rtl"===document.getElementsByTagName("html")[0].getAttribute("dir")?a.replace(".css",".rtl.css"):a;for(var r=o.p+a,s=document.getElementsByTagName("link"),l=0;l<s.length;l++){var c=(u=s[l]).getAttribute("data-href")||u.getAttribute("href");if("stylesheet"===u.rel&&(c===a||c===r))return t()}var d=document.getElementsByTagName("style");for(l=0;l<d.length;l++){var u;if((c=(u=d[l]).getAttribute("data-href"))===a||c===r)return t()}var m=document.createElement("link");m.rel="stylesheet",m.type="text/css";m.onerror=m.onload=function(a){if(m.onerror=m.onload=null,"load"===a.type)t();else{var s=a&&("load"===a.type?"missing":a.type),o=a&&a.target&&a.target.href||r,l=new Error("Loading CSS chunk "+e+" failed.\n("+o+")");l.code="CSS_CHUNK_LOAD_FAILED",l.type=s,l.request=o,delete i[e],m.parentNode.removeChild(m),n(l)}},m.href=r,document.head.appendChild(m)})).then((function(){i[e]=0})))};document.getElementsByTagName("html")[0].hasAttribute("has-applied-locale-text-direction")?n():document.addEventListener("initializePageDirection",n);var a=r[e];if(0!==a)if(a)t.push(a[2]);else{var s=new Promise((function(t,n){a=r[e]=[t,n]}));t.push(a[2]=s);var l,c=document.createElement("script");c.charset="utf-8",c.timeout=120,o.nc&&c.setAttribute("nonce",o.nc),c.src=function(e){return o.p+""+({37:"institution-page",81:"courses",107:"locale-ar-sa",108:"locale-az-az",109:"locale-cs-cz",110:"locale-cy-gb",111:"locale-da-dk",112:"locale-de-de",113:"locale-en",114:"locale-en-au",115:"locale-en-gb",116:"locale-en-us-k12",117:"locale-en-us-pro",118:"locale-es-es",119:"locale-fr-ca",120:"locale-fr-fr",121:"locale-he-il",122:"locale-it-it",123:"locale-ja-jp",124:"locale-ko-kr",125:"locale-ms-my",126:"locale-nb-no",127:"locale-nl-nl",128:"locale-nn-no",129:"locale-pl-pl",130:"locale-pt-br",131:"locale-pt-pt",132:"locale-ru-ru",133:"locale-sv-se",134:"locale-th-th",135:"locale-tr-tr",136:"locale-uk-ua",137:"locale-zh-cn",138:"locale-zh-tw",269:"app_develop",270:"cldrdata-ar",271:"cldrdata-ar-001",272:"cldrdata-ar-AE",273:"cldrdata-ar-BH",274:"cldrdata-ar-DJ",275:"cldrdata-ar-DZ",276:"cldrdata-ar-EG",277:"cldrdata-ar-EH",278:"cldrdata-ar-ER",279:"cldrdata-ar-IL",280:"cldrdata-ar-IQ",281:"cldrdata-ar-JO",282:"cldrdata-ar-KM",283:"cldrdata-ar-KW",284:"cldrdata-ar-LB",285:"cldrdata-ar-LY",286:"cldrdata-ar-MA",287:"cldrdata-ar-MR",288:"cldrdata-ar-OM",289:"cldrdata-ar-PS",290:"cldrdata-ar-QA",291:"cldrdata-ar-SA",292:"cldrdata-ar-SD",293:"cldrdata-ar-SO",294:"cldrdata-ar-SS",295:"cldrdata-ar-SY",296:"cldrdata-ar-TD",297:"cldrdata-ar-TN",298:"cldrdata-ar-YE",299:"cldrdata-bg",300:"cldrdata-bg-BG",301:"cldrdata-ca",302:"cldrdata-ca-AD",303:"cldrdata-ca-ES",304:"cldrdata-ca-ES-VALENCIA",305:"cldrdata-ca-FR",306:"cldrdata-ca-IT",307:"cldrdata-cs",308:"cldrdata-cs-CZ",309:"cldrdata-cy",310:"cldrdata-cy-GB",311:"cldrdata-da",312:"cldrdata-da-DK",313:"cldrdata-da-GL",314:"cldrdata-dav",315:"cldrdata-dav-KE",316:"cldrdata-de",317:"cldrdata-de-AT",318:"cldrdata-de-BE",319:"cldrdata-de-CH",320:"cldrdata-de-DE",321:"cldrdata-de-LI",322:"cldrdata-de-LU",323:"cldrdata-en",324:"cldrdata-en-001",325:"cldrdata-en-150",326:"cldrdata-en-AG",327:"cldrdata-en-AI",328:"cldrdata-en-AS",329:"cldrdata-en-AU",330:"cldrdata-en-BB",331:"cldrdata-en-BE",332:"cldrdata-en-BM",333:"cldrdata-en-BS",334:"cldrdata-en-BW",335:"cldrdata-en-BZ",336:"cldrdata-en-CA",337:"cldrdata-en-CC",338:"cldrdata-en-CK",339:"cldrdata-en-CM",340:"cldrdata-en-CX",341:"cldrdata-en-DG",342:"cldrdata-en-DM",343:"cldrdata-en-ER",344:"cldrdata-en-FJ",345:"cldrdata-en-FK",346:"cldrdata-en-FM",347:"cldrdata-en-GB",348:"cldrdata-en-GD",349:"cldrdata-en-GG",350:"cldrdata-en-GH",351:"cldrdata-en-GI",352:"cldrdata-en-GM",353:"cldrdata-en-GU",354:"cldrdata-en-GY",355:"cldrdata-en-HK",356:"cldrdata-en-IE",357:"cldrdata-en-IM",358:"cldrdata-en-IN",359:"cldrdata-en-IO",360:"cldrdata-en-JE",361:"cldrdata-en-JM",362:"cldrdata-en-KE",363:"cldrdata-en-KI",364:"cldrdata-en-KN",365:"cldrdata-en-KY",366:"cldrdata-en-LC",367:"cldrdata-en-LR",368:"cldrdata-en-LS",369:"cldrdata-en-MG",370:"cldrdata-en-MH",371:"cldrdata-en-MO",372:"cldrdata-en-MP",373:"cldrdata-en-MS",374:"cldrdata-en-MT",375:"cldrdata-en-MU",376:"cldrdata-en-MW",377:"cldrdata-en-MY",378:"cldrdata-en-NA",379:"cldrdata-en-NF",380:"cldrdata-en-NG",381:"cldrdata-en-NR",382:"cldrdata-en-NU",383:"cldrdata-en-NZ",384:"cldrdata-en-PG",385:"cldrdata-en-PH",386:"cldrdata-en-PK",387:"cldrdata-en-PN",388:"cldrdata-en-PR",389:"cldrdata-en-PW",390:"cldrdata-en-RW",391:"cldrdata-en-SB",392:"cldrdata-en-SC",393:"cldrdata-en-SD",394:"cldrdata-en-SG",395:"cldrdata-en-SH",396:"cldrdata-en-SL",397:"cldrdata-en-SS",398:"cldrdata-en-SX",399:"cldrdata-en-SZ",400:"cldrdata-en-TC",401:"cldrdata-en-TK",402:"cldrdata-en-TO",403:"cldrdata-en-TT",404:"cldrdata-en-TV",405:"cldrdata-en-TZ",406:"cldrdata-en-UG",407:"cldrdata-en-UM",408:"cldrdata-en-US",409:"cldrdata-en-US-POSIX",410:"cldrdata-en-VC",411:"cldrdata-en-VG",412:"cldrdata-en-VI",413:"cldrdata-en-VU",414:"cldrdata-en-WS",415:"cldrdata-en-ZA",416:"cldrdata-en-ZM",417:"cldrdata-en-ZW",418:"cldrdata-es",419:"cldrdata-es-419",420:"cldrdata-es-AR",421:"cldrdata-es-BO",422:"cldrdata-es-CL",423:"cldrdata-es-CO",424:"cldrdata-es-CR",425:"cldrdata-es-CU",426:"cldrdata-es-DO",427:"cldrdata-es-EA",428:"cldrdata-es-EC",429:"cldrdata-es-ES",430:"cldrdata-es-GQ",431:"cldrdata-es-GT",432:"cldrdata-es-HN",433:"cldrdata-es-IC",434:"cldrdata-es-MX",435:"cldrdata-es-NI",436:"cldrdata-es-PA",437:"cldrdata-es-PE",438:"cldrdata-es-PH",439:"cldrdata-es-PR",440:"cldrdata-es-PY",441:"cldrdata-es-SV",442:"cldrdata-es-US",443:"cldrdata-es-UY",444:"cldrdata-es-VE",445:"cldrdata-fi",446:"cldrdata-fi-FI",447:"cldrdata-fr",448:"cldrdata-fr-BE",449:"cldrdata-fr-BF",450:"cldrdata-fr-BI",451:"cldrdata-fr-BJ",452:"cldrdata-fr-BL",453:"cldrdata-fr-CA",454:"cldrdata-fr-CD",455:"cldrdata-fr-CF",456:"cldrdata-fr-CG",457:"cldrdata-fr-CH",458:"cldrdata-fr-CI",459:"cldrdata-fr-CM",460:"cldrdata-fr-DJ",461:"cldrdata-fr-DZ",462:"cldrdata-fr-FR",463:"cldrdata-fr-GA",464:"cldrdata-fr-GF",465:"cldrdata-fr-GN",466:"cldrdata-fr-GP",467:"cldrdata-fr-GQ",468:"cldrdata-fr-HT",469:"cldrdata-fr-KM",470:"cldrdata-fr-LU",471:"cldrdata-fr-MA",472:"cldrdata-fr-MC",473:"cldrdata-fr-MF",474:"cldrdata-fr-MG",475:"cldrdata-fr-ML",476:"cldrdata-fr-MQ",477:"cldrdata-fr-MR",478:"cldrdata-fr-MU",479:"cldrdata-fr-NC",480:"cldrdata-fr-NE",481:"cldrdata-fr-PF",482:"cldrdata-fr-PM",483:"cldrdata-fr-RE",484:"cldrdata-fr-RW",485:"cldrdata-fr-SC",486:"cldrdata-fr-SN",487:"cldrdata-fr-SY",488:"cldrdata-fr-TD",489:"cldrdata-fr-TG",490:"cldrdata-fr-TN",491:"cldrdata-fr-VU",492:"cldrdata-fr-WF",493:"cldrdata-fr-YT",494:"cldrdata-ga",495:"cldrdata-ga-IE",496:"cldrdata-he",497:"cldrdata-he-IL",498:"cldrdata-it",499:"cldrdata-it-CH",500:"cldrdata-it-IT",501:"cldrdata-it-SM",502:"cldrdata-ja",503:"cldrdata-ja-JP",504:"cldrdata-ko",505:"cldrdata-ko-KP",506:"cldrdata-ko-KR",507:"cldrdata-kok",508:"cldrdata-kok-IN",509:"cldrdata-ms",510:"cldrdata-ms-Latn",511:"cldrdata-ms-Latn-BN",512:"cldrdata-ms-Latn-MY",513:"cldrdata-ms-Latn-SG",514:"cldrdata-nb",515:"cldrdata-nb-NO",516:"cldrdata-nb-SJ",517:"cldrdata-nl",518:"cldrdata-nl-AW",519:"cldrdata-nl-BE",520:"cldrdata-nl-BQ",521:"cldrdata-nl-CW",522:"cldrdata-nl-NL",523:"cldrdata-nl-SR",524:"cldrdata-nl-SX",525:"cldrdata-nn",526:"cldrdata-nn-NO",527:"cldrdata-pl",528:"cldrdata-pl-PL",529:"cldrdata-pt",530:"cldrdata-pt-AO",531:"cldrdata-pt-BR",532:"cldrdata-pt-CV",533:"cldrdata-pt-GW",534:"cldrdata-pt-MO",535:"cldrdata-pt-MZ",536:"cldrdata-pt-PT",537:"cldrdata-pt-ST",538:"cldrdata-pt-TL",539:"cldrdata-ru",540:"cldrdata-ru-BY",541:"cldrdata-ru-KG",542:"cldrdata-ru-KZ",543:"cldrdata-ru-MD",544:"cldrdata-ru-RU",545:"cldrdata-ru-UA",546:"cldrdata-sv",547:"cldrdata-sv-AX",548:"cldrdata-sv-FI",549:"cldrdata-sv-SE",550:"cldrdata-th",551:"cldrdata-th-TH",552:"cldrdata-tr",553:"cldrdata-tr-CY",554:"cldrdata-tr-TR",555:"cldrdata-vi",556:"cldrdata-vi-VN",557:"cldrdata-zh",558:"cldrdata-zh-Hans",559:"cldrdata-zh-Hans-CN",560:"cldrdata-zh-Hans-HK",561:"cldrdata-zh-Hans-MO",562:"cldrdata-zh-Hans-SG",563:"cldrdata-zh-Hant",564:"cldrdata-zh-Hant-HK",565:"cldrdata-zh-Hant-MO",566:"cldrdata-zh-Hant-TW",567:"datepicker-locales",571:"vendors~app_develop"}[e]||e)+"-0290118b31258ddcfa55.js"}(e);var d=new Error;l=function(t){c.onerror=c.onload=null,clearTimeout(u);var n=r[e];if(0!==n){if(n){var a=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src;d.message="Loading chunk "+e+" failed.\n("+a+": "+i+")",d.name="ChunkLoadError",d.type=a,d.request=i,n[1](d)}r[e]=void 0}};var u=setTimeout((function(){l({type:"timeout",target:c})}),12e4);c.onerror=c.onload=l,document.head.appendChild(c)}return Promise.all(t)},o.m=e,o.c=a,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)o.d(n,a,function(t){return e[t]}.bind(null,a));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o.oe=function(e){throw console.error(e),e};var l=window.webpackJsonp=window.webpackJsonp||[],c=l.push.bind(l);l.push=t,l=l.slice();for(var d=0;d<l.length;d++)t(l[d]);var u=c;s.push(["e6ZA",139,570,106]),n()}({"+4Px":function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return o})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return c})),n.d(t,"i",(function(){return d})),n.d(t,"j",(function(){return u})),n.d(t,"l",(function(){return m})),n.d(t,"m",(function(){return p})),n.d(t,"p",(function(){return h})),n.d(t,"q",(function(){return g})),n.d(t,"r",(function(){return b})),n.d(t,"s",(function(){return f})),n.d(t,"t",(function(){return v})),n.d(t,"u",(function(){return y})),n.d(t,"v",(function(){return S})),n.d(t,"w",(function(){return C})),n.d(t,"h",(function(){return E})),n.d(t,"k",(function(){return I})),n.d(t,"o",(function(){return k})),n.d(t,"n",(function(){return w})),n.d(t,"x",(function(){return T})),n.d(t,"y",(function(){return O})),n.d(t,"A",(function(){return A})),n.d(t,"z",(function(){return P}));const a=8,i=188,r=46,s=40,o=35,l=13,c=27,d=36,u=37,m=110,p=108,h=34,g=33,b=190,f=39,v=32,y=9,S=38,C=48,E=53,I=57,k=96,w=105;function T(e){const t=e.keyCode;return t===S||t===s||t===u||t===f}function O(e){return e.keyCode===l||e.keyCode===p}function A(e){return e.keyCode===y&&!e.shiftKey}function P(e){return e.keyCode===y&&e.shiftKey}},"+IM5":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));n("QLzv");var a=n("yCC5"),i=n("Rjd/"),r=n("nkTj"),s=n("zGdY");const o=a.Ub;i.a.factory(o,["restmod",r.c,e=>e.model().mix({ui:{init:()=>({rendered:!1})},$extend:{Record:{getContentIdForGoalAlignment(){return`blackboard.data.qti.asi.AsiObject;${this.id}`},getContentTitleForGoalAlignment(){return this.title},isCurrentUserEligibleToAlignGoals(){return this.permissions&&!0===this.permissions.edit},saveAlignedGoals(e){return e&&(this.alignedGoals=e.map((e=>({goalId:e.id,isVisibleToStudent:!0,goal:e})))),this.$send({method:"PATCH",url:this.$url(),data:{alignedGoals:this.alignedGoals,questionType:this.questionType}}).$then((()=>{this.$getPreviousVersion()&&(this.$getPreviousVersion().alignedGoals=this.alignedGoals)}))},isPresentationOnly(){return s.Nb.PresentationOnly===this.questionType}},Collection:{getInsertIndex(e){let t=-1;const n=e.positionBefore,a=e.positionAfter;return null!=n&&(t="start"===n.toLowerCase()?0:this.indexOfItemById(n)),t<0&&null!=a&&("end"===a.toLowerCase()?t=this.length:(t=this.indexOfItemById(a),t>=0&&t++)),t},indexOfItemById(e){return this.$indexOf((t=>t.id===e))}}}})])},"+O05":function(e,t,n){"use strict";n.d(t,"g",(function(){return h})),n.d(t,"h",(function(){return g})),n.d(t,"c",(function(){return f})),n.d(t,"f",(function(){return v})),n.d(t,"d",(function(){return y})),n.d(t,"e",(function(){return S})),n.d(t,"b",(function(){return C})),n.d(t,"a",(function(){return E}));var a=n("D57K"),i=n("nsO7"),r=n("Llzl"),s=n("pjml"),o=n("12mu"),l=n("0JpG"),c=n("IbyE"),d=n("zGdY"),u=n("5Dl8"),m=n("aHpC"),p=n("klG7");const h="ultra.services.assessment",g="assessment",b="components.services.assessment.feedbackModeDisplay.afterIndividualGradePosted",f="components.services.assessment.feedbackModeDisplay.noneSpecified",v="course.content.assessment.feedbackOption",y=[d.f.UserAnswers,d.f.InstructorFeedback,d.f.Score,d.f.CorrectAnswers],S={[d.f.UserAnswers]:{visible:"visible",invisible:"invisible"},[d.f.InstructorFeedback]:{visible:"feedback",invisible:"feedback"},[d.f.Score]:{visible:"grade",invisible:"grade"},[d.f.CorrectAnswers]:{visible:"check-circle",invisible:"check-circle"}};var C;!function(e){e.FOLDER="folder",e.ASSESSMENT="assessment",e.BANK="bank"}(C||(C={}));let E=class{constructor(e,t,n,a,i,r){this.modal=e,this.$rootScope=t,this.$q=n,this.localizeService=a,this.AttemptModel=i,this.GroupAttemptModel=r}static isAssessment(e){return s.p.ContentHandler.TestLink.isEqualTo(e.contentHandler)||s.p.ContentHandler.SurveyLink.isEqualTo(e.contentHandler)}static isExternalSubmissionsAssessment(e){return c.j.isExternalSubmissionsAssessment(e)}static isExternalSubmissionByDeployedAssessment(e){var t;return!!(null===(t=null==e?void 0:e.deploymentSettings)||void 0===t?void 0:t.isCollectExternalSubmissions)}static getQuestionsForAttempt(e,t){if(!e.getToolAttemptDetailItem(t))return[];const n=e.getToolAttemptDetailItem(t).questionAttempts;return n&&n.length>0?n.map((e=>e.question)):[]}static studentCanViewAttemptGradeAndFeedback(e,t){return t?!!(e&&e.isSubmitted()&&t.isPosted()):this.studentCanViewAttemptResults(e)}static studentCanViewAttemptResults(e){return!!(null==e?void 0:e.isCompleted())}static attemptHasFeedback(e){const t=e&&e.getFeedbackToUser();return!!t&&!!t.rawText}static groupAttemptHasIndividualFeedback(e){const t=e&&e.attempts&&e.attempts[0].getGroupIndividualFeedbackToUser();return!!t&&!!t.rawText}static canViewAssessmentException(e,t,n,a){return!e&&!t&&n&&!a}static getSubmissionListAllExceptions(e,t){return null==e||null==t?null:e.assessments.$buildRaw(t.getDeployedAssessment().assessment).exceptions.$resolve().$allow([404]).$asPromise()}static initAssessmentExceptionsIndicators(e,t){return null==e||null==t||void 0===t.getDeployedAssessment()?null:this.getSubmissionListAllExceptions(e,t).then((n=>this.generateCssStyle(e,t,n)))}static generateCssStyle(e,t,n){const a={},i=e.assessments.$buildRaw(t.getDeployedAssessment().assessment),r=this.setAssessmentExceptionStyleTag(i.id)();return n.length&&n.forEach((t=>{this.setAssessmentExceptionClass(r,e.id,t,!0,a)})),r}static updateAssessmentExceptionIndicator(e,t,n=!0,a){if(null==e||null==t)return;const i=e.assessments.$buildRaw(t.getDeployedAssessment().assessment),r=this.setAssessmentExceptionStyleTag(i.id)();this.setAssessmentExceptionClass(r,e.id,a,n)}static setAssessmentExceptionStyleTag(e){const t="css_assessment_exceptions"+e;return i.once((()=>{let e=r.element(document).find(`#${t}`);return 0===e.length&&(e=r.element(`<style id="${t}"></style>`).appendTo("head")),e}))}static setAssessmentExceptionClass(e,t,n,a=!0,r){const s=new u.a,o=a?"inline-block":"none",l=n.target.id,c=n.target.type;let m;c===d.d.User&&s.selector(`.cc${t} .assessment-exception bb-username.course_user${l}:before`).rule("display",o),c===d.d.Group&&(s.selector(`.cc${t} .assessment-exception .show-exceptions.submission_row_group${l}:before`).rule("display",o),s.selector(`.cc${t} .slick_title${l} .assessment-exception .show-exceptions:before`).rule("display",o),s.selector(`.cc${t} .assign_group${l}.show-exceptions:before`).rule("display",o)),r&&(r[l]=s.build(),m=i(r).sortBy().map(((e,t)=>e)).join("\n")),m&&m!==e.text()&&e.text(m),m||(m=e.text(),e.text([m,s.build()].join("\n")))}static getSubmissionRowException(e,t,n,a){const i=e.assessments.$buildRaw(t.getDeployedAssessment().assessment);return n===d.d.Group?i.groupExceptions.$new(a).$resolve().$allow([404]).$asPromise():n===d.d.User?i.userExceptions.$new(a).$resolve().$allow([404]).$asPromise():void 0}static deleteException(e,t,n,a){const i=e.assessments.$buildRaw(t.getDeployedAssessment().assessment);return n===d.d.User?i.userExceptions.$new(a).deleteException():n===d.d.Group?i.groupExceptions.$new(a).deleteException():void 0}static setSubmissionRowException(e,t,n,a,i){const r=e.assessments.$buildRaw(t.getDeployedAssessment().assessment),s={start:i.start,end:i.end,attempts:i.attempts};return n===d.d.User?r.userExceptions.$new(a).saveException(s):n===d.d.Group?r.groupExceptions.$new(a).saveException(s):void 0}static isFeedbackOptionEnabled(e,t){const{mode:n}=c.r.getFeedbackModeByOption(e,t);return null!=n}isUserAnswersOption(e){return e===d.f.UserAnswers}getFeedbackModeLabelByOption(e,t){const{mode:n,associatedDate:a}=c.r.getFeedbackModeByOption(e,t);return n?this.localizeService.loadBundle("components/services/assessment").then((()=>{switch(n){case d.e.AfterAttemptGraded:return this.localizeService.translateSync({locale:this.localizeService.getLocale(this.$rootScope),key:"components.services.assessment.feedbackModeDisplay.afterPosted"});case d.e.AfterDueDate:return this.localizeService.translateSync({locale:this.localizeService.getLocale(this.$rootScope),key:"components.services.assessment.feedbackModeDisplay.afterDueDate"});case d.e.AfterSubmission:{const t=e===d.f.Score||e===d.f.CorrectAnswers;return this.localizeService.translateSync({locale:this.localizeService.getLocale(this.$rootScope),key:t?b:"components.services.assessment.feedbackModeDisplay.afterSubmission"})}case d.e.OnSpecifiedDate:return this.localizeService.translateSync({locale:this.localizeService.getLocale(this.$rootScope),key:"components.services.assessment.feedbackModeDisplay.onSpecificDate",params:{date:a},noWrap:!0});case d.e.AfterIndividualGradeIsPosted:return this.localizeService.translateSync({locale:this.localizeService.getLocale(this.$rootScope),key:b});default:console.error(`Feedback mode: ${n} is not yet supported`)}})):this.$q.resolve(null)}getFeedbackModeLabels(e,t){const n=e.map((e=>this.getFeedbackModeLabelByOption(e,t)));return this.$q.all(n)}isAfterIndividualGradeIsPostedFeedbackMode(e,t){switch(e){case d.f.UserAnswers:return c.r.getFeedbackModeByOption(e,t).mode===d.e.AfterIndividualGradeIsPosted;case d.f.CorrectAnswers:case d.f.Score:return c.r.getFeedbackModeByOption(e,t).mode===d.e.AfterSubmission;default:return!1}}isAfterAllGradesArePostedFeedbackMode(e,t){return c.r.getFeedbackModeByOption(e,t).mode===d.e.AfterAttemptGraded}isExternallyRefQuestionsAPIError(e){return 409===e.status&&i.includes(e.code,d.b)}openHasExternallyRefQuestionsModal(e){const t=this.$rootScope.$new();t.translateOpts={title:{key:`components.services.assessment.modal.error-external-questions.${e.toString()}.title`}},t.descriptionKey=`components.services.assessment.modal.error-external-questions.${e.toString()}.description`;const n={scope:t,template:p,resolve:{translations:[l.serviceName,e=>e.loadBundle("components/services/assessment")]}};this.modal.open(n)}launchAttempt(e,t,n,a){const i={scoreProviderHandle:c.O.Test,status:d.l.InProgress,toolAttemptDetail:{"resource/x-bb-assessment":{type:d.h.Test,password:t}}},r=n?this.GroupAttemptModel.$build(i):this.AttemptModel.$build(i);return e.launchAttempt(r,{},n,a).then((e=>{var t,n;return(null===(n=null===(t=null==e?void 0:e.$response)||void 0===t?void 0:t.data)||void 0===n?void 0:n.status)===d.S.Forbidden?e.$asPromise():e.$fetch({expand:"toolAttemptDetail,alignedGoals"}).$asPromise()}))}};E=Object(a.a)([Object(a.c)(0,Object(m.b)(o.b)),Object(a.c)(1,Object(m.b)("$rootScope")),Object(a.c)(2,Object(m.b)("$q")),Object(a.c)(3,Object(m.b)(l.serviceName)),Object(a.c)(4,Object(m.b)(s.A.serviceName)),Object(a.c)(5,Object(m.b)(s.E.serviceName))],E);r.module(h,[o.a]).service(g,E)},"+brj":function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return d})),n.d(t,"a",(function(){return u}));n("qY1S");var a=n("Llzl"),i=n("dzwE"),r=n("Ymz8"),s=n("Fvsw"),o=n("TnpK"),l=n("fYJU");const c="ultra.components.services.browserStorage",d="browserStorage";var u;!function(e){e.LocalStorage="localStorage",e.SessionStorage="sessionStorage"}(u||(u={}));class m{constructor(e,t,n,a,i,s){this.$rootScope=e,this.$q=t,this.DSCacheFactory=n,this.context=a,this.ultraState=i,this.contextUser=s,this.QUOTA_EXCEEDED_ERR=22,this.QUOTA_EXCEEDED_ERR_FIREFOX=22,this.BROWSER_STORAGE_PREFERENCE_KEY="ultraui.browserstorage.key",this.CACHE_PREFIX="ultraui.browserstorage",this.sjcl=r,this.crypto=window.crypto,this.BROWSER_STORAGE_RECORD_MAX_AGE=864e5,this.BROWSER_STORAGE_RECORD_MAX_COUNT=10,this._isEncryptNativeSupported=(()=>this.crypto&&this.crypto.subtle?this.crypto.subtle.digest({name:"SHA-256"},this._stringToArrayBuffer("x")).then((()=>this.$q.when(!0))).catch((()=>this.$q.when(!1))):this.$q.when(!1))()}serializeCurrentRouteScopes(e,t){return this.saveToStorage(this._getCurrentRouterStateObject(),t,e,(function(e,t){if(!(t&&t instanceof Array&&t.length>=1e9)&&"_userModel"!==e&&(t&&t.$type&&t.$type===t.constructor&&"$pk"in t&&(t.ui.isRestModObject=!0),("_"!==e[0]||this.ui&&!0===this.ui.isRestModObject||t&&t.ui&&!0===t.ui.isRestModObject)&&("$"!==e[0]||-1!==["$viewValue","$modelValue"].indexOf(e))))return t}))}deserializeCurrentRouteScopes(e,t){return this.getFromStorage(this._getCurrentRouterStateObject(),e)}deleteCurrentRouteScopes(e){return this.deleteFromStorage(this._getCurrentRouterStateObject(),e)}_getCurrentRouterStateObject(){return{componentState:this.ultraState.current.name.slice(this.ultraState.getBaseState().length+1),stateParams:this.ultraState.getCurrentUrlParams()}}saveToStorage(e,t,n,a){const r=this._getBrowserStorageCache(n);r.removeExpired();const s=i.stringify(t,a);return this._getUserEncryptionPassword().then((t=>this._encrypt(t,s).then((t=>{try{return r.put(this._toSortedKeyJSON(e),t)}catch(e){e.code&&e.code===this.QUOTA_EXCEEDED_ERR||e.code===this.QUOTA_EXCEEDED_ERR_FIREFOX?console.warn("Local storage is at capacity",e):console.warn("Local storage not permitted.",e),this.saveToStorage=(e,t,n)=>this.$q.when(void 0)}}))))}getFromStorage(e,t,n){const a=this._getBrowserStorageCache(t).get(this._toSortedKeyJSON(e));return null!=a?this._getUserEncryptionPassword().then((e=>this._decrypt(e,a).then((e=>i.parse(e,n))))):this.$q.when(void 0)}updateStorageKey(e,t,n,a){return this.getFromStorage(e,n).then((i=>{this.deleteFromStorage(e,n);const r=a||i;if(r)return this.saveToStorage(t,r,n)}))}deleteFromStorage(e,t){const n=this._getBrowserStorageCache(t);return n.removeExpired(),!!n.remove(this._toSortedKeyJSON(e))}_toSortedKeyJSON(e){return JSON.stringify(e,((e,t)=>"object"!=typeof t?t:Object.keys(t).sort().reduce(((e,n)=>(e[n]=t[n],e)),{})))}_getBrowserStorageCache(e){const t=this.CACHE_PREFIX+"."+e.toString()+"."+this.contextUser.userId;let n=this.DSCacheFactory.get(t);if(!n)switch(e){case u.LocalStorage:n=this.DSCacheFactory.createCache(t,{capacity:this.BROWSER_STORAGE_RECORD_MAX_COUNT,maxAge:this.BROWSER_STORAGE_RECORD_MAX_AGE,storageMode:u.LocalStorage.toString()});break;case u.SessionStorage:n=this.DSCacheFactory.createCache(t,{capacity:this.BROWSER_STORAGE_RECORD_MAX_COUNT,storageMode:u.SessionStorage.toString()})}return n}_getUserEncryptionPassword(){this._sjclForceReady();const e=this.sjcl.codec.base64.fromBits(this.sjcl.random.randomWords(6));return this.storageKeyPromise=this.storageKeyPromise||this.context.getPreference(this.BROWSER_STORAGE_PREFERENCE_KEY,e).then((e=>(e.value&&!e.$resolved&&e.$save(),e.value)))}_sjclForceReady(){if(!this.sjcl.random.isReady()){const e=[];for(let t=0;t<32;t++)e.push(Math.floor(4294967296*Math.random()));this.sjcl.random.addEntropy(e,1024,"IE10 fallback entrophy")}}_encrypt(e,t){return this._isEncryptNativeSupported.then((n=>n?this._subtleCryptoEncrypt(e,t).then((e=>({SubtleCryptoEncrypted:e}))):this.$q.when(this.sjcl.encrypt(e,t)).then((e=>({SjclCipherEncrypted:e})))))}_decrypt(e,t){return this._isEncryptNativeSupported.then((n=>n?this._subtleCryptoDecrypt(e,t.SubtleCryptoEncrypted):this.$q.when(this.sjcl.decrypt(e,t.SjclCipherEncrypted))))}_subtleCryptoEncrypt(e,t){return this._subtleCryptoGetPasswordKey(e).then((e=>{const n=this.crypto.getRandomValues(new Uint8Array(16));return this.crypto.subtle.encrypt({name:"AES-CBC",iv:n},e,this._stringToArrayBuffer(t)).then((e=>({vector:this._arrayBufferToBase64(n),encrypted:this._arrayBufferToBase64(e)})))}))}_subtleCryptoDecrypt(e,t){return this._subtleCryptoGetPasswordKey(e).then((e=>{const n=this._base64ToArrayBuffer(t.vector);return this.crypto.subtle.decrypt({name:"AES-CBC",iv:n},e,this._base64ToArrayBuffer(t.encrypted)).then((e=>this._arrayBufferToString(e)))}))}_subtleCryptoGetPasswordKey(e){return this.crypto.subtle.digest({name:"SHA-256"},this._stringToArrayBuffer(e)).then((e=>this.crypto.subtle.importKey("raw",e,{name:"AES-CBC"},!1,["encrypt","decrypt"])))}_arrayBufferToString(e,t){const n=t&&new Uint8Array(e)||new Uint16Array(e);let a="";for(let e=0;e<n.length;e++)a+=String.fromCharCode(n[e]);return a}_arrayBufferToBase64(e){return window.btoa(this._arrayBufferToString(e,!0))}_stringToArrayBuffer(e,t){const n=t&&new ArrayBuffer(e.length)||new ArrayBuffer(2*e.length),a=t&&new Uint8Array(n)||new Uint16Array(n);for(let t=0;t<e.length;t++)a[t]=e.charCodeAt(t);return n}_base64ToArrayBuffer(e){return this._stringToArrayBuffer(window.atob(e),!0)}}m.$inject=["$rootScope","$q","DSCacheFactory",s.b,o.d,l.b];a.module(c,["angular-data.DSCacheFactory",s.a,o.b]).service(d,m)},"+e2k":function(e,t,n){"use strict";var a,i,r=n("D57K"),s=(n("DlnX"),n("yC9S")),o=n("aHpC");!function(e){e[e.LeftToRight=0]="LeftToRight",e[e.Bidirectional=1]="Bidirectional"}(a||(a={})),function(e){e.Small="small",e.Medium="medium",e.Large="large",e.Custom="custom"}(i||(i={}));const l={directionality:a.Bidirectional},c=e=>e.reduce(((e,t)=>({...e,[t]:{...l}})),{}),d={[i.Small]:c(["peer-review","history","time","timer","reminder","add-reminder","no-time-limit","faster","slower","help","information","search","accommodation","away","add-circle-extended","invisible","netstats-unavailable","text","camera","type-size","close-captioning","bulk-edit","draw","edit","highlighter","erase","link","unlinked","check","attempts","attendance","square-checked","complete","play-start","volume-low","volume-medium","volume-mute","volume","mute-audio","telephony","mute-phone","audio","collab","collab-off","mute-video","record","recording","stop-recording","video","start","stop","raise-hands","lower-hand","hand-pointer","approval","disapproval","status-approval","edit-tool","course-complete","notes","safe-assign","app","broken-app","custom-content","whiteboard","format_text_default","format_text","italicize_default","italicize","subscript_default","subscript","superscript_default","superscript","underline_default","underline","bold_default","bold","calculation","strikethrough","insert_formula"]),[i.Medium]:c(["peer-review","hand-raise","shape-line","history","time","timer","reminder","add-reminder","no-time-limit","help","help-circle","information","search","zoom-in","zoom-out","exempt","disabled","status-away","invisible","risk-low","text","camera","capture","type-size","close-captioning","download-captions","link","pencil","highlighter","erase","tools","pen","brush","check","check-circle","attempts","audio-mute","cam-mic","audio","telephony","mute-phone","hang-up","sound-on","sound-off","collab","download-recording","video","record","stop-recording","video","video-mute","stop-action","play-start","raise-hand","lower-hand","hand-pointer","pan","asl-interpreter","edit-tool","course-complete","content-view","safe-assign","grades","attendance","wiki","app","app-off","calculation","whiteboard"]),[i.Large]:c(["app-c","attendance-a","attendance","audio-a","audio-c","audio","calculation-a","calculation-c","calculation","certification-a","certification-c","certification","check-circle-c","check-circle","collaborate-a","collaborate-c","collaborate","coming-soon","course-complete","database-connected","diploma-a","diploma-c","diploma","field-work-a","field-work-c","field-work","fill-in-the-blank-a","fill-in-the-blank","grades-a","grades-c","grades","help-a","help-c","help","information","raise-hand-a","raise-hand-c","raise-hand","record-a","record-c","record","reminder-a","reminder-c","reminder","rubric-a","rubric-c","rubric","scormengine-a","scormengine-sco-a","scormengine-sco","scormengine","stop-recording-a","stop-recording-c","stop-recording","support-document-a","support-document-c","support-document","technical-diploma-a","technical-diploma-c","technical-diploma","text-box-a","text-box","timer-a","timer-c","timer","video-a","video-c","video","whiteboard-a","whiteboard-c","whiteboard","wiki-a","wiki-c","wiki"]),[i.Custom]:{}};var u=n("ZzR9");n.d(t,"a",(function(){return p}));const m=["active","alert","success","warning"],p="ultra.components.directives.svgIcon";let h=class{constructor(e,t){this.$rootScope=e,this.$element=t}$onInit(){this.windowHref=window.location.href,this.updateIconState(),this.setStatusStyles(),this.destroyLocationChangeListener=this.$rootScope.$on(u.a.$locationChangeSuccess,(()=>{this.windowHref=window.location.href,this.updateIconState()}))}$onChanges(){this.updateIconState()}$onDestroy(){this.destroyLocationChangeListener()}updateIconState(){var e,t;this.directionalStyles=(null===(t=null===(e=d[this.size])||void 0===e?void 0:e[this.icon])||void 0===t?void 0:t.directionality)===a.Bidirectional?"":"directional-icon",this.iconHref=`${this.windowHref}#icon-${this.size}-${this.icon}`}setStatusStyles(){this.color?this.statusStyles="color":null!=m.find((e=>this.status))?this.statusStyles=this.status:this.statusStyles="default"}};h=Object(r.a)([Object(s.a)({moduleName:p,componentName:"bbSvgIcon",template:'\n    <svg\n      class="svg-icon svg-icon-directive {{::$ctrl.size}}-icon {{::$ctrl.statusStyles}} {{\n        $ctrl.directionalStyles\n      }}"\n      focusable="false"\n      aria-hidden="true"\n      bb-cache-compilation="svg-icon"\n    >\n      <use xlink:href="" ng-href="{{ $ctrl.iconHref }}"></use>\n    </svg>\n  ',bindings:{icon:"@",color:"<",size:"@",status:"@"}}),Object(r.c)(0,Object(o.b)("$rootScope")),Object(r.c)(1,Object(o.b)("$element"))],h)},"+g6d":function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return r}));n("MFWY");var a=n("Llzl"),i=n("lEL+");const r="ultra.components.directives.clickToInvokeChild",s="bbClickToInvokeChild";class o{constructor(t,n,a,i){if(this.scope=t,this.element=n,this.attrs=a,this.timeout=i,this.linkSelector=a[s],!this.linkSelector&&void 0!==this.linkSelector)throw new Error(s+" has no child selector specified.");this.setClickableStyle(),t.$on("click-to-invoke-child-directive-init",(()=>{this.setClickableStyle()})),n.on("click",(t=>{if(!e(t.target).closest("a, button, [ng-click], .stop-click-propagation, [bb-click-to-invoke-child]",this.element.get(0)).length){const e=this.element.find(this.linkSelector).get(0);e&&(e.click(),a.stopPropagation&&"true"===a.stopPropagation&&t.stopPropagation())}}))}setClickableStyle(){this.timeout((()=>{this.element.find(this.linkSelector).first().length?(void 0===this.element.attr("tabindex")&&this.element.attr("tabindex","-1"),this.element.addClass("child-is-invokable")):(this.element.removeAttr("tabindex"),this.element.removeClass("child-is-invokable"))}),this.scope,0,!1)}}o.$inject=["scope","element","attrs",i.b];class l{constructor(e){this.$injector=e,this.scope=!1,this.restrict="A",this.link=(e,t,n)=>{this.$injector.instantiate(o,{scope:e,element:t,attrs:n})}}}l.$inject=["$injector"],a.module(r,[i.a]).directive(s,["$injector",e=>e.instantiate(l)])}).call(this,n("71td"))},"/0oN":function(e,t){e.exports='<svg viewBox="0 0 240 186" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M238.484 37.43a67.869 67.869 0 0 1-1.648 16.812c-62.272 2.694-124.644 2.145-186.966 1.596-15.93-.15-32.56 1.048-48.34-.549-4.494-16.412 15.381-13.818 25.668-14.217a5941.954 5941.954 0 0 1 51.885-1.596 5869.139 5869.139 0 0 1 102.722-1.796c4.644-.05 56.679-.55 56.679-.25ZM237.735 75.892c1.748-6.036 2.297-12.421 1.698-18.657-11.635-.898-23.271.748-34.856 2.145-59.027 6.984-118.702 6.635-178.128 4.19-5.842-.249-18.277-2.843-23.27.749C-.967 67.262-.118 75.643.581 79.933c15.23 1.447 31.56-.399 46.891-.698 15.33-.25 30.662-.549 45.993-.799l93.033-1.646c4.694-.1 50.587 1.297 51.236-.898ZM.382 130.218c79.55-7.583 159.451-.399 238.952-8.979-.749-9.628-1.449-19.256-2.198-28.884-.05-.749-2.097-3.393-3.046-3.193-31.56 5.537-211.435 5.886-222.621 4.989-6.442-.499-5.494 1.646-7.142 11.922-.4 2.295-3.246 24.045-3.945 24.145Z" fill="#009A8F"/><path d="M204.327 32.392c2.447.698 5.144.748 7.391-.35 2.297-1.097 4.045-3.442 3.895-5.986-3.496 0-6.642-1.796-9.688-3.542-.849-.499-1.698-.997-2.097-1.895-.3-.799-.2-1.846-.799-2.445-.3-.3-.7-.399-1.099-.499-.949-.25-2.097-.299-2.846.3-.7.548-.899 1.496-.999 2.344-.599 5.538.549 10.526 6.242 12.073ZM147.298 165.537c-2.447.699-5.143.748-7.39-.349-2.298-1.098-4.045-3.442-3.896-5.986 3.496 0 6.642-1.796 9.688-3.542.849-.499 1.698-.998 2.098-1.896.299-.798.199-1.846.799-2.444.299-.3.699-.399 1.098-.499.949-.25 2.098-.299 2.847.299.699.549.899 1.497.998 2.345.6 5.487-.549 10.526-6.242 12.072Z" fill="#F6AC3D"/><path d="M16.262 158.703c-.2 1.646-.5 3.342-1.448 4.639-.949 1.347-2.897 2.095-4.295 1.297-.849-.499-1.448-1.446-2.447-1.646-1.648-.299-2.596 2.145-1.648 3.492.95 1.347 2.747 1.746 4.395 1.796 2.946.15 6.242-.399 8.14-2.694.899-1.097 1.348-2.444 1.797-3.791 3.246-10.027 5.494-20.653 4.345-31.129-7.99-1.197-6.891 4.091-7.191 9.977-.35 6.136-.849 12.122-1.648 18.059ZM203.228 155.859c.5 1.148 1.099 2.295 2.098 3.093 1.298 1.098 3.046 1.447 4.744 1.497 1.748.05 3.545-.25 4.894-1.347 1.348-1.098 1.997-3.143 1.148-4.59l-6.442 1.647c-.549.149-1.148.299-1.648.049-.998-.399-1.148-1.696-1.148-2.793.05-6.236.1-12.521.1-18.757 0-2.445.349-11.574-4.744-7.782-2.497 1.895-1.748 10.226-1.798 12.87-.05 5.537.549 11.075 2.796 16.113Z" stroke="#009A8F" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/><path d="M103.353 104.726c43.795-.548 87.641-.598 131.436-.199M4.477 106.772c8.59-.25 17.228-.499 25.867-.699" stroke="#000" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/><path d="M189.296 79.284c-.2 3.443-.35 6.935-.55 10.377 0 .349 0 .748.25.997.2.2.549.2.849.2h4.195c.349 0 .699 0 .999-.2.449-.299.499-.897.549-1.446.15-3.592.349-7.184.499-10.776-2.746-.099-5.493.05-8.19.499M20.357 82.278c-.15 2.843-.35 5.737-.5 8.58 0 .399 0 .798.25 1.048.2.199.55.249.9.249.998 0 1.997-.2 2.945-.549.45-3.392.65-6.784.55-10.176-2.148-.2-4.295-.1-6.442.249" stroke="#009A8F" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/><path d="M1.53 55.29c.3-2.196-2.496-4.29 2.048-10.427 1.548-2.095 5.293-2.294 13.084-2.943 7.84-.648 29.862-1.247 29.862-1.247M175.563 46.709c6.292.1 12.584-.948 18.527-3.043.449-.15.998-.599.749-.998-.1-.15-.25-.2-.4-.25-1.897-.797-4.194-.698-5.992.3-.3.15-.599.4-.599.699 0 .249.199.399.349.548 3.546 3.243 8.989 3.043 13.783 2.644 3.396-.3 6.891-.598 9.937-2.095M164.027 64.369c24.719-5.637 50.088-8.381 75.456-8.231-1.398 6.934-2.796 13.868-4.195 20.852a189.606 189.606 0 0 1-24.969 2.245" stroke="#000" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/><path d="M202.18 32.192a16.908 16.908 0 0 0-.55 4.19M206.624 33.14c-.1 1.297-.05 2.544.05 3.841M200.082 22.065c-2.047-.15-2.447.749-3.995.25M149.446 165.338a16.95 16.95 0 0 1 .549 4.19M145.001 166.286c.1 1.297.05 2.544-.05 3.841M151.543 155.211c2.197 1.147 2.247-.399 3.645.349" stroke="#A67243" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/><path d="M162.03 167.034c-.05.05-.05.1 0 .149h.05c.35-.099.15-.399-.05-.149Z" stroke="#F6AC3D" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/><path d="M150.744 152.667c-.05.049-.05.099 0 .149h.05c.35-.05.15-.349-.05-.149Z" stroke="#000" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/><path d="M162.729 169.378s0 .05.05.05h.05c.749-.399-.4-.648-.1-.05ZM165.476 169.129s0 .05 0 0c.15.15.2-.1.05-.2-.05.05-.1.15-.05.2Z" stroke="#F6AC3D" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/><path d="M200.482 19.172c-.05.05-.05.1 0 .15h.05c.35-.05.15-.35-.05-.15Z" stroke="#000" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/><path d="M63.139 31.835h9.666c1.961.057 4.946 1.024 7.334 1.905 2.303.853 7.648 19.7 7.932 24.989l-1.706 26.666 6.71 22.259s-6.71 4.122-25.757 4.122-26.865-4.975-26.865-4.975l8.159-23.453-.682-27.462c.312-2.587 3.468-21.236 5.97-22.004 3.155-.966 7.363-2.104 9.239-2.047Z" fill="#DA80A0"/><path d="m50.26 43.264-2.387 12.622 1.82 47.021" stroke="#000" stroke-width=".569" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/><path d="M77.268 34.053c2.757-1.109 5.856.34 6.794 3.155l9.61 29.566s2.074 8.614-3.839 10.291c-5.998 1.677-9.267-8.102-9.267-8.102l-6.397-29.082c-.54-2.417.768-4.89 3.099-5.828Z" fill="#DA80A0"/><path d="m56.401 81.5 28.6-14.669s5.287-2.275 7.732 2.018c3.269 5.8-2.445 8.728-2.445 8.728L61.15 89.403 56.401 81.5Z" fill="#DA80A0"/><path d="m49.55 85.423-10.433 3.753s-.626 1.99 2.445 1.648l8.585-3.07-.597-2.331Z" fill="#A67243"/><path d="M61.178 84.485 56.401 81.5s-6.795 3.411-6.795 3.525c0 .142-7.818 6.396-7.818 6.396l-4.946 7.392a.868.868 0 0 0 .255 1.194l.313.199a.835.835 0 0 0 1.166-.256l4.037-6.169 1.222-.995-3.184 8.045a.859.859 0 0 0 .597 1.081l.17.056a.87.87 0 0 0 1.024-.511l2.644-6.937.625-1.052-2.16 7.449a.858.858 0 0 0 .597 1.08l.17.057a.871.871 0 0 0 1.024-.512l2.644-6.937.568-.085-2.018 6.112a.862.862 0 0 0 .483.967c.426.199.938 0 1.109-.455l2.473-5.828.142-.369c1.763-.342 4.89-.313 7.022-4.492l4.748-1.592-1.337-4.378Z" fill="#A67243"/><path d="M85 66.859 49.55 85.423l-7.76 5.998-4.35 6.482" stroke="#000" stroke-width=".569" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/><path d="M56.657 34.45c-2.643-1.364-5.884-.198-7.05 2.502L37.241 65.495s-2.9 8.386 2.843 10.603c5.827 2.246 10.006-7.164 10.006-7.164l9.126-28.343a5.21 5.21 0 0 0-2.559-6.14Z" fill="#DA80A0"/><path d="M72.18 85.707 46.45 66.433s-4.832-3.127-7.96.682c-4.207 5.174.967 9.012.967 9.012l26.723 16.545 5.998-6.965Z" fill="#DA80A0"/><path d="m78.263 90.711 9.637 5.458s.285 2.075-2.7 1.222l-7.932-4.463.995-2.217Z" fill="#A67243"/><path d="m64.902 91.905 4.406 2.388c1.393 4.463 4.492 5.003 6.169 5.6l.085.398 1.45 6.169a.848.848 0 0 0 1.024.626c.398-.086.653-.455.625-.882l-.91-6.425.54.171 1.422 7.278c.085.426.483.71.91.682l.17-.029a.866.866 0 0 0 .768-.966l-.882-7.704.455 1.137 1.422 7.278c.085.426.483.71.91.682l.17-.028a.868.868 0 0 0 .768-.967L82.64 98.87l1.052 1.194 2.928 6.766c.17.426.682.625 1.109.455l.34-.143c.456-.17.655-.682.456-1.137l-3.668-8.102s-6.652-7.477-6.623-7.619c.028-.142-6.084-4.634-6.084-4.634l-5.203 2.133-2.046 4.122Z" fill="#A67243"/><path d="m46.537 80.874 18.365 11.031 2.075-4.094M56.43 49.177l-6.368 19.729 28.23 21.435 6.623 7.591 2.218 4.975" stroke="#000" stroke-width=".569" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/><path d="M38.157 99.863c0-7.506 6.681-9.695 11.457-9.695l19.019-9.949c4.776 0 22.743 11.143 22.743 19.644 0 8.5-2.673 15.976-26.183 15.976-23.51 0-27.035-8.471-27.035-15.976Z" fill="#F0E7D9"/><path d="m75.314 148.959 1.478 14.072-3.374 2.047-5.098-1.621-.966-15.437c.028.029 3.724-.483 7.96.939Z" fill="#A67243"/><path d="m68.274 163.363-.227 7.051s-1.421 1.364-.825 3.638c0 0 1.678 6.795 6.568 9.495 4.89 2.701 11.57 4.293 8.556-4.434l-5.6-16.148c-.199-1.393-1.848-1.336-8.472.398Z" fill="#009A8F"/><path d="M80.442 177.293s-2.473 1.734-5.345-1.336l-3.866-13.333s4.065-1.393 4.264-.625l4.947 15.294Z" fill="#84CCAA"/><path d="M75.408 161.728c.149-.048.31.034.358.183l4.946 15.295a.285.285 0 0 1-.54.175l-4.947-15.295a.284.284 0 0 1 .183-.358ZM68.36 170.432v.011c0 .008 0 .021.002.038l.01.154c.01.136.029.335.06.586.064.504.181 1.216.395 2.046.427 1.664 1.237 3.789 2.766 5.666 1.528 1.875 4.006 3.545 6.297 4.361 1.145.408 2.22.594 3.092.501.863-.092 1.502-.451 1.852-1.118a.285.285 0 1 1 .503.263c-.46.881-1.3 1.315-2.295 1.42-.988.105-2.154-.107-3.343-.531-2.379-.847-4.947-2.574-6.546-4.537-1.598-1.961-2.437-4.171-2.877-5.883a17.371 17.371 0 0 1-.407-2.116 12.866 12.866 0 0 1-.077-.824v-.017l.283-.01-.284.01a.284.284 0 1 1 .568-.02ZM76.71 168.185a.284.284 0 1 0-.155-.547l-2.53.711a.284.284 0 1 0 .154.547l2.53-.711ZM77.418 169.228a.284.284 0 0 1-.197.35l-2.53.711a.284.284 0 1 1-.154-.547l2.53-.711a.285.285 0 0 1 .35.197ZM77.673 171.256a.283.283 0 1 0-.148-.548l-2.53.682a.284.284 0 1 0 .148.549l2.53-.683ZM78.242 172.269a.284.284 0 0 1-.196.351l-2.502.711a.284.284 0 0 1-.155-.547l2.502-.711a.284.284 0 0 1 .35.196ZM78.529 174.354a.284.284 0 1 0-.154-.547l-2.53.711a.283.283 0 1 0 .153.547l2.53-.711Z" fill="#000"/><path d="m76.86 164.017-5.06.256c-.768.028-1.337.682-1.308 1.45.028.767.682 1.336 1.45 1.307l5.572-.284a.56.56 0 0 0 .483-.767l-.597-1.592c-.057-.256-.284-.398-.54-.37Z" fill="#DA80A0"/><path d="m77.275 155.952 5.856-50.915s.768-8.586-6.169-9.922c-11.286-2.161-10.689 9.41-10.689 9.41l.029 53.19 10.973-1.763Z" fill="#F0E7D9"/><path d="m45.464 127.268-9.723 14.726 2.283 3.212h5.563l9.069-13.532c-.029.029-2.7-4.321-7.192-4.406Z" fill="#A67243"/><path d="m43.84 144.996-2.469 6.608s.797 1.802-.62 3.679c0 0-4.133 5.647-9.682 6.288-5.55.64-12.334-.426-6.23-7.354l11.316-12.808c.713-1.213 2.217-.534 7.685 3.587Z" fill="#009A8F"/><path d="M27.292 153.258s1.629 2.544 5.451.795l8.643-10.864s-3.231-2.833-3.707-2.199l-10.387 12.268Z" fill="#84CCAA"/><path d="M37.863 140.773a.284.284 0 0 0-.4.033l-10.388 12.268a.285.285 0 1 0 .434.367l10.387-12.267a.285.285 0 0 0-.033-.401ZM41.075 151.502v.002l-.004.008-.017.035a12.005 12.005 0 0 1-.347.657c-.25.442-.629 1.056-1.141 1.743-1.028 1.376-2.585 3.035-4.712 4.19-2.126 1.153-5.053 1.757-7.482 1.641-1.214-.058-2.279-.294-3.05-.711-.764-.413-1.219-.988-1.288-1.739a.283.283 0 0 0-.31-.256.283.283 0 0 0-.256.309c.091.99.703 1.71 1.584 2.186.874.472 2.032.719 3.294.779 2.522.12 5.554-.502 7.779-1.71 2.223-1.206 3.839-2.932 4.896-4.349a17.31 17.31 0 0 0 1.181-1.802c.13-.23.227-.415.292-.544l.073-.149.02-.04.004-.011.002-.003v-.001l-.259-.118.26.118a.284.284 0 1 0-.518-.235ZM34.205 146.251a.284.284 0 1 1 .35-.448l2.07 1.619a.284.284 0 0 1-.35.448l-2.07-1.619ZM33.154 146.946a.284.284 0 0 0 .049.399l2.07 1.619a.284.284 0 1 0 .35-.448l-2.07-1.618a.285.285 0 0 0-.4.048ZM32.147 148.726a.285.285 0 0 1 .346-.452l2.08 1.593a.284.284 0 1 1-.345.451l-2.081-1.592ZM31.236 149.446a.284.284 0 0 0 .048.399l2.044 1.608a.285.285 0 1 0 .351-.447l-2.044-1.607a.284.284 0 0 0-.399.047ZM30.178 151.266a.284.284 0 1 1 .35-.448l2.07 1.619a.284.284 0 0 1-.35.448l-2.07-1.619Z" fill="#000"/><path d="m35.65 142.338 4.584 2.16c.699.318.976 1.139.658 1.838-.318.699-1.139.977-1.838.659l-5.046-2.381a.56.56 0 0 1-.155-.893l1.157-1.246c.15-.215.414-.26.64-.137Z" fill="#DA80A0"/><path d="m39.55 135.171 20.014-47.163s3.582-7.846 10.263-5.601c10.888 3.696 4.662 13.447 4.662 13.447l-26.296 46.253-8.643-6.936Z" fill="#F0E7D9"/><path d="m54.987 130.111 17.967-31.158s2.132-4.577 5.941.426" stroke="#000" stroke-width=".569" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/><path d="m75.526 22.664.284 11.855-4.918 7.988-4.691-7.675-.256-6.596 9.58-5.572Z" fill="#A67243"/><path d="M69.158 3.532c-5.913-.54-11.741 4.776-10.86 13.475.938 8.983 7.25 14.64 10.718 14.64 4.349 0 9.807-8.585 9.41-15.863-.399-7.277-3.071-11.655-9.268-12.252Z" fill="#A67243"/><path d="M63.705 14.413c.215-.227.52-.394.842-.409.322-.015.658.136.796.41M70.44 14.413c.215-.227.521-.394.843-.409.32-.015.658.136.796.41" stroke="#000" stroke-width=".569" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/><path d="M64.394 18.355c.38 0 .689-.434.689-.97s-.308-.97-.689-.97c-.38 0-.689.434-.689.97s.309.97.689.97ZM71.436 18.355c.38 0 .688-.434.688-.97s-.308-.97-.688-.97c-.38 0-.69.434-.69.97s.31.97.69.97Z" fill="#000"/><path d="M67.697 17.831c.06 2.112-.912 3.456-.897 3.678.015.221.553.886 1.136.782M66.222 24.533s.87 1.125 4.025 0" stroke="#000" stroke-width=".569" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/><path d="M76.919 16.552s1.563-1.791 2.473-.91c.91.882 1.649 5.004-1.734 5.43 0 0-3.099-.114-.74-4.52ZM59.833 16.552s-1.563-1.791-2.473-.91c-.91.882-1.65 5.004 1.734 5.43 0 0 3.099-.114.739-4.52Z" fill="#A67243"/><path d="M70.465 31.676s4.691-2.928 5.885-6.766M79.221 17.263s-1.308-.882-1.109 2.103c0 0 .54-1.194.626-.824M57.616 17.263s1.307-.882 1.108 2.103c0 0-.54-1.194-.625-.824M69.954 43.843l.17 9.95" stroke="#000" stroke-width=".569" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/><path d="M77.26 34.69c.312-.995-.711-1.65-.597-2.73.312-2.928 1.904-5.401 2.956-8.073 2.132-5.459 2.53-13.078-.597-17.825-3.155-4.776-9.95-6.112-14.64-3.525-4.009 2.217-7.96 4.32-9.95 15.266-1.251 6.823-.683 9.95 1.336 13.22 2.018 3.809 7.277 8.272 7.76 13.616 0 0 2.161-1.137 3.298-3.383 0 0 4.634 3.355 5.373 5.43-.028.029 5.487-8.841 5.06-11.996ZM67.85 9.985c7.96.768 9.523 3.781 9.523 7.05 0 4.776-2.615 9.61-3.582 11.827-.739 1.705-1.108 3.809-.625 5.6-.938-1.08-2.7-1.592-3.781-2.331 0 0-8.5-3.44-10.149-10.69-.74-3.268-.142-12.309 8.614-11.456Z" fill="#DA80A0"/><path d="M77.402 13.766c-6.738-6.197-15.238-4.918-17.796.74-2.104 4.633-1.934 13.531 13.56 19.132 2.16.796 1.791 7.277-2.502 4.974M80.415 11.435c.91-12.65-12.992-12.281-16.488-9.012" stroke="#000" stroke-width=".569" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/><path d="M66.713 40.432a33.83 33.83 0 0 1-3.213 4.236c-.511-8.7-10.632-11.144-10.206-23.312.143-4.179 3.554-17.568 16.262-16.772M67.85 42.166c1.45.91 2.729 2.16 3.752 3.639.171.256.455.569.711.426a.865.865 0 0 0 .228-.227c1.051-1.507 1.734-3.326 2.388-5.089l2.302-6.225" stroke="#000" stroke-width=".569" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/></svg>'},"/5AG":function(e,t,n){"use strict";var a=n("ERkP"),i=n.n(a),r=n("7O4Y"),s=n("nmzr"),o=n("8jBL"),l=n("tN4z"),c=n("eqO1"),d=n("YK4x"),u=n("uDfI"),m=n("IbyE"),p=n("GuFu"),h=n("Agfx");const g=Object(h.makeStyles)((e=>Object(h.createStyles)({root:{borderBottom:`1px solid ${e.palette.border.main}`},navigationList:{paddingLeft:0,[e.breakpoints.up("md")]:{paddingLeft:"16px"}},studentPreview:{marginLeft:"auto",padding:"0 16px"},studentPreviewLabel:{"& span":{marginLeft:"8px"}}}))),b=e=>{const{navigationListItems:t,showStudentPreviewButton:n,studentPreviewOnclick:i}=e,h=Object(d.a)(),b=g(e),f=Object(u.e)((e=>m.Yb.app.getRoute(e).name)),v=e=>(null==f?void 0:f.indexOf(e))>=0,y=Object(c.t)(),S=Object(c.s)(y.breakpoints.up("md"));var C;const E=h((C="cr.components.courseNavigation.studentPreview",Object(p.h)("cr.components.courseNavigation","cr.components.courseNavigation.organization")(C)));return a.createElement(l.AnalyticsNavigationListScrollWrapper,{className:Object(r.a)(b.root,"js-course-navigation"),scrollLeftButtonAriaLabel:h("cr.components.courseNavigation.scrollLeftButtonAriaLabel"),scrollRightButtonAriaLabel:h("cr.components.courseNavigation.scrollRightButtonAriaLabel"),analyticsId:"course.navigation.list.scroll.wrapper"},a.createElement(l.AnalyticsNavigationList,{className:b.navigationList,navTagAriaLabel:h("cr.components.courseNavigation.navTagAriaLabel"),orientation:"horizontal",analyticsId:"course.navigation.list"},t.map((e=>{const t=(n=e.route).indexOf(s.n.COURSE_ANALYTICS)>=0?"course.getAnalytics.link":`${n}.link`;var n;return a.createElement(l.AnalyticsNavigationListItem,{href:e.href,active:void 0===e.activeTabRoute?v(e.route):v(e.activeTabRoute),analyticsId:t,key:e.route,className:e.className},a.createElement(l.AnalyticsListItemText,{analyticsId:`${t}.text`},a.createElement(l.AnalyticsTypography,{component:"span",variant:"subtitle2"},e.title)))}))),n&&a.createElement(l.AnalyticsIconButton,{analyticsId:"course.outline.studentPreview.link",className:Object(r.a)(b.studentPreview,"js-student-preview"),"aria-label":E,classes:{label:b.studentPreviewLabel},onClick:i},a.createElement(o.StudentPreview,null),S&&a.createElement(l.AnalyticsTypography,{className:"js-student-preview-label",component:"span",variant:"inherit"},E)))};var f=n("0x+l"),v=n("THXI");const y={width:"2px"},S="4px",C=Object(h.makeStyles)((e=>Object(h.createStyles)({autoMarked:{color:v.c.granite,backgroundColor:v.c.fog,borderRadius:"50%"},completed:{color:e.palette.success.main},container:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100%"},iconWrapper:{minWidth:"38px",minHeight:"38px",display:"flex",alignItems:"center",justifyContent:"center",margin:"-8px 0","& > span > span":{width:"100%",display:"flex",alignItems:"inherit",justifyContent:"inherit"}},offsetIconPositioning:{flex:"0 0 auto",margin:"-8px 0"},centeredIconPositioning:{flex:"0 0 auto",margin:"0"},completionLineBefore:{...y,flex:"0 0 auto",height:"28px",borderBottomLeftRadius:S,borderBottomRightRadius:S},completionLineAfter:{...y,flex:"1 1 auto",height:"8px",borderTopLeftRadius:S,borderTopRightRadius:S},completionLineAutoGrow:{flex:"1 1 auto",height:"unset"},completionComplete:{backgroundColor:e.palette.success.main},completionIncomplete:{backgroundColor:e.palette.secondary.main},completionHidden:{backgroundColor:"transparent"},noNeighborsCompletion:{display:"none"},noIconSpacing:{width:"38px"},completedHovering:{borderRadius:"50%","&:hover":{boxShadow:`0 0 0 8px ${e.palette.success.main}48`}},startedHovering:{borderRadius:"50%","&:hover":{boxShadow:`0 0 0 8px ${e.palette.primary.main}48`}}})));var E,I=n("zGdY");!function(e){e.None="none",e.Incomplete="incomplete",e.Completed="completed"}(E||(E={}));const k=(e,t,n)=>{const a=Object(d.a)(),i=C();if(e.visibility!==I.w.Visible)return I.u.Completed!==t?{iconStyles:"",tooltipText:""}:{iconStyles:i.completed,tooltipText:"",buttonStyles:""};if((e=>!(!m.i.Folder.isEqualTo(null==e?void 0:e.contentHandler)||m.j.isBbPage(e))||!!m.i.LearningModule.isEqualTo(null==e?void 0:e.contentHandler))(e))return I.u.Completed===t?{iconStyles:i.completed,tooltipText:""}:{iconStyles:i.autoMarked,tooltipText:a("courseCore.course.progress.reviewStateIcon.tooltips.childrenUpdatesWillAutoUpdateFolder")};if(I.u.None===t)return{iconStyles:i.autoMarked,tooltipText:a("courseCore.course.progress.reviewStateIcon.tooltips.unopened")};if(n){if(I.u.Started===t)return{iconStyles:i.autoMarked,tooltipText:a("courseCore.course.progress.reviewStateIcon.tooltips.submissionWillAutoUpdate")};if(I.u.Completed===t)return e.inSequence?{iconStyles:i.completed,tooltipText:""}:{iconStyles:i.completed,tooltipText:a("courseCore.course.progress.reviewStateIcon.tooltips.newAttemptWillAutoUpdate")}}if(!e.inSequence&&e.permissions.canUpdateReviewState){if(I.u.Started===t)return{iconStyles:i.startedHovering,tooltipText:a("courseCore.course.progress.reviewStateIcon.tooltips.canTransitionToComplete")};if(I.u.Completed===t)return{iconStyles:`${i.completed} ${i.completedHovering}`,tooltipText:a("courseCore.course.progress.reviewStateIcon.tooltips.canTransitionToStarted")}}return I.u.Completed===t?{iconStyles:i.completed,tooltipText:""}:{iconStyles:"",tooltipText:""}},w=({content:e,contentState:t,onReviewStateIconClick:n,hasAutomaticReviewStateTransition:i,beforeItemState:r,afterItemState:s,centerButton:o})=>{var c;const u=C(),{StateIcon:p,ariaLabel:h,ariaChecked:g}=((e,t)=>{const n=Object(d.a)(),a={contentItemTitle:e.title};let i="false";return t===I.u.Completed?i="true":t===I.u.Started&&(i="mixed"),e.visibility!==I.w.Visible?{StateIcon:f.LockCircle,ariaLabel:n("courseCore.course.progress.reviewStateIcon.ariaLabel.locked",a),ariaChecked:i}:I.u.Completed===t?{StateIcon:f.Complete,ariaLabel:n("courseCore.course.progress.reviewStateIcon.ariaLabel.completed",a),ariaChecked:i}:I.u.Started===t?{StateIcon:f.Started,ariaLabel:n("courseCore.course.progress.reviewStateIcon.ariaLabel.started",a),ariaChecked:i}:I.u.None===t?{StateIcon:f.Circle,ariaLabel:n("courseCore.course.progress.reviewStateIcon.ariaLabel.none",a),ariaChecked:i}:{StateIcon:f.Circle,ariaLabel:n("courseCore.course.progress.reviewStateIcon.ariaLabel.unlocked",a),ariaChecked:i}})(e,t),{iconStyles:b,tooltipText:v}=k(e,t,i),{beforeLineStateStyle:y,afterLineStateStyle:S,iconPositioning:w}=((e,t,n,a,i)=>{const r=C();let s=r.completionHidden,o=r.completionHidden,l=r.offsetIconPositioning;return m.i.LearningModule.isEqualTo(e.contentHandler)?(s=r.noNeighborsCompletion,o=r.noNeighborsCompletion,l=r.centeredIconPositioning):(n!==E.None&&(s=n===E.Completed?r.completionComplete:r.completionIncomplete),a!==E.None&&(o=t===I.u.Completed?r.completionComplete:r.completionIncomplete)),i&&(s+=` ${r.completionLineAutoGrow}`,o+=` ${r.completionLineAutoGrow}`),{beforeLineStateStyle:s,afterLineStateStyle:o,iconPositioning:l}})(e,t,r,s,null!=o&&o);return!!(null===(c=e.permissions)||void 0===c?void 0:c.canViewReviewState)?a.createElement("div",{className:u.container},a.createElement("div",{className:`${u.completionLineBefore} ${y}`}),e.permissions.canHaveReviewState?a.createElement(l.AnalyticsTooltip,{analyticsId:"course.outline.course-progress.review-state-icon-button.tooltip",title:v,placement:"top",className:w},a.createElement(l.AnalyticsIconButton,{"aria-disabled":e.inSequence||i||t===I.u.None,"aria-label":h,analyticsId:"course.outline.course-progress.review-state-icon-button.button",className:"js-review-state-icon-button",onClick:n,role:"checkbox","aria-checked":g},a.createElement("span",{"aria-hidden":"true"},a.createElement(p,{className:b})))):a.createElement("span",{className:u.iconWrapper},a.createElement("span",{className:w},a.createElement("span",{"aria-hidden":"true"},a.createElement(p,{className:b})))),a.createElement("div",{className:`${u.completionLineAfter} ${S}`})):a.createElement("div",{className:u.noIconSpacing})},T=({afterItemState:e,beforeItemState:t,contentId:n,courseId:i,hasAutomaticReviewStateTransition:r,onReviewStateIconClick:s})=>{const o=Object(p.a)(i,n),l=Object(p.b)(i,n)||I.u.None;return o?a.createElement(w,{afterItemState:e,beforeItemState:t,content:o,contentState:l,hasAutomaticReviewStateTransition:r,onReviewStateIconClick:s}):null};var O=n("UE5/"),A=n("jZnR");const P=Object(O.a)((e=>Object(A.a)({instructions:{marginBottom:"16px"},instructionBullets:{marginLeft:"8px"},beforeYouSaveHeader:{marginBottom:"16px"},beforeYouSave:{marginTop:"16px",display:"flex",flexDirection:"row"},informationIcon:{verticalAlign:"middle",marginRight:"8px",marginTop:"3px"},delayedChanges:{marginLeft:"42px",color:Object(c.h)("text.secondary",e)}}))),x=({disabled:e,courseProgressConfiguration:t,onCourseProgressConfigurationChanged:n})=>{const i=Object(p.h)("courseCore.course","courseCore.organization"),s=Object(d.a)(),o=P(),c=t.progressTrackingEnabled?"courseCore.course.progress.courseProgressConfiguration.toggleLabelOn":"courseCore.course.progress.courseProgressConfiguration.toggleLabelOff",[u,m]=Object(a.useState)(!1),[h]=Object(a.useState)(t.progressTrackingEnabled),g=a.useCallback((()=>{const e=!t.progressTrackingEnabled;n({...t,progressTrackingEnabled:e}),m(h&&!e)}),[t.progressTrackingEnabled,h,n,m]);return a.createElement("div",null,a.createElement("div",{className:Object(r.a)(o.instructions,"course-progress-configuration-instructions")},s("courseCore.course.progress.courseProgressConfiguration.instructionsHeader")),a.createElement("ul",null,a.createElement("li",{className:o.instructionBullets},s(i("courseCore.course.progress.courseProgressConfiguration.instructionsBulletPoint1"))),a.createElement("li",{className:o.instructionBullets},s(i("courseCore.course.progress.courseProgressConfiguration.instructionsBulletPoint2")))),a.createElement(l.AnalyticsFormControlLabel,{analyticsId:"features.course.oultine.course-progress-configuration.enable.switch.label",checked:t.progressTrackingEnabled,className:"js-enable-progress-tracking",control:a.createElement(l.AnalyticsSwitch,{analyticsId:"features.course.outline.course-progress-configuration.enable.switch",id:"progressTrackingEnable"}),disabled:e,htmlFor:"progressTrackingEnable","aria-label":s("courseCore.course.progress.courseProgressConfiguration.toggleAriaLabel"),label:s(c),onChange:g}),a.createElement("div",{className:o.delayedChanges},s("courseCore.course.progress.courseProgressConfiguration.delayedChanges")),u&&a.createElement("div",{className:o.beforeYouSave},a.createElement("div",{className:Object(r.a)(o.beforeYouSaveHeader,"course-progress-configuration-before-you-save-header")},a.createElement(f.Information,{className:o.informationIcon})),a.createElement("div",null,s(i("courseCore.course.progress.courseProgressConfiguration.beforeYouSave")))))};var $=n("caKH"),N=n("MC1S"),D=n("WBPx");const L=({onStay:e,onProceed:t,show:n})=>{const i=Object(d.a)();return a.createElement($.c,{hidden:!n,onDismiss:e,dialogContentProps:{type:N.DialogType.small,title:i("courseCore.course.progress.courseProgressConfiguration.confirmationModal.title"),showCloseButton:!0,isAlert:!0},analyticsId:"courseProgress.courseProgressConfiguration.saveConfirmation.dialog"},a.createElement("p",null,i("courseCore.course.progress.courseProgressConfiguration.confirmationModal.studentsWontSeeProgressMarks")),a.createElement(N.DialogFooter,null,a.createElement(D.AnalyticsDefaultButton,{onClick:e,analyticsId:"courseProgress.courseProgressConfiguration.saveConfirmation.dialog.cancel"},i("courseCore.course.progress.courseProgressConfiguration.confirmationModal.cancel")),a.createElement(D.AnalyticsPrimaryButton,{onClick:t,analyticsId:"courseProgress.courseProgressConfiguration.saveConfirmation.dialog.close"},i("courseCore.course.progress.courseProgressConfiguration.confirmationModal.confirm"))))};var j=n("AuQm");function M(e,t){return!t.inSequence||m.j.isFolderContentItem(t)||!e||m.j.isFolderContentItem(e)?E.None:e.state===I.u.Completed?E.Completed:E.Incomplete}var G=n("nsO7");const R=[I.w.Visible,I.w.Restricted],B=[I.w.Visible,I.w.Restricted,I.w.Hidden],F=({courseId:e,userId:t,visibility:n,contentId:i,total:r})=>{const s=Object(u.d)(),o=Object(p.y)({courseId:e,contentId:"ROOT"}),l=null==o?void 0:o.id,c="ROOT"===i&&null!=l?l:i,d=Object(u.e)((e=>m.Yb.contentReviewState.getContentReviewStateFirstUserContent(e,{userId:t,contentId:c,visibility:n})),G.isEqual),h=Object(a.useMemo)((()=>({courseId:e,userId:t,contentId:c,limit:20})),[e,t,c]),{isLoading:g,canLoadMore:b,nextOffset:f,count:v}=Object(u.e)((e=>m.Yb.contentReviewState.hasMoreContentReviewStateUserContent(e,h)),G.isEqual);Object(a.useEffect)((()=>{!l||g||!b||d.length>=r||s(m.V.contentReviewState.fetchMoreContentReviewStateUserContent({courseId:e,userId:t,contentId:c,paging:{offset:f,limit:20}}))}),[s,l,g,b,d.length,r,e,t,c,f]);const y=g||b&&d.length<r;return Object(a.useMemo)((()=>({canLoadMore:b,count:v,isLoading:y,items:d})),[d,b,y,v])};var U=n("n7/H"),_=n("6Wru");const z=Object(h.makeStyles)((e=>Object(h.createStyles)({row:{"& td":{padding:0,border:0,borderBottom:`1px solid ${e.palette.border.main}`,height:"100%"}},rowExpandable:{cursor:"pointer","&:hover > td":{backgroundColor:e.palette.background.b3}},rowIsExpanded:{"& td:first-child":{borderLeft:`1px solid ${e.palette.border.main}`},"& td:last-child":{borderRight:`1px solid ${e.palette.border.main}`}},rowLearningModule:{backgroundColor:e.palette.background.paper,"& > td":{borderBottom:`1px solid ${e.palette.border.main}`},"& td:first-child":{borderLeft:`1px solid ${e.palette.border.main}`},"& td:last-child":{borderRight:`1px solid ${e.palette.border.main}`}},rowIsChild:{"& td":{borderBottom:0},"& td:first-child":{borderLeft:`1px solid ${e.palette.border.main}`},"& td:last-child":{borderRight:`1px solid ${e.palette.border.main}`},"& $cellTitleContent, & $cellStatusExpandContainer":{borderBottom:`1px solid ${e.palette.border.main}`}},rowIsLastOnLevel:{"& td":{borderBottom:`1px solid ${e.palette.border.main}`},"& $cellTitleContent, & $cellStatusExpandContainer":{borderBottom:"0"}},rowText:{display:"flex",flexDirection:"row",alignItems:"center",width:"100%",padding:"16px 0"},cellTitleContainer:{display:"flex",flexDirection:"row",alignItems:"center",position:"relative",height:"100%"},cellTitleReviewIcon:{height:"100%",position:"absolute",top:"0",bottom:"0"},cellTitleContentIconTitle:{marginLeft:"36px",display:"flex",flexDirection:"row",alignItems:"center",flexGrow:1,height:"100%"},cellTitleContent:{display:"flex",flexDirection:"column",flexGrow:1,justifyContent:"center",padding:"24px 0",height:"100%",minHeight:"70px"},cellStatusExpandContainer:{display:"flex",justifyContent:"space-between",alignItems:"center",height:"100%"},statusContainer:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"flex-start",height:"100%",padding:"20px"},expandContainer:{display:"flex",justifyContent:"flex-end",height:"100%",padding:"20px","& > div":{alignItems:"center"}},expandButton:{marginInlineStart:"auto"}})));var q=n("50Q+");function H(e,t){return Math.max(("sm"===t?32:38)*e,0)}const V=Object(a.createContext)(0),W=V.Provider;function K(){return Object(a.useContext)(V)}const Y=()=>Object(h.useMediaQuery)((e=>e.breakpoints.up("sm")))?"md+":"sm",J=Object(h.makeStyles)((e=>({contentItemIcon:{marginRight:"10px",marginLeft:"34px"},contentItemComponent:{position:"relative",flex:"1 1 auto","&::after":{content:'""',position:"absolute",left:0,right:"var(--divider-inline-end, 0)",bottom:"-20px",borderTop:`1px solid ${e.palette.secondary.main}`},".content-list-item.root:last-of-type &":{position:"inherit"},".content-list-item.addable-item &::after":{display:"none"}},contentItemComponentDetails:{display:"flex"},contentVisibility:{display:"flex",flexDirection:"column",width:"fit-content",gap:"4px",[e.breakpoints.up("sm")]:{flexDirection:"row",gap:"12px"}},contentItemContentArea:{width:0,flex:"1 1 auto",display:"flex",flexDirection:"column",justifyContent:"center",minHeight:"38px"},contentItemContextArea:{display:"flex",minHeight:"29px",alignItems:"center",marginTop:"5px"},contentItemDescription:{padding:"8px 15px 0 0",marginBottom:0},dragHandle:{display:"flex",flexDirection:"column",justifyContent:"center"},overlaidIcon:({nestingLevel:e,indentationBreakpoint:t})=>({position:"absolute",height:"inherit",top:0,bottom:0,zIndex:1,marginLeft:`${H(e,t)}px`}),contentItemOverlaidIcon:{left:"-2px"}}))),Z=()=>{const e=K(),t=Y();return J({nestingLevel:e,indentationBreakpoint:t})},Q=e=>({backgroundColor:e.palette.brand.light,border:`2px solid ${e.palette.brand.main}`,borderLeft:"0",borderRight:"0",content:"''",position:"absolute",height:"13px",left:0,right:0});function X(e,t){return e<0?0:H(e,t)+82}const ee=Object(h.makeStyles)((e=>({contentList:({nestingLevel:t})=>({"--divider-inline-start":`${X(t,"sm")}px`,"--divider-inline-end":(t>0?12:0)+"px",[e.breakpoints.up("sm")]:{"--divider-inline-start":`${X(t,"md+")}px`}}),topDivider:({nestingLevel:t})=>({"--divider-inline-start":`${X(t-1,"sm")}px`,"--divider-inline-end":(t>1?12:0)+"px",[e.breakpoints.up("sm")]:{"--divider-inline-start":`${X(t-1,"md+")}px`}}),centeredDivider:{"--divider-inline-end":"15px","--divider-inline-start":"15px"},divider:({isButtonVisible:e})=>({"--add-button-opacity":e?1:0}),contentListItem:{position:"relative","&.root":{position:"relative"},"&.root:last-of-type":{"--divider-inline-start":0},"&.native-drag-top::before":{...Q(e),top:"-3px"},"&.native-drag-bottom::after":{...Q(e),bottom:"0"}}}))),{darken:te}=h.colorManipulator,ne=Object(h.makeStyles)((e=>({contentItemIcon:{position:"relative"},customIcon:{width:38},restrictedContentItemIcon:{"&::before":{content:'""',display:"block",position:"absolute",top:"16px",width:"50px",height:"1px",background:te(e.palette.border.main,.2),boxShadow:`0 0 0 2px ${e.palette.background.default}`,zIndex:1,"&":{flip:!1,left:"-8px",transform:"rotate(-45deg)"}}}}))),ae=Object(h.makeStyles)((()=>Object(h.createStyles)({contentIconContainer:{display:"inline-flex",position:"relative",margin:"0 18px 0 5px"},contentIcon:{width:"24px"},restrictedContentIcon:{"&::before":{top:"18px",width:"40px"}}})));const ie=e=>{var t,n,a;const{content:s,isAccessibleByStudent:o}=e,l=ae(),c=ne(),d=function(e){if(!e)return!1;switch(m.j.getContentHandler(e).toString()){case I.t.File:case I.t.Journal:case I.t.LtiLink:case I.t.LtiPlacement:case I.t.Page:case I.t.RusticiScorm:case I.t.TestLink:return!0;default:return!1}}(Object(p.a)(null!==(t=s.courseId)&&void 0!==t?t:"",null===(a=null===(n=s.contentDetail)||void 0===n?void 0:n[I.t.CourseLink])||void 0===a?void 0:a.linkSourceId)),u=i.a.createElement(q.a,{className:l.contentIcon,item:s,withLabel:!1});return i.a.createElement("span",{className:Object(r.a)(l.contentIconContainer,o?void 0:l.restrictedContentIcon,o?void 0:c.restrictedContentItemIcon)},d?i.a.createElement(j.B,null,u):u)},re=Object(h.makeStyles)((e=>Object(h.createStyles)({cellTitleContent:{fontWeight:e.typography.fontWeightSemiBold},cellTitleContentHidden:{color:e.palette.text.secondary},conditionalRelease:{display:"inline-flex",flexDirection:"row","& svg":{marginInlineEnd:"8px"}},conditionalReleaseText:{color:e.palette.text.secondary},statusCompactContainer:{[e.breakpoints.up("sm")]:{display:"none"}},statusCompact:{paddingInlineEnd:"4px"},visibilityHint:{color:e.palette.text.hint}}))),se=Object(h.makeStyles)((e=>Object(h.createStyles)({conditionalRelease:{display:"inline-flex",flexDirection:"row","& svg":{marginInlineEnd:"8px"}},conditionalReleaseText:{color:e.palette.text.secondary},conditionalReleaseButton:{display:"flex",backgroundColor:"unset",border:"none",padding:0,fontWeight:e.typography.fontWeightRegular,minHeight:"unset","&:hover, &:active, &:hover:active":{textDecoration:"underline",backgroundColor:"unset"}}})));var oe=n("VAMW");function le(){const[e]=Object(a.useState)((()=>Object(oe.e)(oe.d.CurrentCourseMembership).isStudentMembership()?"student":"instructor"));return e}const ce=Object(a.createContext)(null);var de=n("iFXv");function ue(){var e;const t=Object(a.useContext)(ce),n=Object(u.e)((e=>de.c.getRoute(e).params.courseId));return null!==(e=null!=t?t:n)&&void 0!==e?e:""}const me=new Map;function pe(e,t=""){const n=Object(u.d)(),i=Object(u.e)((e=>m.Yb.gradebookColumn.getGradebookColumnById(e,t))),r=Object(u.e)((e=>m.Yb.gradebookColumn.isLoading(e))),s=function(e,t=""){var n;return null!==(n=me.get(`${e}${t}`))&&void 0!==n&&n}(e,t),o=!!i;return Object(a.useEffect)((()=>{!e||!t||o||r||s||(!function(e,t=""){me.set(`${e}${t}`,!0)}(e,t),n(m.V.gradebookColumn.loadGradebookColumn({columnId:t,courseId:e,allowedErrors:[I.S.Forbidden]})))}),[n,e,t,o,r,s]),i}function he(e){const t=function(e){const t=Object(d.a)();if(e)return t("components.directives.content-item-base.conditionalRelease.acl-tooltip")}(m.h.getACLCriterion(e)),n=function(e){const t=Object(d.a)(),n=le();let a="";if((null==e?void 0:e.start)&&(null==e?void 0:e.end))a="both";else if(null==e?void 0:e.start)a="showon";else{if(!(null==e?void 0:e.end))return;a="hideafter"}return t(`components.directives.content-item-base.conditionalRelease.${n}-${a}-date-tooltip`,{showon:e.start?new Date(e.start):void 0,hideafter:e.end?new Date(e.end):void 0})}(m.h.getDateCriterion(e)),a=function(e){const t=Object(d.a)(),n=le(),a=m.h.getForcedSequenceCriterion(e),i=0===e.position;if(a&&"instructor"!==n)return t(`components.directives.content-item-base.conditionalRelease.student-forced-sequence${i?"-first":""}-item-tooltip`)}(e);return{acl:t,date:n,forcedSequence:a,performance:function(e){var t,n,a,i;const r=Object(d.a)(),s=le(),o=ue(),l=pe(o,null==e?void 0:e.gradeColumnId),c=Object(p.p)(o,null==l?void 0:l.gradingSchemaId);if(!e)return;if(!e.gradeColumnId||!l||!c)return{text:r(`components.directives.content-item-base.conditionalRelease.${s}-missing-column-error`),valid:!1};let u=`components.directives.content-item-base.conditionalRelease.${s}-lock-tooltip`;"number"!=typeof e.maxScore?u+="-common":e.minScore===e.maxScore?u+="-equal":u+="-custom";const m=l.columnName;switch(e.type){case I.Y.Grade:{if(void 0===e.maxScore&&c.scaleType!==I.Ub.Score&&c.scaleType!==I.Ub.Complete)break;const a="components.directives.content-item-base.conditionalRelease.point.plural";return{text:r(u,{title:m,minScore:r(a,{score:null!==(t=e.minScore)&&void 0!==t?t:0}),maxScore:r(a,{score:null!==(n=e.maxScore)&&void 0!==n?n:l.possible})}),valid:!0}}case I.Y.GradePercentage:if(void 0!==e.maxScore||c.scaleType===I.Ub.Percent){const t="components.directives.content-item-base.conditionalRelease.percentage";return{text:r(u,{title:m,minScore:r(t,{score:null!==(a=e.minScore)&&void 0!==a?a:0}),maxScore:r(t,{score:null!==(i=e.maxScore)&&void 0!==i?i:l.possible})}),valid:!0}}if(c.scaleType===I.Ub.Tabular){const t=[...c.symbols].sort(((e,t)=>e.absoluteTranslation-t.absoluteTranslation)).find((({absoluteTranslation:t})=>{var n;return t>=(null!==(n=e.minScore)&&void 0!==n?n:0)}));return{text:r(u,{title:m,minScore:null==t?void 0:t.symbol}),valid:!0}}}return{text:r(u,{title:m,minScore:"",maxScore:""}),valid:!0}}(m.h.getPerformanceCriterion(e))}}const ge=Object(h.makeStyles)((()=>({tooltipList:{margin:"0px 0px 0px 12px"}}))),be=e=>{var t,n,a;const{item:r}=e,{translate:s,formatItems:o}=Object(_.a)(),l=ge(),c=he(r);let d;d=!1===(null===(t=c.performance)||void 0===t?void 0:t.valid)?[c.performance.text]:[c.acl,null===(n=c.performance)||void 0===n?void 0:n.text,c.date,c.forcedSequence].filter((e=>!!e));const u=function(e){let t="";return e.acl&&e.date&&e.performance?t="courseCore.components.contentItems.conditionalRelease.courseMembersAndDateAndTimeAndPerformance":e.acl&&e.performance?t="courseCore.components.contentItems.conditionalRelease.courseMembersAndPerformance":e.acl&&e.date?t="courseCore.components.contentItems.conditionalRelease.courseMembersAndDateAndTime":e.date&&e.performance?t="courseCore.components.contentItems.conditionalRelease.dateAndTimeAndPerformance":e.acl?t="courseCore.components.contentItems.conditionalRelease.courseMembers":e.date?t="courseCore.components.contentItems.conditionalRelease.dateAndTime":e.performance&&(t="courseCore.components.contentItems.conditionalRelease.performance"),t}(c),m=r.title;return i.a.createElement(h.Tooltip,{isCustomTitle:!0,"aria-label":`${s(u,{contentItemTitle:m})} ${o(d)}`,title:d.length>1?i.a.createElement("ul",{className:l.tooltipList},d.map((e=>i.a.createElement("li",{key:e},e)))):i.a.createElement("div",null,null!==(a=d[0])&&void 0!==a?a:"")},e.children)},fe=e=>{const{analyticsId:t,content:n}=e,a=Object(d.a)(),r=se(),s=Object(p.h)("courseCore.course","courseCore.organization");return i.a.createElement("span",{className:r.conditionalRelease},n.inSequence?i.a.createElement(l.AnalyticsTypography,{variant:"caption",className:r.conditionalReleaseText},a(s("courseCore.course.progress.student.studentsNeedToCompletePrevious"))):i.a.createElement(be,{item:n},i.a.createElement(l.AnalyticsDefaultButton,{analyticsId:`${t}.releaseButton`,className:r.conditionalReleaseButton},i.a.createElement(f.Lock,null),i.a.createElement(l.AnalyticsTypography,{variant:"caption",className:r.conditionalReleaseText},a("components.directives.content-visibility.conditional-availability")))))},ve=Object(h.makeStyles)((e=>Object(h.createStyles)({statusLine:{textDecoration:"underline",backgroundColor:"unset",border:"none",padding:0,fontWeight:e.typography.fontWeightRegular,"&:hover, &:active, &:hover:active":{textDecoration:"underline",backgroundColor:"unset"}}}))),ye=({analyticsId:e,children:t,isAnonymousTest:n,result:a})=>{const r=ve(),s=Object(d.a)(),[o,c]=i.a.useState(!1);if(a.status||!n)return i.a.createElement(i.a.Fragment,null,t);const u=s("courseContent.contentProgress.progressAvailableAfterPostingGrades");return i.a.createElement(l.AnalyticsTooltip,{analyticsId:`${e}.notAvailableTooltip`,title:u,open:o,onOpen:()=>c(!0),onClose:()=>c(!1)},i.a.createElement(l.AnalyticsDefaultButton,{className:r.statusLine,onClick:()=>c((e=>!e)),analyticsId:`${e}.notAvailableButton`},t))},Se=e=>{const{analyticsId:t,className:n,isAccessibleByStudent:a,isAnonymousTest:s,result:o,statusLabel:l,statusDate:c}=e,{translate:d,formatDatetime:u}=Object(_.a)(),p=re(),h=m.j.isConditionalReleaseLocked(o.content),g=i.a.createElement(ye,{analyticsId:t,isAnonymousTest:s,result:o},i.a.createElement("span",{className:"js-progress-status-label"},l));return i.a.createElement("div",{className:n},i.a.createElement("span",{className:Object(r.a)(p.cellTitleContent,a?void 0:p.cellTitleContentHidden)},o.content.title),h&&i.a.createElement(fe,{analyticsId:`${t}.release`,content:o.content}),i.a.createElement("span",{className:p.statusCompactContainer},i.a.createElement("span",{className:p.statusCompact},d("courseCore.course.progress.student.statusColonLabel",{status:i.a.createElement("strong",null,d("courseCore.course.progress.student.status")),statusLabel:g})),c?i.a.createElement("span",null,u(c,U.ILocaleDatetimeFormat.Short)):void 0))},Ce=i.a.memo((function({analyticsId:e,courseId:t,userId:n,result:a,level:s,indexOnLevel:o,numberOfItemsOnlevel:c,lastItemOnLevel:d,beforeItemState:u,afterItemState:g,contentLoader:b,visibility:f}){var v,y,S,C,E,k,T,O;const A=z(),{formatDatetime:P}=Object(_.a)(),x=(e=>{const t=Object(h.useTheme)();return{paddingInlineStart:e*(Object(h.useMediaQuery)(t.breakpoints.down("xs"))?20:32)+"px"}})(s),$=Object(h.useTheme)(),N=Object(h.useMediaQuery)($.breakpoints.down("xs")),[D,L]=i.a.useState(!1),M=m.j.getContentHandler(a.content),G=Object(p.o)({courseId:t}),R=G.gradebookColumns.find((e=>e.contentId===a.contentId)),B=!0===(null==R?void 0:R.anonymousGrading),F=m.j.requiresManualMarking(a.content),H=Object(p.c)(null===(v=a.status)||void 0===v?void 0:v.state,F),V=null!==(E=null!==(S=null===(y=a.status)||void 0===y?void 0:y.reviewedDate)&&void 0!==S?S:null===(C=a.status)||void 0===C?void 0:C.startedDate)&&void 0!==E?E:null,W=s>0,K=m.B.isLearningModule(a.content),Y=m.j.isFolderContentItem(a.content)||K,J=i.a.useCallback((e=>{L((e=>!e)),e.stopPropagation()}),[L]),Z=a.content.visibility===I.w.Hidden,Q=m.j.isConditionalReleaseLocked(a.content),X=!Z&&!Q,ee=Object(q.p)(t,a.content),te=0===s&&0===o?0:-1;let ne;return Y&&(ne=D?"true":"false"),!G.view||G.view.isLoading?i.a.createElement(i.a.Fragment,null):i.a.createElement(i.a.Fragment,null,i.a.createElement(l.AnalyticsTableRow,{analyticsId:e,"aria-level":s+1,"aria-expanded":ne,"aria-posinset":o+1,"aria-setsize":c,role:"row",tabIndex:te,onClick:Y?J:void 0,className:Object(r.a)({[A.row]:!0,[A.rowExpandable]:Y,[A.rowIsExpanded]:D,[A.rowLearningModule]:K,[A.rowIsChild]:W,[A.rowIsLastOnLevel]:!D&&d})},i.a.createElement(l.AnalyticsTableCell,{analyticsId:`${e}.name`,role:"gridcell"},i.a.createElement("div",{className:A.cellTitleContainer,style:x},i.a.createElement("div",{className:A.cellTitleReviewIcon},i.a.createElement(w,{content:a.content,contentState:null!==(T=null===(k=a.status)||void 0===k?void 0:k.state)&&void 0!==T?T:I.u.None,hasAutomaticReviewStateTransition:null!==(O=a.content.inSequence)&&void 0!==O&&O,beforeItemState:u,afterItemState:g,centerButton:!0})),i.a.createElement("div",{className:A.cellTitleContentIconTitle},!K&&i.a.createElement(ie,{content:a.content,isAccessibleByStudent:X}),i.a.createElement("span",{className:"sr-only"},ee),i.a.createElement(Se,{analyticsId:`${e}.title`,result:a,isAccessibleByStudent:X,isAnonymousTest:B,statusLabel:H,statusDate:V,className:A.cellTitleContent}),b))),!N&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.AnalyticsTableCell,{analyticsId:`${e}.status`,role:"gridcell"},i.a.createElement("div",{className:A.cellStatusExpandContainer},i.a.createElement("div",{className:A.statusContainer},i.a.createElement(ye,{analyticsId:e,isAnonymousTest:B,result:a},i.a.createElement("span",{className:"js-progress-status-label"},H)),V?i.a.createElement(l.AnalyticsTypography,{variant:"body2"},P(V,U.ILocaleDatetimeFormat.Short)):void 0),i.a.createElement("div",{className:A.expandContainer},Y?i.a.createElement(j.g,{open:D}):void 0))))),D?i.a.createElement(Oe,{key:`row-container-${a.contentId}-children`,courseId:t,userId:n,level:s+1,lastItemOnLevel:d,parentContentId:a.contentId,parentContentHandler:M,analyticsId:e,visibility:f}):void 0)})),Ee=Object(h.makeStyles)((e=>Object(h.createStyles)({empty:{textAlign:"center",borderLeft:`1px solid ${e.palette.border.main}`,borderRight:`1px solid ${e.palette.border.main}`,padding:"20px"},emptyRootLevel:{border:0}})));var Ie=n("ajRr"),ke=n.n(Ie);const we=({analyticsId:e,contentHandler:t,level:n,courseId:a,userId:s,parentContentId:o})=>{const c=Object(d.a)(),u=Ee(),g=Object(h.useTheme)(),b=Object(h.useMediaQuery)(g.breakpoints.down("xs")),f=Object(p.h)("courseCore.course","courseCore.organization"),{items:v}=F({courseId:a,userId:s,visibility:B,contentId:o,total:1}),y=0===n,S=c(function(e,t,n){return t.length>0?e.isEqualTo(m.i.LearningModule)?n("courseCore.course.progress.student.emptyLearningModuleWithNotVisibleItems"):n("courseCore.course.progress.student.emptyFolderWithNotVisibleItems"):e.isEqualTo(m.i.LearningModule)?"components.directives.learning-module.empty":"components.directives.folder.empty"}(t,v,f));return i.a.createElement(l.AnalyticsTableRow,{analyticsId:`${e}.empty.row`},i.a.createElement(l.AnalyticsTableCell,{analyticsId:`${e}.empty.row.cell`,colSpan:b?1:2,className:Object(r.a)({[u.empty]:!0,[u.emptyRootLevel]:y})},y?i.a.createElement(j.A,{illustration:ke.a,prominentText:c(f("courseCore.course.progress.student.thisIsWhereYouViewProgress"))}):S))},Te=Object(h.makeStyles)((e=>Object(h.createStyles)({loading:{padding:"20px"},loadingSpinner:{display:"flex",justifyContent:"center"},loadingBorder:{border:`1px solid ${e.palette.border.main}`,borderTop:0}}))),Oe=Object(a.memo)((function({analyticsId:e,courseId:t,userId:n,visibility:s,level:o,lastItemOnLevel:c,parentContentId:u,parentContentHandler:m}){const p=Object(d.a)(),g=Object(h.useTheme)(),b=Object(h.useMediaQuery)(g.breakpoints.down("xs")),f=Te(),[v,y]=Object(a.useState)(20),{items:S,canLoadMore:C,isLoading:E,count:I}=F({courseId:t,userId:n,visibility:s,contentId:u,total:v}),k=Math.min(20,I?I-S.length:20),w=i.a.useCallback((async()=>{y((e=>e+20))}),[y]);return i.a.createElement(i.a.Fragment,null,!E&&0===S.length&&!C&&i.a.createElement(we,{courseId:t,userId:n,parentContentId:u,analyticsId:e,contentHandler:m,level:o}),E&&i.a.createElement("tr",null,i.a.createElement("td",{colSpan:b?1:2,className:Object(r.a)(f.loading,o>0?f.loadingBorder:void 0)},i.a.createElement("div",{className:f.loadingSpinner},i.a.createElement(l.AnalyticsCircularProgress,{ariaLabel:p("global.loading"),size:"medium"})))),S.map(((a,r)=>{var l,d;const u=null===(l=S[r-1])||void 0===l?void 0:l.content,m=null===(d=S[r+1])||void 0===d?void 0:d.content,p=M(u,a.content),h=M(m,a.content),g=(c||1===o)&&r===S.length-1;return i.a.createElement(Ce,{courseId:t,userId:n,result:a,level:o,key:`student-progress-item-${a.content.id}`,analyticsId:`${e}.row`,beforeItemState:p,afterItemState:h,numberOfItemsOnlevel:null!=I?I:S.length,indexOnLevel:r,lastItemOnLevel:g,visibility:s,contentLoader:r===S.length-1?i.a.createElement(j.y,{loader:w,incomingLoadCount:E||void 0!==I&&I<S.length?0:k}):void 0})})))})),Ae=Object(h.makeStyles)((e=>Object(h.createStyles)({table:{tableLayout:"fixed",height:"1px"},tableHeaderCell:{backgroundColor:"unset",borderTop:"0",width:"100%"},tableHeaderStatus:{width:"300px",[e.breakpoints.up("lg")]:{width:"500px"}},tableHeaderExpand:{width:"64px"}})));var Pe=n("P+Wz");const xe='a[href], button, input, textarea, select, details, [tabindex]:not([tabindex="-1"])';function $e(e){let t=e.nextElementSibling;for(;null!==t&&"row"!==t.getAttribute("role");)t=t.nextElementSibling;return t instanceof HTMLElement?t:null}function Ne(e){let t=e.previousElementSibling;for(;null!==t&&"row"!==t.getAttribute("role");)t=t.previousElementSibling;return t instanceof HTMLElement?t:null}function De(e,t){return Array.from(t.querySelectorAll('[role="gridcell"]')).indexOf(e)}function Le(e,t){return e.querySelectorAll('[role="gridcell"]').item(t)}function je(e,t){const n=e.parentElement;if(!n||!t)return null;return Le(t,De(e,n))}function Me(e){let t=e;for(;null!==t&&"row"!==t.getAttribute("role");)t=t.parentElement;return t}function Ge(e){const t=e.querySelectorAll(`[role="row"], [role="gridcell"], ${xe}`);null==t||t.forEach((e=>e.setAttribute("tabindex","-1")))}function Re(e,t){if(t){Ge(e),t.setAttribute("tabindex","0"),t.focus();const n=Me(t);n&&(n.setAttribute("tabindex","0"),n.querySelectorAll(xe).forEach((e=>e.setAttribute("tabindex","0"))))}}function Be(e){return{onKeyDown:i.a.useCallback((t=>{var n;const a=e.current;if(!a)return;const i=document.activeElement,r="row"===(null==i?void 0:i.getAttribute("role")),s="gridcell"===(null==i?void 0:i.getAttribute("role")),o=null!==(n=null==a?void 0:a.querySelectorAll('[role="row"]'))&&void 0!==n?n:[],l=o[0],c=o[o.length-1],d=Me(i);switch(t.key){case Pe.Key.ArrowDown:return void(r?Re(a,$e(i)):s&&Re(a,function(e){const t=e.parentElement;return t?je(e,$e(t)):null}(i)));case Pe.Key.ArrowUp:return void(r?Re(a,Ne(i)):s&&Re(a,function(e){const t=e.parentElement;return t?je(e,Ne(t)):null}(i)));case Pe.Key.ArrowRight:if(r)"false"===i.getAttribute("aria-expanded")?i.click():Re(a,null==i?void 0:i.querySelector('[role="gridcell"]'));else if(s&&d){Re(a,Le(d,De(i,d)+1))}return;case Pe.Key.ArrowLeft:if(r)if("true"===i.getAttribute("aria-expanded"))i.click();else{const e=i.getAttribute("aria-level"),t=null!==e?parseInt(e,10):NaN;if(!Number.isNaN(t)&&t>1){let t=i.previousElementSibling;for(;null!==t&&t.getAttribute("aria-level")===e;)t=t.previousElementSibling;Re(a,t instanceof HTMLElement?t:null)}}else if(s&&d){const e=De(i,d);Re(a,0===e?i.parentElement:Le(d,e-1))}return;case Pe.Key.Home:if(r)Re(a,l),t.preventDefault();else if(s&&d)if(t.ctrlKey){Re(a,Le(l,De(i,d))),t.preventDefault()}else Re(a,null==d?void 0:d.querySelector('[role="gridcell"]')),t.preventDefault();return;case Pe.Key.End:if(r)Re(a,c),t.preventDefault();else if(s){const e=i.parentElement;if(e)if(t.ctrlKey){Re(a,Le(c,De(i,e))),t.preventDefault()}else{const n=e.querySelectorAll('[role="gridcell"]');Re(a,n[n.length-1]),t.preventDefault()}}return;case Pe.Key.Tab:Ge(a),d&&(d.setAttribute("tabindex","0"),d.querySelectorAll(xe).forEach((e=>e.setAttribute("tabindex","0"))))}}),[e])}}const Fe=({analyticsId:e,courseId:t,userId:n,visibility:a})=>{const s=Object(d.a)(),o=Ae(),c=Object(h.useTheme)(),u=Object(h.useMediaQuery)(c.breakpoints.down("xs")),p=i.a.useRef(null),{onKeyDown:g}=Be(p);return i.a.createElement("div",{ref:p,onKeyDown:g},i.a.createElement(l.AnalyticsTable,{analyticsId:`${e}.table`,className:o.table,role:"treegrid","aria-label":s("courseCore.course.progress.student.tableAriaLabel")},i.a.createElement(l.AnalyticsTableHead,{analyticsId:`${e}.table.head`},i.a.createElement(l.AnalyticsTableRow,{analyticsId:`${e}.table.head.row`},i.a.createElement(l.AnalyticsTableCell,{analyticsId:`${e}.table.head.row.name`,className:o.tableHeaderCell},s("courseCore.course.progress.student.itemName")),!u&&i.a.createElement(l.AnalyticsTableCell,{analyticsId:`${e}.table.head.row.status`,className:Object(r.a)(o.tableHeaderCell,o.tableHeaderStatus)},s("courseCore.course.progress.student.status")))),i.a.createElement(l.AnalyticsTableBody,{analyticsId:`${e}.table.body`},i.a.createElement(Oe,{courseId:t,userId:n,visibility:a,level:0,lastItemOnLevel:!1,parentContentId:"ROOT",parentContentHandler:m.i.Folder,analyticsId:`${e}.table.body`}))))},Ue=Object(h.makeStyles)((()=>Object(h.createStyles)({studentProgress:{paddingTop:"18px"},filters:{marginBottom:"20px"}}))),_e=Object(h.makeStyles)((e=>Object(h.createStyles)({filter:{width:"100%",[e.breakpoints.up("sm")]:{minWidth:"250px",width:"unset"}}})));var ze;!function(e){e.StudentVisible="StudentVisible",e.All="All"}(ze||(ze={}));const qe=Object(a.memo)((function({analyticsId:e,visibility:t,onVisibilityChange:n}){const a=_e(),r=Object(d.a)(),s=Object(p.h)("courseCore.course","courseCore.organization"),o=[{value:ze.StudentVisible,label:r(s("courseCore.course.progress.student.availability.visible"))},{value:ze.All,label:r("courseCore.course.progress.student.availability.all")}];return i.a.createElement(l.AnalyticsTextField,{analyticsId:e,select:!0,id:"course-student-progress-filter-availability",label:r("courseCore.course.progress.student.availability.content"),floatingLabel:!0,className:a.filter,value:t,onChange:e=>n(e.target.value)},o.map((t=>i.a.createElement(l.AnalyticsMenuItem,{button:!0,key:t.value,value:t.value,analyticsId:`${e}.menu.${t.value}`},t.label))))})),He=Object(a.memo)((function({analyticsId:e,visibility:t,onVisibilityChange:n}){return i.a.createElement(qe,{visibility:t,onVisibilityChange:n,analyticsId:`${e}.filters.visibility`})}));var Ve=n("RPob");const We=({courseId:e,userId:t,analyticsId:n})=>{const r=Ue(),s=Object(d.a)(),[o,l]=Object(a.useState)(ze.StudentVisible),c=o===ze.StudentVisible?R:B;return i.a.createElement("div",{className:r.studentProgress},i.a.createElement("div",{className:r.filters},i.a.createElement(He,{analyticsId:n,visibility:o,onVisibilityChange:e=>{switch(l(e),e){case ze.StudentVisible:Object(Ve.u)(s("courseCore.course.progress.student.availability.ariaLiveVisibleToStudents"));break;case ze.All:Object(Ve.u)(s("courseCore.course.progress.student.availability.ariaLiveAll"))}}})),i.a.createElement(Fe,{analyticsId:n,courseId:e,userId:t,visibility:c}))};var Ke;!function(e){e.ModifyConfiguration="course.progress.settings.MODIFY",e.ViewConfiguration="course.progress.settings.VIEW",e.ViewProgressInformation="course.progress.information.VIEW"}(Ke||(Ke={}));var Ye=n("kcGO");function Je(e){const t=Object(Ye.f)(e);t&&e.updateState(t,!0)}var Ze=n("np6O");const Qe=Object(h.makeStyles)((e=>Object(h.createStyles)({courseBannerWrapper:{position:"relative",width:"100%",maxHeight:"240px",height:"calc((100vw - 16px) / 4)",[e.breakpoints.up("md")]:{height:"calc((100vw - 34px) / 5)"},display:"flex",justifyContent:"flex-end",alignContent:"center"},courseBanner:e=>({position:"absolute",top:0,left:0,bottom:0,right:0,backgroundImage:`url("${e.bannerUrl}")`,backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundSize:"cover",width:"100%"}),editBannerButton:{backgroundColor:e.palette.background.default,color:e.palette.text.secondary,height:"max-content",borderRadius:36,"&:active, &:focus, &:hover":{color:e.palette.text.primary},margin:"10px",[e.breakpoints.up("sm")]:{margin:"20px"}}}))),Xe=e=>{const{bannerUrl:t,onEditBanner:n,bannerAltText:i}=e,s=Object(d.a)(),o=Qe(e),l=!!t,c=!!n;return a.createElement(a.Fragment,null,l&&a.createElement("div",{className:o.courseBannerWrapper},a.createElement("div",{role:i?"img":void 0,"aria-label":i||void 0,className:Object(r.a)("js-course-banner",o.courseBanner)}),c&&a.createElement(Ze.AnalyticsIconButton,{analyticsId:"course.course-overview.course-banner.edit.banner.button",className:o.editBannerButton,"aria-label":s("course.course-overview.banner.edit-banner-button"),onClick:n},a.createElement(f.Edit,null))))},et=Object(h.makeStyles)((e=>Object(h.createStyles)({mainContainer:{display:"flex",height:"36px",alignItems:"center",borderBottom:`1px solid ${e.palette.secondary.main}`,marginBottom:"12px",paddingBottom:"16px",[e.breakpoints.up("sm")]:{marginBottom:"15px"}},headerWrapper:{flex:"1",maxWidth:"none",display:"flex",alignItems:"center"}}))),tt=Object(h.makeStyles)((e=>Object(h.createStyles)({courseOverviewInfoHeaderControls:{display:"flex"}}))),nt=e=>{const{children:t}=e,n=tt();return a.createElement("div",{className:Object(r.a)("js-course-overview-info-header-controls",n.courseOverviewInfoHeaderControls)},t)},at=Object(h.makeStyles)((e=>Object(h.createStyles)({headerInfoToggle:{display:"flex",[e.breakpoints.up("md")]:{display:"none"}}}))),it=e=>{const{id:t,analyticsId:n,panelControlId:r,isExpanded:s,preferenceKey:o,title:c,setIsExpanded:d}=e,u=at(),m=Object(p.B)(o),h=Object(p.w)(),[g,b]=Object(a.useState)(!1);Object(a.useEffect)((()=>{m&&!g&&d("true"===m.value)}),[m,g,d]);return i.a.createElement(l.AnalyticsIconButton,{id:t,analyticsId:n,onClick:()=>{b(!0),d(!s),h({key:o,value:s?"false":"true"})},className:u.headerInfoToggle,"aria-label":c,"aria-expanded":s,"aria-controls":s?r:void 0},i.a.createElement(j.g,{open:s,hideOnDesktop:!0}))},rt=(e,t)=>`${e}${t}`.replace(/_/g,"."),st=e=>{const{analyticsId:t,courseId:n,children:s,className:o,headerControls:c,title:d,expansionButtonId:u,isStudentPreview:m,preferenceKey:p,panelControlId:g}=e,b=et(),[f,v]=Object(a.useState)(!0),y=rt(m?p+".student.preview":p,n),S=Object(h.useMediaQuery)((e=>e.breakpoints.up("md")));return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:Object(r.a)("js-course-overview-info-header",o,b.mainContainer)},i.a.createElement("div",{className:b.headerWrapper},i.a.createElement(l.AnalyticsTypography,{component:"h2",variant:"h2"},d)),i.a.createElement(nt,null,c,i.a.createElement(it,{id:u,analyticsId:t,isExpanded:f,preferenceKey:y,setIsExpanded:v,title:d,panelControlId:g}))),(f||S)&&s)};var ot=n("M4Wd"),lt=n("xD/U"),ct=n("hYYj"),dt=n("gjTx"),ut=n("t69S"),mt=n("6RBU"),pt=n("xppW"),ht=n("Rfwc");const gt=Object(h.makeStyles)((e=>Object(h.createStyles)({courseInstructorsRoot:{marginBottom:"36px"},fullListContainer:{zIndex:10,width:"300px"},fullListContent:{padding:"8px 16px 0 16px"},viewAllButton:{color:e.palette.link.active,backgroundColor:"transparent",textDecoration:"underline",marginTop:"4px",display:"block",lineHeight:"21px"},closeButton:{position:"absolute",top:"9px",right:"9px"},fullListWrapper:{paddingTop:"12px"},listRoot:{paddingTop:0},emptyState:{backgroundColor:e.palette.background.b3,color:e.palette.text.primary,display:"flex",justifyContent:"center",alignItems:"center",height:"50px",fontStyle:"italic"},listItemAvatar:{minWidth:"unset"},listItemRoot:{padding:"4px 0px","&:first-child":{paddingTop:"1px"}},listItemWithMessageLinkRoot:{cursor:"pointer"},instructorAvatar:{display:"flex",marginLeft:"-4px"},username:{whiteSpace:"nowrap",marginRight:"9px",textOverflow:"ellipsis",overflow:"hidden",color:e.palette.text.primary,backgroundColor:e.palette.background.default},messageLinkRoot:{display:"flex","&, &:focus, &:hover, &:active, &:active:hover":{color:e.palette.primary.main}},roleBadge:{textTransform:"uppercase",fontSize:e.typography.fontSizeXSmall,fontWeight:e.typography.fontWeightBold,color:e.palette.text.primary,backgroundColor:e.palette.background.b3,padding:"0px 10px"}}))),bt=e=>{const{id:t,currentUserId:n,courseId:i,instructorListMemberships:o,canCurrentUserSendMessage:l,ariaLabelledBy:c}=e,u=Object(d.a)(),[m,h]=Object(a.useState)(!1),g=gt(),b=m?"courseCore.components.courseInstructors.showLess":"courseCore.components.courseInstructors.showMore",f=Object(p.h)("courseCore.components.courseInstructors","courseCore.components.courseInstructors.organization"),v=f(m?"courseCore.components.courseInstructors.showLessAriaLabel":"courseCore.components.courseInstructors.showMoreAriaLabel"),y=Object(a.useCallback)(((e,t)=>{var n;e.stopPropagation(),i&&(null===(n=null==t?void 0:t.user)||void 0===n?void 0:n.id)&&s.Z.goPeekState(Object(s.ab)({courseId:i,recipientIds:t.user.id}))}),[i]);return o?a.createElement("div",{id:t,role:"region","aria-labelledby":c,className:Object(r.a)(g.courseInstructorsRoot,"js-course-instructors-root")},0===o.length&&a.createElement("div",{className:Object(r.a)(g.emptyState,"js-empty-state")},u(f("courseCore.components.courseInstructors.emptyStateText"))),o.length>0&&a.createElement(ht.a,{classes:{root:g.listRoot}},(m?o:o.slice(0,2)).map((e=>{var t,i,s;const o=l&&(null===(t=null==e?void 0:e.user)||void 0===t?void 0:t.id)!==n;return a.createElement(lt.a,{key:e.id,classes:{root:Object(r.a)(g.listItemRoot,o?g.listItemWithMessageLinkRoot:"","js-instructor-list-item")},onClick:o?t=>y(t,e):void 0},a.createElement(ot.a,{className:g.listItemAvatar},a.createElement(ut.a,{className:Object(r.a)(g.instructorAvatar,"js-instructor-avatar"),size:"medium",src:null===(s=null===(i=e.user)||void 0===i?void 0:i.avatar)||void 0===s?void 0:s.permanentUrl,alt:u("courseCore.components.courseInstructors.avatarAltText",{user:e.user})})),a.createElement(ct.a,{primary:a.createElement("div",{className:Object(r.a)(g.username,"js-instructor-username")},a.createElement(q.e,{ariaHidden:!0,format:U.ILocaleUsernameFormat.Short,user:e.user})),secondary:e.roleBadgeText&&a.createElement(pt.a,{classes:{badge:Object(r.a)(g.roleBadge,"js-role-badge")},position:"inline",badgeContent:e.roleBadgeText})}),o&&a.createElement(dt.a,{href:"#",onClick:o?t=>y(t,e):void 0,classes:{root:Object(r.a)(g.messageLinkRoot,"js-send-message-link")},"aria-label":u("courseCore.components.courseInstructors.sendMessageAriaLabel",{instructor:e.user})},a.createElement(mt.a,null)))}))),o&&o.length>2&&a.createElement("button",{"data-analytics-id":"courseOverviewInstructorListComponent.toggleFullListButton",className:Object(r.a)(g.viewAllButton,"js-toggle-full-list-button"),id:"view-all-button",onClick:()=>h(!m),"aria-expanded":m,"aria-label":u(v)},u(b))):null},ft="course-instructors-panel",vt="course-instructors-expansion-button",yt=(e,t,n)=>{if(t){if(t.identifier.toString()in m.bc){let a=m.bc[t.identifier.toString()];return n&&(a=a.replace("global.course","global.organization")),e(a)}return n?t.orgName.rawValue:t.courseName.rawValue}},St=e=>{const{courseId:t,isOrganization:n,isStudentPreview:r}=e,s=Object(d.a)(),{memberships:o,users:l}=Object(p.g)((e=>({courseId:e,sort:[{field:I.gb.Role,direction:I.Wb.Ascending},{field:I.gb.DisplayOrder,direction:I.Wb.Ascending},{field:I.gb.FamilyName,direction:I.Wb.Ascending},{field:I.gb.GivenName,direction:I.Wb.Ascending}],filter:{roleBucket:[I.y.Teaching],membershipAvailable:!0}}))(t)),c=Object(p.h)("courseCore.components.courseInstructors","courseCore.components.courseInstructors.organization"),u=Object(a.useMemo)((()=>o&&l?o.map((e=>({...e,user:l[e.userId],roleBadgeText:yt(s,e.courseRole,n)}))):[]),[o,l,n,s]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(st,{analyticsId:"courseOverview.courseInstructors.expandOrCollapse",courseId:t,title:s(c("courseCore.components.courseInstructors.headerText")),isStudentPreview:r,expansionButtonId:vt,panelControlId:ft,preferenceKey:"course.outline.faculty.expanded",className:"js-course-skip-link-target"},i.a.createElement(bt,{id:ft,ariaLabelledBy:vt,instructorListMemberships:u,...e})))},Ct=Object(h.makeStyles)((e=>Object(h.createStyles)({root:{marginBottom:"36px"},addCourseScheduleButtonWrapper:{display:"flex",flexDirection:"column"},addCourseScheduleButton:{width:"100%","&, &:focus, &:hover, &:active, &:active:hover":{color:e.palette.primary.main,textDecoration:"none"}},skipLink:{marginTop:"8px"},editButton:{marginLeft:"auto",height:"38px",width:"38px",display:"flex",alignItems:"center",justifyContent:"center"}})));var Et=n("wgY5"),It=n.n(Et),kt=n("EZIA"),wt=n("7yMF"),Tt=n("WcH3"),Ot=n("wPSj"),At=n("Kftt"),Pt=n("M0dR"),xt=n("6lVL"),$t=n("Jt4C");const Nt=Object(h.makeStyles)((e=>Object(h.createStyles)({scheduleList:{color:e.palette.text.primary},scheduleItem:{flexWrap:"wrap",paddingTop:"0",paddingBottom:"16px",marginBottom:"16px",borderBottom:`1px solid ${e.palette.border.main}`,"&:last-of-type":{paddingBottom:"0",marginBottom:"0",borderBottom:"none"}},scheduleItemSection:{width:"100%",display:"flex"},alignItemsFlexStart:{marginTop:"4px"},otherMeetingTimesLink:{display:"block",marginTop:"16px"}}))),Dt=(e,t,n)=>((e,t)=>{const n=It()(e);return 1439===It()(t).diff(n,"minutes")})(e,t)?n("courseCore.components.courseSchedule.allDayEvent"):n("courseCore.components.courseSchedule.eventTime",{startTime:e,endTime:t}),Lt=(e,t,n,a)=>{const i=e=>((e,t,n,a)=>{const{recurRules:i}=e,r=new Date;if(i)switch(i.freq){case"DAILY":return t(i,r);case"MONTHLY":return n(i,r);default:return a(i,r)}return e.startDate})(e,t,n,a);return e.length>1&&e.sort(((e,t)=>i(e)>i(t)?1:-1)),e},jt=e=>{const{id:t,courseSchedule:n,courseSchedulePanelHref:i,ariaLabelledBy:s,getNextEventForMonthlyRepeat:o,getNextEventForDailyRepeat:l,getNextEventForWeeklyRepeat:c}=e,{translate:d,formatDate:u}=Object(_.a)(),m=Nt(),p=e=>{const{recurRules:t}=e;if(!(null==t?void 0:t.freq))return null;if(t.freq===I.r.Weekly)return((e,t,n)=>{var a,i;return null===(i=null===(a=e.recurRules)||void 0===a?void 0:a.byWeekDay)||void 0===i?void 0:i.map((e=>It()(e,"dd").format())).sort(((e,t)=>e>t?1:-1)).map((e=>n(new Date(e),U.ILocaleDateFormat.LongWeekday))).join(t("courseCore.components.courseSchedule.weekdayDelimiter",{},{noWrap:!0}))})(e,d,u);const n=new Date;return t.freq===I.r.Monthly?d("courseCore.components.courseSchedule.nextMonthlyEvent",{nextMonthlyEventDate:o(t,n)}):t.freq===I.r.Daily?d("courseCore.components.courseSchedule.nextDailyEvent",{nextDailyEventDate:l(t,n)}):void 0};return a.createElement("div",{className:m.scheduleList,id:t,role:"region","aria-labelledby":s},a.createElement(wt.a,{analyticsId:"courseOverview.courseSchedule.list"},(()=>{const e=Lt(n,l,o,c);return e.length>2?e.slice(0,2):e})().map((e=>{var t;return a.createElement(Tt.a,{className:m.scheduleItem,alignItems:"flex-start",analyticsId:"courseOverview.courseSchedule.listItem",key:null===(t=e.recurRules)||void 0===t?void 0:t.repeatRuleId},a.createElement("div",{className:m.scheduleItemSection},a.createElement(Ot.a,{analyticsId:"courseOverview.courseSchedule.listItem.time.icon",classes:{alignItemsFlexStart:m.alignItemsFlexStart}},a.createElement(xt.a,{"aria-label":d("courseCore.components.courseSchedule.time")})),a.createElement(At.a,{primary:p(e),secondary:a.createElement(a.Fragment,null,a.createElement(Pt.a,{component:"span",color:"textPrimary"},Dt(e.startDate,e.endDate,d))),analyticsId:"courseOverview.courseSchedule.listItem.time.text"})),e.location?a.createElement("div",{className:m.scheduleItemSection},a.createElement(Ot.a,{analyticsId:"courseOverview.courseSchedule.listItem.location.icon",classes:{alignItemsFlexStart:m.alignItemsFlexStart}},a.createElement($t.a,{role:"presentation"})),a.createElement(At.a,{primary:d("courseCore.components.courseSchedule.location"),secondary:a.createElement(j.C,{plainText:e.location,analyticsIdTagPrefix:"courseCore.components.courseSchedule.location.text"}),analyticsId:"courseOverview.courseSchedule.listItem.location.text"})):null)}))),n.length<=2?null:a.createElement(kt.a,{className:Object(r.a)(m.otherMeetingTimesLink,"js-other-meeting-times-link"),analyticsId:"courseCode.components.courseSchedule.view.link",href:i},d("courseCore.components.courseSchedule.otherMeetingTimesLink",{number:n.length-2})))},Mt=e=>{const{courseId:t,courseSchedulePanelHref:n,canCreateCourseSchedule:a}=e,s=Object(d.a)(),o=Ct(),c=rt("hide.add.courseSchedule.button.course",t),u=Object(p.B)(c),m="true"===(null==u?void 0:u.value),h=Object(p.w)(),g=Object(p.h)("courseCore.components.courseSchedule","courseCore.components.courseSchedule.organization");return m||!a?null:i.a.createElement("div",{className:Object(r.a)(o.addCourseScheduleButtonWrapper,"button-wrap")},i.a.createElement(l.AnalyticsDashedButton,{className:Object(r.a)(o.addCourseScheduleButton,"js-add-course-schedule-button"),analyticsId:"courseCore.components.courseSchedule.add.link",href:n},s(g("courseCore.components.courseSchedule.addCourseScheduleButton"))),i.a.createElement(l.AnalyticsLink,{className:Object(r.a)(o.skipLink,"js-skip-link"),analyticsId:"courseCore.components.courseSchedule.skip.link",component:"button",onClick:()=>{h({key:c,value:"true"})}},s("courseCore.components.courseSchedule.skipLink")))},Gt="course-schedule-panel",Rt="course-schedule-expansion-button",Bt=e=>{const{courseId:t,courseSchedule:n,isStudentPreview:a}=e,o=Object(d.a)(),c=Ct(),u=Object(p.r)(t,["course.calendar-entry.course-schedule.CREATE"]),m=Object(s.cb)(s.l.CourseSchedule({courseId:t})),h=Object(p.h)("courseCore.components.courseSchedule","courseCore.components.courseSchedule.organization");return n?i.a.createElement("div",{className:c.root},n.length?i.a.createElement(i.a.Fragment,null,i.a.createElement(st,{analyticsId:"courseOverview.courseSchedule.expandOrCollapse",courseId:t,title:o(h("courseCore.components.courseSchedule.headerText")),isStudentPreview:a,expansionButtonId:Rt,panelControlId:Gt,preferenceKey:"course.outline.schedule.expanded",headerControls:i.a.createElement(i.a.Fragment,null,u&&i.a.createElement(l.AnalyticsLink,{className:Object(r.a)(c.editButton,"js-edit-course-schedule-button"),analyticsId:"courseOverview.courseSchedule.edit.link","aria-label":o(h("courseCore.components.courseSchedule.editCourseScheduleButton")),href:m,color:"secondary"},i.a.createElement(f.Edit,null)))},i.a.createElement(jt,{id:Gt,ariaLabelledBy:Rt,courseSchedulePanelHref:m,...e}))):i.a.createElement(Mt,{courseId:t,courseSchedulePanelHref:m,canCreateCourseSchedule:!!u})):null},Ft=Object(a.createContext)({AddContentButton:()=>null,fileUploads:!1});function Ut(){const{fileUploads:e}=Object(a.useContext)(Ft);if(!e)throw new Error("ContentOutline is trying to upload files without the context to do so!");return e}const _t=Object(h.makeStyles)((e=>({placeholderContainer:{backgroundColor:e.palette.background.b5,margin:"10px 0",padding:"20px"},placeholderText:{fontWeight:e.typography.fontWeightBold,textAlign:"center"}}))),zt=()=>{const e=Object(d.a)(),t=_t(),n=Object(a.useRef)(null);return Object(a.useEffect)((()=>{var e;null===(e=n.current)||void 0===e||e.focus()}),[]),i.a.createElement("div",{className:t.placeholderContainer,ref:n,tabIndex:-1},i.a.createElement("div",{className:t.placeholderText},e("components.directives.content-item-base.copy-placeholder")),i.a.createElement("div",{className:"sr-only"},e("components.directives.content-item-base.please-wait")))};var qt=n("C9bf"),Ht=n("fN3Q");function Vt(e){var t;return!!(null===(t=e.permissions)||void 0===t?void 0:t.create)}const Wt=new WeakMap;function Kt(e,t){if((null==t?void 0:t.stable)&&Wt.has(e))return Wt.get(e);if(e.id)return e.id;let n=Wt.get(e);return n||(n=Object(Ht.v4)()),Wt.set(e,n),n}function Yt(e,t){const n=null!=t?t:document,a=Kt(e);return n.querySelector(`[data-content-id="${a}"]`)}function Jt(e){return(null==e?void 0:e.matches("[data-content-id]"))?e:null}function Zt(e){return Jt(e.nextElementSibling)}function Qt(e){return Jt(e.previousElementSibling)}function Xt(e){var t;return Jt(null===(t=e.parentElement)||void 0===t?void 0:t.closest("[data-content-id]"))}function en(e){const t=function(e){return null==e?void 0:e.querySelector(".ax-focusable-title")}(e);null==t||t.focus()}var tn=n("fpIG"),nn=n("ZvIw"),an=n("1hyT");function rn(e){var t;return!!(null===(t=e.ui)||void 0===t?void 0:t.isUploading)}const sn=e=>{var t,n,i;const r=null!==(i=null===(n=null===(t=e.contentDetail)||void 0===t?void 0:t[I.t.CourseLink])||void 0===n?void 0:n.linkSourceId)&&void 0!==i?i:"",s=Object(oe.g)();return Object(a.useEffect)((()=>{r&&s((()=>e.getLinkContentSource()))}),[s,r,e]),e.ui.linkSource};function on(e){return!!m.j.canViewAsInstructor(e)&&!e.isAvailable}function ln(e){return m.j.isConditionalReleaseLocked(e)||m.j.isRestricted(e)&&!m.j.canViewAsInstructor(e)}const cn=e=>{const{item:t}=e,n=sn(t),a=n&&on(n),r=n&&ln(n);switch(Object(oe.i)(oe.b.ContentUpdate,((e,n)=>{var a;n.id&&(null===(a=t.ui.linkSource)||void 0===a?void 0:a.id)===n.id&&(t.ui.linkSource=n)})),Object(oe.i)(oe.b.UpdateReviewState,((e,a)=>{const i=Object(oe.e)(oe.d.CurrentCourseMembership).isStudentMembership();Object(oe.e)(oe.d.LearningModuleRefreshChildrenOperations).refreshCourseLinksWhichTargetIsInLearningModule(t,i,n)})),function(e){if(!e||!(null==e?void 0:e.contentHandler))return;const t=e.contentHandler.toString();return t.startsWith(I.t.LtiPlacement)?I.t.LtiPlacement:m.j.isBbPage(e)?I.t.Document:t}(n)){case I.t.TestLink:return i.a.createElement(fr,{item:t,linkedItem:n,isRestricted:a,readOnly:r});case I.t.Discussion:return i.a.createElement(Pi,{item:t,linkedItem:n,isRestricted:a,readOnly:r});case I.t.Document:return i.a.createElement(Di,{item:t,linkedItem:n,isRestricted:a,readOnly:r});case I.t.Journal:return i.a.createElement(rr,{item:t,linkedItem:n,isRestricted:a,readOnly:r});case I.t.RusticiScorm:return i.a.createElement(gr,{item:t,linkedItem:n,isRestricted:a,readOnly:r});case I.t.File:return i.a.createElement(Gi,{item:t,linkedItem:n,isRestricted:a,readOnly:r});case I.t.LtiPlacement:return i.a.createElement(Pr,{item:t,linkedItem:n});case I.t.LtiLink:return i.a.createElement(Ar,{item:t,linkedItem:n});default:return i.a.createElement(Ti,{item:t})}};var dn=n("MlM1"),un=n("zJ2Y");const mn=Object(h.makeStyles)((e=>({icon:{verticalAlign:"text-top",color:e.palette.indicatorPrimary.main}}))),pn=e=>{const{id:t}=e,n=mn(),a=Object(d.a)();return i.a.createElement(un.a,{id:t,className:n.icon,titleAccess:a("components.directives.content-item-base.aria-label.indicator")})},hn=Object(h.makeStyles)((e=>({container:{display:"flex",alignItems:"baseline",gap:"8px"},contentItemTitle:{maxWidth:"100%",width:"fit-content",color:e.palette.text.primary,fontWeight:e.typography.fontWeightSemiBold,fontSize:e.typography.fontSizeMedium,lineHeight:"1.4",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",textDecoration:"inherit","&:hover, &:focus, &:active:hover":{color:"inherit",textDecoration:"inherit"}},hoverable:{"&:hover, &:active:hover":{textDecoration:"underline"}},isRestricted:{color:e.palette.text.secondary,cursor:"pointer","&:hover, &:focus, &:active:hover":{color:e.palette.text.secondary}},readOnly:{cursor:"default","&:hover, &:active:hover":{textDecoration:"none",cursor:"default"}}}))),gn=i.a.forwardRef((function(e,t){const{analyticsId:n,"aria-describedby":s,children:o,className:c,isRestricted:d=!1,notAccessible:u=!1,hasActivityIndicator:m=!1,readOnly:p,...h}=e,[g]=Object(a.useState)((()=>Object(Ht.v4)())),b=hn(),f=p?void 0:n,{href:v,onClick:y,"aria-expanded":S,"aria-controls":C,...E}=h;let I="span";p?I="div":e.href?I="a":e.onClick&&(I="button");const k=Object(r.a)(s,m&&g);return i.a.createElement("div",{className:b.container},i.a.createElement(l.AnalyticsLink,{className:Object(r.a)(b.contentItemTitle,p?b.readOnly:b.hoverable,d&&b.isRestricted,c,"ax-focusable-title"),"aria-describedby":k||void 0,"aria-expanded":p?void 0:S,"aria-controls":p?void 0:C,component:I,analyticsId:f,ref:t,"aria-hidden":u,tabIndex:u?-1:0,...p?E:h},o),m&&i.a.createElement(pn,{id:g}))})),bn=Object(h.makeStyles)((e=>{var t;const n=Object(c.p)(null!==(t=e.palette.brand.light)&&void 0!==t?t:e.palette.brand.main,.3);return{contentItem:{width:"100%",height:"100%",display:"flex",padding:"20px 0px","&:hover":{backgroundColor:e.palette.background.b3},position:"relative","@media (hover: none) and (pointer: coarse)":{userSelect:"none","-webkit-user-select":"none","-webkit-touch-callout":"none"}},clickable:{cursor:"pointer"},draggable:{cursor:"grab"},dragOverlayOuter:{backgroundColor:e.palette.background.b3,outline:`${e.palette.brand.main} solid 2px`,boxShadow:e.shadows[10],cursor:"grabbing",opacity:.9},dragOverlay:{pointerEvents:"none"},draggingOuter:{backgroundColor:e.palette.brand.light},dragging:{opacity:0},highlighted:{"&&":{outline:`${e.palette.brand.main} solid 1px`,backgroundColor:n,"&:hover":{backgroundColor:n}}},nesting:({nestingLevel:e,indentationBreakpoint:t})=>({paddingLeft:`${H(e,t)}px`})}})),fn=Object(a.createContext)({isSorting:!1}),vn=Object(qt.c)({key:"contentOutline/highlightedContentIdState",default:void 0}),yn=Object(qt.d)({key:"contentOutline/isHighlightedState",get:e=>({get:t})=>!!e&&t(vn)===e}),Sn=Object(qt.c)({key:"contentOutline/togglablesOpenState",default:{}}),Cn=Object(qt.d)({key:"contentOutline/isTogglableOpen",get:e=>({get:t})=>{var n;return!!e&&(null!==(n=t(Sn)[e])&&void 0!==n&&n)},set:e=>({get:t,set:n},a)=>{e&&n(Sn,{...t(Sn),[e]:!(a instanceof qt.a)&&a})}}),En=e=>{const{className:t,contentId:n,readOnly:s,draggable:o,...l}=e,{isDragOverlay:c,isDragging:d,listeners:u,isSorting:m}=Object(a.useContext)(fn),p=Object(qt.g)(yn(n)),h=(({nestingLevel:e})=>{const t=Y();return bn({nestingLevel:e,indentationBreakpoint:t})})({nestingLevel:K()}),g=Object(r.a)(h.contentItem,h.nesting,{[h.clickable]:!s,[h.dragOverlay]:c,[h.dragging]:d,[h.draggable]:o&&!m,[h.highlighted]:p},t);return i.a.createElement("div",{className:Object(r.a)(c&&[h.dragOverlayOuter,"dragOverlay"],d&&h.draggingOuter,"itemContainer")},i.a.createElement(j.f,{className:g,...u,...l}))},In=e=>{const{Icon:t,className:n,showAlertIcon:a,isRestricted:s,titleAccess:o,showLinkBadge:l,customIconUrl:c}=e,d=ne(e),u=a?"error":"primary",m=c?i.a.createElement("img",{src:Object(Ve.d)(c),className:d.customIcon,alt:o}):i.a.createElement(t,{color:u,titleAccess:o});return i.a.createElement("div",{className:Object(r.a)(d.contentItemIcon,s&&d.restrictedContentItemIcon,n)},l?i.a.createElement(j.B,null,m):m)};function kn(e){var t;const n=Object(d.a)();return(null===(t=e.systemGeneratedLocalizableDescription)||void 0===t?void 0:t.languageKey)?n(e.systemGeneratedLocalizableDescription.languageKey):e.description}const wn=Object(a.createContext)({});const Tn=e=>{const{previousNeighborId:t,nextNeighborId:n}=e,r=Object(a.useMemo)((()=>({neighborBefore:{contentId:t},neighborAfter:{contentId:n}})),[t,n]),s=wn.Provider;return i.a.createElement(s,{value:r},e.children)};function On(e,t){const{neighborBefore:n,neighborAfter:i}=Object(a.useContext)(wn),r=Object(p.a)(e,null==n?void 0:n.contentId),s=Object(p.a)(e,null==i?void 0:i.contentId);return{beforeItemState:M(r,t),afterItemState:M(s,t)}}const An=e=>{var t;const{item:n,supportsManualTransition:a}=e,r=null!==(t=n.id)&&void 0!==t?t:"",s=ue(),o=Object(p.b)(s,r),l=function(){const e=Object(u.d)();return(t,n,a)=>{var i;const r=null!==(i=n.id)&&void 0!==i?i:"",s=null!=a?a:I.u.None,o=Object(Ye.g)(s);m.j.canUpdateReviewState(n)&&o&&r&&t&&!n.inSequence&&e(m.V.contentReviewState.persistContentReviewState(t,r,o))}}(),c=a?()=>l(s,n,o):()=>{},{beforeItemState:d,afterItemState:h}=On(s,n);return i.a.createElement(w,{beforeItemState:d,afterItemState:h,content:n,contentState:o||I.u.None,hasAutomaticReviewStateTransition:!m.j.canUpdateReviewState(n),onReviewStateIconClick:c})};const Pn=Object(h.makeStyles)((()=>Object(h.createStyles)({visibilityIcon:{marginRight:"8px"},root:{display:"flex",alignItems:"center",lineHeight:1.4}})));var xn=n("2Lcf"),$n=n("p87j");const Nn=e=>{const{variant:t}=e,n=Pn(),a=Object(d.a)(),r=Object(p.h)("components.directives.content-visibility","components.directives.content-visibility.organization");return i.a.createElement("div",{className:n.root},"medium"===t?i.a.createElement(xn.a,{className:n.visibilityIcon}):i.a.createElement($n.a,{className:n.visibilityIcon}),i.a.createElement("span",null,a(r("components.directives.content-visibility.visible"))))};var Dn=n("L87A"),Ln=n("STfh");const jn=e=>{const{variant:t}=e,n=Pn(),a=Object(d.a)(),r=Object(p.h)("components.directives.content-visibility","components.directives.content-visibility.organization");return i.a.createElement("div",{className:n.root},"medium"===t?i.a.createElement(Dn.a,{className:n.visibilityIcon}):i.a.createElement(Ln.a,{className:n.visibilityIcon}),i.a.createElement("span",null,a(r("components.directives.content-visibility.hidden"))))};var Mn=n("5jhJ"),Gn=n("GAfu");const Rn=e=>{const{variant:t}=e,n=Object(d.a)(),a=Pn();return i.a.createElement("div",{className:a.root},"medium"===t?i.a.createElement(Mn.a,{className:a.visibilityIcon}):i.a.createElement(Gn.a,{className:a.visibilityIcon}),i.a.createElement("span",null,n("components.directives.content-visibility.conditional-availability")))};function Bn(e){return m.h.hasOnlyForcedSequenceConditionalReleaseCriteria(e)?!!e.isAvailable:m.j.isVisibleToStudents(e)}function Fn(e){return m.h.hasOnlyForcedSequenceConditionalReleaseCriteria(e)?!e.isAvailable:m.j.isHiddenFromStudents(e)}function Un(e){return!Bn(e)&&!Fn(e)&&m.h.isConditionalRelease(e)}const _n=e=>{const{item:t,variant:n="small"}=e;return Bn(t)?i.a.createElement(Nn,{variant:n}):Fn(t)?i.a.createElement(jn,{variant:n}):Un(t)?i.a.createElement(Rn,{variant:n}):i.a.createElement(i.a.Fragment,null)};var zn=n("4vxQ"),qn=n("izEs"),Hn=n("AfZX");const Vn=Object(h.makeStyles)((()=>Object(h.createStyles)({visibilityIcon:{marginRight:"8px"},visibilityText:{overflow:"hidden",textOverflow:"ellipsis"},root:{marginTop:"5px",marginLeft:"1px",alignSelf:"start",maxWidth:"100%"},inputRoot:{border:0,backgroundColor:"transparent"},inputFocused:{"&&":{boxShadow:"none"}},selectRoot:{paddingLeft:0,minHeight:"inherit"}})));function Wn(e){const t=Object(oe.e)(oe.d.ConditionalReleaseCourseModelOperations);e.visibility=function(e){return e.isAvailable?I.w.Visible:I.w.Hidden}(e);const n=["isAvailable","isPartiallyVisible","adaptiveReleaseRules"],a=e.getAssociatedGradingColumn();return a&&(a.visible=e.isAvailable,n.push("contentDetail")),t.save(e,n,["assignedGroups,selfEnrollmentGroups.group"])}async function Kn(e,t,n){const a=Object(oe.e)(oe.d.ConditionalReleaseCourseModelOperations),i=Object(oe.e)(oe.d.Content);return m.h.isConditionalRelease(t)&&a.conditionalReleaseAsync(t,"DELETE"),function(e,t){switch(e.adaptiveReleaseRules={startDate:null,endDate:null},t){case I.w.Visible:e.isAvailable=!0,e.isPartiallyVisible=!1;break;case I.w.Hidden:e.isAvailable=!1,e.isPartiallyVisible=!1;break;case I.w.Restricted:e.isAvailable=!0,e.isPartiallyVisible=!0}}(t,e),n?(r=t,(s=n).adaptiveReleaseRules=r.adaptiveReleaseRules,s.isAvailable=r.isAvailable,s.isPartiallyVisible=r.isPartiallyVisible,await Wn(n),await i.updateCourseLinks(n,!0)):(await Wn(t),await i.updateCourseLinks(t,!0));var r,s}async function Yn(e,t,n,a){const{confirmed:i}=await function(e,t,n){return m.h.isConditionalRelease(t)&&!m.h.hasOnlyForcedSequenceConditionalReleaseCriteria(t)?n():Promise.resolve({confirmed:!0})}(0,t,a);i&&await Kn(e,t,n)}function Jn(e,t){return!m.h.isConditionalRelease(e)||function(e,t){const n=(a=e.adaptiveReleaseRules,(null==a?void 0:a.rules)?a.rules.map((e=>e.criteria)).filter((e=>void 0!==e)).reduce(((e,t)=>t.concat(e)),[]):null);var a;return t.entitledToDeleteConditionalRelease||!n||m.h.canDeleteAllCriteria(e,n)}(e,t)}function Zn(e,t,n){return!n&&!!e.id&&!!t.entitledToViewConditionalRelease}const Qn={visibilityType:I.w.Visible,textKey:"components.directives.content-visibility.visible",resolveKey:!0,analyticsId:"components.directives.content-visibility.visible.link",mediumIcon:xn.a,smallIcon:$n.a,displayPredicate:Jn},Xn={visibilityType:I.w.Hidden,textKey:"components.directives.content-visibility.hidden",resolveKey:!0,analyticsId:"components.directives.content-visibility.hidden.link",mediumIcon:Dn.a,smallIcon:Ln.a,displayPredicate:Jn},ea={visibilityType:I.w.Restricted,textKey:"components.directives.content-visibility.conditional-availability",resolveKey:!1,analyticsId:"components.directives.content-visibility.conditional-availability.link",mediumIcon:Mn.a,smallIcon:Gn.a,displayPredicate:Zn},ta=e=>{const{exitCallback:t}=e,[n,r]=Object(a.useState)(!1),[s,o]=Object(a.useState)(!1),c=Object(d.a)(),u=(e=!1)=>{o(e),r(!0)};return i.a.createElement($.a,{analyticsId:"course.conditionalRelease.removeConditionalAvailability",open:!n,TransitionProps:{onExited:()=>{t(s),r(!1)}}},i.a.createElement(h.DialogTitle,{onClose:()=>u()},c("course.conditionalRelease.removeConditionalAvailability.title")),i.a.createElement(h.DialogContent,null,i.a.createElement(h.DialogContentText,null,c("course.conditionalRelease.removeConditionalAvailability.instructions"))),i.a.createElement(h.DialogActions,null,i.a.createElement(l.AnalyticsDefaultButton,{analyticsId:"course.conditionalRelease.removeConditionalAvailability.global.cancel",onClick:()=>u()},c("global.cancel")),i.a.createElement(l.AnalyticsPrimaryButton,{analyticsId:"course.conditionalRelease.removeConditionalAvailability.global.continue",onClick:()=>u(!0)},c("global.continue"))))};var na=n("YPaW");const aa=Object(h.makeStyles)((e=>Object(h.createStyles)({courseLinkVisibilityWarningBanner:{padding:"12px"},fixedMaxWidth:{maxWidth:"200px"}}))),ia=({fixedMaxWidth:e})=>{const t=aa(),n=Object(d.a)(),a=Object(p.h)("components.directives.content-visibility","components.directives.content-visibility.organization");return i.a.createElement(na.a,{severity:"info",className:t.courseLinkVisibilityWarningBanner},i.a.createElement("div",{className:Object(r.a)({[t.fixedMaxWidth]:e})},n(a("components.directives.content-visibility.courseLinkInfo"))))};function ra(e){return Bn(e)?I.w.Visible:Fn(e)?I.w.Hidden:Un(e)?I.w.Restricted:void 0}const sa=e=>{const{item:t,variant:n,entitlements:r,disableRestricted:o,showCourseLinkWarning:l}=e,{displayModal:c,modal:u}=Object(j.lb)(ta),h=Object(d.a)(),g=Vn(),[b,f]=Object(a.useState)((()=>ra(t))),[v,y]=Object(a.useState)(l),S=Object(p.h)("components.directives.content-visibility","components.directives.content-visibility.organization"),C=sn(t),E=ra(t);function k(e){const a="medium"===n?e.mediumIcon:e.smallIcon,s=e.resolveKey?S(e.textKey):e.textKey;return e.displayPredicate(t,r,o)?i.a.createElement(qn.a,{button:!0,value:e.visibilityType,analyticsId:e.analyticsId},i.a.createElement(a,{className:g.visibilityIcon}),i.a.createElement("span",{className:g.visibilityText},h(s))):null}return Object(a.useEffect)((()=>{f(E)}),[E]),i.a.createElement(i.a.Fragment,null,u,i.a.createElement(zn.a,{select:!0,value:b,className:g.root,onChange:e=>{const n=e.target.value;f(n),async function(e,t,n,a){var i;if(e!==I.w.Restricted)return Yn(e,t,n,a);s.Z.goPeekState(s.j.EditConditionalRelease({contentId:null!==(i=t.id)&&void 0!==i?i:""}))}(n,t,C,c)},InputProps:{classes:{root:g.inputRoot,focused:g.inputFocused}},SelectProps:{MenuProps:Hn.b,classes:{root:g.selectRoot},onOpen:()=>{if(!(l||m.j.isFolderContentItem(t)||m.j.isDiscussion(t)||m.B.isLearningModule(t)||m.j.isLink(t))){Object(oe.e)(oe.d.CourseContentModelOperations).hasCourseLinks(t).then((e=>y(e)))}}},analyticsId:"course.content.visibility.button"},k(Qn),k(Xn),k(ea),v&&i.a.createElement(ia,{fixedMaxWidth:!0})))};function oa(e,t,n){return!function(e,t,n){return!Jn(e,t)&&!Zn(e,t,n)}(e,t,n)&&(!!m.j.canEdit(e)||(!!m.j.canEditAvailability(e)||!e.id))}const la=e=>{var t;const{item:n,variant:a,disableRestricted:r=!1,showCourseLinkWarning:s}=e,o=null!==(t=n.courseId)&&void 0!==t?t:"";let l=Object(p.s)(o,["course.content.designer.VIEW"]),c=Object(p.s)(o,["course.adaptiverelease.VIEW"]),d=Object(p.s)(o,["course.adaptiverelease.DELETE"]);n.permissions&&(l=m.j.canViewAsInstructor(n),n.permissions.adaptiveRelease&&(c=n.permissions.adaptiveRelease.view,d=n.permissions.adaptiveRelease.delete));const u={entitledToViewDesigner:l,entitledToViewConditionalRelease:c,entitledToDeleteConditionalRelease:d};return oa(n,u,r)?i.a.createElement(sa,{item:n,variant:a,disableRestricted:r,entitlements:u,showCourseLinkWarning:s}):u.entitledToViewDesigner?i.a.createElement(_n,{item:n,variant:a}):i.a.createElement(i.a.Fragment,null)};function ca(e,t){return function(e){return e===m.i.Unknown.iconClass}(t)&&function(e){return m.i.CourseLink.isEqualTo(e.contentHandler)}(e)?function(e){const t=Object(an.d)(e);return m.i.parse(t).iconClass}(e):t}async function da(e){const t=await async function(e){const t=Object(oe.e)(oe.d.ContentIcon);return await t.getIconClass(e)}(e);return ca(e,t)}var ua=n("+Koh");const ma=Object(h.makeStyles)((e=>({overflowMenu:{padding:"0 16px",color:e.palette.text.secondary,"&:hover":{color:e.palette.action.active}}}))),pa=e=>{const{nativeEvent:t}=e;return(e=>e.composedPath().filter((e=>e instanceof HTMLElement)))(t).some((e=>"allyContentRef"in e.dataset))},ha=Object(h.makeStyles)((()=>({overflowMenuList:{width:"280px"}}))),ga=e=>{const{id:t,onCloseMenu:n,anchorEl:a,overflowMenuItems:r}=e,s=ha(),o=Object(d.a)(),l=r.map((({subAnalyticsId:e,translationKey:t,onClick:a,...i})=>({...i,analyticsId:`components.directives.content-item-base.overflowMenu.${e}.link`,text:o(t),onClick:e=>{null==a||a(e),n()}})));if(!a)return null;return i.a.createElement(j.j,{id:t,analyticsId:"components.directives.content-item-base.overflowMenu",open:!0,onClose:n,onClick:n,onMouseUp:e=>{pa(e)&&setTimeout(n)},onKeyDown:e=>{"Escape"!==e.key&&"Enter"!==e.key&&" "!==e.key||(pa(e)?setTimeout(n):"Escape"===e.key&&n())},anchorEl:a,classes:{list:s.overflowMenuList},transformOrigin:{vertical:12,horizontal:278},items:l})};const ba=e=>{const{item:t,exitCallback:n}=e,[r,s]=Object(a.useState)(!1),[o,c]=Object(a.useState)(!1),u=function(e){const[t,n]=Object(a.useState)(),i=Object(p.d)(e.courseId);return Object(a.useEffect)((()=>{Object(oe.e)(oe.d.Content).generateDeleteConfirmationKey(e,"course-outline",null==i?void 0:i.isOrganization).then((t=>{var a;const i=t.ui.deleteConfirmationKey;n(null!=i?i:null===(a=e.contentHandler)||void 0===a?void 0:a.toString())}))}),[e,null==i?void 0:i.isOrganization]),t}(t),m=null==u?void 0:u.replace(/^resource\//,""),g=`components.directives.confirmation-needed.title-${m}`,b=`components.directives.confirmation-needed.instructions-${m}`,f=Object(d.a)(),v=(e=!1)=>{c(e),s(!0)};return i.a.createElement(i.a.Fragment,null,!!u&&i.a.createElement($.a,{analyticsId:"components.directives.content-item-base.overflowMenu.dialog","aria-labelledby":"delete-content-confirmation-dialog-heading-id",open:!r,TransitionProps:{onExited:()=>{n(o),s(!1)}}},i.a.createElement(h.DialogTitle,{onClose:()=>v(),id:"delete-content-confirmation-dialog-heading-id","aria-describedby":"delete-content-confirmation-dialog-message-id"},f(g)),i.a.createElement(h.DialogContent,null,i.a.createElement(h.DialogContentText,{id:"delete-content-confirmation-dialog-message-id"},f(b))),i.a.createElement(h.DialogActions,null,i.a.createElement(l.AnalyticsDefaultButton,{analyticsId:"components.directives.content-item-base.overflowMenu.cancel.button",onClick:()=>v()},f("global.cancel")),i.a.createElement(l.AnalyticsPrimaryButton,{analyticsId:"components.directives.content-item-base.overflowMenu.confirm.button",onClick:()=>v(!0)},f("global.delete")))))};const fa=e=>{const{children:t}=e,n=e=>e.stopPropagation();return i.a.createElement("div",{onMouseDown:n,onTouchStart:n},t)},va=e=>{var t;const{item:n,overflowMenuItems:r,onOpenMenu:s}=e,[o,c]=Object(a.useState)(void 0),u=!!o,{displayModal:m,modal:p}=Object(j.lb)(ba,{item:n});r.forEach((e=>{var t;(function(e){return void 0!==e.confirmableAction})(e)&&(e.onClick=(t=e.confirmableAction,async()=>{const{confirmed:e}=await m();e&&t()}))}));const h=Object(d.a)();let g;g=null!==n.title&&void 0!==n.title?h("components.directives.overflow-menu.menu-button.aria-label",{elementName:n.title}):h("components.directives.overflow-menu.menu-button.title");const b=`content-item-overflow-menu-${n.id}`,f=ma(),v=r.filter((e=>!e.hidden)),y=v.length>0&&v.every((e=>void 0!==e["data-ally-show"])),S=y&&(null===(t=v[0])||void 0===t?void 0:t["data-ally-content-ref"]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(l.AnalyticsIconButton,{analyticsId:"components.directives.content-item-base.overflowMenu.showMenu.button",className:f.overflowMenu,onClick:e=>{null==s||s(e),c(e.currentTarget)},id:`content-item-overflow-menu-button-${n.id}`,title:g,"aria-expanded":u,"aria-label":g,"aria-haspopup":"true","aria-controls":o?b:void 0,"data-ally-show":y?"instructorfeedback":void 0,"data-ally-content-ref":y?S:void 0},i.a.createElement(ua.Menu,null)),!!o&&i.a.createElement(fa,null,i.a.createElement(ga,{id:b,item:n,onCloseMenu:()=>{c(void 0)},anchorEl:o,overflowMenuItems:r})),p)};var ya=n("vK8H");const Sa=Object(h.makeStyles)((e=>Object(h.createStyles)({groupIcon:{marginRight:"8px",alignSelf:"baseline",height:e.typography.body1.lineHeight+"rem"},root:{marginLeft:"1px",marginTop:"4px",display:"flex"}})));const Ca=e=>{var t;const{item:n}=e,a=Object(d.a)(),r=function(e){return!!(e.selfEnrollmentGroups&&e.selfEnrollmentGroups.length>0)&&e.selfEnrollmentGroups.some((e=>e.group&&!e.group.groupSetId))}(n),s=r?"components.directives.group-count.groups.selfEnroll.plural":"components.directives.group-count.groups.plural";return i.a.createElement("span",null,a(s,{number:null===(t=null==n?void 0:n.assignedGroups)||void 0===t?void 0:t.length}))},Ea=e=>{const{item:t}=e,n=(e=>{const t=sn(e),n=ue();let i,r=e.id;if(m.i.UltraAssignment.isEqualTo(e.contentHandler)||m.i.TestLink.isEqualTo(e.contentHandler)){const t=e.getDeployedAssessment();i=null==t?void 0:t.gradingColumn.id}else m.i.CourseLink.isEqualTo(e.contentHandler)&&e.contentDetail&&(null==t?void 0:t.id)&&(r=t.id);const o=Object(a.useMemo)((()=>{if(r)return s.l.CourseGroup({groupCourseId:n,groupColumnId:i,groupContentId:r})}),[n,i,r]);return Object(s.cb)(o)})(t);return i.a.createElement(l.AnalyticsLink,{analyticsId:"content.item.course.outline.contentItemBase.editGroups.link",href:n},i.a.createElement(Ca,{item:t}))};var Ia=n("gqzd");function ka(e){return(null==e?void 0:e.enrollmentDateState)===Ia.c.OPEN}const wa=Object(h.makeStyles)((e=>Object(h.createStyles)({groupNameTitle:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",wordWrap:"normal",display:"block"},selfEnrollDate:{fontWeight:e.typography.fontWeightBold},deadlineSoon:{color:e.palette.error.main},groupInfoDisplay:{display:"block"}}))),Ta=e=>{var t,n,a,r;const{item:o,selfEnrollGroupInfo:c}=e,d=wa(),u=null!==(n=null===(t=o.assignedGroups)||void 0===t?void 0:t[0].groupTitle)&&void 0!==n?n:"",m=Object(s.cb)(Object(s.eb)({courseId:null!==(a=o.courseId)&&void 0!==a?a:"",contentId:null!==(r=o.id)&&void 0!==r?r:""}));return ka(c)?(null==c?void 0:c.isSelfEnrollment)?i.a.createElement(l.AnalyticsLink,{href:m,analyticsId:"components.directives.group-student-enrollment.groupTitle.link"},u):null:i.a.createElement("div",{className:d.groupNameTitle},u)},Oa=e=>function(e){return(null==e?void 0:e.enrollmentDateState)===Ia.c.BEFORE}(e)?"components.directives.group-student-enrollment.enrollment-starts":function(e){return(null==e?void 0:e.enrollmentDateState)===Ia.c.OPEN&&!!e.relativeDate}(e)?"components.directives.group-student-enrollment.enrollment-closes":function(e){return(null==e?void 0:e.enrollmentDateState)===Ia.c.AFTER}(e)?"components.directives.group-student-enrollment.enrollment-closed":"",Aa=e=>{var t,n;const{item:a,selfEnrollGroupInfo:o}=e,c=Object(d.a)(),u=wa(),m=Object(s.cb)(Object(s.eb)({courseId:null!==(t=a.courseId)&&void 0!==t?t:"",contentId:null!==(n=a.id)&&void 0!==n?n:""}));if(!function(e,t){return!!(e.selfEnrollmentGroups&&e.selfEnrollmentGroups.length>0)&&!!(null==t?void 0:t.isSelfEnrollment)}(a,o))return i.a.createElement("div",{className:u.groupNameTitle},c("components.directives.group-student-enrollment.unknown"));const p="components.directives.group-student-enrollment.self-enroll-to-participate";return i.a.createElement("div",{className:u.groupInfoDisplay},ka(o)&&i.a.createElement(l.AnalyticsLink,{href:m,analyticsId:p},c(p)),!function(e){return(null==e?void 0:e.enrollmentDateState)===Ia.c.OPEN&&!e.relativeDate}(o)&&i.a.createElement("div",{className:Object(r.a)(u.selfEnrollDate,(null==o?void 0:o.isEnrollmentDateImportant)&&u.deadlineSoon)},c(Oa(o),{time:null==o?void 0:o.relativeDate})))},Pa=e=>{var t,n;const{item:r}=e,s=(e=>{const{babelfishFormat:t,locale:n}=Object(_.a)(),[i,r]=Object(a.useState)();return Object(a.useEffect)((()=>{const a=[];e.forEach((e=>{e.group&&a.push(e.group)})),Object(Ia.n)(a,n,t).then((e=>{r(e)}))}),[e,t,n]),i})(null!==(t=r.selfEnrollmentGroups)&&void 0!==t?t:[]);return(null!==(n=r.assignedGroups)&&void 0!==n?n:[]).length>0?i.a.createElement(Ta,{item:r,selfEnrollGroupInfo:s}):i.a.createElement(Aa,{item:r,selfEnrollGroupInfo:s})},xa=e=>{const{item:t}=e,n=ue(),a=Object(p.s)(n,["course.groups.admin.VIEW"]),r=Object(p.s)(n,["course.groups.VIEW"]),s=Sa();return m.j.canHaveAttempts(t)&&t.isGroupContent&&t.assignedGroups?i.a.createElement("div",{className:s.root},i.a.createElement(ya.a,{className:s.groupIcon}),a?i.a.createElement(Ea,{item:t}):r?i.a.createElement(Ca,{item:t}):i.a.createElement(Pa,{item:t})):null};var $a=n("l2+p");const Na=Object(h.makeStyles)({proctorContainer:{display:"inline-flex",alignItems:"center"},proctorIcon:{marginRight:"6px"}});const Da=e=>{const t=Object(d.a)(),n=Na();return i.a.createElement("div",{className:Object(r.a)(n.proctorContainer,e.className)},i.a.createElement($a.a,{className:n.proctorIcon}),t("components.services.proctoring.outline.proctored"))};function La(e){const t=function(e){const t=e.getTimedTestDetail();return t.hasTimeLimit?Math.floor(t.displayedTimeLimitSeconds/60):void 0}(e);if(!e.hasDueDate()&&"number"!=typeof t)return;const n=function(e){const t=e.getDueDate();return t instanceof Date?t:"string"==typeof t?new Date(t):void 0}(e),a=function(e){const t=Object(m.Gb)(e),n=Object(m.Bb)(e),a=!(!n||n===m.N);return t||a}(e);return{dueDate:n,timeLimitMinutes:t,isProctored:a}}const ja=Object(h.makeStyles)({gradeInfo:{display:"flex",flexWrap:"wrap",overflow:"hidden"},gradeDetail:{marginRight:"16px","& + &":{position:"relative","&:before":{position:"absolute",content:'"|"',left:"-11px",top:"-1px"}}}}),Ma=e=>{const{dueDate:t,timeLimitMinutes:n,isProctored:a}=e,r=Object(d.a)(),s=ja();return i.a.createElement("div",{className:s.gradeInfo},i.a.createElement("div",{className:s.gradeDetail},r("courseCore.components.contentItems."+(t?"dueDate":"noDueDate"),{date:t})),"number"==typeof n&&i.a.createElement("div",{className:s.gradeDetail},r("courseCore.components.contentItems.timeLimit",{timeLimit:n})),a&&i.a.createElement(Da,{className:s.gradeDetail}))};var Ga=n("1toc"),Ra=n("ECG1"),Ba=n("mrT9"),Fa=n("kY51"),Ua=n("/n7R");const _a=Object(h.makeStyles)({container:{display:"flex",alignItems:"center",gap:"8px",marginTop:"4px"}}),za="components.directives.content-item-base.content-item-peer-assessment.peer-review-information-tooltip",qa=e=>{var t;const{item:n}=e,[r]=Object(a.useState)((()=>Object(oe.e)(oe.d.CurrentCourseMembership).isStudentMembership())),s=function(e){const[t,n]=Object(a.useState)(void 0);return Object(a.useEffect)((()=>{Object(oe.e)(oe.d.PeerReview).getOrCreatePeerContentFromContent(e).then(n)}),[e]),t}(n),o=Object(d.a)(),l=_a();return(null==s?void 0:s.peerGrading)&&s.isPeerGradingConfigured?i.a.createElement("div",{className:l.container},i.a.createElement(Ga.a,null),i.a.createElement(Ba.a,null,o("components.directives.content-item-base.peer-review-due-date",{peerReviewsNumber:null!==(t=s.numOfPeerReviewsToComplete)&&void 0!==t?t:0,datetime:s.peerReviewDueDate})),r&&i.a.createElement(Ua.AnalyticsTooltip,{analyticsId:"components.directives.content-item-base.content-item-peer-assessment.tooltip.button",placement:"top",title:o(za),"aria-label":o(za)},i.a.createElement(Fa.a,null,i.a.createElement(Ra.a,null)))):null};var Ha=n("t3aq");const Va=Object(h.makeStyles)((()=>({allyWidget:{width:"auto","& > [data-ally-show]":{margin:"9px 16px","& > svg":{fontSize:"20px"}}}})));function Wa(e,t,n){Object(oe.e)(oe.d.Ally).update(e,t,n)}const Ka=e=>{var t;const{contentId:n,fileId:r,...s}=e,o=ue(),l=null!==(t=Object(p.s)(o,["course.content.MODIFY"]))&&void 0!==t&&t,{translate:c,locale:d}=Object(_.a)(),u=Va();return Object(a.useEffect)((()=>{Wa(d,n,r)}),[d,n,r]),i.a.createElement(i.a.Fragment,null,i.a.createElement(Ha.a,{contentId:n,fileId:r,...s}),!!l&&i.a.createElement("div",{"data-testid":"score_indicator",className:u.allyWidget},i.a.createElement(Ha.b,{contentRef:n,widgetType:Ha.d.ScoreIndicator})),i.a.createElement("div",{className:u.allyWidget},i.a.createElement(Ha.b,{contentRef:n,widgetType:Ha.d.AlternativeFormats,ariaLabel:c("ally.download_alternative_formats")})))},Ya=Object(h.makeStyles)((()=>({contentItemDescriptionContainer:{padding:"10px 15px 0 0"}}))),Ja=e=>{const{description:t}=e,n=Ya(),a=Object(d.a)();return i.a.createElement("div",{className:n.contentItemDescriptionContainer},i.a.createElement(j.V,{textContent:t,analyticsId:"components.course-core.content-item.content-item-decription.text-truncate-button",readLessText:a("courseCore.components.contentItems.showLess"),readMoreText:a("courseCore.components.contentItems.showMore"),textClassName:"js-description"}))};var Za=n("ml91");const Qa=e=>{if(e)return()=>{s.Z.goPeekState(e)}};function Xa(e,t){const n=!!e&&t;return{subAnalyticsId:"global.edit",translationKey:"global.edit",icon:i.a.createElement(Za.a,null),onClick:Qa(e),key:"components.directives.content-item-base.overflowMenu.edit",hidden:!n}}var ei=n("7VeY");var ti=n("rq4T");function ni(e,t){const n=m.j.hasConversation(e)&&t,a=(e=>{if(e.id)return s.q.Conversation({contentId:e.id,courseId:e.courseId})})(e);return{subAnalyticsId:"components.directives.content-item-base.overflow-menu.open-conversation",translationKey:"components.directives.content-item-base.overflow-menu.open-conversation",icon:i.a.createElement(ti.a,null),onClick:Qa(a),key:"components.directives.content-item-base.overflowMenu.conversation",hidden:!n}}function ai(e,t){return!m.j.isExternalSubmissionsAssessment(e)&&(!!function(e){return(m.i.TestLink.isEqualTo(e.contentHandler)||m.i.UltraAssignment.isEqualTo(e.contentHandler))&&e.hasGradingColumn()}(e)&&(null!=t&&t))}const ii=e=>{var t;const n=Object(oe.e)(oe.d.Context),[i,r]=Object(a.useState)(void 0),[o,l]=Object(a.useState)(!1),c=Object(p.s)(null!==(t=e.courseId)&&void 0!==t?t:"",["course.gradebook-grades.VIEW"]);return Object(a.useEffect)((()=>{n.isTelemetryEnabled().then(l)}),[n]),Object(a.useEffect)((()=>{const t=ai(e,c),n=function(e,t,n){var a;const i=Object(oe.e)(oe.d.CurrentCourseMembership);return n&&t&&!i.isStudentMembership()&&!(null===(a=e.getAssociatedGradingColumn())||void 0===a?void 0:a.anonymousGrading)}(e,t,o);e.id&&n?r(s.J.ContentActivityInDetail({contentId:e.id})):r(void 0)}),[e,c,o]),i};var ri=n("CTZr");function si(e){var t;const n=null!==(t=e.courseId)&&void 0!==t?t:"",a=Object(p.s)(n,["course.gradebook-grades.VIEW"])&&m.j.isQuestionAnalysisAvailable(e),r=(e=>{if(e.id)return s.E.QuestionAnalysis({qaContentId:e.id})})(e);return{subAnalyticsId:"components.directives.content-item-base.overflow-menu.question-analysis",translationKey:"components.directives.content-item-base.overflow-menu.question-analysis",icon:i.a.createElement(ri.a,null),onClick:Qa(r),key:"components.directives.content-item-base.overflowMenu.questionAnalysis",hidden:!a}}var oi=n("67dj"),li=n("Ptl6");var ci=n("7N5c");function di(e){const t=function(e){if(!e)return;const t=[Zt,Qt,Xt];for(const n of t){const t=n(e);if(t)return t}}(Yt(e));if(t)en(t);else{const e=document.querySelector('[id^="add-content-menu-button-start-"]');null==e||e.focus()}}function ui(e){const t={hidden:!m.j.canDelete(e),subAnalyticsId:"global.delete",translationKey:"global.delete",icon:i.a.createElement(ci.Trash,null),key:"delete"};return Object.defineProperty(t,"confirmableAction",{value:()=>{Object(oe.e)(oe.d.DeleteContentCourseModelOperations).deleteContent(e),di(e)},enumerable:!1}),t}var mi=n("+pNa"),pi=n("Y+9S");function hi(e){const[t,n]=Object(a.useState)(!1),i=Object(oe.e)(oe.d.Ally),r=i.isAllySupportedContentItem(e);return Object(a.useEffect)((()=>{i.isAvailable().then(n)}),[i]),t&&r}function gi(e,t){var n;const a=null!==(n=e.courseId)&&void 0!==n?n:"",r=Object(p.s)(a,[Ke.ViewProgressInformation]),s=Object(p.u)(),o=Object(oe.e)(oe.d.CurrentCourseMembership),l=Object(p.j)(a,o.isStudentMembership());let c;return!!(null==l?void 0:l.progressTrackingEnabled)&&r&&(c=t),{subAnalyticsId:"components.directives.content-item-base.overflow-menu.content-progress",translationKey:s?"components.directives.content-item-base.overflow-menu.content-progress-org":"components.directives.content-item-base.overflow-menu.content-progress",icon:i.a.createElement(f.ClassPulseFuture,null),onClick:Qa(c),key:"components.directives.content-item-base.overflowMenu.contentProgress",hidden:!c}}function bi(e,t={},n){const{editContentRoute:a,contentProgressRoute:r,usesEditButton:s,supportsConversations:o,analyticsRoute:l,downloadUrl:c}=t,d=Xa(a,s),u=ni(e,o),m=function(e){const t=ii(e);return{subAnalyticsId:"components.directives.content-item-base.overflow-menu.student-activity",translationKey:"components.directives.content-item-base.overflow-menu.student-activity",icon:i.a.createElement(ei.a,null),onClick:Qa(t),key:"components.directives.content-item-base.overflowMenu.studentActivity",hidden:!t}}(e),h=function(e){return{subAnalyticsId:"components.directives.content-item-base.overflow-menu.view-analytics",translationKey:"components.directives.content-item-base.overflow-menu.view-analytics",icon:i.a.createElement(ei.a,null),onClick:Qa(e),key:"components.directives.content-item-base.overflowMenu.analytics",hidden:!e}}(l),g=si(e),b=gi(e,r),f=ui(e),v=function(e,t){var n;const a=[],r=e=>{if("Enter"===e.key||" "===e.key){const t=new MouseEvent("click",{cancelable:!0,bubbles:!0});e.currentTarget.dispatchEvent(t)}};return null!==(n=Object(p.s)(null==e?void 0:e.courseId,["course.content.MODIFY"]))&&void 0!==n&&n&&a.push({subAnalyticsId:"ally.context_menu.view_accessibility_score",key:"ally-view-accessibility-score",translationKey:"ally.context_menu.view_accessibility_score",icon:i.a.createElement(li.a,null),hidden:!t,"data-ally-show":"instructorfeedback","data-ally-show-display":"flex","data-ally-content-ref":e.id,"data-ally-invoke":"instructorfeedback",style:{display:"none"},onKeyDown:r}),a.push({subAnalyticsId:"ally.context_menu.download_alternative_formats",key:"ally-download-alternative-formats",icon:i.a.createElement(oi.a,null),translationKey:"ally.context_menu.download_alternative_formats",hidden:!t,"data-ally-show":"alternativeformats","data-ally-show-display":"flex","data-ally-content-ref":e.id,"data-ally-invoke":"alternativeformats",style:{display:"none"},onKeyDown:r}),a}(e,n),y=function(e,t){const n=hi(e);return{subAnalyticsId:"global.download",key:"download",icon:i.a.createElement(mi.a,null),translationKey:n?"ally.context_menu.download_original_file":"global.download",hidden:!t,onClick:()=>{t&&(Object(pi.o)(pi.c.DownloadLinkClicked),window.open(t,"_blank"),Je(e))}}}(e,c);return[d,u,m,h,g,b,f,y,...v]}const fi=i.a.forwardRef(((e,t)=>{const{conditions:n,contentId:a,entitled:r,...o}=e,{translate:c,formatItems:d}=Object(_.a)(),u=Object(p.u)(),m=Object(s.cb)(s.j.EditConditionalRelease({contentId:null!=a?a:""})),h=[[n.acl,(u?"organization":"course")+"-membership"],[n.date,"date"],[n.performance,"performance"]].filter((([e])=>!!e)).map((([,e],t)=>c(`components.directives.content-item-base.conditionalRelease.conditionDescriptions.${e}${0===t?"-capitalized":""}`)));return i.a.createElement(l.AnalyticsLink,{analyticsId:"components.directives.content-item-base.conditionalRelease.link",href:r?m:void 0,ref:t,...o},d(h))})),vi=Object(h.makeStyles)((e=>({linkTarget:{marginTop:"4px",width:"fit-content"},readonlyTarget:{width:"fit-content",color:e.palette.text.secondary,lineHeight:"inherit","&:hover":{textDecoration:"underline"}}}))),yi=e=>{var t,n;const{item:a}=e,s=Object(d.a)(),o=vi(),l=he(a),c=null!==(t=e.visibleAsInstructor)&&void 0!==t?t:m.j.canViewAsInstructor(a),u=null!==(n=e.tabbableByStudents)&&void 0!==n?n:!m.j.isNotAccessibleButVisibleForcedSequenceItem(a);return m.j.isConditionalReleaseLocked(a)||m.h.isConditionalRelease(a)&&c?i.a.createElement(be,{item:a},c?i.a.createElement(fi,{className:o.linkTarget,conditions:l,contentId:a.id,entitled:m.j.canOpenConditionalRelease(a)}):i.a.createElement(h.ButtonBase,{className:Object(r.a)(o.readonlyTarget),"aria-hidden":!u,tabIndex:u?0:-1},s("components.directives.content-item-base.conditionalRelease.lock-info"))):null},Si=e=>{const t=(e=>{const t=ue();return e||(e=t),Object(u.e)((t=>{const n=e?m.Yb.course.getCourseById(t,e):void 0;return!!n&&Object(m.Fb)(n)}))})(null==e?void 0:e.courseId),n=Object(p.s)(null==e?void 0:e.courseId,["course.content.MODIFY"]);return!!e&&m.j.canEdit(e)&&!t&&!!n},Ci=Object(a.createContext)({dragHandleRef:()=>{}}),Ei=Object(h.makeStyles)((()=>({dragHandle:{pointerEvents:"none",height:"38px",width:38,opacity:0,"&:focus":{opacity:1},".dragOverlay &":{opacity:1,outline:"none"},"@media (hover)":{".itemContainer:hover &":{opacity:1,"&.otherItemDragging":{opacity:0}}},"@media (hover: none)":{opacity:1}}}))),Ii=e=>{const{itemTitle:t}=e,n=Object(d.a)(),s=Ei(),o=Object(a.useRef)(null),{isSorting:c,isDragging:u,isDragOverlay:m}=Object(a.useContext)(fn),{attributes:p,activationEvent:h,dragHandleRef:g}=Object(a.useContext)(Ci),b=u&&"keyboard"===h;Object(a.useEffect)((()=>{b&&requestAnimationFrame((()=>{var e;null===(e=o.current)||void 0===e||e.focus()}))}),[b]);const{"aria-roledescription":v,"aria-describedby":y,...S}=null!=p?p:{},C=n("courseCore.course.dragAndDrop.announcements.dragHandleFocus",{contentItemTitle:t}),E=b?{}:{"aria-label":C,"aria-describedby":y};return i.a.createElement("div",{role:"application"},i.a.createElement(l.AnalyticsIconButton,{analyticsId:"content.item.base.move.button",ref:e=>{g(e),o.current=e},className:Object(r.a)(s.dragHandle,{dragOverlay:m,otherItemDragging:!m&&c}),...E,...S},i.a.createElement(f.MoveItemUpDown,{color:m?"action":"disabled"})))},ki=e=>{var t,n,s;const{additionalControls:o,children:l,item:c,overflowMenuProps:u,showAlertIcon:h,showContentVisibility:g=!0,defaultIconDetails:b,overrideIconDetails:f,allyContentProps:v,showLinkBadge:y=!1,onOpenOverflowMenu:S}=e,C=Z(),E=Object(d.a)(),{Icon:I,ariaLabelKey:k}=((e,t)=>{const[n,i]=Object(a.useState)(),r=sn(e);let s=e;r&&m.i.CourseLink.isEqualTo(e.contentHandler)&&(s=r);const o=da(s);return Object(a.useEffect)((()=>{o.then(i)}),[o]),n?{Icon:Object(q.m)(n),ariaLabelKey:Object(q.j)(n)}:t||{Icon:Object(q.m)("document-blank"),ariaLabelKey:Object(q.j)("document-blank")}})(c,b),w=on(c),T=kn(c),O=La(c),A=function(e){return m.i.TestLink.isEqualTo(e.contentHandler)}(c),P=function(e,t){var n;const a=null===(n=t.showReviewStateIcon)||void 0===n||n,i=ue(),r=Object(oe.e)(oe.d.CurrentCourseMembership).isStudentMembership(),s=Object(p.j)(i,r),o=!!(null==s?void 0:s.progressTrackingEnabled)||e.inSequence;return a&&o&&r}(c,{showReviewStateIcon:!0})&&!!c.id,x=Si(c),$=hi(c),N=function(e,t,n){return m.j.canDelete(e)||m.j.canViewAsInstructor(e)||(null==t?void 0:t.usesEditButton)||!!(null==t?void 0:t.downloadUrl)||(m.j.hasConversation(e)||n)&&!m.j.isConditionalReleaseLocked(e)}(c,u,$),D=bi(c,u,$);return i.a.createElement(i.a.Fragment,null,x&&i.a.createElement("div",{className:Object(r.a)(C.dragHandle,C.overlaidIcon,C.contentItemOverlaidIcon)},i.a.createElement(Ii,{itemTitle:null!==(t=c.title)&&void 0!==t?t:""})),P&&i.a.createElement("div",{className:Object(r.a)(C.overlaidIcon,C.contentItemOverlaidIcon)},i.a.createElement(An,{item:c,supportsManualTransition:!0})),i.a.createElement(In,{className:C.contentItemIcon,Icon:null!==(n=null==f?void 0:f.Icon)&&void 0!==n?n:I,showLinkBadge:y,titleAccess:E(null!==(s=null==f?void 0:f.ariaLabelKey)&&void 0!==s?s:k),isRestricted:w,showAlertIcon:h,customIconUrl:null==b?void 0:b.customIconUrl}),i.a.createElement("div",{className:C.contentItemComponent},i.a.createElement("div",{className:C.contentItemComponentDetails},i.a.createElement("div",{className:C.contentItemContentArea},l,!!O&&i.a.createElement(Ma,{...O}),A&&i.a.createElement(qa,{item:c}),i.a.createElement(xa,{item:c}),g&&i.a.createElement("div",{className:C.contentVisibility},i.a.createElement(fa,null,i.a.createElement(la,{item:c,showCourseLinkWarning:y})),m.j.hasAdaptiveReleaseRules(c)&&i.a.createElement(yi,{item:c}))),i.a.createElement("div",{className:C.contentItemContextArea},!!v&&i.a.createElement(Ka,{...v}),N&&i.a.createElement(va,{item:c,overflowMenuItems:D,onOpenMenu:S}),o)),T&&i.a.createElement(Ja,{description:T})))},wi=e=>{const{children:t,item:n,linkProps:r,isRestricted:s,readOnly:o,...l}=e,c=null!=s?s:on(n),d=null!=o?o:ln(n)||!r.onClick&&!r.href,u=Object(a.useRef)(null),p=Si(n);return i.a.createElement(En,{elementToClickRef:u,readOnly:d,draggable:p,contentId:n.id},i.a.createElement(ki,{item:n,...l},i.a.createElement(gn,{...r,isRestricted:c,readOnly:d,hasActivityIndicator:n.ui.hasIndicator,ref:u,notAccessible:m.j.isNotAccessibleButVisibleForcedSequenceItem(n)},n.title),t))},Ti=e=>{const{item:t}=e;return i.a.createElement(wi,{linkProps:{analyticsId:"content.item.courses.outline.default.link"},item:t,defaultIconDetails:{Icon:dn.a,ariaLabelKey:Object(q.j)("document-blank")}})};var Oi=n("4iFr");const Ai=(e,t)=>{const[n,i]=Object(a.useState)(void 0),[r,o]=Object(a.useState)(!1),{id:l}=e,{id:c}=null!=t?t:{},d=function(e,t){return m.i.CourseLink.isEqualTo(e.contentHandler)&&m.i.Discussion.isEqualTo(null==t?void 0:t.contentHandler)}(e,t);return Object(a.useEffect)((()=>{Object(oe.e)(oe.d.Context).isTelemetryEnabled().then(o)}),[]),Object(a.useEffect)((()=>{const e=Object(oe.e)(oe.d.CurrentCourseMembership);l&&c&&r&&d&&!e.isStudentMembership()?i(s.J.DiscussionForumInsights({contentId:c,forumContentId:l})):i(void 0)}),[l,d,c,r]),n},Pi=e=>{const{item:t,linkedItem:n,isRestricted:a,readOnly:r}=e,o=(e=>{if(e.id&&!m.j.isConditionalReleaseLocked(e))return s.q.DiscussionWithGrading({contentId:e.id})})(null!=n?n:t),l=Object(s.cb)(o),c=Ai(t,n),d={analyticsId:n?"course.link.item.forumLink.link":"content.item.courses.outline.gradebook.item.forum.link",href:l},u={editContentRoute:o,usesEditButton:m.j.canEditAvailability(t)&&!!o,analyticsRoute:c,supportsConversations:!1};return i.a.createElement(wi,{linkProps:d,item:t,isRestricted:a,readOnly:r,overflowMenuProps:u,defaultIconDetails:{Icon:Oi.a,ariaLabelKey:Object(q.j)("discussion")}})};var xi=n("OhrW");const $i=e=>{if(e.id&&m.j.canEdit(e))return s.s.EditExternalLink({id:e.id})},Ni=(e,t)=>m.i.CourseLink.isEqualTo(t.contentHandler)?$i(t):e,Di=e=>{const{item:t,linkedItem:n,isRestricted:a,readOnly:r}=e,o=(e=>{if(e.id)return s.j.Document({id:e.id})})(null!=n?n:t),l=Ni(o,t),c={analyticsId:"content.item.coures.outline.document.link",href:Object(s.cb)(o)},d={editContentRoute:l,usesEditButton:m.j.canEditAvailability(t)&&!!o,supportsConversations:!0};return i.a.createElement(wi,{linkProps:c,item:t,isRestricted:a,readOnly:r,showLinkBadge:!!n,defaultIconDetails:{Icon:xi.a,ariaLabelKey:Object(q.j)("document-text")},overflowMenuProps:d})};const Li=e=>{const t=function(e){var t,n,a;return null===(a=null===(n=null===(t=e.contentDetail)||void 0===t?void 0:t[I.t.File])||void 0===n?void 0:n.file)||void 0===a?void 0:a.mimeType}(e),n=Object(m.zb)(t);return{Icon:Object(q.l)(t),ariaLabelKey:Object(q.j)(n)}},ji=e=>{var t,n,a;const i=null===(a=null===(n=null===(t=e.contentDetail)||void 0===t?void 0:t[I.t.File])||void 0===n?void 0:n.file)||void 0===a?void 0:a.permanentUrl;if(i)return Object(Ve.d)(i)},Mi=(e,t,{id:n,title:a})=>{Object(pi.r)({type:e,status:pi.b.Success,contentId:n,contentTitle:a,contentType:t})};const Gi=e=>{const{item:t,linkedItem:n,isRestricted:r,readOnly:o}=e,l=null!=n?n:t,{locale:c}=Object(_.a)(),d=(e=>{if(e.id&&m.j.canEdit(e))return s.t.EditFile({id:e.id})})(l),u=Ni(d,t),h=hi(l),g=(e=>{var t;const n=Object(p.l)("feature.course.content.inline-render"),i=Object(s.cb)(s.t.PreviewFile({id:e.id})),r=ji(e),o=null===(t=e.contentDetail)||void 0===t?void 0:t[I.t.File];return Object(a.useMemo)((()=>{if(!e.id)return{hasFilePreview:!1,href:void 0};const t=null==o?void 0:o.fileAssociationMode,a=(null==o?void 0:o.file)?Object(j.jb)(o.file):void 0,s=t!==I.G.Link&&a&&Object(j.Z)(a,n);return n&&s?{hasFilePreview:!0,href:i}:{hasFilePreview:!1,href:r}}),[e.id,o,n,r,i])})(l),b=ji(l),f=function(e){return Object(oe.e)(oe.d.Ally).getXythosIdFromContentItem(e)}(l),v=function(e,t){var n,a;if(ln(e))return;const i=null===(a=null===(n=e.contentDetail)||void 0===n?void 0:n[I.t.File])||void 0===a?void 0:a.fileAssociationMode;return i&&Object(I.Oc)(i)?t:void 0}(l,b),y=(e=>{if(e.id)return s.t.PreviewFile({id:e.id,view:"progress"})})(t),S=e=>{(e=>{Mi(pi.c.FileOpened,pi.e.Document,e)})(e),Je(e)};let C;h&&l.id&&b&&f&&(C={contentId:l.id,fileId:f,filePreviewUrl:b});const E={editContentRoute:u,usesEditButton:m.j.canEditAvailability(l)&&!!d,supportsConversations:!1,downloadUrl:v,contentProgressRoute:y};return i.a.createElement(wi,{linkProps:{analyticsId:"content.item.course.outline.courseContent.link",href:g.href,onClick:()=>S(l),target:g.hasFilePreview?void 0:"_blank",rel:g.hasFilePreview?void 0:"noopener noreferrer"},item:t,isRestricted:r,readOnly:o,showLinkBadge:!!n,overflowMenuProps:E,defaultIconDetails:Li(t),allyContentProps:C,onOpenOverflowMenu:()=>{h&&function(e,t){const n=Object(oe.e)(oe.d.Ally);if(!n.isAllySupportedContentItem(e))return;Wa(t,e.id,n.getXythosIdFromContentItem(e))}(l,c)}})};var Ri=n("xQgz");const Bi=Object(h.makeStyles)((e=>{const t=e.palette.background.b4;return{chevronContainer:{position:"relative",display:"none","&::before":{content:'""',position:"absolute",borderLeft:`1px solid ${e.palette.border.main}`,top:"-13px",height:"40px"},[e.breakpoints.up("sm")]:{display:"flex"}},folderContents:{position:"relative",backgroundColor:e.palette.background.b2,boxShadow:`inset 0px -5px 0px 0px ${t}, inset 0px 5px 0px 0px ${t}`,padding:"0 0 20px","& .content-list-item:first-child":{marginTop:"5px"}},emptyFolderContents:{padding:"25px 0"},emptyReadOnlyFolderContents:{padding:"30px 0"}}})),Fi=Object(a.createContext)(void 0),Ui=Object(h.makeStyles)((e=>({highlighted:{position:"relative",outline:`${e.palette.brand.main} solid 1px`,"&:before":{content:'""',position:"absolute",left:0,right:0,top:"-1px",zIndex:1,borderTop:`1px solid ${e.palette.brand.main}`}}}))),_i=e=>{var t;const{children:n,className:s,togglableId:o}=e,l=Ui(),{folderId:c,item:d}=null!==(t=Object(a.useContext)(Fi))&&void 0!==t?t:{},u=c===o&&(null==d?void 0:d.parentId)!==o;return i.a.createElement("div",{className:Object(r.a)(u&&l.highlighted,s)},n)};function zi(e){return m.j.canEdit(e)||!m.j.isRestricted(e)}var qi=n("qrV5");const Hi=e=>{const{id:t,open:n,children:a,...r}=e,s=K();return i.a.createElement("div",{id:t},i.a.createElement(W,{value:s+1},i.a.createElement(qi.a,{in:n,unmountOnExit:!0,timeout:"auto",...r},a)))};function Vi(e){return!m.j.isUnknownContentItem(e)}var Wi;function Ki(e){return Object(oe.j)((()=>{var t,n;const a=null===(t=e.children)||void 0===t?void 0:t.length;return"number"!=typeof a?Wi.Unopened:0===a?Wi.Empty:(null!==(n=e.children)&&void 0!==n?n:[]).every((e=>!Vi(e)))?Wi.Empty:Wi.HasChildren}),[e.children])}function Yi(e,t){var n;const[i,r]=Object(qt.f)(Cn(e.id)),s="number"==typeof(null===(n=e.children)||void 0===n?void 0:n.length),[o,l]=Object(a.useState)(s);Object(a.useEffect)((()=>()=>{e.id&&r(!1)}),[e.id,r]),Object(oe.i)(oe.b.CloseFolderById,((t,n)=>{n&&n===e.id&&(l(!1),r(!1))})),Object(a.useEffect)((()=>{!async function(){try{i&&!o&&t&&(await t(e,!1),l(!0),function(e){var t;e.children&&0===e.children.length&&(null===(t=e.permissions)||void 0===t?void 0:t.canHaveReviewState)&&e.state!==I.u.Completed&&e.updateState(I.u.Completed,!0)}(e))}catch(e){console.error(e)}}()}),[i,o,t,e]),Object(a.useEffect)((()=>{o&&!s&&(r(!1),l(!1))}),[s,o,r]);const c=Object(a.useCallback)((()=>{r((e=>!e))}),[r]);return[i&&o,c]}!function(e){e[e.Unopened=0]="Unopened",e[e.Empty=1]="Empty",e[e.HasChildren=2]="HasChildren"}(Wi||(Wi={}));const Ji=Object(h.makeStyles)((e=>({emptyReadOnlyContents:{display:"flex",justifyContent:"center",color:e.palette.text.secondary},emptyContainer:{"& .native-drag-top::after, & .native-drag-bottom::after":{...Q(e),top:"0",bottom:"1px",height:void 0}}})));var Zi,Qi=n("Eptt");!function(e){e.Container="container",e.Item="item",e.EndOfList="endOfList"}(Zi||(Zi={}));const Xi=e=>{const{parentId:t,disabled:n=!1,children:a}=e,r=K(),{setNodeRef:s}=Object(Qi.n)({id:`${t}-contents`,disabled:n,data:{type:Zi.Container,parentId:t,nestingLevel:r}});return i.a.createElement("div",{ref:s},a)},er=Object(a.createContext)((()=>{})),tr=e=>{const{item:t,isOpen:n,loadMoreContent:s,containerId:o,readOnlyEmptyMessage:l,centerDivider:c=!0,classes:d}=e,u=Ji(),m=Object(a.useContext)(er),p=Ki(t),h=!!t.children&&Vt(t.children);return i.a.createElement(Hi,{id:o,open:n,className:p===Wi.Empty?u.emptyContainer:void 0,classes:{wrapperInner:null==d?void 0:d.wrapperInner},onEntered:()=>{m(Kt(t))}},h||p!==Wi.Empty?i.a.createElement(Xi,{parentId:t.id},i.a.createElement(os,{parentFolder:t,contents:t.children,loadMoreContent:s,showTopAddButton:p===Wi.Empty,centeredDivider:c})):i.a.createElement("div",{className:Object(r.a)(u.emptyReadOnlyContents,null==d?void 0:d.readOnlyEmpty)},i.a.createElement("span",null,l)))},nr=e=>{if(e.id)return s.j.GenericStudentProgress({id:e.id})},ar=e=>{const{item:t,loadMoreContent:n}=e,a=Object(d.a)(),[o,l]=Yi(t,n),c=Ki(t),u=!!t.children&&Vt(t.children),p=Bi(),h=(e=>{if(e.id)return s.j.EditFolder({id:e.id})})(t),g=nr(t),b={editContentRoute:h,usesEditButton:m.j.canEditAvailability(t)&&!!h,contentProgressRoute:g},f=zi(t),v=`folder-contents-${t.id}`,y="components.directives.element-image.element-image-accessibility.img-icon-"+(o?"folder-open":"folder"),S=c!==Wi.HasChildren,C=Object(r.a)(p.folderContents,{[p.emptyFolderContents]:S,[p.emptyReadOnlyFolderContents]:S&&!u});return i.a.createElement(_i,{togglableId:t.id},i.a.createElement(wi,{item:t,overrideIconDetails:{Icon:Ri.a,ariaLabelKey:y},linkProps:{analyticsId:"content.item.folder.toggleFolder.button","aria-controls":v,"aria-expanded":o,onClick:f?l:void 0},overflowMenuProps:b,additionalControls:f&&i.a.createElement("div",{className:p.chevronContainer},i.a.createElement(j.g,{open:o}))}),i.a.createElement(tr,{item:t,isOpen:o,loadMoreContent:n,containerId:v,readOnlyEmptyMessage:a("components.directives.folder.empty"),centerDivider:c!==Wi.HasChildren,classes:{wrapperInner:C}}))};var ir=n("BY8f");const rr=e=>{const{item:t,linkedItem:n,isRestricted:a,readOnly:r}=e,o=null!=n?n:t,l=(e=>{if(e.id&&!m.j.isConditionalReleaseLocked(e))return s.z.JournalWithParticipation({contentId:e.id})})(o),c=Ni(l,t),d=Object(s.cb)(l),u={analyticsId:"content.item.courses.outline.journal.link",href:d},p={editContentRoute:c,usesEditButton:m.j.canEditAvailability(o)&&!!d,supportsConversations:!1};return i.a.createElement(wi,{linkProps:u,item:t,isRestricted:a,readOnly:r,overflowMenuProps:p,showLinkBadge:!!n,defaultIconDetails:{Icon:ir.a,ariaLabelKey:Object(q.j)("journal")}})},sr=Object(h.makeStyles)((e=>({region:{border:`solid 1px ${e.palette.border.main}`,position:"relative"},containerWithDragHandle:{paddingLeft:"33px",backgroundColor:e.palette.background.paper,"&:hover":{backgroundColor:({readOnly:t})=>t?e.palette.background.paper:void 0}},learningModuleComponent:{flex:"1 1 auto"},learningModuleComponentDetails:{position:"relative"},learningModuleReviewStateIcon:{left:"-36px"},learningModuleDragHandle:{left:"-3px"},title:{"&:hover, &:active:hover":{textDecoration:"none"}}})));const or=Object(h.makeStyles)((e=>Object(h.createStyles)({instructorNote:{color:e.palette.text.secondary,marginTop:"5px"}}))),lr=e=>{const{item:t}=e,n=Object(d.a)(),a=or();return m.B.isForcedSequenceModule(t)&&m.j.canEdit(t)?i.a.createElement("div",{className:a.instructorNote},n("components.directives.learning-module.base-item.forced-sequence.instructor-note")):null};const cr=e=>{var t;const{contentsContainerId:n,item:o,open:l,toggleContents:c}=e,[h,g]=function(e){const t=Object(u.d)(),n=ue();return[Object(u.e)((t=>{var n,a;return null!==(a=null===(n=t.content.contents[null!=e?e:""])||void 0===n?void 0:n.hasProgressed)&&void 0!==a&&a})),Object(a.useCallback)((()=>{e&&t(m.V.content.loadContents({contentId:e,courseId:n,hasProgressed:!0}))}),[t,n,e])]}(o.id),b=Object(p.s)(o.courseId,["course.content.MODIFY"]),f=Object(d.a)(),v=Object(a.useRef)(null),y=kn(o),S=!zi(o),C=function(e){return{...Z(),...sr(e)}}({readOnly:S});Object(a.useEffect)((()=>{l&&((e=>{Object(pi.r)({type:pi.c.LearningModuleOpened,status:pi.b.Success,contentId:e.id})})(o),g())}),[l,o,g]);const E=m.j.canHaveReviewState(o)&&m.j.canViewReviewState(o)&&!!o.id,I=m.j.canEdit(o),k=l&&function(e,t){return m.j.canEdit(e)&&m.B.isForcedSequenceModule(e)&&!m.j.isHiddenFromStudents(e)&&t}(o,h),w=`learning-module-title-${o.id}`,T=(e=>{if(e.id)return s.j.EditLearningModule({id:e.id})})(o),O={editContentRoute:T,usesEditButton:I&&!!T,contentProgressRoute:nr(o)},A=function(e){return m.j.canDelete(e)||m.j.canEdit(e)}(o),P=function(e,t={}){const{editContentRoute:n,usesEditButton:a,contentProgressRoute:i}=t;return[Xa(n,a),gi(e,i),ui(e)]}(o,O),x=Si(o);return i.a.createElement("div",{role:"region","aria-labelledby":w,className:C.region},i.a.createElement(En,{className:C.containerWithDragHandle,elementToClickRef:v,readOnly:S,draggable:x,contentId:o.id},x&&i.a.createElement("div",{className:Object(r.a)(C.dragHandle,C.overlaidIcon,C.learningModuleDragHandle)},i.a.createElement(Ii,{itemTitle:null!==(t=o.title)&&void 0!==t?t:""})),i.a.createElement("div",{className:C.learningModuleComponent},i.a.createElement("div",{className:Object(r.a)(C.contentItemComponentDetails,C.learningModuleComponentDetails)},E&&i.a.createElement("div",{className:Object(r.a)(C.overlaidIcon,C.learningModuleReviewStateIcon)},i.a.createElement(An,{item:o,supportsManualTransition:!1})),i.a.createElement("div",{className:C.contentItemContentArea},i.a.createElement(gn,{id:w,analyticsId:"course.learning.module.base.item.toggleLm.button","aria-controls":n,"aria-expanded":l,"aria-label":f("components.directives.learning-module.aria-label.toggleLM",{learningModuleName:o.title}),className:C.title,readOnly:S,onClick:c,ref:v},o.title),i.a.createElement("div",{className:C.contentVisibility},i.a.createElement(fa,null,I&&i.a.createElement(la,{item:o})),m.j.hasAdaptiveReleaseRules(o)&&i.a.createElement(yi,{item:o,tabbableByStudents:!0,visibleAsInstructor:I||b})),i.a.createElement(lr,{item:o})),i.a.createElement("div",{className:C.contentItemContextArea},A&&i.a.createElement(va,{item:o,overflowMenuItems:P}),!S&&i.a.createElement(j.g,{open:l}))),y&&i.a.createElement(Ja,{description:y}))),k&&i.a.createElement(j.t,null))},dr=Object(h.makeStyles)((e=>({container:{padding:"20px 0"},learningModuleContents:{position:"relative",border:`solid 1px ${e.palette.border.main}`,borderTop:"0",padding:"25px 0",boxShadow:`inset 0px 3px ${e.palette.background.paper},\n       inset 0px -3px ${e.palette.background.paper}`},emptyReadOnlyLearningModuleContents:{padding:"5px 0"}}))),ur=e=>{const{item:t,loadMoreContent:n}=e,a=Object(d.a)(),[r,s]=Yi(t,n),o=dr();Object(oe.i)(oe.b.UpdateReviewState,((e,n)=>{const a=Object(oe.e)(oe.d.CurrentCourseMembership).isStudentMembership();Object(oe.e)(oe.d.LearningModuleRefreshChildrenOperations).refreshChildren(n,t,a)}));const l=`learning-module-contents-${t.id}`;return i.a.createElement("div",{className:o.container},i.a.createElement(_i,{togglableId:t.id},i.a.createElement(cr,{contentsContainerId:l,item:t,open:r,toggleContents:s}),i.a.createElement(tr,{item:t,isOpen:r,loadMoreContent:n,containerId:l,readOnlyEmptyMessage:a("components.directives.learning-module.empty"),classes:{readOnlyEmpty:o.emptyReadOnlyLearningModuleContents,wrapperInner:o.learningModuleContents}})))},mr=(e,t)=>{if(e.id&&(e=>!!m.j.canEdit(e)||!m.j.isRestricted(e))(e))return s.j.Document({id:e.id,view:t})},pr=e=>{const{item:t}=e,n=mr(t,"content"),a=mr(t,"progress"),r={analyticsId:"content.item.coures.outline.document.link",href:Object(s.cb)(n)},o={editContentRoute:n,contentProgressRoute:a,usesEditButton:m.j.canEditAvailability(t)&&!!n,supportsConversations:!0};return i.a.createElement(wi,{linkProps:r,item:t,overflowMenuProps:o,defaultIconDetails:{Icon:xi.a,ariaLabelKey:Object(q.j)("document-text")}})};var hr=n("MTZf");const gr=e=>{const{item:t,linkedItem:n,isRestricted:r,readOnly:o}=e,l=null!=n?n:t,c=(e=>{if(e.id&&m.j.canEdit(e))return s.I.EditScorm({contentId:e.id})})(l),d=Ni(c,t),u=(e=>{var t,n;const[i,r]=Object(a.useState)(void 0),o=ue(),l=null!==(n=Object(p.s)(o,["course.gradebook.MODIFY"])&&(null===(t=e.hasReport)||void 0===t?void 0:t.call(e)))&&void 0!==n&&n,{id:c}=e;return Object(a.useEffect)((()=>{const e=Object(oe.e)(oe.d.CurrentCourseMembership),t=l&&!e.isStudentMembership();r(c&&t?s.I.ScormAnalyticsReport({contentId:c,courseId:o}):void 0)}),[c,o,l]),i})(t),h=nr(t),g={editContentRoute:d,usesEditButton:m.j.canEditAvailability(l)&&!!d,analyticsRoute:u,supportsConversations:!0,contentProgressRoute:h};return i.a.createElement(wi,{linkProps:{analyticsId:"content.item.scormlaunch.link",href:"#",onClick:()=>(async e=>{const t=Object(oe.e)(oe.d.Scorm);e.id&&e.courseId&&await t.scormLaunch({contentId:e.id,courseId:e.courseId,content:e,showPreLaunchPanel:!0})})(l)},item:t,isRestricted:r,readOnly:o,showLinkBadge:!!n,overflowMenuProps:g,defaultIconDetails:{Icon:hr.a,ariaLabelKey:Object(q.j)("scormengine")}})};var br=n("RrOo");const fr=e=>{var t;const{item:n,linkedItem:a,isRestricted:r,readOnly:o}=e,l=null!=a?a:n,c=(d=l.courseId,!!Object(p.s)(d,["course.assessment.MODIFY","course.assessment.VIEW"]));var d;const u=((e,t)=>{if(e.id)return t?Object(s.T)({courseId:e.courseId,contentId:e.id,gradeitemView:"details",assessmentType:"test"}):m.j.isExternalSubmissionsAssessment(e)?Object(s.N)({contentId:e.id}):Object(s.O)({contentId:e.id})})(l,c),h=Ni(u,n),g=Object(s.cb)(u),b=null===(t=l.getDeployedAssessment())||void 0===t?void 0:t.permissions,f=!(!b||!b.modify&&!b.view),v={analyticsId:c?"content.item.courses.outline.gradebook.item.assessment.link":"content.item.courses.outline.gradebook.item.assessment.readOnly.link",href:g},y={editContentRoute:h,usesEditButton:f,supportsConversations:!0};return i.a.createElement(wi,{linkProps:v,item:n,isRestricted:r,readOnly:o,showLinkBadge:!!a,overflowMenuProps:y,defaultIconDetails:{Icon:br.a,ariaLabelKey:Object(q.j)("test")}})};var vr=n("36Bh"),yr=n("KjBU"),Sr=n.n(yr);const Cr=e=>{const{item:t}=e,n=(e=>{var t,n;let a=null===(n=null===(t=e.contentDetail)||void 0===t?void 0:t[I.t.ExternalLink])||void 0===n?void 0:n.url;if(a)return a=Sr()(a),Object(Ve.f)(a)})(t),a=$i(t),r=nr(t),s=e=>{(e=>{Mi(pi.c.LinkOpened,pi.e.Link,e)})(e),Je(e)},o={editContentRoute:a,usesEditButton:m.j.canEditAvailability(t)&&!!a,supportsConversations:!1,contentProgressRoute:r};return i.a.createElement(wi,{linkProps:{analyticsId:"content.item.course.outline.courseContent.link",href:n,onClick:()=>s(t),target:"_blank",rel:"noopener noreferrer"},item:t,overflowMenuProps:o,defaultIconDetails:{Icon:vr.a,ariaLabelKey:Object(q.j)("link")}})};var Er=n("13AT");const Ir=e=>{const t=Object(oe.e)(oe.d.Lti).getDomainConfigStatusType(e),n=!!e.id&&m.C.isLtiLink(e),a=t===oe.a.Excluded,i=!1===m.C.ltiToolProviderExists(e);return n&&(i||a)};function kr(e,t){const n=(a=e,Object(oe.e)(oe.d.Lti).getDomainConfigStatusType(a)===oe.a.NeedsApproval);var a;const i=Ir(e),r=m.C.isUnlaunchableLtiLink(e),s=t?"admin":"instructor";return i&&!n?`courseCore.components.contentItems.ltiExcludedProvider.${s}`:r&&!n?`courseCore.components.contentItems.ltiDeletedPlacement.${s}`:r&&n?"courseCore.components.contentItems.ltiApprovalRequired":"courseCore.components.contentItems.ltiBrokenLink"}const wr=Object(h.makeStyles)((e=>({alertLtiLink:{fontSize:e.typography.fontSizeSmall,fontWeight:e.typography.fontWeightSemiBold,color:e.palette.error.main}})));const Tr=e=>{const{item:t}=e,n=(e=>{const[t,n]=Object(a.useState)(!1);return Object(a.useEffect)((()=>{Object(oe.e)(oe.d.Entitlement).hasSystemEntitlement(e).then(n)}),[e]),t})("system.buildingblocks.VIEW"),r=Object(d.a)(),s=wr(e);return i.a.createElement("span",{className:s.alertLtiLink,dangerouslySetInnerHTML:{__html:r(kr(t,n))}})},Or=e=>{const{item:t,children:n,editRoute:a,usesEditButton:r,supportsConversations:s,iconDetails:o,linkedItem:l}=e,c=null!=l?l:t,d=Ni(a,t),u=(Ir(p=c)||m.C.isUnlaunchableLtiLink(p))&&m.j.canViewAsInstructor(p);var p;const h=nr(t),g={analyticsId:"content.item.course.outline.courseContent.link",href:"#",onClick:()=>(async e=>Object(oe.e)(oe.d.Lti).ltiLaunch({courseId:e.courseId,contentId:e.id,content:e,showPreLaunchPanel:!0}))(c).catch((e=>{console.error(e)}))};u&&(g.href=void 0,g.onClick=void 0);const b={editContentRoute:d,usesEditButton:r,supportsConversations:s,contentProgressRoute:h};return i.a.createElement(wi,{linkProps:g,overflowMenuProps:b,item:t,showLinkBadge:null!=l,defaultIconDetails:o,showAlertIcon:m.C.isUnlaunchableLtiLink(c),showContentVisibility:!m.C.isUnlaunchableLtiLink(c)},u&&i.a.createElement(Tr,{item:c}),n)};const Ar=e=>{var t,n;const{item:a,linkedItem:r}=e,o=null!=r?r:a,l=(e=>{if(e.id)return s.B.EditLti({id:e.id})})(o),c=function(e,t){return m.j.canEditAvailability(e)&&!!t}(o,l);return i.a.createElement(Or,{...e,iconDetails:{Icon:Er.a,ariaLabelKey:Object(q.j)("lti"),customIconUrl:null===(n=null===(t=a.contentDetail)||void 0===t?void 0:t["resource/x-bb-blti-link"])||void 0===n?void 0:n.customIconUrl},editRoute:l,usesEditButton:c,supportsConversations:!0})};const Pr=e=>{const{item:t,linkedItem:n}=e,a=null!=n?n:t,r=(e=>{var t;if(e.id)return e.contentHandler&&(null===(t=e.contentDetail)||void 0===t?void 0:t[e.contentHandler.toString()].placement)?s.B.EditLtiPlacement({id:e.id}):void 0})(a),o=function(e,t){return m.j.canEditAvailability(e)&&!!t}(a,r);return i.a.createElement(Or,{...e,iconDetails:{Icon:Er.a,ariaLabelKey:Object(q.j)("lti")},editRoute:r,usesEditButton:o,supportsConversations:!0})},xr=e=>i.a.createElement(Or,{...e,iconDetails:{Icon:Er.a,ariaLabelKey:Object(q.j)("lti")},editRoute:void 0,usesEditButton:!1,supportsConversations:!1});var $r=n("6/tG");const Nr=e=>{const{item:t}=e,n=(e=>{var t,n,a;if(!e.id)return;const i=null!==(t=e.contentHandler)&&void 0!==t?t:"",r=null===(a=null===(n=e.contentDetail)||void 0===n?void 0:n[i.toString()])||void 0===a?void 0:a.launchLink;if(!r)return;const o=Object(Ve.d)(r),l=Object(Ve.a)(o,"from_ultra","true");return s.B.EditLtiCloudDocument({courseId:e.courseId,contentId:e.id,toolHref:l})})(t),a=function(e){var t;return null!==(t=Object(p.s)(null==e?void 0:e.courseId,["course.content.MODIFY"]))&&void 0!==t&&t&&!Ir(e)&&!!m.C.ltiPlacementExists(e)}(t);return i.a.createElement(Or,{...e,iconDetails:{Icon:$r.a,ariaLabelKey:Object(q.j)("onedrive")},editRoute:n,usesEditButton:a,supportsConversations:!0})},Dr=Object(h.makeStyles)((e=>({container:({nestingLevel:t})=>({margin:"20px 0",marginLeft:`${H(t,"sm")}px`,[e.breakpoints.up("sm")]:{marginLeft:`${H(t,"md+")}px`}})}))),Lr=(e,t)=>n=>{((e,t)=>{var n;t.title=e.displayName,(null===(n=t.contentDetail)||void 0===n?void 0:n["resource/x-bb-file"])&&e.render&&(t.contentDetail["resource/x-bb-file"].fileAssociationMode=Object(an.c)(e.render))})(n,e),t()},jr=(e,t)=>()=>{e(),t()};const Mr=e=>{const{item:t}=e,n=(()=>{const e=K();return Dr({nestingLevel:e})})(),r=Object(u.d)(),{deleteContent:s}=Ut(),[o,l]=Object(a.useState)(!1),c=Object(u.e)((e=>m.Yb.fileUpload.getFileUploadById(e,t.ui.uploadCorrelationId))),{filename:d,uploadProgress:p,uploadDetails:h,isCloudUpload:g,error:b}=null!=c?c:{},{progress:f,aborter:v}=null!=p?p:{},{errorType:y,errorCode:S}=null!=b?b:{},C=null==h?void 0:h.canUpdateFileDetails;if(Object(a.useEffect)((()=>{"number"==typeof(null==f?void 0:f.total)&&(null==f?void 0:f.loaded)===f.total&&l(!0)}),[null==f?void 0:f.loaded,null==f?void 0:f.total]),!c)return null;function E(){null==v||v.abort(),s(t)}function I(e=!1){t.ui.uploadCorrelationId&&r(m.V.fileUpload.fileDetailsUpdated({correlationId:t.ui.uploadCorrelationId},e))}const k=f?function(e){if(e.lengthComputable)return Math.round(e.loaded/e.total*100)}(f):0,w=t?((e,t)=>{var n,a,i,r,s,o,l,c,d;const u=null!==(r=null===(i=null===(a=null===(n=e.contentDetail)||void 0===n?void 0:n["resource/x-bb-file"])||void 0===a?void 0:a.file)||void 0===i?void 0:i.fileName)&&void 0!==r?r:"";return{resourceUrl:null!==(s=e.ui.webLocation)&&void 0!==s?s:"",viewerUrl:void 0,fileName:u,alternativeText:u,displayName:u,mimeType:null!==(d=null===(c=null===(l=null===(o=e.contentDetail)||void 0===o?void 0:o["resource/x-bb-file"])||void 0===l?void 0:l.file)||void 0===c?void 0:c.mimeType)&&void 0!==d?d:"",render:m.s.Inline,fileSize:null==t?void 0:t.filesize}})(t,c):void 0,T=y&&y!==m.T.Oversized;return i.a.createElement(i.a.Fragment,null,i.a.createElement(j.q,{className:n.container,filename:d,onCancel:E,percentage:k,processing:o,displayAsError:void 0!==y}),C&&w&&i.a.createElement(j.o,{file:w,onCancel:jr(E,(()=>I(!0))),onSave:Lr(t,I),hidden:!1,supportsInlineDocumentRender:!0,canProvideDescription:!1,analyticsId:"course-outline.upload-file"}),T&&i.a.createElement(q.h,{isCloudUpload:g,errorCode:S,processError:function(){s(t)},filename:d}))};const Gr=e=>{var t;const{item:n,loadMoreContent:a}=e;switch(function(e){if(e)return e.startsWith(I.t.LtiPlacement)?I.t.LtiPlacement:e}(null===(t=n.contentHandler)||void 0===t?void 0:t.toString())){case I.t.TestLink:return i.a.createElement(fr,{item:n});case I.t.CourseLink:return i.a.createElement(cn,{item:n});case I.t.Discussion:return i.a.createElement(Pi,{item:n});case I.t.Document:case I.t.Page:return i.a.createElement(Di,{item:n});case I.t.Folder:return Object(an.e)(n)?i.a.createElement(pr,{item:n}):i.a.createElement(ar,{item:n,loadMoreContent:a});case I.t.Journal:return i.a.createElement(rr,{item:n});case I.t.LearningModule:return i.a.createElement(ur,{item:n,loadMoreContent:a});case I.t.RusticiScorm:return i.a.createElement(gr,{item:n});case I.t.File:return rn(n)?i.a.createElement(Mr,{item:n}):i.a.createElement(Gi,{item:n});case I.t.ExternalLink:return i.a.createElement(Cr,{item:n});case I.t.PartnerCloud:return i.a.createElement(xr,{item:n});case I.t.LtiPlacement:return i.a.createElement(Pr,{item:n});case I.t.LtiLink:return function(e){var t,n,a;const i=null===(t=e.contentHandler)||void 0===t?void 0:t.toString();return!!i&&m.D.CloudDocument===(null===(a=null===(n=null==e?void 0:e.contentDetail)||void 0===n?void 0:n[i])||void 0===a?void 0:a.itemOrigin)}(n)?i.a.createElement(Nr,{item:n}):i.a.createElement(Ar,{item:n});default:return i.a.createElement(Ti,{item:n})}};function Rr(e){const t={...e,$scope:void 0,$_ultra_previous_version:void 0,$last:void 0,children:void 0};return t.ui.file=void 0,t.ui.linkSource&&(t.ui={...e.ui,linkSource:Rr(t.ui.linkSource)}),t}const Br=Object(a.createContext)({dndRef:()=>{}});const Fr=Object(a.createContext)({onDrop:void 0,onDragOver:void 0,onDragEnter:void 0,onDragLeave:void 0,registerNode:void 0});function Ur(e){return{x:e.clientX,y:e.clientY}}function _r(e,t){var n;const{currentTarget:a}=e,{top:i,right:r,bottom:s,left:o,width:l,height:c}=a.getBoundingClientRect(),{id:d,data:u}=null!==(n=t.get(a))&&void 0!==n?n:{};return{id:d,element:a,rect:{top:i,right:r,bottom:s,left:o,width:l,height:c},data:u}}const zr=e=>{const{onDrop:t,onDragOver:n,onDragEnter:r,onDragLeave:s,children:o}=e,l=Object(a.useRef)(new WeakMap),c=Object(a.useMemo)((()=>({registerNode(e,t){l.current.set(e,t)},onDragOver(e){e.preventDefault(),e.stopPropagation(),null==n||n(e,_r(e,l.current),Ur(e))},onDragEnter(e){e.preventDefault(),e.stopPropagation(),null==r||r(e,_r(e,l.current),Ur(e))},onDragLeave(e){e.preventDefault(),e.stopPropagation(),null==s||s(e,_r(e,l.current),Ur(e))},onDrop(e){e.preventDefault(),e.stopPropagation(),t(e,_r(e,l.current),Ur(e))}})),[t,n,r,s]);return i.a.createElement(Fr.Provider,{value:c},o)},qr=e=>{const{id:t,disabled:n=!1,data:i}=e,r=Object(a.useRef)(null),{onDrop:s,onDragOver:o,onDragEnter:l,onDragLeave:c,registerNode:d}=Object(a.useContext)(Fr);let u={};return n||(u={onDrop:s,onDragOver:o,onDragEnter:l,onDragLeave:c}),{setNodeRef:e=>{r.current=e,e&&(null==d||d(e,{id:t,data:i}))},listeners:u}},Hr=e=>{const{id:t,item:n,children:r,...s}=e,{style:o,dndRef:l}=Object(a.useContext)(Br),c=Si(n),{setNodeRef:d,listeners:u}=qr({id:t,disabled:!c,data:{item:n}}),m=function(...e){return t=>{t&&e.forEach((e=>e(t)))}}(l,d);return i.a.createElement("div",{"data-content-id":t,...s,...u,style:o,ref:m},r)},Vr=i.a.memo((e=>{const{item:t,parentId:n,loadMoreContent:r,showAddButton:s,neighborBeforeId:o,neighborAfterId:l,className:c}=e,{AddContentButton:d}=Object(a.useContext)(Ft);Object(oe.j)((()=>Rr(t)),[t]);if(!Vi(t))return null;const u=Kt(t);return i.a.createElement(Hr,{id:u,item:t,className:c},i.a.createElement(Tn,{previousNeighborId:o,nextNeighborId:l},i.a.createElement(Gr,{item:t,loadMoreContent:r}),s&&!rn(t)&&i.a.createElement(d,{id:u,parentId:n,item:t})))}));function Wr(e){return!!e&&(m.j.isFolderContentItem(e)||m.i.LearningModule.isEqualTo(e.contentHandler))}function Kr(){return Object(qt.e)((({set:e})=>(t,n)=>{e(Cn(t),n)}),[])}function Yr(){return Object(qt.e)((({snapshot:e})=>t=>!e.getLoadable(Cn(t)).getValue()),[])}function Jr(){return Object(qt.e)((({snapshot:e})=>t=>e.getLoadable(Cn(t)).getValue()),[])}function Zr({active:e,over:t}){if(!t||!e)return"neither";return e.top+e.height/2<=t.top+t.height/2?"top":"bottom"}function Qr(){const{active:e,over:t}=Object(Qi.k)();return function(e,t,n){return a=>{var i,r;const{activeIndex:s,index:o,rects:l,overIndex:c}=a,d=null!==(i=l[s])&&void 0!==i?i:a.activeNodeRect,u=null===(r=null==t?void 0:t.data.current)||void 0===r?void 0:r.item,m=s===o,p=c===o;if(!d||!Wr(u)||!m&&!p)return Object(tn.d)(a);const h=Zr({active:null==e?void 0:e.rect.current.translated,over:l[c]}),g=s<c&&"top"===h,b=s>c&&"bottom"===h,f=n(u.id)||g||b;if(m&&f){const e=l[c-1];if(e&&s<c)return{x:0,y:e.top+e.height-(d.top+d.height),scaleX:1,scaleY:1};const t=l[c+1];if(t&&s>c)return{x:0,y:t.top-d.top,scaleX:1,scaleY:1}}return p&&f?{x:0,y:0,scaleX:1,scaleY:1}:Object(tn.d)(a)}}(e,t,Jr())}const Xr=e=>e-1,es=i.a.memo((function(e){const{sortableProps:t,dragHandleProps:n,dndContainerProps:a,...r}=e;return i.a.createElement(fn.Provider,{value:t},i.a.createElement(Br.Provider,{value:a},i.a.createElement(Ci.Provider,{value:n},i.a.createElement(Vr,{...r}))))})),ts=Object(a.memo)((function(e){const{item:t,parentId:n}=e,r=K(),s=Qr(),o=Si(t),{activatorEvent:l}=Object(Qi.k)(),{attributes:c,listeners:d,setNodeRef:u,setActivatorNodeRef:m,transform:p,transition:h,isDragging:g,isSorting:b,active:f}=Object(tn.c)({id:Kt(t),strategy:s,data:{type:Zi.Item,item:t,parentId:n,nestingLevel:r},disabled:!o}),v=Object(a.useMemo)((()=>({listeners:d,isDragging:g,isSorting:b})),[d,g,b]);let y;l&&(y=l instanceof KeyboardEvent?"keyboard":"pointer");const S=Object(a.useMemo)((()=>({attributes:c,dragHandleRef:m,activationEvent:y})),[c,y,m]),C=nn.a.Transform.toString(p),E=(({active:e,itemParentId:t})=>!Object(tn.b)(e)||e.data.current.sortable.containerId!==t)({active:f,itemParentId:t.parentId})?void 0:h,I=Object(a.useMemo)((()=>({style:{transform:C,transition:E,touchAction:"manipulation"},dndRef:u})),[C,u,E]);return i.a.createElement(es,{sortableProps:v,dragHandleProps:S,dndContainerProps:I,...e})}));const ns=(e,t)=>{const n=e[t];if(n)return{contentId:n.id}};const as=e=>`${e}-end-of-list`,is=e=>{const{parentId:t,lastContentIdInList:n}=e,a=K(),r=Object(qt.g)(Cn(n)),{setNodeRef:s}=Object(tn.c)({id:as(t),disabled:!r,data:{type:Zi.EndOfList,parentId:t,nestingLevel:a,lastContentIdInList:n}});return i.a.createElement("div",{ref:s})},rs=e=>{const{id:t,items:n,children:r}=e,{measureDroppableContainers:s}=Object(Qi.k)(),o=Object(oe.h)((()=>(null!=n?n:[]).map((e=>Kt(e))).concat(as(t))),[n]),l=Object(a.useCallback)((e=>{const t=o.findIndex((t=>t===e))+1,n=o[t];n&&s([n])}),[s,o]);return i.a.createElement(er.Provider,{value:l},i.a.createElement(tn.a,{id:t,items:o,strategy:tn.d},r,i.a.createElement(is,{parentId:t,lastContentIdInList:null==o?void 0:o[o.length-2]})))};const ss="start",os=i.a.memo((e=>{var t;const{parentFolder:n,loadMoreContent:s,showTopAddButton:o=!1,root:l=!1,centeredDivider:c=!1}=e,{AddContentButton:d,textOnPage:u}=Object(a.useContext)(Ft),p=K(),h=function(e,t){const n=Object(oe.h)((()=>e),[e]);return Object(oe.i)(oe.b.ContentUpdate,((e,a)=>{!function(e,t,n){var a;const{parentId:i,id:r}=n;let{position:s}=n;i&&t&&i!==t||("number"==typeof s&&(null===(a=null==e?void 0:e[s])||void 0===a?void 0:a.id)!==r&&(s=void 0),i&&"number"==typeof s||(s=null==e?void 0:e.findIndex((e=>e.id===r))),"number"==typeof s&&(null==e?void 0:e[s])&&(e[s]=n))}(n,t,a)})),n}(e.contents,null==n?void 0:n.id),g=function(e,t){var n,i;const r=Object(a.useContext)(Fi);if(!e)return t;let s=null!==(n=null==t?void 0:t.concat())&&void 0!==n?n:[];return e===(null==r?void 0:r.item.parentId)&&(s=s.filter((e=>e!==r.item))),e===(null==r?void 0:r.folderId)&&s.splice(null!==(i=r.insertPosition)&&void 0!==i?i:0,0,r.item),s}(null==n?void 0:n.id,h),b=ee({nestingLevel:p,isButtonVisible:l||o}),f=Object(a.useRef)(null),v=function(e){if(!e||0===e.length||e.paging.count<e.length)return 0;const t=e.paging.count-e.length;return Math.min(t,e.paging.limit)}(h),[y,S]=Object(a.useState)({prevLoadCount:0,currLoadCount:v}),C=Si(n),{setNodeRef:E,listeners:I}=qr({id:`${null==n?void 0:n.id}-contents-external-file-droppable`,data:{parentId:null==n?void 0:n.id},disabled:!C});Object(a.useEffect)((()=>{S((e=>({prevLoadCount:e.currLoadCount,currLoadCount:v})))}),[v]);const k=!!h&&Vt(h);return i.a.createElement(rs,{id:n?Kt(n):void 0,items:g},i.a.createElement("div",{ref:E,...I},k&&i.a.createElement(d,{id:`start-${null!==(t=null==n?void 0:n.id)&&void 0!==t?t:Object(Ht.v4)()}`,parentId:null==n?void 0:n.id,positionBefore:ss,item:null==h?void 0:h[0],classes:{divider:Object(r.a)(b.divider,c?b.centeredDivider:b.topDivider)}}),i.a.createElement("div",{"data-togglable-bottom":n?Kt(n):""}),i.a.createElement("div",{ref:f,className:b.contentList},null==g?void 0:g.map(((e,t,a)=>{const o=(e=>k&&!function(e){var t;return!!(null===(t=e.ui)||void 0===t?void 0:t.importPlaceholder)}(e))(e),c=Object(r.a)({root:l,"addable-item":o},"content-list-item",b.contentListItem),{neighborBefore:d,neighborAfter:u}={neighborBefore:ns(p=a,(h=t)-1),neighborAfter:ns(p,h+1)};var p,h;const g=m.B.isInForcedSequenceLearningModule(e);return i.a.createElement(ts,{key:Kt(e,{stable:!0}),item:e,parentId:null==n?void 0:n.id,loadMoreContent:s,showAddButton:o,neighborBeforeId:g?null==d?void 0:d.contentId:void 0,neighborAfterId:g?null==u?void 0:u.contentId:void 0,className:c})})),i.a.createElement(j.y,{afterLoad:()=>{const e=function(e,t){return null==e?void 0:e[e.length-t]}(h,y.prevLoadCount);e&&function(e,t){en(Yt(e,t.current))}(e,f)},loader:()=>function(e,t){return e&&t?t(e,!0):Promise.resolve()}(n,s),incomingLoadCount:y.currLoadCount,axLoadMoreButtonLabelKey:null==u?void 0:u.axLoadMoreButtonLabelKey}))))}));var ls=n("7nmT");const cs=i.a.memo(Gr),ds=e=>{const{item:t,nestingLevel:n=0}=e,r=Object(a.useMemo)((()=>({isDragOverlay:!0,isSorting:!0})),[]);return i.a.createElement(fn.Provider,{value:r},i.a.createElement(W,{value:n},Object(ls.createPortal)(i.a.createElement(Qi.b,{zIndex:1011},t&&i.a.createElement(cs,{item:t})),document.body)))};function us(e,t,n){n((n=>{var a,i,r,s;const o=null===(a=e.data.current)||void 0===a?void 0:a.item,l=null==t?void 0:t.data.current,c=null==l?void 0:l.item;if(!o||(null==n?void 0:n.item)&&n.item===c||(null==l?void 0:l.parentId)&&(l.parentId===o.id||l.parentId===(null===(r=null===(i=o.children)||void 0===i?void 0:i[0])||void 0===r?void 0:r.id)))return n;if((null==l?void 0:l.type)===Zi.Container)return{item:o,folderId:null==l?void 0:l.parentId,targetId:void 0,insertPosition:0};if((null==l?void 0:l.type)===Zi.EndOfList&&!l.disabled)return{item:o,folderId:null==l?void 0:l.parentId,targetId:l.lastContentIdInList,insertPosition:null===(s=null==l?void 0:l.sortable)||void 0===s?void 0:s.items.length};if(!c)return n;if(!n&&o.parentId!==c.parentId||n&&n.folderId!==c.parentId){let t=null==l?void 0:l.sortable.index;const n=e.data.current;return(null==l?void 0:l.parentId)&&(null==n?void 0:n.parentId)&&(null==l?void 0:l.parentId)!==(null==n?void 0:n.parentId)&&l.sortable.index+1===l.sortable.items.length&&!Wr(c)&&(t+=1),{item:o,folderId:c.parentId,targetId:c.id,insertPosition:t}}return n}))}function ms(e,t){return{top:t.y,height:e.height,bottom:t.y+e.height,left:t.x,width:e.width,right:t.x+e.width}}const ps=e=>{var t,n,a,i,r;const{active:s}=e,o=Object(Qi.g)(e),l=null===(i=null===(a=null===(n=null===(t=o[0])||void 0===t?void 0:t.data)||void 0===n?void 0:n.droppableContainer)||void 0===a?void 0:a.data)||void 0===i?void 0:i.current;return(null==l?void 0:l.type)===Zi.EndOfList&&(null==l?void 0:l.parentId)===(null===(r=s.data.current)||void 0===r?void 0:r.parentId)?o.slice(1):o};const hs=20;function gs(e){const{collisionRect:t,over:n,draggingFrom:a,distance:i=hs}=e,r="above"===a?-1:1;return n.bottom-n.height/2-t.height/2+r*i}function bs(e,t){if(!Object(tn.b)(e)||!Object(tn.b)(t))return!1;const n=e.data.current.sortable.index<t.data.current.sortable.index,a=Zr({active:e.rect.current.translated,over:t.rect});return n&&"top"===a||!n&&"bottom"===a}const fs=[Qi.c.Down,Qi.c.Right,Qi.c.Up,Qi.c.Left];const vs=30;function ys(e,t,n,a){return(i,r)=>{var s,o,l,c,d,u,m,p,h,g,b,f;if(f=i.code,!fs.includes(f))return;i.preventDefault();const{active:v,collisionRect:y,droppableRects:S,droppableContainers:C,over:E}=r.context,I=null===(o=null===(s=null==v?void 0:v.data.current)||void 0===s?void 0:s.item)||void 0===o?void 0:o.id;if(!(v&&I&&y&&E))return;if([Qi.c.Left,Qi.c.Right].includes(i.code))return function(e){var t,n,a,i;const{active:r,activeId:s,code:o,collisionRect:l,over:c,isOpen:d,setTogglableOpenState:u,setDndActionState:m}=e,p=null===(t=c.data.current)||void 0===t?void 0:t.item,h=null==p?void 0:p.id;if(Wr(p)&&h&&s!==h)if(o===Qi.c.Right&&!d(h)&&bs(r,c)){const e="bottom"===Zr({active:l,over:c.rect});if(u(h,!0),e){const e=null!==(n=r.rect.current.initial)&&void 0!==n?n:l,t=ms(c.rect,{x:c.rect.left,y:c.rect.top+e.height});return m({folderId:p.parentId,item:null===(a=r.data.current)||void 0===a?void 0:a.item,targetId:p.id,insertPosition:null===(i=c.data.current)||void 0===i?void 0:i.sortable.index}),{x:c.rect.left+vs,y:gs({collisionRect:l,over:t,draggingFrom:"above"})}}}else if(o===Qi.c.Left&&d(h))return u(h,!1),{x:c.rect.left+vs,y:gs({collisionRect:l,over:c.rect,draggingFrom:"above"})}}({active:v,activeId:I,code:i.code,collisionRect:y,over:E,isOpen:e,setTogglableOpenState:t,setDndActionState:a});const k=null===(l=E.data.current)||void 0===l?void 0:l.item;if(Wr(k)&&!e(k.id)&&I!==k.id){const e=Zr({active:y,over:E.rect});if(i.code===Qi.c.Down&&"top"===e)return bs(v,E)?{x:E.rect.left,y:Math.max(E.rect.bottom-y.height,gs({collisionRect:y,over:E.rect,draggingFrom:"below",distance:1}))}:{x:E.rect.left+vs,y:gs({collisionRect:y,over:E.rect,draggingFrom:"below"})};if(i.code===Qi.c.Up&&"bottom"===e)return bs(v,E)?{x:E.rect.left,y:Math.min(E.rect.top,gs({collisionRect:y,over:E.rect,draggingFrom:"above",distance:1}))}:{x:E.rect.left+vs,y:gs({collisionRect:y,over:E.rect,draggingFrom:"above"})}}const w=function(e){var t,n,a,i,r,s,o,l,c,d,u,m,p,h,g,b,f;const{active:v,over:y,code:S,collisionRect:C,droppableContainers:E,droppableRects:I}=e,k=[];E.getEnabled().forEach((e=>{if(!e||e.disabled)return;const t=I.get(e.id);t&&(S===Qi.c.Down&&C.top<t.top||S===Qi.c.Up&&C.top>t.top)&&k.push(e)}));const w=ps({active:v,collisionRect:C,droppableRects:I,droppableContainers:k,pointerCoordinates:null});let T=null===(t=w.shift())||void 0===t?void 0:t.id;T===(null==y?void 0:y.id)&&(T=null!==(a=null===(n=w.shift())||void 0===n?void 0:n.id)&&void 0!==a?a:T);{const e=E.get(T);(null===(i=null==e?void 0:e.data.current)||void 0===i?void 0:i.type)===Zi.Container&&e.data.current.parentId===(null===(r=v.data.current)||void 0===r?void 0:r.parentId)&&(T=null!==(o=null===(s=w.shift())||void 0===s?void 0:s.id)&&void 0!==o?o:T)}return(null===(l=y.data.current)||void 0===l?void 0:l.type)===Zi.Container&&y.data.current.parentId===(null===(d=null===(c=E.get(T))||void 0===c?void 0:c.data.current)||void 0===d?void 0:d.parentId)&&(T=null!==(m=null===(u=w.shift())||void 0===u?void 0:u.id)&&void 0!==m?m:T),T===as(null===(p=y.data.current)||void 0===p?void 0:p.parentId)&&(null===(h=v.data.current)||void 0===h?void 0:h.parentId)===(null===(g=y.data.current)||void 0===g?void 0:g.parentId)&&(T=null!==(f=null===(b=w.shift())||void 0===b?void 0:b.id)&&void 0!==f?f:T),{rect:T?I.get(T):void 0,container:T?E.get(T):void 0}}({active:v,over:E,code:i.code,collisionRect:y,droppableContainers:C,droppableRects:S}),T=null===(d=null===(c=w.container)||void 0===c?void 0:c.data.current)||void 0===d?void 0:d.item;if(!w.rect||!w.container||E.id===w.container.id)return;if((null===(u=null==v?void 0:v.data.current)||void 0===u?void 0:u.parentId)!==(null===(p=null===(m=w.container)||void 0===m?void 0:m.data.current)||void 0===p?void 0:p.parentId)){if(((e,t,n)=>{var a;const i=null===(a=null==t?void 0:t.data.current)||void 0===a?void 0:a.sortable;switch(e){case Qi.c.Down:return i.index!==Xr(i.items.length)-1;case Qi.c.Up:return n!==Zi.EndOfList&&n!==Zi.Container;default:return!0}})(i.code,v,null===(h=w.container.data.current)||void 0===h?void 0:h.type)?us(v,{...w.container,rect:w.rect},a):us(v,{...w.container,rect:w.rect},n),i.code===Qi.c.Down)return{x:w.rect.left,y:w.rect.top-y.height};if((null==T?void 0:T.id)===(null===(g=v.data.current)||void 0===g?void 0:g.parentId)){const e=null!==(b=v.rect.current.initial)&&void 0!==b?b:y;return{x:w.rect.left+vs,y:gs({collisionRect:y,over:ms(w.rect,{x:w.rect.left,y:w.rect.top+e.height}),draggingFrom:"above"})}}return{x:w.rect.left,y:w.rect.bottom}}if(Object(tn.b)(v)&&Object(tn.b)(w.container)&&Wr(T)){const e=v.data.current.sortable.index,t=w.container.data.current.sortable.index;if(i.code===Qi.c.Down&&e<t)return{x:w.rect.left+vs,y:gs({collisionRect:y,over:w.rect,draggingFrom:"above"})};if(i.code===Qi.c.Up&&e>t)return{x:w.rect.left+vs,y:gs({collisionRect:y,over:w.rect,draggingFrom:"below"})}}var O,A;const P=(O=v,A=w.container,!(!Object(tn.b)(O)||!Object(tn.b)(A))&&O.data.current.sortable.containerId===A.data.current.sortable.containerId&&O.data.current.sortable.index<A.data.current.sortable.index)?y.height-w.rect.height:0;return{x:w.rect.left,y:w.rect.top-P}}}const Ss=Object(qt.c)({key:"contentOutline/dnd/refresher",default:()=>{}}),Cs=()=>{const{measureDroppableContainers:e}=Object(Qi.k)(),t=Object(qt.h)(Ss),n=Object(a.useRef)();return Object(a.useEffect)((()=>()=>{clearTimeout(n.current)}),[]),Object(a.useEffect)((()=>{t((()=>()=>{n.current=setTimeout((()=>{e([]),n.current=void 0}),30)}))}),[e,t]),null};function Es(e){const t=Object(a.useRef)();Object(a.useEffect)((()=>()=>{clearTimeout(t.current)}),[]);return function(e){const t=Object(qt.g)(Ss);return(n,a)=>{const i=e(n,a);return i&&t(),i}}(ys(Jr(),Kr(),e,((...n)=>{t.current=setTimeout((()=>{e(...n),t.current=void 0}),30)})))}const Is={start:[Qi.c.Space,Qi.c.Enter],cancel:[Qi.c.Esc,"Tab"],end:[Qi.c.Space,Qi.c.Enter]};const ks={onDragStart:()=>{},onDragMove:()=>{},onDragOver:()=>{},onDragEnd:()=>{},onDragCancel:()=>{}},ws=()=>{const e=(()=>{const e=Object(d.a)(),t=Object(a.useRef)(null),n=Object(a.useRef)(!0),i=Object(a.useRef)(""),r=Object(a.useRef)(),s=Object(a.useRef)(!1),o=Object(a.useRef)(),l=Jr(),c=Object(a.useCallback)((({active:t,over:n})=>{if(!Object(tn.b)(t)||!Object(tn.b)(n))return;const a=t.data.current.item,i=n.data.current.item;if(bs(t,n)&&Wr(i)){if(r.current===(null==i?void 0:i.id))return;r.current=null==i?void 0:i.id;let t="dragMoveOnClosedTogglable";return l(i.id)&&(t="dragMoveOnOpenTogglable"),e(`courseCore.course.dragAndDrop.announcements.${t}`,{contentItemTitle:null==a?void 0:a.title,togglableTitle:null==i?void 0:i.title,type:m.j.isFolderContentItem(i)?e("courseCore.course.dragAndDrop.announcements.folder"):e("courseCore.course.dragAndDrop.announcements.learningModule")})}}),[e,l]),u=()=>{t.current=null,o.current=void 0,r.current=void 0,i.current=void 0,s.current=!1};return Object(a.useMemo)((()=>({onDragStart({active:a}){if(n.current=!0,!Object(tn.b)(a))return;const r=a.data.current.item,{index:s,containerId:o,items:l}=a.data.current.sortable;return s===Xr(l.length)-1&&(i.current=o),t.current={containerId:o,index:s},e("courseCore.course.dragAndDrop.announcements.dragStart",{contentItemTitle:null==r?void 0:r.title,currentPosition:s+1,contentItemsCount:Xr(l.length)})},onDragMove({active:t,over:n}){if(s.current)return void(s.current=!1);if(!Object(tn.b)(t)||!Object(tn.b)(n))return;const a=t.data.current.item,l=t.data.current.sortable,d=n.data.current.sortable;if(i.current&&i.current!==l.containerId||l.containerId!==d.containerId)return i.current=void 0,e("courseCore.course.dragAndDrop.announcements.dragMove",{contentItemTitle:null==a?void 0:a.title,currentPosition:l.index+1,contentItemsCount:l.items.length});const u=n.data.current.item;if(r.current===(null==u?void 0:u.id)&&o.current)return r.current=void 0,e("courseCore.course.dragAndDrop.announcements.dragMove",{contentItemTitle:null==a?void 0:a.title,currentPosition:d.index+1,contentItemsCount:d.items.length});if(!r.current&&o.current===n.id){const e=c({active:t,over:n});if(e)return o.current=void 0,e}},onDragOver({active:t,over:a}){var d,u,m,p,h,g;if(o.current=null==a?void 0:a.id,!0===n.current)return void(n.current=!1);i.current&&(i.current=void 0);const b=null===(u=null===(d=null==t?void 0:t.data)||void 0===d?void 0:d.current)||void 0===u?void 0:u.item;if((null===(p=null===(m=null==a?void 0:a.data)||void 0===m?void 0:m.current)||void 0===p?void 0:p.type)===Zi.Container)return r.current=void 0,e("courseCore.course.dragAndDrop.announcements.dragMove",{contentItemTitle:null==b?void 0:b.title,currentPosition:1,contentItemsCount:1});if(!Object(tn.b)(t)||!Object(tn.b)(a))return;const f=c({active:t,over:a});if(f){const e=null===(g=null===(h=null==a?void 0:a.data)||void 0===h?void 0:h.current)||void 0===g?void 0:g.item;return l(null==e?void 0:e.id)&&(s.current=!0),f}const{index:v,items:y}=a.data.current.sortable;return r.current=void 0,e("courseCore.course.dragAndDrop.announcements.dragMove",{contentItemTitle:null==b?void 0:b.title,currentPosition:v+1,contentItemsCount:Xr(y.length)})},onDragCancel({active:t}){if(u(),!Object(tn.b)(t))return;const n=t.data.current.item;return e("courseCore.course.dragAndDrop.announcements.dragCancel",{contentItemTitle:null==n?void 0:n.title})},onDragEnd({active:n,over:a}){if(!Object(tn.b)(n)||!Object(tn.b)(a))return;const i=n.data.current.item,{index:r,containerId:s,items:o}=a.data.current.sortable,l=null==t?void 0:t.current;return u(),s===(null==l?void 0:l.containerId)&&r===(null==l?void 0:l.index)?e("courseCore.course.dragAndDrop.announcements.dragEndPositionRetained",{contentItemTitle:null==i?void 0:i.title}):e("courseCore.course.dragAndDrop.announcements.dragEnd",{contentItemTitle:null==i?void 0:i.title,finalPosition:r+1,contentItemsCount:Xr(o.length)})}})),[e,c,l])})(),t=Object(a.useRef)();return Object(a.useEffect)((()=>()=>{clearTimeout(t.current)}),[]),Object(Qi.l)(Object(a.useMemo)((()=>({onDragStart({active:t}){const n=e.onDragStart({active:t});n&&Object(Ve.t)(n)},onDragMove({active:n,over:a,activatorEvent:i}){t.current=setTimeout((()=>{if(e.onDragMove&&i instanceof KeyboardEvent){const t=e.onDragMove({active:n,over:a});t&&Object(Ve.t)(t)}t.current=void 0}),30)},onDragOver({active:n,over:a}){t.current=setTimeout((()=>{const i=e.onDragOver({active:n,over:a});i&&Object(Ve.t)(i),t.current=void 0}),30)},onDragEnd({active:t,over:n}){const a=e.onDragEnd({active:t,over:n});a&&Object(Ve.t)(a)},onDragCancel({active:t,over:n}){const a=e.onDragCancel({active:t,over:n});a&&Object(Ve.t)(a)}})),[e])),null};function Ts(e){const t=document.querySelector('[data-base-state-name="base.courses.peek"]'),n=null==t?void 0:t.style;n&&(n.position="enable"===e?"fixed":"",n.top="enable"===e?"0":"")}function Os(e){if(e.dataset.contentId){const t=e.querySelector(`[data-togglable-bottom="${e.dataset.contentId}"]`);if(t){const n=Object(Qi.h)(e,{ignoreTransform:!0}),a=Object(Qi.h)(t,{ignoreTransform:!0});return{...n,height:a.bottom-n.top,bottom:a.bottom}}}return Object(Qi.h)(e,{ignoreTransform:!0})}const As=(e={highlight:!0})=>{const t=Object(a.useRef)(null),n=Object(qt.h)(vn),i=Kr();function r(){t.current&&(clearTimeout(t.current.timeoutId),n(void 0),t.current=null)}return{cancelOpenTogglableTimer:r,startOpenTogglableTimer(a){var s;(null==a?void 0:a.id)&&a.id!==(null===(s=null==t?void 0:t.current)||void 0===s?void 0:s.togglableId)&&(r(),e.highlight&&n(a.id),t.current={togglableId:a.id,timeoutId:setTimeout((()=>{i(a.id,!0),r()}),750)})}}};function Ps(e){var t;if(!m.j.isFolderContentItem(e))return 0;let n=0;for(const a of null!==(t=e.children)&&void 0!==t?t:[]){if(!m.j.isFolderContentItem(a))continue;const e=1+Ps(a);e>n&&(n=e)}return n}function xs(e,t){if(void 0===e)return!0;let n=0;return e&&m.j.isFolderContentItem(e)?(n=Ps(e),n+t<2):t<=2}const $s=()=>{const e=Object(d.a)(),t=Object(p.h)("course.outline.courseLinkMoveError.course","course.outline.courseLinkMoveError.organization"),{enqueueSnackbar:n,dequeueSnackbar:a}=Object(j.mb)(j.S.CourseContentOutlineDragAndDrop,!0),r=Object(u.f)();return async(s,o)=>{var l,c;if(!Object(tn.b)(s))return!0;const d=s.data.current.item;if(!d)return!0;if(!xs(d,null!==(c=null===(l=s.data.current)||void 0===l?void 0:l.nestingLevel)&&void 0!==c?c:0)){const t={snackbarMessage:e("course.outline.folderMaxDepthError.text"),isErrorOrWarning:!0,icon:i.a.createElement(f.AlertError,null)};return a(),n(t),!0}if(null==o?void 0:o.folderId){if(((e,t)=>!!t&&(m.j.isFolderContentItem(e)||m.i.CourseLink.isEqualTo(e.contentHandler))&&(m.B.isForcedSequenceModule(t)||m.B.isInForcedSequenceLearningModule(t)))(d,m.Yb.content.getContentById(r.getState(),o.folderId))){const r={snackbarMessage:e(t("course.outline.courseLinkMoveError.course.text")),isErrorOrWarning:!0,icon:i.a.createElement(f.AlertError,null)};if(m.i.CourseLink.isEqualTo(d.contentHandler)&&!(e=>{const t=e.getLinkContentSource();return!!t&&m.i.Discussion.isEqualTo(t.contentHandler)})(d)&&d.id)return a(),n(r),!0;if(m.j.isFolderContentItem(d)){if(!await Object(oe.e)(oe.d.CanEnableForcedSequenceService).canForcedSequenceBeEnabled(d))return a(),n(r),!0}}}return!1}},Ns=Object(G.throttle)(((e,t,n)=>{us(e,t,n)}),100),Ds=e=>{const{children:t,moveContent:n}=e,[r,s]=Object(a.useState)(),[o,l]=Object(a.useState)(0),c=Object(qt.e)((({set:e})=>t=>{Wr(t)&&e(Cn(t.id),!1)}),[]),{startOpenTogglableTimer:u,cancelOpenTogglableTimer:m}=As(),p=function(){const e=Yr();return(t,n,a)=>{var i,r;const s=null===(i=n.data.current)||void 0===i?void 0:i.item,o=null===(r=null==a?void 0:a.data.current)||void 0===r?void 0:r.item;if(t instanceof KeyboardEvent||!Object(tn.b)(n)||!Object(tn.b)(a)||!s||!(null==o?void 0:o.id))return!1;const l=n.data.current.sortable.index<a.data.current.sortable.index,c=Zr({active:n.rect.current.translated,over:a.rect}),d=l&&"top"===c||!l&&"bottom"===c;return Wr(o)&&o.id!==(null==s?void 0:s.id)&&d&&e(o.id)}}(),h=function(e){const t=Es(e);return Object(Qi.p)(Object(Qi.o)(Qi.e,{activationConstraint:{distance:15}}),Object(Qi.o)(Qi.f,{activationConstraint:{delay:400,tolerance:5}}),Object(Qi.o)(Qi.d,{coordinateGetter:t,keyboardCodes:Is}))}(s),g=Object(d.a)(),b=Jr(),f=$s();function v(){m(),Ts("disable"),Object(ls.unstable_batchedUpdates)((()=>{s(void 0)}))}return i.a.createElement(Fi.Provider,{value:r},i.a.createElement(Qi.a,{accessibility:{announcements:ks,screenReaderInstructions:{draggable:g("courseCore.course.dragAndDrop.announcements.draggableScreenReaderInstructions")}},measuring:{droppable:{measure:Os}},collisionDetection:ps,sensors:h,onDragStart:e=>{var t,n;const a=null===(t=e.active.data.current)||void 0===t?void 0:t.item,i=null===(n=e.active.data.current)||void 0===n?void 0:n.nestingLevel;Object(oe.e)(oe.d.AngularMenuCloserService).closeAnyOpenAngularMenus(),Ts("enable"),a&&Object(tn.b)(e.active)&&(c(a),s({item:a,folderId:null==a?void 0:a.parentId,targetId:null==a?void 0:a.id,insertPosition:e.active.data.current.sortable.index})),"number"==typeof i&&l(i)},onDragMove:({activatorEvent:e,active:t,over:n})=>{var a;p(e,t,n)?u(null===(a=null==n?void 0:n.data.current)||void 0===a?void 0:a.item):m()},onDragOver:({active:e,over:t,activatorEvent:n})=>{var a;const i=null===(a=null==t?void 0:t.data.current)||void 0===a?void 0:a.nestingLevel;"number"==typeof i&&l(i),n instanceof KeyboardEvent||Ns(e,t,s)},onDragEnd:({active:e,over:t})=>{!function(e,t,n,a,i){var r,s,o,l,c,d;const u=null===(r=null==e?void 0:e.data.current)||void 0===r?void 0:r.item,m=null===(s=null==t?void 0:t.data.current)||void 0===s?void 0:s.item;if(!Object(tn.b)(e)||!(null==u?void 0:u.id))return;if((null===(o=null==t?void 0:t.data.current)||void 0===o?void 0:o.type)===Zi.Container&&(null==n?void 0:n.folderId)&&a({dragContentId:u.id,parentFolderId:n.folderId,positionBeforeId:n.targetId}),!Object(tn.b)(t)||!(null==m?void 0:m.parentId))return;if((null==n?void 0:n.folderId)&&t.id===e.id&&n.insertPosition===(null===(l=e.data.current)||void 0===l?void 0:l.sortable.items.length)-1)return void a({dragContentId:u.id,parentFolderId:n.folderId,positionAfterId:n.targetId});(null==n?void 0:n.folderId)&&m.id===n.item.id&&a({dragContentId:u.id,parentFolderId:n.folderId,positionBeforeId:n.targetId});const p=null===(c=e.data)||void 0===c?void 0:c.current.sortable.index,h=null===(d=t.data)||void 0===d?void 0:d.current.sortable.index;let g=p>h;if(p!==h){if(Wr(m)){const n="top"===Zr({active:null==e?void 0:e.rect.current.translated,over:null==t?void 0:t.rect}),a=p<h&&n,r=p>h&&n;g=i(m.id)||a||r}a(g?{dragContentId:u.id,parentFolderId:m.parentId,positionBeforeId:m.id}:{dragContentId:u.id,parentFolderId:m.parentId,positionAfterId:m.id})}}(e,t,r,n,b),v()},onDragCancel:v,cancelDrop:({active:e})=>f(e,r)},i.a.createElement(ws,null),i.a.createElement(Cs,null),t,i.a.createElement(ds,{item:null==r?void 0:r.item,nestingLevel:o})))},Ls="course.file.content.upload",js="course.cloud.file.content.upload";async function Ms(e,t,n){const a=Object(Ht.v4)(),i=await e(void 0,n,a,!1,t);if(i)return{content:i,correlationId:a,file:n}}async function Gs(e,t,n,a,i){const r=Object(Ht.v4)(),s=await async function(e,t,n){const a=[];for(const i of e)a.push(Ms(t,n,i));return(await Promise.all(a)).filter((e=>void 0!==e))}(e,a,i);if(s.length>0){n(r,s.map((({correlationId:e})=>e))),t(function(e,t){return{type:Ls,payload:t,meta:{groupUploadId:e}}}(r,s))}}function Rs(e,t){const n=t.top+t.height/2;return e.y<=n?"top":"bottom"}const Bs="native-drag-top",Fs="native-drag-bottom";function Us(e,t,n){e.classList.remove(t),e.classList.add(n)}function _s(e){e.classList.remove(Bs,Fs)}function zs(e,t,n){var a;const i=null===(a=e.data)||void 0===a?void 0:a.item;let r;if(Wr(i)&&!n(null==i?void 0:i.id)){const n=Os(e.element);r=t.y>n.top&&t.y<n.bottom?"top":"bottom"}else r=Rs(t,e.rect);!function(e,t){"bottom"===t?Us(e,Bs,Fs):Us(e,Fs,Bs)}(e.element,r)}const qs=e=>{const t=Object(d.a)(),{children:n}=e,{enqueueSnackbar:r,dequeueSnackbar:s}=Object(j.mb)(j.S.CourseContentOutlineDragAndDrop,!0),o=(()=>{const e=Object(u.d)(),{onStartUpload:t,createFileContent:n}=Ut();return Object(a.useCallback)((async(a,i)=>Gs(a,e,t,n,i)),[e,t,n])})(),{cancelOpenTogglableTimer:l,startOpenTogglableTimer:c}=As({highlight:!1}),m=Yr(),p={snackbarMessage:t("components.directives.fileUpload.disallowFolderUploadFullNotChromeNoMoreFiles")};return i.a.createElement(zr,{onDragOver:(e,t,n)=>{var a;const i=null===(a=t.data)||void 0===a?void 0:a.item;zs(t,n,m),!function(e,t,n){var a;const i=null===(a=e.data)||void 0===a?void 0:a.item;if(Wr(i)&&n(null==i?void 0:i.id)){const n=function(e,t){const n=t.height/3,a=t.top+n,i=t.top+2*n;return e.y<=a?"top":e.y<=i?"center":"bottom"}(t,e.rect);return"center"===n}return!1}(t,n,m)?l():c(i)},onDragEnter:(e,t,n)=>{zs(t,n,m)},onDragLeave:(e,t)=>{_s(t.element),l()},onDrop:(e,t,n)=>{_s(t.element),l(),s();const{droppedFiles:a,droppedFolders:i}=function(e){var t;const n=e.dataTransfer.items,a=[],i=[];for(let e=0;e<n.length;e++)if(null===(t=(r=n[e]).getAsEntry?r.getAsEntry():r.webkitGetAsEntry())||void 0===t?void 0:t.isDirectory)i.push(n[e]);else if(n[e]){const t=n[e].getAsFile();t&&a.push(t)}var r;return{droppedFiles:a,droppedFolders:i}}(e);i.length>0&&r(p);const c=((e,t)=>{var n,a,i;let r={positionBefore:"start"};if(null===(n=e.data)||void 0===n?void 0:n.item){const n=e.data.item,a=Rs(t,e.rect);r=function(e,t,n){var a;const i={parentId:e};return"bottom"===n?(i.positionAfter=null!==(a=t.id)&&void 0!==a?a:t.positionAfter,i.positionBefore=i.positionAfter?void 0:t.positionBefore,t&&void 0!==t.position&&(i.position=t.position+1)):(i.positionAfter=t.positionAfter,i.positionBefore=t.id,t&&void 0!==t.position&&(i.position=t.position-1)),i}(null==n?void 0:n.parentId,n,a)}else(null===(a=e.data)||void 0===a?void 0:a.parentId)&&(r={parentId:null===(i=e.data)||void 0===i?void 0:i.parentId,positionBefore:"start"});return r})(t,n);o(a,c)}},n)},Hs=Object(h.makeStyles)((e=>({root:{position:"relative","& > .native-drag-top::after, & > .native-drag-bottom::after":{...Q(e),top:"-5px",bottom:"-5px",left:"-5px",right:"-5px",height:void 0}}}))),Vs=e=>{var t;const{contents:n,parentFolder:r,loadMoreContent:o,moveContent:l}=e,c=Hs(),{fileUploads:d}=Object(a.useContext)(Ft);Object(p.v)(null==r?void 0:r.courseId);let u=i.a.createElement(os,{contents:n,loadMoreContent:o,parentFolder:r,root:!0});return d&&(u=i.a.createElement(qs,null,u)),i.a.createElement(qt.b,null,i.a.createElement(W,{value:0},i.a.createElement(s.e,null,i.a.createElement("div",{className:(null!==(t=null==n?void 0:n.length)&&void 0!==t?t:0)>0?void 0:c.root},i.a.createElement(Ds,{moveContent:l},u)))))};var Ws=n("5vtU"),Ks=n("dCsl");const Ys=Object(h.makeStyles)((e=>{const t=`1px solid ${e.palette.secondary.main}`,n=`2px solid ${e.palette.brandAlt.main}`;return{divider:{position:"relative",zIndex:1,"&::before":{content:'""',position:"absolute",top:"45%",left:0,right:0,borderTop:t}},addButton:{width:"100%",margin:"-10px 0",padding:"2px 0",display:"flex",justifyContent:"center",alignContent:"center",lineHeight:0,transition:"opacity .25s linear","&:hover":{"& $addButtonIcon":{color:e.palette.brand.main},"&::after":{borderTop:n}},"&::after":{content:'""',position:"absolute",top:"45%",left:0,right:0,borderTop:t,transition:"all .25s linear",transitionProperty:"border-top-color, border-top-width, left, right"}},activeAddButton:{"& $addButtonIcon":{color:e.palette.brand.main},"&$addButton::after":{borderTop:n,left:0,right:0}},addButtonIcon:{background:e.palette.background.default,borderRadius:"50%",transition:"all .25s linear",transitionProperty:"color, transform",color:e.palette.text.secondary,zIndex:1},rotatedIcon:{transform:"rotate(-45deg)",color:e.palette.brand.main}}})),Js=i.a.forwardRef(((e,t)=>{const{className:n,active:a,...s}=e,o=Ys(e);return i.a.createElement("div",{className:o.divider},i.a.createElement(Ws.a,{...s,ref:t,classes:{focusVisible:o.activeAddButton},className:Object(r.a)(n,o.addButton,a&&o.activeAddButton)},i.a.createElement(Ks.a,{className:Object(r.a)(o.addButtonIcon,a&&o.rotatedIcon)})))})),Zs=e=>{const{id:t,buttonAriaLabel:n,buttonAnalyticsId:r,menuAnalyticsId:s,items:o,classes:l}=e,[c,d]=Object(a.useState)(void 0),[u,m]=Object(a.useState)(!1),p=!!c,h=`add-content-menu-${t}`,g=`add-content-menu-button-${t}`,b=Object(a.useCallback)((()=>{d(void 0),m(!0)}),[]),f=Object(a.useCallback)((e=>{d(e.currentTarget)}),[]),v=Object(a.useMemo)((()=>o.map((e=>({...e,onClick:t=>{var n;try{null===(n=e.onClick)||void 0===n||n.call(e,t)}finally{b()}}})))),[o,b]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(Js,{analyticsId:r,id:g,"aria-controls":c?h:void 0,"aria-haspopup":"menu","aria-label":n,"aria-expanded":p,active:p||u,onClick:f,classes:l}),i.a.createElement(j.j,{id:h,anchorEl:c,open:p,onClose:b,MenuListProps:{"aria-labelledby":g},TransitionProps:{onExited:()=>m(!1)},items:v,analyticsId:s}))};async function Qs(e,t,n){const a=Object(Ht.v4)(),i=await e(void 0,null,a,!1,t);if(i)return{content:i,correlationId:a,file:n}}async function Xs(e,t,n,a,i){const r=Object(oe.e)(oe.d.CloudDriveService),s=await r.cloudDriveStorage.openFilePicker(a,!0);if(!(null==s?void 0:s.length))return;const o=Object(Ht.v4)(),l=await async function(e,t,n){const a=[];for(const i of e)a.push(Qs(t,n,i));return(await Promise.all(a)).filter((e=>void 0!==e))}(s,n,i);if(l.length>0){t(o,l.map((({correlationId:e})=>e))),e(function(e,t){return{type:js,payload:t,meta:{groupUploadId:e}}}(o,l))}}function eo(e){const{createFileContent:t,onStartUpload:n}=Ut(),{locale:r}=Object(_.a)(),s=Object(u.d)(),o=Object(d.a)();return{hidden:!function(){const[e,t]=Object(a.useState)(!1);return Object(a.useEffect)((()=>{Object(oe.e)(oe.d.CloudDriveService).isCloudServiceAvailable().then((e=>t(!!e)))}),[]),e}(),key:"cloud-storage",analyticsId:"components.directives.add-content-button.course-outline.importContentFromCloudStorage.button",click:()=>{Xs(s,n,t,r,e)},text:o("components.directives.add-content-button.importContentFromCloudStorage.title"),icon:i.a.createElement(f.UploadCloud,null)}}function to(e){const t=Object(d.a)(),{onStartUpload:n,createFileContent:a}=Ut(),r=eo(e),o=Object(u.d)();return[{key:"create",analyticsId:"components.directives.add-content-button.contextualMenu.menuItem",text:t("components.directives.add-content-button.create"),icon:i.a.createElement(f.Add,null),route:s.j.CreateContent(e)},{key:"copy",analyticsId:"components.directives.add-content-button.course-outline.import.link",text:t("components.directives.add-content-button.copy"),icon:i.a.createElement(f.Duplicate,null),route:s.j.CopyContent(e)},{key:"upload",analyticsId:"components.directives.add-content-button.course-outline.upload.button",text:t("components.directives.add-content-button.upload"),icon:i.a.createElement(f.UploadFile,null),click:()=>{!async function(e,t,n,a){try{Gs(await Object(Ve.x)({multiple:!0}),e,t,n,a)}catch(e){}}(o,n,a,e)}},r,{key:"content-market",analyticsId:"components.directives.add-content-button.course-outline.openContentMarket.link",text:t("components.directives.add-content-button.contentMarket"),icon:i.a.createElement(f.ContentMarket,null),route:s.j.ContentMarket(e)},{key:"content-collection",analyticsId:"components.directives.add-content-button.course-outline.contentCollection.link",text:t("components.directives.add-content-button.contentCollection"),icon:i.a.createElement(f.ContentCollection,null),route:s.g.ContentCollection(e)}]}const no=e=>{const{id:t,buttonAriaLabel:n,locationData:a,classes:r}=e,o=Object(d.a)(),l=to(a).map((({route:e,click:t,...n})=>{const a=n;return e?a.onClick=()=>{s.Z.goPeekState(e)}:t&&(a.onClick=()=>t()),a}));return i.a.createElement(Zs,{id:t,buttonAriaLabel:null!=n?n:o("components.directives.add-content-button.aria-label.content.add-button-label"),buttonAnalyticsId:"components.directives.add-content-button.course-outline.addContentMenu.button",menuAnalyticsId:"components.directives.add-content-button.contextualMenu",classes:r,items:l})},ao=Object(h.makeStyles)((e=>({divider:{"&::before":{left:"var(--divider-inline-start)",right:"var(--divider-inline-end)"}},addButton:{opacity:1,"&:hover, &:active":{opacity:1},"&::after":{left:"var(--divider-inline-start)",right:"var(--divider-inline-end)"},[e.breakpoints.up("sm")]:{opacity:"var(--add-button-opacity, 0)"}},activeAddButton:{"&&":{opacity:1}}})));function io(e,t,n,a,i){const r=function(e,t){var n;const a={parentId:e};return a.positionAfter=null!==(n=null==t?void 0:t.id)&&void 0!==n?n:null==t?void 0:t.positionAfter,a.positionBefore=a.positionAfter||null==t?void 0:t.positionBefore,t&&void 0!==t.position&&(a.position=t.position+1),a}(e,t);return r.depth=i,function(e,t,n){const a={...e};return t?(a.positionAfter=t,delete a.positionBefore):n&&(delete a.positionAfter,a.positionBefore=n,n===ss&&(a.position=0)),a}(r,n,a)}const ro=e=>{const{classes:t,parentId:n,item:a,id:s}=e;let o,l;"positionBefore"in e?o=e.positionBefore:"positionAfter"in e&&(l=e.positionAfter);const c=K(),u=ao(),m=io(n,a,l,o,c+1),p=function(e,t){const n=Object(d.a)();if(!t)return;return n("components.directives.add-content-button.aria-label.content.add-button-label-item-name-"+(e.positionAfter?"after":"before"),{itemName:t.title})}(m,a);return i.a.createElement(no,{id:s,locationData:m,classes:{divider:Object(r.a)(null==t?void 0:t.divider,u.divider),addButton:Object(r.a)(null==t?void 0:t.addButton,u.addButton),activeAddButton:u.activeAddButton},buttonAriaLabel:p})};function*so(e){if(yield e,e.children)for(let t=0;t<e.children.length;t++)yield*so(e.children[t])}const oo=(e,t,n)=>{if(t)for(const a of so(t)){const{uploadCorrelationId:t}=a.ui;t&&(e.includes(t)&&n(a))}};function lo(e){let t=[];return e.forEach((({oversizedFiles:e})=>{t=t.concat(e)})),t}const co=(e,t,n)=>{const{oversizedUploadIds:i,untrackUploadIds:r}=(e=>{const t=Object(q.r)(e),[n,i]=Object(a.useState)((()=>lo(t)));return Object(a.useEffect)((()=>{const e=lo(t);i((t=>{const n=e.filter((e=>!t.includes(e)));return 0===n.length?t:[...t,...n]}))}),[t]),{oversizedUploadIds:n,untrackUploadIds:Object(a.useCallback)((e=>{i((t=>t.filter((t=>!e.includes(t)))))}),[])}})(e.current),{displayModal:s,modal:o}=Object(j.lb)(q.f,{uploadIds:i});return Object(a.useEffect)((()=>{0!==i.length&&async function(e){try{await s()}finally{r(e),oo(e,t,n)}}(i)}),[i,s,r,t,n]),o},uo=e=>{const{exitCallback:t}=e,[n,r]=Object(a.useState)(!1),[s,o]=Object(a.useState)(!1),c=Object(d.a)(),u=(e=!1)=>{o(e),r(!0)};return i.a.createElement($.a,{analyticsId:"components.directives.fileUpload.confirmLeave.dialog","aria-labelledby":"confirm-leave-page-dialog-heading-id",open:!n,TransitionProps:{onExited:()=>{t(s),r(!1)}}},i.a.createElement(h.DialogTitle,{onClose:()=>u(),id:"confirm-leave-page-dialog-heading-id","aria-describedby":"confirm-leave-page-dialog-message-id"},c("components.directives.fileUpload.closeDuringUploadTitle")),i.a.createElement(h.DialogContent,null,i.a.createElement(h.DialogContentText,{id:"confirm-leave-page-dialog-message-id"},c("components.directives.fileUpload.closeDuringUploadInstructions"))),i.a.createElement(h.DialogActions,null,i.a.createElement(l.AnalyticsDefaultButton,{analyticsId:"components.directives.fileUpload.closeDuringUploadGoBack",onClick:()=>u()},c("components.directives.fileUpload.closeDuringUploadGoBack")),i.a.createElement(l.AnalyticsPrimaryButton,{analyticsId:"components.directives.fileUpload.closeDuringUploadClose",onClick:()=>u(!0)},c("components.directives.fileUpload.closeDuringUploadClose"))))};function mo(e){const t=Object(u.d)(),{displayModal:n,modal:a}=Object(j.lb)(uo,{});return Object(oe.i)(oe.b.RouterStateChangeStart,(async(a,i,r,o)=>{o.name!==i.name&&await async function(a,i,r){if(e.current.size<=0)return;a.preventDefault(),(await n()).confirmed&&(e.current.forEach((e=>{t(m.V.fileUpload.abortGroupUploads(e))})),e.current.clear(),s.Z.goRoute(i.name,r))}(a,i,r)})),a}const po=e=>{const{showContentImportProgress:t,createFileContent:n,deleteContentItem:r,...s}=e,{modals:o,startUpload:l}=function(e,t){const n=Object(a.useRef)(new Set),r=Object(q.q)(n),s=mo(n),o=co(n,e,t),l=Object(a.useCallback)(((e,t)=>{n.current.add(e),r(e,t)}),[r]);return{modals:i.a.createElement(i.a.Fragment,null,s,o),startUpload:l}}(s.parentFolder,r),c=Object(a.useMemo)((()=>({AddContentButton:ro,fileUploads:{createFileContent:n,deleteContent:r,onStartUpload:l},textOnPage:{axLoadMoreButtonLabelKey:"components.directives.content.content-outline.infiniteScroll.content.loadMoreButton.label.plural"}})),[n,r,l]);return i.a.createElement(i.a.Fragment,null,o,t&&i.a.createElement(zt,null),i.a.createElement(Ft.Provider,{value:c},i.a.createElement(Vs,{...s})))},ho=Object(h.makeStyles)((e=>({divider:{position:"relative",zIndex:1,"&::before":{content:'""',position:"absolute",top:"45%",left:"var(--divider-inline-start, 0px)",right:"var(--divider-inline-end, 0px)",borderTop:`1px solid ${e.palette.secondary.main}`}}}))),go=()=>{const e=ho();return i.a.createElement("div",{className:e.divider})},bo={AddContentButton:go,fileUploads:!1,textOnPage:{axLoadMoreButtonLabelKey:"components.directives.content.content-outline.infiniteScroll.discussions.loadMoreButton.label.plural"}},fo=e=>i.a.createElement(Ft.Provider,{value:bo},i.a.createElement(go,null),i.a.createElement(Vs,{...e}));var vo=n("OrNH");function yo(e){return function(){Object(oe.e)(oe.d.CreateContentCourseModelOperations).createContent(e)}}function So(e,t){var n;e.title=decodeURIComponent(null!==(n=t.fileName)&&void 0!==n?n:""),e.contentDetail={"resource/x-bb-file":{file:{fileName:t.fileName,fileLocation:t.fileLocation,mimeType:t.mimeType},fileAssociationMode:I.G.Embed}},t.webLocation&&(e.ui.webLocation=t.webLocation)}function Co(e){return function*(t){var n,a;const{file:i}=t.payload,r=t.meta.uploadId.correlationId,s=e(t);So(s,i);const o=yield Object(vo.e)(m.Yb.fileUpload.getFileUploadById,r),l=yield Object(vo.e)(null===(n=m.Yb.fileUpload)||void 0===n?void 0:n.getGroupStatusById,null!==(a=o.groupId)&&void 0!==a?a:""),c=(null==l?void 0:l.uploads.length)>1,d=yo(s);c?d():(yield function*(e){e.ui.uploadCorrelationId&&(yield Object(vo.c)(m.V.fileUpload.canUpdateFileDetails({correlationId:e.ui.uploadCorrelationId})))}(s),yield Object(vo.h)((e=>e.type===m.tb.UPDATED_FILE_DETAILS&&e.meta.uploadId.correlationId===r),(e=>{e.payload.cancelled||d()})))}}function*Eo(e){const t=e.payload,n=t.reduce(((e,{correlationId:t,content:n})=>(e[t]=n,e)),{}),a=Object.keys(n),{groupUploadId:i}=e.meta;yield Object(vo.c)(m.V.fileUpload.filesUploadRequest(t,i)),yield Object(vo.h)((e=>e.type===`${m.tb.FILE_UPLOAD}.ok`&&a.includes(e.meta.uploadId.correlationId)),Co((({meta:e})=>n[e.uploadId.correlationId])))}function Io(e){return`${e.account}|${e.id}`}function*ko(e){const t=e.payload,{groupUploadId:n}=e.meta,a=t.reduce(((e,{correlationId:t,content:n})=>(e[t]=n,e)),{}),i=Object.keys(a),r=[];for(const{correlationId:e,file:a}of t){const t=a.bearer_token.key,i=Io(a);let s;try{s=yield Object(vo.b)(m.xb,"CloudStorageIntegration",i,t)}catch(t){yield Object(vo.c)(m.V.fileUpload.invalidFileUpload(a,{correlationId:e,groupId:n},!0));continue}r.push({correlationId:e,accessToken:t,file:s})}var s;yield Object(vo.c)(m.V.fileUpload.cloudFilesUploadRequest(r,n)),yield Object(vo.h)((e=>e.type===`${m.tb.FILE_UPLOAD}.ok`&&i.includes(e.meta.uploadId.correlationId)),(s=({meta:e})=>a[e.uploadId.correlationId],function(e){const{file:t}=e.payload,n=s(e);So(n,t),yo(n)()}))}var wo=n("0uRC");async function To(e){return new Promise((t=>{setTimeout(t,e)}))}function Oo(e,t){return Object(m.wb)(t,e)}function Ao(e,t,n){return n.status===I.s.Complete?(e(m.V.fileUpload.fileUploadSuccess(t,function(e){const t={fileName:void 0,fileLocation:void 0};return e&&(t.fileName=e.fileName,t.fileLocation=e.fileLocation,t.webLocation=e.webLocation,t.mimeType=e.mimeType,t.isMedia=e.isMedia),t}(n))),e(wo.a),!0):(n.status===I.s.Incomplete||n.status===I.s.CompleteErrors)&&(e(m.V.fileUpload.fileUploadFailure(t,m.T.Api)),e(wo.a),!0)}function Po(e,t,n){const a={lengthComputable:!1,loaded:n.completePercentage,total:100};e(m.V.fileUpload.updateFileUploadProgress(t,a))}function xo(e,t){e(m.V.fileUpload.fileUploadAborted(t)),e(wo.a)}async function $o(e,t,n,a,i){const r=t=>{let n;t instanceof I.a&&(n=t.body.status),e(m.V.fileUpload.fileUploadFailure(a,m.T.Api,n))};let s;try{s=await function(e,t){return Object(m.ac)("CloudStorageIntegration",e.id,t)}(t,n)}catch(e){return void r(e)}Po(e,a,s);let o=Ao(e,a,s);for(;!o;){if(await To(2e3),i.signal)return o=!0,void xo(e,a);let t;try{t=await Oo(n,s.taskId)}catch(e){return void r(e)}Po(e,a,t),o=Ao(e,a,t)}}class No{constructor(){this._signal=!1}abort(){this._signal=!0}get signal(){return this._signal}}function*Do(e,t,n){const a=new No;yield Object(vo.c)(m.V.fileUpload.startFileUpload(n,a));const i=function(e,t,n,a){return Object(wo.c)((i=>($o(i,e,t,n,a),()=>{})))}(e,t,n,a);for(;;){const e=yield Object(vo.g)(i);yield Object(vo.c)(e)}}var Lo={uploadFileContentItemSaga:function*(){yield Object(vo.h)(Ls,Eo)},cloudUploadFileContentItemSaga:function*(){yield Object(vo.h)(js,ko)},cloudUploadRequestWatcherSaga:function*(){yield Object(vo.h)(m.tb.CLOUD_FILE_UPLOAD_REQUEST,(function*(e){const{file:t,accessToken:n}=e.payload,{uploadId:a}=e.meta;yield Object(vo.b)(Do,t,n,a)}))}};const jo=Object(h.makeStyles)((e=>Object(h.createStyles)({mainContainer:{display:"flex",height:"36px",alignItems:"center"},headerWrapper:{flex:"1",maxWidth:"none",display:"flex",alignItems:"center"}}))),Mo="course.outline.details.and.action.expanded",Go=e=>{const{isStudentPreview:t,courseId:n,isExpanded:a,setIsExpanded:s}=e,o=rt(t?Mo+".student.preview":Mo,n),c=Object(d.a)(),u=jo();return i.a.createElement("div",{className:Object(r.a)("js-course-skip-link-target","js-details-header",u.mainContainer)},i.a.createElement("div",{className:u.headerWrapper},i.a.createElement(l.AnalyticsTypography,{component:"h2",variant:"h2"},c("course.outline.detailsActionsLabel"))),i.a.createElement(nt,null,i.a.createElement(it,{id:"details-actions-expansion-button",analyticsId:'"courseOverview.detailsAndActions.expandOrCollapse"',isExpanded:a,preferenceKey:o,setIsExpanded:s,title:c("course.outline.detailsActionsLabel"),panelControlId:"details-and-actions-panel"})))},Ro=Object(h.makeStyles)((e=>({container:{padding:e.spacing(0),display:"flex",height:"100%",[e.breakpoints.up("sm")]:{height:"calc(100vh - 232px)"},[e.breakpoints.up("md")]:{height:"calc(100vh - 226px)"}}}))),Bo="keyword",Fo="category",Uo=[{id:"DOCUMENT",name:"document-text",contentHandler:[I.t.Document,I.t.Folder]},{id:"ASSESSMENTS",name:"assessments",contentHandler:[I.t.TestLink]},{id:"SCORM",name:"scormengine",contentHandler:[I.t.RusticiScorm]},{id:"FILE",name:"file",contentHandler:[I.t.File]},{id:"LTI",name:"lti",contentHandler:[I.t.LtiLink,I.t.LtiPlacement]},{id:"JOURNAL",name:"journal",contentHandler:[I.t.Journal]}],_o=()=>({filters:Uo.map((({id:e,name:t,contentHandler:n})=>({id:e,name:t,selected:!1,length:0,contentHandler:n}))),[Bo]:""});var zo=n("N79G");const qo=Object(h.makeStyles)((e=>({container:{width:"100%",minWidth:"170px",display:"flex",flexDirection:"column",[e.breakpoints.up("sm")]:{width:"360px",minWidth:"225px",boxShadow:`5px 0 0 0 ${Object(zo.d)(e.palette.border.main,.1)}`}},clearAll:{color:e.palette.link.disabled,"&:enabled":{color:e.palette.link.active,textDecoration:"underline"}},searchItemsContainer:{overflow:"auto",display:"flex",flexDirection:"column",flexGrow:1,[e.breakpoints.up("sm")]:{padding:e.spacing(0,3,0,0)}},header:{display:"flex",alignItems:"center",justifyContent:"space-between",borderBottom:`1px solid ${e.palette.border.main}`,whiteSpace:"nowrap",minHeight:"76px",[e.breakpoints.up("sm")]:{marginRight:e.spacing(3)}},headerText:{"&&":{marginBottom:"0px"}},icon:{transition:"transform 200ms"},iconClose:{transform:"rotate(-180deg)"},blocksContainer:{overflow:"auto"},keywordSearch:{paddingTop:e.spacing(1.25)},keywordInputField:{marginBottom:e.spacing(2),"& fieldset":{border:0},"& input":{margin:0},"& label":{color:e.palette.text.hint}},blockHeader:{display:"flex",justifyContent:"space-between",alignItems:"center"},blockHeaderTitle:{fontWeight:e.typography.fontWeightBold},block:{borderBottom:`1px solid ${e.palette.border.main}`,padding:e.spacing(1,0,1,0),display:"inline-block",width:"100%","&:last-child":{borderBottom:"none"}},itemContainer:{paddingLeft:e.spacing(1.5),paddingTop:e.spacing(.625),whiteSpace:"nowrap",overflowX:"hidden"},footer:{borderTop:`1px solid ${e.palette.border.main}`,padding:e.spacing(1,1.5),display:"flex",justifyContent:"end",[e.breakpoints.up("sm")]:{marginRight:e.spacing(3)},[e.breakpoints.down("xs")]:{position:"sticky",bottom:0,backgroundColor:e.palette.background.default}}}))),Ho=_o(),Vo=({criteriaConfig:e,onPanelClose:t,isOpen:n,setFocusOnCloseButton:s})=>{const{onSearchClick:o,currentFilterState:l}=e,[c,u]=Object(a.useState)({[Bo]:{expanded:!0},[Fo]:{expanded:!0}}),m=Object(d.a)(),p=qo(),g=Object(h.useMediaQuery)((e=>e.breakpoints.down("xs"))),[b,v]=Object(a.useState)(l),y=Object(a.useRef)(null);Object(a.useEffect)((()=>{var e;n&&s&&(null===(e=y.current)||void 0===e||e.focus())}),[n,s]),Object(a.useEffect)((()=>{v(l)}),[l]);const S=e=>{u({...c,[e]:{expanded:!c[e].expanded}})};if(!n)return null;const C=m("courseLink.searchPanel.keywordSearch.header"),E=m("courseLink.searchPanel.linkableItems.label"),I=c.keyword.expanded,k=c.category.expanded,w=(e=>{const{keyword:t,filters:n}=e;return!n.some((e=>e.selected))&&!t.trim()})(b);return i.a.createElement("div",{role:"search",className:p.container},i.a.createElement("div",{className:p.header},i.a.createElement("div",null,i.a.createElement(h.Typography,{variant:"h2",className:p.headerText},m("courseLink.searchPanel.header")),i.a.createElement(Ws.a,{analyticsId:m("courseLink.searchPanel.clearAll"),className:p.clearAll,onClick:()=>{v(Ho)},disabled:w,"aria-label":m("courseLink.searchPanel.clearAll")},m("courseLink.searchPanel.clearAll"))),i.a.createElement(h.IconButton,{onClick:t,"aria-label":m("courseLink.searchPanel.closeLabel"),"aria-expanded":"true",ref:y},i.a.createElement(f.Close,null))),i.a.createElement("div",{className:p.searchItemsContainer},i.a.createElement("div",{className:p.block},i.a.createElement("div",{className:p.blockHeader},i.a.createElement(h.Typography,{variant:"h4",component:"h3",className:p.blockHeaderTitle},C),i.a.createElement(h.IconButton,{id:"button-keyword-search-input-field",className:Object(r.a)(p.icon,{[p.iconClose]:!I}),onClick:()=>S(Bo),"aria-label":m("courseLink.searchPanel.keywordSearch.ariaLabel"),"aria-expanded":c.keyword.expanded,"aria-controls":"keyword-region"},i.a.createElement(f.ChevronUp,null))),I&&i.a.createElement(h.FormControl,{fullWidth:!0,className:p.keywordSearch,id:"keyword-region",role:"region","aria-labelledby":"button-keyword-search-input-field"},i.a.createElement(h.TextField,{id:"keyword-input-field",type:"text",className:p.keywordInputField,label:m("courseLink.searchPanel.keywordSearch.placeholder"),floatingLabel:!0,value:b.keyword,onChange:e=>{return t=e.target.value,void v((e=>({...e,[Bo]:t})));var t},inputProps:{"aria-label":m("courseLink.searchPanel.keywordSearch.placeholder")}}))),i.a.createElement("div",{className:p.block},i.a.createElement("div",{className:p.blockHeader},i.a.createElement(h.Typography,{variant:"h4",component:"h3",className:p.blockHeaderTitle},E),i.a.createElement(h.IconButton,{id:"button-category-search-checkboxes",className:Object(r.a)(p.icon,{[p.iconClose]:!k}),onClick:()=>S(Fo),"aria-expanded":k,"aria-label":m("courseLink.searchPanel.linkableItems.ariaLabel"),"aria-controls":"categories-region"},i.a.createElement(f.ChevronUp,null))),i.a.createElement("div",{id:"categories-region",role:"region","aria-labelledby":"button-category-search-checkboxes"},k&&b.filters.map((e=>i.a.createElement("div",{key:e.id,className:p.itemContainer},i.a.createElement(h.FormControlLabel,{label:m(`courseLink.searchPanel.linkableItems.types.${e.name}`,{totalResults:e.length}),htmlFor:e.id,control:i.a.createElement(h.Checkbox,{id:e.id,checked:e.selected,onChange:t=>((e,t)=>{const n=b.filters.map((n=>n.id===e?{...n,selected:t}:n));v((e=>({...e,filters:n})))})(e.id,t.target.checked)})}))))))),i.a.createElement("div",{className:p.footer},i.a.createElement(h.PrimaryButton,{onClick:()=>{const{filters:e,keyword:n}=b;o({filters:e.map((e=>({...e,length:0}))),keyword:n}),g&&t()},disabled:w},m("courseLink.searchPanel.buttonText"))))},Wo=({criteriaConfig:e,children:t})=>{const[n,r]=(()=>{const e=Object(h.useTheme)(),t=Object(h.useMediaQuery)(e.breakpoints.down("sm")),[n,i]=Object(a.useState)(!t);return[n,i]})(),[s,o]=Object(a.useState)(!1),l=Ro(),c=()=>{r((e=>!e)),s||o(!0)};return i.a.createElement("div",{className:l.container},i.a.createElement(Vo,{criteriaConfig:e,isOpen:n,onPanelClose:c,setFocusOnCloseButton:s}),t(c,n))},Ko=Object(h.makeStyles)((e=>({header:{display:"flex",justifyContent:"space-between",alignItems:"center",minHeight:"min-content",padding:e.spacing(1.25,0),[e.breakpoints.up("sm")]:{minHeight:"76px",padding:e.spacing(.5,0)}},headerButton:{marginRight:e.spacing(1.875),[e.breakpoints.up("sm")]:{marginRight:e.spacing(1)}},results:{"&&":{marginBottom:"0px"},[e.breakpoints.up("sm")]:{whiteSpace:"nowrap"}},emptyDiv:{display:"none",[e.breakpoints.up("sm")]:{display:"flex",width:"50px"}}}))),Yo=({isSearchPanelOpen:e,openSearchPanel:t,totalResults:n,loadedResults:a,initialState:r})=>{const s=Object(d.a)(),o=Object(p.h)("courseLink.contentPanel.header.helper.course","courseLink.contentPanel.header.helper.organization"),c=Ko();return i.a.createElement(h.Box,{className:c.header},!e&&i.a.createElement(h.Box,{className:c.headerButton,role:"search"},i.a.createElement(l.AnalyticsPrimaryButton,{onClick:t,analyticsId:"courseLink.containerPanel.openSearchPanelButton","aria-expanded":"false"},s("courseLink.contentPanel.header.searchButton"))),!!n&&!r&&i.a.createElement(h.Box,null,i.a.createElement(l.AnalyticsTypography,{variant:"h2",className:c.results},s("courseLink.contentPanel.header.searchResults",{loadedResults:a,totalResults:n})),i.a.createElement(l.AnalyticsTypography,{variant:"body1"},s(o("courseLink.contentPanel.header.helper.course")))),!e&&i.a.createElement(h.Box,{className:c.emptyDiv}))};var Jo=n("p2I/"),Zo=n.n(Jo);const Qo=Object(h.makeStyles)((()=>({container:{display:"flex",flexDirection:"column",alignItems:"center",margin:"30px auto 0 auto"},image:{display:"inline-block",lineHeight:1,strokeWidth:1.1,stroke:"transparent",fill:"none",verticalAlign:"inherit",width:"200px",height:"200px",marginBottom:"10px"},title:{fontSize:"20px !important",marginBottom:"10px !important",marginTop:0,textAlign:"center"},message:{textAlign:"center",marginBottom:"28px",whiteSpace:"pre-wrap"}}))),Xo=e=>{const{headerKey:t,messageKey:n}=e,a=Object(d.a)(),r=Object(p.h)("courseLink.emptyState.initialHeader.course","courseLink.emptyState.initialHeader.organization"),s=Object(p.h)("courseLink.emptyState.initialMessage.course","courseLink.emptyState.initialMessage.organization"),o=Qo();return i.a.createElement("div",{className:o.container},i.a.createElement("div",{className:o.image,dangerouslySetInnerHTML:{__html:Zo.a}}),i.a.createElement(l.AnalyticsTypography,{variant:"h2",className:o.title},a(r(t))),i.a.createElement("div",{className:o.message},a(s(n),{keyword:i.a.createElement("strong",null,a("courseLink.searchPanel.keywordSearch.header")),linkableItems:i.a.createElement("strong",null,a("courseLink.searchPanel.linkableItems.label"))})))},el=Object(h.makeStyles)((e=>({container:{display:"flex",flexDirection:"column",flexGrow:1,width:"100%"},loadingContainer:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center",[e.breakpoints.down("xs")]:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}},containerOff:{paddingLeft:e.spacing(4),width:"67vw",[e.breakpoints.down("xs")]:{display:"none"}}}))),tl=({isSearchPanelOpen:e,openSearchPanel:t,totalResults:n,children:a,initialState:s,isLoading:o,loadedResults:l})=>{const c=el(),u=Object(d.a)();return i.a.createElement("div",{className:Object(r.a)(c.container,{[c.containerOff]:e})},!o&&i.a.createElement(Yo,{isSearchPanelOpen:e,openSearchPanel:t,totalResults:n,loadedResults:l,initialState:s}),o?i.a.createElement("div",{className:c.loadingContainer},i.a.createElement(h.CircularProgress,{id:"courseLink.contentPanel.loader",ariaLabel:u("courseLink.contentPanel.loader")})):s||!n?i.a.createElement(Xo,{headerKey:s?"courseLink.emptyState.initialHeader.course":"courseLink.emptyState.zeroResultsHeader",messageKey:s?"courseLink.emptyState.initialMessage.course":"courseLink.emptyState.zeroResultsMessage"}):a)},nl=Object(h.makeStyles)((e=>({content:{overflow:"hidden",display:"flex",flexDirection:"column"},subHeader:{height:"40px",display:"grid",gridTemplateColumns:"1fr",[e.breakpoints.up("sm")]:{gridTemplateColumns:"2fr 1fr"},alignItems:"center",borderBottom:`1px solid ${e.palette.border.main}`,borderTop:`1px solid ${e.palette.border.main}`},itemsContent:{display:"flex",flexDirection:"column",overflowY:"auto",overflowX:"clip"},category:{display:"flex",flexDirection:"row",gap:"34px",alignItems:"center",[e.breakpoints.down("xs")]:{display:"none"}},divider:{height:"25px"},title:{paddingRight:e.spacing(1)},headerName:{padding:e.spacing(.125,5),display:"flex",height:"40px",alignItems:"center"}})));var al=n("9wcI");const il=Object(h.makeStyles)((e=>({iconDisabled:{marginRight:"-40px"},visibilityText:{paddingLeft:e.spacing(.75)}}))),rl=({type:e,visible:t})=>{const n=il(),a=Object(q.m)(e);return a?t?i.a.createElement(a,{"data-testid":e}):i.a.createElement(i.a.Fragment,null,i.a.createElement(al.a,{"data-testid":"disabled",className:n.iconDisabled}),i.a.createElement(a,{"data-testid":e})):null},sl=Object(h.makeStyles)((e=>({content:{padding:e.spacing(2.5,0),display:"flex"},checkbox:{paddingLeft:e.spacing(1.5)},icon:{paddingRight:e.spacing(1.5),alignSelf:"center"},item:{display:"grid",flexGrow:1,gridTemplateColumns:"1fr",[e.breakpoints.up("sm")]:{gridTemplateColumns:"2fr 1fr"}},itemHideCategoryColumn:{gridTemplateColumns:"1fr"},itemName:{display:"flex"},itemTitle:{display:"grid",gap:"4px"},itemCategoryVisible:{display:"none",[e.breakpoints.up("sm")]:{paddingLeft:e.spacing(4.5),paddingRight:e.spacing(2),display:"grid"}},itemCategoryHidden:{display:"none"},visibilityContentPanelOff:{"&& div":{lineHeight:"unset"},display:"flex",flexDirection:"column",gap:"4px",[e.breakpoints.up("sm")]:{flexDirection:"row",gap:"12px",alignItems:"center"}},visibilityContentPanelOn:{"&& div":{lineHeight:"unset"},display:"flex",flexDirection:"column",gap:"4px",[e.breakpoints.up("md")]:{flexDirection:"row",gap:"12px",alignItems:"center"}},contentFooter:{borderBottom:`1px solid ${e.palette.border.main}`,marginLeft:e.spacing(12.25),"&:last-child":{marginLeft:e.spacing(0),marginBottom:e.spacing(2),paddingLeft:e.spacing(12.25)}},checkedContent:{display:"flex",flexDirection:"column",paddingBottom:e.spacing(2.5)},displayName:{marginBottom:e.spacing(2),width:"260px","& div":{border:0},"& input":{margin:0},[e.breakpoints.down("xs")]:{width:"100%"}},description:{"& div, div:hover":{border:`1px solid ${e.palette.background.b5}`}},itemText:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}}))),ol=({record:e,selectedItem:t,setSelectedItem:n,isSearchPanelOpen:a,hideCategoryColumn:s})=>{const o=sl(),l=Object(d.a)(),{type:c,categoryType:u,name:m,isAvailable:p,id:g}=e,b=g===(null==t?void 0:t.id);return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:o.content},i.a.createElement("div",{className:Object(r.a)(o.item,s&&o.itemHideCategoryColumn)},i.a.createElement("div",{className:o.itemName},i.a.createElement(h.FormControlLabel,{label:"",htmlFor:g,className:o.checkbox,control:i.a.createElement(h.Radio,{id:g,"aria-label":m,checked:b,value:g,onClick:()=>(()=>{const t={...e,displayName:e.name};n(t)})()})}),i.a.createElement("div",{className:o.icon},i.a.createElement(rl,{visible:p,type:c})),i.a.createElement("div",{className:o.itemTitle},i.a.createElement(h.Typography,{variant:"h4",component:"h3",className:o.itemText},m),i.a.createElement("div",{className:a?o.visibilityContentPanelOn:o.visibilityContentPanelOff},i.a.createElement(_n,{item:e}),Un(e)&&i.a.createElement("div",null,i.a.createElement(yi,{item:e}))))),i.a.createElement("div",{className:Object(r.a)(s?o.itemCategoryHidden:o.itemCategoryVisible)},i.a.createElement(h.Typography,{className:o.itemText,variant:"body1"},u)))),i.a.createElement("div",{className:o.contentFooter},b&&i.a.createElement("div",{className:o.checkedContent},i.a.createElement(h.TextField,{id:"item-display-name",type:"text",className:o.displayName,label:l("courseLink.contentPanel.item.displayName"),placeholder:l("courseLink.contentPanel.item.displayNamePlaceholder"),onChange:e=>{return a=e.target.value,void(t&&n({...t,displayName:a}));var a},value:t.displayName,required:!0,error:!t.displayName,helperText:t.displayName?"":l("courseLink.contentPanel.item.displayNameHelperText"),inputProps:{"aria-label":l("courseLink.contentPanel.item.displayName"),maxLength:333}}),i.a.createElement(h.TextField,{id:"item-description",type:"text",className:o.description,label:l("courseLink.contentPanel.item.description"),placeholder:l("courseLink.contentPanel.item.descriptionPlaceholder"),onChange:e=>{return a=e.target.value,void(t&&n({...t,description:a}));var a},value:t.description,inputProps:{"aria-label":l("courseLink.contentPanel.item.description"),maxLength:750},fullWidth:!0,multiline:!0,rows:5,helperText:l("course.content.descriptionMaxCharactersLabel")}))))};var ll;!function(e){e.Name="name",e.Category="categoryType"}(ll||(ll={}));var cl=n("jrAY");const dl=({records:e,setSelectedCourseItem:t,loadData:n,hasMore:r,isSearchPanelOpen:s})=>{const o=Object(d.a)(),{sortBySubHeader:l,sortOrder:c,sortedRecords:u}=(e=>{const[t,n]=Object(a.useState)({}),i=Object(a.useMemo)((()=>{const{type:n,isAsc:a}=t;if(!n)return e;const i=[...e].sort(((e,t)=>n===ll.Category?e[n].localeCompare(t[n])||e[ll.Name].localeCompare(t[ll.Name]):e[n].localeCompare(t[n])));return a?i:i.reverse()}),[e,t]);return{sortOrder:t,sortBySubHeader:e=>{t.type===e?n((t=>({type:e,isAsc:!t.isAsc}))):n({type:e,isAsc:!0})},sortedRecords:i}})(e),{isAsc:m,type:p}=c,g=nl(),b=Object(j.kb)(n,r),v=Object(h.useMediaQuery)((e=>e.breakpoints.down("xs"))),y=Object(h.useMediaQuery)((e=>e.breakpoints.down("sm")))&&s||v,[S,C]=Object(a.useState)(),E=e=>p===e?m?i.a.createElement(f.SortArrowAscending,null):i.a.createElement(f.SortArrowDescending,null):i.a.createElement(f.SortArrows,null),I=e=>{C(e),t(e)},k=Object(a.useMemo)((()=>[{id:"courseLink.contentPanel.subHeader.name",title:o("courseLink.contentPanel.subHeader.name"),onClick:()=>l(ll.Name),ariaLabel:o("courseLink.contentPanel.subHeader.name."+(m?"ascending":"descending")),icon:E(ll.Name),className:g.headerName,hasDivider:!1},{id:"courseLink.content.panel.subHeader.category",title:o("courseLink.contentPanel.subHeader.category"),onClick:()=>l(ll.Category),ariaLabel:o("courseLink.contentPanel.subHeader.category."+(m?"ascending":"descending")),icon:E(ll.Category),className:g.category,hasDivider:!0}]),[c]),w=Object(a.useCallback)((()=>(y?[k[0]]:k).map((({id:e,title:t,onClick:n,ariaLabel:a,icon:s,className:o,hasDivider:l})=>r?i.a.createElement("div",{className:o,key:e},l&&i.a.createElement(h.Divider,{orientation:"vertical",className:g.divider}),i.a.createElement(h.Typography,{variant:"h4"},t)):i.a.createElement("div",{className:o,key:e},l&&i.a.createElement(h.Divider,{orientation:"vertical",className:g.divider}),i.a.createElement(h.IconButton,{onClick:()=>n(),"aria-label":a},i.a.createElement(h.Typography,{variant:"h4",className:g.title},t),s))))),[r,c,y]);return i.a.createElement("div",{className:g.content},i.a.createElement("div",{className:g.subHeader},w()),i.a.createElement("div",{className:g.itemsContent},i.a.createElement(cl.a,{hasCustomLegend:!0},u.map((e=>i.a.createElement(ol,{record:e,selectedItem:S,key:e.id,setSelectedItem:I,isSearchPanelOpen:s,hideCategoryColumn:y}))),b)))},ul={offset:0,limit:10},ml="courseLink.searchPanel.linkableItems.types",pl=(e,t,n,a)=>m.i.TestLink.isEqualTo(a)?(null==n?void 0:n.isUserDefined)?`${t(`${ml}.assessment`)} (${null==n?void 0:n.title})`:`${t(`${ml}.assessment`)} (${t(`course.content.assessment.test.settings.grading.category.${null==n?void 0:n.title}`)})`:(null==a?void 0:a.toString())===m.i.File.handle?`${t(`${ml}.file`)}`:(null==a?void 0:a.toString())===m.i.LtiLink.handle||(null==a?void 0:a.toString())===m.i.LtiPlacement.handle||"document-blank"===e?`${t(`${ml}.singlelti`)}`:t(`${ml}.${e}`),hl=({getCourseContentChildren:e,setSelectedCourseItem:t})=>{const[n,r]=Object(a.useState)({records:[]}),[s,o]=Object(a.useState)(!1),[l,c]=Object(a.useState)(!0),u=Object(d.a)(),m=_o(),[p,h]=Object(a.useState)(m),g=t=>{const{pagingParams:a}=n,{filters:i,keyword:s}=t||p,o=i.filter((e=>e.selected)).map((e=>e.id)).join(", "),l=(e=>{if(e){const{offset:t,limit:n}=e;return{offset:t+n,limit:n}}return ul})(t?void 0:a),c=s.trim();return c!==s&&h((e=>({...e,[Bo]:c}))),e(c,o,l,!t).then((({paging:e,items:t})=>{const n=t.map((e=>({...e,categoryType:pl(e.type,u,e.gradebookType,e.contentHandler)})));r((({records:t})=>({records:t.concat(n),pagingParams:e}))),(e=>{const t=p.filters.some((e=>e.selected));h((n=>({...n,filters:n.filters.map((n=>(e.forEach((e=>{t&&!n.selected||n.contentHandler.find((t=>{var n;return null===(n=e.contentHandler)||void 0===n?void 0:n.startsWith(t)}))&&(n.length+=1)})),n)))})))})(n)}))},b={currentFilterState:p,onSearchClick:async e=>{if(!s){r({records:[]}),h(e),o(!0);try{await g(e),l&&c(!1)}finally{o(!1)}}}},{records:f,pagingParams:v}=n,y=Object(a.useMemo)((()=>((e,t)=>{var n;if(!t)return!1;const a=(null!==(n=null==t?void 0:t.count)&&void 0!==n?n:0)-e;return Math.min(a,t.limit)>0})(f.length,v)),[v,f.length]);return i.a.createElement(Wo,{criteriaConfig:b},((e,n)=>{var a;return i.a.createElement(tl,{isSearchPanelOpen:n,openSearchPanel:e,totalResults:null!==(a=null==v?void 0:v.count)&&void 0!==a?a:0,loadedResults:f.length,initialState:l,isLoading:s},i.a.createElement(dl,{records:f,setSelectedCourseItem:t,loadData:()=>g(),hasMore:y,isSearchPanelOpen:n}))}))},gl=Object(h.makeStyles)((e=>({contentLinkTabs:{borderBottomWidth:"1px",borderBottomStyle:"solid",borderBottomColor:e.palette.border.main}})));var bl;!function(e){e.WebLink="webLink",e.CourseLink="courseLink"}(bl||(bl={}));const fl=[{id:bl.WebLink,displayKey:"courseCore.course.courseLinks.webLinkTabLabel"},{id:bl.CourseLink,displayKey:"courseCore.course.courseLinks.courseLinkTabLabel"}],vl=e=>{const{onChange:t,value:n}=e,a=gl(),r=Object(d.a)(),s=Object(p.h)("courseCore.course","courseCore.organization");return i.a.createElement("div",{className:a.contentLinkTabs},i.a.createElement(l.AnalyticsTabs,{onChange:(e,n)=>t(n),value:n,analyticsId:"contentlink.tabs"},fl.map((e=>i.a.createElement(l.AnalyticsTab,{analyticsId:`contentlink.tab.${e.id}`,key:e.id,value:e.id,label:r(s(e.displayKey)),id:`tab-${e.id}`,"aria-controls":`tabpanel-${e.id}`})))))};n.d(t,"j",(function(){return b})),n.d(t,"r",(function(){return E})),n.d(t,"s",(function(){return T})),n.d(t,"k",(function(){return x})),n.d(t,"l",(function(){return L})),n.d(t,"o",(function(){return We})),n.d(t,"m",(function(){return Ke})),n.d(t,"u",(function(){return Je})),n.d(t,"d",(function(){return Xe})),n.d(t,"g",(function(){return St})),n.d(t,"n",(function(){return Bt})),n.d(t,"e",(function(){return po})),n.d(t,"q",(function(){return fo})),n.d(t,"a",(function(){return Ja})),n.d(t,"p",(function(){return ce})),n.d(t,"t",(function(){return Lo})),n.d(t,"f",(function(){return Go})),n.d(t,"h",(function(){return hl})),n.d(t,"c",(function(){return vl})),n.d(t,"b",(function(){return bl})),n.d(t,"i",(function(){return ia}))},"/J7e":function(e,t,n){"use strict";function a(e){if(null==e)return!1;if("boolean"==typeof e)return e;if("string"==typeof e){const t=e.trim();return"true"===t.toLowerCase()||"1"===t}if("number"==typeof e)return 0!==e;throw new Error('Cannot convert "'+e+'" to boolean')}n.d(t,"a",(function(){return a}))},"/KQw":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n("Llzl");const i="ultra.components.directives.cacheCompilation";class r{constructor(e){this.$compile=e,this.compiled=Object.create(null),this.priority=2e3}compile(e,t){const n=t.bbCacheCompilation;if(!n)throw new Error("Cache compilation key is required");const a=e.contents();return e.empty(),null==this.compiled[n]&&(this.compiled[n]=this.$compile(a)),(e,t)=>{this.compiled[n](e,(function(e,n){t.append(e)}))}}}r.$inject=["$compile"],a.module(i,[]).directive("bbCacheCompilation",["$injector",e=>e.instantiate(r)])},"/jNt":function(e,t,n){"use strict";n("t04/"),n("kH1j");var a=n("Llzl"),i=n("UP3t"),r=n("pjml"),s=n("z6Q5"),o=n("TnpK"),l=n("gkef"),c=n("ZzYr"),d=n("0JpG");n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return p}));const u="ultra.directives.courseCatalogLink",m="course",p="org",h="ultraui.coursecatalog.link",g="ultraui.organizationcatalog.link",b="classic_course_catalog_link_ind",f="classic_course_catalog_link",v={[h]:"Disabled",[g]:"Disabled",[b]:"N",[f]:""};class y{constructor(e,t,n,a,r,s,o,l){this.scope=e,this.attrs=t,this.$q=n,this.SystemPreferenceModel=a,this.batchService=r,this.ultraState=s,this.windowSizeService=o,this.bbLocalize=l,this.template=i,r.performBatch((()=>{n.all([a.$find(this.getCatalogLinkKey()).$allow([404]).$asPromise(),a.$find(b).$allow([404]).$asPromise(),a.$find(f).$allow([404]).$asPromise()]).then((e=>{this.handleSystemPreferencesResponse(e)}))}));const c=t.catalogType===p?"base.organization-catalog":"base.course-catalog";e.handleCatalogLink=()=>{s.goToRoute(c)},e.windowSizeService=o,o.isLargeBreakpoint()||this.bbLocalize.loadBundle("base/baseCourses").then((()=>{e.ariaLabel=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"base.baseCourses.link"})}))}handleSystemPreferencesResponse(e){const t=this.getPreferenceValueByKey(e,this.getCatalogLinkKey())||v[this.getCatalogLinkKey()];this.scope.shouldDisplayCatalogLink="Enabled"===t;const n=this.getPreferenceValueByKey(e,b)||v[b];this.scope.isExternalCatalog="Y"===n,this.scope.externalCatalogUrl=this.getPreferenceValueByKey(e,f)||v[f]}getPreferenceValueByKey(e,t){const n=e.find((e=>e.key===t));return n?n.value:null}getCatalogLinkKey(){return this.attrs.catalogType===m?h:g}}y.$inject=["scope","attrs","$q",r.qb.serviceName,s.b,o.d,l.b,d.serviceName];class S{constructor(e){this.$injector=e,this.template=i,this.link=(e,t,n)=>{e.courseCatalogLink=this.$injector.instantiate(y,{scope:e,element:t,attrs:n})}}}S.$inject=["$injector"],a.module(u,[r.N,s.a,o.b,l.a,c.a]).directive("bbCourseCatalogLink",["$injector",e=>e.instantiate(S)])},"/qpZ":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n("Llzl"),i=n("+4Px");const r="ultra.directives.accessibility.keyboardEnter";class s{constructor(){this.restrict="A",this.link=(e,t,n)=>{t.on("keydown keypress",(a=>{a.keyCode===i.f&&(n.bbBlurBeforeEnter&&t.blur(),e.$apply((function(){e.$eval(n.bbKeyboardEnter,{$event:a})})),a.preventDefault())}))}}}a.module(r,[]).directive("bbKeyboardEnter",["$injector",e=>e.instantiate(s)])},0:function(e,t){},"0+Qs":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return s}));var a=n("Llzl"),i=n("5MwF");const r="ultra.services.interval",s="interval";a.module(r,[]).factory(s,["$interval",e=>{const t=(t,n,a,r,s)=>{if(!i.a.production&&a<5e3&&!r&&(null==s||s)){if(a<1e3)throw new Error("Short duration interval, repeating indefinitely, which invokes apply was registered!");console.warn("Short duration interval, repeating indefinitely, which invokes apply was registered!\n"+(new Error).stack)}const o=e(t,a,r,s);return o.__bb_unregister_scope_destroy__=n.$on("$destroy",(()=>{e.cancel(o)})),o};return t.cancel=t=>{t&&t.__bb_unregister_scope_destroy__&&(t.__bb_unregister_scope_destroy__(),t.__bb_unregister_scope_destroy__=null),e.cancel(t)},t}])},"07uq":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n("Llzl");const i="ultra.directives.bbMouseLeaveEnter";class r{constructor(e){this.$rootScope=e,this.restrict="A",this.link=(e,t,n)=>{const a=()=>{e.$apply((()=>{this.$rootScope.$broadcast(n.bbMouseLeaveEnter+"-mouse-enter")}))},i=()=>{e.$apply((()=>{this.$rootScope.$broadcast(n.bbMouseLeaveEnter+"-mouse-leave")}))};e.$on("$destroy",(()=>{t.off("mouseenter",a),t.off("mouseleave",i)})),t.on("mouseenter",a),t.on("mouseleave",i)}}}r.$inject=["$rootScope"],a.module(i,[]).directive("bbMouseLeaveEnter",["$injector",e=>e.instantiate(r)])},"0AOT":function(e,t,n){e.exports=n.p+"29560560fa9ff2c494c76c86210daa15.png"},"0B2D":function(e,t){e.exports='<bb-modal class="notification" modal-title-key="course.content.assessment.alreadySubmitted.title"\n  analytics-id-tag-prefix="course.content.assessment.alreadySubmitted">\n  <div name="modal-contents">\n    <p bb-translate>course.content.assessment.alreadySubmitted.backend</p>\n  </div>\n  <button name="modal-footer-button-primary" ng-click="$parent.$close(); customClose();"\n    class="button confirm-ok js-primary-button ng-scope" bb-translate\n    analytics-id="course.content.groupAttempt.edit.alreadySubmitted.dismiss">\n    course.content.groupAttempt.edit.alreadySubmitted.dismiss\n  </button>\n</bb-modal>\n'},"0JpG":function(e,t,n){"use strict";n.d(t,"moduleName",(function(){return m})),n.d(t,"serviceName",(function(){return p})),n.d(t,"providerName",(function(){return h})),n.d(t,"localeQuerystringRegex",(function(){return g})),n.d(t,"Service",(function(){return v}));var a=n("D57K"),i=n("nsO7"),r=n("Llzl"),s=n("5MwF"),o=n("lAEu"),l=n("n7/H"),c=n("m2oH"),d=n("C3Ga"),u=n("tfZW");n.o(l,"ILocaleComposedDurationFormat")&&n.d(t,"ILocaleComposedDurationFormat",(function(){return l.ILocaleComposedDurationFormat})),n.o(l,"ILocaleDateFormat")&&n.d(t,"ILocaleDateFormat",(function(){return l.ILocaleDateFormat})),n.o(l,"ILocaleDatetimeFormat")&&n.d(t,"ILocaleDatetimeFormat",(function(){return l.ILocaleDatetimeFormat})),n.o(l,"ILocaleTimeFormat")&&n.d(t,"ILocaleTimeFormat",(function(){return l.ILocaleTimeFormat})),n.o(l,"ILocaleTimezoneFormat")&&n.d(t,"ILocaleTimezoneFormat",(function(){return l.ILocaleTimezoneFormat})),n.o(l,"LocaleCategory")&&n.d(t,"LocaleCategory",(function(){return l.LocaleCategory})),n.o(l,"PreferredDisplayName")&&n.d(t,"PreferredDisplayName",(function(){return l.PreferredDisplayName})),n.d(t,"ILocaleUsernameFormat",(function(){return l.ILocaleUsernameFormat}));const m="ultra.services.BbLocalize",p="bbLocalize",h=p+"Provider",g=/setLang=([^&]*)/,b=function(e,t,n){const a=n.value;n.value=function(...e){return this.$q.when(a.apply(this,e))}};class f{constructor(e,t){this.$q=e,this.$rootScope=t,this.defaultLocale="en",this.percentageFormatters={},this.currencyFormatters={},this.bundlePromises={},this.intl=d.a.getInstance(),this.frmt=new o.a(this.intl,{production:f.production,urlRoot:f.urlRoot,defaultLocale:this.defaultLocale}),this.overrideLoader=u.a.getInstance()}isRTL(e){if(!s.a.features.rightToLeftSupport)return!1;const t=this.getAppLocale();return Object(c.a)(t)}getDecimalStringForScope(e){const t=this.getLocale(e);return this.frmt.number.getDecimalStringSync(t)}getGroupingStringForScope(e){const t=this.getLocale(e);return this.frmt.number.getGroupingStringSync(t)}isValidNumber(e,t){const n=this.getLocale(t);return this.frmt.number.isValidSync(e,n)}loadBundle(e,t){null==t&&(t=this.getLocale(null));const n="locales/[locale]/"+e+".json";return this.intl.addBundles(n),this.intl.loadBundles(t)}loadAllBundles(e){return this.intl.loadBundles(e)}insertLocaleData(e,t){return this.intl.storeLocaleData(e,t)}resetLocaleData(){return this.intl.reset()}translateSync(e){let t=e?{...e.params}:{};return Object.keys(t).forEach((e=>{void 0===t[e]&&(t[e]="")})),t=this.frmt.processTranslationParams(t,{locale:e.locale,noWrap:e.noWrap,noEscape:e.noEscape}),this.intl.translateSync(e.locale||this.getLocale(null),e.key,t)}translate(e){let t=e?e.params:{};return t=this.frmt.processTranslationParams(t,{locale:e.locale,noWrap:e.noWrap,noEscape:e.noEscape}),this.intl.translate(e.locale||this.getLocale(null),e.key,t)}_getFormatter(e){return this.frmt.getFormatterSync(e)}getAppLocale(){return this.intl.normalizeLocale(this.getUserLocale()||this.defaultLocale)}getAppLocaleISO(){return this.getUserLocale()||this.defaultLocale}getLocale(e){if(!e)return this.getAppLocale();let t=e.locale;for(;!t&&e.$parent;)t=(e=e.$parent).locale;return this.intl.normalizeLocale(t)||this.getAppLocale()}getUserLocale(){return this.userLocale}preProcessFormatterLocale(e){return this.frmt.preProcessFormatterLocale(e)}getPreferredLocales(e){return this.intl.normalizeLocales(this.frmt.getPreferredLocales(e))}validateLocale(e){try{this.intl.getMf("isLocaleExists",this.intl.normalizeLocale(e))}catch(e){return!1}return!0}setLocale(e,t){return t||(t=this.getAppLocale()),e&&(e.locale=t),this.loadLocale(t).then((()=>{this.$rootScope.$broadcast("$translateChangeSuccess",{language:t})}))}setUserLocale(e){this.userLocale=e}setSystemDefaultLocale(e){this.defaultLocale=e}addOverride(e,t){this.overrideLoader.addOverrideBundle(e,t)}loadLocale(e){return this.frmt.loadLocale(e)}formatNumber(e,t,n){const a=this.getLocale(t);return this.frmt.number.format(e,a,n)}formatNumberSync(e,t,n){const a=this.getLocale(t);return this.frmt.number.formatSync(e,a,n)}regroupNumber(e,t){const n=this.getLocale(t);return this.frmt.number.regroup(e,n)}regroupNumberSync(e,t){const n=this.getLocale(t);return this.frmt.number.regroupSync(e,n)}parseNumber(e,t){const n=this.getLocale(t);return this.frmt.number.parse(e,n)}parseNumberSync(e,t){const n=this.getLocale(t);return this.frmt.number.parseSync(e,n)}formatDate(e,t,n){const a=this.getLocale(n);return this.frmt.datetime.formatDate(e,t,a)}formatDateSync(e,t,n){const a=this.getLocale(n);return this.frmt.datetime.formatDateSync(e,t,a)}parseDate(e,t,n,a){const i=this.getLocale(n);return this.frmt.datetime.parseDate(e,t,i,a)}parseDateSync(e,t,n,a){const i=this.getLocale(n);return this.frmt.datetime.parseDateSync(e,t,i,a)}formatTime(e,t,n){const a=this.getLocale(n);return this.frmt.datetime.formatTime(e,t,a)}formatTimeSync(e,t,n){const a=this.getLocale(n);return this.frmt.datetime.formatTimeSync(e,t,a)}getDayPeriodsFormatSync(e){return this.frmt.getFormatterSync(e).cldr.main("dates").calendars.gregorian.dayPeriods.format.abbreviated}getTimePattern(e,t){const n=this.getLocale(t);return this.frmt.datetime.getTimePattern(e,n)}getTimePatternSync(e,t){const n=this.getLocale(t);return this.frmt.datetime.getTimePatternSync(e,n)}parseTime(e,t,n,a){const i=this.getLocale(n);return this.frmt.datetime.parseTime(e,t,i,a)}parseTimeSync(e,t,n,a){const i=this.getLocale(n);return this.frmt.datetime.parseTimeSync(e,t,i,a)}formatDatetime(e,t,n){const a=this.getLocale(n);return this.frmt.datetime.formatDatetime(e,t,a)}formatDatetimeSync(e,t,n){const a=this.getLocale(n);return this.frmt.datetime.formatDatetimeSync(e,t,a)}formatDurationBetweenSync(e,t,n,a){const i=this.getLocale(n);return this.frmt.datetime.formatDurationBetweenSync(e,t,i,a)}formatDuration(e,t,n,a){const i=this.getLocale(t);return this.frmt.datetime.formatDuration(e,i,n,a)}formatComposedDurationSync(e,t,n){const a=this.getLocale(n);return this.frmt.datetime.formatComposedDurationSync(e,t,a)}formatTimezone(e,t,n){const a=this.getLocale(n);return this.frmt.datetime.formatTimezone(e,t,a)}formatTimezoneSync(e,t,n){const a=this.getLocale(n);return this.frmt.datetime.formatTimezoneSync(e,t,a)}formatUsername(e,t,n,a){const i=this.getLocale(n);return this.frmt.username.format(e,t,i,a)}formatUsernameSync(e,t,n,a){const i=this.getLocale(n);return this.frmt.username.formatSync(e,t,i,a)}formatUsernameList(e,t,n,a){const i=this.getLocale(n);return this.frmt.username.formatList(e,t,i,a)}formatItems(e,t,n,a,i){const r=this.getLocale(n);return this.frmt.items.format(e,e.length,t,r,a,i)}formatItemsSync(e,t,n,a,i,r){const s=this.getLocale(a);return this.frmt.items.formatSync(e,t,n,s,i,r)}getFormatEnum(e,t){if(!t)return null;const n=e[t=t.charAt(0).toUpperCase()+t.slice(1)];if(null==n)throw new Error("Invalid format `"+t+"` is used");return n}getFormatId(e,t){if(null==t)return 0;const n=e[t=t.charAt(0).toUpperCase()+t.toLowerCase().slice(1)];if(null==n)throw new Error("Invalid format `"+t+"` is used");return n}formatPercentage(e,t){const n=this.getLocale(t);return this.frmt.number.format(e,n,{style:"percent"})}formatPercentageSync(e,t,n){const a=this.getLocale(t);return this.frmt.number.formatSync(e,a,{style:"percent",maximumFractionDigits:n})}formatCurrency(e,t,n,a){const i=this.getLocale(t);return this.frmt.currency.format(e,i,n,a)}formatCurrencySync(e,t,n,a){const i=this.getLocale(t);return this.frmt.currency.formatSync(e,i,n,a)}getReactBabelfishParams(e){return{locale:this.getLocale(e),babelfishInstance:this.intl,babelfishFormatter:this.frmt,isRtl:this.isRTL()}}}f.$inject=["$q","$rootScope"],f.production=!1,f.urlRoot=".",f.defaultDecimalPrecision=l.Number.defaultDecimalPrecision,f.minDecimalPrecision=1,f.maxDecimalPrecision=4,Object(a.a)([b],f.prototype,"loadBundle",null),Object(a.a)([b],f.prototype,"translate",null),Object(a.a)([b],f.prototype,"formatNumber",null),Object(a.a)([b],f.prototype,"regroupNumber",null),Object(a.a)([b],f.prototype,"parseNumber",null),Object(a.a)([b],f.prototype,"formatUsername",null),Object(a.a)([b],f.prototype,"formatUsernameList",null),Object(a.a)([b],f.prototype,"formatPercentage",null);class v extends f{}class y{constructor(){this.$get=["$injector",e=>e.instantiate(f)]}setOptions(e={}){i.forOwn(e,((e,t)=>{f[t]=e}))}}r.module(m,[]).provider(p,y)},"0Y4C":function(e,t,n){var a=n("ziER"),i=n("5JeM"),r=new a({id:"icon-small-collab",use:"icon-small-collab-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-collab"><path fill-rule="evenodd" clip-rule="evenodd" d="M1 3h10v3l4-1.974V12l-4-2v3H1V3z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><path d="M4 6l1 2-1 2M7.5 6l1 2-1 2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(r);e.exports=r},"0fB1":function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return o}));var a=n("nsO7"),i=n("Llzl"),r=n("5MwF"),s=n("w9Zy");const o="ultra.offcanvas-scope.offcanvas-scope-pausal-scope",l="bbOffcanvasPausalScope";class c{constructor(){this.restrict="A",this.link=function(t,n,i){const o=function(e){return e.hasClass("bb-offcanvas-overlay")&&((t=e.next()).hasClass("bb-offcanvas-panel")&&(t.hasClass("full")||(n=t.css("max-width"),a.findIndex([void 0,"none"],(e=>e===n))>=0)));var t,n};t.$newOffcanvasScope=function(...e){const t=this.constructor.prototype.$new.apply(this,e);return t.$$__digestPaused=!1,t};const c=()=>{t.$$__digestPaused=function(){const t=n.is(".hide-in-background")?n:n.parents(".hide-in-background");return"true"===t.attr("aria-hidden")&&(()=>{const n=t.nextAll();for(let t=0;t<n.length;t+=2)if(o(e(n.get(t))))return!0;return!1})()}(),!1!==t.$$__digestPaused||t.$root.$$phase||t.$digest()};if(t.$on(s.c,c),t.$on(s.b,c),!r.a.production){const e=function(t){return t?e(t.$parent)+"."+t.$id+(t.$$digestPaused?"P":"A"):""},n=function(){i.$set(l,e(t))};t.$on(s.c,n),t.$on(s.b,n),n()}}}}i.module(o,[]).directive(l,["$injector",e=>e.instantiate(c)])}).call(this,n("71td"))},"0wat":function(e,t){e.exports='<div id="body-content" class="tools-frame" ng-controller="ultra.legacy.tool.controller">\n  <div id="side-panel" class="tools-overlay full bb-offcanvas-right side-panel">\n    <div class="panel-wrap">\n      <header class="panel-header">\n        <div class="columns" id="global-title">\n          <h1 class="panel-title ng-scope" bb-translate="{{tool.getToolTitleByKey(legacyTool.toolName)}}"></h1>\n          <button class="left-off-canvas-toggle menu-toggle" aria-expanded="true"\n                  analytics-id="base.tools.frame.menu.button">\n            <bb-svg-icon size="small" icon="main-menu"></bb-svg-icon>\n            <span class="sr-only" bb-translate>base.menu</span>\n          </button>\n        </div>\n      </header>\n      <div class="iframe-wrapper">\n        <iframe name="legacy-tool-iframe" bb-iframe-max-height seamless="seamless" ng-src="{{::legacyTool.getUrl()}}"\n                bb-iframe-event-repeater="keydown"\n                bb-translate-attrs="{\'title\': \'{{tool.getToolTitleByKey(legacyTool.toolName)}}\'}"></iframe>\n      </div>\n    </div>\n  </div>\n</div>\n'},1:function(e,t){},"1/43":function(e,t,n){"use strict";n.r(t),n.d(t,"EmailSettingGeneralSettingValue",(function(){return a})),n.d(t,"SmsSettingGeneralSettingValue",(function(){return i})),n.d(t,"PushNotificationGeneralSettingValue",(function(){return r})),n.d(t,"serviceName",(function(){return d}));n("QLzv");var a,i,r,s=n("5MwF"),o=n("yCC5"),l=n("Rjd/"),c=n("nkTj");!function(e){e.Digest="D",e.Immediate="I",e.None="N"}(a||(a={})),function(e){e.Enabled="A",e.Disabled="N"}(i||(i={})),function(e){e.Everyone="E",e.Instructor="I"}(r||(r={}));const d=o.sb;l.a.factory(d,["restmod",c.c,e=>e.model().mix({$url:()=>s.a.apiBasePath+"/v1/notification/settings/generalSettings/course"})])},"12mu":function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return m}));n("imME");var a=n("Llzl"),i=n("w9Zy"),r=n("9zo4"),s=n("H8CZ"),o=n("wWlP"),l=n("cQcs"),c=n("A4cK"),d=n("fmWv");const u="mm.foundation.modal",m="$modal";a.module(u,[i.d]).directive("modalBackdrop",["$modalStack","$timeout",function(e,t){return{restrict:"EA",replace:!0,template:l,link(n){n.animate=!1,t((function(){n.animate=!0})),n.close=function(t){const n=e.getTop();n&&n.value.backdrop&&"static"!==n.value.backdrop&&t.target===t.currentTarget&&(t.preventDefault(),t.stopPropagation(),e.dismiss(n.key,"backdrop click"))}}}}]).directive("modalWindow",["$modalStack","$timeout",function(e,t){return{restrict:"EA",scope:{index:"@",animate:"="},replace:!0,transclude:!0,template:c,link(e,n,a){e.windowClass=a.windowClass||"",t((function(){e.animate=!0,n[0].querySelectorAll("[autofocus]").length>0?n[0].querySelectorAll("[autofocus]")[0].focus():n[0].querySelector("div").focus()}))}}}]).factory("$modalStack",["$window","$timeout","$document","$compile","$rootScope",i.e,r.c,function(t,n,i,r,l,c,d){const u="modal-open";let m,p;const h=o.a,g={};function b(){let e=-1;const t=h.keys();for(let n=0;n<t.length;n++)h.get(t[n]).value.backdrop&&(e=n);return e}function f(e,t){const n=i.find("body").eq(0),a=h.get(e).value;h.remove(e),v(a.modalDomEl,a.modalScope,300,(function(){a.modalScope.$destroy(),n.toggleClass(u,h.length()>0),function(e){if(m&&-1===b()){let t=p;v(m,p,150,(function(){t.$destroy(),t=null,e()})),m=void 0,p=void 0}else e()}(t),d.revertAccessibilityHandling()}))}function v(e,t,a,i){const r=n(o,a);function o(){o.done||(o.done=!0,e.remove(),i&&i())}s.a(e,(function(){n.cancel(r),o(),t.$apply()})),t.animate=!1}return l.$watch(b,(function(e){p&&(p.index=e)})),g.open=function(n,s){h.add(n,{deferred:s.deferred,modalScope:s.scope,backdrop:s.backdrop,keyboard:s.keyboard});const o=i.find("body").eq(0),f=b();f>=0&&!m&&(p=l.$new(!0),p.index=f,m=r("<div modal-backdrop></div>")(p),o.append(m));const v=a.element('<div class="reveal-modal" style="z-index:-1""></div>');o.append(v[0]);const y=parseInt(getComputedStyle(v[0]).top,10)||0;v.remove();const S=(t.pageYOffset||0)+y;function C(e){let t;27===e.which&&(t=h.top(),t&&t.value.keyboard&&l.$apply((function(){g.dismiss(t.key)})))}return c.getTopElement().then((e=>{const t=a.element('<div modal-window style="visibility: visible; top:'+S+'px;"></div>');t.attr("window-class",s.windowClass),t.attr("index",h.length()-1),t.attr("animate","animate"),e&&e.name&&t.attr("data-base-state-name",e.name),t.append(s.content);const i=r(t)(s.scope);d.applyAccessibilityHandlingForPanel(i),h.top().value.modalDomEl=i,i&&!h.get(n).value.modalDomEl&&(h.get(n).value.modalDomEl=i),o.append(i),o.addClass(u)})),p&&(p.darkenBackdrop=s.darkenBackdrop),i.bind("keydown",C),s.scope.$on("$destroy",(function(){e(document).off("keydown",C)})),h},g.close=function(e,t){if(!h.get(e))return;const n=h.get(e).value;n&&f(e,(()=>{n.deferred.resolve(t)}))},g.dismiss=function(e,t){if(!h.get(e))return;const n=h.get(e).value;n&&f(e,(()=>{n.deferred.reject(t)}))},g.dismissAll=function(e){let t=this.getTop();for(;t;)this.dismiss(t.key,e),t=this.getTop()},g.getTop=function(){return h.top()},g}]).provider(m,(function(){const e={options:{backdrop:!0,keyboard:!0,darkenBackdrop:!1},$get:["$injector","$rootScope","$q","$http","$templateCache","$controller","$modalStack",function(t,n,i,r,s,l,c){new d.a(o.a).start();const u={};return u.open=function(r){const s=i.defer(),o=i.defer(),d={result:s.promise,opened:o.promise,close(e){c.close(d,e)},dismiss(e){c.dismiss(d,e)}};if((r=a.extend({},e.options,r)).resolve=r.resolve||{},!r.template)throw new Error("Template is required. Use requireJs to load template string if needed.");const u=i.all([i.when(r.template)].concat(function(e){const n=[];return a.forEach(e,(function(e,r){(a.isFunction(e)||a.isArray(e))&&n.push(i.when(t.invoke(e)))})),n}(r.resolve)));return u.then((function(e){const t=(r.scope||n).$new();t.$close=d.close,t.$dismiss=d.dismiss;const i={};let o=1;r.controller&&(i.$scope=t,i.$modalInstance=d,a.forEach(r.resolve,(function(t,n){i[n]=e[o++]})),l(r.controller,i)),c.open(d,{scope:t,deferred:s,content:e[0],backdrop:r.backdrop,keyboard:r.keyboard,windowClass:r.windowClass,darkenBackdrop:r.darkenBackdrop})}),(function(e){s.reject(e)})),u.then((function(){o.resolve(!0)}),(function(){o.reject(!1)})),d},u}]};return e}))}).call(this,n("71td"))},"1I+h":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));n("JzsJ");var a=n("Llzl"),i=n("5MwF"),r=n("0JpG"),s=n("TnpK");const o="ultra.course.collab.router";a.module(o,[r.moduleName,s.b]).config([s.c,e=>{i.a.features.collab&&e.peekState("collab",{url:"/collab/:launchType",require:()=>n.e(720).then(n.bind(null,"6DVw")),pageTitle:"course.outline.collab.ultraCollabTitle",panelClass:"full",resolve:{translations:[r.serviceName,e=>e.loadBundle("features/course/collab/course-collab")]},onExit:["$rootScope",e=>{e.$broadcast("collab-exit")}]})}])},"1ZbL":function(e,t,n){"use strict";var a=n("5MwF"),i=n("nsO7"),r=n("ERkP"),s=n("7nmT"),o=n("0JpG"),l=n("k9iv");class c extends r.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(e){console.error("ErrorBoundary caught exception",e),"undefined"!=typeof NREUM&&NREUM.noticeError(e),this.props.errorModalService.showDefaultErrorModal()}render(){return this.state.hasError?r.createElement("div"):this.props.children}}var d=n("Qbdf"),u=n("VAMW"),m=n("/5AG"),p=n("4JTD"),h=n("6PRJ"),g=n("uDfI"),b=n("A4Z1");n.d(t,"a",(function(){return T}));class f{constructor(){this.__isFirstRender=!0,this.state={},this.props={}}$onChanges(e){const t=this.props,n=Object(i.mapValues)(e,"currentValue"),a=Object(i.assign)({},this.props,n);if(this.__isFirstRender)Object(i.assign)(this,{props:a}),this.componentWillMount(),this.render(),this.__isFirstRender=!1;else{if(!this.didPropsChange(n,t))return;this.componentWillReceiveProps(a);const e=this.shouldComponentUpdate(a,this.state);if(Object(i.assign)(this,{props:a}),!e)return;this.componentWillUpdate(this.props,this.state),this.render(),this.componentDidUpdate(this.props,this.state)}}$postLink(){this.componentDidMount()}$onDestroy(){this.componentWillUnmount()}didPropsChange(e,t){return Object(i.some)(e,((e,n)=>e!==t[n]))}componentWillMount(){}componentDidMount(){}componentWillReceiveProps(e){}shouldComponentUpdate(e,t){return!0}componentWillUpdate(e,t){}componentDidUpdate(e,t){}componentWillUnmount(){}render(){}}function v(e,t){let n;return a.a.unitTesting&&(n=Object(h.a)()),r.createElement(p.a,{...t,mockLocalize:n},e)}function y(e){return e.withProvider}function S(e){return e.withThemeProvider||!!e.renderLocalized}function C(e){return S(e)||!!e.withTransitScope}function E(e){return!1!==e.withErrorModalBoundary}function I(e){return e.withCurrentCourse}function k(e,t,n){let a=e;if(t.renderLocalized){const{localize:e,$scope:i}=n;let r={locale:e.getLocale(i),babelfishInstance:e.intl,babelfishFormatInstance:e.frmt,isRtl:e.isRTL()};const s=t.renderLocalized;"object"==typeof s&&(r={...r,...s}),a=v(a,r)}if(t.withProvider){const{store:e}=n;a=function(e,t){const n={store:t};return r.createElement(g.a,n,e)}(a,e)}if(t.withThemeProvider&&(a=function(e,t){const n={theme:"light",isRtl:t.isRTL(),cssReset:"none",zIndex:{modal:1350}};return r.createElement(b.a,n,e)}(a,n.localize)),!1!==t.withErrorModalBoundary){const{errorModalService:e}=n;a=function(e,t){const n={errorModalService:t};return r.createElement(c,n,e)}(a,e)}if(t.withCurrentCourse){const{currentCourseService:e}=n;a=function(e,t){return r.createElement(m.p.Provider,{value:t.courseId},e)}(a,e)}if(t.withTransitScope){const{$scope:e}=n;a=function(e,t){return r.createElement(u.c,{value:t},e)}(a,e)}return a}function w(e,t){return class extends f{constructor(n,...a){super(),this.$element=n,this.injectedProps={},this.injectedModules={},t.forEach(((e,t)=>{this.injectedModules[e]=a[t]})),(e.injectNames||[]).forEach((e=>{this.injectedProps[e]=this.injectedModules[e]}))}render(){const t={};y(e)&&(t.store=this.injectedModules.$ngRedux),E(e)&&(t.errorModalService=this.injectedModules[l.c]),S(e)&&(t.localize=this.injectedModules[o.serviceName]),C(e)&&(t.$scope=this.injectedModules.$scope),I(e)&&(t.currentCourseService=this.injectedModules[d.e]);let n=r.createElement(e.Class,{...this.injectedProps,...this.props},null);n=k(n,e,t),Object(s.render)(n,this.$element[0])}componentWillUnmount(){Object(s.unmountComponentAtNode)(this.$element[0])}}}function T(e){var t;e.injectNames=e.injectNames||[],e.withThemeProvider=null===(t=e.withThemeProvider)||void 0===t||t;const n=e.bindingNames||e.Class.propTypes&&Object.keys(e.Class.propTypes)||[],a=e.attributes||[],r=[];E(e)&&r.push(l.c),S(e)&&r.push(o.serviceName),C(e)&&r.push("$scope"),y(e)&&r.push("$ngRedux"),I(e)&&r.push(d.e);const s=Object(i.uniq)([...r,...e.injectNames]);return{bindings:{...Object(i.fromPairs)(n.map((e=>[e,"<"]))),...Object(i.fromPairs)(a.map((e=>[e,"@"])))},controller:["$element",...s,w(e,s)]}}},"1ZiP":function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));n("JzsJ");var a=n("Llzl"),i=n("pjml"),r=n("w9Zy"),s=n("0JpG"),o=n("Is+C"),l=n("Qbdf"),c=n("TnpK"),d=n("bF8R"),u=n("Fvsw"),m=n("gkef"),p=n("36CG"),h=n("+O05"),g=n("nmzr");const b="ultra.course.content.scorm.routes",f={onEnter:["contentData","attempt",r.e,c.d,"$stateParams",m.b,(e,t,n,a,i,r)=>{if(!i.forceOpenFeedbackPanel||i.skipTransitionEvents)return;a.isPeekPanelOpen()&&n.expandTopPanel();const s=h.a.attemptHasFeedback(t),o=h.a.studentCanViewAttemptGradeAndFeedback(t,e.gradeDetail),l=a.next.name.indexOf("assessment-submission-feedback")>=0,c=!a.prev.name,d=r.isSmallBreakpoint();!s||!o||d||l||c||a.goPeekState("assessment-submission-feedback",{attemptId:t.id})}],onExit:["contentData",r.e,c.d,"$q","$stateParams",(e,t,n,a,i)=>{if(!i.skipTransitionEvents&&e.gradingColumn.isMultipleAttempts()){let i=a.when();n.isPeekPanelOpen()&&(i=t.shrinkTopPanel()),i.then((()=>{n.goPeekState("scorm-overview.student.multiple-attempt",{contentId:e.courseContent.id,columnId:e.gradingColumn.id,gradeId:e.gradeDetail.id,courseId:e.courseContent.courseId})}))}}]};a.module(b,[s.moduleName,c.b,l.b,p.a]).config([c.c,l.c,p.b,(e,t)=>{e.peekState("scorm",{abstract:!0,url:"/scorm"}).peekState("scorm.open",{url:"/open",params:{contentId:null,courseId:null},routingFunction:[c.d,o.c,(e,t)=>{t.scormLaunch({courseId:e.nextParams.courseId,contentId:e.nextParams.contentId,showPreLaunchPanel:!0})}]}).peekState("scorm-settings",{url:"/scorm/settings?parentId&positionBefore&positionAfter&contentId",pageTitle:"course.content.scorm.settings.panelTitle",require:[()=>Promise.all([n.e(0),n.e(1),n.e(2),n.e(583)]).then(n.bind(null,"7Six"))],resolve:{[l.d]:t.resolve,translations:[s.serviceName,e=>e.loadBundle("features/course/content/scorm/scorm")]},peekViewName:"scorm-goal-peek",allowChildPeekStates:!0,peekStates:["goal-picker-legacy",g.k.CONDITIONAL_RELEASE_PEEK_PANEL,"content-collection-picker"]}).peekState("scorm-launch-frame",{url:"/scorm/launchFrame?toolHref&courseId&contentId",resolve:{translations:[s.serviceName,e=>e.loadBundle("features/course/content/scorm/scorm")]},panelClass:"full",require:[()=>n.e(610).then(n.bind(null,"26hv"))],pageTitle:"course.content.scorm.launch.frameTitle"}).peekState("gradebook-item.scorm-submissions",{pageTitle:"course.content.scorm.settings.gradingTitle",url:"/scorm/:contentId/columns/:columnId/submissions?courseId&gradeitemView&gradingStatus&studentStatus",panelClass:"full",resolve:{translations:["$q",s.serviceName,(e,t)=>e.all([t.loadBundle("features/course/content/scorm/scorm"),t.loadBundle("features/course/content/course-content"),t.loadBundle("features/course/grades/gradebook-item/submissions"),t.loadBundle("features/course/content/assessment/assessment"),t.loadBundle("features/course/goal-alignment/goal")])]},views:{"gradebook-item-scorm-slider@":{require:()=>n.e(710).then(n.bind(null,"2eYu"))},"gradebook-item-students@":{require:()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(34),n.e(60),n.e(79)]).then(n.bind(null,"hmMQ"))}},onExit:["$rootScope",e=>{e.$broadcast("deadline-refresh")}],peekStates:["conversations",g.n.COURSE_MESSAGE,g.k.CONDITIONAL_RELEASE_PEEK_PANEL,"scorm-settings","scorm-launch-frame",g.w.SUBMISSION_GRADING,g.n.COURSE_GRADES_MULTIPLE_ATTEMPT,"per-gradable-item-settings"],peekViewName:"gradebook-item-panel@"}).peekState("scorm-overview",{abstract:!0,resolve:{[l.d]:t.resolve,contentData:[l.d,d.b,c.d,p.c,(e,t,n,a)=>t.loadContentAndGrades({course:e,contentId:n.nextParams.contentId}).then((e=>(a.setCurrentContent(e.courseContent),e)))],translations:["$q",s.serviceName,(e,t)=>e.all([t.loadBundle("features/course/content/scorm/scorm"),t.loadBundle("features/course/goal-alignment/goal"),t.loadBundle("features/course/content/assessment/assessment")])]},onEnter:["contentData",u.b,(e,t)=>{t.column=e.gradingColumn}],onExit:[u.b,e=>{e.column=null}],require:()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(20),n.e(32),n.e(33),n.e(39),n.e(21),n.e(54),n.e(59),n.e(74),n.e(749)]).then(n.bind(null,"HwBC"))}).peekState("scorm-overview.student",{url:"/scorm/overview/{contentId:_[0-9]+_1}?courseId",peekViewName:"assessment-overview-peek@",allowChildPeekStates:!0,peekStates:["conversations",g.n.COURSE_MESSAGE],views:{"scorm-grading-section@":{require:()=>n.e(723).then(n.bind(null,"all8"))}}}).peekState("scorm-overview.student.multiple-attempt",{url:"/scorm-attempts/:columnId/:gradeId",resolve:{scormContentData:[l.d,"contentData",o.c,d.b,c.d,(e,t,n,a,i)=>{const r=n.currentContentData||t&&t.gradingColumn.id===i.nextParams.columnId&&t;return r||a.loadContentAndGrades({course:e,contentId:i.nextParams.contentId,columnId:i.nextParams.columnId})}],translations:["$q",s.serviceName,(e,t)=>e.all([t.loadBundle("features/course/content/assessment/assessment")])]},pageTitle:"course.content.assessment.overview.multiple-attempt.pageTitle",require:()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(34),n.e(44),n.e(45),n.e(650)]).then(n.bind(null,"x3h6"))}).peekState("scorm-overview.student.attempt",{url:"/column/{columnId:_[0-9]+_1}/attempt/{attemptId:_[0-9]+_1}",panelClass:"full",resolve:{contentData:["contentData",l.d,d.b,c.d,(e,t,n,a)=>e.gradeDetail.ui.groupAttempt?e:n.loadContentAndGrades({course:t,contentId:a.nextParams.contentId,columnId:a.nextParams.columnId})],currentContent:["contentData",e=>e.courseContent],currentColumn:["contentData",e=>e.gradingColumn],attempt:["$q","contentData",i.m.serviceName,c.d,i.A.serviceName,i.E.serviceName,(e,t,n,a)=>{const i=a.nextParams.attemptId;return n.$buildRaw({id:t.courseContent.courseId}).gradebook.attempts.$find(i,{expand:["toolAttemptDetail","alignedGoals"].join(",")}).$then((e=>{t.attempt=e})).$asPromise()}]},require:()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(33),n.e(34),n.e(44),n.e(45),n.e(58),n.e(157)]).then(n.bind(null,"H0q3")),...f,params:{commentPanelInitiallyOpen:!1,forceOpenFeedbackPanel:!1,skipTransitionEvents:!1,peekStateToOpen:null},peekViewName:"assessment-attempt-review-peek",peekStates:["assessment-submission-feedback","conversations",g.n.COURSE_MESSAGE]}).peekState("scorm-analytics-report",{url:"/scorm-report/{contentId:_[0-9]+_1}?courseId",resolve:{[l.d]:t.resolve,content:[l.d,c.d,i.m.serviceName,(e,t,n)=>n.$new(e.id).contents.$find(t.nextParams.contentId).$asPromise()],translations:[s.serviceName,e=>e.loadBundle("features/course/content/scorm/scorm")]},panelClass:"full",require:()=>n.e(634).then(n.bind(null,"0rof")),pageTitle:"course.content.scorm.report.pageTitle"})}])},2:function(e,t){},"2Tae":function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return l}));var a=n("Llzl"),i=n("3bn4"),r=n("0JpG"),s=n("TnpK");const o="ultra.course.rubric.rubric-goal-alignment",l="rubric-goal-alignment",c=["course","goal-alignment","goal"];class d extends i.a{constructor(){super(...arguments),this.url="/goalAlignment/:rowId",this.panelClass="peek rubric-goal-peek"}resolveGoalAlignableContent(){return["$q","currentCourse","currentRubric",r.serviceName,s.d,(e,t,n,a,i)=>e.when(a.loadBundle(`features/${c.join("/")}`)).then((()=>t.rubrics.$find(n.id,{expand:"rows.alignedGoals,permissions"}).$asPromise().then((e=>{e.rows.forEach((e=>{e.id&&i.nextParams&&i.nextParams.rowId&&e.id===i.nextParams.rowId&&(this.rubricRow=e)}))})))).then((()=>this.rubricRow?this.setupGoalAlignableContent(this.rubricRow,a):e.when([])))]}getPeekStateName(){return l}getOverrideSubTitle(){return["currentRubric",s.d,(e,t)=>{let n="";return e.rows.forEach((e=>{e.id&&t.nextParams&&t.nextParams.rowId&&e.id===t.nextParams.rowId&&(n=e.header)})),n}]}setupGoalAlignableContent(e,t){return[{getContentTitleForGoalAlignment:()=>t.translateSync({locale:null,key:`${c.join(".")}.goalsAlignedWithRubricCriteria`}),getContentIdForGoalAlignment:()=>e.getContentIdForGoalAlignment(),isCurrentUserEligibleToAlignGoals:()=>e.isCurrentUserEligibleToAlignGoals(),alignedGoals:e.alignedGoals.map((t=>(t.content=e,t)))}]}}d.$inject=["$injector","$q"],a.module(o,[s.b,r.moduleName]).config([s.c,e=>{const t=new d;e.peekState(t.getPeekStateName(),t)}])},"2qV7":function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return le}));n("JzsJ"),n("h3Te");var a=n("nsO7"),i=n("Llzl"),r=n("TnpK"),s=n("pjml"),o=n("Fvsw"),l=n("fYJU"),c=n("0JpG"),d=n("neh4"),u=n("vWx0"),m=n("VfFK"),p=n("OMme"),h=n("jj6p"),g=n("cacA"),b=n("sb+l"),f=n("Nrpd"),v=n("rmtn"),y=n("iAaI"),S=n("qOsI"),C=n("qtHE"),E=n("Sjpn"),I=n("DDbI"),k=n("P43K"),w=n("YVo+"),T=n("iwI+"),O=n("yGso"),A=n("YfM7"),P=n("pUR+"),x=n("Hbkz"),$=n("CPqS"),N=n("GNXM"),D=n("3hz+"),L=n("FE+f"),j=n("fzj8"),M=n("yXB1"),G=n("1I+h"),R=n("JRp+"),B=n("gOJg"),F=n("y3by"),U=n("uNsL"),_=n("8HGT"),z=n("jnoB"),q=n("7oqQ"),H=n("RJ/U"),V=n("7QJo"),W=n("UiBk"),K=n("YRs5"),Y=n("U8wS"),J=n("sNuB"),Z=n("BrA8"),Q=n("IVtk"),X=n("hWgD"),ee=n("IVCC"),te=n("1ZiP"),ne=n("cwoR"),ae=n("j2IR"),ie=n("Q/M7"),re=n("tfZW"),se=n("5MwF"),oe=n("7/CN");const le="ultra.routes";function ce(e,t){return{systemInfo:[o.b,e=>e.getSystemInfo().$asPromise()],currentUser:[l.b,e=>e.userModel.$asPromise()],languages:["currentUser",s.J.serviceName,(e,n)=>{if(t&&e.locale)return n.$collection().$fetch({limit:1e4}).$asPromise()}],user:["currentUser","languages",(e,n)=>(t&&e.locale&&!a.find(n,{locale:e.locale})&&(e.locale=null),e.$patch().$asPromise())],localize:["$q","$rootScope","user","systemInfo",c.serviceName,"$cookies","$window",(t,n,a,i,r,s,o)=>{let l=a.locale||i.defaultLocaleIdentifier;const d=s.get("guest.session.locale");a.isGuest()&&d&&(l=d);const u=re.a.getInstance();if(i.siteId&&i.ultraCustomLocaleLocation&&u.setOverrideLocation(i.ultraCustomLocaleLocation,i.siteId),i.ultraLocaleData){const e=Object.keys(i.ultraLocaleData);e.forEach((e=>{const t=i.ultraLocaleData[e];t.ultraOverrideCode&&r.addOverride(e,t.ultraOverrideCode)})),e.indexOf(l)<0&&(l=i.defaultLocaleIdentifier)}const m=(e=>e.location)(o).href.match(c.localeQuerystringRegex);m&&se.a.features.devtools_enableSetLangQuery&&(l=m[1]),r.setUserLocale(l),r.setSystemDefaultLocale(i.defaultLocaleIdentifier),oe.g.initialize(r.isRTL()?oe.b.RightToLeft:oe.b.LeftToRight);const p=[r.setLocale(n,l),...e.map((e=>r.loadBundle(e))),t.when(oe.g.getCSSLoadedPromise())];return t.all(p)}]}}i.module(le,[s.N,o.a,l.a,c.moduleName,r.b,d.a,u.a,m.a,p.a,A.a,C.a,h.a,g.a,E.a,I.a,k.a,w.a,T.a,b.a,f.a,v.a,y.a,S.a,O.a,x.a,$.a,N.a,D.a,L.a,j.a,M.a,G.a,R.a,B.a,F.a,U.a,_.a,z.a,q.a,H.a,V.a,W.a,K.a,Y.a,J.a,P.a,Z.a,X.a,ee.a,te.a,ne.a,ae.a,"ngCookies"]).config([r.c,t=>{t.state("base",{abstract:!0,resolve:ce(["features/base/base","global","common/grades-common","components/services/grade"]),require:()=>Promise.all([n.e(684),n.e(43),n.e(40),n.e(46),n.e(61),n.e(93),n.e(577)]).then(n.bind(null,"03Un"))}).state("welcome",{resolve:ce(["features/welcome"],!0),require:()=>n.e(700).then(n.bind(null,"IYP1")),pageTitle:"welcome.welcome.title"}).state("register-succeeded",{url:"/startLearn?registerStatusCode?courseId?enrollStatusCode",require:()=>n.e(745).then(n.bind(null,"90MB"))}).state("base.not-found",{resolve:{translations:[c.serviceName,e=>e.loadBundle("features/base/not-found/base-not-found")]},require:()=>n.e(705).then(n.bind(null,"A15Z")),pageTitle:"base.not-found.pageNotFoundTitle"}).state("logout",{url:"^/logout",onEnter:()=>{e("body").addClass("bb-logout"),window.location.href=ie.c("/webapps/login/?action=logout")}}).state("classicRedirect",{url:"/classicRedirect?legacyUrl",onEnter:[r.d,e=>{const t=e.nextParams.legacyUrl,n=t?ie.b(t).course_id:null;n&&e.goPeekState("course.classic.outline",{courseId:n,legacyUrl:t})}]}).state("mobileApiCall",{url:"^/mobileApiCall?action&courseId&contentId&attemptId&columnId",onEnter:[r.d,e=>{Q.a(e)}]})}])}).call(this,n("71td"))},3:function(e,t){},"36CG":function(e,t,n){"use strict";n.d(t,"d",(function(){return p})),n.d(t,"g",(function(){return h})),n.d(t,"e",(function(){return g})),n.d(t,"f",(function(){return b})),n.d(t,"a",(function(){return f})),n.d(t,"c",(function(){return v})),n.d(t,"b",(function(){return y}));var a=n("D57K"),i=n("pjml"),r=n("lVRt"),s=n("TnpK"),o=n("Qbdf"),l=n("kcGO"),c=n("zGdY"),d=n("aHpC"),u=n("yC9S"),m=n("ZzR9");const p="ultra.service.course-context.content",h="currentContentModel",g=h+"Provider",b=r.b,f=p,v=h,y=g;let S=class{constructor(e,t,n){this.$q=e,this.$rootScope=t,this.$ngRedux=n,this.dispatchContentOpened=()=>{},this.dispatchContentClosed=()=>{},this.onStateHasContentInContextChanged=(e,t,n)=>{n&&!t&&this.clear()},this.connectToRedux(),u.b.OnRootScope(t,m.b.$stateHasContentInContextChanged,this.onStateHasContentInContextChanged)}get contentId(){return this._contentId}get content(){return this._content}connectToRedux(){this.$ngRedux.connect(null,(e=>({dispatchContentOpened:t=>{e(Object(l.e)(t))},dispatchContentClosed:t=>{e(Object(l.d)(t))}})))(this)}setCurrentContent(e){e!==this.content&&(e||this.content)&&(this.content&&this.dispatchContentClosed(this.content),this._contentId=e?e.id:null,this._content=e,this.content&&this.dispatchContentOpened(this.content))}clear(){this.setCurrentContent(null)}load(e,t){return e?this.contentId===t&&this.content?this.content.$asPromise():this.loadContent(e,t).then((e=>(this.setCurrentContent(e),e.$asPromise()))).catch((e=>this.$q.reject(e))):this.$q.when(null)}loadContent(e,t){return e.$find(t).$allow([404]).$asPromise().then((e=>{const n=e.$response;return n&&n.status===c.S.NotFound?this.$q.reject(new Error(`Content  ${t} not found`)):e.$asPromise()}))}};S=Object(a.a)([Object(a.c)(0,Object(d.b)("$q")),Object(a.c)(1,Object(d.b)("$rootScope")),Object(a.c)(2,Object(d.b)("$ngRedux"))],S);const C=[i.N];angular.module(p,C).provider(h,class{constructor(){this.$get=["$injector",e=>e.instantiate(S)],this.name=b,this.resolve=["$q",s.d,h,o.d,(e,t,n,a)=>{var r;const s=null!==(r=t.nextParams.contentId)&&void 0!==r?r:t.nextParams.id;return s&&s!==i.p.CREATE_CONTENT_ID?n.load(a.contents,s):e.resolve(void 0)}]}})},"3FFP":function(e,t,n){"use strict";var a=n("nsO7"),i=n("71td"),r=n("Llzl"),s=n("nbDY"),o=n.n(s),l=n("rxY8"),c=n("lEL+"),d=n("0JpG"),u=n("yC9S"),m=n("LsF/"),p=n("DyQT"),h=n("yo/t");n.d(t,"b",(function(){return g})),n.d(t,"a",(function(){return b}));const g="ultra.components.directives.saveTray";class b extends o.a{constructor(e,t,n,a){super(e),this.template=t,this.msgKeysSuffix=n,this.eventName=a}getTemplateHtml(){return this.template}static getTrayType(e){switch(e){case"LoadMoreResults":return b.LoadMoreResults;case"Toast":return b.Toast;default:return b.Default}}}b.Default=new b("Default",m,{inProgress:"saving",success:"success",error:"error"},"bb-save-tray-start"),b.LoadMoreResults=new b("LoadMoreResults",p,{inProgress:"loadingMoreItems",success:"itemsLoaded",error:"itemsFailedToLoad"},"bb-load-more-results-start"),b.Toast=new b("Toast",h);class f{constructor(e,t,n,r,s){if(this.scope=e,this.spinner=n,this.timeout=r,this.bbLocalize=s,this.inProgress=!1,this.localizationKeysPrefix=e.trayLocalizationKeysPrefix||"components.directives.save-tray",this.footer=t.closest("footer"),e.toastMessage&&e.toastMessage()){if(t.find(".notification-container span.progress-status").html(e.toastMessage()),e.toastShortMessage&&e.toastShortMessage()){let n,r=!1,s=!1,o=!0;const l=t.find(".notification-container span.progress-status"),c=()=>{const t=i(window).width();l[0].offsetWidth<l[0].scrollWidth?(r||(n=t),r=!0,o&&(s=!0),l.html(e.toastShortMessage())):t>n&&!s&&(r=!1,l.html(e.toastMessage())),o=!1};this.timeout(c,e,0);const d=a.debounce(c,100);u.b.OnWindow("resize",d,e)}}else this.spinnerArgs={canvasSize:43,scaleX:1.5,scaleY:1.5,successCallback:()=>{this.status="success",this.inProgress=!1,this.sendStatusMessage(e,this.status),this.sendMessageToScreenReader(e,e.trayType.msgKeysSuffix.success),e.$apply()},errorCallback:()=>{this.status="error",this.inProgress=!1,this.sendStatusMessage(e,this.status),this.sendMessageToScreenReader(e,e.trayType.msgKeysSuffix.error),e.$apply()}},e.$on("save-tray-spinner-status-update",((e,t)=>{if(this.spinnerObject)return t?this.spinnerObject.complete():this.spinnerObject.error()})),e.$on(e.trayType.eventName,((n,a,i,r,s,o)=>{e.trayId===a&&(this.status="",this.canvasElement||(this.canvasElement=t.find(".canvas")),r&&(this.spinnerArgs=r),this.footer.addClass("is-active"),this.spinnerObject||(this.spinnerObject=this.spinner.initInlineLoader(this.canvasElement,this.spinnerArgs)),this.inProgress||(this.spinnerObject.start(),this.inProgress=!0),this.timeoutComplete=!1,this.activeTimeout&&!this.timeoutComplete&&this.timeout.cancel(this.activeTimeout),this.sendMessageToScreenReader(e,e.trayType.msgKeysSuffix.inProgress,0),i.then((()=>{s?(this.activeTimeout=this.timeout((()=>{this.footer.removeClass("is-active"),this.timeoutComplete=!0,this.scope.$root.$broadcast("bbSaveTrayComplete")}),e,o||f.ACTIVE_TIMEOUT_LENGTH,!0),this.spinnerObject.complete()):this.spinnerObject.error()}),(e=>{e&&"canceled"===e.$status||this.spinnerObject.error()})))}))}sendMessageToScreenReader(e,t,n){t&&e.$root.$emit("read-info-directive-alert",this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:this.localizationKeysPrefix+"."+t}),n)}sendStatusMessage(e,t){"true"===e.emitStatusEvent&&e.$root.$emit("save-tray-status-event",t)}}f.$inject=["scope","element",l.b,c.b,d.serviceName],f.ACTIVE_TIMEOUT_LENGTH=6e3;class v{constructor(e,t){this.$injector=e,this.$compile=t,this.restrict="E",this.scope={trayId:"@?",trayLocalizationKeysPrefix:"@?",toastMessage:"&?",toastShortMessage:"&?",toastClass:"&?",toastIcon:"&?",toastStatus:"&?",emitStatusEvent:"@?"},this.link=(e,t,n)=>{n.trayType?e.trayType=b.getTrayType(n.trayType):e.trayType=e.toastMessage&&e.toastMessage()?b.Toast:b.Default,t.append(this.$compile(e.trayType.getTemplateHtml())(e)),e.saveTray=this.$injector.instantiate(f,{scope:e,element:t})}}}v.$inject=["$injector","$compile"],r.module(g,[l.a,c.a,d.moduleName]).directive("bbSaveTray",["$injector",e=>e.instantiate(v)])},"3PCF":function(e,t,n){"use strict";var a;n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),function(e){e.None="",e.SafeAssign="SafeAssign",e.Integration="Integration"}(a||(a={}));const i="mdb-sa"},"3bn4":function(e,t,n){"use strict";var a=n("nsO7"),i=n("0JpG");t.a=class{constructor(){this.panelClass="peek",this.url="/goalAlignment",this.require=()=>Promise.all([n.e(0),n.e(618)]).then(n.bind(null,"lQY5")),this.pageTitle="course.goal-alignment.goal.header",this.allowChildPeekStates=!0,this.peekViewName="goal-alignment-peek",this.params={noAutoGo:!1},this.peekStates=["goal-picker-legacy"],this.resolve={translations:[i.serviceName,e=>e.loadBundle("features/course/goal-alignment/goal")],goalAlignableContents:(()=>{const e=this.resolveGoalAlignableContent(),t=e[e.length-1];return e[e.length-1]=function(...e){return t.apply(null,e).then((e=>a.isArray(e)?e:[e]))},e})(),overrideSubTitle:(()=>this.getOverrideSubTitle())()}}getOverrideSubTitle(){return[()=>null]}}},"3hz+":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n("nmzr"),i=n("Llzl"),r=n("0JpG"),s=n("TnpK");const o="ultra.course.books-and-tools.router";i.module(o,[r.moduleName,s.b]).config([s.c,e=>{e.peekState("books-and-tools",{url:"/booksAndTools?parentId",require:()=>Promise.all([n.e(86),n.e(631)]).then(n.bind(null,"cFJh")),resolve:{translations:[r.serviceName,e=>e.loadBundle("features/course/books-and-tools/books-and-tools")]},panelClass:"peek",pageTitle:"course.booksAndTools.tab.title",peekStates:[a.i.CONTENT_MARKET,"partner-tools","proctoring-lti-tool"]})}])},"3uIF":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));n("QLzv");var a=n("5MwF"),i=n("yCC5"),r=n("Rjd/");const s=i.zb;r.a.factory(s,["restmod",e=>{const t=a.a.partnerCloudBasePath+"/v1/courses";return e.model(t).mix({$extend:{Model:{delete(e,t){return this.$build().$send({method:"DELETE",url:this.$url()+"/"+e+"/linkRefId/"+t},(function(e){})).$asPromise()}}}})}])},"3vti":function(e,t,n){"use strict";n("4lO8"),n("my/J");var a=n("71td"),i=n("Llzl"),r=n("yC9S"),s=n("nbDY"),o=n.n(s),l=n("+4Px"),c=n("0JpG");n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return u}));const d="ultra.components.directives.bbSortable";class u extends o.a{}u.Horizontal=new u("Horizontal"),u.Vertical=new u("Vertical");const m={containerSelector:"[sortable-container]",itemSelector:"[sortable-item]",containerPath:"[sortable-parent]:first",placeholder:'<div class="placeholder">&nbsp;</div>',handle:"i.icon-reorder",onDragStart(e,t,n,a){t.rootGroup.placeholder=e.clone().addClass("placeholder").removeAttr("sortable-item"),t.rootGroup.placeholder.find("[sortable-container], [sortable-item]").removeAttr("sortable-container sortable-item"),n(e,t)},triggerKey:l.f,orientation:u.Vertical,placeholderClass:"placeholder",moveKeyHandler:(e,t,n,a)=>{const i=t.options;if(u.Horizontal.isEqualTo(i.orientation)){const t=i.isRTL?l.j:l.s,n=i.isRTL?l.s:l.j;a.keyCode===n?(a.stopPropagation(),e.insertBefore(e.prev(i.itemSelector)),e.find(i.handle).focus()):a.keyCode===t&&(e.insertAfter(e.next(i.itemSelector)),e.find(i.handle).focus(),a.stopPropagation())}else a.keyCode===l.v?(a.stopPropagation(),e.insertBefore(e.prev(i.itemSelector)),e.find(i.handle).focus()):a.keyCode===l.d&&(e.insertAfter(e.next(i.itemSelector)),e.find(i.handle).focus(),a.stopPropagation())},cancelHandler:(e,t,n,a,i)=>{const r=e.index();r>n?e.insertAfter(e.parent().find(t.options.itemSelector+":nth-child("+n+")")):r<n&&e.insertAfter(e.parent().find(t.options.itemSelector+":nth-child("+(n+1)+")"))},saveHandler:(e,t,n,a)=>{e.focus(),t.options.onDrop&&"function"==typeof t.options.onDrop&&t.options.onDrop(e,t,n,a)}};class p{constructor(e){this.localize=e,this.scope={sortableOptions:"=?"},this.restrict="A",this.link=(e,t,n)=>{const i=e.$watch("sortableOptions",(()=>{e.sortableOptions=a.extend({},m,e.sortableOptions),e.sortableOptions.isRTL=this.localize.isRTL(e);const n=t.parents("[bb-sortable]");t.on("touchstart",e.sortableOptions.handle,(e=>{a(e.target).trigger("click")})),0!==n.length?(n.sortable("destroy"),n.last().sortable(e.sortableOptions)):t.sortable(e.sortableOptions),t.find(e.sortableOptions.itemSelector).each(((t,n)=>{this.keyboardDragAndDrop(a(n),e)})),r.b.OnRootScope(e,"sortable-item-inserted",((t,n)=>{const a=this.keyboardDragAndDrop(n,e);n.hasClass(e.sortableOptions.placeholderClass)&&!n.data("axHandlersAdded")&&this.triggerAccessibilityMode(a,e)})),i()}))}}keyboardDragAndDrop(e,t){const n=a(e).find(t.sortableOptions.handle);return n.on("keyup",(e=>{if(e.keyCode===t.sortableOptions.triggerKey){const n=a(e.target),i=n.closest(t.sortableOptions.itemSelector),r=i.parents(t.sortableOptions.containerSelector).last().data("sortable");if(i.hasClass(t.sortableOptions.placeholderClass))return;e.stopImmediatePropagation(),i.addClass(t.sortableOptions.placeholderClass),t.sortableOptions.onEnter&&t.sortableOptions.onEnter(i,r),this.triggerAccessibilityMode(n,t)}})),n}triggerAccessibilityMode(e,t){const n=e.closest(t.sortableOptions.itemSelector),i=n.parents(t.sortableOptions.containerSelector).last().data("sortable"),r=n.index();let s,o,l;const c=()=>{a(document).off("click focusin",o),e.off("keydown",s),e.off("keyup",l),n.data("axHandlersAdded",!1),n.removeClass(t.sortableOptions.placeholderClass),t.sortableOptions.onExit&&t.sortableOptions.onExit(n,i)};s=e=>{t.sortableOptions.moveKeyHandler(n,i,a.noop,e)},o=s=>{a(s.target).is(e)||(c(),t.sortableOptions.cancelHandler(n,i,r,a.noop,s))},l=e=>{e.keyCode===t.sortableOptions.triggerKey&&(c(),e.stopImmediatePropagation(),t.sortableOptions.saveHandler(n,i,a.noop,e))},e.on("keyup",l),e.on("keydown",s),a(document).on("click focusin",o),t.$on("$destroy",c),n.data("axHandlersAdded",!0)}}p.$inject=[c.serviceName],i.module(d,[c.moduleName]).directive("bbSortable",["$injector",e=>e.instantiate(p)])},"43zP":function(e,t,n){"use strict";var a;n.d(t,"a",(function(){return a})),function(e){e.NoChanges="noChanges",e.NotSaved="notSaved",e.Saved="saved",e.Saving="saving",e.Cancelling="cancelling",e.Deleting="deleting"}(a||(a={}))},"4GL6":function(e,t,n){"use strict";(function(e){n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return u}));n("pGZF");var a=n("nsO7"),i=n("Llzl"),r=n("0JpG"),s=n("lEL+"),o=n("gkef"),l=n("fGgA"),c=n("+4Px");const d="ultra.components.directives.tooltip.complexTooltip";function u(e=""){return'<ul class="complex-tooltip-list '+e+'"><li ng-repeat="item in items track by $index">{{item}}</li></ul>'}class m extends l.a{constructor(e,t,n,r,s,o,l){super(e,t,n,s,o,l),this.scope=e,this.element=t,this.attrs=n,this.$compile=r,this.localizeService=s,this.timeoutService=o,this.windowSizeService=l,this.scopeChanged=!1;const c=this.scope.$watch("tooltipScope()",(e=>{e&&(this.tooltipScope=this.scope.tooltipScope(),this.content=this.$compile(this.scope.tooltipTemplate)(this.tooltipScope),c())})),d=this.scope.$watch("tooltipScope().items",((e,t)=>{e&&t&&a.difference(e,t).length&&(this.tooltipScope=this.scope.tooltipScope(),this.content=this.$compile(this.scope.tooltipTemplate)(this.tooltipScope),this.scopeChanged=!0,this.tooltipScope.$parent.$on("$destroy",(()=>{this.tooltipScope.$destroy()})),(i.isUndefined(this.scope.tooltipAutoUpdate)||"false"===this.scope.tooltipAutoUpdate)&&d())}))}showTooltip(){"true"===this.scope.tooltipAutoUpdate&&this.tooltipCreated&&this.scopeChanged&&(this.updateTooltipContent(super.getTooltip()),this.tooltipCreated=!1,this.scopeChanged=!1),super.showTooltip()}addTooltipContent(t){this.content=this.$compile(this.scope.tooltipTemplate)(this.tooltipScope),this.tooltipScope.$apply(),t.on("keydown",(e=>{e.which===c.g?(this.element.focus(),this.hideTooltip()):e.which!==c.u||e.shiftKey?e.which===c.u&&e.shiftKey&&i.element(e.target).closest(".tooltip-first-tabbable").length>0&&(this.getTooltip().find(".tooltip-last-tabbable").focus(),e.preventDefault(),e.stopPropagation()):i.element(e.target).closest(".tooltip-last-tabbable").length>0&&(this.getTooltip().find(".tooltip-first-tabbable").focus(),e.preventDefault(),e.stopPropagation())})),t.append(e('<div class="'+m.TOOLTIP_CONTENT_CLASS+'"></div>').append(this.content))}updateTooltipContent(e){this.content=this.$compile(this.scope.tooltipTemplate)(this.tooltipScope),e.find("."+m.TOOLTIP_CONTENT_CLASS).empty().append(this.content)}addTooltipStyles(e){e.removeClass("tooltip-center-content"),this.attrs.tooltipMaxWidth&&(e.removeClass("tooltip-max-width"),e.css({"max-width":this.attrs.tooltipMaxWidth})),"true"===this.attrs.tooltipDisablePadding&&e.addClass("tooltip-unpadded"),"true"===this.attrs.tooltipDarkTheme&&e.addClass("tooltip-dark-theme")}addTooltipEvents(e){e.on("mouseleave",(e=>{this.timeoutMS>0?this.timeout=this.timeoutService((()=>{this.hideTooltip()}),this.scope,this.timeoutMS):this.hideTooltip()})),e.on("mouseover",(e=>{this.timeout&&this.timeoutService.cancel(this.timeout)})),e.on("click",(e=>{e.stopPropagation()}))}postShowTooltip(){i.isDefined(this.attrs.tooltipFocusSelector)&&this.timeoutService((()=>{this.getTooltip().find(this.attrs.tooltipFocusSelector).eq(0).focus()}),this.scope,120)}}m.$inject=["scope","element","attrs","$compile",r.serviceName,s.b,o.b],m.TOOLTIP_CONTENT_CLASS="complex-tooltip-content";class p{constructor(e){this.$injector=e,this.restrict="A",this.scope={tooltipScope:"&",tooltipTemplate:"@",tooltipAutoUpdate:"@?"},this.link=(e,t,n)=>{e.complexTooltip=this.$injector.instantiate(m,{scope:e,element:t,attrs:n})}}}p.$inject=["$injector"],i.module(d,[r.moduleName,s.a,l.b,o.a]).directive("bbComplexTooltip",["$injector",e=>e.instantiate(p)])}).call(this,n("71td"))},"4HBD":function(e,t,n){"use strict";var a=n("D57K"),i=n("Llzl"),r=n("n7/H"),s=n("1ZbL"),o=n("50Q+"),l=n("0JpG");const c="ultra.components.directives.react-toolkit.username",d={Class:o.e,attributes:["subtext"],bindingNames:["user","format","ariaHidden","showPronouns","showPronunciation"],renderLocalized:!0,withProvider:!0,withErrorModalBoundary:!1};i.module(c,[l.moduleName]).component("bbUiUsername",Object(s.a)(d));var u=n("gCXj"),m=n("pjml"),p=n("oVrE"),h=n("aHpC"),g=n("4eVg"),b=n("Zjmk");n.d(t,"a",(function(){return f}));const f="ultra.components.directives.bbUsername";let v=class{constructor(e,t,n,a){this.$scope=e,this.element=t,this.attributes=n,this.bbLocalize=a,t.addClass("username"),this.initialize()}initialize(){this.unbind=this.$scope.$watchGroup(["user.id","user.familyName","user.givenName","user.title","user.email","user.pronouns","user.pronunciation","user.pronunciationAudio","user.preferredDisplayName","user.otherName"],(()=>this.update()))}update(){if(!this.$scope.user)return;var e;this.user=(e=this.$scope.user)&&{id:e.id,title:e.title,givenName:e.givenName,familyName:e.familyName,otherName:e.otherName,preferredDisplayName:e.preferredDisplayName,pronouns:Object(b.c)(e),pronunciation:e.pronunciation,pronunciationAudio:e.pronunciationAudio,email:e.email,ui:e.ui};const t=this.$scope.user;t.$asPromise&&!t.$resolved?t.$asPromise().then((()=>this.updateDom())):this.updateDom(),null!=this.attributes.autoUpdate&&"false"!==this.attributes.autoUpdate||this.unbind()}isAnonymousUser(e){return Object(p.d)(e)}cleanUpClassNames(e){return e.split(/\s+/).filter((e=>!/^course_user.+$/.test(e))).join(" ")}updateDom(){const e=this.$scope.user;this.shouldAllowLabel="true"===this.attributes.shouldAllowLabel,this.showInlineUsername="true"===this.attributes.showInlineUsername,this.showPronouns="true"===this.attributes.showPronouns,this.showPronunciation="true"===this.attributes.showPronunciation,this.isAnonymousUser(e)&&(e.givenName=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.$scope),key:"anonymous.postedName"}),e.familyName=""),this.element[0].className=this.cleanUpClassNames(this.element[0].className),e.id&&this.element.addClass("course_user"+e.id);const t=this.bbLocalize.getFormatId(r.ILocaleUsernameFormat,this.attributes.format);this.$scope.format=t;try{this.accessibilityName=this.bbLocalize.formatUsernameSync(e,t,this.$scope,{noWrap:!0,noEscape:!0}),"true"===this.attributes.hasTitleAttr?this.element.attr("title",this.accessibilityName):this.element.removeAttr("title"),this.textAccommodation=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.$scope),key:"components.directives.username.msg-has-accommodations",params:{fullname:this.accessibilityName},noWrap:!0})}catch(e){console.error(e)}}};v=Object(a.a)([Object(a.c)(0,Object(h.b)("$scope")),Object(a.c)(1,Object(h.b)("$element")),Object(a.c)(2,Object(h.b)("$attrs")),Object(a.c)(3,Object(h.b)(l.serviceName))],v);class y{constructor(){this.controllerAs="un",this.scope={user:"="},this.restrict="AE",this.template=g,this.controller=v}}i.module(f,[l.moduleName,u.a,m.N,c]).config([u.b+"Provider",function(e){e.onStyleRefresh((function(e,t){var n,a;const i=t.permissions,r=null===(a=null===(n=t.course)||void 0===n?void 0:n.memberships)||void 0===a?void 0:a.permissions,s=(null==r?void 0:r.viewDueDateException)||(null==r?void 0:r.viewTimeLimitException),o=(null==i?void 0:i.editDueDateException)||(null==i?void 0:i.editTimeLimitException),l=s||o;e.selector(`bb-username.course_user${t.userId}:before`).rule("display",t.accommodation().hasAccommodation&&l?"inline-block":"none!important"),e.selector(`bb-username.course_user${t.userId}:before`).rule("vertical-align",t.accommodation().hasAccommodation&&l?"middle":"none"),e.selector(`bb-username.course_user${t.userId}`).selector(".sr-only:before").rule("content",t.accommodation().hasAccommodation&&l?"attr(aria-label-if-has-accommodation)":"attr(aria-label-if-no-accommodation)"),e.selector(`bb-username.course_user${t.userId} bb-ui-username`).rule("width",t.accommodation().hasAccommodation&&l?"calc(100% - .75rem)":"100%"),e.selector(`.bb-group-user .highlight .course_user${t.userId}`).rule("overflow",t.accommodation().hasAccommodation&&l?"visible":"hidden"),e.selector(`.element-card .element-details .course_user${t.userId}`).rule("display",t.accommodation().hasAccommodation&&l?"flex":"inline"),e.selector(`.user-info bb-username.course_user${t.userId}`).rule("display",t.accommodation().hasAccommodation&&l?"flex":"block")}))}]).directive("bbUsername",["$injector",e=>e.instantiate(y)])},"4HXK":function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return o}));var a=n("Llzl"),i=n("5MwF"),r=n("w9mJ");const s="ultra.services.logger",o="logger";class l{constructor(e,t){this.$http=e,this.promiseQueueService=t,this.$http=e,this.queue=t.getQueue("telemetry")}logToServer(e,t,n){if(e){const a="string"==typeof e?new Error(e):e,r={applicationId:i.a.telemetryAppId,component:"",message:a.message,data:n,cause:a.stack,level:t};r.cause||(r.cause="Stack trace is unavailable"),this.queue.enqueue((()=>this.$http.post(i.a.telemetryApiBasePath+"/v1/browser/logs",r,{timeout:i.a.telemetryApiTimeoutMS}).catch((e=>{console.error("Failed to send logs to server. \nResponse: "+e+" Status: "+e.status)}))))}else console.error("Unable to send empty log entry to server")}debug(e,t){this.logToServer(e,"debug",t)}info(e,t){this.logToServer(e,"info",t)}error(e,t){this.logToServer(e,"error",t)}critical(e,t){this.logToServer(e,"critical",t)}warn(e,t){this.logToServer(e,"warn",t)}}l.$inject=["$http",r.b];a.module(s,[r.a]).service(o,l)},"4eVg":function(e,t){e.exports='<bb-ui-username\n  ng-if="un.user"\n  class="bb-ui-username"\n  user="un.user"\n  format="un.format"\n  aria-hidden="!un.shouldAllowLabel"\n  show-pronouns="un.showPronouns"\n  show-pronunciation="un.showPronunciation"\n  subtext="{{ un.showInlineUsername ? user.userName : undefined }}"\n></bb-ui-username>\n<span\n  ng-if="un.user"\n  class="sr-only"\n  ng-attr-aria-hidden="{{ !un.shouldAllowLabel || undefined }}"\n  aria-label="{{ un.accessibilityName }}"\n  aria-label-if-no-accommodation="{{ un.accessibilityName }}"\n  aria-label-if-has-accommodation="{{ un.textAccommodation }}"\n></span>\n'},"4nF1":function(e,t,n){"use strict";n.d(t,"b",(function(){return w})),n.d(t,"a",(function(){return N}));var a=n("Llzl"),i=n("nsO7"),r=n("pjml"),s=n("Y3OE"),o=n("nbDY"),l=n.n(o),c=n("Q/M7"),d=n("nmzr"),u=n("zGdY"),m=n("IbyE"),p=n("AuQm"),h=n("kcGO");class g extends l.a{}g.BbPage=new g("resource/x-bb-page"),g.LtiLaunch=new g("ltilaunch"),g.ScormLaunch=new g("scormlaunch"),g.ContentUrl=new g("contenturl"),g.FileUrl=new g("fileurl"),g.None=new g("none");class b{constructor(e,t){this.content=e,this.isFromCourseLink=t}deleteKey(){return this.content.contentHandler.toString()}iconClass(){const e=s.a.parse(this.content.contentHandler.toString());return null!=e?e.iconClass:null}linkAction(){let e=this.content.contentHandler.toString();this.isFromCourseLink&&(e=s.a.CourseLink.toString());let t=g.parse(e);return t||(t=new g(e)),t}viewHandler(){return this.content.contentHandler.toString()}getTargetCourseContentDisplay(){return null}getEditSref(){return null}getEditState(){return null}getEditStateParams(){return null}usesEditButton(){return null!=this.getEditSref()}canUseEditButton(){return this.usesEditButton()&&!(!this.content.permissions||!this.content.permissions.edit&&!this.content.permissions.modifyAvailability)}canDownload(){return!1}isLtiLink(){return!1}contentUrl(){throw new Error("contentUrl() is not supported for "+this.content.contentHandler.toString())}supportsConversations(){return!1}isXplorLtiLink(){return!1}getContentProgressRoute(){}}class f extends b{getEditState(){return"gradebook-item.assignment"}getEditStateParams(){return{courseId:this.content.courseId,contentId:this.content.id,gradeitemView:"details"}}getEditSref(){return this.getEditState()+'({courseId: content.courseId,contentId: content.id,gradeitemView: "details"})'}}class v extends b{getEditState(){return"gradebook-item.assignment"}getEditStateParams(){return{courseId:this.content.courseId,contentId:this.content.id,gradeitemView:"details"}}getEditSref(){return this.getEditState()+'({courseId: content.courseId,contentId: content.id,gradeitemView: "details"})'}supportsConversations(){return!0}}class y extends b{deleteKey(){if(this.content.getAssociatedGradingColumn){const e=this.content.getAssociatedGradingColumn();if(e&&e.gradebookCategory)return e.gradebookCategory.title===u.W.Assignment?s.a.UltraAssignment.toString():s.a.TestLink.toString()}return this.content.contentHandler.toString()}getEditState(){return d.w.GRADEBOOK_ITEM_ASSESSMENT}getEditStateParams(){return{courseId:this.content.courseId,contentId:this.content.id,gradeitemView:"details",assessmentType:"test"}}canUseEditButton(){const e=this.content.getDeployedAssessment().permissions;return!(!e||!e.modify&&!e.view)}getEditSref(){return this.getEditState()+'({courseId: content.courseId,contentId: content.id,gradeitemView: "details",assessmentType: "test"})'}supportsConversations(){return!0}}class S extends b{getEditState(){return"discussion.view.with-grading"}getEditStateParams(){return{courseId:this.content.courseId,contentId:this.content.id}}getEditSref(){return this.getEditState()+"({courseId: content.courseId,contentId: content.id})"}}class C extends b{constructor(e){super(e),this.content=e,e.contentDetail&&(this.targetContent=e.getLinkContentSource())}getTargetCourseContentDisplay(){return this.targetContent&&this.targetContent.$resolved&&this.targetContent.contentHandler?N.normalize(this.targetContent.contentHandler.toString())===s.a.Discussion.toString()?new S(this.targetContent,!0):new b(this.targetContent,!0):new b(this.content,!0)}}class E extends b{constructor(e,t){super(e),this.options=t}getEditState(){return d.u.EDIT_FILE}getEditStateParams(){return{id:this.content.id}}getEditSref(){return this.getEditState()+"({id:content.id})"}canDownload(){var e,t;if(m.j.isConditionalReleaseLocked(this.content))return!1;if(!(null===(e=this.options)||void 0===e?void 0:e.supportsInlineRender))return!0;const n=null===(t=this.content.contentDetail)||void 0===t?void 0:t[r.p.ContentHandler.File.toString()];return Object(u.Oc)(null==n?void 0:n.fileAssociationMode)}linkAction(){var e;if(!this.content.contentDetail||!(null===(e=this.options)||void 0===e?void 0:e.supportsInlineRender))return g.ContentUrl;const t=this.content.contentDetail[r.p.ContentHandler.File.toString()],n=null==t?void 0:t.fileAssociationMode,a=(null==t?void 0:t.file)&&Object(p.jb)(t.file,this.content.description);return a&&"LINK"!==n&&Object(p.Z)(a,!0)?g.FileUrl:g.ContentUrl}contentUrl(){var e,t;if(m.j.isConditionalReleaseLocked(this.content))return;const n=null===(e=this.content.contentDetail)||void 0===e?void 0:e[r.p.ContentHandler.File.toString()];return c.c(null===(t=null==n?void 0:n.file)||void 0===t?void 0:t.permanentUrl)}getContentProgressRoute(){return{stateName:d.u.PREVIEW_FILE,args:{id:this.content.id,courseId:this.content.courseId,view:h.b.Progress}}}}class I extends b{getEditState(){return d.k.EDIT_FOLDER}getEditStateParams(){return{id:this.content.id}}getEditSref(){return this.getEditState()+"({id:content.id})"}getContentProgressRoute(){return{stateName:d.k.GENERIC_STUDENT_PROGRES_PEEK_PANEL,args:{id:this.content.id,courseId:this.content.courseId}}}}class k extends b{getEditState(){return"content-manage.edit.learning-module"}getEditStateParams(){return{id:this.content.id}}getEditSref(){return this.getEditState()+"({id:content.id})"}getContentProgressRoute(){return{stateName:d.k.GENERIC_STUDENT_PROGRES_PEEK_PANEL,args:{id:this.content.id,courseId:this.content.courseId}}}}class w extends I{static get EDIT_STATE_SREF(){return d.k.DOCUMENT}getEditState(){return w.EDIT_STATE_SREF}getIconClass(){return s.a.Document.iconClass}supportsConversations(){return!0}linkAction(){return g.BbPage}viewHandler(){return s.a.Page.toString()}getContentProgressRoute(){return{stateName:d.k.DOCUMENT,args:{id:this.content.id,courseId:this.content.courseId,view:h.b.Progress}}}}class T extends b{getEditState(){return"content-manage.edit.link"}getEditStateParams(){return{id:this.content.id}}getEditSref(){return this.getEditState()+"({id:content.id})"}contentUrl(){const e=r.p.ContentHandler.ExternalLink.toString();let t=Object(i.get)(this.content,["contentDetail",e,"url"],null);return t&&(t=Object(i.unescape)(t)),T.PROTOCOL_CHECK.test(t)?t:"http://"+t}linkAction(){return g.ContentUrl}getContentProgressRoute(){return{stateName:d.k.GENERIC_STUDENT_PROGRES_PEEK_PANEL,args:{id:this.content.id,courseId:this.content.courseId}}}}T.PROTOCOL_CHECK=/^\w+\:{1}/;class O extends b{isCloudDocument(){var e;return this.content.contentDetail&&m.D.CloudDocument===(null===(e=this.getContentDetail())||void 0===e?void 0:e.itemOrigin)}getContentDetail(){var e;return this.content.contentDetail[null===(e=this.content.contentHandler)||void 0===e?void 0:e.toString()]}getEditState(){return this.isCloudDocument()?d.G.Lti.LTI_LAUNCH_PEEK:"content-manage.edit.lti"}getEditStateParams(){var e;if(this.isCloudDocument()){let t=c.c(null===(e=this.getContentDetail())||void 0===e?void 0:e.launchLink);return t=c.a(t,"from_ultra","true"),{courseId:this.content.courseId,contentId:this.content.id,toolHref:t}}return{id:this.content.id}}getEditSref(){return this.getEditState()+"({id:content.id})"}linkAction(){return g.LtiLaunch}isLtiLink(){return!0}isXplorLtiLink(){var e,t,n,a,i;const r=null===(i=null===(t=null===(e=this.content)||void 0===e?void 0:e.contentDetail)||void 0===t?void 0:t[null===(a=null===(n=this.content)||void 0===n?void 0:n.contentHandler)||void 0===a?void 0:a.toString()])||void 0===i?void 0:i.url;return r&&r.indexOf("://xplor")>-1}supportsConversations(){return!0}getContentProgressRoute(){return{stateName:d.k.GENERIC_STUDENT_PROGRES_PEEK_PANEL,args:{id:this.content.id,courseId:this.content.courseId}}}}class A extends b{deleteKey(){return s.a.LtiPlacement.toString()}getEditState(){return"content-manage.edit.placement"}getEditStateParams(){return{id:this.content.id}}getEditSref(){return this.getEditState()+"({id:content.id})"}linkAction(){return g.LtiLaunch}isLtiLink(){return!0}supportsConversations(){return!0}canUseEditButton(){return super.canUseEditButton()&&a.isDefined(this.content.contentDetail)&&a.isDefined(this.content.contentDetail[this.content.contentHandler.toString()])&&a.isDefined(this.content.contentDetail[this.content.contentHandler.toString()].placement)}getContentProgressRoute(){return{stateName:d.k.GENERIC_STUDENT_PROGRES_PEEK_PANEL,args:{id:this.content.id,courseId:this.content.courseId}}}}class P extends b{getEditState(){return"scorm-settings"}getEditStateParams(){return{contentId:this.content.id}}getEditSref(){return this.getEditState()+"({contentId:content.id})"}linkAction(){return g.ScormLaunch}supportsConversations(){return!0}getContentProgressRoute(){return{stateName:d.k.GENERIC_STUDENT_PROGRES_PEEK_PANEL,args:{id:this.content.id,courseId:this.content.courseId}}}}class x extends b{getEditState(){return d.G.Journal.JOURNAL_VIEW_WITH_PARTICIPATION}getEditStateParams(){return{courseId:this.content.courseId,contentId:this.content.id}}getEditSref(){return this.getEditState()+"({courseId: content.courseId,contentId: content.id})"}}class $ extends b{linkAction(){return g.LtiLaunch}isLtiLink(){return!0}}class N{static normalize(e){return null!=e&&0===e.indexOf(s.a.LtiPlacement.toString())?s.a.LtiPlacement.toString():e}static matchesHandlers(e,t){const n=this.normalize(e);return Object(i.findIndex)(t,(e=>n===e.toString()))>=0}static create(e,t){switch(this.normalize(e.contentHandler.toString())){case s.a.ClassicAssignment.toString():return new f(e);case s.a.File.toString():return new E(e,t);case s.a.Folder.toString():if(e.contentDetail){const t=e.contentDetail[s.a.Folder.toString()];if(t&&t.isBbPage)return new w(e)}return new I(e);case s.a.ExternalLink.toString():return new T(e);case s.a.LtiLink.toString():return new O(e);case s.a.LtiPlacement.toString():return new A(e);case s.a.Page.toString():return new w(e);case s.a.PartnerCloud.toString():return new $(e);case s.a.TestLink.toString():return new y(e);case s.a.RusticiScorm.toString():return new P(e);case s.a.UltraAssignment.toString():return new v(e);case s.a.Discussion.toString():return new S(e);case s.a.CourseLink.toString():return new C(e).getTargetCourseContentDisplay();case s.a.LearningModule.toString():return new k(e);case s.a.Journal.toString():return new x(e);default:return new b(e)}}}},"4vd5":function(e,t,n){"use strict";var a=n("ERkP"),i=n("td+C"),r=n("oPIA"),s=n("v6Sp"),o=n("tN4z"),l=n("nmzr");const c=e=>{const[t,n]=Object(a.useState)("#");return Object(a.useEffect)((()=>{n(l.Z.getHref(l.y.INTEGRATION_BASE,{routeName:e}))}),[e]),t},d=e=>{const{isRtl:t,to:n,analyticsId:i,className:r,children:s,...l}=e,d=c(n),u=i?`integration.${i}`:"integration.link";return a.createElement(o.AnalyticsJssThemeProvider,{theme:"light",isRtl:t},a.createElement(o.AnalyticsLink,{...l,className:`uef-link ${r}`,analyticsId:u,href:d},s))},u=e=>{const{analyticsId:t,children:n,isRtl:i,to:r,...s}=e,l=c(r),d=t?`integration.${t}`:"integration.button.link";return a.createElement(o.AnalyticsJssThemeProvider,{theme:"light",isRtl:i},a.createElement(o.AnalyticsPrimaryButton,{...s,analyticsId:d,href:l,variant:"contained",color:"primary"},n))},m=/^[a-z0-9-]*$/i,p=new Map([["uef--base-nav-button","integration-navigation-button-content themed-background-primary-alt-fill-only theme-border-left-active"],["uef--base-nav-button-v2","integration-navigation-button-content-v2 themed-background-primary-alt-fill-only theme-border-left-active"],["uef--button","button button--primary"],["uef--button--secondary","button button--secondary"]]),h=new Map([["classname",e=>Object(s.h)(e,p)]]);t.a=new class{constructor(e){this.integrationService=e,this.onIntegrationRegistration=(e,t)=>{const n=this.validateBaseNavigationRequest(e);n.status===r.p.Success?(this.registeredRoutes.set(t.id,{integrationId:t.id,routes:[e.routeName],displayName:e.displayName,initialContents:e.initialContents}),this.listeners.forEach((e=>{try{e(this.registeredRoutes.get(t.id))}catch(e){console.error(e)}})),this.integrationService.sendMessage(n,t)):this.integrationService.sendMessage(n,t)},this.registeredRoutes=new Map,this.listeners=new Set}init(e){this.initializeWhitelist(),this.integrationService.addIntegrationMessageType(r.d,this.onIntegrationRegistration),this.bbLocalize=e}initializeWhitelist(){const e={props:{to:!0,className:!1},isValid:(e,t)=>!!this.isRouteRegistered(e.props.to,t)||(console.warn(`${e.props.to} has not been registered`),!1),render:(e,t,n)=>a.createElement(d,{...t,isRtl:this.bbLocalize.isRTL(null)}," ",n," "),transformers:h},t={props:{to:!0,className:!1},isValid:(e,t)=>!!this.isRouteRegistered(e.props.to,t)||(console.warn(`${e.props.to} has not been registered`),!1),render:(e,t,n)=>a.createElement(u,{...t,isRtl:this.bbLocalize.isRTL(null)}," ",n," "),transformers:h};s.b.addGlobalComponent(r.q.Link,e),s.b.addGlobalComponent(r.q.ButtonLink,t)}onIntegrationAdded(e){return this.listeners.add(e),()=>{this.removeIntegrationAdded(e)}}removeIntegrationAdded(e){this.listeners.delete(e)}getRegisteredRecords(){return Array.from(this.registeredRoutes.values())}getRecordForRoute(e){return Array.from(this.registeredRoutes.values()).find((t=>t.routes.indexOf(e)>=0))}isValidRouteName(e){return m.test(e)}validateBaseNavigationRequest(e){return this.getRecordForRoute(e.routeName)?{type:r.d,status:r.p.Failure,error:r.t.ExistingRouteName,errorMessage:`${e.routeName} as already been registered`}:this.isValidRouteName(e.routeName)?{type:r.d,status:r.p.Success}:{type:r.d,status:r.p.Failure,error:r.t.InvalidRouteName,errorMessage:`${e.routeName} has invalid characters in it.`}}isRouteRegistered(e,t){var n;const a=null===(n=this.registeredRoutes.get(t))||void 0===n?void 0:n.routes;return!!a&&-1!==a.indexOf(e)}}(i.a)},"50Q+":function(e,t,n){"use strict";var a=n("ERkP"),i=n.n(a),r=n("SToD"),s=n("tN4z");n("ICWc"),n("71td"),n("JD9L"),n("4qjI");const o={"& input":{margin:"0px",minHeight:"auto",height:"auto",":focus":{boxShadow:"none"}}};var l=n("GuFu"),c=n("zGdY"),d=n("n7/H"),u=n("Agfx"),m=n("THXI");const p=Object(u.makeStyles)({wrapper:{display:"flex",width:"100%"},avatar:{borderRadius:"50%",height:"24px",marginRight:"10px",marginTop:"8px",width:"24px"},names:{display:"inline-block",width:"90%"},givenName:{display:"block",marginRight:"10px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},username:{color:m.c.charcoal,display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},highlight:{fontWeight:m.h.fontWeightBold}}),h=e=>{const{stringToSearch:t,searchString:n}=e;if(!n)return a.createElement("span",null,t);const{highlightStyle:i}=e,r=t.split(new RegExp(`(${n})`,"gi")).filter((e=>e));return a.createElement("span",null,r.map(((e,t)=>a.createElement("span",{key:t,className:`js-search-highlighting-split ${e.toLowerCase()===n.toLowerCase()?i:""}`},e))))},g=e=>{var t;const{optionData:n,selectorData:i}=e,r=p();return a.createElement("div",{className:r.wrapper},a.createElement("img",{className:r.avatar,src:null===(t=n.user.avatar)||void 0===t?void 0:t.permanentUrl,alt:n.value}),a.createElement("span",{className:r.names},a.createElement("span",{className:r.givenName},a.createElement(h,{stringToSearch:n.label,searchString:i.inputValue,highlightStyle:r.highlight})),a.createElement("span",{className:r.username},n.user.userName)))};var b=n("uDfI"),f=n("IbyE");const v=(e,t)=>f.Yb.courseMembership.getCourseMembershipViewStatusByQuery(e,t),y=(e,t)=>{const n=e.getState(),a=v(n,t),i=f.Yb.courseMembership.getCourseMembershipsByQuery(n,t),r=f.Yb.user.getUsersByIds(n,i.reduce(((e,t)=>(t.userId&&e.push(t.userId),e)),[]));return{memberships:i,users:r,view:a}};var S=n("BidM"),C=n.n(S);const E=(e,t,n)=>{const[i,r]=a.useState(e+t+n),s=t+e;return s>i&&r(s+n),i},I=[{field:c.gb.Role,direction:c.Wb.Descending},{field:c.gb.FamilyName,direction:c.Wb.Ascending},{field:c.gb.GivenName,direction:c.Wb.Ascending}],k={membershipAvailable:!0,includeMe:!1},w=(e,t,n,a,i)=>(null==e?void 0:e.length)>=i?[]:t.reduce(((e,t)=>{var i;if(!t.userId)return e;const r=n[t.userId];return r.id&&e.push({value:r.id,user:r,label:null!==(i=a.formatUsername(r,d.ILocaleUsernameFormat.Short))&&void 0!==i?i:""}),e}),[]),T=(e,t,n,i,r)=>{const s=Object(b.f)(),o=a.useCallback(C()((async a=>{const i=await(async(e,t)=>{const n=e.getState(),a=v(n,t);return a&&a.isValid&&!a.isLoading?y(e,t):(0,e.dispatch)(f.V.courseMembership.loadCourseMembershipsByQuery(t)).then((()=>y(e,t)))})(s,{courseId:e,paging:{limit:t},filter:{...k,roleBucket:n,searchString:a},sort:I});return r(i.users,i.memberships)}),500),[e,r,t]);return a.useCallback(((e,t)=>{o(e).then((e=>{t(e)}))}),[o])},O=Object(r.a)((e=>{const{inputId:t,analyticsId:n,localize:i,courseId:r,placeholder:u,onMemberSelectionChanged:m,disabled:p,selectedUsers:h,selectionLimit:b,label:f,roleBuckets:v}=e,y=a.useCallback(((e,t)=>w(h,t,e,i,b)),[h,b,i]),S=null!=v?v:[c.y.Taking,c.y.Supporting],{users:C,memberships:O,totalUsers:A,loadPickerUsersCallback:P}=((e,t,n,a)=>{var i,r;const s=E(50,n.length,10),o=T(e,s,t,0,a),{memberships:c,users:d,view:u}=Object(l.g)({courseId:e,paging:{limit:s},filter:{...k,roleBucket:t,searchString:""},sort:I}),m=((e,t,n)=>{const a=n.map((e=>e.id));return t=t.filter((e=>!a.includes(e.userId))).slice(0,50),{users:e=t.reduce(((t,n)=>n.userId?(t[n.userId]=e[n.userId],t):t),{}),memberships:t}})(d,c,n);return{...m,totalUsers:null!==(r=null===(i=null==u?void 0:u.paging)||void 0===i?void 0:i.count)&&void 0!==r?r:0,loadPickerUsersCallback:o}})(r,S,h,y),x=w(h,O,C,i,b),$=a.useCallback(((e,t)=>"menu"===t.context?a.createElement(g,{selectorData:t,optionData:e}):a.createElement("span",null,e.label)),[]),N=((e=[],t)=>e.reduce(((e,n)=>{var a;return n.id?(e.push({value:n.id,user:n,label:null!==(a=t.formatUsername(n,d.ILocaleUsernameFormat.Short))&&void 0!==a?a:""}),e):e}),[]))(h,i),D={inputId:t,analyticsId:`${n}.userPicker`,"aria-label":u,className:"js-individual-members-picker",defaultValue:N,value:N,formatOptionLabel:$,isClearable:!0,isDisabled:p,noOptionsMessage:()=>(null==h?void 0:h.length)>=b?i.translate("course.learn-data-components.course-members-picker.noResultsMax"):i.translate("course.learn-data-components.course-members-picker.noResults"),label:f,removeTagAriaLabel:e=>{const t=e.label.props.children;return i.translate("course.learn-data-components.removeItem",{selectedLabel:t})},clearInputTooltipLabel:i.translate("course.learn-data-components.clearAll"),onChange:e=>{var t;return m(null!==(t=null==e?void 0:e.map((e=>e.user)))&&void 0!==t?t:[])},placeholder:u,styles:{input:e=>({...e,...o})}};return A>50?a.createElement(s.AnalyticsAsyncPicker,{tabSelectsValue:!1,isMulti:!0,loadOptions:P,defaultOptions:x,...D}):a.createElement(s.AnalyticsTagPicker,{options:x,...D})})),A=Object(u.makeStyles)((e=>Object(u.createStyles)({groupSize:{background:m.a.b9,color:m.k.primary,borderRadius:"50%",width:"24px",height:"24px",display:"inline-block",marginRight:"10px",textAlign:"center",fontWeight:e.typography.fontWeightBold,lineHeight:"24px"},maxUser:{fontSize:e.typography.fontSizeSmall},highlight:{fontWeight:e.typography.fontWeightBold}})));var P=n("7O4Y");const x=Object(r.a)((e=>{var t;const{optionData:n,selectorData:a,localize:r}=e,s=A(),o=null!==(t=n.group.studentCount)&&void 0!==t?t:100;return i.a.createElement("span",null,i.a.createElement("span",{className:Object(P.a)("js-group-size",s.groupSize,o>99&&s.maxUser)},o>99?r.translate("course.learn-data-components.course-groups-picker.maxUsers"):o),i.a.createElement(h,{stringToSearch:n.label,searchString:a.inputValue,highlightStyle:s.highlight}))})),$=Object(u.makeStyles)((e=>Object(u.createStyles)({groupSet:{display:"flex"},label:{flex:1,overflow:"hidden",textOverflow:"ellipsis",paddingRight:"10px"},visibility:{fontWeight:e.typography.fontWeightRegular,color:e.palette.text.hint,display:"flex"},visibilityIcon:{marginRight:"5px",alignSelf:"center"},highlight:{fontWeight:e.typography.fontWeightBold}})));var N=n("0x+l");const D=Object(r.a)((e=>{var t;const{localize:n,groupSet:i,searchString:r}=e,s=$(),o=(null==i?void 0:i.isAvailable)?n.translate("course.learn-data-components.course-groups-picker.visible"):n.translate("course.learn-data-components.course-groups-picker.hidden");return a.createElement("span",{className:s.groupSet},a.createElement("span",{className:s.label},a.createElement(h,{stringToSearch:null!==(t=null==i?void 0:i.title)&&void 0!==t?t:"",searchString:r,highlightStyle:s.highlight})),a.createElement("span",{className:s.visibility},(null==i?void 0:i.isAvailable)?a.createElement(N.Visible,{className:s.visibilityIcon}):a.createElement(N.Invisible,{className:s.visibilityIcon}),a.createElement("span",null,o)))})),L=(e,t)=>f.Yb.group.getCourseGroupViewStatusByQuery(e,t),j=(e,t)=>{const n=e.getState(),a=L(n,t);return{groups:f.Yb.group.getGroupsByQuery(n,t),view:a}},M=Object(u.makeStyles)((e=>Object(u.createStyles)({defaultHighlight:{fontWeight:e.typography.fontWeightSemiBold}}))),G=(f.m.Title,c.Wb.Ascending,f.l.Title,c.Wb.Ascending,e=>{var t,n;return{group:e,label:null!==(t=e.title)&&void 0!==t?t:"",value:null!==(n=e.id)&&void 0!==n?n:""}}),R=(e,t,n)=>{const a=new Map;return(null==e?void 0:e.length)>=n||!(null==t?void 0:t.length)?[]:(t.forEach((e=>{if(!(null==e?void 0:e.groupSet)||!(null==e?void 0:e.groupSetId))return;const t=e.groupSet,n=G(e);if(!t.id)return;const i=a.get(t.id);if(i)i.options.push(n);else{const i={groupSet:t,options:[]};i.options.push(n),a.set(e.groupSetId,i)}})),Array.from(a.values()))},B=(e,t)=>{const n=t.map((e=>e.id));return e.filter((e=>!n.includes(null==e?void 0:e.id))).slice(0,200)},F=(e,t,n,i)=>{const r=Object(b.f)(),[s,o]=a.useState([]),l=a.useCallback(C()((async a=>{const{groups:s}=await(async(e,t)=>{const n=e.getState(),a=L(n,t);return a&&a.isValid&&!a.isLoading?j(e,t):(0,e.dispatch)(f.V.group.loadGroupsByQuery(t)).then((()=>j(e,t)))})(r,{courseId:e,filter:{nameOrGroupSetName:a,inGroupSet:!0,groupNameCompare:f.k.contains},paging:{limit:t}}),l=i(B(s,n));return o(l),l}),500),[s,e,t,n,i]);return{memoizedLoadOptionsCallback:a.useCallback(((e,t)=>{l(e).then((e=>{t(e)}))}),[l]),optionData:s}},U=Object(r.a)((e=>{const{inputId:t,analyticsId:n,courseId:i,onSelectedGroupsChanged:r,disabled:c,placeholder:d,selectedGroups:u=[],selectionLimit:p,localize:h,label:g}=e,b=M(),[f,v]=a.useState(""),y=a.useCallback((e=>R(u,e,p)),[u,p]),{groups:S,totalGroups:C,optionData:I,loadPickerGroupsCallback:k}=((e,t,n)=>{var a,i;const r=E(200,t.length,10),{memoizedLoadOptionsCallback:s,optionData:o}=F(e,r,t,n),{groups:c,view:d}=Object(l.e)({courseId:e,filter:{nameOrGroupSetName:"",inGroupSet:!0},paging:{limit:r}});return{groups:B(c,t),totalGroups:null!==(i=null===(a=null==d?void 0:d.paging)||void 0===a?void 0:a.count)&&void 0!==i?i:0,optionData:o.length>0?o:n(B(c,t)),loadPickerGroupsCallback:s}})(i,u,y),w=R(u,S,p),T=a.useCallback((e=>{v(e)}),[]),O=a.useCallback(((e,t)=>"menu"===t.context?a.createElement(x,{selectorData:t,optionData:e}):a.createElement("span",null,e.label)),[]),A=a.useCallback((e=>a.createElement("span",{className:b.defaultHighlight},a.createElement(D,{groupSet:e.groupSet,searchString:f}))),[f,b.defaultHighlight]),P=h.translate("course.learn-data-components.course-groups-picker.noResultsMax"),$=h.translate("course.learn-data-components.course-groups-picker.noResults"),N=a.useCallback((()=>(null==u?void 0:u.length)>=p?P:$),[u,p,$,P]),L=((e=[])=>e.map((e=>G(e))))(u),j=a.useCallback((e=>{var t;r(null!==(t=null==e?void 0:e.map((e=>e.group)))&&void 0!==t?t:[])}),[r]),U=a.useCallback((e=>({visibleGroupCount:e.reduce(((e,t)=>{var n;return(null===(n=t.group)||void 0===n?void 0:n.isAvailable)?e+1:e}),0),totalGroupCount:e.length})),[]),_={inputId:t,analyticsId:`${n}.groupsPicker`,"aria-label":d,className:"js-groups-picker",defaultValue:L,value:L,isClearable:!0,isDisabled:c,filterOption:({label:e,value:t},n)=>((e,t,n,a)=>{if(e.toLowerCase().includes(n.toLowerCase()))return!0;const i=a.map((e=>{const t=e.groupSet.title;return(null==t?void 0:t.toLowerCase().includes(n.toLowerCase()))?e:null})),r=e=>e.value===t;return i.some((e=>null==e?void 0:e.options.some(r)))})(e,t,n,I),formatOptionLabel:O,formatGroupLabel:A,noOptionsMessage:()=>N(),label:g,removeTagAriaLabel:e=>{const t=e.label.props.children;return h.translate("course.learn-data-components.removeItem",{selectedLabel:t})},clearInputTooltipLabel:h.translate("course.learn-data-components.clearAll"),onChange:j,getOnChangeAnalyticsData:U,onInputChange:T,inputValue:f,placeholder:d,styles:{input:e=>({...e,...o}),group:e=>({...e,paddingTop:0}),groupHeading:e=>({...e,fontWeight:m.h.fontWeightBold,color:m.l.primary,backgroundColor:m.a.b3,height:"32px",lineHeight:"32px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"})}};return C>200?a.createElement(s.AnalyticsAsyncPicker,{tabSelectsValue:!1,isMulti:!0,loadOptions:k,defaultOptions:w,..._}):a.createElement(s.AnalyticsTagPicker,{options:w,..._})})),_=Object(u.makeStyles)((e=>({wrapper:{display:"flex",alignItems:"center",width:"100%"},iconWrapper:{display:"flex",alignItems:"center",marginRight:"10px",width:"24px"},columnName:{width:"90%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},highlight:{fontWeight:e.typography.fontWeightBold}})));var z=n("8jBL"),q=n("Gvux");const H=new Map,V=new Map,W=new Map;var K;V.set(c.W.Assignment,z.Assignment),V.set(c.W.Attendance,z.Attendance),V.set(c.W.Calculation,z.Calculation),V.set(c.W.Discussion,z.Discussion),V.set(c.W.Exam,z.Test),V.set(c.W.Homework,z.Home),V.set(c.W.Journal,z.Grades),V.set(c.W.LTI,q.Lti),V.set(c.W.Presentation,z.PresentationMenu),V.set(c.W.Quiz,z.Test),V.set(c.W.ScormEngine,q.Scormengine),V.set(c.W.Test,z.Test),function(e){e.Small="small",e.Medium="medium",e.Large="large"}(K||(K={}));const Y=e=>{const{category:t,size:n}=e;let i=V;if(n===K.Small?i=H:n===K.Large&&(i=W),(null==t?void 0:t.isUserDefined)||!(null==t?void 0:t.title))return a.createElement(z.DocumentBlank,null);const r=null==t?void 0:t.title,s=i.get(r);return s?a.createElement(s,null):a.createElement(z.DocumentBlank,null)},J=e=>{const{optionData:t,selectorData:n}=e,i=_();return a.createElement("div",{className:i.wrapper},a.createElement("div",{className:i.iconWrapper},a.createElement(Y,{category:t.column.gradebookCategory,size:K.Medium})),a.createElement("span",{className:i.columnName},a.createElement(h,{stringToSearch:t.label,searchString:n.inputValue,highlightStyle:i.highlight})))},Z=(e,t)=>f.Yb.gradebookColumn.getGradebookColumnViewStatusByQuery(e,t),Q=(e,t)=>{const n=e.getState(),a=Z(n,t);return{columns:f.Yb.gradebookColumn.getGradebookColumnsByQuery(n,t),view:a}},X=[{field:f.x.ColumnName,direction:c.Wb.Ascending}],ee=(e,t,n=!1,a)=>(null==e?void 0:e.length)>=a?[]:t.reduce(((e,t)=>((t.externalGrade&&n||!t.externalGrade)&&e.push({value:t.id,column:t,label:t.columnName}),e)),[]),te=(e,t,n,i)=>{const r=Object(b.f)(),s=a.useCallback(C()((async n=>{const{columns:a}=await(async(e,t)=>{const n=e.getState(),a=Z(n,t);return a&&a.isValid&&!a.isLoading?Q(e,t):(0,e.dispatch)(f.V.gradebookColumn.loadGradebookColumnsByQuery(t)).then((()=>Q(e,t)))})(r,{courseId:e,filter:{name:n},paging:{limit:t},sort:X});return i(a)}),500),[e,t,i]);return a.useCallback(((e,t)=>{s(e).then((e=>{t(e)}))}),[s])},ne=Object(r.a)((e=>{const{inputId:t,analyticsId:n,localize:i,courseId:r,placeholder:c,onColumnSelectionChanged:d,disabled:u,allowExternalGradeColumns:m,selectedColumns:p,selectionLimit:h,label:g}=e,b=a.useCallback((e=>ee(p,e,m,h)),[p,h]),{columns:f,totalColumns:v,loadPickerColumnsCallback:y}=((e,t,n)=>{var a,i;const r=E(50,t.length,10),s=te(e,r,0,n),{gradebookColumns:o,view:c}=Object(l.o)({courseId:e,paging:{limit:r},sort:X}),d=((e,t)=>{const n=t.map((e=>e.id));return e.filter((e=>!n.includes(e.id))).slice(0,50)})(o,t);return{columns:d,totalColumns:null!==(i=null===(a=null==c?void 0:c.paging)||void 0===a?void 0:a.count)&&void 0!==i?i:0,loadPickerColumnsCallback:s}})(r,p,b),S=ee(p,f,m,h),C=a.useCallback(((e,t)=>"menu"===t.context?a.createElement(J,{optionData:e,selectorData:t}):a.createElement("span",null,e.label)),[]),I=((e=[],t=!1)=>e.reduce(((e,n)=>(n.externalGrade&&!t||e.push({value:n.id,column:n,label:n.columnName}),e)),[]))(p,m),k={inputId:t,analyticsId:`${n}.columnsPicker`,"aria-label":c,className:"js-columns-picker",defaultValue:I,value:I,formatOptionLabel:C,isClearable:!0,isDisabled:u,noOptionsMessage:()=>(null==p?void 0:p.length)>=h?i.translate("course.learn-data-components.gradebook-columns-picker.noResultsMax"):i.translate("course.learn-data-components.gradebook-columns-picker.noResults"),label:g,removeTagAriaLabel:e=>{const t=e.label.props.children;return i.translate("course.learn-data-components.removeItem",{selectedLabel:t})},clearInputTooltipLabel:i.translate("course.learn-data-components.clearAll"),onChange:e=>{var t;return d(null!==(t=null==e?void 0:e.map((e=>e.column)))&&void 0!==t?t:[])},placeholder:c,styles:{input:e=>({...e,...o})}};return v>50?a.createElement(s.AnalyticsAsyncPicker,{tabSelectsValue:!1,isMulti:!0,loadOptions:y,defaultOptions:S,...k}):a.createElement(s.AnalyticsTagPicker,{options:S,...k})}));var ae=n("6Wru");const ie=Object(u.makeStyles)((e=>Object(u.createStyles)({root:{display:"flex",flexDirection:"column",width:"100%","& bdi,span":{flip:!1,overflow:"hidden",direction:e.direction,textOverflow:"ellipsis",whiteSpace:"nowrap",display:"block"}},userFlex:{display:"flex",alignItems:"center"},userAccommodation:{color:e.palette.brand.main,marginInlineEnd:"5px"},userPronunciation:{display:"flex",width:"100%"},userPronunciationAudio:{flexDirection:"row","& $pronunciationAudio":{"& button":{minWidth:0,minHeight:0,padding:"0 5px"}}},pronouns:{"&$pronouns$pronouns":{display:"block",fontWeight:e.typography.fontWeightRegular}},pronunciation:{"&$pronunciation$pronunciation":{display:"flex",alignItems:"center",margin:"0 -5px","& > span":{padding:"0 5px",fontWeight:e.typography.fontWeightRegular}}},pronunciationAudio:{},subtext:{color:e.palette.text.secondary,lineHeight:"18px",fontSize:e.typography.fontSizeSmall,fontWeight:e.typography.fontWeightRegular}})));var re=n("AuQm"),se=n("RPob");const oe="othername_as_display_name_option",le=e=>{var t,n,i,r,s;const{user:o,format:c,ariaHidden:d,showPronouns:u,subtext:m,showPronunciation:p,showAccommodation:h,userNameStyles:g}=e,{translate:b,formatUsername:f}=Object(ae.a)(),v=Object(l.z)(oe),y=o&&v?Object(se.m)(o,v):void 0,S=[o,c,null==o?void 0:o.id,null==o?void 0:o.title,null==o?void 0:o.givenName,null==o?void 0:o.familyName,null==o?void 0:o.otherName,null==o?void 0:o.email,null===(t=null==o?void 0:o.ui)||void 0===t?void 0:t.anonymousStudent,null===(n=null==o?void 0:o.ui)||void 0===n?void 0:n.anonymousStudentId,null==o?void 0:o.pronouns,null==o?void 0:o.pronunciation,null==o?void 0:o.pronunciationAudio,y],C=a.useMemo((()=>{if(o){const e={...o,preferredDisplayName:y};return f(e,c,{noWrap:!0})}return""}),S),E=ie();if(!o)return a.createElement(a.Fragment,null);const I={[E.userFlex]:h||p&&(null===(i=o.pronunciationAudio)||void 0===i?void 0:i.permanentUrl),[E.userPronunciationAudio]:p&&(null===(r=o.pronunciationAudio)||void 0===r?void 0:r.permanentUrl)};return a.createElement("div",{className:E.root},a.createElement("div",{className:Object(P.a)(E.userPronunciation,I,g)},h&&a.createElement(N.Accommodations,{className:E.userAccommodation,titleAccess:b("cr.components.username.accommodationAriaLabel")}),a.createElement("bdi",{"aria-hidden":d},C),p&&(null===(s=o.pronunciationAudio)||void 0===s?void 0:s.permanentUrl)&&a.createElement(re.D,{className:Object(P.a)(E.pronunciationAudio),analyticsId:"username.pronunciation",src:o.pronunciationAudio.permanentUrl,ariaLabel:b("cr.components.username.pronunciationAriaLabel")})),p&&o.pronunciation&&a.createElement("bdi",{className:Object(P.a)(E.pronunciation,e.pronunciationStyles)},a.createElement("span",{"aria-hidden":d},o.pronunciation)),u&&o.pronouns&&a.createElement("bdi",{"aria-hidden":d,className:Object(P.a)(E.pronouns,e.pronounsStyles)},o.pronouns),m&&a.createElement("span",{"aria-hidden":d,className:Object(P.a)(E.subtext,"username-subtext")},m))},ce=Object(u.makeStyles)((e=>Object(u.createStyles)({userCardPreview:{display:"flex",border:`1px solid ${e.palette.border.main}`,borderRadius:"2px",padding:"13px 19px"},avatar:{width:"20%"},userInfo:{width:"80%"},userName:{fontSize:"16px",fontWeight:e.typography.fontWeightSemiBold,"& bdi":{whiteSpace:"initial"}}}))),de=e=>{const{givenName:t,familyName:n,otherName:i,pronunciation:r,pronunciationAudioUrl:o,preferredDisplayName:l,pronouns:c}=e,u=ce(),{formatUsername:m}=Object(ae.a)(),p={givenName:t,familyName:n,otherName:i,pronunciation:r,pronunciationAudio:{permanentUrl:o},preferredDisplayName:l,pronouns:c},h=m(p,d.ILocaleUsernameFormat.Short);return a.createElement("div",{className:u.userCardPreview},a.createElement("div",{className:u.avatar},a.createElement(s.AnalyticsAvatar,{size:"medium",alt:h})),a.createElement("div",{className:u.userInfo},a.createElement(le,{userNameStyles:u.userName,format:d.ILocaleUsernameFormat.Short,ariaHidden:!0,user:p,showPronouns:!0,showPronunciation:!0})))};function ue(e,t){return`${t?"organization.":"course."}${e}`}function me(){const{translate:e,formatItems:t}=Object(ae.a)(),n=Object(a.useCallback)((t=>{let n;n=t.length>1?e("components.directives.fileUpload.aria.multipleFiles.uploadStarted.plural",{filesCount:t.length}):e("components.directives.fileUpload.aria.singleFile.uploadStarted"),Object(se.t)(n)}),[e]),i=Object(a.useCallback)((n=>{let a;a=1===n.length?function(e,t){var n;return t.status===f.t.Complete?e("components.directives.fileUpload.aria.singleFile.uploadSuccessful"):t.status!==f.t.Failed||(null===(n=t.error)||void 0===n?void 0:n.errorType)?void 0:e("components.directives.fileUpload.aria.singleFile.uploadFailed")}(e,n[0]):function(e,t,n){const a=[],i=[];n.forEach((e=>{e.status===f.t.Failed?a.push(e.filename):e.status===f.t.Canceled&&i.push(e.filename)}));const r=n.length-i.length;if(!(r<=0))return a.length===r?e("components.directives.fileUpload.aria.multipleFiles.uploadFailed"):0===a.length?e("components.directives.fileUpload.aria.multipleFiles.uploadSuccessful.plural",{filesCount:r}):`${e("components.directives.fileUpload.aria.multipleFiles.uploadFinished.plural",{successfulFilesCount:r-a.length,filesCount:r})} ${e("components.directives.fileUpload.aria.multipleFiles.failedFiles.plural",{filesCount:a.length,filenameList:t(a,a.length,void 0)})}`}(e,t,n),a&&Object(se.t)(a)}),[e,t]);return{readUploadStarted:n,readUploadFinished:i}}const pe=(e,t)=>{const n=[];return t.forEach((t=>{const a=f.Yb.fileUpload.getGroupStatusById(e,t);a&&n.push(a)})),n};function he(e,t){return e===t||e.length===t.length&&e.every(((e,n)=>Object(b.c)(t[n],e)))}function ge(e,t){return e===t||e.length===t.length&&e.every(((e,n)=>{return(a=t[n])===(i=e)||a.groupId===i.groupId&&he(a.pendingUploads,i.pendingUploads)&&he(a.uploads,i.uploads);var a,i}))}const be=e=>{const t=(e=>Object(b.e)((t=>pe(t,e).map((({groupId:e,pendingUploads:n,uploads:a})=>{const i={groupId:e,pendingUploads:n,uploads:[]};return i.uploads=a.reduce(((e,n)=>{var a;const i=f.Yb.fileUpload.getFileUploadById(t,n);return i&&e.push({correlationId:n,filename:null!==(a=i.filename)&&void 0!==a?a:"",status:i.status,error:i.error}),e}),[]),i}))),ge))(e.current),n=me();return Object(a.useEffect)((()=>{if(0===t.length)return;const a=[];t.forEach((e=>{0===e.pendingUploads.length&&a.push(e)})),a.forEach((e=>{n.readUploadFinished(e.uploads)})),a.forEach((t=>{e.current.delete(t.groupId)}))}),[t,n.readUploadFinished,n.readUploadStarted]),Object(a.useCallback)(((t,a)=>{e.current.add(t),n.readUploadStarted(a)}),[n.readUploadStarted])};function fe(e,t){return e===t||e.length===t.length&&e.every(((e,n)=>{return(a=t[n])===(i=e)||a.groupId===i.groupId&&he(a.oversizedFiles,i.oversizedFiles);var a,i}))}const ve=e=>Object(b.e)((t=>pe(t,e).reduce(((e,{groupId:t,oversizedFiles:n})=>(n.length>0&&e.push({groupId:t,oversizedFiles:n}),e)),[])),fe);var ye=n("caKH"),Se=n("YK4x");const Ce=e=>{const{processError:t,isCloudUpload:n,errorCode:r,filename:o}=e,[l,c]=Object(a.useState)(!1),d=Object(Se.a)(),m=()=>{c(!1),t()},p=function(e,t,n){return e?t?"components.directives.cloudStorageIntegration.modal.generalError":"components.directives.cloudStorageIntegration.modal.generalErrorWithoutName":t?422===n?"components.directives.fileUpload.securityError":"components.directives.fileUpload.generalError":422===n?"components.directives.fileUpload.securityErrorWithoutName":"components.directives.fileUpload.generalErrorWithoutName"}(n,o,r);return i.a.createElement(ye.a,{analyticsId:p,"aria-labelledby":"upload-error-dialog-heading-id",onClose:()=>m(),open:!l,TransitionProps:{onExited:m}},i.a.createElement(u.DialogTitle,{id:"upload-error-dialog-heading-id","aria-describedby":"upload-error-dialog-message-id",onClose:()=>m()},d("components.directives.fileUpload.errorTitle")),i.a.createElement(u.DialogContent,null,i.a.createElement(u.DialogContentText,{id:"upload-error-dialog-message-id"},d(p,{filename:o}))),i.a.createElement(u.DialogActions,null,i.a.createElement(s.AnalyticsPrimaryButton,{analyticsId:"components.directives.fileUpload.cancelUploadText.button",onClick:()=>m()},d("components.directives.fileUpload.cancelUploadText"))))},Ee=Object(u.makeStyles)((()=>({oversizedFileList:{maxHeight:"140px",overflowY:"auto"}}))),Ie=e=>e/1048576,ke=e=>{const{uploadIds:t,exitCallback:n}=e,[i,r]=Object(a.useState)(!1),[o,c]=Object(a.useState)(!1),d=Object(Se.a)(),m=Ee(),p=Object(l.m)(),h=Object(b.e)((e=>t.map((t=>f.Yb.fileUpload.getFileUploadById(e,t)))),b.c),g=(e=!1)=>{c(e),r(!0)};if(0===h.length)return null;let v;return v=(null==p?void 0:p.displayRecommendedAlternatives)?d("components.directives.fileUpload.maxSizeWarningAlternateStorage",{alternateStorage:null==p?void 0:p.recommendedAlternatives}):d("components.directives.fileUpload.maxSizeWarningNoAlternateStorage"),a.createElement(ye.a,{isAlert:!0,analyticsId:"components.directives.fileUpload.maxSizeWarningPrimary","aria-labelledby":"max-file-size-dialog-heading-id",open:!i,TransitionProps:{onExited:()=>{n(o)}},onClose:()=>g(!0)},a.createElement(u.DialogTitle,{onClose:()=>g(!0),id:"max-file-size-dialog-heading-id","aria-describedby":"max-file-size-dialog-message-id"},d("components.directives.fileUpload.maxSizeWarningTitle")),a.createElement(u.DialogContent,null,a.createElement(u.DialogContentText,{id:"max-file-size-dialog-message-id"},d("components.directives.fileUpload.maxSizeWarningMessage",{maxFileSize:Ie(null==p?void 0:p.maxUploadSizeInBytes)})),a.createElement("div",{className:m.oversizedFileList},a.createElement("ul",null,h.map(((e,n)=>a.createElement("li",{key:t[n]},d("components.directives.fileUpload.maxSizeWarningFiles",{fileName:e.filename,fileSize:Ie(e.filesize)})))))),a.createElement(u.DialogContentText,null,v,(null==p?void 0:p.displaySupportLink)&&a.createElement(a.Fragment,null,"",a.createElement("span",{dangerouslySetInnerHTML:{__html:d("components.directives.fileUpload.maxSizeWarningSupportLinkText",{supportLink:null==p?void 0:p.supportLink})}})))),a.createElement(u.DialogActions,null,a.createElement(s.AnalyticsPrimaryButton,{analyticsId:"components.directives.fileUpload.maxSizeWarningPrimary",onClick:()=>g(!0)},d("components.directives.fileUpload.maxSizeWarningPrimary"))))};var we=n("69Wd"),Te=n("me+T"),Oe=n("5ikY"),Ae=n("cXGx"),Pe=n("4iFr"),xe=n("MlM1"),$e=n("6/tG"),Ne=n("IL+z"),De=n("OhrW"),Le=n("xQgz"),je=n("K16Q"),Me=n("r7jL"),Ge=n("BY8f"),Re=n("3yh1"),Be=n("36Bh"),Fe=n("13AT"),Ue=n("y8aX"),_e=n("i+uu"),ze=n("k6dK"),qe=n("MTZf"),He=n("Ul6e"),Ve=n("SBxA"),We=n("RrOo"),Ke=n("wnlu"),Ye=n("Uw7Y"),Je=n("FvSu"),Ze=n("TE6g"),Qe=n("U21b");function Xe(e){return e.replace(/^img-icon-/,"")}function et(e){switch(Xe(e)){case c.v.Assignment:return we.a;case c.v.Attendance:return Te.a;case c.v.Audio:return Je.a;case c.v.Blog:return Oe.a;case c.v.Course:return Qe.a;case c.v.Calculation:return Ae.a;case c.v.Discussion:return Pe.a;case c.v.DocumentBlank:return xe.a;case c.v.DocumentCloud:return $e.a;case c.v.CollaborativeCloud:return Ne.a;case c.v.Document:return De.a;case c.v.Folder:case c.v.FolderOpen:return Le.a;case c.v.Homework:return je.a;case c.v.Journal:return Ge.a;case c.v.LearningModule:return Re.a;case c.v.Link:return Be.a;case c.v.LTI:return Fe.a;case c.v.OverallGrade:return Ue.a;case c.v.Pdf:return _e.a;case c.v.Photo:return Me.a;case c.v.Presentation:return ze.a;case c.v.Scorm:return qe.a;case c.v.Spreadsheet:return He.a;case c.v.Survey:return Ve.a;case c.v.Test:case c.v.Quiz:case c.v.Exam:return We.a;case c.v.Textbook:return Ke.a;case c.v.Video:return Ye.a;case c.v.Zip:return Ze.a;default:return xe.a}}function tt(e,t){var n,a,i,r,s,o,l,d,u;const m=f.j.getContentHandler(e);if(f.i.File.isEqualTo(m)){const t=null===(i=null===(a=null===(n=e.contentDetail)||void 0===n?void 0:n[c.t.File])||void 0===a?void 0:a.file)||void 0===i?void 0:i.mimeType;if(t)return et(Object(f.yb)(t))}if(f.j.isFolderContentItem(e)&&"ROOT"===e.title&&null==e.parentId)return et(c.v.Course);if(f.i.LtiLink.isEqualTo(m)&&"CloudDocument"===(null===(s=null===(r=e.contentDetail)||void 0===r?void 0:r[c.t.LtiLink])||void 0===s?void 0:s.itemOrigin)){return f.C.getCloudDocumentType(e)===c.yb.CloudCollaboration?et(c.v.CollaborativeCloud):et(c.v.DocumentCloud)}if(void 0!==t.gradebookColumn&&(m.isEqualTo(f.i.TestLink.handle)||m.isEqualTo(f.i.Unknown.handle)||m.isEqualTo(f.i.RusticiScorm.handle)||m.isEqualTo(f.i.LtiLink.handle)||m.isEqualTo(f.i.PartnerCloud.handle)||m.startsWith(f.i.LtiPlacement.handle))){if(null===(o=t.gradebookColumn.gradebookCategory)||void 0===o?void 0:o.isUserDefined)return et("custom-item");const e=null===(d=null===(l=t.gradebookColumn.gradebookCategory)||void 0===l?void 0:l.title)||void 0===d?void 0:d.substring(0,null===(u=t.gradebookColumn.gradebookCategory)||void 0===u?void 0:u.title.lastIndexOf(".name")).toLowerCase();if(e)return et(e)}return et(m.iconClass.replace(/^img-icon-/,""))}function nt(e){return`components.directives.element-image.element-image-accessibility.img-icon-${Xe(e)}`}function at(e){var t,n,a,i;let r=f.j.getContentHandler(e).iconClass;return f.i.File.isEqualTo(null===(t=e.contentHandler)||void 0===t?void 0:t.toString())&&(r=Object(f.zb)(null===(i=null===(a=null===(n=e.contentDetail)||void 0===n?void 0:n[c.t.File])||void 0===a?void 0:a.file)||void 0===i?void 0:i.mimeType)),nt(r)}const it=Object(u.makeStyles)((e=>({brokenLtiLink:{color:e.palette.error.main},customIcon:{width:"24px",minWidth:"24px"}})));const rt=({className:e,item:t,withLabel:n=!0})=>{var a,r,s;const o=Object(Se.a)(),d=it(),u=Object(b.e)((e=>{if(t.id)return f.Yb.gradebookColumn.getGradebookColumnByContentId(e,t.id)})),m=Object(l.a)(null!==(a=t.courseId)&&void 0!==a?a:"",null===(s=null===(r=t.contentDetail)||void 0===r?void 0:r[c.t.CourseLink])||void 0===s?void 0:s.linkSourceId),p=f.j.canViewAsInstructor(t)&&f.C.isUnlaunchableLtiLink(t),h=function(e){var t,n;return null===(n=null===(t=e.contentDetail)||void 0===t?void 0:t[c.t.LtiLink])||void 0===n?void 0:n.customIconUrl}(t);if(h)return i.a.createElement("img",{src:Object(se.d)(h),alt:"",className:d.customIcon});const g=tt(null!=m?m:t,{gradebookColumn:u}),v=o(at(null!=m?m:t));return i.a.createElement(g,{className:Object(P.a)(e,{[d.brokenLtiLink]:p}),titleAccess:n?v:void 0})};function st(e){return et(Object(f.zb)(e))}const ot=(e,t)=>{var n,a;const i=Object(Se.a)(),r=Object(l.a)(e,null===(a=null===(n=t.contentDetail)||void 0===n?void 0:n[c.t.CourseLink])||void 0===a?void 0:a.linkSourceId);return i(at(null!=r?r:t))};n.d(t,"c",(function(){return O})),n.d(t,"b",(function(){return U})),n.d(t,"d",(function(){return ne})),n.d(t,"g",(function(){return oe})),n.d(t,"e",(function(){return le})),n.d(t,"i",(function(){return de})),n.d(t,"o",(function(){return ue})),n.d(t,"q",(function(){return be})),n.d(t,"r",(function(){return ve})),n.d(t,"h",(function(){return Ce})),n.d(t,"f",(function(){return ke})),n.d(t,"a",(function(){return rt})),n.d(t,"j",(function(){return nt})),n.d(t,"k",(function(){return tt})),n.d(t,"l",(function(){return st})),n.d(t,"m",(function(){return et})),n.d(t,"p",(function(){return ot})),n.d(t,"n",(function(){return o}))},"5Dl8":function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r}));var a=n("nsO7");function i(e){return e&&e/16+"rem"||"0"}class r{constructor(e){this.parent=e,this.curSelector=null,this.pool=null==e?{}:null}selector(e){const t=new r(this);return t.curSelector=e,t}rule(e,t){return this.subRule(null,e,t),this}build(){return a.map(this.pool,((e,t)=>{const n=[];return e.forEach((e=>n.push(e))),`${n.join(",")}{${t}}`})).join("\n")}subRule(e,t,n){const i=a.compact([this.curSelector,e]).join(" ");if(null!=this.parent)this.parent.subRule(i,t,n);else{const e=`${t}:${n}`;this.pool[e]=this.pool[e]||new Set,this.pool[e].add(i)}}}},"5KgE":function(e,t,n){"use strict";var a=n("D57K"),i=n("Llzl"),r=n("w9Zy"),s=n("Fvsw"),o=n("Qbdf"),l=n("lEL+"),c=n("aHpC"),d=n("g66W"),u=n("5MwF"),m=n("wDWF");const p=u.a.features.devtools_disableFtue?-1:2,h="ftue.",g=".visited",b="hide",f="show";class v{constructor(e,t,n,a){this.$q=e,this.context=t,this.offCanvas=n,this.contextCourse=a}shouldShow(e,t,n){return u.a.disableAllFtueGuidance?this.$q.when(!1):n?this.$q.when(this.isShownInCurrentSession(e)):this.$q.all([this.offCanvas.getElement(t),this.offCanvas.getTopElement(),this.getSessionNumber(e)]).then((t=>{const n=t[0],a=t[1],i=t[2];return a&&n!==a?this.$q.when(!1):this.shouldShowImpl(e,i)}))}shouldShowImpl(e,t){if(t>p)return this.$q.when(!1);if(this.isLastSessionCurrent(e))return this.$q.when(this.isShownInCurrentSession(e));const n=++t<=p;return sessionStorage.setItem(this.getSessionStorageKey(e),n?f:b),this.setSessionNumber(e,t).then((()=>n)),this.$q.when(n)}hide(e,t){sessionStorage.setItem(this.getSessionStorageKey(e),b),t&&this.getSessionNumber(e).then((t=>{this.setSessionNumber(e,++t)}))}getSessionNumber(e){const t=h+e+g;if(!this.isPredictComponent(e)){const e=e=>{const t=parseInt(e.value,10);return Number.isNaN(t)?0:t};return this.context.getPreference(t,"0").then(e)}return this.context.getPredictPreference(t,"0").then((e=>{const t=parseInt(e.value,10);return Number.isNaN(t)?p:t}))}isLastSessionCurrent(e){const t=sessionStorage.getItem(this.getSessionStorageKey(e));return t===f||t===b}isShownInCurrentSession(e){return sessionStorage.getItem(this.getSessionStorageKey(e))!==b}setSessionNumber(e,t){const n=h+e+g;return this.isPredictComponent(e)?this.context.setPredictPreference(n,t.toString()):this.context.setPreference(n,t.toString())}getSessionStorageKey(e){return h+e+".show."+m.a(this.context.sessionId)}isPredictComponent(e){return!!e&&0===e.toLowerCase().indexOf("predict.")}}class y extends v{shouldShowImpl(e,t){return this.courseId=this.contextCourse.courseId&&this.contextCourse.courseId.replace(/_/g,"."),this.getSessionNumber(e+this.courseId).then((n=>{if(t>p&&n>1)return this.$q.when(!1);if(this.isLastSessionCurrent(e+this.courseId))return this.$q.when(this.isShownInCurrentSession(e)||this.isShownInCurrentSession(e+this.courseId));let a=!1,i=!1;t++,n++,a=t<=p,sessionStorage.setItem(this.getSessionStorageKey(e),a?f:b),i=n<=1,sessionStorage.setItem(this.getSessionStorageKey(e+this.courseId),i?f:b);const r=[];return t<=p+1&&r.push(this.setSessionNumber(e,t)),n<=2&&r.push(this.setSessionNumber(e+this.courseId,n)),this.$q.all(r).then((()=>a||i)),this.$q.when(a||i)}))}hide(e){sessionStorage.setItem(this.getSessionStorageKey(e),b),this.courseId||(this.courseId=this.contextCourse.courseId&&this.contextCourse.courseId.replace(/_/g,".")),sessionStorage.setItem(this.getSessionStorageKey(e+this.courseId),b)}}n.d(t,"b",(function(){return S})),n.d(t,"c",(function(){return C})),n.d(t,"a",(function(){return E}));const S="ultra.service.firstTimeHelper",C="firstTimeHelper",E=/[_-]/g;let I;const k=Symbol("default");let w=class{constructor(e){this.timeout=e,this.TIME_TO_SHOW_FIRST_BUTTON=5e3}shouldShow(e,t,n){return this.convertAngularPromise((I.get(e)||I.get(k)).shouldShow(e,t,n))}hasBeenShown(e){return(I.get(e)||I.get(k)).getSessionNumber(e).then((e=>e>0))}hide(e,t){(I.get(e)||I.get(k)).hide(e,t)}fadeAddContentButton(e,t,n){this.shouldShow(t,n).then((t=>{const n=e.$on("add-content-button-ready",(()=>{const a=t?this.TIME_TO_SHOW_FIRST_BUTTON:0;n(),this.timeout((()=>{e.$broadcast("always-show-time-expires")}),e,a)}))}))}hasMultiTargetSupport(e){return!!e&&0===e.toLowerCase().indexOf("predict.")}convertAngularPromise(e){return new Promise(((t,n)=>{e.then(t).catch(n)}))}};w=Object(a.a)([Object(a.c)(0,Object(c.b)(l.b))],w);i.module(S,[s.a,o.b,r.d]).run(["$q",s.b,o.e,r.e,(e,t,n,a)=>{const i=new y(e,t,a,n),r=new v(e,t,a,n);var s;I=(new Map).set((s="components.features.course.content.assessment.ftue.group-conversation",d.a(s,E)),i).set(k,r)}]).service(C,w)},"5RJJ":function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d}));var a=n("Llzl"),i=n("yC9S"),r=n("oVrE"),s=n("PdQf"),o=n("pjml"),l=n("zGdY");const c="ultra.service.courseMembership",d="courseMembership";class u{constructor(e,t,n,a){this.$q=e,this.$rootScope=t,this.CourseModel=n,this.CourseMembershipModel=a,this.userCourseAvailabilities={},this.msgToolAvailability={},this.fetchToolAvailabilityPromiseCache={},i.b.OnRootScope(this.$rootScope,"membership.update",((e,t,n,a,i,r,s,o)=>{this.getUserCourseAvailabilities(o).then((()=>{this.userCourseAvailabilities[o][s.id]=t.isAvailable}))})),i.b.OnRootScope(this.$rootScope,"deleteMembership",((e,t,n,a)=>{this.getUserCourseAvailabilities(a).then((()=>{this.userCourseAvailabilities[a][t.id]=!1}))})),i.b.OnRootScope(this.$rootScope,"roster.enroll.new.membership",((e,t,n,a)=>{this.getUserCourseAvailabilities(n).then((()=>{this.userCourseAvailabilities[n][a]=t.isAvailable}))}))}getUserCourseAvailabilities(e){if(this.userCourseAvailabilities[e])return this.$q.when(this.userCourseAvailabilities[e]);const t=this.$q.defer();return this.userCourseAvailabilities[e]={},this.CourseModel.$new(e).memberships.$refresh().$then((n=>{n.forEach((t=>{this.userCourseAvailabilities[e][t.userId]=t.isAvailable})),this.userCourseAvailabilities[e][s.d()]=!0,this.userCourseAvailabilities[e][r.c()]=!1,t.resolve(this.userCourseAvailabilities[e])})),t.promise}getMsgToolAvailability(e,t){if(!e)return;if(t||null==this.msgToolAvailability[e.id]){if(!e.isUltra()){let t=this.fetchToolAvailabilityPromiseCache[e.id];return t||(t=e.tools.$find("messages").$asPromise().then((t=>(this.msgToolAvailability[e.id]=t.isVisible,t.isVisible)),(e=>{console.error("Fetch ToolAvailability error!")})).finally((()=>{delete this.fetchToolAvailabilityPromiseCache[e.id]})),this.fetchToolAvailabilityPromiseCache[e.id]=t,t)}this.msgToolAvailability[e.id]=!0}const n=this.$q.defer();return n.resolve(this.msgToolAvailability[e.id]),n.promise}isUserCourseAvailable(e,t){return this.userCourseAvailabilities[e][t]}createGuestMembership(e,t){return this.CourseMembershipModel.$build({userId:t.id,course:e,user:t,role:l.V.Guest})}}u.$inject=["$q","$rootScope",o.m.serviceName,o.t.serviceName];a.module(c,[o.N]).service(d,u)},"5uPl":function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return p}));var a=n("D57K"),i=n("nsO7"),r=n("Llzl"),s=n("pjml"),o=n("0JpG"),l=n("Q/M7"),c=n("vJBG"),d=n("aHpC"),u=n("3PCF");const m="ultra.service.originalityReport",p="originalityReport";let h=class{constructor(e,t){this.localize=e,this.$q=t,this.columnOriginalityAverageScoreDict={}}setCourseContent(e,t){this.courseContent=e,this.isPrivileged=t}clearCourseContent(){this.courseContent=void 0,this.isPrivileged=void 0}updateReport(e,t,n){this.columnId=n,this.attempt=e,this.openOriginalityReport=!0,this.shouldFetchOriginality()&&(t&&(this.gradedQuestionAttempts=t.map((e=>i.pick(e,["questionAttempt.question.position","questionAttempt.visibleQuestionNumber"])))),this.fetchOriginality())}clearReport(){this.gradedQuestionAttempts=void 0,this.attempt=void 0,this.originality=void 0,this.openOriginalityReport=void 0,this.columnId=void 0,this.reports=void 0,this.personalMaxScore=void 0,this.personalMaxScoreReportName=void 0,this.personalAverageScore=void 0,this.classAverageScore=void 0}isSafeAssignEnabled(e){var t;return!!(null===(t=null!=e?e:this.courseContent)||void 0===t?void 0:t.isSafeAssignEnabled())}retrieveOriginalityIntegration(e){var t;const n=e||this.courseContent;return n?(this.setCourseContent(n,!0),this.$q.when(c.a.fetchDefaultOriginalityReportSubmissionService(n.courseId,null===(t=n.getAssociatedGradingColumn())||void 0===t?void 0:t.id)).then((e=>(this.defaultOriginalityIntegrationService=e,this.portalIntegrationId=this.getOriginalityIntegrationByUniqueId(null==e?void 0:e.uniqueHandle),e)))):this.$q.resolve(void 0)}fetchIsOriginalityIntegrationEnabled(e){return this.retrieveOriginalityIntegration(e).then((e=>e?this.isOriginalityIntegrationEnabled():this.$q.resolve(!1)))}fetchIsOriginalityEnabled(e){return this.fetchIsOriginalityIntegrationEnabled(e).then((e=>e))}isOriginalityIntegrationEnabled(){var e,t;const n=this.defaultOriginalityIntegrationService;return!!(null===(t=null===(e=null==n?void 0:n.capabilities)||void 0===e?void 0:e.OriginalityReport)||void 0===t?void 0:t.enabled)}saveOriginalityConfiguration(e){return this.$q.when(c.a.saveOriginalityConfiguration(this.courseContent,e))}isOriginalityReportEnabled(){return this.defaultOriginalityIntegrationService&&this.defaultOriginalityIntegrationService.uniqueHandle!==u.b?this.isOriginalityIntegrationEnabled():this.isSafeAssignEnabled()}getCurrentOriginalityReportProviderType(e){return e?e.uniqueHandle===u.b?u.a.SafeAssign:u.a.Integration:u.a.None}getOriginalityDisplayName(){var e;return null===(e=this.defaultOriginalityIntegrationService)||void 0===e?void 0:e.displayName}isOriginalityReportProviderActive(){return this.getCurrentOriginalityReportProviderType(this.defaultOriginalityIntegrationService)!==u.a.None}isSafeAssignActiveOriginalityProvider(){return this.getCurrentOriginalityReportProviderType(this.defaultOriginalityIntegrationService)===u.a.SafeAssign}isIntegrationActiveOriginalityProvider(){return this.getCurrentOriginalityReportProviderType(this.defaultOriginalityIntegrationService)===u.a.Integration}getOriginalityReportLinkAnalyticsId(){var e;const t=null===(e=this.defaultOriginalityIntegrationService)||void 0===e?void 0:e.uniqueHandle;return t?`course.content.originalityReport.settings.${t}.link`:"course.content.originalityReport.settings.link"}getOriginalityReportLinkText(e){const t=this.defaultOriginalityIntegrationService,n=null==t?void 0:t.displayName;return n?this.isOriginalityReportEnabled()?this.localizeProviderLinkText("course.content.originalityReport.settings.providerEnabled",n):e?this.localizeProviderLinkText("course.content.originalityReport.settings.enableProvider",n):this.localizeProviderLinkText("course.content.originalityReport.settings.providerDisabled",n):this.localize.translateSync({locale:this.localize.getAppLocale(),key:"course.content.originalityReport.settings.originalityDisabled",noWrap:!0})}localizeProviderLinkText(e,t){return this.localize.translateSync({locale:this.localize.getAppLocale(),key:e,noWrap:!0,params:{originalityProvider:t},noEscape:!0})}canStudentViewReports(){return this.courseContent&&this.courseContent.canStudentViewReports()}isReportSectionOpen(){var e;return this.openOriginalityReport&&((null===(e=this.originality)||void 0===e?void 0:e.canShowReportPanel())||this.isOriginalityIntegrationEnabled())}shouldFetchOriginality(){return this.isPrivileged&&this.isSafeAssignEnabled()||!this.isPrivileged&&this.canStudentViewReports()}setOriginalityAverageScore(e,t){let n=0,a=0;e.forEach((e=>{e.originalityProcessed&&!i.isUndefined(e.originalityScore)&&(n+=1,a+=e.originalityScore)})),n&&(this.columnOriginalityAverageScoreDict[t]=a/n)}fetchOriginality(){const e=this.attempt;e.originality.$fetch().$then((t=>{this.attempt===e&&(this.originality=t,this.generateReport())}))}hasValidReports(){return this.reports&&this.reports.some((e=>!e.invalid))}generateReport(){const e=this.originality.answerOriginalities;if(this.gradedQuestionAttempts){const t=()=>this.gradedQuestionAttempts.some(((e,t)=>e.questionAttempt.question.position!==t+1));if(this.isPrivileged&&t()){const t=i.sortBy(this.gradedQuestionAttempts,(e=>e.questionAttempt.question.position)),n=[];i.map(t,"questionAttempt.visibleQuestionNumber").forEach(((e,t)=>n[e-1]=t)),e.forEach((e=>e.order=n[e.order-1]+1)),e.sort(((e,t)=>e.order-t.order))}}this.reports=i.flatMap(e,(e=>e.attachments.map((t=>({...t,isQuestionAnswerContent:!0,visibleQuestionNumber:e.order}))))),this.originality.attemptOriginality&&this.reports.push(...this.originality.attemptOriginality.attachments),this.hasValidReports()&&this.calculateScore()}calculateScore(){const e=this.reports.filter((e=>!e.invalid));let t=0;this.personalMaxScore=e[0].score,this.personalMaxScoreReportName=e[0].name,e.forEach((e=>{e.reportLink=Object(l.c)(e.reportLink),this.personalMaxScore<e.score&&(this.personalMaxScore=e.score,this.personalMaxScoreReportName=e.name),t+=e.score})),this.personalAverageScore=Math.floor(t/e.length),i.isUndefined(this.columnOriginalityAverageScoreDict[this.columnId])||(this.classAverageScore=Math.floor(this.columnOriginalityAverageScoreDict[this.columnId]))}getOriginalityIntegrationByUniqueId(e){var t;return null===(t=c.a.getOriginalityIntegrationByUniqueId(e))||void 0===t?void 0:t.integrationId}};h=Object(a.a)([Object(a.c)(0,Object(d.b)(o.serviceName)),Object(a.c)(1,Object(d.b)("$q"))],h);r.module(m,[s.N]).service(p,h)},"65PF":function(e,t){e.exports='<td class="table-cell"\n    ng-show="tableCell.column.visible">\n  <div class="sr-only alternate-contents"></div>\n  <div class="transclude-container"></div>\n</td>\n'},"67oV":function(e,t,n){var a=n("ziER"),i=n("5JeM"),r=new a({id:"icon-small-close",use:"icon-small-close-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-close"><path d="M15 1L1 15M1 1l14 14" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(r);e.exports=r},"6BRP":function(e,t,n){var a=n("ziER"),i=n("5JeM"),r=new a({id:"icon-small-attention",use:"icon-small-attention-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-attention"><rect x="1" y="1" width="14" height="14" rx="7" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><path d="M8 4v5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><circle cx="8" cy="12" r=".5" /></symbol>'});i.add(r);e.exports=r},"6Ksg":function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return d}));var a=n("71td"),i=n("Llzl"),r=n("nsO7"),s=n("0JpG");const o="ultra.directives.validate.bbmlmarkup",l={img:["id"]};class c{constructor(e,t){this.$q=e,this.$http=t,this.whitelist=null,this.whitelistInitializer=null,this.require="ngModel",this.restrict="A",this.initialWhitelist=()=>(null===this.whitelistInitializer&&(this.whitelistInitializer=this.$http.get("/learn/api/v1/utilities/bbml/whitelist").then((e=>{this.whitelist={};const t=(e.data[":all"]||[]).concat(l[":all"]||[]);r.forEach(e.data,((e,n)=>{const a={};r.each(e.concat(t,l[n]||[]),(e=>{a[e]=e})),this.whitelist[n]=a}))}),(()=>{this.whitelist=null}))),this.whitelistInitializer),this.validate=e=>{if(null===this.whitelist)return!0;if(1!==e[0].nodeType)return!0;const t=e[0].tagName.toLowerCase();if(!Object.prototype.hasOwnProperty.call(this.whitelist,t))return!1;const n=this.whitelist[t];return r.every(e[0].attributes,(e=>Object.prototype.hasOwnProperty.call(n,e.name.toLowerCase())))&&r.every(e.children(),(e=>this.validate(a(e))))},this.getValidator=(e,t,n,i)=>e=>{const n=this.$q.defer();return this.initialWhitelist().then((()=>{r.every(t.children(),(e=>this.validate(a(e))))?n.resolve():n.reject()})),n.promise},this.link=(e,t,n,a)=>{a.$asyncValidators.bbmlMarkup=this.getValidator(e,t,n,a)}}}c.$inject=["$q","$http"];class d extends c{}i.module(o,[s.moduleName]).directive("bbValidateBbmlMarkup",["$injector",e=>e.instantiate(c)])},"6fZB":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=e=>new Promise(((t,n)=>{e.then((e=>t(e))).catch((e=>n(e)))}))},"6jv3":function(e,t){e.exports='<div class="save-buttons">\n  <footer class="panel-footer" ng-if="!(hideCancel() || hideSave() || hideDelete())">\n    \x3c!--footer tag is removed, and its children appended to parent if the directive is marked as \'isInline\'--\x3e\n    <div ng-class="{\'inline\':isInline(), \'panel-footer-right\':!isInline()}" class="buttons-2 equal-buttons">\n      <button ng-if="!(hideDelete() != null ? hideDelete() : true)"\n              class="button js-delete js-primary-button non-first-focus" ng-class="{\'small clear icon\':isInline}"\n              bb-confirmation-needed="{{ deleteConfirmationResourceType }}"\n              show-type="{{mustShowDeleteConfirmation() ? \'always\' : \'userChoice\'}}"\n              ng-disabled="saveButtons.isDeleteDisabled()"\n              ng-click="saveButtons.deleteAction()"\n              ng-mousedown="saveButtons.mousedownAction()"\n              type="button"\n              choices="{{choices()}}"\n              analytics-id="{{::analyticsIdTagPrefix}}.autosave.saveButtons.delete.button">\n                <span ng-if="!isInline()">{{saveButtons.deleteButtonStatus}}</span>\n                <span ng-if="isInline()"><i class="icon-trash"></i></span>\n      </button>\n      <button ng-if="!hideCancel()"\n              class="button button--secondary js-cancel js-secondary-button non-first-focus"\n              bb-confirmation-needed="{{ saveButtons.isCancelNowADelete() ? deleteConfirmationResourceType : \'\' }}"\n              show-type="{{mustShowDeleteConfirmation() ? \'always\' : \'userChoice\'}}"\n              ng-disabled="saveButtons.isCancelDisabled()"\n              ng-click="saveButtons.cancelAction()"\n              ng-mousedown="saveButtons.mousedownAction()"\n              type="button"\n              choices="{{choices}}"\n              analytics-id="{{::analyticsIdTagPrefix}}.autosave.saveButtons.cancel.button">{{saveButtons.cancelButtonStatus}}</button>\n      <button ng-if="!hideSave()"\n              class="button js-save js-primary-button non-first-focus"\n              bb-confirmation-needed="{{ saveConfirmationResourceType }}"\n              show-type="{{mustShowSaveConfirmation() ? \'always\' : \'userChoice\'}}"\n              ng-disabled="saveButtons.isSaveDisabled()"\n              ng-click="saveButtons.saveAction()"\n              ng-mousedown="saveButtons.mousedownAction()"\n              type="submit"\n              analytics-id="{{::analyticsIdTagPrefix}}.autosave.saveButtons.save.button">{{saveButtons.saveButtonStatus}}</button>\n    </div>\n  </footer>\n</div>'},"6vR2":function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return s}));var a=n("nsO7"),i=n("IbyE");function r(e){const t=new Set;return JSON.parse(JSON.stringify(e,((e,n)=>{if("object"!=typeof n||!t.has(n))return"object"!=typeof n||t.add(n),n})))}function s(e){return Array.isArray(e)?e.map((e=>s(e))):Object(a.isPlainObject)(e)?Object(a.mapValues)(e,(e=>s(e))):Object(i.jb)(e)}},"6ynb":function(e,t,n){"use strict";class a extends Error{constructor(e){let t="string"==typeof e?e:"";e&&e.message&&(t=e.message),super(t),this.name="Exception",this.message=t,this.stack=(new Error).stack;const n=Error;e&&e.stack?this.stack=e.stack:n.captureStackTrace&&n.captureStackTrace(this,a)}}t.a=a},"7+Tq":function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return l}));var a=n("Llzl"),i=n("0+Qs"),r=n("XGja"),s=n("+4Px");const o="ultra.services.dropdownInit",l="dropdownInitService";a.module(o,[i.a]).factory(l,[i.b,t=>{const n=(e,t)=>{t.focus()};return(a,i)=>{a.find("[data-dropdown]").each(((a,o)=>{const l=e(o),c=l.attr("data-dropdown"),d=e("#"+c);if(!d.length)return;l.attr("aria-haspopup","true"),d.attr("role")||(d.attr("role","menu"),d.find("li a").each((function(){e(this).attr("role")||e(this).attr("role","menuitem")}))),d.off("keydown.fndtn.dropdown"),d.on("keydown.fndtn.dropdown",(e=>{if(d.hasClass("open")){let t,a=!0,i=d.find("li a:focus").closest("li");if(0===i.length&&(i=d.find(":focus"),a=!1),e.keyCode===s.g&&!d.hasClass("bb-foundation-dropdown-close-esc-override")||e.keyCode===s.u&&!d.hasClass("bb-foundation-dropdown-tab-override"))l.click(),e.keyCode===s.g&&(n(0,l),e.stopPropagation());else if(e.keyCode===s.d||e.keyCode===s.v||e.keyCode===s.u)return a?(e.keyCode===s.d||e.keyCode===s.u&&!e.shiftKey?(t=i.nextAll().not(".scroll-control").find(":tabbable").first().closest("li"),t&&0!==t.length||(t=d.find(":tabbable").closest("li").not(".scroll-control").first())):(e.keyCode===s.v||e.keyCode===s.u&&e.shiftKey)&&(t=i.prevAll().not(".scroll-control").find(":tabbable").last().closest("li"),t&&0!==t.length||(t=d.find(":tabbable").closest("li").not(".scroll-control").last())),t.length>0&&t.find(":tabbable").focus()):e.keyCode===s.d||e.keyCode===s.u&&!e.shiftKey?r.b(d,i):(e.keyCode===s.v||e.keyCode===s.u&&e.shiftKey)&&r.c(d,i),!1}}));let u=!0;d.off("keyup.fndtn.dropdown"),d.on("keyup.fndtn.dropdown",(t=>{if((t.keyCode===s.f||t.keyCode===s.t)&&!d.hasClass("bb-foundation-dropdown-enter-override")){if(!u)return u=!0,!1;if(e(t.target).closest("input[type=checkbox]").length)return!0;if(e(t.target).closest("button").length)return!0;if("-1"===e(t.target).attr("tabindex"))return!0;if(d.hasClass("open")){const e=d.find("li a:focus").closest("li");return e.length>0?e.find("a").click():l.click(),n(0,l),!1}}})),l.off("keydown.fndtn.dropdown"),l.on("keydown.fndtn.dropdown",(e=>{if((e.keyCode===s.f||e.keyCode===s.t)&&!d.hasClass("open")){l.click(),u=!1;let e=d.find("li a:focus").closest("li");return 0===e.length&&(e=d.find("li").not(".scroll-control").find(":tabbable").first().closest("li")),e.find("a:visible").length?e.find("a:visible").focus():d.find(":tabbable").first().focus(),!1}})),l.off("click.fndtn.dropdown"),l.on("click.fndtn.dropdown",(e=>{let n=d.find("li a:focus").closest("li");0===n.length&&(n=d.find("li").not(".scroll-control").find(":tabbable").first().closest("li"));const a=t((()=>{"false"===d.attr("aria-hidden")&&(n.find("a:visible").length?n.find("a:visible").focus():d.find("*:focus").length||d.find(":tabbable").first().focus(),t.cancel(a))}),i,50,100,!1)}))}))}}])}).call(this,n("71td"))},"7/0s":function(e,t){e.exports='<a\n  href="javascript:void(0);"\n  class="skip-link"\n  bb-focus-next="{{ bbSkipLinkFocusNext }}"\n  bb-translate\n  bb-load-bundle="components/directives/skip-link"\n  analytics-id="components.directives.skip-link.message">\n  components.directives.skip-link.message\n</a>\n'},"7/CN":function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return d})),n.d(t,"h",(function(){return u})),n.d(t,"j",(function(){return m})),n.d(t,"f",(function(){return p})),n.d(t,"i",(function(){return h})),n.d(t,"a",(function(){return l})),n.d(t,"e",(function(){return b})),n.d(t,"g",(function(){return v}));var a=n("71td"),i=n("lUN/"),r=n("MC1S");const s="has-applied-locale-text-direction";var o,l;function c(e){let t=a(e),n=0;for(;t.length;){if(t.is(".bb-close"))n++;else if(t.is(".bb-offcanvas-panel, #main-content-inner")){if(n<=0)return t[0];n--}t=t.parent()}return document.body}function d(){const e=a(".reveal-modal-bg, .wrs_modal_overlay");return e&&e.length}function u(e){const t=(e||"0").split(" ");return{top:parseInt(t[0],10),right:parseInt(t[1]||t[0],10),bottom:parseInt(t[2]||t[0],10),left:parseInt(t[3]||t[1]||t[0],10)}}function m(e){const t=e.view,n=e.el;e.viewHeight=null==e.viewHeight?t.get(0).clientHeight:e.viewHeight,e.viewWidth=null==e.viewWidth?t.get(0).clientWidth:e.viewWidth,e.height=null==e.height?n.height():e.height,e.width=null==e.width?n.width():e.width;const a=t.offset(),i=n.offset(),r=t.scrollTop(),s=t.scrollLeft(),o=i.top-a.top-e.padding.top,l=i.left-a.left-e.padding.left,c=i.top+e.height+e.padding.bottom-a.top-e.viewHeight,d=i.left+e.width+e.padding.right-a.left-e.viewWidth;e.height<=e.viewHeight?o<0?t.scrollTop(r+o):c>0&&t.scrollTop(r+c):o>0?t.scrollTop(r+o):c<0&&t.scrollTop(r+c),e.width<=e.viewWidth?l<0?t.scrollLeft(s+l):d>0&&t.scrollLeft(s+d):l>0?t.scrollLeft(s+l):d<0&&t.scrollLeft(s+d)}function p(e){e.attr("aria-hidden","true"),function(e){i.a(),e.find(":tabbable").each((function(){const e=a(this);e.addClass("bb-element-inaccessible"),e.data("bb-element-inaccessible",{tabindex:e.attr("tabindex")}),e.attr("tabindex","-1")}))}(e)}function h(e){e.removeAttr("aria-hidden"),e.find(".bb-element-inaccessible").each((function(){const e=a(this);e.removeClass("bb-element-inaccessible"),e.data("bb-element-inaccessible")&&(null!=e.data("bb-element-inaccessible").tabindex?e.attr("tabindex",e.data("bb-element-inaccessible").tabindex):e.removeAttr("tabindex"))}))}let g;function b(){if(g)return g;const e=document.createElement("div");e.id="rtl-browser-detector",document.body.appendChild(e);try{e.innerHTML='\n      <div dir="rtl" style="width: 1px; height: 1px; overflow: hidden; position: fixed; left: 0; top: 0">\n        <div style="width: 2px; height: 1px; white-space: nowrap">\n          <span style="width: 1px; height: 1px; display: inline-block">&nbsp;</span>\n          <span style="width: 1px; height: 1px; display: inline-block">&nbsp;</span>\n        </div>\n      </div>\n    ';const t=e.children[0];t.children[0].children[1].scrollIntoView(),g=t.scrollLeft>=0?l.Positive:l.Negative}catch(e){console.error("Error retrieving scroll direction",e),g=l.Negative}finally{document.body.removeChild(e)}return g}!function(e){e.LeftToRight="ltr",e.RightToLeft="rtl"}(o||(o={})),function(e){e[e.Positive=0]="Positive",e[e.Negative=1]="Negative"}(l||(l={}));class f{constructor(){this._rtlCSSLoadedPromise=new Promise((e=>{this._rtlCSSLoadedResolve=e}))}static getInstance(){return f.instance||(f.instance=new f),f.instance}getCSSLoadedPromise(){return this._rtlCSSLoadedPromise}initialize(e){Object(r.setRTL)(e===o.RightToLeft);const t=document.getElementsByTagName("html")[0],n=[];if(t.hasAttribute(s))this._rtlCSSLoadedResolve();else{if(t.setAttribute("dir",e),t.setAttribute(s,""),e===o.RightToLeft){const e=Array.from(document.getElementsByClassName("initial-css-link"));for(let t=0;t<e.length;t++){const i=a(e[t]),r=i.attr("href");i.attr("href","");const s=a(i).clone();s.attr("href",r.replace(".css",".rtl.css")),i.removeClass("initial-css-link"),s.appendTo("head"),n.push(new Promise((e=>{s[0].onload=()=>e()})))}Promise.all(n).then((()=>{this._rtlCSSLoadedResolve()}))}else this._rtlCSSLoadedResolve();const i=new CustomEvent("initializePageDirection",{detail:{isRtl:e===o.RightToLeft}});document.dispatchEvent(i)}}}const v=f.getInstance()},"7CA4":function(e,t,n){"use strict";var a=n("nbDY"),i=n.n(a);class r extends i.a{}r.NothingToGrade=new r("NOTHING_TO_GRADE"),r.NeedsGrading=new r("NEEDS_GRADING"),r.NeedsPosting=new r("NEEDS_POSTING"),r.AllPosted=new r("ALL_POSTED"),r.AllGraded=new r("ALL_GRADED"),r.Restricted=new r("RESTRICTED"),t.a=r},"7QJo":function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n("Llzl"),i=n("0JpG"),r=n("pjml"),s=n("TnpK"),o=n("Qbdf"),l=n("X455"),c=n("OTLg"),d=n("nmzr");const u="ultra.course.roster.router";a.module(u,[i.moduleName,s.b,o.b,l.a]).config([s.c,o.c,l.b,(e,t,a)=>{e.peekState("roster",{url:"/roster",resolve:{[o.d]:t.resolve,[l.c]:a.resolve,translations:[i.serviceName,e=>e.loadBundle("features/course/roster/course-roster")]},peekStates:["edit-enrollment","enroll-users",d.n.COURSE_MESSAGE,"invite",d.n.ACCOMMODATION],panelClass:"full",peekViewName:"account-update-base@",require:()=>Promise.all([n.e(0),n.e(101),n.e(589)]).then(n.bind(null,"DjKT")),pageTitle:"course.roster.rosterName"}).peekState("edit-enrollment",{url:"/edit/:membershipId",require:()=>Promise.all([n.e(97),n.e(101),n.e(680)]).then(n.bind(null,"VZ54"))}).peekState("enroll-users",{url:"/enroll",require:()=>Promise.all([n.e(101),n.e(667)]).then(n.bind(null,"30P8")),pageTitle:"course.roster.enroll.enrollPeople"}).peekState(d.n.COURSE_MESSAGE,{url:"/message?courseId?recipientId",require:()=>Promise.all([n.e(49),n.e(51),n.e(73)]).then(n.bind(null,"BrlV"))}).peekState("invite",{url:"/invite",require:()=>n.e(668).then(n.bind(null,"IgRM")),pageTitle:"course.roster.invite.inviteStudents"}).peekState(d.n.ACCOMMODATION,{url:"/exception/:membershipId",require:()=>n.e(662).then(n.bind(null,"0vas")),pageTitle:"course.roster.dueDateException",resolve:{currentMembership:["$q","$stateParams",r.m.serviceName,(e,t,n)=>{const a={fields:c.b.join(",")};return n.$new(t.courseId).memberships.$find(t.membershipId,a).$asPromise()}]}})}])},"7n5u":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n("fN3Q"),i=n("td+C"),r=n("v6Sp"),s=n("oPIA");const o="course.outline.details",l={attributes:s.hb,classNameMappings:new Map(Object.entries({"uef--course-details--element":"element-details","uef--course-details--image":"element-image","uef--course-details--element-card":"element-card","uef--course-details--name":"name","uef--course-details--content":"content","uef--course-details--link":"blue-link","uef--course-details--container":"element-card-container","uef--course-details--menu-container":"select-wrapper content"}))},c={attributes:[...s.hb,"disabled"],classNameMappings:new Map(Object.entries({"uef--button":"button button--primary","uef--button--secondary":"button button--secondary","uef--button--course-details":"element-card","uef--button--disabled":"disabled"})),classNameDefault:"uef--button--classless"};t.b=new class{constructor(e,t){this.registrations=new Map,this.listeners=new Set,this.onIntegrationRegistration=(e,t)=>{const n=this.validateRegistrationRequest(e);n.status===s.h.Success?(this.registrations.set(n.registrationId,{integrationId:t.id,registrationId:n.registrationId,registrationName:n.registrationName}),this.notifyListeners(n.registrationId),this.integrationService.sendMessage(n,t)):this.integrationService.sendMessage(n,t)},this.integrationService=e,this.componentManager=t}init(){this.integrationService.addIntegrationMessageType(s.e,this.onIntegrationRegistration),this.initializeWhitelist()}onIntegrationAdded(e){return this.listeners.add(e),()=>{this.removeIntegrationAdded(e)}}removeIntegrationAdded(e){this.listeners.delete(e)}getRegisteredRecords(){return Array.from(this.registrations.values()).map((e=>({selectorData:{},registrationRecord:e})))}initializeWhitelist(){this.componentManager.setCustomWhiteList(o,"div",l),this.componentManager.setCustomWhiteList(o,"button",c)}notifyListeners(e){this.listeners.forEach((t=>{try{t(this.registrations.get(e))}catch(e){console.error(e)}}))}hasRegistrationName(e){return Array.from(this.registrations.values()).some((t=>t.registrationName===e))}validateRegistrationRequest(e){return this.hasRegistrationName(e.registrationName)?{type:s.e,registrationName:e.registrationName,error:s.g.ExistingRegistration,status:s.h.Failure}:{type:s.e,registrationName:e.registrationName,registrationId:Object(a.v4)(),status:s.h.Success}}}(i.a,r.b)},"7oqQ":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));n("JzsJ");var a=n("Llzl"),i=n("ZQFV"),r=n("0JpG"),s=n("TnpK");const o="ultra.course.question-analysis.routes",l=()=>({translations:[r.serviceName,e=>e.loadBundle("features/course/question-analysis/question-analysis")]});a.module(o,[s.b]).config([s.c,e=>{e.peekState("question-analysis",{url:"?qaContentId",abstract:!0,resolve:l(),courseEntitlement:[i.q.ViewGrades]}).peekState("question-analysis.report",{panelClass:"full",url:"/report",require:()=>Promise.all([n.e(3),n.e(13),n.e(12),n.e(14),n.e(96),n.e(736)]).then(n.bind(null,"wD7k")),pageTitle:"course.question-analysis.report.pageTitle",peekViewName:"question-analysis-report",peekStates:["gradebook-item","question-analysis-report"]}),e.peekState("question-analysis-report",{url:"?difficultyFilter&discriminationFilter",abstract:!0,resolve:l(),courseEntitlement:[i.q.ViewGrades]}).peekState("question-analysis-report.question-details",{panelClass:"full",url:"/questionDetails/:questionId",require:()=>Promise.all([n.e(3),n.e(13),n.e(12),n.e(14),n.e(96),n.e(734)]).then(n.bind(null,"jvDI")),pageTitle:"course.question-analysis.question-details.pageTitle",peekViewName:"question-analysis-question-details",peekStates:["gradebook-item"]})}])},"8HGT":function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var a=n("Llzl"),i=n("nmzr"),r=n("Sa5G"),s=n("ZQFV"),o=n("w9Zy"),l=n("Fvsw"),c=n("vdfi"),d=n("JXhc"),u=n("hlSw"),m=n("0JpG"),p=n("pjml"),h=n("TnpK"),g=n("Qbdf"),b=n("X455"),f=n("tQ/B"),v=n("wylW");const y="ultra.course.grades.router";a.module(y,[m.moduleName,h.b,c.c,d.c,g.b,f.b]).config([h.c,g.c,b.b,f.c,(e,t,a,f)=>{e.peekState("gradebook-item",{abstract:!0,require:()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(22),n.e(69),n.e(595)]).then(n.bind(null,"AlUX")),resolve:{translations:[m.serviceName,e=>e.loadBundle("features/course/grades/gradebook-item/gradebook-item")],[g.d]:t.resolve,currentColumn:u.a.currentColumn,currentContent:u.a.currentContent}}).peekState("gradebook-item.assignment-create",{panelClass:"full",resolve:{translations:["$q",m.serviceName,(e,t)=>e.all([t.loadBundle("features/course/content/assessment/assessment"),t.loadBundle("features/course/content/course-content"),t.loadBundle("features/course/goal-alignment/goal"),t.loadBundle("features/course/grades/gradebook-item/submissions")])]},onEnter:[o.e,h.d,(e,t)=>{t.isPeekPanelOpen()&&e.expandTopPanel()}],onExit:["$rootScope",e=>{e.$broadcast("deadline-refresh")}],url:"/assignment?id&parentId&positionBefore&positionAfter&gradeitemView",views:{"gradebook-item-details@":{require:[()=>Promise.all([n.e(19),n.e(27),n.e(181)]).then(n.bind(null,"eePf")),()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(20),n.e(19),n.e(21),n.e(23),n.e(29),n.e(26),n.e(25),n.e(27),n.e(28),n.e(24),n.e(30)]).then(n.bind(null,"5lIA"))]},"gradebook-item-students@":{require:()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(34),n.e(60),n.e(79)]).then(n.bind(null,"hmMQ"))}},peekStates:["assignment-grading","assessment-settings","conversations",i.G.Course.COURSE_MESSAGE,"course-group","editAssignmentFileAttachment",c.a,"rubric","rubric-list","rubric-evaluation","view-exceptions"],peekViewName:"gradebook-item-panel@",pageTitle:"course.content.assignmentCreate"}).peekState("gradebook-item.assignment",{panelClass:"full",resolve:{translations:["$q",m.serviceName,(e,t)=>e.all([t.loadBundle("features/course/content/assessment/assessment"),t.loadBundle("features/course/content/course-content"),t.loadBundle("features/course/goal-alignment/goal"),t.loadBundle("features/course/grades/gradebook-item/submissions")])]},onEnter:[o.e,h.d,(e,t)=>{t.isPeekPanelOpen()&&e.expandTopPanel()}],onExit:["$rootScope",e=>{e.$broadcast("deadline-refresh")}],url:"/assignment/:contentId?courseId&gradeitemView",views:{"gradebook-item-details@":{require:[()=>Promise.all([n.e(19),n.e(27),n.e(181)]).then(n.bind(null,"eePf")),()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(20),n.e(19),n.e(21),n.e(23),n.e(29),n.e(26),n.e(25),n.e(27),n.e(28),n.e(24),n.e(30)]).then(n.bind(null,"5lIA"))]},"gradebook-item-students@":{require:()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(34),n.e(60),n.e(79)]).then(n.bind(null,"hmMQ"))}},peekStates:["assignment-grading","assessment-settings","conversations",i.G.Course.COURSE_MESSAGE,"course-group","editAssignmentFileAttachment",c.a,"rubric","rubric-list","rubric-evaluation","view-exceptions"],params:{},peekViewName:"gradebook-item-panel@",pageTitle:"course.grades.gradebook-item.title.assignment.edit"}).peekState("editAssignmentFileAttachment",{require:()=>n.e(169).then(n.bind(null,"TFHU")),resolve:{translations:[m.serviceName,e=>e.loadBundle("features/course/content/media-widget/media-widget")]},url:"/assignment/fileAttachment?toolContentName&fileIndex&isRenderedInline&linkName&parentToolInstanceName&alternativeText&mediaType&bbmlEditorId"}).peekState(i.G.Course.COURSE_GRADES_MULTIPLE_ATTEMPT,{panelClass:"peek",resolve:{translations:[m.serviceName,e=>e.loadBundle("features/course/grades/course-grades")],[g.d]:t.resolve,currentContent:u.a.nullContent,currentColumn:u.a.currentColumn},url:"/multiple-attempt-grading?columnId&gradeId&userId&groupId",params:{hasException:!1},reloadOnSearch:!1,require:[()=>Promise.all([n.e(0),n.e(22),n.e(163),n.e(744)]).then(n.bind(null,"bhG9")),()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(22),n.e(34),n.e(44),n.e(45),n.e(163),n.e(701)]).then(n.bind(null,"0dEv"))],pageTitle:"course.grades.multiple-attempt-grading.title",peekStates:[i.G.Grade.SUBMISSION_GRADING]}).peekState(i.G.Grade.RECONCILE_GRADE,{panelClass:"full",resolve:{translations:[m.serviceName,e=>e.loadBundle("features/course/grades/course-grades")],[g.d]:t.resolve,currentContent:u.a.nullContent,currentColumn:u.a.currentColumn},url:"/reconcile-grade?columnId&gradeId&userId",require:[()=>n.e(693).then(n.bind(null,"NNJe")),()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(34),n.e(44),n.e(45),n.e(694)]).then(n.bind(null,"e5ML"))],pageTitle:"course.grades.reconcile-grade.title",peekStates:[i.G.Grade.SUBMISSION_GRADING],peekViewName:"reconcile-grade-peek"}).peekState("per-assessment-settings",{panelClass:"peek",courseEntitlement:s.q.ModifyGradebook,resolve:{translations:[m.serviceName,e=>e.loadBundle("features/course/grades/course-grades")],currentContent:u.a.currentContent,currentColumn:u.a.currentColumn,[g.d]:t.resolve},url:"/per-assessment-settings?userId&columnId&membershipId",require:[()=>Promise.all([n.e(80),n.e(729)]).then(n.bind(null,"1p7s")),()=>Promise.all([n.e(1),n.e(2),n.e(5),n.e(80),n.e(153)]).then(n.bind(null,"Wn37"))],pageTitle:"course.grades.per-assessment-settings.title"}).peekState("per-assessment-group-settings",{panelClass:"peek",courseEntitlement:s.q.ModifyGradebook,resolve:{translations:[m.serviceName,e=>e.loadBundle("features/course/grades/course-grades")],currentContent:u.a.currentContent,currentColumn:u.a.currentColumn,[g.d]:t.resolve},url:"/per-assessment-group-settings?groupId&columnId&userId",require:[()=>Promise.all([n.e(80),n.e(728)]).then(n.bind(null,"bMue")),()=>Promise.all([n.e(1),n.e(2),n.e(5),n.e(80),n.e(153)]).then(n.bind(null,"Wn37"))],pageTitle:"course.grades.per-assessment-settings.title"}).peekState("per-gradable-item-settings",{panelClass:"peek",courseEntitlement:s.q.ModifyGradebook,url:"/per-gradable-item-settings?userId&columnId&courseId",require:()=>n.e(752).then(n.bind(null,"ovwO")),pageTitle:"components.directives.grade.submission-list-row.per-gradable-item.title",template:"<gradable-item-exempt-settings>"}).peekState("originality-report",{panelClass:"peek",url:"/originality-report",require:()=>n.e(715).then(n.bind(null,"K7I1")),peekViewName:"originality-report-peek"}).peekState(i.G.Grade.SUBMISSION_GRADING,{panelClass:"full",resolve:{translations:["$q",m.serviceName,(e,t)=>e.all([t.loadBundle("features/course/grades/submission-grading"),t.loadBundle("features/course/grades/submissions-grading")])],[b.c]:a.resolve,currentColumn:u.a.currentColumn,currentContent:u.a.currentContent},url:"/submission-grading?columnId&gradeId&userId&attemptId&contentId&membershipId",onExit:["currentColumn",o.e,h.d,(e,t,n)=>{if(n.params.isGradingBarAttemptNavigationEnabled)return;const a=n.current.name.match(".peek.reconcile-grade"),r=n.current.name.match(".peek.attempt-receipt-search");if(e.isMultipleAttempts()&&!a&&!r||n.prevParams.hasException){n.isPeekPanelOpen()&&t.shrinkTopPanel();n.next.name.indexOf(i.G.Grade.SUBMISSION_GRADING)>=0||n.goPeekState("multiple-attempt-grading",{columnId:n.prevParams.columnId,gradeId:n.prevParams.gradeId,userId:n.prevParams.userId,membershipId:n.prevParams.membershipId,hasException:n.prevParams.hasException})}}],onEnter:[o.e,h.d,(e,t)=>{t.isPeekPanelOpen()&&e.expandTopPanel()}],reloadOnSearch:!1,require:[()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(22),n.e(666)]).then(n.bind(null,"6S3j")),()=>Promise.all([n.e(3),n.e(13),n.e(31),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(22),n.e(33),n.e(34),n.e(44),n.e(45),n.e(23),n.e(58),n.e(66),n.e(67),n.e(72)]).then(n.bind(null,"fVgT"))],pageTitle:"course.grades.submission-grading.title",params:{commentPanelInitiallyOpen:!1,isGradingBarAttemptNavigationEnabled:!1},peekViewName:"submission-grading-peek",peekStates:[i.G.Assessment.ASSESSMENT_SETTINGS,i.G.Grade.SUBMISSION_DEEP_LINK,"per-assessment-settings","per-gradable-item-settings","assessment-submission-feedback","originality-report",i.G.ContentMarket.CONTENT_MARKET]}).peekState(i.G.Grade.SUBMISSION_GRADING_FEEDBACK_TAB,{url:"/inline-feedback?mode",pageTitle:"course.content.assessment.feedback.title",panelClass:"full",params:{mode:"inline",isGradingBarAttemptNavigationEnabled:!1},resolve:{translations:[m.serviceName,e=>e.loadBundle("features/course/feedback-authoring/feedback-authoring")]},views:{[`${i.G.Grade.SUBMISSION_GRADING}@`]:{require:()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18)]).then(n.bind(null,"15AK"))}},peekStates:["per-assessment-settings",i.G.Lti.LTI,i.G.Grade.SUBMISSION_DEEP_LINK]}).peekState(i.G.Grade.SUBMISSION_GRADING_RUBRICS_TAB,{url:"/inline-rubric",pageTitle:"course.rubricInline.title",panelClass:"full",views:{[`${i.G.Grade.SUBMISSION_GRADING}@`]:{require:()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(32),n.e(104)]).then(n.bind(null,"5N8L"))}},peekStates:["per-assessment-settings",i.G.Grade.SUBMISSION_DEEP_LINK]}).peekState(i.G.Grade.SUBMISSION_GRADING_ORIGINALITY_TAB,{url:"/originality-report",pageTitle:"course.content.originalityReport.routeDefinition.routeTitle",panelClass:"full",views:{[`${i.G.Grade.SUBMISSION_GRADING}@`]:{require:()=>n.e(90).then(n.bind(null,"djtz"))}},peekStates:["per-assessment-settings",i.G.Grade.SUBMISSION_DEEP_LINK]}).peekState(i.G.Grade.GROUP_SUBMISSION_GRADING,{panelClass:"full",params:{userId:null,isGradingBarAttemptNavigationEnabled:!1},resolve:{translations:["$q",m.serviceName,(e,t)=>e.all([t.loadBundle("features/course/grades/submission-grading"),t.loadBundle("features/course/grades/submissions-grading")])],currentColumn:u.a.currentColumn,currentContent:u.a.currentContent},url:"/group-submission-grading?columnId&gradeId&groupId&contentId&attemptId&groupAttemptId&userId",onExit:["currentColumn",o.e,h.d,(e,t,n)=>{if(n.params.isGradingBarAttemptNavigationEnabled)return;const a=n.current.name.match(".peek.attempt-receipt-search");!e.isMultipleAttempts()&&!n.prevParams.hasException||a||(n.isPeekPanelOpen()&&t.shrinkTopPanel(),n.goPeekState("multiple-attempt-grading",{columnId:n.prevParams.columnId,gradeId:n.prevParams.gradeId,userId:n.prevParams.userId,groupId:n.prevParams.groupId,membershipId:n.prevParams.membershipId,hasException:n.prevParams.hasException}))}],onEnter:[o.e,h.d,(e,t)=>{t.isPeekPanelOpen()&&e.expandTopPanel()}],reloadOnSearch:!1,require:[()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(768)]).then(n.bind(null,"rNv7")),()=>Promise.all([n.e(3),n.e(13),n.e(31),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(22),n.e(33),n.e(34),n.e(44),n.e(45),n.e(23),n.e(58),n.e(66),n.e(67),n.e(72)]).then(n.bind(null,"fVgT"))],pageTitle:"course.grades.submission-grading.title",peekViewName:"submission-grading-peek",peekStates:[i.G.Assessment.ASSESSMENT_SETTINGS,i.G.Grade.SUBMISSION_DEEP_LINK,"per-assessment-group-settings","originality-report",i.G.ContentMarket.CONTENT_MARKET]}).peekState(i.G.Grade.GROUP_SUBMISSION_GRADING_FEEDBACK_TAB,{url:"/inline-feedback?attemptId&userId&mode",pageTitle:"course.content.assessment.feedback.title",panelClass:"full",params:{mode:"inline"},resolve:{translations:[m.serviceName,e=>e.loadBundle("features/course/feedback-authoring/feedback-authoring")]},views:{[`${i.G.Grade.GROUP_SUBMISSION_GRADING}@`]:{require:()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18)]).then(n.bind(null,"15AK"))}},peekStates:["per-assessment-group-settings",i.G.Lti.LTI,i.G.Grade.SUBMISSION_DEEP_LINK]}).peekState(i.G.Grade.GROUP_SUBMISSION_GRADING_RUBRICS_TAB,{url:"/inline-rubric",pageTitle:"course.rubricInline.title",panelClass:"full",views:{[`${i.G.Grade.GROUP_SUBMISSION_GRADING}@`]:{require:()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(32),n.e(104)]).then(n.bind(null,"5N8L"))}},peekStates:["per-assessment-group-settings",i.G.Grade.SUBMISSION_DEEP_LINK]}).peekState(i.G.Grade.GROUP_SUBMISSION_GRADING_ORIGINALITY_TAB,{url:"/originality-report",pageTitle:"course.content.originalityReport.routeDefinition.routeTitle",panelClass:"full",views:{[`${i.G.Grade.GROUP_SUBMISSION_GRADING}@`]:{require:()=>n.e(90).then(n.bind(null,"djtz"))}},peekStates:["per-assessment-group-settings",i.G.Grade.SUBMISSION_DEEP_LINK]}).peekState("assignment-grading",{panelClass:"full",resolve:{translations:[m.serviceName,e=>e.loadBundle("features/course/grades/submissions-grading")],currentColumn:["currentColumn",p.m.serviceName,h.d,(e,t,n)=>{if(null!=e)return e.$asPromise();const a=n.nextParams.columnId,i=n.nextParams.courseId;return t.$find(i).gradebook.columns.$find(a,{expand:"associatedRubrics,externalGrade"}).$asPromise()}]},url:"/grading?columnId&gradeId&groupId",reloadOnSearch:!1,require:[()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(67)]).then(n.bind(null,"XGKH")),()=>Promise.all([n.e(3),n.e(13),n.e(31),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(22),n.e(33),n.e(34),n.e(44),n.e(45),n.e(23),n.e(58),n.e(66),n.e(67),n.e(72)]).then(n.bind(null,"fVgT"))],pageTitle:"course.grades.submissions-grading.title",peekViewName:"assignment-grading-peek",peekStates:["rubric-evaluation"]}).peekState("gradebook-item.offline",{panelClass:"full",resolve:{translations:["$q",m.serviceName,(e,t)=>e.all([t.loadBundle("features/course/grades/course-grades"),t.loadBundle("features/course/grades/gradebook-item/non-attempt-grades")])]},url:"/offline-grades/:columnId?courseId&q&limit&page&gradeitemView",views:{"gradebook-item-students@":{require:()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(94)]).then(n.bind(null,"qijm"))}},peekStates:[i.w.OFFLINE_GRADE_AND_FEEDBACK],peekViewName:"gradebook-item-panel@",pageTitle:"course.grades.instructorHeaderLabel"}).peekState(i.w.OFFLINE_GRADE_AND_FEEDBACK,{panelClass:"peek",url:"/offline-feedback?userId",require:()=>n.e(713).then(n.bind(null,"SkVk")),pageTitle:"course.grades.gradebook-item.non-attempt-grades.pageTitle"}).peekState("gradebook-item.calculation",{panelClass:"full",resolve:{translations:["$q",m.serviceName,(e,t)=>e.all([t.loadBundle("features/course/grades/gradebook-item/calculation"),t.loadBundle("features/course/grades/gradebook-item/non-attempt-grades")])]},url:"/calculation/:columnId?courseId&gradeitemView&isOverallGrade&positionBefore&positionAfter",params:{columnId:p.C.CREATE_COLUMN_ID},views:{"gradebook-item-details@":{require:()=>Promise.all([n.e(149),n.e(665)]).then(n.bind(null,"aUnP"))},"gradebook-item-students@":{require:()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(94)]).then(n.bind(null,"qijm"))}},courseEntitlement:s.q.ViewGradebookMetaData,pageTitle:"course.grades.gradebook-item.title.calculation"}).peekState(i.w.GRADEBOOK_ITEM_ASSESSMENT,{panelClass:"full",courseEntitlement:[r.j.ViewAssessment,s.q.ViewAttempts],resolve:{translations:["$q",m.serviceName,(e,t)=>e.all([t.loadBundle("features/course/content/course-content"),t.loadBundle("features/course/grades/gradebook-item/submissions"),t.loadBundle("features/course/content/assessment/assessment"),t.loadBundle("features/course/goal-alignment/goal")])]},onEnter:[o.e,h.d,"currentColumn",l.b,(e,t,n,a)=>{a.column=n,t.isPeekPanelOpen()&&e.expandTopPanel()}],onExit:["$rootScope",l.b,(e,t)=>{e.$broadcast("deadline-refresh"),t.column=null}],url:"/assessment/:assessmentType/{contentId:_[0-9]+_1|create}?courseId&gradeitemView&parentId&positionBefore&positionAfter&gradebookCategoryId&autoPostGrades&gradingStatus&studentStatus",params:{contentId:p.p.CREATE_CONTENT_ID,isCreateState:!1},views:{"gradebook-item-details@":{require:()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(20),n.e(19),n.e(33),n.e(39),n.e(21),n.e(26),n.e(159)]).then(n.bind(null,"EPkw"))},"gradebook-item-students@":{require:()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(34),n.e(60),n.e(79)]).then(n.bind(null,"hmMQ"))}},peekStates:[i.G.Grade.CREATE_OFFLINE_ATTEMPT,"assessment-settings","question-analysis",i.G.Grade.RECONCILE_GRADE,"multiple-attempt-grading",i.G.Grade.SUBMISSION_GRADING,"group-submission-grading","course-group",i.k.CONDITIONAL_RELEASE_PEEK_PANEL,c.a,d.a,"conversations",i.G.Course.COURSE_MESSAGE,"edit-file-settings","rubric","rubric-list","rubric-evaluation","view-exceptions",i.G.ContentMarket.CONTENT_MARKET,i.G.Lti.LTI,"proctoring-lti-tool","per-assessment-settings","per-assessment-group-settings","per-gradable-item-settings","grades-bulk-download"],peekViewName:"gradebook-item-panel@",pageTitle:"course.grades.gradebook-item.title.assessment"}).peekState("grade-item",{abstract:!0,url:"/item"}).peekState("grade-item.create",{url:"/create?positionBefore&positionAfter",resolve:{translations:["$q",m.serviceName,(e,t)=>e.all([t.loadBundle("features/course/content/course-content"),t.loadBundle("features/course/grades/course-grades")])]},require:()=>n.e(160).then(n.bind(null,"kneA")),pageTitle:"course.grades.gradeItem.addItem"}).peekState("grade-item.edit",{url:"/edit/:id",resolve:{translations:[m.serviceName,e=>e.loadBundle("features/course/grades/course-grades")]},require:()=>n.e(160).then(n.bind(null,"kneA")),pageTitle:"course.grades.gradeItem.editItem"}).peekState(i.G.Grade.GRADE_ITEM_OVERALL_GRADE,{panelClass:"full",resolve:{translations:["$q",m.serviceName,(e,t)=>e.all([t.loadBundle("features/course/grades/overall-grade"),t.loadBundle("features/course/grades/gradebook-item/non-attempt-grades")])]},onExit:["$rootScope",e=>{e.$broadcast("deadline-refresh")}],url:"/overallGrade?columnId&gradeitemView",views:{"gradebook-item-details@":{require:()=>Promise.all([n.e(0),n.e(11),n.e(149),n.e(578)]).then(n.bind(null,"FOdA"))},"gradebook-item-students@":{require:()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(94)]).then(n.bind(null,"qijm"))}},peekStates:["overall-grade-settings"],peekViewName:"gradebook-item-panel@",pageTitle:"course.grades.overallGrade.pageTitle"}).peekState("overall-grade-settings",{url:"/overallGradeSettings",resolve:{translations:[m.serviceName,e=>e.loadBundle("features/course/grades/overall-grade")]},panelClass:"peek",require:()=>Promise.all([n.e(0),n.e(11),n.e(654)]).then(n.bind(null,"CW69")),pageTitle:"course.grades.overallGrade.settings.pageTitle"}).peekState("overall-grade-student",{url:"/overallGradeStudent?courseId&courseName",resolve:{translations:[m.serviceName,e=>e.loadBundle("features/course/grades/overall-grade")]},panelClass:"peek",require:()=>n.e(679).then(n.bind(null,"Fn0y")),pageTitle:"course.grades.overallGrade.pageTitle"}).peekState(i.G.Grade.GRADE_DOWNLOAD_SETTINGS,{url:"/grade-download-setting",require:()=>n.e(727).then(n.bind(null,"eD2y")),pageTitle:"course.grades.settings.title",peekViewName:"grades-download-peek",peekStates:["content-collection-picker"],allowChildPeekStates:!0}).peekState("grade-upload-setting",{resolve:{translations:[m.serviceName,e=>e.loadBundle("features/course/grades/grades-upload-settings/grades-upload-settings")],contentCollectionAvailability:[p.rb.serviceName,e=>e.$new("bbcms").$resolve().$asPromise()]},url:"/grade-upload-setting",require:()=>n.e(614).then(n.bind(null,"nrqE")),pageTitle:"course.grades.settings.title",peekViewName:"grade-upload-setting-peek",courseEntitlement:s.q.ModifyGradebook,peekStates:["content-collection-picker"],allowChildPeekStates:!0}).peekState("grade-setting",{resolve:{translations:[m.serviceName,e=>e.loadBundle("features/course/grades/course-grades")]},url:"/grade-settings",require:()=>Promise.all([n.e(0),n.e(11),n.e(582)]).then(n.bind(null,"NsLW")),pageTitle:"course.grades.settings.title",peekViewName:"grade-setting-peek",peekStates:["rubric",i.G.Grade.GRADEBOOK_ITEM,i.G.Telemetry.INSTRUCTOR_CLASS],allowChildPeekStates:!0}).peekState(i.G.Grade.GRADE_AND_FEEDBACK,{resolve:{translations:[m.serviceName,e=>e.loadBundle("features/course/grades/grade-and-feedback")],[g.d]:t.resolve,currentColumn:[g.d,h.d,(e,t)=>{const n=t.nextParams.columnId;return e.gradebook.columns.$find(n).$asPromise()}]},url:"/grade-and-feedback?columnId?userId?courseId",require:()=>Promise.all([n.e(0),n.e(1),n.e(2),n.e(4),n.e(15),n.e(22),n.e(44),n.e(66),n.e(628)]).then(n.bind(null,"SZKj")),pageTitle:"course.grades.grade-and-feedback.title"}).peekState("course-group",{panelClass:"full",url:"/group?groupCourseId&groupContentId&groupColumnId",resolve:{translations:[m.serviceName,e=>e.loadBundle("features/course/content/group/course-group")]},courseEntitlement:r.o.ViewGroupsAsAdmin,require:()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(22),n.e(141),n.e(761)]).then(n.bind(null,"OZRj")),pageTitle:"course.content.courseGroup.title",peekStates:[i.G.Course.COURSE_MESSAGE,i.x.IMPORT_GROUP_MEMBERS,i.x.EXPORT_GROUP_SET],peekViewName:"group-message-peek"}).peekState("rubric-list",{url:"/rubricList?gradeColumnId",resolve:{translations:[m.serviceName,e=>e.loadBundle("features/course/content/assignment/rubric-list")],[g.d]:t.resolve,currentContent:u.a.currentContent},panelClass:"peek",require:()=>Promise.all([n.e(1),n.e(2),n.e(621)]).then(n.bind(null,"WtEJ")),pageTitle:"course.content.assignmentSettings.rubricList.title",peekViewName:"rubric-list-peek",peekStates:["rubric"],allowChildPeekStates:!0}).peekState("view-exceptions",{panelClass:"peek",pageTitle:"course.content.exceptions.peekPanel.title",url:"/view-exceptions",require:()=>n.e(690).then(n.bind(null,"MBGk")),resolve:{[g.d]:t.resolve,currentContent:u.a.currentContent},allowChildPeekStates:!0,peekStates:["roster"],peekViewName:"exceptions-peek"}).peekState("grades-bulk-download",{url:"/grades-bulk-download?columnId",require:[()=>n.e(767).then(n.bind(null,"sI1N"))],pageTitle:"course.grades.grades-bulk-download.pageTitle",panelClass:"full"}).peekState(i.G.Grade.DOWNLOAD_TEST_RESULTS,{url:"/download-test-results?columnId",require:[()=>n.e(726).then(n.bind(null,"W1Pb"))],pageTitle:"course.grades.download-test-results.pageTitle",panelClass:"peek"}).peekState(i.G.Course.COURSE_GRADES_VIEW_INDIVIDUAL_GRADES,{url:"/individual-grades?userId&membershipId&studentTabId",require:[()=>Promise.all([n.e(0),n.e(1),n.e(2),n.e(4),n.e(8),n.e(52),n.e(156),n.e(593)]).then(n.bind(null,"HPfQ"))],courseEntitlement:"course.gradebook-metadata.VIEW",peekStates:[i.G.Course.ACCOMMODATION,"assignment","assessment","gradebook-item","scorm-settings","gradebook-item.scorm-submissions","scorm-launch-frame","scorm-overview","multiple-attempt-grading","per-gradable-item-settings","assignment-grading",i.G.Grade.SUBMISSION_GRADING,"group-submission-grading","grade-item","grade-setting","grade-download-setting","grade-upload-setting",i.G.Grade.GRADE_AND_FEEDBACK,i.G.Grade.CREATE_OFFLINE_ATTEMPT,"conversion-analysis","content-manage",i.G.Lti.LTI,"discussion","submission-list","rubric","overall-grade","overall-grade-student","attendance","attendance-student-records","attendance-student-view","question-analysis",i.G.Grade.RECONCILE_GRADE,"grades-bulk-download",i.G.Journal.JOURNAL_PARTICIPATION_DETAIL,i.K.INSTRUCTOR_DETAILS],panelClass:"full",pageTitle:"course.grades.instructorHeaderLabel",pageTitleHandler:f.config({listenOn:v.b,provides:v.a})}).peekState(i.G.Grade.SUBMISSION_DEEP_LINK,{url:"/submission-deep-link?deepLinkAttemptId&peerIndex",panelClass:"full",require:[()=>n.e(178).then(n.bind(null,"c7nl")),()=>n.e(166).then(n.bind(null,"iA/f"))],peekStates:["assessment-submission-feedback"],peekViewName:"submission-deep-link"}).peekState(i.G.Grade.SUBMISSION_DEEP_LINK_FEEDBACK_TAB,{url:"/inline-feedback?mode&deepLinkAttemptId",pageTitle:"course.content.assessment.feedback.title",panelClass:"full",params:{mode:"inline"},resolve:{translations:[m.serviceName,e=>e.loadBundle("features/course/feedback-authoring/feedback-authoring")]},views:{[`${i.G.Grade.SUBMISSION_DEEP_LINK}@`]:{require:()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(184)]).then(n.bind(null,"bKLL"))}},peekStates:["per-assessment-settings",i.G.Lti.LTI]}).peekState(i.G.Grade.ATTEMPT_RECEIPT_SEARCH,{url:"/attempt-receipt-search",resolve:{[g.d]:t.resolve,translations:[m.serviceName,e=>e.loadBundle("features/course/grades/attempt-receipt-search")]},peekStates:[i.G.Grade.SUBMISSION_GRADING,i.G.Grade.GROUP_SUBMISSION_GRADING],allowChildPeekStates:!0,panelClass:"peek",require:()=>n.e(615).then(n.bind(null,"M8qv")),pageTitle:"course.grades.attempt-receipt-search.pageTitle",peekViewName:"attempt-receipt-search-peek"}),e.peekState(i.G.Grade.GRADEBOOK_GRID_ADVANCED_FILTERS,{panelClass:"peek",url:"/filters",require:()=>n.e(714).then(n.bind(null,"1d8D")),pageTitle:"course.grades.gradebookGrid.advancedFilters",peekViewName:"gradebook-grid-advanced-filters-peek"})}])},"8W6D":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n("nbDY"),i=n.n(a);class r extends i.a{}r.NONE=new r("none"),r.CREATE=new r("create"),r.EDIT=new r("edit"),r.COPY=new r("copy")},"8jry":function(e,t){e.exports='<bb-modal class="notification js-disallowed-file-type"\n          modal-title-key="components.directives.fileUpload.disallowedFileTypeTitle"\n          analytics-id-tag-prefix="components.directives.fileUpload">\n  <div name="modal-contents">\n    <p>\n      <bb-translate>components.directives.fileUpload.disallowedFileTypeFull</bb-translate>\n      <a href="{{::fileUpload.getMoreSupportURL()}}" target="_blank" rel="noopener noreferrer" analytics-id="components.directives.fileUpload.moreSupportedFiles"><bb-translate>components.directives.fileUpload.moreSupportedFiles</bb-translate></a>\n    </p>\n  </div>\n  <div name="modal-footer" class="reveal-modal__footer-content reveal-modal__footer-content--gray">\n    <div class="reveal-modal__footer-buttons">\n      <span class="reveal-modal__footer-button-container">\n        <button role="button" class="button js-primary-button" ng-click="fileUpload.modalCancelUpload()" analytics-id="components.directives.fileUpload.cancelUploadText">\n          <bb-translate>components.directives.fileUpload.cancelUploadText</bb-translate>\n        </button>\n      </span>\n      <span class="reveal-modal__footer-button-container" ng-if="fileUpload.validFiles.length > 0">\n        <button role="button" class="button button--secondary js-secondary-button" ng-click="fileUpload.closeModal()" analytics-id="components.directives.fileUpload.uploadValidFiles.plural">\n          <bb-translate translate-values="{count:fileUpload.validFiles.length}">components.directives.fileUpload.uploadValidFiles.plural</bb-translate>\n        </button>\n      </span>\n      <span class="reveal-modal__footer-button-container" ng-if="fileUpload.forceReselectDisallowedFiles && fileUpload.forceReselectDisallowedFiles()">\n        <button role="button" class="button button--secondary js-secondary-button" ng-click="fileUpload.closeModalAndChooseFiles()" analytics-id="components.directives.fileUpload.selectAnotherFile">\n          <bb-translate>components.directives.fileUpload.selectAnotherFile</bb-translate>\n        </button>\n      </span>\n    </div>\n  </div>\n</bb-modal>\n'},"8jzW":function(e,t,n){"use strict";n.d(t,"b",(function(){return g})),n.d(t,"c",(function(){return b})),n.d(t,"a",(function(){return v}));var a=n("D57K"),i=n("Llzl"),r=n("nmzr"),s=n("pjml"),o=n("IbyE"),l=n("TnpK"),c=n("X/qj"),d=n("fYJU"),u=n("aHpC"),m=n("+O05"),p=n("zGdY"),h=n("Bssh");const g="ultra.components.services.scoreProviderHelper",b="scoreProviderHelper";function f(e){return!e.getScore()||e.isOverrideGrade()}var v;function y(e){var t,n;if(!(null==e?void 0:e.attempts)&&!(null==e?void 0:e.groupAttempts))return!1;const a=null===(t=null==e?void 0:e.attempts)||void 0===t?void 0:t.some((e=>null==e?void 0:e.isSubmitted())),i=null===(n=null==e?void 0:e.groupAttempts)||void 0===n?void 0:n.some((e=>(null==e?void 0:e.id)&&(null==e?void 0:e.isSubmitted())));return a||i}!function(e){e[e.GenerateStateParams=0]="GenerateStateParams",e[e.GenerateStateRef=1]="GenerateStateRef",e[e.GoToState=2]="GoToState"}(v||(v={}));class S{constructor(e){this.ultraState=e}getScoreProviderHandle(){return null}openStateRef(e,t){return null}studentViewStateRef(e,t){return null}editStateRef(e,t){return null}gradingStateRef(e,t,n,a){return null}gradingWithRubricStateRef(e,t){return null}gradingWithFeedbackStateRef(e,t){return null}getSubmissionsListStateRef(e,t){return null}getAttemptReceiptSearchStateRef(e,t){return null}supportsOverall(){return!1}supportsEdit(){return!0}supportsViewItem(){return!1}supportsExternalEdit(){return!1}takeActionOnStateRef(e,t,n){switch(n){case v.GoToState:this.ultraState.goPeekState(e,t);break;case v.GenerateStateParams:return i.toJson({state:e,args:t});case v.GenerateStateRef:default:return this.generateStateRef(e,t)}}generateStateRef(e,t){return t?e+"("+i.toJson(t)+")":e}}S.$inject=[l.d];let C=class extends S{constructor(e,t,n){super(e),this.gradebookPermissionService=t,this.currentUser=n}getScoreProviderHandle(){return[o.O.Test,o.O.PeerSubmissionsTest,o.O.PeerEvaluationTest]}openStateRef(e,t){return this.takeActionOnStateRef("assessment.open",e,t)}studentViewStateRef(e,t){return this.takeActionOnStateRef(e.state||"assessment.overview",e,t)}editStateRef(e,t){return e.assessmentType="test",e.gradeitemView="details",this.takeActionOnStateRef(r.w.GRADEBOOK_ITEM_ASSESSMENT,e,t)}gradingStateRef(e,t,n,a){var i,s,o;let l=r.w.SUBMISSION_GRADING,c=t;const d=null==n?void 0:n.hasAttempts(),u=y(n),p=m.a.isExternalSubmissionsAssessment(null===(i=null==e?void 0:e.ui)||void 0===i?void 0:i.content),h=null==e?void 0:e.isUserReconciler(this.currentUser.userId),g=(null===(s=null==n?void 0:n.attempts)||void 0===s?void 0:s.length)>e.multipleAttempts,b=(e.isMultipleAttempts()||g)&&u;if(b&&!t.attemptId)return this.takeActionOnStateRef(r.n.COURSE_GRADES_MULTIPLE_ATTEMPT,t,a);b&&(c=null);const v=this.gradebookPermissionService.canExecute()&&!h;return p?u||!v?(l=(null==t?void 0:t.groupId)?r.w.GROUP_SUBMISSION_GRADING:r.w.SUBMISSION_GRADING,this.takeActionOnStateRef(l,c,a)):this.takeActionOnStateRef(r.w.CREATE_OFFLINE_ATTEMPT,t,a):(h&&d&&!(null==e?void 0:e.peerGrading)&&!(null===(o=this.ultraState.current.peekViewName)||void 0===o?void 0:o.startsWith(r.w.RECONCILE_GRADE))?l=r.w.RECONCILE_GRADE:(null==t?void 0:t.groupId)&&u?l=r.w.GROUP_SUBMISSION_GRADING:!n||u||!d&&(d||(null==n?void 0:n.isSubmitted())&&!f(n))||(l=r.w.GRADE_AND_FEEDBACK),this.takeActionOnStateRef(l,c,a))}gradingWithFeedbackStateRef(e,t){const n=e&&e.groupId?r.w.GROUP_SUBMISSION_GRADING:r.w.SUBMISSION_GRADING;return this.takeActionOnStateRef(`${n}.assessment-submission-feedback-tab`,e,t)}gradingWithRubricStateRef(e,t){const n=(null==e?void 0:e.groupId)?r.w.GROUP_SUBMISSION_GRADING:r.w.SUBMISSION_GRADING;return this.takeActionOnStateRef(`${n}.inline-rubric`,null,t)}getSubmissionsListStateRef(e,t){return e.assessmentType="test",e.gradeitemView="students",(null==e?void 0:e.needsGrading)&&(delete e.needsGrading,e.gradingStatus=p.O.needsGrading),this.takeActionOnStateRef(r.w.GRADEBOOK_ITEM_ASSESSMENT,e,t)}getAttemptReceiptSearchStateRef(e,t){const n=(null==e?void 0:e.groupId)?r.w.GROUP_SUBMISSION_GRADING:r.w.SUBMISSION_GRADING,a=e;return this.takeActionOnStateRef(n,a,t)}supportsOverall(){return!0}};C.$inject=[],C=Object(a.a)([Object(a.c)(0,Object(u.b)(l.d)),Object(a.c)(1,Object(u.b)(c.b)),Object(a.c)(2,Object(u.b)(d.b))],C);class E{constructor(e,t){this.$rootScope=e,this.$injector=t,this.delegates=Object.create(null),this.contentHandlerToDelegateMap=Object.create(null),E.SCORE_PROVIDER_DELEGATES.forEach((e=>{const t=this.$injector.instantiate(e),n=t.getScoreProviderHandle();Array.isArray(n)?n.forEach((e=>{this.buildDelegateMap(e,t)})):this.buildDelegateMap(n,t)}))}buildDelegateMap(e,t){if(this.delegates[e.toString()])throw new Error("There is already a registered delegate for "+e.toString());this.delegates[e.toString()]=t,e.contentHandlers.forEach((n=>{if(this.contentHandlerToDelegateMap[n]){if(this.contentHandlerToDelegateMap[n]!==t)throw new Error("There is already a registered delegate for "+e.toString())}else this.contentHandlerToDelegateMap[n]=t}))}getDelegate(e){return e&&this.delegates[e.toString()]||I.NULL_DELEGATE}getDelegateByContentHandler(e){return e&&this.contentHandlerToDelegateMap[e.toString()]||I.NULL_DELEGATE}isSupported(e){return e&&null!=this.getDelegate(e).getScoreProviderHandle()}getSupportedHandles(){return Object.keys(this.delegates).map((e=>o.O.parse(e)))}openStateRef(e,t,n){return this.getDelegateByContentHandler(e).openStateRef(t,n)}getSubmissionListStateRef(e,t,n){return this.getDelegate(e).getSubmissionsListStateRef(t,n)}getSubmissionListStateRefByContentHandler(e,t,n){return this.getDelegateByContentHandler(e).getSubmissionsListStateRef(t,n)}getAttemptReceiptSearchStateRef(e,t,n){return this.getDelegate(null==e?void 0:e.scoreProviderHandle).getAttemptReceiptSearchStateRef(t,n)}studentViewStateRef(e,t,n){return this.getDelegate(e).studentViewStateRef(t,n)}editStateRef(e,t,n){return this.getDelegate(e).editStateRef(t,n)}gradingStateRef(e,t,n,a){return this.getDelegate(null==e?void 0:e.scoreProviderHandle).gradingStateRef(e,n,t,a)}gradingWithRubricStateRef(e,t,n){return this.getDelegate(e).gradingWithRubricStateRef(t,n)}gradingWithFeedbackStateRef(e,t,n){return this.getDelegate(e).gradingWithFeedbackStateRef(t,n)}getNeedsGradingIconByContentHandler(e){let t=this.getDelegateByContentHandler(e).getScoreProviderHandle();return t?(Array.isArray(t)&&(t=t[0]),t.needsGradingIcon):null}getNeedsReconcilingIconByContentHandler(e){let t=this.getDelegateByContentHandler(e).getScoreProviderHandle();return t?(Array.isArray(t)&&(t=t[0]),t.needsReconcilingIcon):null}supportsOverall(e){return this.getDelegate(e).supportsOverall()}supportsEdit(e){return this.getDelegate(e).supportsEdit()}supportsViewItem(e){return this.getDelegate(e).supportsViewItem()}supportsExternalEdit(e){if(s.p.ContentHandler.PartnerCloud.isEqualTo(e)||s.p.ContentHandler.LtiLink.isEqualTo(e))return this.getDelegate(e).supportsExternalEdit()}}E.$inject=["$rootScope","$injector"],E.SCORE_PROVIDER_DELEGATES=[class extends S{getScoreProviderHandle(){return o.O.UltraAssignment}openStateRef(e,t){return this.takeActionOnStateRef("assignment.router",{courseId:e.courseId,assignmentId:e.contentId},t)}studentViewStateRef(e,t){return this.takeActionOnStateRef("assignment.view",{courseId:e.courseId,assignmentId:e.contentId},t)}editStateRef(e,t){return e.gradeitemView="details",this.takeActionOnStateRef("gradebook-item.assignment",e,t)}gradingStateRef(e,t,n,a){t.gradeitemView="students";let i="assignment-grading";const s=null==n?void 0:n.hasAttempts(),o=y(n);return n&&(s&&!o||!s&&!(null==n?void 0:n.isSubmitted())&&!o)&&(i=r.w.GRADE_AND_FEEDBACK),this.takeActionOnStateRef(i,t,a)}getSubmissionsListStateRef(e,t){return e.gradeitemView="students",(null==e?void 0:e.needsGrading)&&(delete e.needsGrading,e.gradingStatus=p.O.needsGrading),this.takeActionOnStateRef("gradebook-item.assignment",e,t)}supportsOverall(){return!0}},class extends S{getScoreProviderHandle(){return o.O.Attendance}openStateRef(e,t){return this.takeActionOnStateRef("attendance",e,t)}studentViewStateRef(e,t){return this.takeActionOnStateRef("attendance-student-view",e,t)}editStateRef(e,t){return this.takeActionOnStateRef("attendance",e,t)}gradingStateRef(e,t,n,a){return this.takeActionOnStateRef("attendance",t,a)}getSubmissionsListStateRef(e,t){return this.takeActionOnStateRef("attendance",e,t)}supportsEdit(){return!1}supportsOverall(){return!0}},class extends S{getScoreProviderHandle(){return o.O.Discussion}openStateRef(e,t){return this.takeActionOnStateRef(r.r.DISCUSSION_VIEW_WITH_GRADING,e,t)}studentViewStateRef(e,t){return this.takeActionOnStateRef(r.r.DISCUSSION_VIEW_WITH_GRADING,e,t)}gradingStateRef(e,t,n,a){return this.takeActionOnStateRef(r.r.SUBMISSION_LIST,t,a)}editStateRef(e,t){return this.takeActionOnStateRef(r.r.DISCUSSION_VIEW_WITH_GRADING,e,t)}getSubmissionsListStateRef(e,t){return e.view="participants",(null==e?void 0:e.needsGrading)&&(delete e.needsGrading,e.gradingStatus=p.O.needsGrading),this.takeActionOnStateRef(r.r.DISCUSSION_VIEW_WITH_GRADING,e,t)}supportsOverall(){return!0}},class extends S{getScoreProviderHandle(){return o.O.Journal}openStateRef(e,t){return this.takeActionOnStateRef(r.A.JOURNAL_VIEW_WITH_PARTICIPATION,e,t)}studentViewStateRef(e,t){return this.takeActionOnStateRef(r.A.JOURNAL_VIEW_WITH_PARTICIPATION,{...e,view:"journal"},t)}editStateRef(e,t){return this.takeActionOnStateRef(r.A.JOURNAL_VIEW_WITH_PARTICIPATION,e,t)}getSubmissionsListStateRef(e,t){return(null==e?void 0:e.needsGrading)&&(delete e.needsGrading,e.submissionStatus=h.g.NeedsGrading),this.takeActionOnStateRef(r.A.JOURNAL_VIEW_WITH_PARTICIPATION,{...e,view:"participants"},t)}gradingStateRef(e,t,n,a){var i;const s=n.memberId,o=e.contentId,l=(null==n?void 0:n.memberId)||t.membershipId,c=(null===(i=null==n?void 0:n.user)||void 0===i?void 0:i.$pk)||(null==n?void 0:n.userId)||t.userId;return this.takeActionOnStateRef(r.A.JOURNAL_PARTICIPATION_DETAIL,{...t,participantId:s,contentId:o,singleMembershipId:l,singleUserId:c},a)}supportsOverall(){return!0}},class extends S{getScoreProviderHandle(){return o.O.LTILink}openStateRef(e,t){return this.takeActionOnStateRef(r.C.LTI_LAUNCH,{courseId:e.courseId,contentId:e.contentId},t)}studentViewStateRef(e,t){return this.takeActionOnStateRef(r.C.LTI_LAUNCH,{courseId:e.courseId,contentId:e.contentId},t)}getSubmissionsListStateRef(e,t){return this.takeActionOnStateRef(r.C.LTI_LAUNCH,{courseId:e.courseId,contentId:e.contentId},t)}supportsOverall(){return!0}supportsExternalEdit(){return!0}},class extends S{getScoreProviderHandle(){return o.O.PartnerCloud}openStateRef(e,t){return this.takeActionOnStateRef(r.C.LTI_LAUNCH,{courseId:e.courseId,contentId:e.contentId},t)}studentViewStateRef(e,t){let n;return n=e.linkRef?{courseId:e.courseId,linkRef:e.linkRef,linkType:o.O.PartnerCloud.toString()}:{courseId:e.courseId,contentId:e.contentId},this.takeActionOnStateRef(r.C.LTI_LAUNCH,n,t)}editStateRef(e,t){return this.takeActionOnStateRef("content-manage.edit.partnercloud",{courseId:e.courseId,id:e.contentId},t)}getSubmissionsListStateRef(e,t){return this.takeActionOnStateRef(r.C.LTI_LAUNCH,{courseId:e.courseId,contentId:e.contentId},t)}supportsOverall(){return!0}supportsViewItem(){return!0}supportsEdit(){return!1}supportsExternalEdit(){return!0}},class extends S{getScoreProviderHandle(){return o.O.Scorm}studentViewStateRef(e,t){return this.takeActionOnStateRef("scorm-overview.student",e,t)}openStateRef(e,t){return this.takeActionOnStateRef("scorm.open",e,t)}editStateRef(e,t){return this.takeActionOnStateRef("scorm-settings",e,t)}gradingStateRef(e,t,n,a){var i;let s=r.w.SUBMISSION_GRADING;const o=null==n?void 0:n.hasAttempts(),l=y(n),c=(null===(i=null==n?void 0:n.attempts)||void 0===i?void 0:i.length)>e.multipleAttempts;if(n&&(o&&!l||!o&&(!(null==n?void 0:n.isSubmitted())&&!l||f(n))))s=r.w.GRADE_AND_FEEDBACK;else if((e.isMultipleAttempts()||c)&&l){if(t.attemptId)return this.takeActionOnStateRef(s,null,a);s=r.n.COURSE_GRADES_MULTIPLE_ATTEMPT}return this.takeActionOnStateRef(s,t,a)}gradingWithFeedbackStateRef(e,t){return this.takeActionOnStateRef("submission-grading.peek.assessment-submission-feedback",e,t)}getSubmissionsListStateRef(e,t){return e.gradeitemView="students",this.takeActionOnStateRef("gradebook-item.scorm-submissions",e,t)}supportsOverall(){return!0}},C],E.NULL_DELEGATE=new class extends S{}(null);class I extends E{}i.module(g,[l.b,c.a,d.a]).service(b,E)},"90v0":function(e,t){e.exports='<div class="preview-header"\n     ng-if="shouldShowHeader && !previewHeader.studentPreview.isInIframeOfPreviewMode()"\n     role="banner">\n  <div>\n    <h2 bb-translate course-org-token-resolver>course.outline.previewCourse.headerBar.title</h2>\n    <div ng-if="hasExceptionReport">\n      <bb-translate>course.outline.previewCourse.headerBar.description</bb-translate>\n      <a href="javascript:void(0);" bb-peek-sref="conversion-risk-analysis" bb-translate\n         analytics-id="course.outline.previewCourse.headerBar.exceptionsLink">course.outline.previewCourse.headerBar.exceptionsLink</a>\n    </div>\n  </div>\n</div>\n'},"94iD":function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i}));var a,i,r=n("zGdY"),s=n("eUpQ");class o{constructor(e){this.apiData=e}get testType(){if(!this.apiData.timeLimitSec)return this.apiData.dueDate?i.EnforcedDueDateTest:i.NotATimedTest;switch(this.apiData.timerCompletion||""){case r.ac.Continual:return i.UnlimitedExtraTime;case r.ac.HardStop:return this.apiData.softLimitSec?i.LimitedExtraTime:i.NoExtraTime;default:return this.apiData.dueDate?i.EnforcedDueDateTest:i.NotATimedTest}}get adaptedTime(){switch(this.testType){case i.NoExtraTime:return{elapsedSeconds:this.apiData.elapsedSec,softlimitSeconds:this.apiData.timeLimitSec,hardlimitSeconds:this.apiData.timeLimitSec};case i.UnlimitedExtraTime:return{elapsedSeconds:this.apiData.elapsedSec,softlimitSeconds:this.apiData.timeLimitSec,hardlimitSeconds:Number.POSITIVE_INFINITY};case i.LimitedExtraTime:return{elapsedSeconds:this.apiData.elapsedSec,softlimitSeconds:this.apiData.softLimitSec,hardlimitSeconds:this.apiData.timeLimitSec};case i.EnforcedDueDateTest:return{elapsedSeconds:s.a.getServerTimeAsEpochTime(),softlimitSeconds:this.dueDateAsEpochTime,hardlimitSeconds:this.dueDateAsEpochTime};default:return{elapsedSeconds:NaN,softlimitSeconds:NaN,hardlimitSeconds:NaN}}}get dueDateAsEpochTime(){return this.apiData.dueDate?this.apiData.dueDate.getTime()/1e3:null}get stages(){if(this.dueDateAsEpochTime&&!this.withinDueDatelimit)return[a.StageE];switch(this.testType){case i.NoExtraTime:return this.getStagesForNoExtraTimeTest();case i.UnlimitedExtraTime:return this.getStagesForUnlimitedExtraTimeTest();case i.LimitedExtraTime:return this.getStagesForLimitedExtraTimeTest();case i.EnforcedDueDateTest:return this.getStagesForEnforcedDueDateTest()}}getStagesForNoExtraTimeTest(){if(this.testType===i.NoExtraTime)return this.dueDateIsSoonerThanHardTimeLimit?[a.StageEnforcedDueDate]:this.withinHardlimit?[a.Stage0NoExtraTime]:[a.StageE]}getStagesForUnlimitedExtraTimeTest(){if(this.testType===i.UnlimitedExtraTime)return this.dueDateIsSoonerThanSoftTimeLimit?[a.StageEnforcedDueDate]:this.dueDateIsSoonerThanHardTimeLimit?this.withinLimit?[a.Stage0UnlimitedExtraTime,a.StageEnforcedDueDate]:[a.StageEnforcedDueDate]:this.withinLimit?[a.Stage0UnlimitedExtraTime,a.Stage1UnlimitedExtraTime]:[a.Stage1UnlimitedExtraTime]}getStagesForLimitedExtraTimeTest(){if(this.testType===i.LimitedExtraTime)return this.dueDateIsSoonerThanSoftTimeLimit?[a.StageEnforcedDueDate]:this.dueDateIsSoonerThanHardTimeLimit?this.withinLimit?[a.Stage0LimitedExtraTime,a.StageEnforcedDueDate]:[a.StageEnforcedDueDate]:this.withinLimit?[a.Stage0LimitedExtraTime,a.Stage1LimitedExtraTime]:this.withinHardlimit?[a.Stage1LimitedExtraTime]:[a.StageE]}getStagesForEnforcedDueDateTest(){if(this.testType===i.EnforcedDueDateTest)return this.withinDueDatelimit?[a.StageEnforcedDueDate]:[a.StageE]}get hasTimeLimit(){return this.testType!==i.EnforcedDueDateTest&&this.testType!==i.NotATimedTest}get hasExtraTime(){return this.testType===i.LimitedExtraTime||this.testType===i.UnlimitedExtraTime}get hasLimitedExtraTime(){return this.testType===i.LimitedExtraTime}get hasUnlimitedExtraTime(){return this.testType===i.UnlimitedExtraTime}get withinLimit(){return this.adaptedTime.elapsedSeconds<this.adaptedTime.softlimitSeconds}get withinHardlimit(){return this.adaptedTime.elapsedSeconds<this.adaptedTime.hardlimitSeconds}get withinDueDatelimit(){return this.dueDateAsEpochTime&&s.a.getServerTimeAsEpochTime()<this.dueDateAsEpochTime}get dueDateIsSoonerThanHardTimeLimit(){return this.dueDateIsSoonerThanTimeLimit(this.adaptedTime.hardlimitSeconds)}get dueDateIsSoonerThanSoftTimeLimit(){return this.dueDateIsSoonerThanTimeLimit(this.adaptedTime.softlimitSeconds)}dueDateIsSoonerThanTimeLimit(e){var t;return this.withinDueDatelimit&&this.dueDateAsEpochTime-s.a.getServerTimeAsEpochTime()<e-(null!==(t=this.adaptedTime.elapsedSeconds)&&void 0!==t?t:0)}get willAutoSubmit(){return this.testType===i.NoExtraTime||this.testType===i.LimitedExtraTime||this.testType===i.EnforcedDueDateTest}get displayedTimeLimitSeconds(){return this.adaptedTime.softlimitSeconds}get displayedExtraTimeSeconds(){return this.adaptedTime.hardlimitSeconds-this.adaptedTime.softlimitSeconds}getSubmissionRuleText(e,t){switch(this.testType){case i.NoExtraTime:return e.translateSync({locale:t,key:"course.content.assessment.test.settings.timeLimit.autoSubmission"});case i.UnlimitedExtraTime:return e.translateSync({locale:t,key:"course.content.assessment.test.settings.timeLimit.unlimitExtraTime"});case i.LimitedExtraTime:return e.translateSync({locale:t,key:"course.content.assessment.test.settings.timeLimit.extraTimeInfo.plural",params:{allowExtraTime:Math.floor(this.displayedExtraTimeSeconds/60)}});default:return""}}}!function(e){e.Stage0NoExtraTime="S0_NO_EXTRA",e.Stage0UnlimitedExtraTime="S0_UNLIMITED_EXTRA",e.Stage1UnlimitedExtraTime="S1_UNLIMITED_EXTRA",e.Stage0LimitedExtraTime="S0_LIMITED_EXTRA",e.Stage1LimitedExtraTime="S1_LIMITED_EXTRA",e.StageE="SE",e.StageEnforcedDueDate="S0_ENFORCED_DUE_DATE"}(a||(a={})),function(e){e.NoExtraTime="NO_EXTRA",e.UnlimitedExtraTime="UNLIMITED_EXTRA",e.LimitedExtraTime="LIMITED_EXTRA",e.EnforcedDueDateTest="ENFORCED_DUE_DATE",e.NotATimedTest="NOT_TIMED"}(i||(i={}))},"9ZjI":function(e,t){e.exports='<bb-modal id="notification-modal-api-error"\n          class="notification error-not-found-modal"\n          modal-title-key="components.services.error-modal.error-not-found.title"\n          analytics-id-tag-prefix="components.services.error-modal.error-not-found">\n  <div name="modal-contents">\n    <p bb-translate>components.services.error-modal.error-not-found.description</p>\n    <pre>{{ response | json }}</pre>\n    <bb-session-debug-modal-button></bb-session-debug-modal-button>\n  </div>\n  <button name="modal-footer-button-primary"\n          class="button large reload-page-button js-primary-button"\n          onclick="location.reload(true)"\n          analytics-id="components.services.error-modal.reloadPage"\n          bb-translate>components.services.error-modal.reloadPage</button>\n</bb-modal>\n'},"9p8+":function(e,t){e.exports='<bb-modal id="notification-modal-api-error"\n          class="notification"\n          modal-title-key="components.services.error-modal.error-discussion-due-date.title"\n          analytics-id-tag-prefix="components.services.error-modal.error-discussion-due-date">\n  <div name="modal-contents">\n    <p bb-translate>components.services.error-modal.error-discussion-due-date.description</p>\n  </div>\n  <button name="modal-footer-button-primary"\n          ng-click="$parent.$dismiss()"\n          class="button js-primary-button"\n          analytics-id="components.services.error-modal.error-discussion-due-date.ok"\n          bb-translate>global.ok</button>\n</bb-modal>\n'},"9zo4":function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return d})),n.d(t,"a",(function(){return m}));n("my/J");var a=n("Llzl"),i=n("71td"),r=n("XGja"),s=n("+4Px"),o=n("lUN/"),l=n("tMbR");const c="ultra.services.accessibility",d="accessibility";class u{constructor(e){this.$rootScope=e,this.FOCUSED_ELEMENT="focusedElement",this.FOCUS_SELECTOR_OVERRIDE="focusSelectorOverride",this.isFocusDelayed=!1,this.panelInfoStack=[{panelElement:i(document.body)}],this.currentPanelInfo=this.panelInfoStack[this.panelInfoStack.length-1],this.activePanel=this.currentPanelInfo.panelElement,this.isFocusedElementInFocusTrap=()=>!!i(document.activeElement).closest(".ms-FocusTrapZone").length,this.focusCorrectElementOnPanel=function(e=this.activePanel){if(this.isFocusDelayed=!1,Object(l.b)())return;const t=i(".ms-Callout");if(t&&t.length)return;const n=i(".ms-Modal");if(n&&n.length)return;const a=i(".datepicker-dropdown");if(a&&a.length)return;const s=i('div[class*="MuiDialogcontainer"]');if(s&&s.length)return;const o=i('div[data-analytics-id="course.outline.oneDriveFilePickerLTIModal"]');if(null==o?void 0:o.length)return;const c=i('div[class*="MuiPopoverroot"]');if(null==c?void 0:c.length)return;if(this.isFocusedElementInFocusTrap())return;const d=e.find("[bb-focus]");if(d&&d.length){const e=d.first();if(e.trigger("focus"),this.elementHasFocus(e))return}const u=e.find("h1").filter(":visible");if(u&&u.length){const e=u.first();if(r.a(e),this.elementHasFocus(e))return}const m=e.find(":tabbable:not(.bb-close, .non-first-focus):first");m&&m.length&&(m.trigger("focus"),this.elementHasFocus(m))||r.a(e)},this.elementHasFocus=e=>e.is(i(document.activeElement)),this.isElementInActivePanel=e=>e.hasClass("pagehelp-directive-link")||!!e.closest(".focus-handling-disabled").size()||this.isElementInPanel(this.activePanel,e),this.isElementInPanel=(e,t)=>e.is(t)||i.contains(e[0],i(t)[0]),this.applyFocusinHandler=()=>{i("body").off("focusin.axService"),i("body").on("focusin.axService",(e=>{const t=i(e.target);this.isFocusDelayed||this.isElementInActivePanel(t)||this.focusCorrectElementOnPanel(this.activePanel)}))},this.removeFocusinHandler=()=>{i("body").off("focusin.axService")},this.backgroundElementsStack=[],o.a(),this.applyFocusinHandler();const t=e=>{this.isElementInActivePanel(i(e.target))||this.removeFocusinHandler()};i("body").on("mousedown",t),e.$on("$destroy",(()=>{i("body").off("mousedown",t)}))}applyAccessibilityHandlingForPanel(e){this._storeFocusedElement(),this._setActivePanel(e),this._applyTabCapture(),this.ariaHideBackgroundElements()}revertAccessibilityHandling(){this.ariaShowBackgroundElements(),this._revertTabCapture(this.currentPanelInfo),this._restoreActivePanel(),this._restoreFocusedElement()}_setActivePanel(e){this.activePanel=null,this.activePanel=e,this.currentPanelInfo={panelElement:e,overlayDisabled:e.hasClass("overlay-disabled"),panelFocusHandlingDisabled:e.hasClass("focus-handling-disabled")},this.panelInfoStack.push(this.currentPanelInfo),i(".bb-offcanvas-panel").removeClass("panel-has-focus"),this.activePanel.addClass("panel-has-focus"),this.applyFocusinHandler()}_restoreActivePanel(){this.panelInfoStack.length<2&&(this._setActivePanel(i(document.body)),this._setActivePanel(i(document.body)));this.panelInfoStack.pop().panelElement=null,this.currentPanelInfo=this.panelInfoStack[this.panelInfoStack.length-1],this.activePanel=null,this.activePanel=this.currentPanelInfo.panelElement,i(".bb-offcanvas-panel").removeClass("panel-has-focus"),this.activePanel.addClass("panel-has-focus"),this.applyFocusinHandler()}ariaHideBackgroundElements(e=!0){const t=i('.hide-in-background[aria-hidden!="true"]');t.attr("aria-hidden","true"),this.backgroundElementsStack.push(t),e&&this.activePanel.attr("aria-hidden","false")}ariaShowBackgroundElements(){if(this.backgroundElementsStack.length<1)throw i(".hide-in-background").attr("aria-hidden","false"),new Error("Tried to set aria-hidden=false for background elements, but there were no background elements in the stack.");let e=this.backgroundElementsStack.pop().attr("aria-hidden","false");e=null}setFocusOverrideOnPanel(e,t){if(!t)throw new Error("A panel selector is required to override focus on a panel");for(let n=this.panelInfoStack.length-1;n>=0;n--)if(this.panelInfoStack[n].panelElement.find(t).addBack(t).length){this.panelInfoStack[n].panelElement.data(this.FOCUS_SELECTOR_OVERRIDE,e);break}}_storeFocusedElement(){let e=i(document.activeElement);!m.isLastNavigationByKeyboard&&m.lastClickedElement&&m.lastClickedElement.length&&(e=m.lastClickedElement),this.activePanel.data(this.FOCUSED_ELEMENT,e),e=null}_restoreFocusedElement(){if(this.isFocusDelayed=!1,this.activePanel.data(this.FOCUS_SELECTOR_OVERRIDE)){const e=this.activePanel.find(this.activePanel.data(this.FOCUS_SELECTOR_OVERRIDE)).addBack(this.activePanel.data(this.FOCUS_SELECTOR_OVERRIDE)).first();e.length&&this.activePanel.data(this.FOCUSED_ELEMENT,e),this.activePanel.data(this.FOCUS_SELECTOR_OVERRIDE,"")}let e=this.activePanel.data(this.FOCUSED_ELEMENT);e&&0!==e.length&&e.focus(),e&&e.length&&i(document.activeElement).is(e)||this.focusCorrectElementOnPanel(this.activePanel),this.activePanel.removeData(this.FOCUSED_ELEMENT),e=null}_applyTabCapture(){this.activePanel.on("keydown",(e=>{if(e.keyCode===s.u&&!this.currentPanelInfo.tabCalled){let e=this.activePanel.data("axMutationObserver");e||(e=new MutationObserver((()=>{this.currentPanelInfo.tabCalled=!1})),e.observe(this.activePanel[0],{childList:!0,attributes:!0,subtree:!0}),this.activePanel.data("axMutationObserver",e));const t=i(this.activePanel).find("*").addBack();this._conditionallyUpdateSkipLinkFocus(),i(":tabbable, .ax-tabbable").not(".bb-ax-background-tabindex").add(i('a[tabindex!="-1"]').filter((function(){return 0===i(this).height()&&0===i(this).width()}))).filter((function(){return 0===i(this).closest(".focus-handling-disabled").size()})).add(i('div.editor-element[tabindex!="-1"]')).not(t).not(i(".pagehelp-directive-link")).add(i('div.panel-wrap[tabindex!="-1"]')).each((function(){i(this).data("originalTabindex",this.getAttribute("tabindex"))})).attr("tabindex","-1").addClass("bb-ax-background-tabindex"),this.currentPanelInfo.tabCalled=!0}}))}_revertTabCapture(e,t){const n=t||i(document);n.find(".bb-ax-background-tabindex").each((function(){const e=i(this);null==e.data("originalTabindex")?e.removeAttr("tabindex"):e.attr("tabindex",e.data("originalTabindex")),e.removeAttr("originalTabindex")})).removeClass("bb-ax-background-tabindex"),n.data("axMutationObserver")&&n.data("axMutationObserver").disconnect()}_revertTabCaptureForActivePanel(){this._revertTabCapture(this.currentPanelInfo)}_conditionallyUpdateSkipLinkFocus(){this.currentPanelInfo.overlayDisabled&&!this.currentPanelInfo.panelFocusHandlingDisabled&&this.panelInfoStack.length>1&&this._revertTabCapture(this.panelInfoStack[this.panelInfoStack.length-2],this.activePanel)}}u.isLastNavigationByKeyboard=!1,u.$inject=["$rootScope"];class m extends u{}a.module(c,[]).service(d,u)},"A+IJ":function(e,t,n){"use strict";n.d(t,"k",(function(){return a})),n.d(t,"l",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return s})),n.d(t,"e",(function(){return o})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return c})),n.d(t,"h",(function(){return d})),n.d(t,"d",(function(){return u})),n.d(t,"a",(function(){return m})),n.d(t,"m",(function(){return p})),n.d(t,"j",(function(){return h})),n.d(t,"i",(function(){return g}));const a=1,i=2,r="#c575d2",s="#1874a4",o="#333333",l="#666666",c="#e5e5e5",d="#cdcdcd",u="#ffffff",m="#f0f0f0",p="Open Sans",h=`600 12px ${p}`,g=`700 12px ${p}`},A4cK:function(e,t){e.exports="<div ng-transclude></div>"},Afl9:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n("UE5/"),i=n("jZnR"),r=n("QgAF");const s=Object(a.a)((e=>Object(i.a)({icon:{zIndex:1},animatedIconButton:{position:"relative","&:focus:before":{boxShadow:"none"},"&:before":{animation:"$pulsate infinite linear 1.25s",animationIterationCount:4,borderRadius:"50%",content:'""',display:"block",height:"32px",marginTop:"-16px",position:"absolute",top:"50%",width:"32px",left:"50%",marginLeft:"-16px"},"&:after":{animation:"$circle 1 linear 5s forwards",borderRadius:"50%",content:'""',display:"block",height:"24px",marginTop:"-12px",position:"absolute",top:"50%",width:"24px",zIndex:0,left:"50%",marginLeft:"-12px"}},"@keyframes pulsate":{"0%":{border:`4px solid ${Object(r.fade)(e.palette.indicatorPrimary.main,.3)}`,transform:"scale(1, 1)"},"100%":{border:`4px solid ${Object(r.fade)(e.palette.indicatorPrimary.main,0)}`,transform:"scale(1.4, 1.4)"}},"@keyframes circle":{"0%":{background:Object(r.fade)(e.palette.indicatorPrimary.main,.3)},"90%":{background:Object(r.fade)(e.palette.indicatorPrimary.main,.3)},"100%":{background:Object(r.fade)(e.palette.indicatorPrimary.main,0)}}})))},BXiQ:function(e,t,n){"use strict";var a=n("Llzl"),i=n("71td"),r=n("nsO7"),s=n("Ymz8"),o=n("PdQf"),l=n("5Dl8"),c=n("pjml"),d=n("Q/M7"),u=n("DpvE"),m=n("gCXj"),p=n("IMr6"),h=n("VdDF");n.d(t,"a",(function(){return g}));const g="ultra.directives.user-avatar",b=a.module(g,[c.N,m.a]),f=p.replace(/\s+id="[^\"]+"\s*/," ").replace(/<svg /,'<svg stroke-width="3" stroke="#fff" ').replace(/\s+viewBox="(\d+ \d+ \d+ \d+)"/,(function(e,...t){const[n,a,i,r]=t[0].split(" ").map((e=>parseInt(e,10)));return' viewBox="'+[n-i/2,a-r/2,2*i,2*r].join(" ")+'"'})),v={avatar:{permanentUrl:"data:image/svg+xml;base64,"+s.codec.base64.fromBits(s.codec.utf8String.toBits(f))},lastModifiedAt:"",getInitials:r.noop},y=i('<style id="css-bb-user-avatar"></style>').appendTo("head"),S={};let C,E;const I=function(e){e.forEach((e=>{const t=e.id||e.$pk,n=S[t]=S[t]||{};if(null!=e.lastModifiedAt&&e.lastModifiedAt===n.lastModifiedAt||e.isPlaceHolder)return;n.avatarURL=void 0,n.isAvailable=e.isAvailable,n.lastModifiedAt=e.lastModifiedAt;const a=e.avatar&&"default"!==e.avatar.permanentUrl;if(a){let t=e.avatar.permanentUrl;if(e.avatar.permanentUrl.startsWith("http")){const n=(h.a.isValidDate(e.lastModifiedAt)?e.lastModifiedAt:new Date).getTime();t=Object(d.a)(e.avatar.permanentUrl,"ts",n)}n.avatarURL=t}const i=(e.getInitials||r.noop).apply(e);n.initials=!a&&i?i:void 0})),C()};b.config([m.b+"Provider",function(e){e.onStyleRefresh((function(e,t){t.isAvailable||(e.selector(`bb-user-avatar.u${t.userId}:after`).rule("display","block"),e.selector(`bb-user-avatar.u${t.userId} > div`).rule("opacity",".3"))}))}]).run(["$rootScope",c.Jb.serviceName,function(e,t){C=r.debounce((()=>{const e=new l.a;r.forEach(S,((t,n)=>{const a=e.selector(`bb-user-avatar.u${n}`);t.avatarURL?(a.selector(".image:after").rule("background-image",`url("${t.avatarURL}")`).rule("display","block"),a.selector(".image:before").rule("display","none")):t.initials&&(a.selector(".image").rule("display","none"),a.selector(".initials").rule("display","block"),a.selector(".initials:after").rule("content",`"${t.initials}"`)),!1===t.isAvailable&&e.selector(`bb-user-avatar.u${n}:after`).rule("display","block")}));const t=e.build();y.text()!==t&&y.text(t)}),200),E=r.once((function(){t.$mixHook("after-feed",(function(){const e=Array.prototype.concat.call([],this);I(e)}))}))}]).directive("bbUserAvatar",(function(){return{restrict:"E",template:u,scope:{user:"=?"},link(e,t){E(),t.addClass("avatar element-image");e.$watch("user",((e,n)=>{e&&(o.i(e)&&r.extend(e,v),t[0].className=t[0].className.split(/\s+/).filter((e=>!/^u\w+$/.test(e))).join(" "),t.addClass(`u${e.id||e.$pk}`),I([e]))}))}}}))},BrA8:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));n("JzsJ");var a=n("Llzl"),i=n("pjml"),r=n("0JpG"),s=n("Fvsw"),o=n("bF8R"),l=n("jhBu"),c=n("o5Lu"),d=n("TnpK"),u=n("Qbdf"),m=n("X455"),p=n("nmzr"),h=n("IbyE");const g="ultra.course.content.lti.routes";a.module(g,[r.moduleName,o.a,l.a,c.m,d.b,u.b,m.a]).config([d.c,u.c,m.b,(e,t,a)=>{e.peekState(p.C.LTI,{abstract:!0,url:"/lti"}).peekState(p.C.LTI_LAUNCH,{url:"/launch?courseId&contentId&linkRef&linkType",resolve:{translations:[r.serviceName,e=>e.loadBundle("features/course/content/course-content")],[m.c]:a.resolve,[u.d]:t.resolve,currentContent:["$q",d.d,i.S.serviceName,i.m.serviceName,(e,t,n,a)=>{const i=e.defer(),r=t.nextParams.courseId?t.nextParams.courseId:t.prevParams.courseId,s=t.nextParams.contentId?t.nextParams.contentId:t.prevParams.contentId,o=t.nextParams.linkRef?t.nextParams.linkRef:t.prevParams.linkRef,l=t.nextParams.linkType?t.nextParams.linkType:t.prevParams.linkType;return r&&s?a.$new(r).contents.$find(s).$asPromise().then((e=>i.resolve(e))):r&&o&&h.O.PartnerCloud.isEqualTo(l)?n.getContentIds(r,o).then((e=>{e.contentIds&&e.contentIds.length>0?a.$new(r).contents.$find(e.contentIds[0]).$asPromise().then((e=>i.resolve(e))):i.resolve(null)})):i.resolve(null),i.promise}],currentGradeColumn:["$q",u.d,"currentContent",s.b,(e,t,n)=>{if(t&&n){const e=n.contentDetail[n.contentHandler.toString()].gradingColumn.id;return t.gradebook.columns.$find(e).$asPromise()}return e.when(null)}],contentData:["$q",u.d,"currentContent","currentGradeColumn",o.b,(e,t,n,a,i)=>{if(t&&n&&a)return i.loadContentAndGrades({course:t,content:n,column:a});e.when(null)}]},panelClass:"peek",require:()=>Promise.all([n.e(1),n.e(2),n.e(629)]).then(n.bind(null,"7CZ/")),pageTitle:" Launch"}).peekState(p.C.LTI_LAUNCH_FRAME,{url:"/launchFrame?toolHref",resolve:{translations:[r.serviceName,e=>e.loadBundle("features/course/content/course-content")]},panelClass:"full",require:()=>Promise.all([n.e(1),n.e(2),n.e(630)]).then(n.bind(null,"I/hb")),pageTitle:"course.content.ltiLaunchFrameTitle"}).peekState(p.C.LTI_LAUNCH_PEEK,{url:"/launchPeek?toolHref&courseId&contentId",resolve:{translations:[r.serviceName,e=>e.loadBundle("features/course/content/course-content")]},peekStates:[p.k.CONDITIONAL_RELEASE_PEEK_PANEL,p.C.LTI_EDIT_CLOUD_DOCUMENT,p.r.CONVERSATION],panelClass:"full",require:()=>Promise.all([n.e(1),n.e(2),n.e(633)]).then(n.bind(null,"BY6k")),pageTitle:"course.content.ltiLaunchFrameTitle"}).peekState(p.C.LTI_LAUNCH_CLOUD_CREATE,{url:"/launchCloudCreate?toolHref&courseId&contentId&placementId",resolve:{translations:[r.serviceName,e=>e.loadBundle("features/course/content/course-content")]},peekStates:[p.C.LTI_LAUNCH_PEEK],panelClass:"full",require:()=>Promise.all([n.e(1),n.e(2),n.e(651)]).then(n.bind(null,"KIJB")),pageTitle:"course.content.ltiLaunchFrameTitle"}).peekState(p.C.LTI_EDIT_CLOUD_DOCUMENT,{url:"/edit?contentId",resolve:{[u.d]:t.resolve,translations:["$q",r.serviceName,(e,t)=>e.all([t.loadBundle("features/course/content/course-content"),t.loadBundle("features/course/goal-alignment/goal")])]},panelClass:"peek",require:[()=>Promise.all([n.e(0),n.e(76),n.e(751)]).then(n.bind(null,"N/2L"))],peekViewName:"cloud-document-goal-peek",allowChildPeekStates:!0,peekStates:["goal-picker-legacy"]})}])},Bssh:function(e,t,n){"use strict";var a,i;!function(e){e.CREATE="CREATE",e.EDIT="EDIT",e.VIEW="VIEW"}(a||(a={})),function(e){e.GRID_VIEW="grid-view",e.STUDENT_LIST_VIEW="student-list-view",e.PARTICIPANTS_VIEW="participants-view"}(i||(i={}));var r=n("ERkP"),s=n.n(r),o=n("uDfI"),l=n("ERsv"),c=n("SToD"),d=n("nsO7"),u=n("IbyE");class m extends s.a.Component{constructor(e){super(e),this.setPristine=function(e){},this.onContentChange=e=>{this.setPristine=e.setPristine,this.props.editor.onEditorContentChanged(e)},this.onUploadSuccess=e=>{const{fileLocation:t,webLocation:n}=e;this.setState((()=>({fileLocation:t,webLocation:n}))),this.props.editor.pluginConfig&&this.props.editor.pluginConfig.onUploadSuccess&&this.props.editor.pluginConfig.onUploadSuccess(e)},this.getEditorElement=()=>document.querySelector("#feedback-authoring-container .bb-editor"),this.getAttachmentConfigurations=()=>{const{babelfishFormatInstance:e,babelfishInstance:t,editor:n,currentLocale:a,fileUploadSettings:i}=this.props,{apiBasePath:r,xsrfToken:s,courseId:o,onUploadSuccess:l}=n.pluginConfig,{webLocation:c,fileLocation:d}=this.state,u={apiBasePath:r,xsrfToken:s,webLocation:c,fileLocation:d,babelfishFormatInstance:e,babelfishInstance:t,onUploadSuccess:l,fileUploadSettings:i};return{commonUploadConfig:u,mathPluginConfig:{apiBasePath:r,xsrfToken:s,courseId:o,locale:a},cloudStorageIntegrationPluginConfig:{...u,...n.pluginConfig.insertCloudStorageIntegrationFile},videoEverywhereConfig:{apiBasePath:r,courseId:o,xsrfToken:s,isHidden:!0},youtubeVideoPluginConfig:{...u,...n.pluginConfig.insertYoutubeVideo},contentMarketConfig:{...u,...n.pluginConfig.contentMarket}}},this.prepareEditorPlugins=()=>{if(!this.props.editor.pluginConfig)return[Object(l.link)(),Object(l.image)(),Object(l.video)()];const{commonUploadConfig:e,mathPluginConfig:t,cloudStorageIntegrationPluginConfig:n,videoEverywhereConfig:a,youtubeVideoPluginConfig:i,contentMarketConfig:r}=this.getAttachmentConfigurations(),s=[Object(l.link)(),Object(l.image)(),Object(l.video)(),Object(l.insertLocalFile)(e),Object(l.math)(t),Object(l.videoEverywhere)(a)];return this.props.editor.pluginConfig.insertCloudStorageIntegrationFile&&n.openCloudStorageIntegrationModal&&s.push(Object(l.insertCloudStorageIntegrationFile)(n)),this.props.editor.pluginConfig.insertYoutubeVideo&&s.push(Object(l.insertYoutubeVideo)(i)),this.props.editor.pluginConfig.contentMarket&&s.push(Object(l.contentMarket)(r)),s},this.focusEditor=()=>{const e=this.getEditorElement();e&&e.focus()},this.state={fileLocation:e.editor.pluginConfig&&e.editor.pluginConfig.fileLocation||"",webLocation:e.editor.pluginConfig&&e.editor.pluginConfig.webLocation||""}}componentDidMount(){this.props.editor.isReadOnly||this.focusEditor()}componentDidUpdate(e){this.props.editor.shouldSetPristine&&this.setPristine&&this.setPristine(this.props.editor.bbml),this.props.editor.isReadOnly||this.focusEditor()}shouldComponentUpdate(e,t){return 0!==Object(d.differenceWith)([t],[this.state],d.isEqual).length||0!==Object(d.differenceWith)([e.editor],[this.props.editor],d.isEqual).length}render(){const{placeholder:e,editor:t}=this.props,n=this.prepareEditorPlugins();return!t.isReadOnly||t.isPrivileged||t.bbml?s.a.createElement(l.BbEditor,{bbml:t.bbml||"",isReadOnly:t.isReadOnly,isToolbarHidden:t.isToolbarHidden,plugins:n,placeholder:e,onBlur:t.onBlur,onChange:this.onContentChange,onFocus:t.onFocus,showWordCount:t.showWordCount,ariaLabelledBy:t.ariaLabelledBy}):s.a.createElement("div",null,s.a.createElement("i",null,e))}}const p=Object(o.b)((e=>({fileUploadSettings:u.Yb.fileUploadSettings.getFileUploadSettings(e)})))(Object(c.a)(m));var h=n("MC1S"),g=n("8jBL");class b extends s.a.Component{render(){const{analyticsId:e,localize:t,openAccommodationsPanel:n,isGroupContent:a,accommodationCount:i}=this.props;return s.a.createElement("div",{className:"element-card element-info-list row"},s.a.createElement("div",{className:"element-image icon columns small-2"},s.a.createElement(g.Accommodations,null)),s.a.createElement("div",{id:"element-due-date-option",className:"element-details element-info-details columns small-10"},s.a.createElement("div",{className:"name"},s.a.createElement("span",null,t.translate("journals.settingsPanel.accommodations.settings.label"))),s.a.createElement("div",null,s.a.createElement(h.Link,{id:"element-accommodation-link",analyticsId:`${e}.accommodations.link`,onClick:n,href:"#"},a?s.a.createElement("span",null,t.translate("journals.settingsPanel.accommodations.settings.groups.plural",{number:i})):s.a.createElement("span",null,t.translate("journals.settingsPanel.accommodations.settings.students.plural",{number:i}))))))}}const f=Object(c.a)(b);class v extends s.a.Component{constructor(){super(...arguments),this.onClick=()=>{const{onClick:e}=this.props;e&&e()}}renderDateData(){const{analyticsId:e,localize:t,dueDate:n,canEdit:a}=this.props;let i=s.a.createElement("span",{id:"element-due-date"},t.translate("journals.settingsPanel.dueDate.isntDated"));return a&&!n?i=s.a.createElement(h.Link,{id:"element-due-date",analyticsId:`${e}.dueDate.link`,href:"#",onClick:this.onClick},t.translate("journals.settingsPanel.dueDate.isntDated")):a&&n?i=s.a.createElement(h.Link,{id:"element-due-date",analyticsId:`${e}.dueDate.link`,href:"#",onClick:this.onClick},t.translate("journals.settingsPanel.dueDate.dueDateFormat",{datetime:n})):!a&&n&&(i=s.a.createElement("span",{id:"element-due-date"},t.translate("journals.settingsPanel.dueDate.dueDateFormat",{datetime:n}))),s.a.createElement("div",null,i)}render(){const{localize:e}=this.props;return s.a.createElement("div",{className:"element-card element-info-list row"},s.a.createElement("div",{className:"element-image icon columns small-2"},s.a.createElement(g.Calendar,null)),s.a.createElement("div",{id:"element-due-date-option",className:"element-details element-info-details columns small-10"},s.a.createElement("span",{className:"name"},e.translate("journals.settingsPanel.dueDate.title")),this.renderDateData()))}}const y=Object(c.a)(v);var S=n("ZQFV"),C=n("0x+l"),E=n("Gvux"),I=n("nmzr"),k=n("tN4z"),w=n("zGdY");const T=e=>{var t;return!((null==e?void 0:e.manualStatus)!==w.Bb.IsPosted||!(null===(t=null==e?void 0:e.displayGrade)||void 0===t?void 0:t.isOverride)||null==e.displayGrade.score)||!((null==e?void 0:e.status)!==w.J.Graded||!(null==e?void 0:e.displayGrade)||e.displayGrade.isOverride||null==e.displayGrade.score)},O=e=>{var t;return(null==e?void 0:e.manualStatus)===w.Bb.NoOverride&&(null==e?void 0:e.status)===w.J.NeedsGrading&&null!=(null===(t=null==e?void 0:e.displayGrade)||void 0===t?void 0:t.score)||(null==e?void 0:e.manualStatus)===w.Bb.ReadyToPost},A=e=>e===w.Ub.Percent?S.p.Percentage:e===w.Ub.Tabular?S.p.Tabular:S.p.Points,P=(e,t,n)=>n===S.p.Percentage&&void 0!==e?e*t/100:e;var x=n("THXI");class $ extends s.a.Component{constructor(e){super(e),this.calloutId="automatic-zeros-callout",this.gradeColorVariant=(e,t)=>e?t.isExempt?S.F.Grey:null:S.F.Black,this.onCalloutClick=()=>{this.setState((e=>({isCalloutVisible:!e.isCalloutVisible}))),setTimeout((()=>{this.state.isCalloutVisible&&document.getElementById(this.calloutId).focus()}))},this.onCalloutDismiss=()=>{this.setState({isCalloutVisible:!1});this.automaticZeroButtonElement.childNodes[0].focus()},this.onMouseEnterZeroButton=()=>{this.setState({isCalloutVisible:!0})},this.onMouseLeaveZeroButton=e=>{-1===(e&&e.relatedTarget&&e.relatedTarget.className||"").indexOf("ms-Callout")&&this.setState({isCalloutVisible:!1})},this.onClick=()=>{const{onClick:e}=this.props;e&&e()},this.onGradeSchemaClick=()=>{const{onGradeSchemaClick:e}=this.props;e&&e()},this.handleOnFeedbackClick=()=>{var e,t;I.Z.goPeekState(I.z.JournalSubmissionFeedback({columnId:null===(e=this.props.gradeColumn)||void 0===e?void 0:e.id,userId:null===(t=this.props.grade)||void 0===t?void 0:t.userId}))},this.handleOnRubricIconClick=()=>{const{grade:e}=this.props;e.displayGrade.isOverride?I.Z.goPeekState(I.H.RubricView({columnId:e.columnId})):I.Z.goPeekState(I.H.RubricEvaluation({userId:e.userId,columnId:e.columnId}))},this.state={isCalloutVisible:!1}}renderInstructorGradeInformation(){const{analyticsId:e,localize:t,possible:n,gradeSchema:a,disabled:i}=this.props,r=a&&a.ui,o=r&&(r.displayTitle||r.displayTitleKey&&t.translate(r.displayTitleKey));return null==n?s.a.createElement(h.Link,{analyticsId:`${e}.grading.link`,href:"#",onClick:this.onClick,disabled:i},t.translate("journals.settingsPanel.grade.isntGraded")):s.a.createElement("div",null,s.a.createElement(h.Link,{analyticsId:`${e}.gradeSchema.link`,href:"#",id:"element-grade-schema",onClick:this.onGradeSchemaClick,disabled:i},o),s.a.createElement("span",{className:"grading-separator"}," | "),s.a.createElement(h.Link,{analyticsId:`${e}.points.link`,href:"#",id:"element-points",onClick:this.onClick,disabled:i},t.translate("journals.settingsPanel.grade.points.plural",{points:n})))}renderStudentGradeInformation(){var e;const{localize:t,possible:n,grade:a,gradeSchema:i,gradeColumn:r,isColorEnabled:o,analyticsId:l}=this.props,c=i&&i.scaleType,d=!!(null===(e=null==a?void 0:a.instructorFeedback)||void 0===e?void 0:e.rawText);let u;return u=a&&a.displayGrade?s.a.createElement("div",{className:"student-grade panel"},s.a.createElement("div",{className:"grade-information"},s.a.createElement("div",{className:"content-icon"},s.a.createElement(E.Journal,{className:"content-icon",color:"primary"})),s.a.createElement("span",null,t.translate("journals.settingsPanel.grade.student.contentType.journal"))),s.a.createElement("div",{className:"grade-pill"},s.a.createElement(S.H,{grade:P(a.displayGrade.score,a.pointsPossible,A(c)),pointsPossible:a.pointsPossible,variant:A(c),symbolGrade:a.displayGrade.grade,gradeColorVariant:this.gradeColorVariant(o,a)},r.rubricAssociations&&s.a.createElement(S.I,{ariaLabel:t.translate("journals.settingsPanel.grade.student.rubric"),onClick:this.handleOnRubricIconClick,analyticsId:`${l}.readonlyGradePill.rubricIcon`})),!!d&&s.a.createElement(k.AnalyticsIconButton,{"aria-label":t.translate("journals.settingsPanel.grade.feedbackAriaLabel"),analyticsId:`${l}.feedback`,onClick:this.handleOnFeedbackClick,className:"feedback-button"},s.a.createElement(g.Feedback,{className:"feedback-icon",htmlColor:x.c.purpleDark})),a.isExempt&&s.a.createElement("span",{className:"exempt-tag"},t.translate("journals.settingsPanel.grade.exempt")))):s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"student-grade panel max-points-info"},s.a.createElement("span",null,t.translate("journals.settingsPanel.grade.maximumGrade"))),s.a.createElement("div",{className:"student-grade panel max-points-value"},s.a.createElement("span",null,t.translate("journals.settingsPanel.grade.student.points.plural",{points:n})))," "),s.a.createElement("div",{className:"grade-box"},u)}renderAutomaticZeroInformation(){const{localize:e,analyticsId:t,grade:n}=this.props,{isCalloutVisible:a}=this.state;return s.a.createElement(s.a.Fragment,null,!n.isExempt&&s.a.createElement("div",{className:"automatic-zero-alert automatic-zero"},s.a.createElement("div",{className:"automatic-zero-message"},s.a.createElement("span",null,e.translate("journals.settingsPanel.grade.student.automaticZeroAlert"))),s.a.createElement("div",{className:"automatic-zero-button",ref:e=>this.automaticZeroButtonElement=e},s.a.createElement(k.AnalyticsIconButton,{analyticsId:`${t}.automaticZero.information.button`,onClick:this.onCalloutClick,onMouseEnter:this.onMouseEnterZeroButton,onMouseLeave:this.onMouseLeaveZeroButton,"aria-label":e.translate("journals.settingsPanel.grade.student.automaticZeroCallout")},s.a.createElement(C.Attention,{color:"error"})))),a&&s.a.createElement(h.Callout,{className:"automatic-zero-callout",target:this.automaticZeroButtonElement,calloutId:this.calloutId,directionalHint:3,gapSpace:6,role:"region",onDismiss:this.onCalloutDismiss},s.a.createElement("span",null,e.translate("journals.settingsPanel.grade.student.automaticZeroCallout"))))}render(){const{localize:e,canEdit:t,grade:n}=this.props,a=!t&&n&&n.displayGrade&&n.displayGrade.scoredByAutomaticZero;return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"element-card element-info-list row"},t&&s.a.createElement("div",{className:"element-image icon columns small-2"},s.a.createElement(g.Grade,null)),s.a.createElement("div",{className:""+(t?"element-details element-info-details columns small-10":"student-grade-details")},s.a.createElement("span",{className:`name ${a&&!n.isExempt&&"automatic-zero"}`},e.translate("journals.settingsPanel.grade.title")),a&&!n.firstAttemptId&&this.renderAutomaticZeroInformation(),t?this.renderInstructorGradeInformation():this.renderStudentGradeInformation())))}}const N=Object(c.a)($);var D=n("np6O");class L extends s.a.Component{constructor(e){super(e),this.state={loadedGrade:!1}}componentDidMount(){const{loadGradebookSchemasByCourseId:e,courseId:t}=this.props;e({courseId:t})}componentDidUpdate(){const{journal:e,canEdit:t,courseId:n,loadGradebookGradesByColumnId:a}=this.props,{loadedGrade:i}=this.state;!i&&!t&&e&&e.gradeColumnId&&(a({courseId:n,columnId:e.gradeColumnId}),this.setState({loadedGrade:!0}))}getDummyJournal(){return{gradingAllowed:!1}}render(){const{analyticsId:e,localize:t,canEdit:n,isJournalBeingCreated:a,rubricName:i,journal:r,gradeColumn:o,grade:l,onGearClick:c,onRubricClick:d,onDueDateClick:u,onPointsClick:m,onPointsTypeClick:p,displayAccommodation:b,accommodationCount:v,accommodationIsGroup:S,onAccommodationClick:C,gradeSchema:E,preference:I}=this.props;let k=!1,w=n;!r&&a&&(w=!0,k=!0);const T=r&&r.gradingAllowed,O=o&&o.dueDate&&new Date(o.dueDate),A=o&&o.possible,P=!!I&&!!I.value&&JSON.parse(I.value),x=!P||!1!==P.isColorEnabled;return s.a.createElement("div",{className:"journals"},(a||T||w)&&s.a.createElement("div",{className:"full-panel-details"},s.a.createElement("div",{className:"element-settings"},s.a.createElement("div",{className:"full-panel-details-title row collapse"},s.a.createElement("div",{className:"text-wrapper columns small-10"},s.a.createElement("h2",{id:"journalTitle"},w?t.translate("journals.settingsPanel.title"):t.translate("journals.settingsPanel.journalDetailsLabel"))),s.a.createElement("div",{className:"button-wrapper columns small-2"},w&&s.a.createElement(D.AnalyticsIconButton,{analyticsId:`${e}.gear.link`,className:"icon super-clear right button",id:"journal-settings-cog-button",onClick:c,disabled:k,"aria-label":t.translate("journals.settingsPanel.ariaLabel.editSettings")},s.a.createElement(g.Settings,null)))),s.a.createElement("div",{className:"full-panel-details-info element-settings-info"},T&&s.a.createElement(y,{analyticsId:e,canEdit:w,dueDate:O,onClick:u}),i&&s.a.createElement("div",{className:"element-card element-info-list row"},s.a.createElement("div",{className:"element-image icon columns small-2"},s.a.createElement(g.Rubric,null)),s.a.createElement("div",{className:"element-details element-info-details columns small-10"},s.a.createElement("div",{className:"name"},s.a.createElement("span",null,t.translate("journals.settingsPanel.rubric.title"))),s.a.createElement("div",{className:"settings-link"},s.a.createElement(h.Link,{analyticsId:`${e}.rubric.link`,className:"rubric-title",href:"#",onClick:d},w?s.a.createElement("span",{id:"rubricTitle"},i):s.a.createElement("span",{id:"rubricTitle"},t.translate("journals.settingsPanel.rubric.gradedWithRubric")))))),s.a.createElement(N,{analyticsId:e,canEdit:w,possible:A,gradeSchema:E,grade:l,onClick:T?m:c,onGradeSchemaClick:p,isColorEnabled:x,disabled:k,gradeColumn:o}),b&&T&&w&&s.a.createElement(f,{analyticsId:e,accommodationCount:v,isGroupContent:S,openAccommodationsPanel:C})))))}}const j={loadGradebookColumn:u.V.gradebookColumn.loadGradebookColumn,loadGradebookSchemasByCourseId:u.V.gradebookSchema.loadGradebookSchemasByCourseId,loadGradebookGradesByColumnId:u.V.gradebookGrade.loadGradebookGradesByColumnId},M=Object(c.a)(L),G=Object(o.b)((function(e,t){const{journalId:n}=t,a=u.Yb.blog.blogs.getBlogById(e,n),i=a&&a.gradeColumnId&&u.Yb.gradebookColumn.getGradebookColumnById(e,a.gradeColumnId),r=i&&i.gradingSchemaId&&u.Yb.gradebookSchema.getGradebookSchemaById(e,i.gradingSchemaId),s=i&&u.Yb.gradebookGrade.getGradebookGradesByColumnId(e,i.id),o=!!a&&u.Yb.blog.blogs.canModifyBlog(e,n);return{journal:a,gradeColumn:i,gradeSchema:r,grade:!o&&s&&s.length>0&&s[0]||void 0,preference:u.Yb.systemPreference.getSystemPreferenceByKey(e,"gradepill.color.preference.settings"),canEdit:o}}),j)(M);var R=n("Agfx");const B=Object(R.makeStyles)((e=>Object(R.createStyles)({responseHeader:{marginBottom:"3px !important",fontWeight:e.typography.fontWeightSemiBold},responseHeaderContainer:{padding:"17px 0",borderBottom:`1px solid ${e.palette.border.main}`,margin:0},pageSize:{paddingRight:"25px"},paginationContainer:{display:"flex",justifyContent:"right",padding:"17px 0"}})));var F=n("AuQm"),U=n("7O4Y");const _=Object(c.a)((e=>{const{localize:{translate:t},pageSizeOptions:n,limit:a,handleOnLimitChange:i,analyticsId:r}=e,o=B(e),l=t("journals.entry.basicHeaderTitle");return s.a.createElement("div",null,s.a.createElement("div",{className:Object(U.a)("response-header",o.responseHeaderContainer)},s.a.createElement("h2",{className:o.responseHeader},l)),s.a.createElement("div",{className:o.paginationContainer},s.a.createElement(F.H,{className:o.pageSize,pageSizeOptions:n,initialPageSize:a,onPageSizeChange:i,analyticsId:r})))}));var z=n("fN3Q"),q=n.n(z),H=n("n7/H"),V=n("50Q+"),W=n("6Wru");const K=e=>{const{givenName:t,familyName:n,preferredDisplayName:a,otherName:i,durationInfo:r,image:o,isActive:l,isNewContent:c,showInfo:d,showDraft:u,showAccommodation:m}=e,p={givenName:t,familyName:n,preferredDisplayName:a,otherName:i},{translate:h,formatUsername:g}=Object(W.a)(),b=g(p,H.ILocaleUsernameFormat.Short);return s.a.createElement("div",{className:"response-user-info "+(l?"":"grayed-out")},s.a.createElement(k.AnalyticsAvatar,{alt:b,size:"medium",unavailable:!l,src:o}),d&&s.a.createElement("div",{className:"user-info"},s.a.createElement("div",{className:"primary-info"},m&&s.a.createElement(F.a,{className:"accomodations-icon"}),s.a.createElement("span",{className:"username","aria-hidden":!0},s.a.createElement(V.e,{user:p,ariaHidden:!0,format:H.ILocaleUsernameFormat.Short})),c&&s.a.createElement("div",{className:"new-content-pill"},s.a.createElement("span",null,h("journals.newContentPill"))),s.a.createElement("span",{className:"sr-only"},m?h("journals.entry.userInfo.hasAccommodations",{fullName:b}):b),s.a.createElement("span",{className:"draft-label "+(u?"":"hide")},h("journals.entry.draftLabel"))),r&&s.a.createElement("div",{className:"secondary-info"},s.a.createElement("span",{className:"user-details"},r))))};function Y(e){return Date.now()-e.getTime()<=864e5}function J(e,t){switch(e){case w.l.NeedsGrading:return t("journals.gradesAndParticipation.status.needsGrading");case w.l.NotAttempted:return t("journals.gradesAndParticipation.status.noSubmission");case w.l.Completed:return t("journals.gradesAndParticipation.status.completed");case w.l.InProgress:return t("journals.gradesAndParticipation.status.opened");default:return t("journals.gradesAndParticipation.status.noSubmission")}}function Z(e,t){let n=!1;if(e)if(t)n=t>e;else{n=Date.now()>e.getTime()}return n}function Q(e,t,n){return t?n(e?"journals.gradesAndParticipation.statusLastEntry.lastEntryLate":"journals.gradesAndParticipation.statusLastEntry.lastEntry",{datetime:t}):n(e?"journals.gradesAndParticipation.statusLastEntry.noEntryLate":"journals.gradesAndParticipation.statusLastEntry.noEntry")}const X=(e,t,n,a,i,r)=>({blogId:e,courseId:t,searchText:n,submissionStatus:r,paging:{limit:a,offset:i}});var ee=n("myse"),te=n("WBPx");const ne="journals.entry";class ae extends s.a.Component{constructor(e){var t;super(e),this.ariaLabelledBy=`bb-response-editor${q.a.v4()}`,this.onCancel=()=>{this.setState({isToolbarHidden:!0,isOverrideViewMode:!1})},this.onSave=()=>{this.setState({isSaving:!0}),this.state.toBbML(!0).then((e=>{const{entry:t,addBlogEntry:n,entryContext:i,modifyBlogEntry:r,mode:s}=this.props,{courseId:o,journalId:l,creatorId:c,assignedUserId:d}=i,u=d||c;if(""===e&&s===a.CREATE||e===(null==t?void 0:t.description.rawText))return this.setState({isSaving:!1}),void this.onCancel();this.setState({isSaving:!0}),t?r({courseId:o,blogId:l,prevEntry:t,nextEntry:{...t,creatorId:c,description:{rawText:e,displayText:e},assignedUserId:u}}).then((()=>{s===a.CREATE&&this.setState({currentBbml:""}),this.setState({isOverrideViewMode:!1,isToolbarHidden:!0,isSaving:!1})})):n({courseId:o,blogId:l,nextEntry:{...t,creatorId:c,description:{rawText:e,displayText:e},assignedUserId:u}}).then((()=>{s===a.CREATE&&this.setState({currentBbml:""}),(null==i?void 0:i.addEntryCallback)&&i.addEntryCallback(),this.setState({isOverrideViewMode:!1,isToolbarHidden:!0,isSaving:!1})}))}))},this.onDelete=async()=>{const{removeBlogEntry:e,entryContext:t,entry:n}=this.props,{courseId:a,journalId:i}=t;await e({courseId:a,blogId:i,entryId:n.id})},this.onFocus=()=>{this.setState({isToolbarHidden:!1})},this.onFocusWithAnalytics=()=>{const{analyticsEventAugmentor:e,analyticsId:t}=this.props;e(ee.AnalyticsEventTypes.CLICK_EVENT,this.onFocus,`${t}.body.input.text`)(null)},this.onEditorContentChanged=e=>{this.setState({toBbML:e.toBbML,currentBbml:e.toBbML()})},this.getDuration=()=>{const{localize:e,entry:t}=this.props;if(t){const n=new Date(t.createdDate);(new Date).getTime()-n.getTime()>=6e4&&n.setSeconds(30);const{date:a,time:i}=e.formatDuration(n,void 0,H.ILocaleDateFormat.Short);return Y(n)?e.translate("components.directives.duration.agoText",{durationDate:a,durationTime:i}):e.formatDatetime(n,H.ILocaleDatetimeFormat.Short)}return""},this.openDeleteConfirmationDialog=()=>{this.setState({isDialogHidden:!1})},this.onDialogDismiss=()=>{this.setState({isDialogHidden:!0})},this.onDialogConfirm=()=>{this.onDelete(),this.onDialogDismiss()},this.onActionMenuClick=e=>{this.setState({target:e.currentTarget})},this.enableEditing=()=>{this.setState({isOverrideViewMode:!0,isToolbarHidden:!1},(()=>{this.focusEditor()}))},this.isReadOnly=()=>!this.state.isOverrideViewMode&&this.props.mode===a.VIEW,this.setPluginConfig=()=>{const{entryContext:e,babelfishFormatInstance:t,babelfishInstance:n}=this.props,{courseId:a,pluginConfig:i}=e,r={courseId:a,babelfishFormatInstance:t,babelfishInstance:n,apiBasePath:Object(u.eb)(u.cb.apiBasePath),locale:this.props.currentLocale,xsrfToken:u.cb.xsrf};this.setState({pluginConfig:{...r,insertYoutubeVideo:{...r,getEmbedSrc:i.lti},contentMarket:{...r,getEmbedSrc:i.lti,openContentMarket:i.openContentMarket},insertCloudStorageIntegrationFile:{...r,openCloudStorageIntegrationModal:i.openCloudStorageIntegrationModal}},isConfigReady:!0})},this.renderActionDialog=()=>{const{analyticsId:e,localize:t}=this.props;return!this.state.isDialogHidden&&s.a.createElement(h.Dialog,{analyticsId:`${e}.options.delete.confirmationDialog`,onDismiss:this.onDialogDismiss,showAsCallout:!0,target:this.state.target,dialogContentProps:{type:h.DialogType.actionConfirmation,title:t.translate(`${ne}.actionMenu.delete.confirmationDialog.title`),subText:t.translate(`${ne}.actionMenu.delete.confirmationDialog.description`),showCloseButton:!1}},s.a.createElement(h.DialogFooter,null,s.a.createElement(te.AnalyticsDefaultButton,{onClick:this.onDialogDismiss,analyticsId:`${e}.options.delete.confirmationDialog.cancel.button`},t.translate(`${ne}.actionMenu.delete.confirmationDialog.dialogFooter.cancelButton`)),s.a.createElement(te.AnalyticsPrimaryButton,{onClick:this.onDialogConfirm,analyticsId:`${e}.options.delete.confirmationDialog.save.button`},t.translate(`${ne}.actionMenu.delete.confirmationDialog.dialogFooter.deleteButton`))))};const n=(null===(t=e.entry)||void 0===t?void 0:t.description.rawText)||"";this.state={toBbML:Object(l.generateToBbML)(n),currentBbml:n,isDialogHidden:!0,isConfigReady:!1,isOverrideViewMode:!1,isToolbarHidden:!0,pluginConfig:{},isSaving:!1}}componentDidMount(){!this.state.isConfigReady&&this.props.entryContext.pluginConfig&&this.setPluginConfig()}componentDidUpdate(e){const t=this.props.entry,n=e.entry;!this.state.isConfigReady&&this.props.entryContext.pluginConfig&&this.setPluginConfig(),(null==n?void 0:n.description.rawText)!==(null==t?void 0:t.description.rawText)&&this.setState({currentBbml:t.description.rawText})}get isNew(){const{entry:e}=this.props,t=e&&e.userStatus,n=null==t?void 0:t.entryLastSeenDate,a=null==e?void 0:e.createdDate;return!!t&&(!n||n<a)}get isSaveButtonDisabled(){var e;return this.state.isSaving||""===this.state.currentBbml||this.state.currentBbml===(null===(e=this.props.entry)||void 0===e?void 0:e.description.rawText)}focusEditor(){this.node.querySelector(".ql-editor.bb-editor").focus()}get shouldShowEditInformation(){const{entry:e}=this.props,t=null==e?void 0:e.createdDate,n=null==e?void 0:e.updatedDate;return t&&n&&Math.abs(n.getTime()-t.getTime())>=1e3}get shouldShowActionMenu(){const{entry:e}=this.props;return this.isReadOnly()&&(e&&e.permissions.delete||e.permissions.modify)}get menuOptions(){const{localize:e,entry:t}=this.props,n={directionalHint:6,items:[]};return t&&t.permissions.modify&&n.items.push({onClick:this.enableEditing,icon:s.a.createElement(C.Edit,null),key:"editEntry",name:e.translate(`${ne}.actionMenu.edit.label`)}),t&&t.permissions.delete&&n.items.push({onClick:this.openDeleteConfirmationDialog,icon:s.a.createElement(C.Trash,null),key:"deleteEntry",name:e.translate(`${ne}.actionMenu.delete.label`)}),n}render(){const{analyticsId:e,entry:t,localize:n,mode:i,showUserInfo:r,userInfo:o}=this.props,{translate:l,formatUsername:c}=n,d=i===a.CREATE,u=c(o,H.ILocaleUsernameFormat.Short);return s.a.createElement("div",{ref:e=>{this.node=e},className:"response"},s.a.createElement("div",{className:d?"comment-avatar-wrapper":"comment-wrapper"},this.shouldShowActionMenu&&s.a.createElement("div",{className:"response__action-menu-wrapper",onClick:this.onActionMenuClick},s.a.createElement(h.ActionMenu,{className:"response__action-menu",analyticsId:`${e}.actionMenu`,disabled:!this.state.isDialogHidden,ariaLabel:l(`${ne}.actionMenu.ariaLabel`),menuProps:this.menuOptions,title:l(`${ne}.actionMenu.title`,{displayName:u,datetime:t.createdDate})}),this.renderActionDialog()),s.a.createElement("div",{className:"element-image avatar no-select one-participant"},s.a.createElement(K,{durationInfo:this.getDuration(),...o,showDraft:t&&t.isDraft,showInfo:r,isNewContent:this.isNew})),s.a.createElement("div",{className:"reply-form comments"},this.state.isConfigReady&&s.a.createElement(p,{placeholder:l(`${ne}.edit.placeholder`),editor:{ariaLabelledBy:this.ariaLabelledBy,bbml:(null==t?void 0:t.description.rawText)||"",isPrivileged:!0,isReadOnly:this.isReadOnly(),isToolbarHidden:this.state.isToolbarHidden,onEditorContentChanged:this.onEditorContentChanged,onFocus:this.onFocusWithAnalytics,pluginConfig:this.state.pluginConfig,shouldSetPristine:!1,showWordCount:!0}})),!this.state.isToolbarHidden&&s.a.createElement("div",{className:"panel-editor-controls"},s.a.createElement(te.AnalyticsDefaultButton,{className:"button button--secondary js-secondary-button js-text-editor-cancel",analyticsId:`${e}.edit.cancel.button`,onClick:this.onCancel},l(`${ne}.edit.cancel`)),s.a.createElement(te.AnalyticsPrimaryButton,{className:"button js-primary-button js-text-editor-save",analyticsId:`${e}.edit.save.button`,disabled:this.isSaveButtonDisabled,onClick:this.onSave},l(`${ne}.edit.post`))),this.shouldShowEditInformation&&s.a.createElement("div",{className:"response__edit-info"},l(`${ne}.lastUpdateInfo`,{date:t.updatedDate}))))}}const ie=Object(c.a)(Object(ee.withAnalytics)(ae));var re=n("x6OE"),se=n.n(re);class oe extends r.Component{constructor(e){super(e),this.ariaLabelledBy=`item-reply-editor${z.v4()}`,this.closeEditor=()=>{this.setState({currentBbml:this.props.bbml||"",isReadOnly:this.isEditable,isToolbarHidden:!0}),this.props.onEditorClose&&this.props.onEditorClose()},this.onSave=async()=>{try{this.setState({isSaving:!0});const e=await this.state.toBbML(!0);""!==e&&e!==this.props.bbml&&await this.props.onSave(e),this.closeEditor()}catch(e){}finally{this.setState({isSaving:!1})}},this.onDelete=()=>{this.props.onDelete&&this.props.onDelete()},this.onDeleteButtonClick=()=>{this.setState({shouldShowDialog:!0})},this.onFocus=()=>{this.setState({isToolbarHidden:!1}),this.props.onEditorFocus&&this.props.onEditorFocus()},this.onFocusWithAnalytics=()=>{const{analyticsEventAugmentor:e,analyticsId:t}=this.props;e(ee.AnalyticsEventTypes.CLICK_EVENT,this.onFocus,`${t}.body.input.text`)(null)},this.onBlur=()=>{const{bbml:e,onEditorClose:t}=this.props;this.state.currentBbml!==e&&(e||this.state.currentBbml)||(this.setState({isToolbarHidden:!0,isReadOnly:this.isEditable}),t&&t())},this.onEditorContentChanged=e=>{this.setState({toBbML:e.toBbML,currentBbml:e.toBbML()})},this.onDialogDismiss=()=>{this.setState({shouldShowDialog:!1})},this.onActionMenuClick=e=>{this.setState({target:e.currentTarget})},this.setToEditMode=()=>{this.setState({isReadOnly:!1,isToolbarHidden:!1},(()=>{this.focusEditor()}))},this.renderDialog=()=>{const{analyticsId:e,localize:t}=this.props;return this.state.shouldShowDialog&&r.createElement(h.Dialog,{analyticsId:`${e}.options.delete.confirmationDialog`,onDismiss:this.onDialogDismiss,showAsCallout:!0,target:this.state.target,dialogContentProps:{type:h.DialogType.actionConfirmation,title:t.translate("journals.comment.modals.deleteModalTitle"),subText:t.translate("journals.comment.modals.deleteModalText"),showCloseButton:!1}},r.createElement(h.DialogFooter,null,r.createElement(te.AnalyticsDefaultButton,{onClick:this.onDialogDismiss,analyticsId:`${e}.options.delete.confirmationDialog.cancel.button`},t.translate("journals.comment.modals.cancelButtonText")),r.createElement(te.AnalyticsPrimaryButton,{onClick:this.onDelete,analyticsId:`${e}.options.delete.confirmationDialog.save.button`},t.translate("journals.comment.actions.delete"))))};const t=e.bbml||"";this.state={toBbML:Object(l.generateToBbML)(t),currentBbml:t,isToolbarHidden:!0,isReadOnly:this.isEditable,shouldShowDialog:!1,isSaving:!1}}componentDidMount(){this.props.shouldFocusReplyEditor&&this.focusEditor()}componentDidUpdate(e){!e.shouldFocusReplyEditor&&this.props.shouldFocusReplyEditor&&this.focusEditor()}focusEditor(){this.replyBody.querySelector(".ql-editor.bb-editor").focus(),window.scrollTo(0,this.replyBody.offsetTop)}getDateTimeLabel(){const{localize:e,createdDate:t,updatedDate:n}=this.props;if(!t)return"";if(Y(t)){const a=e.formatDuration(t,null,H.ILocaleDateFormat.Short);return this.shouldShowEditInformation?e.translate("journals.comment.lastUpdateLessOneDayInfo",{date:n,durationDate:a.date,durationTime:a.time}):e.translate("components.directives.duration.agoText",{durationDate:a.date,durationTime:a.time})}return this.shouldShowEditInformation?e.translate("journals.comment.lastUpdateInfo",{date:n,datetime:t}):e.formatDatetime(t,H.ILocaleDatetimeFormat.Short)}get isEditable(){return null!=this.props.bbml}get isSaveButtonDisabled(){return this.state.isSaving||""===this.state.currentBbml||this.state.currentBbml===this.props.bbml}get shouldShowEditInformation(){const{createdDate:e,updatedDate:t}=this.props;return e&&t&&Math.abs(t.getTime()-e.getTime())>=1e3}get shouldShowActionMenu(){const{canEdit:e,canDelete:t}=this.props,{isReadOnly:n}=this.state;return n&&(e||t)}get actionMenuProps(){const{localize:e,canDelete:t,canEdit:n}=this.props,a={directionalHint:7,items:[]};return n&&a.items.push({onClick:this.setToEditMode,icon:r.createElement(C.Edit,null),key:"edit",name:e.translate("journals.comment.actions.edit")}),t&&a.items.push({onClick:this.onDeleteButtonClick,icon:r.createElement(C.Trash,null),key:"delete",name:e.translate("journals.comment.actions.delete")}),a}render(){const{analyticsId:e,bbml:t,createdDate:n,isNew:a,localize:i,pluginConfig:s,userInfo:o}=this.props,{isReadOnly:l,isToolbarHidden:c}=this.state,d=i.translate("journals.comment.actions.moreOptions");return r.createElement("div",{className:"reply-item"+(this.isEditable?"":" -create-mode")},r.createElement("div",{className:"reply-item__header"},r.createElement("div",{className:"reply-item__header__left"},r.createElement(K,{...o,showInfo:this.isEditable,isNewContent:a})),this.shouldShowActionMenu&&r.createElement("div",{className:"reply-item__action-menu",onClick:this.onActionMenuClick},r.createElement(h.ActionMenu,{analyticsId:`${e}.actionMenu`,ariaLabel:d,title:d,disabled:this.state.shouldShowDialog,menuProps:this.actionMenuProps}))),this.renderDialog(),r.createElement("div",{ref:e=>{this.replyBody=e},className:"reply-item__body"},r.createElement(p,{placeholder:i.translate("journals.comment.editor.placeholder"),editor:{bbml:t,isReadOnly:l,isToolbarHidden:c,pluginConfig:s,ariaLabelledBy:this.ariaLabelledBy,isPrivileged:!0,onBlur:this.onBlur,onEditorContentChanged:this.onEditorContentChanged,onFocus:this.onFocusWithAnalytics,shouldSetPristine:!1,showWordCount:!0}}),!c&&r.createElement("div",{className:"reply-item__editor-controls"},r.createElement(te.AnalyticsDefaultButton,{className:"reply-item__editor-controls__button js-text-editor-cancel",analyticsId:`${e}.edit.cancel.button`,onClick:this.closeEditor},i.translate("journals.comment.editor.cancel")),r.createElement(te.AnalyticsPrimaryButton,{className:"reply-item__editor-controls__button js-text-editor-save",analyticsId:`${e}.edit.save.button`,disabled:this.isSaveButtonDisabled,onClick:this.onSave},i.translate("journals.comment.editor.comment"))),r.createElement("div",{className:"reply-item__container-detail"},l&&n&&r.createElement("div",{className:"reply-item__details"},this.getDateTimeLabel()))))}}oe.defaultProps={canDelete:!1,canEdit:!1,isNew:!1,shouldFocusReplyEditor:!1};const le=Object(ee.withAnalytics)(Object(c.a)(oe));class ce extends s.a.Component{constructor(){super(...arguments),this.onSave=async e=>{const{comment:t,entry:n,modifyComment:a,addComment:i,entryContext:r}=this.props,{courseId:s,journalId:o}=r;t?await a({courseId:s,blogId:o,entryId:n.id,prevComment:t,nextComment:{...t,description:{...t.description,rawText:e}}}):await i({courseId:s,blogId:o,entryId:n.id,nextComment:{description:{rawText:e}}})},this.onDelete=async()=>{const{entry:e,entryContext:t,deleteComment:n,comment:a}=this.props,{courseId:i,journalId:r}=t;await n({courseId:i,blogId:r,entryId:e.id,commentId:a.id})}}componentDidMount(){const{comment:e,entryContext:t,loadMembershipByMemberId:n}=this.props,a=(null==e?void 0:e.creatorId)||t.creatorId;n(t.courseId,a)}get isNew(){const{comment:e,entry:t,entryContext:n}=this.props,a=t&&t.userStatus,i=e&&e.creatorId===n.creatorId,r=null==a?void 0:a.commentLastSeenDate,s=null==e?void 0:e.createdDate;return!!e&&!!a&&!i&&(!r||s>r)}getPluginConfig(){const{entryContext:e,babelfishFormatInstance:t,babelfishInstance:n}=this.props,{courseId:a,pluginConfig:i}=e,r={courseId:a,babelfishFormatInstance:t,babelfishInstance:n,apiBasePath:Object(u.eb)(u.cb.apiBasePath),locale:this.props.currentLocale,xsrfToken:u.cb.xsrf};return{...r,insertYoutubeVideo:{...r,getEmbedSrc:i.lti},contentMarket:{...r,getEmbedSrc:i.lti,openContentMarket:i.openContentMarket},insertCloudStorageIntegrationFile:{...r,openCloudStorageIntegrationModal:i.openCloudStorageIntegrationModal}}}render(){var e,t,n;const{analyticsId:a,comment:i,userInfo:r,shouldFocusReplyEditor:o,onEditorClose:l,onEditorFocus:c}=this.props,d=null===(e=null==i?void 0:i.description)||void 0===e?void 0:e.rawText,u=null==i?void 0:i.createdDate,m=null==i?void 0:i.updatedDate,p=(null===(t=null==i?void 0:i.permissions)||void 0===t?void 0:t.delete)||!1,h=(null===(n=null==i?void 0:i.permissions)||void 0===n?void 0:n.edit)||!1;return s.a.createElement(le,{analyticsId:a,bbml:d,canDelete:p,canEdit:h,createdDate:u,isNew:this.isNew,onDelete:this.onDelete,onEditorClose:l,onEditorFocus:c,onSave:this.onSave,pluginConfig:this.getPluginConfig(),shouldFocusReplyEditor:o,updatedDate:m,userInfo:r})}}ce.defaultProps={shouldFocusReplyEditor:!1};const de={addComment:u.V.blog.comments.addComment,deleteComment:u.V.blog.comments.deleteComment,modifyComment:u.V.blog.comments.modifyComment,loadMembershipByMemberId:u.V.courseMembership.loadCourseMembershipByMemberId},ue=Object(o.b)(((e,t)=>{var n,a,i,r,s,o;const{comment:l,entryContext:c}=t,d=null!==(n=null==l?void 0:l.creatorId)&&void 0!==n?n:c.creatorId,m=u.Yb.courseMembership.getCourseMembershipByMembershipId(e,d),p=u.Yb.user.getUserById(e,null==m?void 0:m.userId);return{userInfo:{familyName:null!==(a=null==p?void 0:p.familyName)&&void 0!==a?a:"",givenName:null!==(i=null==p?void 0:p.givenName)&&void 0!==i?i:"",showAccommodation:!1,isActive:!0,image:null!==(s=null===(r=null==p?void 0:p.avatar)||void 0===r?void 0:r.permanentUrl)&&void 0!==s?s:"",otherName:null!==(o=null==p?void 0:p.otherName)&&void 0!==o?o:"",preferredDisplayName:null==p?void 0:p.preferredDisplayName}}}),de)(Object(c.a)(ce));class me extends s.a.Component{constructor(e){super(e),this.handleReplyClick=()=>{this.handleCommentsLoading(),this.setState({shouldShowReplies:!0,shouldFocusReplyEditor:!1},(()=>{this.setState({shouldFocusReplyEditor:!0})}))},this.handleShowRepliesClick=()=>{this.handleCommentsLoading(),this.setState((e=>({shouldShowReplies:!e.shouldShowReplies,shouldFocusReplyEditor:!1})))},this.replyRenderer=e=>{const{analyticsId:t,comments:n,entry:a,entryContext:i}=this.props;return s.a.createElement(ue,{key:n[e].id,analyticsId:`${t}.comment`,comment:n[e],entry:a,entryContext:i,onEditorClose:this.onEditorClose,onEditorFocus:this.onEditorFocus})},this.onEditorFocus=()=>{this.setState({areControlsDisabled:!0})},this.onEditorClose=()=>{this.setState({areControlsDisabled:!1})},this.state={areControlsDisabled:!1,hasLoadedComments:!1,shouldShowReplies:!1,shouldFocusReplyEditor:!1}}componentDidMount(){const{entry:e,entryContext:t,loadCourseMembershipByMemberId:n}=this.props,a=(null==e?void 0:e.creatorId)||"";n(t.courseId,a)}handleCommentsLoading(){const{hasLoadedComments:e}=this.state;e||this.loadComments()}loadComments(){const{entry:e,entryContext:t,loadEntryComments:n}=this.props,{courseId:a,journalId:i}=t;this.setState({hasLoadedComments:!0},(()=>{n(a,i,e.id,{limit:1e3})}))}renderComments(){const{comments:e}=this.props;return e?s.a.createElement(se.a,{length:e.length,itemRenderer:this.replyRenderer}):null}renderNewCommentsInformation(){var e,t;const{entry:n,localize:a}=this.props,i=null!==(t=null===(e=null==n?void 0:n.userStatus)||void 0===e?void 0:e.unreadCommentCount)&&void 0!==t?t:0;return i<=0?null:s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"new-content-pill"},s.a.createElement("span",null,a.translate("journals.newContentPill"))),s.a.createElement("span",{className:"unread-count"},a.translate("journals.entry.comments.newComments.plural",{count:i})))}render(){const{analyticsId:e,entry:t,entryContext:n,localize:i,removeBlogEntry:r,addBlogEntry:o,modifyBlogEntry:l,userInfo:c}=this.props,{areControlsDisabled:d,shouldShowReplies:u,shouldFocusReplyEditor:m}=this.state,p=t.userStatus&&t.userStatus.commentCount||0;return s.a.createElement("div",{className:"response-with-replies-group"},s.a.createElement(ie,{analyticsId:e,mode:a.VIEW,entry:t,entryContext:n,showUserInfo:!0,addBlogEntry:o,modifyBlogEntry:l,removeBlogEntry:r,userInfo:c}),s.a.createElement("div",{className:"reply-and-show-replies-control"},s.a.createElement(h.Link,{analyticsId:`${e}.createComment.button`,disabled:d,onClick:this.handleReplyClick},i.translate("journals.entry.comments.comment")),p>0&&s.a.createElement(s.a.Fragment,null,s.a.createElement("span",null," | "),s.a.createElement(h.Link,{analyticsId:`${e}.showComments.button`,disabled:d,onClick:this.handleShowRepliesClick},u?i.translate("journals.entry.comments.hideComments",{count:p}):i.translate("journals.entry.comments.showComments",{count:p}))),this.renderNewCommentsInformation()),u&&s.a.createElement("div",{className:"replies"},this.renderComments(),s.a.createElement("div",{className:"new-reply-editor"},s.a.createElement(ue,{analyticsId:`${e}.newComment`,entry:t,entryContext:n,onEditorClose:this.onEditorClose,onEditorFocus:this.onEditorFocus,shouldFocusReplyEditor:m}))))}}const pe={loadEntryComments:u.V.blog.comments.loadEntryComments,addBlogEntry:u.V.blog.entries.addBlogEntry,modifyBlogEntry:u.V.blog.entries.modifyBlogEntry,removeBlogEntry:u.V.blog.entries.removeBlogEntry,loadCourseMembershipByMemberId:u.V.courseMembership.loadCourseMembershipByMemberId},he=Object(o.b)((function(e,t){var n,a,i;const{entry:r}=t,s=u.Yb.blog.comments.getCommentsByEntryId(e,r.id),o=(null==r?void 0:r.creatorId)||"",l=u.Yb.courseMembership.getCourseMembershipByMembershipId(e,o),c=u.Yb.user.getUserById(e,null==l?void 0:l.userId);return{userInfo:{familyName:(null==c?void 0:c.familyName)||"",givenName:(null==c?void 0:c.givenName)||"",showAccommodation:!1,isActive:!0,image:null!==(a=null===(n=null==c?void 0:c.avatar)||void 0===n?void 0:n.permanentUrl)&&void 0!==a?a:"",otherName:null!==(i=null==c?void 0:c.otherName)&&void 0!==i?i:"",preferredDisplayName:null==c?void 0:c.preferredDisplayName},comments:s}}),pe)(Object(c.a)(me));class ge extends s.a.Component{constructor(e){super(e),this.renderResponseGroup=e=>{const{entries:t,entryContext:n}=this.props,a=Object.values(t)[e];return a?s.a.createElement(he,{analyticsId:`${n.analyticsId}.entry`,entry:a,key:a.id,entryContext:n}):null},this.listRef=null}render(){const e=this.props.entries&&Object.values(this.props.entries).length||0;return s.a.createElement(se.a,{itemsRenderer:(e,t)=>s.a.createElement("div",{ref:t},e),length:e,itemRenderer:this.renderResponseGroup,ref:this.listRef})}}const be=Object(c.a)(ge);var fe,ve,ye;!function(e){e.Small="25",e.Medium="50",e.Large="100"}(fe||(fe={})),function(e){e.Small="5",e.Medium="10",e.Large="20"}(ve||(ve={})),function(e){e.All="all",e.NoSubmission="noSubmission",e.NeedsGrading="needsGrading",e.Complete="complete"}(ye||(ye={}));var Se=n("FAEt"),Ce=n("Ep2I");const Ee=e=>{const[t,n]=Object(r.useState)("#");return Object(r.useEffect)((()=>{const{routeSearchParams:t,participant:a,participantIndex:i,columnId:r}=e,s=Number(t.limit),o=(Number(t.page||1)-1)*s+(i-1);I.Z.getPeekHref(I.z.JournalSubmission({participantId:a.courseMembershipId,columnId:r,offset:String(o)})).then((e=>{n(e)}))}),[e]),t};var Ie=n("ggbH");const ke=(e,t)=>Object(o.e)((n=>Ie.c.getGradebookGradesByColumnIdAndUserId(n,e,t)[0]));var we=n("suvu");const Te=e=>Object(o.e)((t=>we.c.getUserById(t,e)));var Oe=n("MN17");const Ae=(e,t)=>Object(o.e)((n=>Oe.c.userHasCourseEntitlement(n,e,t)));const Pe=e=>{const t=Object(o.d)();Object(r.useEffect)((()=>{e&&t(Oe.a.loadUserCourseEntitlements(e))}),[e,t])};var xe=n("HdiE");const $e=(e,t)=>{const n=Object(o.d)();Object(r.useEffect)((()=>{e&&t&&n(xe.a.loadParticipationSummary(e,t))}),[e,t,n])};const Ne=(e,t,n)=>{const a=Object(o.d)(),i=Object(o.e)((t=>{if(n){const n=u.Yb.blog.blogs.getBlogById(t,e);return null==n?void 0:n.gradeColumnId}return null})),s=Object(o.e)((e=>i?u.Yb.columnSummary.getColumnSummaryByColumnId(e,i):null)),l=Object(o.e)((e=>{var t;return i?null===(t=u.Yb.gradebookColumn.getGradebookColumnById(e,i))||void 0===t?void 0:t.dueDate:null}));return Object(r.useEffect)((()=>{i&&t&&n&&a(u.V.columnSummary.loadColumnSummary({courseId:t,columnId:i}))}),[i,t,n,a]),{columnId:i,columnSummary:s,dueDate:l}};var De=n("Bv6r");var Le=e=>Object(o.e)((t=>De.c.getBlogParticipantsByQuery(t,e)));var je=(e,t)=>Object(o.e)((n=>t?t.map((t=>{const a=u.Yb.gradebookGrade.getGradebookGradesByColumnIdAndUserId(n,e,t.userId)[0];return{courseMembershipId:t.courseMembershipId,user:u.Yb.user.getUserById(n,t.userId),hasNewActivity:t.hasNewActivity,attemptStatus:t.attemptStatus,gradeDetail:a,entriesCount:t.entriesCount,lastAttemptDate:t.lastAttemptDate?new Date(t.lastAttemptDate):null}})):[]));var Me=e=>{var t,n;const a=Object(o.e)((t=>u.Yb.blog.participants.getPagingByQuery(t,e))),i=null!==(t=null==a?void 0:a.count)&&void 0!==t?t:1,r=null!==(n=null==a?void 0:a.limit)&&void 0!==n?n:1;return Math.ceil(i/r)};var Ge=e=>Object(o.e)((t=>De.c.isLoading(t,e)));const Re=e=>{const{journalId:t,courseId:n,columnId:a,submissionStatus:i,searchText:s,limit:l,page:c}=e,d=Object(o.d)(),[m,p]=Object(r.useState)(!1),h=Number(l),g=(Number(c)-1)*h,b=X(t,n,s,h,g,i),f=Le(b),v=Ge(b),y=Me(b),S=je(a,f);return Object(r.useEffect)((()=>{n&&t&&d(u.V.blog.participants.loadParticipantList(b)).then((()=>{p(!1)}))}),[n,t,s,l,c,a,i]),Object(r.useEffect)((()=>{if(!m&&a&&n&&S.length){const e=S.map((e=>e.courseMembershipId));d(u.V.gradebookGrade.loadBulkView(n,[a],e,{expand:["grade.instructorFeedback","attempts"]})),p(!0)}}),[d,n,t,a,S,m]),{participants:S,isLoading:v,numPages:y}};const Be=e=>Object(o.e)((t=>xe.c.getSummaryByBlogId(t,e)));const Fe=()=>Object(o.e)((e=>u.Yb.app.getLocation(e))).queryParams;const Ue=(e,t)=>{const n=Object(o.e)((e=>u.Yb.app.getLocation(e))).queryParams[e],[a,i]=Object(r.useState)(n||t);return Object(r.useEffect)((()=>{a!==n&&("entryLimit"===e?I.Z.search({[e]:a,entryPage:"1"}):"limit"===e?I.Z.search({[e]:a,page:"1"}):I.Z.search({[e]:a}))}),[a]),Object(r.useEffect)((()=>{const r=Number(n);Number.isNaN(r)||r<=0?(i(t),I.Z.search({[e]:t})):n&&n!==a&&(i(n),I.Z.search({[e]:n}))}),[n]),[a,i]};var _e=n("5Yha");const ze=Object(R.makeStyles)((e=>Object(R.createStyles)({paginationContainer:{display:"flex",justifyContent:"center",marginTop:"30px"}}))),qe=[Number(ve.Small),Number(ve.Medium),Number(ve.Large)],He={addBlogEntry:u.V.blog.entries.addBlogEntry,modifyBlogEntry:u.V.blog.entries.modifyBlogEntry,removeBlogEntry:u.V.blog.entries.removeBlogEntry,loadBlogEntriesByQuery:u.V.blog.entries.loadBlogEntriesByQuery,loadCourseMembershipByMemberId:u.V.courseMembership.loadCourseMembershipByMemberId},Ve=Object(o.b)(((e,t)=>{var n,a,i,r,s,o,l;const{journalId:c,creatorId:d,assignedUserId:m,courseId:p}=t.entryContext,h=u.Yb.courseMembership.getCourseMembershipByMembershipId(e,d),g=u.Yb.app.getLocation(e).queryParams,b=u.Yb.user.getUserById(e,null==h?void 0:h.userId),f=Number(null!==(n=g.entryLimit)&&void 0!==n?n:ve.Small),v=(Number(null!==(a=g.entryPage)&&void 0!==a?a:1)-1)*f,y={familyName:(null==b?void 0:b.familyName)||"",givenName:(null==b?void 0:b.givenName)||"",showAccommodation:!1,isActive:!0,image:null!==(r=null===(i=null==b?void 0:b.avatar)||void 0===i?void 0:i.permanentUrl)&&void 0!==r?r:"",otherName:null!==(s=null==b?void 0:b.otherName)&&void 0!==s?s:void 0,preferredDisplayName:null==b?void 0:b.preferredDisplayName},S={courseId:p,blogId:c,assignedUserId:m||d,expand:"userStatus",paging:{limit:f,offset:v}},C=u.Yb.blog.entries.getBlogEntriesViewStatusByQuery(e,S);return{userInfo:y,isViewLoading:null!==(o=null==C?void 0:C.isLoading)&&void 0!==o&&o,isViewValid:null!==(l=null==C?void 0:C.isValid)&&void 0!==l&&l,viewPaging:null==C?void 0:C.paging,entries:u.Yb.blog.entries.getBlogEntriesByQuery(e,S),canCreateEntry:u.Yb.blog.blogs.canCreateEntry(e,c)}}),He)((e=>{const{canCreateEntry:t,entries:n,addBlogEntry:i,modifyBlogEntry:r,removeBlogEntry:o,entryContext:l,userInfo:c,loadBlogEntriesByQuery:d,loadCourseMembershipByMemberId:u,isViewLoading:m,isViewValid:p,viewPaging:h}=e,{formatNumber:g}=Object(W.a)(),[b,f]=s.a.useState(1),[v,y]=Ue("entryPage","1"),[S,C]=Ue("entryLimit",ve.Small),E=l.analyticsId;s.a.useEffect((()=>{var e,t;const n=null!==(e=null==h?void 0:h.count)&&void 0!==e?e:1,a=null!==(t=null==h?void 0:h.limit)&&void 0!==t?t:1;f(0===n?1:Math.ceil(n/a))}),[h]),s.a.useEffect((()=>{if((null==l?void 0:l.assignedUserId)&&(null==l?void 0:l.journalId)&&!p){const{courseId:e,journalId:t,creatorId:n,assignedUserId:a}=l;if(u(e,n),n!==a&&u(e,a),t){const i=Number(S),r=(Number(v)-1)*i;d({courseId:e,blogId:t,assignedUserId:a||n,expand:"userStatus",paging:{limit:i,offset:r}})}}}),[null==l?void 0:l.assignedUserId,null==l?void 0:l.journalId,p,S,v]),s.a.useEffect((()=>{!m&&0===n.length&&Number(v)>b&&y(b.toString())}),[b,v,m,n,y]);const I=s.a.useCallback((e=>{const t=Object(_e.c)([e],g)[0];C(t.value)}),[g,C]),k=s.a.useCallback((e=>{y(String(e+1))}),[y]),w=ze(e),T=Object(Ce.a)(),O=Object(Se.a)(T.breakpoints.down("xs"));return s.a.createElement("div",null,s.a.createElement("div",{className:"row spaced collapse reply-form"},s.a.createElement("div",{className:"columns new-comment"},s.a.createElement(_,{...e,pageSizeOptions:qe,limit:S,handleOnLimitChange:I,analyticsId:E}),!!t&&s.a.createElement(ie,{analyticsId:`${l.analyticsId}.newEntry`,mode:a.CREATE,entryContext:l,showUserInfo:!1,addBlogEntry:i,removeBlogEntry:o,modifyBlogEntry:r,userInfo:c}))),s.a.createElement("div",null,s.a.createElement(be,{entries:n,entryContext:l})),s.a.createElement("div",{className:w.paginationContainer},s.a.createElement(F.I,{numberOfPages:b,onPageChange:k,page:Number(v)-1,analyticsId:l.analyticsId,compact:O})))})),We=e=>s.a.createElement(Ve,{entryContext:e});var Ke=n("0AOT"),Ye=n("YK4x");const Je=Object(R.makeStyles)((e=>Object(R.createStyles)({dialogTitle:{"& h1":{fontFamily:e.typography.fontFamily}}}))),Ze=e=>{const{showPostConfirmationModal:t,analyticsId:n,headerKey:a,handleOnClose:i,onPostConfirmation:r}=e,o=Object(Ye.a)(),l="post-grade-confirmation",c=Je(e);return s.a.createElement(s.a.Fragment,null,s.a.createElement(k.AnalyticsDialog,{analyticsId:`${n}`,open:t,maxWidth:"md",onClose:i,"aria-labelledby":`${l}-dialog-title`},s.a.createElement(k.AnalyticsDialogTitle,{analyticsId:`${n}.titleClose.button`,id:`${l}-dialog-title`,onClick:i,className:c.dialogTitle},o("journals.gradesAndParticipation.postGrade.confirmation.title")),s.a.createElement(k.AnalyticsDialogContent,{analyticsId:`${n}.content`},s.a.createElement(k.AnalyticsDialogContentText,{analyticsId:`${n}.contentText`,id:`${l}-dialog-description`},o(`${a}.postConfirmationDialog`))),s.a.createElement(k.AnalyticsDialogActions,{analyticsId:`${n}.actions`},s.a.createElement(k.AnalyticsDefaultButton,{analyticsId:`${n}.cancel.button`,onClick:i},o("journals.gradesAndParticipation.postGrade.confirmation.cancelButton")),s.a.createElement(k.AnalyticsPrimaryButton,{analyticsId:`${n}.post.button`,onClick:r},o("journals.gradesAndParticipation.postGrade.confirmation.postButton")))))};const Qe=e=>{var t,n,a;const{analyticsId:i,participationSummary:r,columnSummary:o,isGraded:l,headerKey:c,postReadyGrades:d}=e,u=Object(Ye.a)(),[m,p]=s.a.useState(!1),h=s.a.useCallback((()=>{p(!0)}),[p]),g=s.a.useCallback((()=>{p(!1),d()}),[p,d]),b=s.a.useCallback((()=>{p(!1)}),[p]);let f={participation:{studentsParticipating:u("journals.gradesAndParticipation.participationSummary.studentsParticipating",{currentNumber:null!==(t=null==r?void 0:r.studentsWithEntriesCount)&&void 0!==t?t:0,totalNumber:null!==(n=null==o?void 0:o.numStudentsEligibleToBeGraded)&&void 0!==n?n:0}),key:u("journals.gradesAndParticipation.participationSummary.studentsParticipating.label")}};if(l){const e=o?o.numStudentsGradedNeedsPosting+o.numberOfOverriddenGradesToPost:0;f={...f,participationToGrade:{count:null!==(a=null==o?void 0:o.numStudentsNeedsGrading)&&void 0!==a?a:0,key:u("journals.gradesAndParticipation.participationSummary.participationToGrade")},gradesToPost:{count:e,key:u("journals.gradesAndParticipation.participationSummary.gradesToPost")},postButton:{analyticsId:`${i}.postAllGrades`,label:u("journals.gradesAndParticipation.postGrade.postAllGrades"),onClick:h}}}return s.a.createElement("div",{className:"journals-participation-summary"},m&&s.a.createElement(Ze,{analyticsId:i,headerKey:c,showPostConfirmationModal:m,handleOnClose:b,onPostConfirmation:g}),s.a.createElement(F.Q,{summary:f}))};const Xe=Object(R.makeStyles)((e=>Object(R.createStyles)({participantRow:{borderBottom:`1px solid ${e.palette.secondary.main}`,"&:hover":{backgroundColor:e.palette.background.b3,"& $displayName":{textDecoration:"underline"}}},tableRow:{paddingTop:"12px",paddingBottom:"8px",border:"none"},userInfo:{display:"flex",flexDirection:"column"},userName:{fontWeight:e.typography.fontWeightSemiBold,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},displayName:{fontWeight:e.typography.fontWeightSemiBold,color:"inherit",textDecoration:"inherit","&:hover, &:focus, &:active":{color:"inherit",textDecoration:"underline"}},userStatus:{fontWeight:e.typography.fontWeightRegular},notAttempted:{color:e.palette.error.main},completed:{display:"flex"},completedIcon:{marginRight:"5px",color:e.palette.success.main,alignSelf:"center"},gradepill:{display:"inline-flex",flexWrap:"wrap"},gradeInfo:{fontWeight:e.typography.fontWeightRegular,fontStyle:"italic",paddingTop:"3px",paddingLeft:"5px",color:e.palette.text.hint},pastDueZero:{fontWeight:e.typography.fontWeightLight,fontStyle:"italic",paddingTop:"3px",paddingLeft:"5px",color:e.palette.text.primary},containerIndicator:{position:"relative",width:"40px"},indicator:{marginBottom:"50%",marginTop:"50%",width:"8px",border:`1px solid ${e.palette.indicatorPrimary.contrastText}`,height:"8px",display:"inline-block",position:"absolute",borderRadius:"50%",left:"-8px",backgroundColor:e.palette.indicatorPrimary.main},lateLastEntry:{color:e.palette.error.main,fontSize:"14px",lineHeight:"21px",fontWeight:e.typography.fontWeightRegular},postedLabel:{color:e.palette.success.main,fontStyle:"italic"}}))),et={updateAttemptGrade:u.V.gradebookAttempt.updateAttemptById,loadColumnSummary:u.V.columnSummary.loadColumnSummary,loadBulkViewGrades:u.V.gradebookGrade.loadBulkView,createGradeByUserId:u.V.gradebookGrade.createGradeByUserId,updateGradeByGradeId:u.V.gradebookGrade.updateGradeByGradeId},tt=Object(o.b)(((e,{gradeColumnId:t,userId:n})=>{const a=u.Yb.gradebookColumn.getGradebookColumnById(e,t),i=null==a?void 0:a.gradingSchemaId,r=u.Yb.gradebookSchema.getGradebookSchemaById(e,i),s=u.Yb.gradebookGrade.getGradebookGradesByColumnIdAndUserId(e,t,n)[0],o=(null==a?void 0:a.courseId)&&u.Yb.courseEntitlements.userHasCourseEntitlement(e,a.courseId,S.q.EnterItemGrades),l=(null==a?void 0:a.courseId)&&u.Yb.courseEntitlements.userHasCourseEntitlement(e,a.courseId,S.q.OverrideItemGrades);let c=!1;const d=u.Yb.systemPreference.getSystemPreferenceByKey(e,"gradepill.color.preference.settings");if(d&&d.value){c=!JSON.parse(d.value).isColorEnabled}return{gradebookGrade:s,grade:null==s?void 0:s.displayGrade.score,pointsPossible:null==a?void 0:a.possible,variant:A(null==r?void 0:r.scaleType),symbolsMap:(m=null==r?void 0:r.symbols,m?m.map((e=>({symbol:e.symbol,lowerBound:e.lowerBound,upperBound:e.upperBound}))):null),symbol:null==s?void 0:s.displayGrade.grade,courseId:null==a?void 0:a.courseId,gradeId:null==s?void 0:s.id,participantId:null==s?void 0:s.memberId,enterAttemptGradesEntitlement:o,overrideGradesEntitlement:l,hasRubric:!!(null==a?void 0:a.rubricAssociations),attemptId:null==s?void 0:s.lastAttemptId,colorless:c};var m}),et)((e=>{const{userId:t,grade:n,pointsPossible:a,variant:i,symbolsMap:o,symbol:l,courseId:c,gradeId:d,attemptId:u,gradeColumnId:m,ariaLabel:p,analyticsId:h,enterAttemptGradesEntitlement:g,overrideGradesEntitlement:b,canShowRubricIcon:f,canGradeWithRubric:v,overrideGrade:y,hasRubric:C,participantId:E,gradebookGrade:k,colorless:T,isExempt:O,loadColumnSummary:A,updateAttemptGrade:x,loadBulkViewGrades:$,createGradeByUserId:N,updateGradeByGradeId:D,onGradeUpdate:L}=e,j=Object(Ye.a)(),M=()=>x({courseId:c,attemptId:u,payload:{score:null,grade:"-",status:w.l.NeedsGrading,rubricEvaluation:null}}),[G,R]=Object(r.useState)(n),B=s.a.useCallback((async e=>{e!==G&&(R(e),d&&y?(await D(k,{...k,manualScore:e}),null===e&&u&&await M()):u&&!y?(null===e?await M():await x({courseId:c,attemptId:u,payload:{score:e,readyToPost:!0}}),await D(k,{...k,manualScore:null})):await N({courseId:c,columnId:m,userId:t,manualScore:e}),$(c,[m],[E],{expand:["grade.instructorFeedback","attempts"]}),A({courseId:c,columnId:m}),L&&L(e))}),[d,G,u,y]);Object(r.useEffect)((()=>{R(P(n,a,e.variant))}),[n]);const F=()=>{I.Z.goPeekState(I.H.RubricEvaluation({userId:t}))},U=e=>s.a.createElement(s.a.Fragment,null,e&&v&&u?s.a.createElement(S.I,{onClick:F,ariaLabel:j("journals.participantGrade.rubricIconAriaLabel"),analyticsId:`${h}.gradepill.rubricIcon`}):s.a.createElement(S.I,{ariaLabel:j("journals.participantGrade.rubricIconAriaLabelDisabled")})),_=()=>{const e={grade:G,pointsPossible:a,variant:i,symbolsMap:o,gradeColorVariant:T?S.F.Black:null,onBlur:B,ariaLabel:p,analyticsId:`${h}.gradePill`};return f&&C?s.a.createElement(S.o,{...e},U(!0)):s.a.createElement(S.o,{...e})},z=e=>{let t=null;O?t=S.F.Grey:T&&(t=S.F.Black);const n={grade:G,pointsPossible:a,variant:i,symbolGrade:l,gradeColorVariant:t};return f&&C?s.a.createElement(S.H,{...n},U(e)):s.a.createElement(S.H,{...n})};return y&&b||!y&&g?O?z(!0):_():z(!1)})),nt=Object(R.makeStyles)((e=>Object(R.createStyles)({root:{margin:"0 -30px",[e.breakpoints.down("sm")]:{width:"100vw",position:"relative",left:"50%",right:"50%",marginLeft:"-50vw",marginRight:"-50vw"}},loadingSpinner:{textAlign:"center",margin:"100px"},isEmptyPage:{width:"100%",marginBottom:"30px",maxHeight:"700px","& $isEmptyImage":{display:"inline-block"}},isEmptyExplanation:{height:"100%",opacity:1,transition:`all ${e.transitions.duration.short}ms ${e.transitions.easing.easeInOut}`,padding:"0 30px"},isEmptyImage:{height:"200px",width:"auto",marginBottom:"30px",transform:"scale(1)",transition:`all ${e.transitions.duration.short}ms ${e.transitions.easing.easeInOut}`},isEmptyWrapper:{textAlign:"center",marginTop:"40px"},isEmptyHeader:{fontSize:e.typography.fontSizeXLarge}}))),at=Object(R.makeStyles)((e=>Object(R.createStyles)({gradeInfo:{fontWeight:e.typography.fontWeightRegular,paddingTop:"3px",paddingLeft:"5px",color:e.palette.text.hint}}))),it=e=>{const{isExempt:t,displayGrade:n}=e,a=Object(Ye.a)(),i=at(e);return t?s.a.createElement("span",{className:Object(U.a)("exempt",i.gradeInfo)},a("journals.gradesAndParticipation.grade.exempt")):(null==n?void 0:n.scoredByAutomaticZero)?s.a.createElement("span",{className:Object(U.a)("past-due-zero",i.gradeInfo)},a("journals.gradesAndParticipation.grade.pastDueZero")):(null==n?void 0:n.isOverride)?s.a.createElement("span",{className:Object(U.a)("override",i.gradeInfo)},a("journals.gradesAndParticipation.grade.override")):null};var rt=n("GuFu"),st=n("RPob");const ot=Object(o.b)(((e,t)=>({canPostGrades:u.Yb.courseEntitlements.userHasCourseEntitlement(e,t.courseId,S.q.PublishGrades),routeSearchParams:u.Yb.app.getLocation(e).queryParams})),null)((e=>{var t,n;const{gradeColumnId:a,participant:i,analyticsId:r,headerKey:o,isGraded:l,canPostGrades:c,dueDateJournal:d,onPostClick:u,routeSearchParams:m,participantIndex:p}=e,{translate:h,formatUsername:g,formatNumber:b}=Object(W.a)(),{courseMembershipId:f,user:v,entriesCount:y,gradeDetail:S,attemptStatus:E,lastAttemptDate:I,hasNewActivity:A}=i,P=Object(rt.z)(V.g),x=g({...i.user,preferredDisplayName:Object(st.m)(i.user,P)},H.ILocaleUsernameFormat.Short),$=Xe(e),[N,D]=s.a.useState(!1),L=Ee({routeSearchParams:m,participant:i,participantIndex:p,columnId:a});let j;w.l.NotAttempted===E&&(j=$.notAttempted),w.l.Completed===E&&(j=$.completed);const M=e=>{e.preventDefault(),e.stopPropagation(),D(!0)},G=s.a.useCallback((()=>(D(!1),u(S.columnId,S.id,f))),[M,null==S?void 0:S.columnId,null==S?void 0:S.id,f]),R=()=>{D(!1)},B=Z(d,I),F=(null==S?void 0:S.displayGrade.score)?"graded":"nonGraded";return s.a.createElement(s.a.Fragment,null,N&&s.a.createElement(Ze,{analyticsId:`${r}.confirmationDialog`,headerKey:o,showPostConfirmationModal:N,handleOnClose:R,onPostConfirmation:G}),s.a.createElement(k.AnalyticsTableRow,{className:$.participantRow,analyticsId:r},s.a.createElement(k.AnalyticsTableCell,{className:$.tableRow,analyticsId:`${r}.avatar.cell`},A&&s.a.createElement("div",{className:$.containerIndicator},s.a.createElement("span",{className:Object(U.a)("indicator",$.indicator)})),s.a.createElement(k.AnalyticsAvatar,{src:null===(n=null===(t=i.user)||void 0===t?void 0:t.avatar)||void 0===n?void 0:n.permanentUrl,size:"medium",alt:x,className:"user-avatar"})),s.a.createElement(k.AnalyticsTableCell,{className:$.tableRow,analyticsId:`${r}.userInfo.cell`},s.a.createElement("div",{className:Object(U.a)("user-info",$.userInfo)},s.a.createElement(k.AnalyticsLink,{analyticsId:`${r}.displayName`,className:Object(U.a)("display-name",$.displayName),href:L},x),s.a.createElement("span",{className:Object(U.a)("last-entry",$.userStatus,B&&$.lateLastEntry)},!(null==S?void 0:S.isExempt)&&Q(B,I,h)))),l&&s.a.createElement(k.AnalyticsTableCell,{className:Object(U.a)("attempt-status",$.tableRow),analyticsId:`${r}.attemptStatus.cell`},s.a.createElement("div",{className:j},w.l.Completed===E&&s.a.createElement(C.Complete,{className:$.completedIcon}),s.a.createElement("span",null,J(E,h)))),s.a.createElement(k.AnalyticsTableCell,{className:Object(U.a)("entries-count",$.tableRow),analyticsId:`${r}.entriesCount.cell`},s.a.createElement("span",null," ",b(null!=y?y:0)," ")),l&&s.a.createElement(k.AnalyticsTableCell,{analyticsId:`${r}.gradepill.cell`,className:$.tableRow,onClick:e=>e.stopPropagation()},s.a.createElement("div",{className:`${Object(U.a)("gradepill",$.gradepill,F)}`},s.a.createElement(tt,{isExempt:null==S?void 0:S.isExempt,gradeColumnId:a,userId:v.id,ariaLabel:(()=>{let e="scoreInputEmpty";return(null==S?void 0:S.displayGrade.scoredByAutomaticZero)?e="pastDueZeroScoreInputGraded":void 0!==(null==S?void 0:S.displayGrade.score)&&(e="scoreInputGraded"),h(`journals.gradesAndParticipation.grade.aria.${e}`,{displayName:x,grade:null==S?void 0:S.displayGrade.score,total:null==S?void 0:S.pointsPossible})})(),analyticsId:`${r}.participantGrade`,overrideGrade:!0}),s.a.createElement(it,{isExempt:null==S?void 0:S.isExempt,displayGrade:null==S?void 0:S.displayGrade}))),l&&s.a.createElement(k.AnalyticsTableCell,{analyticsId:`${r}.postGrade.cell`,className:$.tableRow},s.a.createElement("div",{className:"post-grade"},!(null==S?void 0:S.isExempt)&&T(S)&&s.a.createElement("span",{className:$.postedLabel},h("journals.gradesAndParticipation.postGrade.posted")),!(null==S?void 0:S.isExempt)&&c&&O(S)&&s.a.createElement(k.AnalyticsDefaultButton,{analyticsId:`${r}.post.button`,onClick:M},h("journals.gradesAndParticipation.postGrade.button"))))))})),lt=Object(R.makeStyles)((e=>Object(R.createStyles)({userAvatarCol:{width:"10%",[e.breakpoints.up("md")]:{width:"5.5%"}},studentInformationCol:{width:"20%",[e.breakpoints.up("md")]:{width:"26%"}},gradingStatusCol:{width:"20%"},entriesGradedCol:{width:"15%",[e.breakpoints.up("md")]:{width:"20%"}},gradingInformationCol:{width:"20%"},postGradeCol:{width:"15%",[e.breakpoints.up("md")]:{width:"10%"}},studentInformationNonGradableCol:{width:"40%"},entriesNonGradableCol:{width:"50%"},header:{paddingBottom:"10px",borderBottom:`1px solid ${e.palette.secondary.main}`,fontWeight:e.typography.fontWeightSemiBold},tableHeader:{paddingTop:"9px",paddingBottom:"10px",background:"none",borderTop:"none"},participantListTable:{textAlign:"left",width:"100%",tableLayout:"fixed"},participantList:{[e.breakpoints.up("md")]:{marginLeft:"36px",marginRight:"31px"}}}))),ct=e=>{const{gradeColumnId:t,participants:n,analyticsId:a,courseId:i,dueDateJournal:r,headerKey:o,isGraded:l,onPostClick:c}=e,d=Object(Ye.a)(),u=lt(e),m=`${a}.tableHeader`;return s.a.createElement("div",{className:u.participantList},s.a.createElement(k.AnalyticsTable,{className:u.participantListTable,analyticsId:`${a}.table`},s.a.createElement("colgroup",null,s.a.createElement("col",{className:u.userAvatarCol}),s.a.createElement("col",{className:l?u.studentInformationCol:u.studentInformationNonGradableCol}),l&&s.a.createElement("col",{className:u.gradingStatusCol}),s.a.createElement("col",{className:l?u.entriesGradedCol:u.entriesNonGradableCol}),l&&s.a.createElement(s.a.Fragment,null,s.a.createElement("col",{className:u.gradingInformationCol}),s.a.createElement("col",{className:u.postGradeCol}))),s.a.createElement(k.AnalyticsTableHead,{analyticsId:m},s.a.createElement(k.AnalyticsTableRow,{className:u.header,analyticsId:a},s.a.createElement(k.AnalyticsTableCell,{className:Object(U.a)(u.tableHeader,"user-avatar"),analyticsId:`${m}.avatar`},s.a.createElement("span",{className:"sr-only"},d("journals.gradesAndParticipation.participantListHeader.user"))),s.a.createElement(k.AnalyticsTableCell,{className:Object(U.a)(u.tableHeader,"display-name"),analyticsId:`${m}.displayName`},s.a.createElement("span",null,d(`${o}.participantListHeader.displayName`))),l&&s.a.createElement(k.AnalyticsTableCell,{className:Object(U.a)(u.tableHeader,"status"),analyticsId:`${m}.status`},s.a.createElement("span",null,d("journals.gradesAndParticipation.participantListHeader.status"))),s.a.createElement(k.AnalyticsTableCell,{className:Object(U.a)(u.tableHeader,"entries"),analyticsId:`${m}.entries`},s.a.createElement("span",null,d("journals.gradesAndParticipation.participantListHeader.entries"))),l&&s.a.createElement(s.a.Fragment,null,s.a.createElement(k.AnalyticsTableCell,{className:Object(U.a)(u.tableHeader,"grade"),analyticsId:`${m}.grade`},s.a.createElement("span",null,d("journals.gradesAndParticipation.participantListHeader.grade"))),s.a.createElement(k.AnalyticsTableCell,{className:Object(U.a)(u.tableHeader,"posted"),analyticsId:`${m}.posted`},s.a.createElement("span",{className:"sr-only"},d("journals.gradesAndParticipation.participantListHeader.grade")))))),s.a.createElement(k.AnalyticsTableBody,{id:"journals-participants-table-body",analyticsId:a},n.map(((e,n)=>s.a.createElement(ot,{key:n,gradeColumnId:t,participant:e,isGraded:l,courseId:i,headerKey:o,dueDateJournal:r,onPostClick:c,analyticsId:`${a}.participantRow`,participantIndex:n}))))))},dt=Object(R.makeStyles)((e=>Object(R.createStyles)({participantsListOptions:{display:"flex",flexDirection:"column",margin:0,[e.breakpoints.up(50)]:{flexDirection:"row",margin:"22px 31px 15px 36px",justifyContent:"space-between"}},participantFilters:{display:"flex",flexDirection:"column",height:"90px",justifyContent:"space-between",minWidth:0,margin:"16px 17px",[e.breakpoints.up(40)]:{flexDirection:"row",minWidth:"500px",height:"auto"},[e.breakpoints.up(50)]:{margin:"16px 0"}},participantsSearchBox:{[e.breakpoints.up("sm")]:{maxWidth:"290px",margin:0,width:"100%"}},participantSubmissionFilter:{display:"flex",height:"40px",alignItems:"center",[e.breakpoints.up("sm")]:{marginLeft:"20px"},"& input":{color:"transparent !important","&:focus":{boxShadow:"none"},minHeight:"auto",marginRight:"8px"},"& span":{marginRight:"8px",fontWeight:e.typography.fontWeightSemiBold}},submissionFilterDropdown:{flexGrow:1,[e.breakpoints.up(40)]:{minWidth:"155px"}},pageSizeContainer:{display:"inline-flex",alignItems:"center",borderBottom:`1px solid ${e.palette.secondary.main}`,borderTop:`1px solid ${e.palette.secondary.main}`,padding:"20px 17px",[e.breakpoints.up(50)]:{padding:0,borderBottom:"none",borderTop:"none"}},itemsPerPage:{padding:0,"& button":{border:`1px solid ${e.palette.text.hint}`,marginLeft:0}},itemsPerPagePicker:{marginRight:"8px"}}))),ut=[Number(fe.Small),Number(fe.Medium),Number(fe.Large)],mt=e=>{const{isGraded:t,limit:n,initialSearchText:a,initialSubmissionStatus:i,analyticsId:r,onSearchBoxTextChange:o,onLimitChange:l,onSubmissionStatusChange:c}=e,{translate:d,formatNumber:u}=Object(W.a)(),[m,p]=s.a.useState(i),h=dt(),[g,b]=s.a.useState(a);s.a.useEffect((()=>{b(a)}),[a]),s.a.useEffect((()=>{p(i)}),[i]);const f=s.a.useCallback((e=>{b(e),o(e)}),[o]),v=s.a.useCallback((e=>{p(e.value),c(e.value)}),[c]);return s.a.createElement("div",{className:h.participantsListOptions},s.a.createElement("div",{className:h.participantFilters},s.a.createElement(F.M,{value:g,inputId:"journals-participant-list-search-input",label:d("journals.gradesAndParticipation.search"),analyticsId:`${r}.search`,onChange:f,onClear:()=>f(""),className:h.participantsSearchBox}),s.a.createElement("div",{className:h.participantSubmissionFilter},s.a.createElement("span",null,d("journals.gradesAndParticipation.filters.label")),s.a.createElement(k.AnalyticsPicker,{className:`submissionFilterDropdown ${h.submissionFilterDropdown}`,options:[{value:ye.All,label:d("journals.gradesAndParticipation.filters.all")},{value:ye.NoSubmission,label:d("journals.gradesAndParticipation.filters.noSubmission")},...t?[{value:ye.NeedsGrading,label:d("journals.gradesAndParticipation.filters.needsGrading")}]:[],{value:ye.Complete,label:d("journals.gradesAndParticipation.filters.complete")}],onChange:v,value:{value:m,label:d(`journals.gradesAndParticipation.filters.${m}`)},"aria-label":d("journals.gradesAndParticipation.filters.label"),analyticsId:`${r}.filter.dropdown`,inputId:"journals-participant-list-submission-filter"}))),s.a.createElement("div",{className:h.pageSizeContainer},s.a.createElement(F.H,{className:h.itemsPerPage,pageSizeOptions:ut,initialPageSize:n,onPageSizeChange:e=>l(Object(_e.c)([e],u)[0]),analyticsId:r})))};const pt=Object(R.makeStyles)((e=>Object(R.createStyles)({root:{margin:"25px 0","& .paging-component-button":{border:`1px solid ${e.palette.text.hint}`}}}))),ht=e=>{const{currentPage:t,analyticsId:n,handleOnPageChange:a,numPages:i}=e,s=pt(e),o=Object(Ce.a)(),l=Object(Se.a)(o.breakpoints.down("xs"));return r.createElement("div",{className:s.root},r.createElement(F.I,{className:"paging-component",numberOfPages:i,onPageChange:e=>a(e+1),page:t-1,analyticsId:n,compact:l}))};var gt=n("bWNV"),bt=n("oYCK"),ft=n("syUg");const vt=Object(R.makeStyles)((e=>Object(R.createStyles)({participantCard:{padding:"0 18px 13px",borderTop:"none","&:hover":{backgroundColor:e.palette.background.b3,cursor:"pointer","& $displayName":{textDecoration:"underline"}}},avatar:{marginRight:"16px"},participantCardContent:{display:"flex"},userInfo:{display:"flex",flexDirection:"column",width:"80%"},displayName:{fontWeight:e.typography.fontWeightSemiBold,color:"inherit",textDecoration:"inherit",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis","&:hover, &:focus, &:active":{color:"inherit",textDecoration:"underline"}},participantData:{paddingTop:"5px"},notAttempted:{color:e.palette.error.main},gradepill:{display:"inline-flex",flex:1},gradeInfo:{fontWeight:e.typography.fontWeightRegular,fontStyle:"italic",paddingTop:"3px",paddingLeft:"5px",color:e.palette.text.hint},containerIndicator:{position:"relative",width:"40px"},indicator:{marginBottom:"50%",marginTop:"50%",width:"8px",border:`1px solid ${e.palette.indicatorPrimary.contrastText}`,height:"8px",display:"inline-block",position:"absolute",borderRadius:"50%",backgroundColor:e.palette.indicatorPrimary.main},lateLastEntry:{color:e.palette.error.main,fontSize:"14px",lineHeight:"21px",fontWeight:e.typography.fontWeightRegular},marginAvatar:{marginLeft:"10px"},postGrade:{justifyContent:"flex-end"},postedLabel:{color:e.palette.success.main,fontStyle:"italic"},participantActions:{marginLeft:"83px",marginRight:"13px",flexWrap:"wrap"},participantInfoLabel:{fontWeight:e.typography.fontWeightSemiBold},entriesCount:{fontWeight:e.typography.fontWeightRegular}}))),yt=Object(o.b)(((e,t)=>({canPostGrades:u.Yb.courseEntitlements.userHasCourseEntitlement(e,t.courseId,S.q.PublishGrades),routeSearchParams:u.Yb.app.getLocation(e).queryParams})),null)((e=>{var t,n;const{gradeColumnId:a,participant:i,analyticsId:r,headerKey:o,isGraded:l,canPostGrades:c,dueDateJournal:d,onPostClick:u,routeSearchParams:m,participantIndex:p}=e,{translate:h,formatUsername:g}=Object(W.a)(),{courseMembershipId:b,entriesCount:f,gradeDetail:v,attemptStatus:y,lastAttemptDate:S,hasNewActivity:C}=i,E=g(i.user,H.ILocaleUsernameFormat.Short),I=vt(e),[A,P]=s.a.useState(!1);let x;w.l.NotAttempted===y&&(x=I.notAttempted);const $=s.a.useCallback((()=>(P(!1),u(v.columnId,v.id,b))),[u,null==v?void 0:v.columnId,null==v?void 0:v.id,b]),N=()=>{P(!1)},D=s.a.createElement("span",{className:I.entriesCount,key:"participant-card-entries-count-span"},null!=f?f:0),L=Z(d,S),j=(null==v?void 0:v.displayGrade.score)?"graded":"nonGraded",M=Ee({routeSearchParams:m,participant:i,participantIndex:p,columnId:a});return s.a.createElement("div",null,A&&s.a.createElement(Ze,{analyticsId:`${r}.confirmationDialog`,headerKey:o,showPostConfirmationModal:A,handleOnClose:N,onPostConfirmation:$}),s.a.createElement(gt.a,{id:"journals-participant-card",analyticsId:`${r}.card`,className:I.participantCard},s.a.createElement(bt.a,{analyticsId:`${r}.cardContent`,className:I.participantCardContent},s.a.createElement("div",{className:I.avatar},C&&s.a.createElement("div",{className:I.containerIndicator},s.a.createElement("span",{className:Object(U.a)("indicator",I.indicator)})),s.a.createElement(k.AnalyticsAvatar,{src:null===(n=null===(t=i.user)||void 0===t?void 0:t.avatar)||void 0===n?void 0:n.permanentUrl,size:"medium",alt:E,className:Object(U.a)("user-avatar",I.marginAvatar)})),s.a.createElement("div",{className:Object(U.a)("user-info",I.userInfo)},s.a.createElement(k.AnalyticsLink,{analyticsId:`${r}.displayName`,className:I.displayName,href:M},E),s.a.createElement("span",{className:Object(U.a)("last-entry",L&&I.lateLastEntry)},Q(L,S,h)),l&&(()=>{const e=y&&w.l.NotAttempted!==y;return s.a.createElement("div",{className:Object(U.a)("attempt-status",x,I.participantData)},e&&s.a.createElement("span",{className:I.participantInfoLabel},`${h("journals.gradesAndParticipation.participantListHeader.status")}: `),s.a.createElement("span",{className:Object(U.a)("attempt-status-label",!e&&I.notAttempted)},J(y,h)))})(),s.a.createElement("div",{className:Object(U.a)("entries-count",I.participantData)},s.a.createElement("span",{className:I.participantInfoLabel},h("journals.gradesAndParticipation.participantListHeader.participantCard.entries",{count:D}))))),l&&s.a.createElement(ft.a,{analyticsId:`${r}.card`,className:I.participantActions},s.a.createElement("div",{className:`${Object(U.a)("gradepill",I.gradepill,j)}`},s.a.createElement(tt,{gradeColumnId:a,userId:i.user.id,ariaLabel:(()=>{let e="scoreInputEmpty";return(null==v?void 0:v.displayGrade.scoredByAutomaticZero)?e="pastDueZeroScoreInputGraded":void 0!==(null==v?void 0:v.displayGrade.score)&&(e="scoreInputGraded"),h(`journals.gradesAndParticipation.grade.aria.${e}`,{displayName:E,grade:null==v?void 0:v.displayGrade.score,total:null==v?void 0:v.pointsPossible})})(),analyticsId:`${r}.participantGrade`,overrideGrade:!0}),s.a.createElement(it,{displayGrade:null==v?void 0:v.displayGrade})),s.a.createElement("div",{className:`${Object(U.a)("post-grade",I.postGrade)}`},T(v)&&s.a.createElement("span",{className:I.postedLabel},h("journals.gradesAndParticipation.postGrade.posted")),c&&O(v)&&s.a.createElement(k.AnalyticsDefaultButton,{analyticsId:`${r}.post.button`,onClick:()=>{P(!0)}},h("journals.gradesAndParticipation.postGrade.button"))))))})),St={loadBulkViewGrades:u.V.gradebookGrade.loadBulkView,loadColumnSummary:u.V.columnSummary.loadColumnSummary,postGrade:u.V.gradebookGrade.postGradeByGradeId,postReadyGrades:u.V.gradebookColumn.postReadyGradesByColumnId},Ct=Object(o.b)(null,St)((e=>{const{analyticsId:t,courseId:n,isGraded:a,isOrganization:i,journalId:o,loadBulkViewGrades:l,loadColumnSummary:c,postGrade:u,postReadyGrades:m}=e,p=Object(Ye.a)(),h=Object(Ce.a)(),g=nt(e),b=Object(Se.a)(h.breakpoints.down("xs")),[f,v]=Ue("page","1"),[y,S]=Ue("limit",fe.Small),[C,E]=(()=>{const{name:e}=Fe(),[t,n]=Object(r.useState)(e||"");return Object(r.useEffect)((()=>{t!==(e||"")&&I.Z.search({name:t,page:"1"})}),[t]),Object(r.useEffect)((()=>{e&&e!==t&&(n(e),I.Z.search({name:e})),!e&&t&&(n(""),I.Z.search({name:void 0}))}),[e]),[t,n]})(),[w,T]=(()=>{const{submissionStatus:e}=Fe(),[t,n]=Object(r.useState)(e||ye.All);return Object(r.useEffect)((()=>{t!==(e||"")&&I.Z.search({submissionStatus:t,page:"1"})}),[t]),Object(r.useEffect)((()=>{e&&e!==t&&(n(e),I.Z.search({submissionStatus:e}))}),[e]),[t,n]})();Pe(n),$e(n,o);const{columnId:O,dueDate:A,columnSummary:P}=Ne(o,n,a),x=Be(o),$={journalId:o,courseId:n,columnId:O,submissionStatus:w,searchText:C,limit:y,page:f},{participants:N,isLoading:D,numPages:L}=Re($),j=i?"journals.gradesAndParticipation.organization":"journals.gradesAndParticipation.course",M=[O],G=(e,t,a)=>{u({courseId:n,columnId:e,id:t}).then((()=>{l(n,M,[a],{expand:["grade.instructorFeedback","attempts"]}),c({courseId:n,columnId:e})}))},R=Object(r.useCallback)((()=>{m(n,O).then((()=>{const e=N.map((e=>e.courseMembershipId));l(n,M,e,{expand:["grade.instructorFeedback","attempts"]}),c({courseId:n,columnId:O})}))}),[m,l,c,N]),B=Object(r.useCallback)(Object(d.debounce)((e=>{E(e)}),500,{leading:!1,trailing:!0}),[]),F=()=>null===D||D;return s.a.createElement("div",{className:g.root},s.a.createElement(Qe,{analyticsId:`${t}.summary`,headerKey:j,isGraded:a,participationSummary:x,columnSummary:P,postReadyGrades:R}),s.a.createElement(mt,{isGraded:a,initialSearchText:C,initialSubmissionStatus:w,analyticsId:`${t}.listOptions`,limit:y,onSearchBoxTextChange:B,onLimitChange:e=>{S(e.value)},onSubmissionStatusChange:e=>{T(e)}}),F()&&s.a.createElement("div",{className:g.loadingSpinner},s.a.createElement(k.AnalyticsCircularProgress,{id:"journals-gradesAndParticipation-spinner",ariaLabel:p("journals.gradesAndParticipation.spinner"),size:"large"})),!F()&&((null==N?void 0:N.length)>0?s.a.createElement(s.a.Fragment,null,!b&&s.a.createElement(ct,{gradeColumnId:O,participants:N,dueDateJournal:A,isGraded:a,courseId:n,headerKey:j,onPostClick:G,analyticsId:`${t}.participantList`}),b&&N.map(((e,i)=>s.a.createElement(yt,{key:i,gradeColumnId:O,participant:e,isGraded:a,courseId:n,headerKey:j,dueDateJournal:A,onPostClick:G,participantIndex:i,analyticsId:`${t}.participantCard`})))):(()=>{const e=(null==x?void 0:x.totalStudentsCount)>0?s.a.createElement("div",{className:g.isEmptyExplanation},s.a.createElement("img",{className:g.isEmptyImage,src:Ke,alt:""}),s.a.createElement("h3",{className:g.isEmptyHeader},p("journals.gradesAndParticipation.noResultsFound"))):s.a.createElement("div",{className:g.isEmptyExplanation},s.a.createElement("img",{className:g.isEmptyImage,src:Ke,alt:""}),s.a.createElement("h3",{className:g.isEmptyHeader},p(`${j}.emptyExplanationHeaderKey`)),s.a.createElement("span",null,p(`${j}.emptyExplanationContentKey`)));return s.a.createElement("div",{className:"grades-and-participation"},s.a.createElement("div",{className:Object(U.a)(g.isEmptyPage,"is-empty-page")},s.a.createElement("div",{className:g.isEmptyWrapper},e)))})()),L>1&&s.a.createElement(ht,{currentPage:Number(f),numPages:L,analyticsId:`${t}.listFooterOptions`,handleOnPageChange:e=>{v(String(e))}}))})),Et=Object(R.makeStyles)((e=>Object(R.createStyles)({submissionWrapper:{margin:"0 -20px",[e.breakpoints.up("sm")]:{margin:"0 -30px"}},loadingSpinner:{textAlign:"center",margin:"100px"}})));var It=n("BY8f");const kt=Object(R.makeStyles)((e=>Object(R.createStyles)({containerStatus:{backgroundColor:e.palette.background.b2,width:"100%",padding:"0 18px",flexFlow:"wrap",display:"flex",flexDirection:"column-reverse",[e.breakpoints.up("sm")]:{padding:"18px 70px",alignItems:"center",flexDirection:"row"},[e.breakpoints.up("md")]:{padding:"18px 132px"}},journal:{[e.breakpoints.up("sm")]:{display:"flex",flex:1}},journalInformation:{textAlign:"center",margin:"18px 0",[e.breakpoints.up("sm")]:{textAlign:"inherit",margin:"0"}},journalIcon:{display:"none",[e.breakpoints.up("sm")]:{display:"inherit",marginRight:"15px"}},journalDates:{fontSize:e.typography.fontSizeMedium,fontWeight:e.typography.fontWeightSemiBold},date:{fontSize:e.typography.fontSizeDefault,fontWeight:e.typography.fontWeightRegular},entriesCommentsCount:{color:e.palette.text.secondary},gradesAndFeedback:{display:"flex",alignSelf:"center",marginTop:"10px",[e.breakpoints.up("sm")]:{marginTop:0,display:"flex",justifyContent:"flex-end",alignItems:"center"}},grade:{alignSelf:"center",marginRight:"10px",[e.breakpoints.up("sm")]:{}},exempt:{color:x.c.granite},menu:{alignSelf:"flex-end",position:"absolute",right:"15px",[e.breakpoints.up("sm")]:{justifyContent:"flex-end",position:"inherit",right:"0px"}},feedbackIcon:{color:e.palette.brand.main},undoOverride:{alignSelf:"center",marginRight:"10px"}})));var wt=n("uk6l"),Tt=n("3/0u");const Ot=e=>{const{target:t,isOrganization:n,analyticsId:a,onClose:i,onPostConfirmation:r}=e,o=Object(Ye.a)(),l=o("journals.gradesAndParticipation.postGrade.confirmation.title"),c=o(`journals.gradesAndParticipation.${n?"organization":"course"}.postConfirmationDialog`);return s.a.createElement(Tt.Dialog,{showAsCallout:!0,onDismiss:i,target:t,dialogContentProps:{type:Tt.DialogType.actionConfirmation,title:l,subText:c,showCloseButton:!1},analyticsId:`${a}.dialog`},s.a.createElement(Tt.DialogFooter,null,s.a.createElement(te.AnalyticsDefaultButton,{onClick:i,analyticsId:`${a}.cancel.button`},o("journals.gradesAndParticipation.postGrade.confirmation.cancelButton")),s.a.createElement(te.AnalyticsPrimaryButton,{onClick:r,analyticsId:`${a}.post.button`},o("journals.gradesAndParticipation.postGrade.confirmation.postButton"))))},At={loadColumnSummary:u.V.columnSummary.loadColumnSummary,loadGradebookGradesByColumnId:u.V.gradebookGrade.loadGradebookGradesByColumnId,postGrade:u.V.gradebookGrade.postGradeByGradeId,updateGrade:u.V.gradebookGrade.updateGradeByGradeId},Pt=Object(o.b)(((e,{participantId:t,journalId:n,columnId:a,courseId:i})=>{var r,s,o,l;const c=u.Yb.app.getLocation(e).queryParams,d=Number(null!==(r=c.entryLimit)&&void 0!==r?r:ve.Small),m={courseId:i,blogId:n,assignedUserId:t,expand:"userStatus",paging:{limit:d,offset:(Number(null!==(s=c.entryPage)&&void 0!==s?s:1)-1)*d}},p=t&&n&&(null===(l=null===(o=u.Yb.blog.entries.getBlogEntriesViewStatusByQuery(e,m))||void 0===o?void 0:o.paging)||void 0===l?void 0:l.count),h=t&&u.Yb.courseMembership.getCourseMembershipByMembershipId(e,t),g=a&&u.Yb.gradebookColumn.getGradebookColumnById(e,a),b=a&&h&&u.Yb.gradebookGrade.getGradebookGradesByColumnIdAndUserId(e,a,null==h?void 0:h.userId)[0];return{gradeId:null==b?void 0:b.id,userId:null==h?void 0:h.userId,entriesCount:p,dueDate:null==g?void 0:g.dueDate,creationDate:null==g?void 0:g.dateCreated,gradeNeedsPosting:O(b),gradeDetail:b,participantMembership:h,gradeUseRubric:!!(null==g?void 0:g.rubricAssociations)}}),At)((e=>{var t,n;const{gradeId:a,courseId:i,entriesCount:r,dueDate:o,creationDate:l,columnId:c,userId:d,analyticsId:u,gradeNeedsPosting:m,isOrganization:p,gradeDetail:h,gradeUseRubric:b,postGrade:f,loadGradebookGradesByColumnId:v,participantMembership:y,loadColumnSummary:S,updateGrade:E,onGradeUpdate:w}=e,{translate:T,formatDate:O}=Object(W.a)(),A="journals.submissions.submissionStatus",P=T(`${A}.entriesCount`,{numEntries:null!=r?r:0}),x=kt(e),[$,N]=s.a.useState(!1),D=s.a.createElement("span",{className:x.date,key:"submission-status-creation-date-span"},l&&O(l,H.ILocaleDateFormat.Short)),L=s.a.createElement("span",{className:x.date,key:"submission-status-due-date-span"},o&&O(o,H.ILocaleDateFormat.Short)),j=T(`${A}.journalDates`,{creationDateSpan:D,dueDateSpan:L}),M=()=>{N(!0)},G=s.a.useCallback((()=>{I.Z.goPeekState(I.z.JournalSubmissionFeedback({columnId:c,userId:d}))}),[c,d]),R=s.a.createElement(wt.ActionMenu,{ariaLabel:T(`${A}.actionMenu.ariaLabel`),menuProps:{items:(()=>{const e=[];return m&&!(null==h?void 0:h.isExempt)&&e.push({key:"post",name:`${T(`${A}.actionMenu.post`)}`,icon:s.a.createElement(C.Post,null),onClick:M}),e.push({key:"editFeedback",name:`${T(`${A}.actionMenu.editFeedback`)}`,icon:s.a.createElement(C.Edit,null),onClick:G}),e})()},analyticsId:`${u}.actionMenu`,className:"postGradeActionMenu"});s.a.useEffect((()=>{i&&c&&(null==y?void 0:y.userId)&&v({columnId:c,courseId:i,userId:y.userId})}),[i,c,null==y?void 0:y.userId]);const B=!(null===(t=null==h?void 0:h.displayGrade)||void 0===t?void 0:t.scoredByAutomaticZero)&&!(null==h?void 0:h.isExempt)&&(null===(n=null==h?void 0:h.displayGrade)||void 0===n?void 0:n.isOverride);return s.a.createElement("div",{className:x.containerStatus},s.a.createElement("div",{className:x.journal},s.a.createElement("div",{className:x.journalIcon},s.a.createElement(It.a,{color:"primary"})),s.a.createElement("div",{className:Object(U.a)(x.journalInformation,"journal-information")},s.a.createElement("div",{className:Object(U.a)(x.journalDates,"journal-dates")},j),s.a.createElement("div",{className:Object(U.a)(x.entriesCommentsCount,"entries-count")},P))),s.a.createElement("div",{className:x.gradesAndFeedback},B&&s.a.createElement("div",{className:x.undoOverride},s.a.createElement(k.AnalyticsLink,{onClick:async()=>{await E(h,{...h,manualScore:null}),w&&w(null)},analyticsId:`${u}.undoOverride.link`,component:"button"},T("journals.undoOverride"))),s.a.createElement("div",{className:x.grade},s.a.createElement(tt,{isExempt:null==h?void 0:h.isExempt,gradeColumnId:c,userId:d,analyticsId:`${u}.participantGrade`,canShowRubricIcon:!0,canGradeWithRubric:!!r,overrideGrade:b||!r,ariaLabel:(()=>{let e="scoreInputEmpty";return(null==h?void 0:h.displayGrade.scoredByAutomaticZero)?e="pastDueZeroScoreInputGraded":void 0!==(null==h?void 0:h.displayGrade.score)&&(e="scoreInputGraded"),T(`journals.submissions.submissionStatus.grade.aria.${e}`,{grade:null==h?void 0:h.displayGrade.score,total:null==h?void 0:h.pointsPossible})})(),onGradeUpdate:w})),(null==h?void 0:h.isExempt)&&s.a.createElement("span",{className:Object(U.a)(x.exempt,"exempt-tag")},T("journals.gradesAndParticipation.grade.exempt")),s.a.createElement("div",null,s.a.createElement(k.AnalyticsIconButton,{"aria-label":T(`${A}.feedbackAriaLabel`),analyticsId:`${u}.edit.feedback.iconButton`,onClick:G,className:"js-feedback-button"},(()=>{var e;return(null===(e=null==h?void 0:h.instructorFeedback)||void 0===e?void 0:e.rawText)?s.a.createElement(g.Feedback,{className:x.feedbackIcon}):s.a.createElement(g.AddFeedback,null)})())),s.a.createElement("div",{className:x.menu},R)),$&&s.a.createElement(Ot,{analyticsId:`${u}.postConfirmationDialog`,target:".postGradeActionMenu",isOrganization:p,onClose:()=>{N(!1)},onPostConfirmation:()=>{f({courseId:i,columnId:c,id:a}).then((()=>{var e;w((null===(e=h.displayGrade)||void 0===e?void 0:e.score)||h.manualScore),S({courseId:i,columnId:c})})),N(!1)}}))})),xt=Object(R.makeStyles)((e=>Object(R.createStyles)({submissionContent:{marginTop:"-10px"},journalSubmission:{maxWidth:"1000px",margin:"0 20px",[e.breakpoints.up("sm")]:{marginLeft:"177px",marginRight:"253px"}}}))),$t=Object(R.makeStyles)((e=>Object(R.createStyles)({promptHeader:{padding:"17px 0",borderBottom:`1px solid ${e.palette.border.main}`,margin:0,fontWeight:e.typography.fontWeightSemiBold},emptyPrompt:{padding:"16px 10px",fontStyle:"italic"}}))),Nt=Object(o.b)(((e,t)=>{const n=u.Yb.blog.blogs.getBlogById(e,t.journalId);return{journalPrompt:n&&n.description.rawText}}),null)((e=>{const{journalPrompt:t,courseId:n}=e,a={apiBasePath:u.cb.apiBasePath,xsrfToken:u.cb.xsrf,courseId:n},i=$t(),r=Object(d.uniqueId)("journalPromptTitle"),o=Object(Ye.a)();return s.a.createElement("div",null,s.a.createElement("h2",{className:i.promptHeader,id:r},o("journals.journalPrompt.title")),t&&s.a.createElement(l.BbEditor,{isReadOnly:!0,ariaLabelledBy:r,bbml:t,plugins:[Object(l.link)(),Object(l.image)(),Object(l.video)(),Object(l.math)({...a}),Object(l.insertLocalFile)(a)]}),""===t&&s.a.createElement("div",{className:i.emptyPrompt},s.a.createElement("span",null,o("journals.journalPrompt.emptyPrompt"))))})),Dt=Object(R.makeStyles)((()=>Object(R.createStyles)({journalEntries:{maxWidth:"1000px",margin:"auto",marginTop:"20px"}}))),Lt=e=>{const{courseId:t,journalId:n,assignedUserId:a,creatorId:i,pluginConfig:r,analyticsId:o}=e,l=Dt(e);return s.a.createElement("div",{className:l.journalEntries},s.a.createElement(We,{assignedUserId:a,journalId:n,courseId:t,creatorId:i,pluginConfig:r,analyticsId:o}))},jt=e=>{const{courseId:t,columnId:n,journalId:a,participantId:i,isGraded:r,creatorId:l,isOrganization:c,pluginConfig:d,analyticsId:m,onGradeUpdate:p}=e,h=Object(o.d)(),g=xt(e);return s.a.useEffect((()=>{i&&(I.Z.search({participantId:String(i)}),function(e,t){h(u.V.blog.participants.updateParticipantActivity(e,t))}(i,a))}),[i,a]),i?s.a.createElement("div",{className:g.submissionContent},r&&s.a.createElement(Pt,{participantId:i,journalId:a,courseId:t,analyticsId:`${m}.status`,isOrganization:c,columnId:n,onGradeUpdate:p}),s.a.createElement("div",{className:g.journalSubmission},s.a.createElement(Nt,{journalId:a,courseId:t}),s.a.createElement(Lt,{assignedUserId:i,journalId:a,courseId:t,creatorId:l,pluginConfig:d,analyticsId:`${m}.entries`}))):null},Mt=e=>{const{analyticsId:t,columnId:n,courseId:a,creatorId:i,isGraded:r,isOrganization:o,journalId:l,participants:c,pluginConfig:d,onGradeUpdate:u,offset:m,onOffsetChange:p}=e,{translate:h,formatUsername:g}=Object(W.a)(),b=Object(rt.z)(V.g),f=c.map((e=>{if(!e)return{name:null,getContent:()=>null};const c={...e.user,preferredDisplayName:Object(st.m)(e.user,b)};return{name:g(c,H.ILocaleUsernameFormat.Short),getContent:()=>s.a.createElement(jt,{analyticsId:`${t}.content`,courseId:a,participantId:e.courseMembershipId,journalId:l,creatorId:i,columnId:n,pluginConfig:d,isGraded:r,isOrganization:o,onGradeUpdate:u})}})),v=s.a.useCallback((()=>h("journals.submissions.onSlideChangeMessage",{participantNumber:m})),[h,m]),y=s.a.useCallback((e=>{p(e)}),[p]);return s.a.createElement(F.e,{analyticsId:`${t}.participants.carousel`,slides:f,onSlideChangeMessage:v,slideIndex:m,onSlideChange:y})};const Gt=e=>{var t,n;const{analyticsId:a,columnId:i,courseId:l,creatorId:c,isGraded:d,isOrganization:m,journalId:p,pluginConfig:h,onGradeUpdate:g}=e,[b,f]=s.a.useState(!1),[v,y]=s.a.useState(!1),S=Object(o.e)((e=>u.Yb.app.getLocation(e).queryParams)),[C,E]=Object(r.useState)(Number(S.offset)),[k,w]=Object(r.useState)(Number(null!==(t=S.entryLimit)&&void 0!==t?t:ve.Small)),[T,O]=Object(r.useState)(Number(null!==(n=S.entryPage)&&void 0!==n?n:"1"));let A;const P=function(e,t,n,a,i,r,l,c,d){const m=Object(o.d)(),p=X(t,e,i,n,a,r);return s.a.useEffect((()=>{e&&t&&l&&I.Z.search({offset:String(a),entryPage:String(d),entryLimit:String(c)}).then((()=>{m(u.V.blog.participants.loadParticipantList(p))}))}),[l,e,t,i,n,a,r,d,c]),Object(o.e)((e=>{const t=u.Yb.blog.participants.getBlogParticipantsByQuery(e,p);return(null==t?void 0:t.length)?t.map((t=>({courseMembershipId:t.courseMembershipId,user:u.Yb.user.getUserById(e,t.userId)}))):[]}))}(l,p,3,C,S.name,S.submissionStatus,v,k,T);C<0&&P.unshift(null);const x=((e,t,n,a,i)=>{const s=Object(o.d)();return Object(r.useCallback)((r=>{if(1===r&&e){const{journalId:e,courseId:a,name:i,serverLimit:r,participantOffset:o,submissionStatus:l,entryPage:c,entryLimit:d}=t,m=X(e,a,i,r,o,l);a&&e&&n&&I.Z.search({offset:String(o),entryPage:String(c),entryLimit:String(d)}).then((()=>{s(u.V.blog.participants.loadParticipantList(m))}))}else a(r);i()}),[e,n,t.journalId,t.courseId,t.name,t.serverLimit,t.participantOffset,t.submissionStatus,t.entryPage,t.entryLimit])})(b,{journalId:p,courseId:l,name:S.name,serverLimit:3,participantOffset:C,submissionStatus:S.submissionStatus,entryLimit:k,entryPage:T},v,(e=>{E(C+e)}),(()=>{f(!1),w(Number(ve.Small)),O(1)}));s.a.useEffect((()=>(A=S,I.Z.search({limit:String(3)}),y(!0),()=>{const e=A.limit===String(3)?fe.Small:A.limit;I.Z.search({...A,offset:void 0,limit:String(e)})})),[]);const $=Object(r.useCallback)((e=>{S.submissionStatus!==ye.All&&f(((e,t)=>{const n=t===ye.Complete?ye.NeedsGrading:t;return("number"==typeof e?ye.Complete:n)!==t})(e,S.submissionStatus)),g()}),[S.submissionStatus,f,g]),N=Object(r.useCallback)((e=>{x(e)}),[x]);return s.a.createElement(Mt,{analyticsId:a,courseId:l,journalId:p,creatorId:c,columnId:i,pluginConfig:h,isGraded:d,isOrganization:m,onGradeUpdate:$,participants:P,offset:1,onOffsetChange:N})};const Rt=()=>{},Bt=e=>{const t=function(e){return Object(o.e)((t=>[{courseMembershipId:e,user:u.Yb.courseMembership.getUserFromMembershipId(t,e)}]))}(Object(o.e)((e=>u.Yb.app.getLocation(e).queryParams)).singleMembershipId);return s.a.createElement(Mt,{...e,participants:t,offset:0,onOffsetChange:Rt})};const Ft=e=>{var t;const n={...S.j};e.childCourseIds&&(n.childCourseId=e.childCourseIds),e.groupIds&&(n.groupId=e.groupIds),e.courseMemberIds&&(n.membershipId=e.courseMemberIds);const a={courseId:e.courseId,sort:S.k,filter:n},i=Object(o.e)((t=>u.Yb.courseMembership.getLatestViewWithMembershipId(t,e.participantId,a)));if(!i)throw new Error("No similar views were found to contain the provided membership");const r=i.indexInCollection;let l;let c;0===r?(l=0,c=0):(l=r-1,c=1);const d=null!==(t=function(e){const t=Object(o.d)(),n=Object(o.e)((t=>{const n=u.Yb.courseMembership.getCourseMembershipViewStatusByQuery(t,e);return(null==n?void 0:n.isValid)?u.Yb.courseMembership.getCourseMembershipsByQuery(t,e).map((e=>({user:u.Yb.user.getUserById(t,e.userId),courseMembershipId:e.id}))):null})),a=Object(o.e)((t=>u.Yb.courseMembership.getCourseMembershipViewStatusByQuery(t,e)));return n||(null==a?void 0:a.isLoading)||t(u.V.courseMembership.loadCourseMembershipsByQuery(e)),n}({...a,paging:{limit:3,offset:l}}))&&void 0!==t?t:[],m=s.a.useCallback((t=>{let n;n=d[0].courseMembershipId===e.participantId||2===d.length&&1===t?1:1+t;const a=d[n].courseMembershipId;I.Z.search({participantId:a,entryLimit:ve.Small,entryPage:"1"})}),[d]);return 1===d.length&&(c=0),s.a.createElement(Mt,{analyticsId:"journal-grid-detail",courseId:e.courseId,journalId:e.journalId,participants:d,columnId:e.columnId,creatorId:e.creatorId,isGraded:e.isGraded,isOrganization:e.isOrganization,offset:c,onOffsetChange:m,pluginConfig:e.pluginConfig,onGradeUpdate:e.onGradeUpdate})},Ut=e=>{var t,n,a;const i=Object(o.e)((e=>u.Yb.app.getLocation(e).queryParams)),r={groupIds:null===(t=i.courseGroupId)||void 0===t?void 0:t.split(","),childCourseIds:null===(n=i.childCourseId)||void 0===n?void 0:n.split(","),courseMemberIds:null===(a=i.memberId)||void 0===a?void 0:a.split(","),participantId:i.participantId};return r.participantId?s.a.createElement(Ft,{...e,...r}):s.a.createElement("div",null)},_t=e=>{const{parentView:t}=e,n=Et(e),a=Object(Ye.a)();return s.a.createElement("div",{className:n.submissionWrapper},t===i.PARTICIPANTS_VIEW&&s.a.createElement(Gt,{...e}),t===i.STUDENT_LIST_VIEW&&s.a.createElement(Bt,{...e}),t===i.GRID_VIEW&&s.a.createElement(Ut,{...e}),!t&&s.a.createElement("div",{className:n.loadingSpinner},s.a.createElement(k.AnalyticsCircularProgress,{id:"journals-gradesAndParticipation-spinner",ariaLabel:a("journals.gradesAndParticipation.spinner"),size:"large"})))};var zt=n("kwLz");const qt={createGrade:u.V.gradebookGrade.createGradeByUserId,updateGrade:u.V.gradebookGrade.updateGradeByGradeId},Ht=Object(o.b)(null,qt)((e=>{var t,n,a,i;const{bbmlPluginConfig:r,courseId:o,columnId:c,isOrganization:d,userId:m,createGrade:p,updateGrade:h,onFeedbackUpdate:g}=e,{formatUsername:b,locale:f}=Object(W.a)(),v=Te(m),y=ke(c,m),C=Ae(o,S.q.EnterFeedback),E=Object(rt.m)(),k=s.a.useRef(""),w=s.a.useRef(Object(l.generateToBbML)(k.current)),[T,O]=s.a.useState(!0),[A,P]=s.a.useState(!1);s.a.useEffect((()=>{var e;const t=null===(e=null==y?void 0:y.instructorFeedback)||void 0===e?void 0:e.rawText;k.current=null!=t?t:"",O(!!t||!C)}),[y,C]);const x=s.a.useCallback((async()=>{var e,t;if(y){if(k.current!==(null===(e=y.instructorFeedback)||void 0===e?void 0:e.rawText)){P(!0);try{const e=await w.current(!0);await h(y,{...y,instructorFeedback:{...null==y?void 0:y.instructorFeedback,rawText:e}})}finally{P(!1)}g&&g()}}else{P(!0);try{const e=await w.current(!0);await p({columnId:c,courseId:o,userId:m,instructorFeedback:{...null==y?void 0:y.instructorFeedback,rawText:e}})}finally{P(!1)}g&&g()}(null===(t=null==y?void 0:y.instructorFeedback)||void 0===t?void 0:t.rawText)?O(!0):I.Z.leavePeekState()}),[p,h,y]),$=s.a.useCallback((()=>{y||I.Z.leavePeekState(),O(!0)}),[y]),N=s.a.useCallback((()=>{O(!1)}),[]),D=s.a.useCallback((e=>{w.current=e.toBbML,k.current=e.toBbML()}),[]);return s.a.createElement(zt.a,{analyticsId:"course.journal.submission.feedback",panelTitle:b({familyName:null!==(t=null==v?void 0:v.familyName)&&void 0!==t?t:"",givenName:null!==(n=null==v?void 0:v.givenName)&&void 0!==n?n:""},H.ILocaleUsernameFormat.Short),configProps:{isOrganization:d,courseColorClass:"",editorConfigProps:{apiBasePath:u.cb.apiBasePath,courseId:o,onClickCancel:$,onClickSave:x,xsrfToken:u.cb.xsrf,locale:f,...r,fileUploadSettings:E},primaryFeedbackConfigProps:{onFeedbackChange:D,onClickEdit:N,editorIsReadOnly:T}},primaryGraderFeedback:{isFeedbackEditable:!A&&C,rawTextFeedback:null!==(i=null===(a=null==y?void 0:y.instructorFeedback)||void 0===a?void 0:a.rawText)&&void 0!==i?i:""}})}));n.d(t,"e",(function(){return i})),n.d(t,"f",(function(){return G})),n.d(t,"b",(function(){return We})),n.d(t,"a",(function(){return Ct})),n.d(t,"c",(function(){return _t})),n.d(t,"d",(function(){return Ht})),n.d(t,"g",(function(){return ye}))},Bu0u:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n("6ynb");class i extends a.a{constructor(e){super(e),this.name="InvalidArgumentsError"}}},ByeC:function(e,t){e.exports='<bb-modal id="disallow-folder-upload-modal" class="notification js-disallow-folder"\n          modal-title-key="{{isChrome || hasFiles ? \'components.directives.fileUpload.disallowFolderUploadTitle\' : \'components.directives.fileUpload.disallowFolderUploadNotChromeTitle\'}}"\n          analytics-id-tag-prefix="components.directives.fileUpload">\n  <div name="modal-contents">\n    <ng-switch on="isChrome">\n      <div ng-switch-when="true">\n        <p>\n          <bb-translate>components.directives.fileUpload.disallowFolderUploadFull</bb-translate>\n        </p>\n      </div>\n      <div ng-switch-default>\n        <ng-switch on="hasFiles">\n          <div ng-switch-when="true">\n            <p>\n              <bb-translate>components.directives.fileUpload.disallowFolderUploadFullNotChromeAdditionalFiles</bb-translate>\n            </p>\n          </div>\n          <div ng-switch-default>\n            <p>\n              <bb-translate>components.directives.fileUpload.disallowFolderUploadFullNotChromeNoMoreFiles</bb-translate>\n            </p>\n          </div>\n        </ng-switch>\n      </div>\n    </ng-switch>\n  </div>\n  <div name="modal-footer" class="reveal-modal__footer-content reveal-modal__footer-content--gray" ng-switch on="isChrome || hasFiles">\n    <div class="reveal-modal__footer-buttons">\n      <span class="reveal-modal__footer-button-container" ng-switch-when="true">\n        <button class="button button--secondary js-secondary-button" ng-click="fileUpload.modalCancelUpload()" analytics-id="components.directives.fileUpload.no">\n          <bb-translate>components.directives.fileUpload.no</bb-translate>\n        </button>\n      </span>\n      <span class="reveal-modal__footer-button-container" ng-switch-when="true">\n        <button class="button js-primary-button" ng-click="fileUpload.closeModal()" analytics-id="components.directives.fileUpload.yes">\n          <bb-translate>components.directives.fileUpload.yes</bb-translate>\n        </button>\n      </span>\n      <span class="reveal-modal__footer-button-container" ng-switch-when="false">\n        <button class="button js-primary-button" ng-click="fileUpload.modalCancelUpload()" analytics-id="components.directives.fileUpload.cancelUploadText">\n          <bb-translate>components.directives.fileUpload.cancelUploadText</bb-translate>\n        </button>\n      </span>\n    </div>\n  </div>\n</bb-modal>\n'},"C/Ry":function(e,t){e.exports='<th class="table-cell"\n    scope="row"\n    ng-show="tableCell.column.visible">\n  <div class="sr-only alternate-contents"></div>\n  <div class="transclude-container"></div>\n</th>'},CPVT:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n("D57K"),i=n("TnpK"),r=n("Qbdf"),s=n("aHpC"),o=n("Llzl");const l="ultra.components.directives.confirmationCourseOrgTokenReplacementDirective";class c{constructor(e,t,n,a,i){this.element=e,this.attributes=t,this.scope=n,this.ultraState=a,this.currentCourse=i;try{(a.includes("base.organizations.**")||i.course&&i.course.isOrganization)&&t.bbConfirmationNeeded&&(t.bbConfirmationNeeded=this.replaceToken(t.bbConfirmationNeeded),e.attr("bb-confirmation-needed",this.replaceToken(t.bbConfirmationNeeded)))}catch(e){}}replaceToken(e){return e?e.replace("resource/x-bb-course-","resource/x-bb-organization-"):e}}let d=class{constructor(e,t){this.ultraState=e,this.currentCourse=t,this.restrict="A",this.scope=!1,this.priority=-1,this.compile=()=>(e,t,n)=>new c(t,n,e,this.ultraState,this.currentCourse)}};d=Object(a.a)([Object(a.c)(0,Object(s.b)(i.d)),Object(a.c)(1,Object(s.b)(r.e))],d),o.module(l,[i.b]).directive("confirmationCourseOrgTokenResolver",["$injector",e=>e.instantiate(d)])},CPqS:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return I}));var a=n("Llzl"),i=n("Sa5G"),r=n("0JpG"),s=n("w9Zy"),o=n("nYZ0"),l=n("ZzN+"),c=n("hqh6"),d=n("5RJJ"),u=n("pjml"),m=n("TnpK"),p=n("Qbdf"),h=n("tQ/B"),g=n("X455"),b=n("uC9d"),f=n("x+T+"),v=n("nmzr"),y=n("eQBN"),S=n("WIGI"),C=n("jhBu"),E=n("fYJU");const I="ultra.course.routes";a.module(I,[c.a,d.a,p.b,g.a,y.b,h.b]).config([m.c,p.c,g.b,y.c,h.c,(t,a,c,d,h)=>{t.peekState(v.G.Course.COURSE,{abstract:!0,url:"^/{coursesOrOrganizations:(?:courses|organizations)}/:courseId",panelClass:"full",require:()=>Promise.all([n.e(0),n.e(22),n.e(47),n.e(56)]).then(n.bind(null,"ogn+")),resolve:{currentColumn:()=>null,[p.d]:a.resolve,[g.c]:c.resolve,currentCourseId:["$state",e=>e.nextParams.courseId],courseEntitlementsLoader:["currentCourseId",f.c,(e,t)=>t.loadCourseEntitlements(e)],"?courseMembershipsLoader":["currentCourseId",u.m.serviceName,(e,t)=>t.$new(e).memberships.$fetch({limit:1e4}).$asPromise()],isOrganization:[p.d,m.d,(e,t)=>(t.nextParams.coursesOrOrganizations=e.isOrganization?"organizations":"courses",e.isOrganization)],[y.d]:d.resolve},onEnter:[g.d,e=>{var t,n;const a=null===(n=null===(t=null==e?void 0:e.courseMembership)||void 0===t?void 0:t.courseRole)||void 0===n?void 0:n.identifier;a&&Object(S.c)({courseRole:a})}],onExit:["$rootScope","$stateParams","membership",r.serviceName,s.e,p.e,l.b,b.c,E.b,g.d,(t,n,a,i,r,s,o,l,c,d)=>{t.bbOffcanvasOpened=!1,r.close("course");s.course.isClassic()&&t.$broadcast("reloadCourse",n.courseId);const u=a.isStudentMembership(),m=!c.userModel.isGuest();!u&&m&&d.courseMembership.$fetch().$allow([404]).$asPromise().then((e=>{e.isStudentMembership()&&l.clearCache("users/"+c.userId+"/memberships")})),o.showPreviewAlert=!0,e(window.parent.document).find("body").removeClass("has-footer-in-preview-mode"),Object(S.a)()}]}).peekState(v.G.Course.COURSE_ANALYTICS,{url:"/analytics",views:{"course@":{require:[()=>Promise.all([n.e(31),n.e(87)]).then(n.bind(null,"amHh")),()=>Promise.all([n.e(0),n.e(22),n.e(47),n.e(56)]).then(n.bind(null,"ogn+"))],resolve:{"analytics-translations":[r.serviceName,e=>e.loadBundle("features/course/analytics/course-analytics")]}}},panelClass:"full",pageTitleHandler:h.config({listenOn:"update-course-name",provides:"CoursePageTitleHandler"}),pageTitle:"course.analytics.headerLabel"}).peekState(v.G.Course.COURSE_ANALYTICS_PREDICT_INSTRUCTOR,{url:"/predict?resetFTUE",views:{"analytics@":{require:()=>Promise.all([n.e(38),n.e(42),n.e(53),n.e(145),n.e(697)]).then(n.bind(null,"x4MM")),resolve:{"predict-translations":[r.serviceName,e=>e.loadBundle("features/predict/predict")]}}},pageTitleHandler:h.config({listenOn:"update-course-name",provides:"CoursePageTitleHandler"}),pageTitle:"predict.course.title",peekStates:["predictCourseStudentPanel"],panelClass:"full"}).peekState(v.G.Course.COURSE_ANALYTICS_PREDICT_STUDENT,{url:"/predict/:studentId",views:{"analytics@":{require:()=>Promise.all([n.e(38),n.e(50),n.e(42),n.e(41),n.e(48),n.e(53),n.e(82),n.e(716)]).then(n.bind(null,"lanz")),resolve:{"predict-translations":[r.serviceName,e=>e.loadBundle("features/predict/predict")]}}},peekStates:["predictMessagingPanel"],pageTitleHandler:h.config({listenOn:"update-course-name",provides:"CoursePageTitleHandler"}),pageTitle:"course.title.predictStudent",panelClass:"full"}).peekState(v.G.Course.COURSE_ANALYTICS_REPORTS,{url:"/reports",views:{"analytics@":{require:[()=>Promise.all([n.e(31),n.e(646)]).then(n.bind(null,"Va14")),()=>Promise.all([n.e(31),n.e(87)]).then(n.bind(null,"amHh")),()=>Promise.all([n.e(0),n.e(22),n.e(47),n.e(56)]).then(n.bind(null,"ogn+"))],resolve:{"analytics-translations":[r.serviceName,e=>e.loadBundle("features/course/analytics/course-analytics")]}}},panelClass:"full",pageTitleHandler:h.config({listenOn:"update-course-name",provides:"CoursePageTitleHandler"}),pageTitle:"course.analytics.headerLabel"}).peekState(v.G.Course.COURSE_ANALYTICS_SCORM_REPORTS,{url:"/scormReports",resolve:{[p.d]:a.resolve},views:{"analytics@":{require:[()=>n.e(691).then(n.bind(null,"txuS")),()=>Promise.all([n.e(31),n.e(87)]).then(n.bind(null,"amHh"))],resolve:{"scorm-report-analytics-translations":[r.serviceName,e=>e.loadBundle("features/course/content/scorm/scorm")]}}},peekStates:["scorm-analytics-report"],panelClass:"full",pageTitleHandler:h.config({listenOn:"update-course-name",provides:"CoursePageTitleHandler"}),pageTitle:"course.analytics.title.scormReports"}).peekState(v.G.Course.COURSE_ANALYTICS_QUESTION_ANALYSIS,{url:"/questionAnalysis",views:{"analytics@":{require:()=>Promise.all([n.e(3),n.e(13),n.e(12),n.e(14),n.e(96),n.e(735)]).then(n.bind(null,"ErSj")),resolve:{"question-analysis-translations":[r.serviceName,e=>e.loadBundle("features/course/question-analysis")]}}},peekViewName:"question-analysis-report-list",peekStates:["question-analysis"],panelClass:"full",pageTitleHandler:h.config({listenOn:"update-course-name",provides:"CoursePageTitleHandler"}),pageTitle:"course.question-analysis.report-list.pageTitle"}).peekState(v.G.Course.COURSE_ANALYTICS_ACTIVITY,{url:"/courseActivity",views:{"analytics@":{require:()=>Promise.all([n.e(38),n.e(50),n.e(41),n.e(48),n.e(57),n.e(64),n.e(148),n.e(750)]).then(n.bind(null,"pri/")),resolve:{translations:["$q",r.serviceName,(e,t)=>e.all([t.loadBundle("components/directives/telemetry/telemetry"),t.loadBundle("components/services/telemetry-chart")])],[p.d]:a.resolve}}},peekStates:[v.n.COURSE_MESSAGE,"event-create","telemetry-settings",v.K.INSTRUCTOR_DETAILS],peekViewName:"telemetry-instructor-class-base@",panelClass:"full",pageTitle:"components.directives.telemetry.panel.titleInstructor"}).peekState(v.G.Course.COURSE_CALENDAR,{url:"/calendar",views:{"course@":{require:[()=>Promise.all([n.e(102),n.e(0),n.e(22),n.e(36),n.e(47),n.e(83),n.e(604)]).then(n.bind(null,"bbBO")),()=>Promise.all([n.e(0),n.e(22),n.e(47),n.e(56)]).then(n.bind(null,"ogn+"))],resolve:{"calendar-translations":[r.serviceName,e=>e.loadBundle("features/course/calendar/course-calendar")]}}},courseEntitlement:i.d.ViewCalendar,peekStates:[v.G.Calendar.CREATE_EVENT,v.G.Calendar.EDIT_EVENT,v.G.Calendar.VIEW_EVENT,v.G.Calendar.COURSE_SCHEDULE,v.G.Calendar.OFFICE_HOURS,v.G.Lti.LTI,v.G.Lti.LTI_LAUNCH_PEEK,"conversion-analysis","content-manage","assignment","grade-item","assessment","scorm-launch-frame","scorm-settings","gradebook-item.scorm-submissions","scorm-overview"],panelClass:"full",peekViewName:"calendar-panel-base",pageTitleHandler:h.config({listenOn:"update-course-name",provides:"CoursePageTitleHandler"}),pageTitle:"course.calendar.headerLabel"}).peekState(v.G.Course.COURSE_ENGAGEMENT,{url:"/engagement",resolve:{"engagement-translations":[r.serviceName,e=>e.loadBundle("features/course/engagement/course-engagement")]},views:{"course@":{require:()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(20),n.e(52),n.e(65),n.e(75),n.e(69),n.e(91),n.e(692)]).then(n.bind(null,"QVC4"))}},panelClass:"full",peekStates:["content-manage","conversion-analysis","discussion",v.G.Content.CONDITIONAL_RELEASE_PEEK_PANEL,"content-group-enroll","discussion-settings",v.G.Telemetry.DISCUSSION_FORUM_INSIGHTS,"course-group","discussions-settings"],peekViewName:"engagement-panel-base",pageTitleHandler:h.config({listenOn:"update-course-name",provides:"CoursePageTitleHandler"}),pageTitle:"course.engagement.headerLabel"}).peekState(v.G.Course.COURSE_GRADES,{url:`/grades?${v.m.join("&")}`,views:{"course@":{require:[()=>Promise.all([n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(15),n.e(16),n.e(17),n.e(52),n.e(156),n.e(611)]).then(n.bind(null,"OFW5")),()=>Promise.all([n.e(0),n.e(22),n.e(47),n.e(56)]).then(n.bind(null,"ogn+"))],resolve:{"grades-translations":[r.serviceName,e=>e.loadBundle("features/course/grades/course-grades")]}}},resolve:{courseEntitlement:["$q","membership",C.b,(e,t,n)=>t.isStudentMembership()?e.resolve(!0):n.isEntitled("course.gradebook-metadata.VIEW")]},peekStates:[v.G.Course.ACCOMMODATION,"assignment","assessment","gradebook-item","scorm-settings","gradebook-item.scorm-submissions","scorm-launch-frame","scorm-overview",v.G.Course.COURSE_GRADES_MULTIPLE_ATTEMPT,"assignment-grading",v.G.Grade.SUBMISSION_GRADING,"group-submission-grading","grade-item","grade-setting","grade-download-setting","grade-upload-setting",v.G.Grade.GRADE_AND_FEEDBACK,"conversion-analysis","content-manage",v.G.Lti.LTI,"discussion","submission-list","rubric","overall-grade","overall-grade-student","attendance","attendance-student-records","attendance-student-view","question-analysis",v.G.Grade.RECONCILE_GRADE,"grades-bulk-download",v.G.Grade.DOWNLOAD_TEST_RESULTS,v.G.Course.COURSE_GRADES_VIEW_INDIVIDUAL_GRADES,v.G.Journal.JOURNAL_PARTICIPATION_DETAIL,v.G.Grade.GRADEBOOK_GRID_ADVANCED_FILTERS,v.G.Grade.ATTEMPT_RECEIPT_SEARCH],panelClass:"full",peekViewName:"grades-panel-base",pageTitleHandler:h.config({listenOn:"update-course-name",provides:"CoursePageTitleHandler"}),pageTitle:"course.grades.instructorHeaderLabel"}).peekState(v.G.Course.COURSE_MESSAGES,{url:"/messages",views:{"course@":{require:[()=>Promise.all([n.e(31),n.e(0),n.e(22),n.e(49),n.e(51),n.e(146),n.e(695)]).then(n.bind(null,"vjWz")),()=>Promise.all([n.e(0),n.e(22),n.e(47),n.e(56)]).then(n.bind(null,"ogn+"))],resolve:{"messages-translations":[r.serviceName,e=>e.loadBundle("features/course/messages/course-messages")]}}},panelClass:"full",peekStates:["create-message","edit-message","conversion-analysis"],pageTitleHandler:h.config({listenOn:"update-course-name",provides:"CoursePageTitleHandler"}),pageTitle:"course.messages.headerLabel"}).peekState(v.G.Course.COURSE_OUTLINE,{url:"/outline?legacyUrl?enrollmentMessage?inPreviewMode",views:{"course@":{require:[()=>Promise.all([n.e(0),n.e(1),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(10),n.e(40),n.e(36),n.e(46),n.e(49),n.e(51),n.e(69),n.e(61),n.e(77),n.e(76),n.e(81),n.e(171)]).then(n.bind(null,"Qile")),()=>Promise.all([n.e(0),n.e(22),n.e(47),n.e(56)]).then(n.bind(null,"ogn+"))],resolve:{isClassicCourse:[p.d,m.d,(e,t)=>{if(!e.isUltra())return t.goPeekState("course.classic.outline",{courseId:e.id,legacyUrl:t.nextParams.legacyUrl})}],translations:["$q",r.serviceName,(e,t)=>e.all([t.loadBundle("features/course/outline/course-outline"),t.loadBundle("features/course/course-overview/course-overview")])]}}},onExit:["$rootScope",m.d,(e,t)=>{"base.calendar"===t.getBaseState()&&e.$broadcast("deadline-refresh")}],peekStates:[v.G.Announcement.ANNOUNCEMENTS_LIST,v.G.Announcement.ANNOUNCEMENT_DETAIL,"assignment","assessment-settings","question-analysis","question-banks","assessment-safe-assign-settings","bulk-edit-content",v.u.PREVIEW_FILE,v.G.Calendar.COURSE_SCHEDULE,"content-group-enroll","content-manage","conversion-analysis","conversion-risk-analysis","description",v.G.Calendar.VIEW_EVENT,"exports","gradebook-item","import-report",v.G.Course.COURSE_MESSAGE,"roster","collab","stream-message","assessment",v.G.ContentMarket.CONTENT_MARKET,v.G.ContentCollection.CONTENT_COLLECTION,"document-settings","partner-tool",v.G.Lti.LTI,v.G.Lti.LTI_LAUNCH_PEEK,"discussion-settings","conversations","books-and-tools","rubric",v.G.Telemetry.CONTENT_ACTIVITY_IN_DETAIL,v.G.Telemetry.DISCUSSION_FORUM_INSIGHTS,"overall-grade","attendance","attendance-student-view","course-group-enroll",v.G.Content.CONDITIONAL_RELEASE_PEEK_PANEL,"course-group","scorm-settings","gradebook-item.scorm-submissions","group-set-detail","group-set-list","scorm-launch-frame","scorm-overview","content-navigator-transition-peek","content-navigator-transition-full","content-navigator-placeholder","scorm-analytics-report",v.G.Course.EDIT_BANNER,v.G.CourseTasks.COURSE_TASKS_LOGS,v.G.Group.IMPORT_GROUP_SET,v.G.Group.EXPORT_GROUP_SET,v.G.Group.IMPORT_GROUP_MEMBERS,v.G.Group.GROUP_MEMBERS_LIST],peekViewName:"content-create-base",pageTitleHandler:h.config({listenOn:"update-course-name",provides:"CoursePageTitleHandler"}),pageTitle:"course.outline.tab.title",panelClass:"full"}).peekState("content-navigator-transition-peek",{url:"/content-navigator-transition-peek",template:'<div class="spinner bb-secondary-color-2"></div>',panelClass:"peek"}).peekState("content-navigator-transition-full",{url:"/content-navigator-transition-full",template:'<div class="spinner bb-secondary-color-2"></div>',panelClass:"full"}).peekState("content-navigator-placeholder",{url:"/link/{contentId:_[0-9]+_1}",require:()=>Promise.all([n.e(1),n.e(2),n.e(623)]).then(n.bind(null,"1Uig")),panelClass:"full",peekStates:[v.G.Lti.LTI],resolve:{currentContent:[m.d,p.d,"$q",(e,t,n)=>{const a=e.nextParams.contentId?e.nextParams.contentId:e.nextParams.id;if(a&&a!==u.p.CREATE_CONTENT_ID)return t.contents.$find(a).$asPromise()}]}}).peekState(v.G.Content.CONDITIONAL_RELEASE_PEEK_PANEL,{url:"/conditionalRelease?contentId",pageTitle:"course.conditionalRelease.panelTitle",require:[()=>Promise.all([n.e(1),n.e(2),n.e(5),n.e(586)]).then(n.bind(null,"gl4I")),()=>Promise.all([n.e(0),n.e(1),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(10),n.e(40),n.e(36),n.e(46),n.e(49),n.e(51),n.e(69),n.e(61),n.e(77),n.e(76),n.e(81),n.e(171)]).then(n.bind(null,"Qile"))],panelClass:"peek",peekStates:["group-set-list"],peekViewName:"conditional-release-peek",allowChildPeekStates:!0,resolve:{[p.d]:a.resolve,currentContent:[m.d,"currentCourse",o.f,(e,t,n)=>{const a=e.nextParams.contentId,i=n.findRootNode(t,u.p.ContentRootNode.ROOT);return n.getOrMakeContentInContentTree(i,t.id,a).then((e=>e.content))}],translations:[r.serviceName,e=>e.loadBundle("features/course/conditional-release/conditional-release")]}}).peekState(v.G.Course.COURSE_CLASSIC,{abstract:!0,url:"/cl"}).peekState("course.classic.outline",{url:"/outline?legacyUrl?enrollmentMessage",require:[()=>Promise.all([n.e(0),n.e(22),n.e(47),n.e(56)]).then(n.bind(null,"ogn+"))],resolve:{"outline-translations":[r.serviceName,e=>e.loadBundle("features/course/outline/course-outline")]},peekStates:[v.G.Telemetry.CONTENT_ACTIVITY_IN_DETAIL],peekViewName:"course-classic-peek",pageTitle:"course.outline.tab.title",panelClass:"full"}).peekState("edit-file-settings",{require:[()=>n.e(169).then(n.bind(null,"TFHU"))],resolve:{translations:[r.serviceName,e=>e.loadBundle("features/course/content/media-widget/media-widget")]},url:"/fileAttachment?toolContentName&fileIndex&isRenderedInline&linkName&parentToolInstanceName&isDecorative&alternativeText&mediaType&mimeType&bbmlEditorId"}).peekState("bulk-edit-content",{url:"/bulkEditContent",require:[()=>n.e(619).then(n.bind(null,"iGvw"))],pageTitle:"course.outline.bulkEditHeaderLabel",panelClass:"full",courseEntitlement:i.f.ViewAsDesigner}).peekState(v.u.PREVIEW_FILE,{url:"/file/:id?view",require:[()=>Promise.all([n.e(0),n.e(1),n.e(2),n.e(4),n.e(19),n.e(32),n.e(89),n.e(596)]).then(n.bind(null,"vFEc"))],pageTitle:"course.content.file",panelClass:"full",allowChildPeekStates:!0,peekViewName:"file-preview-peek",peekStates:[v.u.PREVIEW_FILE_EDIT,v.n.COURSE_MESSAGE,v.G.Course.COURSE_GRADES_VIEW_INDIVIDUAL_GRADES]}).peekState(v.u.PREVIEW_FILE_EDIT,{resolve:{translations:[r.serviceName,e=>e.loadBundle("features/course/content/course-content")]},url:"/edit",require:[()=>Promise.all([n.e(19),n.e(24),n.e(99)]).then(n.bind(null,"ebp7")),()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(20),n.e(19),n.e(21),n.e(23),n.e(29),n.e(26),n.e(25),n.e(27),n.e(28),n.e(24),n.e(30)]).then(n.bind(null,"5lIA"))],allowChildPeekStates:!0,peekViewName:"file-goal-peek",peekStates:["goal-picker-legacy",v.k.CONDITIONAL_RELEASE_PEEK_PANEL],panelClass:"peek",pageTitle:"course.content.file"}).peekState(v.G.Course.EDIT_BANNER,{url:"/editBanner?id",resolve:{translations:[r.serviceName,e=>e.loadBundle("features/course/edit-banner/edit-banner")]},require:()=>Promise.all([n.e(1),n.e(2),n.e(61),n.e(603)]).then(n.bind(null,"WXoY")),pageTitle:"course.editBanner.panelTitle"})}])}).call(this,n("71td"))},Cxi4:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d}));var a=n("Llzl"),i=n("nYZ0"),r=n("Sa5G"),s=n("ZQFV"),o=n("jhBu"),l=n("pjml");const c="ultra.components.services.discussionPermission",d="discussionPermission";class u{constructor(e,t,n,a){this.$q=e,this.content=t,this.CourseModel=n,this.entitlement=a}canCreateAllContent(e){if(e){const t=this.CourseModel.$new(e),n=this.content.findRootNode(t,l.p.ContentRootNode.INTERACTIVE);let a;return n.$then((()=>{a=n.children,a||(a=n.getChildren({limit:0}))})).$asPromise().then((()=>a.$asPromise().then((()=>a.permissions&&a.permissions.create))))}return this.$q.when(!1)}hasEditPermission(e){return this.entitlement.hasCourseEntitlement(r.f.ModifyContent,e)}hasEditAvailabilityPermission(e){return this.entitlement.hasCourseEntitlement(r.f.ModifyContentAvailability,e)}hasEditDueDatePermission(e){return this.entitlement.hasCourseEntitlement(s.q.ModifyItemDueDate,e)}hasGradingPermission(e){return this.entitlement.hasCourseEntitlement(s.q.ModifyGradebook,e)}canDeleteDiscussion(e,t){return t&&t.permissions?t.canDelete():e&&e.canDelete()}areAnyGroupEntitled(e){return this.entitlement.areAnyEntitled([r.o.CreateGroups,r.o.DeleteGroups,r.o.ManageGroupMembership,r.o.ModifyGroups,r.o.ViewGroups],e)}}u.$inject=["$q",i.f,l.m.serviceName,o.b];a.module(c,[i.d,l.N,o.a]).service(d,u)},DDbI:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n("Llzl"),i=n("w9Zy"),r=n("TnpK"),s=n("nmzr");const o="profile.update-avatar.routes";a.module(o,[i.d,r.b]).config([r.c,e=>{e.peekState(s.D.UPDATE_AVATAR_PEEK,{url:"/avatar/update",require:()=>Promise.all([n.e(43),n.e(659)]).then(n.bind(null,"Jgl2")),pageTitle:"base.profile.update-avatar.pageTitle"})}])},DH9M:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));n("QLzv");var a=n("5MwF"),i=n("yCC5"),r=n("Rjd/"),s=n("nkTj");const o=i.ec;r.a.factory(o,["restmod",s.c,(e,t)=>{const n=a.a.apiBasePath+"/v1/announcements";return e.model(n)}])},DU7P:function(e,t,n){"use strict";var a;n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),function(e){e.None="",e.Respondus="Respondus",e.IMS="IMS"}(a||(a={}));const i="rs-lockdown"},DlnX:function(e,t,n){},DpvE:function(e,t){e.exports='<div>\n  <div class="initials"></div>\n  <div class="image"></div>\n</div>'},DsaG:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return l}));var a=n("Llzl"),i=n("f4B+"),r=n("IbyE"),s=n("AuQm");const o="ultra.components.services.fileViewer",l="fileViewer",c="audio",d="image",u="video",m="gif",p="jpeg",h="png";class g{constructor(t){this.$sce=t,this.canFileBeRenderedInline=e=>{if(!e)return!1;const t=this.getMediaSubType(e),n=this.getMediaType(e);switch(n){case d:return[p,m,h].indexOf(t)>-1;case c:case u:{const t=document.createElement(n);return t.canPlayType&&!!t.canPlayType(e)}}return Object(s.bb)(e)},this.getMediaSubType=e=>{var t;return null!==(t=null==e?void 0:e.substring(e.indexOf("/")+1))&&void 0!==t?t:null},this.getMediaType=e=>{var t;return null!==(t=null==e?void 0:e.substring(0,e.indexOf("/")))&&void 0!==t?t:null},this.isMediaFile=t=>e.inArray(t,[d,u,c])>=0,this.shouldRenderInlineByDefault=e=>{let t=!1;const n=this.getMediaType(e.currentMimeType);return n?t=this.isMediaFile(n):Object(s.bb)(e.currentMimeType)&&(t=!0),t},this.isAudioFile=e=>e===c,this.isImageFile=e=>e===d,this.isVideoFile=e=>e===u,this.initUiField=e=>{null==e.ui&&(e.ui={}),e.viewerData&&e.viewerData.viewerUrl&&(e.ui.trustedViewUrl=this.$sce.trustAsResourceUrl(e.viewerData.viewerUrl)),e.ui.iconClass=Object(r.yb)(e.currentMimeType);const{currentMimeType:t}=e;e.ui.mediaType=this.getMediaType(t),e.ui.mediaSubtype=this.getMediaSubType(t),e.ui.canBeRenderedInline=this.canFileBeRenderedInline(t),e.ui.safeAltText=e.alternativeText?i.a.HTML(e.alternativeText):""}}}g.$inject=["$sce"];a.module(o,[]).service(l,g)}).call(this,n("71td"))},Dwp2:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n("Llzl"),i=n("YOs/"),r=n("65PF"),s=n("C/Ry");const o="ultra.components.directives.table.tableCell";class l{constructor(e,t,n){this.scope=e,this.element=t,this.ctrl=n,this.getColumn(),this.handleAlternateText()}getColumn(){this.column=this.ctrl.getConfig().columns[this.scope.columnIndex()]}handleAlternateText(){if(this.column&&this.column.alternateTextFn){const e=this.column.alternateTextFn(this.scope.item);this.element.find(".alternate-contents").text(e),this.element.find(".transclude-container").attr("aria-hidden","true")}}}l.$inject=["scope","element","ctrl"];class c{constructor(e){this.$injector=e,this.require="^bbTable",this.restrict="E",this.replace=!0,this.transclude=!0,this.template=function(e,t){return"true"===t.header?s:r},this.scope={columnIndex:"&",header:"@"},this.link=(e,t,n,a,i)=>{e.item=e.$parent.$parent.item,e.tableCell=this.$injector.instantiate(l,{scope:e,element:t,ctrl:a}),i(((n,a)=>{a.item=e.item,t.find(".transclude-container").append(n)}))}}}c.$inject=["$injector"],a.module(o,[i.b]).directive("bbTableCell",["$injector",e=>e.instantiate(c)])},DyQT:function(e,t){e.exports='<div bb-load-bundle="components/directives/save-tray">\n  <div class="notification-container" ng-switch on="saveTray.status">\n    <span class="progress-indicator"><div class="canvas" ng-class="{\'success-state\' : saveTray.status === \'success\', \'error-state\' : saveTray.status === \'error\'}"></div></span>\n    <span class="progress-status" ng-switch-default bb-translate>{{::saveTray.localizationKeysPrefix}}.loadingMoreItems</span>\n    <span class="progress-status" ng-switch-when="success" bb-translate>{{::saveTray.localizationKeysPrefix}}.itemsLoaded</span>\n    <span class="progress-status" ng-switch-when="error" bb-translate>{{::saveTray.localizationKeysPrefix}}.itemsFailedToLoad</span>\n  </div>\n</div>\n'},E01l:function(e,t){e.exports='<bb-modal class="notification group-attempt-access-control-dialog {{additionalClass}}"\n  modal-translate-options="modalTranslateOptions"\n  analytics-id-tag-prefix="components.directives.groupAttemptAccessControlDialog">\n\n  <div name="modal-contents">\n\n    <div class="queue">\n      <div class="owner user-tile">\n        <div>\n          <bb-avatar user="owner"></bb-avatar>\n          <bb-username user="owner"></bb-username>\n        </div>\n      </div>\n      <div class="user-tile queuer" ng-repeat="user in queuedUsers track by user.id" ng-class="\'queuer-\' + $index">\n        <div>\n          <bb-avatar user="user"></bb-avatar>\n          <bb-username user="user"></bb-username>\n        </div>\n      </div>\n    </div>\n\n    <p ng-bind-html="::modalStrings.instructions"></p>\n  </div>\n  <span name="modal-footer-button-primary">\n    <button class="button confirm-ok js-primary-button" ng-click="okAction()" ng-if="!hideOK" analytics-id="primary.ok.action.button">{{::modalStrings.ok}}</button>\n    <button class="button confirm-cancel js-secondary-button" ng-click="cancelAction()" ng-if="hideOK" analytics-id="secondary.cancel.action.button">{{::modalStrings.cancel}}</button>\n  </span>\n  <span name="modal-footer-button-secondary">\n    <button class="button button--secondary confirm-cancel js-secondary-button" ng-click="cancelAction()" ng-if="!hideOK" analytics-id="secondary.cancel.action.button">{{::modalStrings.cancel}}</button>\n  </span>\n</bb-modal>\n'},EN13:function(e,t){e.exports='<bb-modal class="notification js-non-file-error" \n          modal-title-key="components.directives.fileUpload.disallowNonFileUploadTitle"\n          analytics-id-tag-prefix="components.directives.fileUpload">\n  <div name="modal-contents">\n    <p>\n      <bb-translate>components.directives.fileUpload.disallowNonFileUploadError</bb-translate>\n    </p>\n  </div>\n  <button name="modal-footer-button-primary" class="button js-primary-button" ng-click="fileUpload.modalCancelUpload()" analytics-id="components.directives.fileUpload.cancelUploadText">\n    <bb-translate>components.directives.fileUpload.cancelUploadText</bb-translate>\n  </button>\n</bb-modal>\n'},Ediv:function(e,t){e.exports='\x3c!--\n  this #ftue-new div is copied from first-time-visit-directive.html.\n  it may need to move back up a level if/when the welcome template is made configurable.\n--\x3e\n<div id="ftue-new" class="base-ftue" ng-if="firstVisit">\n  <div id="ftue-new-1" class="ftue-new-slide current-view">\n    <div class="slide-content large-6 large-offset-3 medium-8 medium-offset-2 small-10 small-offset-1">\n      <h2 bb-translate>welcome.welcome.title</h2>\n\n      <div>\n        <a href="javascript:void(0);" class="ftue-img ftue-1-button scroll-button" tabindex="0" analytics-id="welcome.welcome.welcomeIcon.link"><img\n                                          src="./static/images/ftue/ftueMMicon_blank.gif"\n                                          in-view="loadImage($inview, $inviewpart, $event,((\'./static/images/ftue/ftuMMicon_Welcome.gif\')))"\n                                          in-view-options="{ debounce: 100 }"\n                                          bb-translate-attrs="{alt: \'welcome.welcome.alt\'}"\n                                          ></a>\n      </div>\n      <p class="medium-up-padding" bb-translate>welcome.welcome.description</p>\n    </div>\n    <div class="slide-control">\n\n      <button class="button ftue-1-button icon round ftue-advance large scroll-button"\n                                                                  bb-translate-attrs="{\'aria-label\': \'welcome.welcome.alt\'}"\n                                                                  analytics-id="welcome.welcome.downIcon.button"><i\n                                                                  class="icon-chevron-down"\n\n                                                                  ></i>\n      </button>\n    </div>\n  </div>\n\n  <div class="ftue-new-slide" id="ftue-new-2">\n    <div class="slide-content large-6 large-offset-3 medium-8 medium-offset-2 small-10 small-offset-1">\n      <h2 bb-translate>welcome.layers.title</h2>\n\n      <div>\n        <a id="ftue-new-2-img" href="javascript:void(0);" class="ftue-img ftue-2-button scroll-button" tabindex="0" analytics-id="welcome.welcome.neverLoseYourPlace.link"><img\n                                          src="./static/images/ftue/ftueMMicon_blank.gif"\n                                          in-view="loadImage($inview, $inviewpart, $event,((\'./static/images/ftue/ftuMMicon_NeverLoseYourPlace.gif\')))"\n                                          in-view-options="{ debounce: 100 }"\n                                          bb-translate-attrs="{alt: \'welcome.layers.alt\'}"></a>\n      </div>\n      <p bb-translate>welcome.layers.description</p>\n    </div>\n    <div class="slide-control">\n      <button class="button icon round ftue-advance large ftue-2-button scroll-button"\n                                                                  bb-translate-attrs="{\'aria-label\': \'welcome.layers.alt\'}"\n                                                                  analytics-id="welcome.welcome.downIcon.button"><i\n                                                                  class="icon-chevron-down"\n                                                                  ></i>\n      </button>\n    </div>\n  </div>\n\n  <div class="ftue-new-slide" id="ftue-new-3">\n    <div class="slide-content large-6 large-offset-3 medium-8 medium-offset-2 small-10 small-offset-1">\n      <h2 bb-translate>welcome.safe.title</h2>\n\n      <div>\n        <a id="ftue-new-3-img" href="javascript:void(0);" class="ftue-img ftue-3-button" ng-click="welcome.goNextPage()" tabindex="0" analytics-id="welcome.welcome.goNextPage.link"><img\n                                          src="./static/images/ftue/ftueMMicon_blank.gif"\n                                          in-view="loadImage($inview, $inviewpart, $event,((\'./static/images/ftue/ftuMMicon_FeelFree.gif\')))"\n                                          in-view-options="{ debounce: 100 }"\n                                          bb-translate-attrs="{alt: \'welcome.safe.alt\'}"></a>\n      </div>\n      <p bb-translate>welcome.safe.description</p>\n\n    </div>\n    <div class="slide-control">\n      <button class="button round ftue-end large ftue-3-button" bb-translate ng-click="welcome.goNextPage()" analytics-id="welcome.safe.button">welcome.safe.button</button>\n    </div>\n  </div>\n</div>\n'},FBBZ:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"j",(function(){return c})),n.d(t,"b",(function(){return d})),n.d(t,"i",(function(){return u})),n.d(t,"c",(function(){return m})),n.d(t,"d",(function(){return p})),n.d(t,"l",(function(){return h})),n.d(t,"k",(function(){return g})),n.d(t,"m",(function(){return b})),n.d(t,"n",(function(){return f})),n.d(t,"h",(function(){return v})),n.d(t,"f",(function(){return y})),n.d(t,"e",(function(){return S})),n.d(t,"o",(function(){return C})),n.d(t,"g",(function(){return E}));var a=n("nsO7"),i=n("Q/M7"),r=n("5MwF");const s=["xplor-connector"];function o(e){return i.c(r.a.partnerCloudBasePath+e)}function l(e){const t=e.baseUrl+"/ultra/features/course/partner-tool/partner-tool-return-page.html";return o("/launch/lti?returnUrl="+encodeURIComponent(t)+"&uri_uri="+encodeURIComponent("ACTION:cloudProvisioning")+"&content_id="+encodeURIComponent(e.parentId||"")+"&window=false&disclaimer=true&provider_id=CLOUD1&uri_scheme=ACTION&custom_error_url="+encodeURIComponent(t)+"&action=cloudProvisioning&uri_id="+(new Date).getTime().toString()+"&course_id="+encodeURIComponent(e.courseId||"")+"&public=true&ignore_partner_settings=false&target=_self")}function c(e){let t="/content"+(e.displayInIframe?"/ultra":"")+"?provider_id="+encodeURIComponent(e.partnerId)+"&course_id="+encodeURIComponent(e.courseId);return e.parentId&&(t+="&content_id="+encodeURIComponent(e.parentId)),e.position&&(t+="&position="+encodeURIComponent(e.position)),e.mode&&(t+="&mode="+encodeURIComponent(e.mode)),o(t)}function d(e){let t="/content/return?provider_id="+encodeURIComponent(e.providerId)+"&course_id="+encodeURIComponent(e.courseId)+"&content_id="+encodeURIComponent(e.contentId)+"&parentId="+encodeURIComponent(e.parentId)+"&position="+encodeURIComponent(e.position);return t+=e.itemIds?"&itemIds="+encodeURIComponent(e.itemIds):"&root=true",o(t)}function u(e){const t=e.baseUrl+"/webapps/blackboard/execute/blti/launchReturn";return o("/launch/lti?window=false&action=provisioning&ignore_partner_settings=false&uri_scheme=ACTION&target=_self&uri_id="+(new Date).getTime().toString()+"&uri_uri="+encodeURIComponent("ACTION:provisioning")+"&b2Uri="+encodeURIComponent("/webapps/partner-cloud/")+"&course_id="+encodeURIComponent(e.courseId)+"&content_id="+encodeURIComponent(e.parentId||"")+"&provider_id="+encodeURIComponent(e.partnerId)+"&returnUrl="+encodeURIComponent(t)+"&custom_error_url="+encodeURIComponent(t))}function m(e){return o("/course/tools?provider_id="+encodeURIComponent(e.partnerId)+"&course_id="+encodeURIComponent(e.courseId))}function p(e){return o("/gradeLink/grade?outcomeDefinitionId="+encodeURIComponent(e.gradableItemId)+"&linkRefId="+encodeURIComponent(e.linkId)+"&course_id="+encodeURIComponent(e.courseId)+"&attempt_id="+encodeURIComponent(e.attemptId)+"&courseMembershipId="+encodeURIComponent(e.membershipId)+"&cancelGradeUrl")}function h(e){return o("/diagnostics/ultra?provider_id="+encodeURIComponent(e.partnerId)+"&course_id="+encodeURIComponent(e.courseId)+"&ignore_partner_settings=false")}function g(e){return o("/contentRefresh/preview/ultra?provider_id="+encodeURIComponent(e.partnerId)+"&course_id="+encodeURIComponent(e.courseId)+"&ignore_partner_settings=false")}function b(e){return o("/gradeRefresh/preview/ultra?provider_id="+encodeURIComponent(e.partnerId)+"&course_id="+encodeURIComponent(e.courseId)+"&ignore_partner_settings=false")}function f(e){return o("/course/roster/ultra?provider_id="+encodeURIComponent(e.partnerId)+"&course_id="+encodeURIComponent(e.courseId)+"&ignore_partner_settings=false")}function v(e){return e?e&&e.toolProvider&&e.toolProvider.toolProviderProfile&&e.toolProvider.toolProviderProfile.name?e.toolProvider.toolProviderProfile.name:e&&e.portfolio&&e.portfolio.name?e.portfolio.name:e.providerId:""}function y(e,t){if(!e)return"";const n=t?e.iconUrl:e.associatedIconUrl;return n?i.l(n):""}function S(e){if(!e)return"";let t;return e.toolProvider&&e.toolProvider.toolProviderProfile&&(t=e.toolProvider.toolProviderProfile.description),t||""}function C(e){return e.toolProvider&&e.toolProvider.toolProviderProfile&&e.toolProvider.toolProviderProfile.internalProviderProfile&&e.toolProvider.toolProviderProfile.internalProviderProfile.pluginDescriptor&&a.includes(s,e.toolProvider.toolProviderProfile.internalProviderProfile.pluginDescriptor.handle)||!1}function E(e){const t=[];return Array.prototype.push.apply(t,e.premierList),Array.prototype.push.apply(t,e.signatureList),Array.prototype.push.apply(t,e.otherList),t.forEach((e=>{e.childProviders&&Array.prototype.push.apply(t,e.childProviders)})),a.keyBy(t,"providerId")}},"FE+f":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n("Llzl"),i=n("0JpG"),r=n("TnpK");const s="ultra.course.description.router";a.module(s,[r.b,i.moduleName]).config([r.c,e=>{e.peekState("description",{url:"/description",resolve:{translations:[i.serviceName,e=>e.loadBundle("features/course/description/course-description")]},require:()=>n.e(170).then(n.bind(null,"8WQs")),pageTitle:"course.description.header"})}])},FHk9:function(e,t,n){"use strict";n.r(t),n.d(t,"EVENT_BBML_EDITOR_IS_UPDATED",(function(){return a})),n.d(t,"EVENT_BBML_EDITOR_FORCE_UPDATE",(function(){return i})),n.d(t,"EVENT_BBML_EDITOR_ID_GENERATED",(function(){return r})),n.d(t,"ReorderBlockEventInfo",(function(){return s}));const a="bbml-updated",i="bb-bbml-editor-force-bbml-update",r="bb-bbml-editor-id-generated";class s{}},FR7u:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return i}));n("FwJ5");var a=n("Llzl");const i="ultra.components.directives.clickScrollTo";class r{constructor(){this.restrict="A",this.link=(t,n,a)=>{n.on("click",(()=>{e(a.bbClickScrollTo).scrollintoview({duration:500})})),t.$on("$destroy",(()=>{n.off()}))}}}a.module(i,[]).directive("bbClickScrollTo",["$injector",e=>e.instantiate(r)])}).call(this,n("71td"))},Fvsw:function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return f}));var a=n("nsO7"),i=n("Llzl"),r=n("Sa5G"),s=n("ZQFV"),o=n("jhBu"),l=n("fYJU"),c=n("Qbdf"),d=n("emI2"),u=n("X455"),m=n("pjml"),p=n("eUpQ"),h=n("VAMW"),g=n("6fZB");const b="ultra.service.context",f="context";var v;!function(e){e.Administrator="administrator",e.NonStudent="nonstudent",e.Student="student",e.ClassicNonStudent="classicnonstudent",e.ClassicStudent="classicstudent"}(v||(v={}));class y{constructor(e){this.service=e,this.key=h.d.Context}isTelemetryEnabled(){return Object(g.a)(this.service.isTelemetryEnabled())}}class S{constructor(e,t,n,i,s,o,l,c,d,u,m,p){this.$rootScope=e,this.$q=t,this.currentUser=n,this.EntitlementService=i,this.currentCourse=s,this.currentCourseMembership=o,this.preferenceService=l,this.BrandModel=c,this.SystemInfoModel=d,this.PrivacyPolicyModel=u,this.PredictFtueModel=m,this.ThemeModel=p,this.helpVariantOverride=null,this.predictInitialDefer=null,this.getHelpVariantDependencies=a.memoize((function(){return this.$q.all([this.EntitlementService.hasSystemEntitlement(r.s.ViewAdminTop),this.currentUser.getMemberships()])})),this.registerCourseContextDetection();this._course=new class{get model(){return s.course}get membership(){return o.courseMembership}},Object(h.f)(new y(this))}get course(){return{model:this.currentCourse.course,membership:this.currentCourseMembership.courseMembership}}get courseId(){return this.currentCourse.courseId}set courseId(e){this.currentCourse.load(e)}registerCourseContextDetection(){const e=this;this.$rootScope.$on(c.a,((t,n)=>{e.courseId=n.id}))}overrideHelpVariant(e){this.helpVariantOverride=e}guessHelpVariant(){const e=[];if(this.helpVariantOverride){const e=this.helpVariantOverride;return this.helpVariantOverride=null,this.$q.when([e])}return this.course&&this.course.membership&&!this.course.membership.isStudentOrGuestMembership()&&e.push(this.course.model.isClassic()?v.ClassicNonStudent:v.NonStudent),this.getHelpVariantDependencies().then((t=>{const n=t[0],i=t[1];if(n&&e.push(v.Administrator),this.course&&this.course.model)n&&e.push(this.course.model.isClassic()?v.ClassicNonStudent:v.NonStudent);else{let t=v.Student;i.some((e=>!e.isStudentOrGuestMembership()))&&(t=v.NonStudent),e.push(t)}return 0===e.length&&e.push(this.course&&this.course.model&&this.course.model.isClassic()?v.ClassicStudent:v.Student),a.uniq(e)}))}getSystemInfo(){return this.systemInfo||(this.systemInfo=window.__initialContext&&window.__initialContext.systemInfo?this.SystemInfoModel.$buildRaw(window.__initialContext.systemInfo):this.SystemInfoModel.$new().$fetch().$suppressErrorDialog()),this.systemInfo}getTheme(){return this.theme||(this.theme=this.ThemeModel.$new({themeId:this.getBrand().themeId}).$fetch()),this.theme}getServerTime(){return p.a.getServerTime()}getServerTimeAsEpochTime(){return p.a.getServerTimeAsEpochTime()}getPrivacyPolicyUrls(){return this.privacyPolicy||(this.privacyPolicy=this.PrivacyPolicyModel.$new().$fetch().$suppressErrorDialog()),this.privacyPolicy}getCourseId(){return this.currentCourse.courseId}getCurrentUserId(){return this.currentUser.userId}userHasGradebookModificationEntitlement(){const e=this.getCourseId();return e?this.EntitlementService.hasCourseEntitlement(s.q.ModifyGradebook,e).then((e=>e)):this.$q.when(!1)}getBrand(){return this.brand||(this.brand=window.__initialContext&&window.__initialContext.brand?this.BrandModel.$buildRaw(window.__initialContext.brand):this.BrandModel.getCurrent()),this.brand}getUiVersion(){return window.__initialContext&&window.__initialContext.uiVersion||""}getPreference(e,t){return this.preferenceService.getPreference(e,t)}getPredictPreference(e,t){const n=this.$q.defer(),a=!Object.keys(this.preferenceService.preferences).some((e=>e.indexOf(".predict.")>0));if(a){if(this.predictInitialDefer)return this.predictInitialDefer.promise.then((()=>{n.resolve(this.preferenceService.preferences[e])})),n.promise;this.predictInitialDefer=n,this.PredictFtueModel.getFtues().then((a=>{if(a){let i=null;a.forEach((t=>{this.preferenceService.preferences[t.key]=t,e===t.key&&(i=t)})),i?n.resolve(i):(this.preferenceService._addPreferenceToCache(e,t),n.resolve(this.preferenceService.preferences[e]))}else{if(void 0===t)return void n.reject(a);this.preferenceService._addPreferenceToCache(e,t),n.resolve(this.preferenceService.preferences[e])}}),(e=>{n.reject(e)}))}else Object.prototype.hasOwnProperty.call(this.preferenceService.preferences,e)||this.preferenceService._addPreferenceToCache(e,t),n.resolve(this.preferenceService.preferences[e]);return n.promise}getUltraConversionReportId(){return this.course.model.ultraConversionReportId}isTelemetryEnabled(){return this.getSystemInfo().$asPromise().then((e=>e.telemetryEnabled))}setPreference(e,t,n){return this.preferenceService.setPreference(e,t,n)}setPredictPreference(e,t,n){if(e.length>d.a)throw new Error("Preference key is too long!");return this.preferenceService._addPreferenceToCache(e,t,n),this.PredictFtueModel.setFtue(e)}}S.$inject=["$rootScope","$q",l.b,o.b,c.e,u.d,d.c,m.e.serviceName,m.pb.serviceName,m.jb.serviceName,m.bb.serviceName,m.Hb.serviceName];i.module(b,[m.N,l.a,o.a,c.b,u.a,d.b]).service(f,S)},GGEJ:function(e,t){e.exports='<div bb-load-bundle="components/directives/collab-session-icon" class="icon-shadow" ng-class="{\'is-running\': $ctrl.runningSessionFlag}">\n    <bb-svg-icon ng-if="$ctrl.runningSessionFlag" size="small" icon="collab" role="presentation" aria-hidden="true" status="active"></bb-svg-icon>\n    <bb-svg-icon ng-if="!$ctrl.runningSessionFlag" size="medium" icon="collab-session" role="presentation" aria-hidden="true"></bb-svg-icon>\n</div>'},GNXM:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n("Llzl"),i=n("0JpG"),r=n("TnpK"),s=n("nmzr");const o="ultra.course.announcement.router";a.module(o,[i.moduleName,r.b]).config([r.c,e=>{e.peekState(s.a.ANNOUNCEMENTS_LIST,{url:"/announcement-list",require:()=>Promise.all([n.e(40),n.e(743)]).then(n.bind(null,"pp2P")),pageTitle:"course.outline.announcements.title",peekStates:[s.a.ANNOUNCEMENT_DETAIL],panelClass:"full"}).peekState(s.a.ANNOUNCEMENT_DETAIL,{url:"/announcement-detail?courseId&announcementId&mode",require:()=>Promise.all([n.e(40),n.e(675)]).then(n.bind(null,"Zozd")),pageTitle:"course.outline.announcements.title",panelClass:"full"})}])},GbAM:function(e,t,n){"use strict";(function(e){n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return d}));var a=n("Llzl"),i=n("yC9S"),r=n("hlUp"),s=n("RPob"),o=n("ZzR9");const l="ultra.components.directives.accessibility.liveRegion",c="aria_live_polite",d="aria_live_assertive",u="#aria-live-polite-region-1",m="#aria-live-polite-region-2",p="#aria-live-assertive-region-1",h="#aria-live-assertive-region-2";class g{constructor(e,t,n){this.scope=e,this.element=t,this.attrs=n,s.b.readAssertive=e=>this.readAssertiveMessage(e),s.b.readPolite=e=>this.readPoliteMessage(e),i.b.OnRootScope(e,c,((e,t)=>{this.readPoliteMessage(t),this.isEnabled=!0})),i.b.OnRootScope(e,d,((e,t)=>{this.readAssertiveMessage(t),this.isEnabled=!0})),e.$on(o.a.$locationChangeSuccess,(()=>{this.isEnabled&&(this.cleanLiveRegion(),this.isEnabled=!1)}))}cleanLiveRegion(){const t=e(u),n=e(m),a=e(p),i=e(h);void 0!==t&&(t.empty(),n.empty(),a.empty(),i.empty())}readPoliteMessage(t){const n=e(u),a=e(m);this.readMessage(n,a,t)}readAssertiveMessage(t){const n=e(p),a=e(h);this.readMessage(n,a,t)}readMessage(e,t,n){""===e.text()?this.switchRegion(t,e,n):this.switchRegion(e,t,n)}switchRegion(e,t,n){e.empty(),e.attr("aria-hidden","true"),t.text(n),t.attr("aria-hidden","false")}}g.$inject=["scope","element","attrs"];class b{constructor(e,t){this.$injector=e,this.$compile=t,this.restrict="A",this.link=(e,t,n)=>{t.append(this.$compile(r)(e)),e.liveRegion=this.$injector.instantiate(g,{scope:e,element:t,attrs:n})}}}b.$inject=["$injector","$compile"],a.module(l,[]).directive("bbLiveRegion",["$injector",e=>e.instantiate(b)])}).call(this,n("71td"))},"H+SH":function(e,t){e.exports='<bb-modal class="notification js-dismiss-modal" role="alertdialog" bb-translate-attrs="{\'aria-label\': \'course.outline.previewCourse.alert.modalTitle\'}"\n          modal-title-key="course.outline.previewCourse.alert.modalTitle"\n          analytics-id-tag-prefix="course.outline.previewCourse.alert">\n  <div name="modal-contents">\n    <bb-translate>course.conversion.statusBar.page-out-of-date</bb-translate>\n  </div>\n  <button name="modal-footer-button-primary" ng-click="$parent.$close(\'refresh\')" class="button js-primary-button" analytics-id="course.outline.previewCourse.alert.ok.button">\n    <span bb-translate="global.ok"></span>\n  </button>\n</bb-modal>'},H8CZ:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));function a(e,t){r(e,t,"webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend")}function i(e,t){r(e,t,"webkitAnimationEnd oanimationend oAnimationEnd msAnimationEnd animationend")}function r(e,t,n){if(!window.Modernizr.csstransitions)return t({data:{noTransitions:!0}});const a=function(i){let r;i.data||(i.data={});try{r=t(i)}finally{void 0===r&&e.off(n,a)}};e.on(n,a)}},HAJP:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));const a="external.script.loader",i="externalScriptLoader";class r{constructor(e){this.$q=e,this.scripts={}}_createScriptElement(){return document.createElement("script")}_appendScriptElement(e){document.head.appendChild(e)}_getWindowProperty(e){return window[e]}getScript(e,t={}){if(this.scripts[e])return this.scripts[e];const n=this.$q.defer();try{this.scripts[e]=n.promise;const a=(e.indexOf("?")>=0?"&":"?")+"_"+Date.now(),i=this._createScriptElement();if(i.type="text/javascript",i.src=e+a,t.attributes)for(const e of Object.keys(t.attributes))i.setAttribute(e,t.attributes[e]);const r=this;i.onload=function(){t.exports?n.resolve(r._getWindowProperty(t.exports)):n.resolve()},i.onerror=function(){n.reject(new Error(`error loading script: ${e}`))},this._appendScriptElement(i)}catch(e){n.reject(e)}return n.promise}}r.$inject=["$q"];angular.module(a,[]).service(i,r)},HDxW:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return c}));var a=n("Llzl"),i=n("5MwF"),r=n("k9iv"),s=n("Q/M7"),o=n("IbyE");const l="ultra.service.errorHandler",c="errorHandler",d=e=>()=>{let t,n;const a=e.connect((e=>({})),o.V.app)(((e,a)=>{n=e,t=a}));try{t&&t.clearError&&t.clearError()}finally{a()}},u=(e,t,n,a,r)=>o=>{if(o&&o.$response)if(401===o.$response.status){const n=e.get("$location").url(),a=n?"/?new_loc="+encodeURIComponent(i.a.basePath+n):"/";t.location.href=s.c(a)}else 403===o.$response.status?r.handleApiError(o.$response,(()=>{n.$broadcast("no-permission-course"),d(a)()})):-2===o.$response.status?"undefined"!=typeof NREUM&&NREUM.noticeError(o.$response.data):r.handleApiError(o.$response,d(a))};a.module(l,[]).factory(c,["$injector",e=>{const t=t=>e.invoke(["$injector","$window","$rootScope","$ngRedux",r.c,u])(t);return{handle:t,subscribe:()=>e.invoke(["$ngRedux",e=>(e=>t=>{let n;return e.subscribe((()=>{const a=o.Yb.app.getAppError(e.getState());if(a&&n!==a){const e={status:"api"===a.type?a.status:-2,data:a.originalException};t({$response:e})}n=a}))})(e)(t)])}}])},Hbkz:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));n("JzsJ");var a=n("Llzl"),i=n("0JpG"),r=n("bF8R"),s=n("g7Mf"),o=n("pjml"),l=n("TnpK"),c=n("Qbdf"),d=n("nmzr");const u="ultra.course.content.conversations.routes";a.module(u,[i.moduleName,l.b,c.b]).config([l.c,c.c,(e,t)=>{e.peekState("conversations",{url:"/conversations/:contentId/:courseId?groupId",resolve:{[c.d]:t.resolve,content:[c.d,r.b,l.d,o.m.serviceName,(e,t,n,a)=>a.$new(e.id).contents.$find(n.nextParams.contentId,{expand:"assignedGroups"}).$asPromise()],translations:["$q",i.serviceName,(e,t)=>e.all([t.loadBundle("features/course/content/course-content"),t.loadBundle("common/user-common")])],currentCourseMemberships:"^courseMembershipsLoader",discussionInit:[s.c,"currentCourseMemberships",(e,t)=>e.init(t).then((()=>e.loadHardContent(!0)))]},onExit:[s.c,e=>{e.destroy()}],require:()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(20),n.e(52),n.e(65),n.e(75),n.e(91),n.e(676)]).then(n.bind(null,"FFqm")),pageTitle:"course.content.classConversations",peekViewName:"conversations-peek",panelClass:"full",allowChildPeekStates:!0,peekStates:[d.n.COURSE_MESSAGE,d.n.COURSE_DISCUSSION_PARTICIPANTS,d.n.COURSE_LTI,d.n.COURSE_CONTENT_MARKET]})}])},Hj9i:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n("uDfI"),i=n("ERkP"),r=n("IbyE");const s=e=>{const t=Object(a.d)();Object(i.useEffect)((()=>{t(r.V.userPreference.loadUserPreference({key:e}))}),[e,t]);const n=Object(a.e)((e=>r.Yb.userPreference.isUserPreferenceLoading(e))),s=Object(a.e)((t=>{const n=r.Yb.userPreference.getUserPreferenceByKey(t,e);return n?Number.parseInt(n.value,10):0})),o=Object(i.useCallback)((()=>{t(r.V.userPreference.persistUserPreference({key:e,value:(s+1).toString()}))}),[e,s,t]);return[!s&&!n,o]}},HtY7:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n("Llzl"),i=n("lEL+");const r="ultra.components.directives.click";class s{constructor(e){this.timeout=e,this.restrict="A",this.link=(e,t,n)=>{void 0===n.bbClickTimeout&&(n.bbClickTimeout=0);let a=0;const i=()=>{let t;"true"===n.bbClickOnceDisable?t=e.$eval(n.bbClick):(a+=1,a<=1&&(t=e.$eval(n.bbClick))),null!=t&&void 0!==t&&t.finally((()=>{this.timeout((function(){a=0}),e,n.bbClickTimeout)}))};e.$on("$destroy",(function(){t.off("click",i)})),t.on("click",i)}}}s.$inject=[i.b],a.module(r,[i.a]).directive("bbClick",["$injector",e=>e.instantiate(s)])},Htol:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));const a="update-state",i="course-outline.refresh-folder"},IMr6:function(e,t){e.exports='<svg id="icon-large-avatar-multiple" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 60"><g fill="none"  stroke-miterlimit="10"><path d="M37.685 17.545C37.976 12.214 41.593 8 46.012 8c4.609 0 8.345 4.583 8.345 10.237s-3.737 10.237-8.345 10.237c-1.683 0-3.25-.612-4.562-1.663"/><path d="M44.685 44.789h11.676C57.996 42.569 59 39.838 59 36.846c0-5.068-2.81-9.419-6.894-11.656M18.949 26.469c-1.387 1.26-3.103 2.005-4.962 2.005-4.609 0-8.345-4.583-8.345-10.237S9.379 8 13.987 8c4.39 0 7.988 4.158 8.32 9.438"/><path d="M7.894 25.191C3.81 27.428 1 31.779 1 36.847c0 2.992 1.004 5.722 2.639 7.943H15.27"/><g><ellipse cx="30" cy="27.514" rx="11.266" ry="13.223"/><path d="M19.619 32.661c-2.532 3.407-4.644 8.708-4.644 13.758 0 2.317.343 4.528.942 6.581h28.167c.599-2.054.942-4.264.942-6.581 0-5.09-2.075-10.343-4.644-13.758"/></g></g></svg>'},IVCC:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n("Llzl"),i=n("0JpG"),r=n("w9Zy"),s=n("pjml"),o=n("fYJU"),l=n("TnpK"),c=n("ZBYA"),d=n("aohr");const u="ultra.predict.routes";a.module(u,[i.moduleName,r.d,s.N,o.a,l.b,c.a]).config([l.c,e=>{var t;e.baseState("predictBase",{abstract:!0,require:()=>Promise.all([n.e(43),n.e(655)]).then(n.bind(null,"xID3")),resolve:(t=["components/directives/telemetry/telemetry","components/services/telemetry-chart","features/predict/predict","features/locations","features/course/course","global"],{user:[o.b,e=>e.userModel.$asPromise()],localize:["$q","$rootScope","user","$window",i.serviceName,c.b,(e,n,a,r,s,o)=>{o.getInstitutionPreference(d.a.OverrideLanguagePack).then((o=>{let l=o.value||a.locale||"en";const c=r.location.href.match(i.localeQuerystringRegex);c&&(l=c[1]),l=s.validateLocale(l)?l:"en",s.setUserLocale(l);const d=[s.setLocale(n,l),...t.map((e=>s.loadBundle(e)))];return e.all(d)}))}]})}).baseState("predictBase.predictAdvisorStudents",{url:"/predict/advisor/students?customFields&resetFTUE",require:()=>Promise.all([n.e(103),n.e(42),n.e(53),n.e(95),n.e(85),n.e(144),n.e(573)]).then(n.bind(null,"NKO4")),pageTitle:"predict.advisor.title",peekStates:["predictAdvisorStudentsFilter","predictMessagingPanel","predictAdvisorStudentProfilePanel","predictCourseStudentPanel"]}).baseState("predictBase.predictCourseBase",{url:"/predict/courses/:courseId",require:()=>Promise.all([n.e(38),n.e(42),n.e(53),n.e(145),n.e(681)]).then(n.bind(null,"j0gv")),pageTitle:"predict.course.title"}).baseState("predictBase.predictCourseStudentBase",{url:"/predict/instructor/students/:studentId/course/:courseId",require:()=>Promise.all([n.e(38),n.e(50),n.e(42),n.e(41),n.e(48),n.e(53),n.e(82),n.e(682)]).then(n.bind(null,"PPqB")),peekStates:["predictMessagingPanel"],pageTitle:"predict.instructor.title"}).peekState("predictAdvisorStudentProfilePanel",{url:"/profile/:studentId",require:()=>Promise.all([n.e(42),n.e(53),n.e(85),n.e(142),n.e(645)]).then(n.bind(null,"W7NY")),panelClass:"full",peekStates:["predictMessagingPanel","predictCourseStudentPanel","predictFavoritesPanel","predictAdvisorStudentProfilePanel.course-performance","predictAdvisorStudentProfilePanel.advisor-notes","predictAdvisorStudentProfilePanel.interests"],pageTitle:"predict.advisor.student-profile.title"}).peekState("predictAdvisorStudentProfilePanel.course-performance",{url:"/outline",views:{"student-details-tabs-content@":{require:()=>Promise.all([n.e(42),n.e(606)]).then(n.bind(null,"fQnU"))}},peekStates:["predictCourseStudentPanel","predictMessagingPanel"],panelClass:"full",pageTitle:"predict.advisor.student-profile.title"}).peekState("predictAdvisorStudentProfilePanel.advisor-notes",{url:"/notes-contributors",views:{"student-details-tabs-content@":{require:()=>Promise.all([n.e(42),n.e(53),n.e(85),n.e(142),n.e(739)]).then(n.bind(null,"kgDa"))}},peekStates:["predictMessagingPanel"],panelClass:"full",pageTitle:"predict.advisor.student-profile.title"}).peekState("predictAdvisorStudentProfilePanel.interests",{url:"/interests",views:{"student-details-tabs-content@":{require:()=>n.e(609).then(n.bind(null,"clqd"))}},peekStates:["predictFavoritesPanel","predictMessagingPanel"],panelClass:"full",pageTitle:"predict.advisor.student-profile.title"}).peekState("predictCourseStudentPanel",{url:"/courses/:courseId/students/:studentId",require:()=>Promise.all([n.e(38),n.e(50),n.e(42),n.e(41),n.e(48),n.e(53),n.e(82),n.e(698)]).then(n.bind(null,"Wwzz")),panelClass:"full",peekStates:["predictMessagingPanel"],pageTitle:"predict.instructor.title"}).peekState("predictAdvisorStudentsFilter",{url:"/filter",require:()=>Promise.all([n.e(42),n.e(144),n.e(696)]).then(n.bind(null,"TRcT")),panelClass:"peek",pageTitle:"predict.advisor.title"}).peekState("predictMessagingPanel",{url:"/messagingPanel?messageStudentId&messageCourseId&messageType&messageLaunchOrigin",require:()=>Promise.all([n.e(42),n.e(590)]).then(n.bind(null,"G6j8")),panelClass:"peek",pageTitle:"predict.messagingPanel.title"}).peekState("predictFavoritesPanel",{url:"/favorites/:favoriteId?favoriteCategory?city&state&region&country",require:()=>n.e(640).then(n.bind(null,"pI+d")),panelClass:"peek",pageTitle:"predict.favoritesPanel.title"})}])},IVtk:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n("Q/M7"),i=n("Y+9S");function r(e){const t=a.c(e);a.p(t)}function s(e){const{action:t,courseId:n,contentId:a,attemptId:s,columnId:o}=e.nextParams,l=o||"";switch(t){case i.d.OpenDocument:r(`ultra/courses/${n}/outline/edit/document/${a}?courseId=${n}`);break;case i.d.OpenAttempt:r(`ultra/courses/${n}/outline/assessment/${a}/overview/attempt/${s}?courseId=${n}`);break;case i.d.ReviewAttempt:r(`ultra/courses/${n}/outline/assessment/${a}/overview/attempt/${s}/review?courseId=${n}&columnId=${o}&contentId=${a}`);break;case i.d.ReviewFeedback:r(`ultra/courses/${n}/outline/assessment/${a}/overview/attempt/${s}/review/inline-feedback?attemptId=${s}&mode=inline&courseId=${n}&contentId=${a}`);break;case i.d.PreviewAssessment:r(`ultra/courses/${n}/outline/assessment/test/${a}?courseId=${n}&gradeitemView=details`);break;case i.d.CollabRecordingPreview:r(`ultra/courses/${n}/outline/collab/launchRecordings`);break;case i.d.CollabManageSession:r(`ultra/courses/${n}/outline/collab/launchSessions`);break;case i.d.OpenCourse:r(`ultra/courses/${n}/outline`);break;case i.d.OpenDiscussion:r(`ultra/courses/${n}/engagement/discussion/${a}?view=discussions&courseId=${n}`);break;case i.d.OpenGroupDiscussion:r(`ultra/courses/${n}/outline/discussion/${a}?view=discussions&disGroupId=${s}&courseId=${n}`);break;case i.d.OpenJournal:r(`ultra/courses/${n}/outline/journal/${a}?view=journal&courseId=${n}`);break;case i.d.OpenAssessment:r(`ultra/courses/${n}/outline/assessment/${a}/overview?courseId=${n}`);break;case i.d.OpenAssessmentInstView:r(`ultra/courses/${n}/outline/assessment/test/${a}?courseId=${n}&gradeitemView=details`);break;case i.d.OpenAdminAnnouncement:r(`ultra/stream/announcement/${a}`);break;case i.d.OpenCourseAnnouncement:r(`ultra/courses/${n}/outline/announcement-list/announcement-detail?courseId=${n}&announcementId=${a}`);break;case i.d.OpenCourseMessage:r(`ultra/courses/${n}/messages/edit/${a}?courseId=${n}&offset=0&count=1`);break;case i.d.OpenGradeBook:r(`ultra/courses/${n}/grades`);break;case i.d.OpenCalendar:r(`ultra/courses/${n}/calendar`);break;case i.d.OpenGradedSCORM:r(`ultra/courses/${n}/outline/scorm/overview/${a}?courseId=${n}`);break;case i.d.OpenInstViewGradedSCORM:r(`ultra/courses/${n}/outline/scorm/${a}/columns/${l}/submissions?courseId=${n}&gradeitemView=students`);break;case i.d.OpenTimeline:r("ultra/course");break;case i.d.OpenPersonalEvent:r(`ultra/stream/event/edit/PERSONAL/blackboard.data.calendar.CalendarEntry/${a}`);break;case i.d.OpenCalendarEvent:r(`ultra/stream/event/edit/${n}/blackboard.data.calendar.CalendarEntry/${a}`);break;case i.d.OpenTools:r("ultra/tools");break;case i.d.OpenCreateMessages:r(`ultra/messages/create?courseId=${n}`);break;case i.d.OpenCourseMessagesList:r(`ultra/courses/${n}/messages`);break;case i.d.OpenInstitutionPage:r("ultra/institution-page");break;case i.d.OpenAdminInstitutionPage:r("ultra/institution-page/admin/default");break;case i.d.OpenJournalParticipantsGrades:r(`ultra/grades/journal/${a}?view=participants&limit=25&page=1&submissionStatus=all&courseId=${n}`);break;case i.d.OpenViewGradesOfflinePage:r(`ultra/grades/offline-grades/${a}?courseId=${n}&gradeitemView=students`);break;case i.d.OpenViewGradesAssessmentsPage:r(`ultra/grades/assessment/test/${a}?courseId=${n}&gradeitemView=students`);break;case i.d.OpenScormGradesPage:r(`ultra/grades/scorm/${a}/columns/${o}/submissions?courseId=${n}&gradeitemView=students`);break;case i.d.OpenDiscussionGradePage:r(`ultra/grades/discussion/${a}?view=participants&courseId=${n}`);break;case i.d.OpenAttendancePage:r(`ultra/grades/attendance?courseId=${n}`);break;case i.d.OpenCalendarAssessmentPage:r(`ultra/calendar/assessment/test/${a}?courseId=${n}&gradeitemView=details`);break;case i.d.OpenCalendarDiscussionPage:r(`ultra/calendar/discussion/${a}?view=discussions&courseId=${n}`);break;case i.d.OpenCalendarJournalPage:r(`ultra/calendar/journal/${a}?view=journal&courseId=${n}`);break;case i.d.OpenCalendarScormPage:r(`ultra/calendar/scorm/${a}/columns/${o}/submissions?courseId=${n}&gradeitemView=students`);break;case i.d.OpenStudentCalendarAssessmentPage:r(`ultra/calendar/assessment/${a}/overview?courseId=${n}`);break;case i.d.OpenStudentCalendarScormPage:r(`ultra/calendar/scorm/overview/${a}?courseId=${n}`);break;case i.d.OpenStudentDiscusssionPage:r(`ultra/courses/${n}}/outline/discussion/${a}?view=discussions&courseId=${n}`);break;default:e.go("base.not-found")}}},"In+A":function(e,t,n){"use strict";const a=50,i={};function r(e){let t=e.priority||a;t<0&&(t=a),i[e.name]=t}function s(e,t){let n=e.priority||i[e.componentType]||a;n<0&&(n=a);let r=t.priority||i[t.componentType]||a;return r<0&&(r=a),n-r}class o{constructor(e,t,n,a,i,r,s,o){this.element=e,this.componentType=t,this.componentKey=n,this.manager=a,this.helper=i,this.connector=r,this.priority=s,this.isInitialHide=o,this.display=window.getComputedStyle(e,null).display,e.style.display="none",this.isShown=!1}get shown(){return this.isShown}set shown(e){this.isShown=e,this.shownChangedCallback&&this.shownChangedCallback(e)}onShownChanged(e){this.shownChangedCallback=e}registerToManager(){this.shown=!1,this.manager.registerComponent(this)}deregisterFromManager(){this.manager.deregisterComponent(this)}hide(){this.hideImpl(),this.manager.hideComponent(this.componentKey)}onShown(){this.element.style.display=this.display,this.shown=!0}onHidden(e){this.hideImpl(e)}hideImpl(e){this.shown=!1,e||this.helper.hide(this.componentKey)}showComponent(){this.connector.sendStart()}setShouldShow(e){this.shouldShowGuidance=e}shouldShow(){return this.shouldShowGuidance?this.shouldShowGuidance():Promise.resolve(!0)}}n.d(t,"f",(function(){return l})),n.d(t,"e",(function(){return c})),n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return u})),n.d(t,"d",(function(){return o})),n.d(t,"g",(function(){return r})),n.d(t,"c",(function(){return a}));const l=new class{constructor(){this.components=[],this.guidanceTargets={},this.hasStartedShowing=!1,this.currentShownComponent=null,this.getFirstComponentToShowPromise=null}isComponentRegistered(e){return this.components.indexOf(e)>=0}registerComponent(e){if(this.components.length){if(this.isComponentRegistered(e))return;let t=this.components.length-1;for(;s(e,this.components[t])<0&&(t-=1,!(t<0)););this.components.splice(t+1,0,e)}else this.components.push(e);const t=this.hasStartedShowing&&!e.isInitialHide,n=this.currentShownComponent||this.getFirstComponentToShowPromise;t&&!n&&this.showGuidanceComponentAsync()}deregisterComponent(e){if(this.getFirstComponentToShowPromise)return void this.getFirstComponentToShowPromise.then((()=>this.deregisterComponent(e)));if(!this.isComponentRegistered(e))return;const t=this.components.indexOf(e);this.components.splice(t,1),this.currentShownComponent&&this.currentShownComponent.componentKey===e.componentKey&&(this.currentShownComponent.onHidden(!0),this.onComponentHidden(this.currentShownComponent))}registerTarget(e){const t=this.guidanceTargets[e.componentKey]||[];if(this.guidanceTargets[e.componentKey]=t,(0===t.length||e.multiTargetSupport)&&t.push(e),this.hasStartedShowing&&this.currentShownComponent){const t=this.currentShownComponent.componentKey;e.componentKey===t&&e.onShown()}}deregisterTarget(e){this.guidanceTargets[e.componentKey]=null}startQueue(){this.hasStartedShowing||(this.hasStartedShowing=!0,this.showGuidanceComponentAsync())}stopQueue(){this.hasStartedShowing&&(this.hasStartedShowing=!1,this.currentShownComponent&&(this.currentShownComponent.onHidden(!0),this.hideTargetsForComponent(this.currentShownComponent),this.currentShownComponent=null))}hideComponent(e){this.getFirstComponentToShowPromise?this.getFirstComponentToShowPromise.then((()=>{this.hideComponent(e)})):this.currentShownComponent&&this.currentShownComponent.componentKey===e&&(this.currentShownComponent.onHidden(!1),this.onComponentHidden(this.currentShownComponent))}hideTargetsForComponent(e){const t=this.guidanceTargets[e.componentKey];t&&t.forEach((e=>{e.onHidden()}))}showTargetsForComponent(e){const t=this.guidanceTargets[e.componentKey];t&&t.forEach((e=>{e.onShown()}))}onComponentHidden(e){this.currentShownComponent===e&&(this.currentShownComponent=null,this.hideTargetsForComponent(e),this.showGuidanceComponentAsync())}showGuidanceComponentAsync(){0!==this.components.length&&(this.getFirstComponentToShowPromise=this.getFirstComponentToShowAsync(0).then((e=>(e&&this.hasStartedShowing&&(this.currentShownComponent=e,e.onShown(),this.showTargetsForComponent(e)),this.getFirstComponentToShowPromise=null,e))))}getFirstComponentToShowAsync(e){return this.components[e].shouldShow().then((t=>t?this.components[e]:e<this.components.length-1?this.getFirstComponentToShowAsync(e+1):null))}},c=new class{constructor(e){this.guidanceManager=e,this.watchers=[],this.addWatcher=e=>{this.watchers.push(e),this.handleStateChange(e.started),e.onStateChanged(this.handleStateChange)},this.removeWatcher=e=>{const t=this.watchers.indexOf(e);-1!==t&&(e.onStateChanged(void 0),this.watchers.splice(t,1))},this.sendStart=()=>{this.handleStateChange(!0)},this.handleStateChange=e=>{e?this.updateGuidanceState(!this.watchers.some((e=>!e.started))):this.updateGuidanceState(e)},this.updateGuidanceState=e=>{e!==this.startState&&(this.startState=e,e?this.guidanceManager.startQueue():this.guidanceManager.stopQueue())}}}(l),d=35,u="guidance"},"Is+C":function(e,t,n){"use strict";n.d(t,"b",(function(){return E})),n.d(t,"c",(function(){return I})),n.d(t,"a",(function(){return k}));var a=n("D57K"),i=n("nsO7"),r=n("Llzl"),s=n("pjml"),o=n("VAMW"),l=n("4nF1"),c=n("X455"),d=n("12mu"),u=n("TnpK"),m=n("o5Lu"),p=n("8jzW"),h=n("Sa5G"),g=n("Q/M7"),b=n("fYJU"),f=n("IbyE"),v=n("aHpC"),y=n("kcGO"),S=n("Htol"),C=n("9OUN");const E="ultra.components.services.scorm",I="scorm",k="geolocation *; microphone *; camera *; midi *; encrypted-media *";class w{constructor(e){this.service=e,this.key=o.d.Scorm}scormLaunch({contentId:e,courseId:t,content:n,showPreLaunchPanel:a}){return this.service.scormLaunch({contentId:e,courseId:t,content:n,showPreLaunchPanel:a})}}let T=class{constructor(e,t,n,a,i,r,s,l,c,d,u,m){this.$q=e,this.$rootScope=t,this.$window=n,this.$ngRedux=a,this.cacheFactory=i,this.contextCourseMembership=r,this.modalService=s,this.ultraState=l,this.gradeService=c,this.scoreProviderHelper=d,this.CourseModel=u,this.contextUser=m,this.scormAvailabilityCache={},this.subscribeToReduxChanges(),Object(o.f)(new w(this))}subscribeToReduxChanges(){this.$ngRedux.connect(null,(e=>Object(C.b)({updateContentReviewState:f.V.contentReviewState.persistContentReviewState},e)))(this)}isScormAvailable(e){var t;const n=this.scormAvailabilityCache[e];return n?this.$q.when(null===(t=n.toolEnabledSetting)||void 0===t?void 0:t.isAvailable):this.CourseModel.$new(e).contentHandlers.$find(h.g.RusticiScorm.toString()).$allow([403]).$asPromise().then((t=>{var n;return null===(n=(this.scormAvailabilityCache[e]=t).toolEnabledSetting)||void 0===n?void 0:n.isAvailable}))}async scormLaunch(e){const t=this.$q.defer(),[n,a]=await this.$q.all([this.getContent(e.courseId,e.content,e.contentId),e.showPreLaunchPanel?this.getMembership(e.courseId):null]);if(e.showPreLaunchPanel&&this.isGradable(n))if(n.canEdit()){const n=r.fromJson(this.scoreProviderHelper.getSubmissionListStateRef(f.O.Scorm,{courseId:e.courseId,contentId:e.contentId},p.a.GenerateStateParams));this.ultraState.goPeekState(n.state,n.args).then((()=>{t.resolve()})).catch((e=>{t.reject({errorMessage:"Failed to open the SCORM submission list.",errorResponse:e})}))}else this.isStudentInCourse(a)&&this.ultraState.goPeekState("scorm-overview.student",{courseId:n.courseId,contentId:n.id}).then((()=>{t.resolve()})).catch((e=>{t.reject({errorMessage:"Failed to open the SCORM submission list.",errorResponse:e})}));else this.launchScormLink(i.merge(e,{content:n}),t);return t.promise}refreshContents(e,t){this.getContent(e,null,t).then((e=>{this.gradeService.refreshCourseContents(e)}))}markContentAsViewed(e,t){return t?this.getContent(e,null,t).then((e=>{var t;if(!(null===(t=e.permissions)||void 0===t?void 0:t.canHaveReviewState))return;const n=Object(y.f)(e);n&&(this.updateContentReviewState(e.courseId,e.id,n),e.inSequence&&this.$rootScope.$broadcast(S.b,e,n))})):this.$q.when()}launch(e,t,n,a=!1){e=g.c(e),e=g.a(e,"from_ultra","true"),a?(this.$window.open(e),this.markContentAsViewed(t,n)):this.ultraState.goPeekState("scorm-launch-frame",{toolHref:e,courseId:t,contentId:n}).then((()=>{this.markContentAsViewed(t,n)}))}launchScormLink(e,t){let n;e.content&&(n=this.getLaunchLinkFromContent(e.content)),n&&(this.determineLaunchTarget(i.merge(e,{launchLink:n})),t.resolve())}determineLaunchTarget(e){e.content&&e.content.isScorm()&&this.launch(e.launchLink,e.content.courseId,e.content.id,e.content.launchInNewWindow)}getLaunchLinkFromContent(e){const t=e.contentDetail&&e.contentDetail[e.contentHandler.toString()];return t&&t.launchUrl||null}scormEditColumn(e){this.getContent(e.courseId,e.ui.content,e.contentId).then((t=>{e.ui.content=t;const n=l.a.create(t).getEditState();this.ultraState.goPeekState(n,{contentId:t.id})}))}isStudentInCourse(e){return e.isStudentMembership()}isGradable(e){return!!e.getScormGradebookItems().length}getContent(e,t,n){return t?this.$q.when(t):n?this.CourseModel.$new(e).contents.$find(n).$asPromise():this.$q.when(null)}getMembership(e){return this.contextCourseMembership.courseMembership?this.$q.when(this.contextCourseMembership.courseMembership):this.CourseModel.$new(e).users.$find(this.contextUser.userId).$asPromise()}loadScormGrade({courseId:e,column:t,grade:n}){let a=null;return a=n?n.$asPromise&&n.$asPromise()||this.$q.when(n):this.gradeService.loadGrade({gradeQueryParams:{},courseId:e,column:t,userId:this.contextUser.userId},!1),a.then((t=>t&&t.attempts.$fetch({fields:"id,status,attemptDate"}).$asPromise().then((e=>e.length&&e.reduce(((e,t)=>e.attemptDate>t.attemptDate?e:t)))).then((e=>e&&e.id)).then((n=>{if(!n)return t;const a=this.CourseModel.$new(e),i={expand:"toolAttemptDetail,alignedGoals,members,attempts,attempts.toolAttemptDetail,lastFeedbackAuthor,attempts.lastFeedbackAuthor",attemptId:n};return this.gradeService.loadAttempt(t,a,i)}))))}};T=Object(a.a)([Object(a.c)(0,Object(v.b)("$q")),Object(a.c)(1,Object(v.b)("$rootScope")),Object(a.c)(2,Object(v.b)("$window")),Object(a.c)(3,Object(v.b)("$ngRedux")),Object(a.c)(4,Object(v.b)("DSCacheFactory")),Object(a.c)(5,Object(v.b)(c.d)),Object(a.c)(6,Object(v.b)(d.b)),Object(a.c)(7,Object(v.b)(u.d)),Object(a.c)(8,Object(v.b)(m.n)),Object(a.c)(9,Object(v.b)(p.c)),Object(a.c)(10,Object(v.b)(s.m.serviceName)),Object(a.c)(11,Object(v.b)(b.b))],T);r.module(E,[c.a,u.b,p.b,m.m,s.N]).service(I,T).config(["$compileProvider",e=>{e.aHrefSanitizationWhitelist(/^\s*(https?|mailto):/)}])},J0Qq:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n("Llzl"),i=n("0JpG");const r="ultra.directives.bbDate";class s{constructor(e,t){this.$parse=e,this.bbLocalize=t,this.restrict="AE"}compile(e){const t=e.html();return(e,n,a)=>{const r=t=>{const r=this.bbLocalize.getFormatEnum(i.ILocaleDateFormat,a.format)||i.ILocaleDateFormat.Full,s=e=>{"bb-date"===n.prop("tagName").toLowerCase()?n.replaceWith(e):n.html(e)};null==t?s(""):this.bbLocalize.formatDate(t,r,e).then(s)},s=t=>t?new Date(this.$parse(t)(e)):null;let o;"true"===a.autoUpdate?a.$observe("bbDate",(()=>{o=s(a.bbDate),r(o)})):(o=this.$parse(t)(e)||s(a.bbDate),r(o))}}}s.$inject=["$parse",i.serviceName];a.module(r,[i.moduleName]).directive("bbDate",["$injector",e=>e.instantiate(s)])},"JRp+":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n("Llzl"),i=n("0JpG"),r=n("TnpK");const s="ultra.course.conversion.router";a.module(s,[r.b,i.moduleName]).config([r.c,e=>{e.peekState("conversion-analysis",{url:"/conversionAnalysis",resolve:{translations:[i.serviceName,e=>e.loadBundle("components/directives/convert-and-import")]},require:()=>Promise.all([n.e(71),n.e(724)]).then(n.bind(null,"0y0M")),pageTitle:"ultra.convert.analysis.pageTitle"}).peekState("conversion-risk-analysis",{url:"/conversionRiskAnalysis",resolve:{translations:[i.serviceName,e=>e.loadBundle("components/directives/convert-and-import")]},require:[()=>Promise.all([n.e(155),n.e(158)]).then(n.bind(null,"VtI1")),()=>Promise.all([n.e(155),n.e(158),n.e(764)]).then(n.bind(null,"ubcj"))],pageTitle:"ultra.convert.analysis.pageTitle"})}])},JXhc:function(e,t,n){"use strict";n.d(t,"c",(function(){return l})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d}));var a=n("Llzl"),i=n("0JpG"),r=n("hlSw"),s=n("TnpK"),o=n("3bn4");const l="ultra.course.content.assessment.question-goal-alignment",c="question-goal-alignment",d="question-goal-alignment-for-student",u=["course","goal-alignment","goal"];class m extends o.a{constructor(){super(...arguments),this.url="/goalAlignment/:questionId/:questionIndex",this.panelClass="peek assessment-question-goal-peek"}resolveGoalAlignableContent(){return["$q","currentContent","currentCourse",i.serviceName,s.d,"$injector",(e,t,n,a,i,s)=>void 0!==t&&void 0===t.id?e.when([]):e.when(null).then((()=>{if(void 0===t)return s.invoke(r.a.currentContent,null,{currentCourse:n,translations:{}}).then((e=>{t=e}))})).then((()=>e.all([n.assessments.$buildRaw({id:t.getDeployedAssessment().assessment.id}).questions.$find(i.nextParams.questionId,{expand:"alignedGoals"}).$asPromise(),a.loadBundle(`features/${u.join("/")}`)]).then((([e])=>this.setupGoalAlignableContent(e,a,i)))))]}getPeekStateName(){return c}getOverrideSubTitle(){return[i.serviceName,s.d,(e,t)=>e.translateSync({locale:null,key:"components.directives.assessment-question.question-title",params:{index:t.nextParams.questionIndex},noWrap:!0})]}setupGoalAlignableContent(e,t,n){return[{getContentTitleForGoalAlignment:()=>t.translateSync({locale:null,key:`${u.join(".")}.goalsAlignedWithThisQuestion`}),getContentIdForGoalAlignment:()=>e.getContentIdForGoalAlignment(),isCurrentUserEligibleToAlignGoals:()=>e.isCurrentUserEligibleToAlignGoals(),alignedGoals:e.alignedGoals.map((t=>(t.content=e,t)))}]}}m.$inject=["$injector","$q"];class p extends m{resolveGoalAlignableContent(){return["$q","currentCourse","contentData",i.serviceName,s.d,(e,t,n,i,r)=>{let s=e.when(null);return n.courseContent.isGroupContent&&n.groupAttempt?s=t.gradebook.groupAttempts.$find(n.groupAttempt.id,{expand:"toolAttemptDetail,alignedGoals"}).$asPromise():!n.courseContent.isGroupContent&&n.attempt&&(s=t.gradebook.attempts.$find(n.attempt.id,{expand:"toolAttemptDetail,alignedGoals"}).$asPromise()),e.all([s,i.loadBundle(`features/${u.join("/")}`),i.loadBundle("components/directives/assessment/assessment-question")]).then((([e])=>{let t={};if(e){const i=e.getToolAttemptDetailItem(n.gradingColumn.scoreProviderHandle);(i&&i.questionAttempts||[]).forEach((e=>{e.question&&e.question.id===r.nextParams.questionId&&(t=a.extend(e.question,{getContentIdForGoalAlignment:()=>`blackboard.data.qti.asi.AsiObject;${e.question.id}`,isCurrentUserEligibleToAlignGoals:()=>!1}))}))}return this.setupGoalAlignableContent(t,i,r)}))}]}getPeekStateName(){return d}}a.module(l,[s.b,i.moduleName]).config([s.c,e=>{[new m,new p].forEach((t=>{e.peekState(t.getPeekStateName(),t)}))}])},JbSi:function(e,t,n){var a=n("ziER"),i=n("5JeM"),r=new a({id:"icon-medium-collab-session",use:"icon-medium-collab-session-usage",viewBox:"0 0 24 24",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-medium-collab-session"><path fill-rule="evenodd" clip-rule="evenodd" d="M1 5h17v4l5-3.9583V19l-5-4v4H1V5z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><path d="M18 8v8M6 8l2 4-2 4M11 8l2 4-2 4" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(r);e.exports=r},JrDC:function(e,t,n){"use strict";function a(e,t){if(t instanceof e)return t.$pk;if(!t.$scope||"object"!=typeof t.$scope)throw new Error("model_utility.findModelPkInScope could not find $scope object on "+t);return a(e,t.$scope)}n.d(t,"a",(function(){return a}))},"K/D1":function(e,t,n){"use strict";var a=n("nsO7"),i=n("uC9d");const r="learnApiCacheService",s="learnApiCache.CacheRules",o=["DELETE","PUT","POST","PATCH","JSONP"],l="/learn/api/v1";function c(e=""){return Array.isArray(e)?e.sort().join(","):e.split(",").sort().join(",")}class d{constructor(){this.$get=[function(){return{}}]}}class u{constructor(e){this.cacheRules=e,this.cachingEnabled=!0,this.cachedExpandedRequests=new Map,this.queuedRequests=new Map,this.requestCache=new Map,this.disableCaching=()=>{this.cachingEnabled=!1},this.$get=["$q","$log",i.c,function(e,t,n){n.listen((e=>{if("clear"===e.type)this.removeCacheEntries(e.pattern||".*")}));const a=n=>{const a=this.makeKeyFromRequest(n);if(!this.queuedRequests.has(a)){const t=e.defer();return t.promise.finally((()=>{this.queuedRequests.delete(a)})),this.queuedRequests.set(a,{pendingRequestConfig:t}),e.resolve(n)}return t.info(`Easing ${a}`),this.queuedRequests.get(a).pendingRequestConfig.promise};return{request:e=>{if(!this.cachingEnabled||"GET"!==e.method||!this.isApiUrl(e.url)||e.cache)return e;const t=this.handleRequest(e);return t.url.match(/^blob/)?t:a(t).then((e=>e))},requestError:n=>(t.error("requestError: ",n),e.reject(n)),response:e=>{if(e.config.url.match(/^blob/)){const t=e.config.headers;return e.config.url=t.originalUrl,e.config.params=JSON.parse(t.originalParams),e}return this.cachingEnabled&&"GET"===e.config.method&&this.isApiUrl(e.config.url)&&!e.config.cache?this.handleResponse(e):e},responseError:t=>{if(!t||!t.config)return e.reject(t);const n=this.makeKeyFromResponse(t);return this.queuedRequests.has(n)&&this.queuedRequests.get(n).pendingRequestConfig.reject(t.data),e.reject(t)}}}],this.removeCacheEntries=e=>{this.requestCache.forEach(((t,n)=>{(e instanceof RegExp?e:new RegExp(`${e}$`)).test(t.baseUrl)&&(this.requestCache.delete(n),this.cachedExpandedRequests.delete(t.baseUrl),this.queuedRequests.has(n)&&(this.queuedRequests.get(n).pendingRequestConfig.reject(`Canceled Easing: ${n}`),this.queuedRequests.delete(n)),URL.revokeObjectURL(t.documentUrl))}))},this.requestCachingRules=e.rules,setInterval((()=>{const e=(new Date).getTime();this.requestCache.forEach((t=>{e>t.expires&&this.removeCacheEntries(t.baseUrl)}))}),this.cacheRules.cacheTimes.MEDIUM)}getRule(e,t){return this.requestCachingRules.find((n=>{const a=n.urlRegex?n.urlRegex:new RegExp(n.url+"$","i");return n.methods.indexOf(t.toUpperCase())>-1&&a.test(e)}))}handleRequest(e){return this.resolveCachedEntry(e)||e}handleResponse(e){if(!this.isApiUrl(e.config.url)||e.config.url.match(/^blob/))return e;const t=e.config.method.toUpperCase(),n=e.config.url,a=this.getRule(n,t),i=this.makeKeyFromResponse(e);return a&&!this.requestCache.has(i)&&this.insertCacheEntry({...e},a.duration),this.resolveEasing(e),e}getCacheEntry(e){let t;const n=this.makeKeyFromRequest(e),a=this.lookupExpandedCacheEntry(e);if(a?t=a:this.requestCache.has(n)&&(t=this.requestCache.get(n)),t){if((new Date).getTime()<t.expires)return t;this.removeCacheEntries(t.baseUrl)}return{}}getCleanUrl(e){return e.slice(e.indexOf(l)+l.length+1)}insertCacheEntry(e,t){const n=this.makeKeyFromResponse(e),a=e.config.url,i={documentUrl:URL.createObjectURL(new Blob([JSON.stringify(e.data)],{type:"application/json"})),baseUrl:a,expires:t+(new Date).getTime()};if(this.requestCache.set(n,i),e.config.params&&e.config.params.expand){const t=e.config.params.expand;if(this.cachedExpandedRequests.has(a)){const e=this.cachedExpandedRequests.get(a);this.cachedExpandedRequests.set(a,[...e,{cacheKey:n,expand:t}])}else this.cachedExpandedRequests.set(a,[{cacheKey:n,expand:t}])}}isApiUrl(e){return e.indexOf(l)>-1}lookupExpandedCacheEntry(e){const t=e.url,n=e.params;if(n&&n.expand&&this.cachedExpandedRequests.has(t)){const e=this.cachedExpandedRequests.get(t).find((e=>{const t=n.expand.split(","),i=e.expand.split(",");return!a.difference(t,i).length}));if(e)return this.requestCache.get(e.cacheKey)}}makeKeyFromRequest(e){const t=this.getCleanUrl(e.url);e.params=e.params||{};const{fields:n,expand:a,...i}=e.params,r=c(n),s={url:t,expand:c(a),fields:r,rest:i};return JSON.stringify(s)}makeKeyFromResponse(e){return this.makeKeyFromRequest(e.config)}resolveCachedEntry(e){if(e.url.match(/^blob/))return e;const t=this.getCacheEntry(e);return t&&t.documentUrl?{...e,url:t.documentUrl,params:{},headers:{originalUrl:e.url,originalParams:JSON.stringify(e.params)}}:e}resolveEasing(e){const t=this.makeKeyFromResponse(e),n=this.queuedRequests.get(t);if(n){const t=this.resolveCachedEntry(e.config);n.pendingRequestConfig.resolve(t)}}}const m="ultra-session-event-existing-window",p="ultra-session-event-new-window",h="ultra-session-updating-storage",g=e=>{if(e.newValue)if(e.key===m)null==window.sessionStorage.getItem(h)&&(window.sessionStorage.setItem(h,"updating"),setTimeout((()=>{window.localStorage.setItem(p,JSON.stringify(window.sessionStorage)),window.localStorage.removeItem(p),window.sessionStorage.removeItem(h)}))),window.localStorage.setItem(p,JSON.stringify(window.sessionStorage));else if(e.key===p&&!window.sessionStorage.length){const t=JSON.parse(e.newValue);for(const e of Object.keys(t))window.sessionStorage.setItem(e,t[e])}};var b=n("5MwF");n.d(t,"a",(function(){return v}));const f="ultra.components.services.learn.api.cacheRules",v="ultra.components.services.learn.api.cache";angular.module(f,[]).constant(s,new class{constructor(){this.cacheTimes={DO_NOT_CACHE:0,INSTANT:500,SHORT:15e3,MEDIUM:6e4,LONG:6e5,PERPETUAL:1/0},this.rules=[{url:"calendars",methods:["GET"],duration:this.cacheTimes.SHORT},{url:"cloudstorages",methods:["GET"],duration:this.cacheTimes.PERPETUAL},{url:"courses/_\\d+_\\d+",methods:["GET"],duration:this.cacheTimes.LONG},{url:"courses/_\\d+_\\d+",methods:o,onUpdate:(e,t)=>{t(new RegExp("users/.*"))}},{url:"courses/_\\d+_\\d+/contents/_\\d+_\\d+",methods:["GET"],duration:this.cacheTimes.INSTANT},{url:"courses/_\\d+_\\d+/contents/ROOT/children",methods:["GET"],duration:this.cacheTimes.INSTANT},{url:"courses/_\\d+_\\d+/convertToUltra/conversionStatus",methods:["GET"],duration:this.cacheTimes.INSTANT,onUpdate:(e,t)=>{const n=e.url,a=new RegExp("courses/(_\\d+_\\d+)/convertToUltra"),i=n.match(a);t(new RegExp(`courses/${i[1]}`))}},{url:"courses/_\\d+_\\d+/tools",methods:["GET"],duration:this.cacheTimes.LONG},{url:"courses/_\\d+_\\d+/assessments/_\\d+_\\d+/questions",methods:["GET"],duration:this.cacheTimes.MEDIUM},{url:"courses/_\\d+_\\d+/discussionboards/default/forums/_\\d+_\\d+/messages/_\\d+_\\d+",methods:o,onUpdate:(e,t)=>{const n=e.url,a=new RegExp("courses/(_\\d+_\\d+)/discussionboards/default/forums/(_\\d+_\\d+)"),i=n.match(a);t(new RegExp(`courses/${i[1]}/discussionboards/default/forums/${i[2]}/messages`))}},{url:"courses/_\\d+_\\d+/gradebook/attempts/_\\d+_\\d+",methods:o,onUpdate:(e,t)=>{const n=e.url,a=new RegExp("courses/(_\\d+_\\d+)/gradebook"),i=n.match(a);t(new RegExp(`courses/${i[1]}/gradebook/.*`))}},{url:"courses/_\\d+_\\d+/gradebook/attempts/_\\d+_\\d+/assessment/answers/_\\d+_\\d+/grades",methods:o,onUpdate:(e,t)=>{const n=e.url,a=new RegExp("courses/(_\\d+_\\d+)/gradebook"),i=n.match(a);t(new RegExp(`courses/${i[1]}/gradebook/.*`))}},{url:"courses/_\\d+_\\d+/gradebook/columns/_\\d+_\\d+",methods:["GET"],duration:this.cacheTimes.INSTANT},{url:"courses/_\\d+_\\d+/gradebook/columns/_\\d+_\\d+/grades",methods:["GET"],duration:this.cacheTimes.INSTANT},{url:"courses/_\\d+_\\d+/gradebook/columns/_\\d+_\\d+/grades/_\\d+_\\d+/attempts",methods:["GET"],duration:this.cacheTimes.INSTANT},{url:"courses/_\\d+_\\d+/gradebook/columns/_\\d+_\\d+/.+",methods:o,onUpdate:(e,t)=>{const n=e.url,a=new RegExp("courses/(_\\d+_\\d+)/gradebook/columns/(_\\d+_\\d+)"),i=n.match(a);t(new RegExp(`courses/${i[1]}/gradebook/columns/${i[2]}/.*`)),t(new RegExp(`courses/${i[1]}/memberships.*`))}},{url:"courses/_\\d+_\\d+/gradebook/columns/_\\d+_\\d+/summary",methods:["GET"],duration:this.cacheTimes.INSTANT},{url:"courses/_\\d+_\\d+/gradebook/grades/bulkView",methods:["GET"],duration:this.cacheTimes.DO_NOT_CACHE},{url:"courses/_\\d+_\\d+/gradebook/groupAttempts/_\\d+_\\d+/activities",methods:o,onUpdate:(e,t)=>{const n=e.url,a=new RegExp("courses/(_\\d+_\\d+)/gradebook/groupAttempts/(_\\d+_\\d+)"),i=n.match(a);t(new RegExp(`courses/${i[1]}/gradebook/groupAttempts/${i[2]}/.*`)),t(new RegExp(`courses/${i[1]}/gradebook/columns/.*`))}},{url:"courses/_\\d+_\\d+/memberships/_\\d+_\\d+",methods:o,onUpdate:(e,t)=>{const n=e.url,a=new RegExp("courses/(_\\d+_\\d+)/memberships"),i=n.match(a);t(new RegExp(`courses/${i[1]}.*`)),t(new RegExp("users/_\\d+_\\d+/memberships"))}},{url:"courses/_\\d+_\\d+/memberships",methods:["GET"],duration:this.cacheTimes.SHORT},{url:"courses/_\\d+_\\d+/users/_\\d+_\\d+",methods:["GET"],duration:this.cacheTimes.LONG},{url:"users/_\\d+_\\d+",methods:o,onUpdate:(e,t)=>{t(new RegExp("users/.*"))}},{url:"users/(?:me|_\\d+_\\d+)",methods:["GET"],duration:this.cacheTimes.LONG},{url:"users/_\\d+_\\d+/memberships",methods:["GET"],duration:this.cacheTimes.LONG},{url:"terms",methods:["GET"],duration:this.cacheTimes.PERPETUAL},{url:".+",methods:["GET"],duration:this.cacheTimes.INSTANT}]}});const y=angular.module(v,[f]);b.a.features.learnApiCaching?y.provider(r,[s,u]).service(i.c,i.a).config(["$provide","$httpProvider","learnApiCacheServiceProvider",(e,t,n)=>{window.addEventListener("storage",(e=>{(e=>[m,p].some((t=>t===e.key)))(e)&&n.disableCaching()})),window.addEventListener("storage",g,!1),localStorage.setItem(m,m),localStorage.removeItem(m);e.decorator("$http",["$delegate",e=>{const t=function(t){if(null!=t.cache)return e(t);const a=n.getRule(t.url,t.method.toUpperCase());return a&&a.onUpdate&&"function"==typeof a.onUpdate&&a.onUpdate(t,n.removeCacheEntries),-1!==o.indexOf(t.method.toUpperCase())&&n.removeCacheEntries(t.url),e(t)};return function(e,t){!function(...e){a.each(e,(function(e){t[e]=function(n,a){return t(angular.extend({},a||{},{method:e,url:n}))}}))}("delete","get","head","jsonp"),function(...e){a.each(e,(function(e){t[e]=function(n,a,i){return t(angular.extend({},i||{},{method:e,url:n,data:a}))}}))}("post","put","patch"),function(...n){a.each(n,(function(n){Object.defineProperty(t,n,{enumerable:!0,get:()=>e[n],set(t){e[n]=t}})}))}("defaults","pendingRequests")}(e,t),t}]),URL&&Object.prototype.hasOwnProperty.call(URL,"createObjectURL")&&t.interceptors.push(r)}]):y.provider(r,[d]).service(i.c,i.b)},K3JI:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return i}));var a=n("Llzl");const i="ultra.components.directives.hoverMenuOpacity";class r{constructor(){this.restrict="A",this.link=(t,n)=>{n.on("focus",".hover-menu a, .hover-menu button",(t=>{0===e("body.hide-focus-outline").length&&e(t.target).closest(".hover-menu").css({opacity:1})})).on("blur",".hover-menu a, .hover-menu button",(t=>{e(t.target).closest(".hover-menu").removeAttr("style")}))}}}r.$inject=["$injector"],a.module(i,[]).directive("bbHoverMenuOpacity",["$injector",e=>e.instantiate(r)])}).call(this,n("71td"))},KiLF:function(e,t,n){"use strict";var a=n("nbDY"),i=n.n(a);class r extends i.a{}r.Continuous=new r("CONTINUOUS"),r.DateRange=new r("DATE_RANGE"),r.FixedNumDays=new r("FIXED_NUM_DAYS"),t.a=r},Kpdw:function(e,t,n){"use strict";n.r(t),n.d(t,"moduleName",(function(){return f})),n.d(t,"serviceName",(function(){return v})),n.d(t,"CREATE_COLUMN_ID",(function(){return y})),n.d(t,"AttemptAggregationModel",(function(){return E})),n.d(t,"defaultAttemptAggregationModel",(function(){return I})),n.d(t,"parseAttemptAggregationModel",(function(){return k})),n.d(t,"getAttemptAggregationModelLabelKey",(function(){return w})),n.d(t,"getAttemptAggregationModelStudentLabelKey",(function(){return T})),n.d(t,"parseForumId",(function(){return O}));n("QLzv");var a=n("nsO7"),i=n("IbyE"),r=n("zGdY"),s=n("vYaK"),o=n("KrjC"),l=n("3uIF"),c=n("yCC5"),d=n("Rjd/"),u=n("wgY5"),m=n("XfOu"),p=n("eUpQ"),h=n("6vR2"),g=n("3PCF"),b=n("ZQFV");const f="ultra.components.services.models.grade.gradeColumn",v=c.fb,y="create",S=Symbol("forceFetchSummary"),C=[r.S.Unauthorized,r.S.Forbidden,r.S.TooManyRequests];var E;!function(e){e.Average="AVERAGE",e.First="FIRST",e.Highest="HIGHEST",e.Last="LAST",e.Lowest="LOWEST"}(E||(E={}));const I=E.Average;function k(e){if(e)return Object.values(E).find((t=>t.toLowerCase()===e.toLowerCase()))}function w(e){return"components.services.grade.aggregation-model."+e.toLowerCase()}function T(e){return"course.content.assessment.overview.gradeBasedOn."+e.toLowerCase()}function O(e){const t=e.split("/");return t[t.length-1]}d.a.factory(v,["$http","$ngRedux","restmod","$rootScope","$q",s.serviceName,l.a,o.serviceName,(e,t,n,s,o,l,d,f)=>n.model().mix({grades:{hasMany:c.gb},summary:{hasOne:c.r,hooks:{"before-request":function(e){!this.$owner[S]&&this.$owner.isCalculated()&&(e.cache={get:()=>({})})}}},groupAssociations:{hasMany:c.L},anonymousGradingReleaseDate:{serialize:"date"},dueDate:{serialize:"date"},dateCreated:{serialize:"date"},dateModified:{serialize:"date"},peerReviewDueDate:{serialize:"date"},ui:{mask:!0,init:()=>({})},$hooks:{"before-request":function(e){if(this.$url()===e.url&&"DELETE"!==e.method){const t="gradebookCategory";e.params&&e.params.expand?a.includes(e.params.expand,t)||(e.params.expand+=`,${t}`):e.params={expand:t,...e.params}}},"before-save":e=>{e.params||(e.params={}),e.params.expand=["externalGrade","gradebookCategory","columnSummary"]},"after-request":function(e){if(e.data.externalGrade&&"PATCH"===e.config.method){const n=e.data.id,a=i.Yb.gradebookGrade.getGradebookGradesByColumnId(t.getState(),n);t.dispatch(i.V.gradebookGrade.setInvalidatedGradesInStore(a))}e.data&&e.data.rubricAssociations&&e.data.rubricAssociations.forEach((e=>{m.sortRubricData(e.rubricDefinition)}));if(e.config&&e.config.params&&e.config.params.expand&&-1!==e.config.params.expand.indexOf("associatedRubrics")){const n=Object(h.a)(e.data);t.dispatch(i.V.gradebookColumn.setGradebookColumnInStore(n))}},"after-create":function(e){const n=Object(h.a)(e.data);t.dispatch(i.V.gradebookColumn.addGradebookColumnToStore(n))}},$extend:{Record:{isTest(){return i.O.Test.isEqualTo(this.scoreProviderHandle)},isAssignment(){return i.O.UltraAssignment.isEqualTo(this.scoreProviderHandle)},isCalculated(){return r.p.NonCalculated!==this.calculationType},isOffline(){return this.userCreatedColumn},seemsAttemptBased(){return!this.isCalculated()&&!this.isOffline()&&!this.isAttendance()},isDiscussion(){return i.O.Discussion.isEqualTo(this.scoreProviderHandle)},isJournal(){return i.O.Journal.isEqualTo(this.scoreProviderHandle)},isScorm(){return i.O.Scorm.isEqualTo(this.scoreProviderHandle)},isScormSCO(){if(this.isScorm()){const e=this.ui&&this.ui.content||null,t=e&&!e.isConditionalReleaseLocked()&&e.getScormGradebookItems()||[],n=t&&t.find((e=>e.columnId===this.id));return!(!n||n.root)}return!1},isAttendance(){return i.O.Attendance.isEqualTo(this.scoreProviderHandle)},isVisible(){return this.visible},isHidden(){return!this.visible},isVisibleToStudents(){return this.isVisible()},isHiddenFromStudents(){return this.isHidden()},isGroupContent(){return this.groupContent},isMultipleAttempts(){return this.multipleAttempts>1||this.isUnlimitedAttempts()},isSingleAttempt(){return 1===this.multipleAttempts},isUnlimitedAttempts(){return 0===this.multipleAttempts},isCollectExternalSubmissions(){return!!this.collectExternalSubmissions},lateAttemptCreationDisallowed(){return!!this.isLateAttemptCreationDisallowed},getNumMissing(){let e=NaN;return e=this.isOffline()?this.summary.numNeedsGrading:this.summary.numEligibleToBeGraded-this.summary.numStudentSubmissions(),e},getNumMissingIfLate(){return this.isCalculated()||!this.isLate()?NaN:this.getNumMissing()},getVisibilityAsStudent(){return this.isVisibleToStudents()?r.w.Visible:r.w.Hidden},setVisibility(e){switch(e){case r.w.Visible:this.visible=!0;break;case r.w.Hidden:this.visible=!1}},canEdit(){return this.permissions&&this.permissions.edit},postReadyGrades(){return this.$send({method:"POST",url:this.$url()+"/postReadyGrades",data:{}},(function(e){this.ui.numOfGradesPosted=e.data.count})).$asPromise().then((e=>e.ui.numOfGradesPosted))},postReadyGroupAttempts(e){return this.$send({method:"POST",url:this.$url()+"/groupAssociations/"+e.groupAssociationId+"/postReadyGroupGrades",data:{}},(e=>{this.ui.numOfAttemptsPosted=e.data.count})).$asPromise().then((e=>e.ui.numOfAttemptsPosted))},getGroupGrade(t,n){const a=n?{expand:"instructorFeedback,groupMembersGrades"}:null;return e.get(this.$url()+"/groupAssociations/"+t+"/grades",a&&{params:a}).then((e=>{const t=f.$buildRaw(e.data);return delete t.id,t.groupMembersGrades&&(t.groupMembersGrades=t.groupMembersGrades.map((e=>this.grades.$buildRaw(e)))),t}))},getGroupAttemptByGroupAssociationId(e,t=!1,n){const a={expand:t?"attempts,toolAttemptDetail,viewUrl":"attempts,toolAttemptDetail",excludeUnavailableMembers:!0};return this.groupAssociations.$new(e).groupAttempts.$fetch(a).$asPromise().then((e=>{var t;let a;return e&&n&&(a=e.find((e=>e.id===n))),null!==(t=null!=a?a:e.find((e=>e.isInProgress())))&&void 0!==t?t:e[0]}))},getGradeIdToAttempt(e,t){let n;const a={};return this.withParams(e).$send({method:"GET",url:this.$url()+(t?"/groupAttempts":"/attempts")},(function(e){Object.keys(e.data.lookup).forEach((n=>{if(t)e.data.lookup[n]=this.grades.$new(n).groupAttempts.$decode(e.data.lookup[n]);else{this.grades.$new(n).attempts.$decode(e.data.lookup[n]).some((e=>!e.deletedAttempt))&&(a[n]=this.grades.$new(n).attempts.$decode(e.data.lookup[n]))}})),e.data.lookup=a,n=e.data})).$asPromise().then((()=>n))},loadReviewableAttempts(e){return e.reviewableAttemptsOnly=!0,this.getGradeIdToAttempt(e,!1)},getContentGroupIdToGroupAttempt(e){let t;return(e?this.withParams(e):this).$send({method:"GET",url:this.$url()+"/groupAttempts"},(function(e){Object.keys(e.data.lookup).forEach((t=>{const n=e.data.lookup[t][0];n.submissionResults&&n.submissionResults.results[g.b]&&(n.originalityProcessed=n.submissionResults.results[g.b].originalityProcessed,n.originalityScore=n.submissionResults.results[g.b].originalityScore),e.data.lookup[t]=l.$new(this.courseId).gradebook.groupAttempts.$decode(e.data.lookup[t]),e.data.lookup[t].forEach((e=>{var t;e.attempts=l.$new(this.courseId).gradebook.attempts.$decode(null!==(t=e.attempts)&&void 0!==t?t:[])}))})),t=e.data})).$asPromise().then((()=>t))},hasEvaluations(){return this.getGradeIdToAttempt({}).then((e=>{let t=!1;return e&&e.lookup&&a.each(Object.keys(e.lookup),(n=>(a.each(e.lookup[n],(e=>(e&&e.rubricEvaluation&&(t=!0),!t))),!t))),t}))},launchAttempt(e,t,n,a){return n&&(e.groupId=a),this.$send({method:"POST",url:this.$url()+(n?"/groupAttempts":"/attempts"),data:e.$wrap&&e.$wrap()||e,params:t},(function(e){this.createdAttempt=n?l.$new(this.courseId).gradebook.groupAttempts.$buildRaw(e.data):l.$new(this.courseId).gradebook.attempts.$buildRaw(e.data)})).$allow(C).$asPromise().then((e=>{var t;return C.indexOf(null===(t=null==e?void 0:e.$response)||void 0===t?void 0:t.status)>-1||!(null==e?void 0:e.createdAttempt)?e:e.createdAttempt}))},countAttempts(){const e=o.defer();return this.$send({method:"GET",url:this.$url()+"/attempts/count"},(t=>{let n=null;return t.data&&(n=t.data.count),e.resolve(n)}),(t=>e.reject(t))).$allow([403]),e.promise},timeUntilDueDate(e){if(this.dueDate){const t=u(this.dueDate),n=u(p.a.getServerTime());return t.diff(n,e)}return null},daysUntilDueDate(){return this.timeUntilDueDate("days")},isLate(){return!!this.dueDate&&this.dueDate<=p.a.getServerTime()},isUserReconciler(e){const t=this;return!!(t.delegatedGrading&&t.delegatedGraders&&t.delegatedGraders.some((t=>t.userId===e&&t.canReconcile&&!t.isUnassigned)))},forceDelete(){if(!this.contentId){let e;return e=i.O.PartnerCloud.isEqualTo(this.scoreProviderHandle)&&this.linkId?d.delete(this.courseId,this.linkId):this.withParams({onlyIfEmpty:!1}).$destroy().$asPromise(),e.then((()=>(s.$broadcast("bb-delete-column",this),t.dispatch(i.V.gradebookColumn.removeGradebookColumnFromStore(this.id)),this)))}throw new Error("Content based column must be deleted by deleting associated content")},hasRubricAssociation(){return null!=this.rubricAssociations&&this.rubricAssociations.length>0},getRubricAssociation(){return this.hasRubricAssociation()?this.rubricAssociations[0]:null},getAssociatedRubricId(){return this.hasRubricAssociation()?this.rubricAssociations[0].rubricId:null},getAssociatedRubric(){return this.hasRubricAssociation()?this.rubricAssociations[0].rubricDefinition:null},setRubricAssociation(e){this.rubricAssociations=e?[{rubricId:e}]:[]},setMaxPossiblePoints(e){Number.isFinite(e)?this.possible=e:this.possible=b.O.GRADE_DEFAULT_POINTS},forceResolveSummary(){return this[S]=!0,this.summary.$resolve().$then((()=>{delete this[S]}))},forceFetchSummary(e={}){return this[S]=!0,this.summary.$fetch(e).$then((()=>{delete this[S]}))},alwaysOverride(){let e=!1;return[i.O.Test,i.O.UltraAssignment,i.O.Discussion,i.O.Scorm,i.O.PeerSubmissionsTest].forEach((t=>{t.isEqualTo(this.scoreProviderHandle)&&(e=!0)})),e},isQuestionAnalysisAvailable(){return this.isAssignment()||this.isTest()},isAnonymousGrading(){return this.anonymousGrading},canSeeFinalGrade(e){return this.delegatedGrading?!this.anonymousGrading&&this.isUserReconciler(e.id):!this.anonymousGrading}},Collection:{attachRelatedContentsByScoreProviderHandle(e){const t=this;if(!t.length)return o.when(this);const n=l.$new(t[0].courseId),a=t.filter((t=>e.isEqualTo(t.scoreProviderHandle)&&!t.restricted)),i=new Set(a.map((e=>e.contentId))),r=Array.from(i.values()).map((e=>n.contents.$find(e).$suppressErrorDialog().$asPromise()));return o.all(r).then((e=>(a.forEach((t=>{t.ui.content=e.find((e=>e.id===t.contentId))})),this)))},indexOfItemById(e){return this.$indexOf((t=>t.id===e))}}}})])},KrjC:function(e,t,n){"use strict";n.r(t),n.d(t,"moduleName",(function(){return m})),n.d(t,"serviceName",(function(){return p}));n("QLzv");var a=n("nsO7"),i=n("Llzl"),r=n("wgY5"),s=n("yCC5"),o=n("Rjd/"),l=n("eUpQ"),c=n("nkTj"),d=n("IbyE"),u=n("zGdY");const m="ultra.components.services.models.gradeDetail",p=s.gb;o.a.factory(p,["restmod",c.c,"$ngRedux",(e,t,n)=>e.model().mix({$hooks:{"after-request":function(){this.$response.data.results?n.dispatch(d.V.gradebookGrade.setInvalidatedGradesInStore(this.$response.data.results)):"PATCH"===this.$response.config.method&&n.dispatch(d.V.gradebookGrade.setGradesInStore([this.$response.data]))}},attempts:{hasMany:s.cb,hooks:{"after-fetch-many":function(){this.forEach((e=>{e.permissions=this.permissions}))}}},column:{ignore:"CU"},groupAttempts:{hasMany:s.hb},user:{belongsTo:s.zc},ui:{mask:!0,init:()=>({currentAttemptIndex:0,isCommentBoxShown:!1,areAllAttemptsDeleted:!1})},lastOverrideDate:{serialize:"date"},$extend:{Record:{isMissing(e){return!(this.isGraded()||!(e||i.isUndefined(e)&&!this.isSubmitted())||!this.column||!this.column.dueDate)&&r(this.column.dueDate).isBefore(l.a.getServerTime())},isGraded(){return null!=this.displayGrade&&(null!=this.displayGrade.score||null!=this.displayGrade.grade&&""!==this.displayGrade.grade)},isOverrideGrade(){return u.Bb.NoOverride!==this.manualStatus&&(null!=this.manualGrade||null!=this.manualScore)},isReadyToPost(){return u.Bb.NoOverride===this.manualStatus&&this.isGraded()&&!this.hasGradeBeenPosted||u.Bb.ReadyToPost===this.manualStatus},isPosted(){return!this.isCalculatedColumnGrade&&(u.Bb.NoOverride===this.manualStatus&&(this.hasGradeBeenPosted||!Object.prototype.hasOwnProperty.call(this,"hasGradeBeenPosted")&&this.isGraded())||u.Bb.IsPosted===this.manualStatus)},isSubmitted(){return!(!this.column||!this.column.seemsAttemptBased())&&u.J.NeedsGrading===this.status},isUpcoming(){if(!this.isGraded()&&!this.isSubmitted()&&this.column){if(this.column.dueDate)return r(this.column.dueDate).isAfter(l.a.getServerTime());if(this.column.seemsAttemptBased())return!0}return!1},isInProgress(){return u.Bb.GradingInProgress===this.manualStatus},hasInstructorComments(){var e,t;if(!this.isGraded())return!1;let n,a;return this.column.seemsAttemptBased()&&(n=this.ui&&this.ui.attempt,a=this.attempts),!!(null===(e=null==n?void 0:n.feedbackToUser)||void 0===e?void 0:e.displayText)||(!(!(null==a?void 0:a.length)||!this.hasSomeFeedbackToUser(a))||!!(null===(t=this.instructorFeedback)||void 0===t?void 0:t.displayText))},hasSomeFeedbackToUser:e=>e.some((e=>{var t;return!!(null===(t=e.feedbackToUser)||void 0===t?void 0:t.displayText)})),saveComment(e,t,n,i){let r=t?{userId:t}:{};return n&&(r=a.merge(r,n)),a.isString(e)?this.instructorFeedback?this.instructorFeedback.rawText=e:this.instructorFeedback={rawText:e}:this.instructorFeedback=e,i?this.$send({method:"PATCH",url:this.$url(),data:{instructorFeedback:this.instructorFeedback},params:r},(function(e){this.instructorFeedback=e.data.instructorFeedback})):this.withParams(r).$save(["instructorFeedback"])},hasAttempts(){return!!this.firstAttemptId},postReadyGrades(e){return this.$send({method:"POST",url:this.$url()+"/postReadyGrades",data:{}},(function(e){this.ui.numOfGradesPosted=e.data.count})).$asPromise().then((e=>e.ui.numOfGradesPosted))},getScore(){return this.displayGrade&&null!=this.displayGrade.score?this.displayGrade.score.toString():""},isPastDueZero(){return null!=this.displayGrade&&!0===this.displayGrade.scoredByAutomaticZero}},Collection:{},Model:{unpack(e,t){return t=this.$super(e,t),e.$isCollection?t.forEach((t=>{n(t,e.permissions)})):n(t,e.permissions),t;function n(e,t){e.permissions=t}}}}})])},"LsF/":function(e,t){e.exports='<div bb-load-bundle="components/directives/save-tray" role="status">\n  <div class="notification-container" ng-switch on="saveTray.status">\n    <span class="progress-indicator"><div class="canvas" ng-class="{\'success-state\' : saveTray.status === \'success\', \'error-state\' : saveTray.status === \'error\'}"></div></span>\n    <span class="progress-status" ng-switch-default bb-translate>{{::saveTray.localizationKeysPrefix}}.saving</span>\n    <span class="progress-status" ng-switch-when="success" bb-translate>{{::saveTray.localizationKeysPrefix}}.success</span>\n    <span class="progress-status" ng-switch-when="error" bb-translate>{{::saveTray.localizationKeysPrefix}}.error</span>\n  </div>\n</div>\n'},M2M2:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"g",(function(){return s})),n.d(t,"a",(function(){return o})),n.d(t,"e",(function(){return l})),n.d(t,"f",(function(){return c})),n.d(t,"h",(function(){return d})),n.d(t,"d",(function(){return u}));var a=n("nsO7");const i="memberships.user,studentCount,signUpSheet,hasSubmittedGroupAttempt,hasGrades";document.createElement("textarea");function r(e){return"item-sub-row-"+e}function s(e){if(e){document.activeElement.blur(),e.focus()}}var o;function l(e){const t=!!e&&a.some(e,["isSelfEnrolledAllowed",!0]),n=new Date;if(t){const t=function(e){return e.map((e=>a.get(e,"signUpSheet.enrollmentStartDate",null))).reduce(((e,t)=>{const n=e?new Date(e):null,a=t?new Date(t):null;return a&&(!n||n>a)?a:n}),null)}(e),i=function(e){return e.map((e=>a.get(e,"signUpSheet.enrollmentEndDate",null))).reduce(((e,t)=>{const n=e?new Date(e):null,a=t?new Date(t):null;return a&&(!n||n<a)?a:n}),null)}(e);let r=o.OPEN;return t&&n<t?r=o.BEFORE:i&&n>i&&(r=o.AFTER),{now:n,firstStartDate:t,lastEndDate:i,enrollmentDateState:r,isSelfEnrollment:!0}}return{now:n,isSelfEnrollment:!1}}async function c(e,t,n){const a=l(e);if(a.isSelfEnrollment){let e=null;return"Before"===a.enrollmentDateState?e=await n.datetime.formatRelativeTimestamp(a.firstStartDate,t):"Open"===a.enrollmentDateState&&a.lastEndDate&&(e=await n.datetime.formatRelativeTimestamp(a.lastEndDate,t)),{relativeDate:e,isEnrollmentDateImportant:!!(a.lastEndDate&&"Open"===a.enrollmentDateState&&a.lastEndDate.getTime()-a.now.getTime()<2592e5),enrollmentDateState:a.enrollmentDateState,isSelfEnrollment:!0}}return{isSelfEnrollment:!1}}function d(e){return a.sortBy(e,"title")}function u(e){return e&&e[0]&&e[0].groupSetId?e[0].groupSetId:null}!function(e){e.OPEN="Open",e.BEFORE="Before",e.AFTER="After"}(o||(o={}))},MFWY:function(e,t,n){},MISG:function(e,t,n){},MOka:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return h}));var a=n("D57K"),i=n("pjml"),r=n("emI2"),s=n("fYJU"),o=n("zPsu"),l=n("zGdY"),c=n("aHpC"),d=n("yC9S"),u=n("go4a"),m=n("IbyE");const p="ultra.service.stream.settings",h="streamSettings",g="ultraui.stream.settings.v2",b={Calendar:"CAL",NewContentAdded:"CON",NewAssessmentsAdded:"CON",CourseAvailable:"CRS",BlogEntryPosted:"DIS",BlogEntryEdited:"DIS",BlogEntryComment:"DIS",DiscussionReply:"DIS",NewDiscussionForum:"DIS",NewMessages:"MES",NewGradeableItems:"SUB",StudentActivityAvailable:"GRB",StudentGradeDataAvailable:"GRB",StudentsFallingBehind:"GRB",StudentsFallingBehindAbsent:"GRB",StudentsFallingBehindFailing:"GRB",StudentsFallingBehindAbsentFailing:"GRB",NoRecentActivity:"TEL",LowActivity:"TEL",HighActivity:"TEL",GradeAtRisk:"TEL",LowGrade:"TEL",GradeLowered:"TEL",PerformanceIncreased:"TEL",HighGrade:"TEL"};let f=class{constructor(e,t,n,a,i,r){this.$rootScope=e,this.$q=t,this.preferenceService=n,this.UserModel=a,this.currentUserService=i,this.store=r,this.userSettings=null,d.b.OnRootScope(this.$rootScope,"membership-hidden-status-update",((e,t)=>{this._updateMembership(t),this.$rootScope.$broadcast("stream-settings-updated")})),this.subscribeToRedux()}initializeSettings(){return this.$q.all([this._getUserMemberships(),this.loadAdminNotificationSettings()]).then((()=>this._loadUserSettings()))}subscribeToRedux(){const e=this.store.connect((e=>{const t=m.Yb.notificationMethodSetting.getAdminNotificationMethodSettings(e),n=m.Yb.systemPreference.getSystemPreferenceByKey(e,o.b),a=this._transformRegistrySettings(n);return{adminNotificationSettings:t.concat(a)}}),(e=>({loadAdminNotificationSettings:()=>this.$q.all([e(m.V.notificationMethodSetting.loadAdminNotificationMethodSettings()),e(m.V.systemPreference.loadSystemPreference({key:o.b,shouldLoadWhilePending:!0}))])})))(this);this.$rootScope.$on("$destroy",e)}_transformRegistrySettings(e){let t=o.d;e&&e.value&&(t=JSON.parse(e.value));const n=[];return t.settings.forEach((e=>{n.push({context:l.Eb.Course,source:o.a,event:e.id,method:"DA",isEditable:e.isEditable,isEnabled:e.isEnabled})})),n}_getUserMemberships(){return this.userMemberships?this.$q.resolve(Object.values(this.userMemberships)):this.currentUserService.getMemberships().then((e=>(this.userMemberships=e.reduce(((e,t)=>({...e,[t.id]:t})),{}),Object.values(this.userMemberships))))}reloadStreamMemberships(){return this.userMemberships=null,this._getUserMemberships()}save(e){if(!e)return this.$q.resolve();Object.keys(e).forEach((t=>{e[t].definition||(e[t].definition=o.c.find((e=>e.id===t)))}));const t={version:3,settings:Object.keys(e).map((t=>({id:e[t].definition.id,isEnabled:e[t].isEnabled})))};return this.preferenceService.setPreference(g,angular.toJson(t)).then((()=>this._loadUserSettings()))}_loadLegacyUserSettings(){return this.preferenceService.getPreference("ultraui.stream.settings",null).then((e=>{if(!e||!e.value)return!1;const t=angular.fromJson(e.value);return this.userSettings=o.c.reduce(((e,n)=>{const a=b[n.id];return{...e,[n.id]:{definition:n,isEnabled:!!a&&"N"!==t[a]}}}),{}),!0}))}_loadUserSettings(){return this.preferenceService.getPreference(g,null).then((e=>{if(!e||!e.value)return this._loadLegacyUserSettings().then((e=>{if(!e)return this._loadDefaultSettings()}));const t=angular.fromJson(e.value);this.userSettings={},t.settings.forEach((e=>{const t=o.c.find((t=>t.id===e.id));t&&(this.userSettings[e.id]={isEnabled:e.isEnabled,definition:t})}))}))}_loadDefaultSettings(){return this.loadAdminNotificationSettings().then((()=>{this.userSettings=o.c.reduce(((e,t)=>{const n=t.defaultSetting(this.adminNotificationSettings);return e[t.id]={isEnabled:n,definition:t},e}),{})}))}getUserSettings(){return this._hasUserSettings()?this.$q.resolve(this.userSettings):this._loadUserSettings().then((()=>this.userSettings))}_hasUserSettings(){return null!==this.userSettings}_updateMembership(e){this.userMemberships={...this.userMemberships,[e.id]:{...this.userMemberships[e.id],...e}}}hidden(e){if(!e)return!1;const t=!!this.userMemberships?Object.values(this.userMemberships).find((t=>t.course.$pk===e.courseId)):null;if(t&&t.userHasHidden)return!0;if(t&&(e.courseColorClass=Object(u.a)(t)),!this.userSettings||!this.adminNotificationSettings)return!1;let n=!1;for(const t of Object.keys(this.userSettings)){const a=this.userSettings[t];if(a.definition.canHandle(e)&&(n=!0,a.definition.isStreamEntryVisible(a.isEnabled,this.adminNotificationSettings)))return!1}return n}};f=Object(a.a)([Object(a.c)(0,Object(c.b)("$rootScope")),Object(a.c)(1,Object(c.b)("$q")),Object(a.c)(2,Object(c.b)(r.c)),Object(a.c)(3,Object(c.b)(i.Jb.serviceName)),Object(a.c)(4,Object(c.b)(s.b)),Object(a.c)(5,Object(c.b)("$ngRedux"))],f);angular.module(p,[r.b]).service(h,f)},Mc6f:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return l}));var a=n("nsO7"),i=n("Llzl"),r=n("yC9S"),s=n("pjml");const o="ultra.components.services.grade.gradeNotation.Service",l="gradeNotationService";class c{constructor(e,t,n){this.$q=e,this.$rootScope=t,this.CourseModel=n,this.courseGradeNotationMap={},r.b.OnRootScope(t,"grade-notation-update",((e,t)=>{this.CourseModel.$new(t).gradebook.performancecodes.$fetch().$then((e=>{this.courseGradeNotationMap[t]=e,this.$rootScope.$broadcast("grade-notation-cache-update",t)}))}))}getGradeNotationsMap(e,t){if(t&&this.courseGradeNotationMap[e])return this.$q.when(this.courseGradeNotationMap[e]);const n=this.$q.defer();return this.CourseModel.$new(e).gradebook.performancecodes.$fetch().$then((t=>{this.courseGradeNotationMap[e]=t,n.resolve(t)})),n.promise}isValidPerformanceCodeGrade(e,t){return!(!t||a.isEmpty(e))&&!!a.find(e,(e=>e.code===t))}}c.$inject=["$q","$rootScope",s.m.serviceName];i.module(o,[]).service(l,c)},N7x3:function(e,t,n){"use strict";(function(e){var a=n("Llzl"),i=n("5MwF"),r=n("td+C"),s=n("YzQO"),o=n("oPIA"),l=n("myse");t.a=new class{constructor(e){this.integrationService=e,this.integrationForceClick="integration-force-click",this.onClick=e=>{if(e.originalEvent&&e.originalEvent.manualFireFlag)return;const t=a.element(e.target),n=Object(s.b)(t)||Object(s.d)(t.parent());this._sendEventMessage(n,o.fb.Click)},this.onHover=e=>{const t=a.element(e.target),n=Object(s.c)(t);n!==this.lastHoverElementId&&(this.lastHoverElementId=n,this._sendEventMessage(n,o.fb.Hover))},Object(l.subscribeToFramework)("Ultra",((e,t)=>{e===l.AnalyticsEventTypes.CLICK_EVENT?this._sendEventMessage(t.analyticsId,o.fb.Click):e===l.AnalyticsEventTypes.HOVER_EVENT&&this._sendEventMessage(t.analyticsId,o.fb.Hover)}))}addClickListener(){i.a.unitTesting||(e(document).on("click",this.onClick),e(document).on(this.integrationForceClick,this.onClick))}addHoverListener(){i.a.unitTesting||e(document).on("mouseover",this.onHover)}_sendEventMessage(e,t){e&&this.integrationService.sendEventMessage({type:o.i,eventType:t,analyticsId:e})}}(r.a)}).call(this,n("71td"))},"NI+y":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a="ANALYTICS_HISTORY";t.b=new class{constructor(){this.analytics=[],this.maxHistorySize=30,this.storageKey=a}setStorage(e,t){return this.browserStorage=e,this.storageType=t,this.getHistoryFromStorage().then((e=>(e&&(this.analytics=e.concat(this.analytics),this.setMaxHistorySize(this.maxHistorySize)),e)))}addHistory(e){this.analytics.push({action:e.action,analyticsId:e.analyticsId,screenDimension:e.screenDimension,timestamp:(new Date).toUTCString()}),this.analytics.length>this.maxHistorySize&&this.analytics.shift(),this.browserStorage.saveToStorage(this.storageKey,this.analytics,this.storageType)}getHistoryFromStorage(){return this.historyRestoredPromise=Promise.resolve(this.browserStorage.getFromStorage(this.storageKey,this.storageType)),this.historyRestoredPromise}async getHistory(){return await this.historyRestoredPromise,this.analytics}clearHistory(){this.historyRestoredPromise=null,this.analytics=[],this.browserStorage.saveToStorage(this.storageKey,this.analytics,this.storageType)}setMaxHistorySize(e){e>0&&Number.isInteger(e)&&(this.maxHistorySize=e,this.analytics=this.analytics.slice(-this.maxHistorySize))}}},NXdT:function(e,t,n){"use strict";(function(e){n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));n("LNcM"),n("nh++");var a=n("nsO7"),i=n("zFCC");const r="bbIntersectionObservableDirective";function s(e,t=null){return function(n,i,r,s,o){const l=s[s.length-1],c=Object(a.once)((()=>{e.call(this,n,i,r,s,o)}));let d=c;t&&t>0?d=Object(a.debounce)((()=>{c(),n.$evalAsync(a.noop)}),t):d.cancel=a.noop,l?l.link(i[0],n,((e,t,n)=>{n.isIntersecting?d():d.cancel()})):c()}}function o(e=null){return function(t){return class extends t{constructor(...t){super(...t),this.require=[].concat(this.require||[]).concat([`^^?${i.a}`]),this.link=s(this.link||a.noop,e)}}}}const l="bbIntersectionObservable";angular.module(r,[]).directive(l,["$compile",function(t){return{transclude:"element",priority:6e3,terminal:!0,require:`^^?${i.a}`,restrict:"A",link(n,i,r,s,o){if(!s)return o((function(e,t){i.replaceWith(e)}));const c={placeholder:"div",debounce:0,...n.$eval(r[l]||"{}")},d=e(`<${c.placeholder} class="intersection-observable-placeholder"></${c.placeholder}>`);t(d)(n),i.replaceWith(d);const u=Object(a.debounce)(Object(a.once)((()=>{o((function(e,t){s.unlink(d[0]),d.replaceWith(e)}))})),c.debounce);s.link(d[0],n,((e,t,n)=>{n.isIntersecting?u():u.cancel()}))}}}])}).call(this,n("71td"))},Nrpd:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n("Llzl"),i=n("0JpG"),r=n("pjml"),s=n("TnpK"),o=n("MOka"),l=n("Sa5G");const c="ultra.base.notification-settings.routes";a.module(c,[i.moduleName,s.b]).config([s.c,e=>{e.peekState("notification-settings",{abstract:!0,require:()=>n.e(625).then(n.bind(null,"gE0d")),resolve:{mobileDistributorSettings:[r.Q.serviceName,e=>e.$build().courseSettings.$new(l.q.Mobile).$fetch().$allow([400])],isMobileDistributorActive:["$q","mobileDistributorSettings","memberships",(e,t)=>t.$then((e=>!!e.settings)).$asPromise()],notificationGeneralSettings:[r.P.serviceName,e=>e.$build().$fetch().$asPromise()],memberships:[o.b,e=>e.reloadStreamMemberships()]}}).peekState("notification-settings.content",{url:"/notification/settings?tab",resolve:{translations:[i.serviceName,e=>e.loadBundle("features/base/notifications-settings/base-notifications-settings")],memberships:[o.b,e=>e.reloadStreamMemberships()]},views:{"email-settings@":{require:()=>n.e(706).then(n.bind(null,"IwlP"))},"stream-settings@":{require:()=>n.e(758).then(n.bind(null,"wgch")),resolve:{translations:[i.serviceName,e=>e.loadBundle("features/base/stream/base-stream")]}},"sms-settings@":{require:()=>Promise.all([n.e(43),n.e(78),n.e(687)]).then(n.bind(null,"EKn0"))},"mobile-settings@":{require:()=>n.e(707).then(n.bind(null,"pVU+"))}}})}])},OMme:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return h}));var a=n("Llzl"),i=n("vdfi"),r=n("bF8R"),s=n("0JpG"),o=n("JXhc"),l=n("TnpK"),c=n("Qbdf"),d=n("36CG"),u=n("X455"),m=n("nmzr"),p=n("+O05");const h="ultra.base.proctoring.routes";a.module(h,[s.moduleName,l.b,c.b,u.a,p.g]).config([l.c,c.c,u.b,(t,a,h)=>{t.baseState(m.d.BASE_PROCTORING_ATTEMPT,{url:"^/proctoring/attempt?courseId&contentId&password",peekStates:["conversations",m.n.COURSE_MESSAGE,"assessment-details","edit-file-settings","attempt-safe-assign-setting","rubric-view",i.b,o.b],onEnter:()=>{e("body").addClass("proctoring-attempt-open")},onExit:()=>{e("body").removeClass("proctoring-attempt-open")},resolve:{[c.d]:a.resolve,[u.c]:h.resolve,contentData:[c.d,r.b,l.d,(e,t,n)=>t.loadContentAndGrades({course:e,contentId:n.nextParams.contentId})],translations:[s.serviceName,e=>e.loadAllBundles(["components/services/proctoring","features/course/content/assessment/assessment"])],currentContent:["contentData",e=>e.courseContent],currentColumn:["contentData",e=>e.gradingColumn],attempt:["contentData",p.h,l.d,(e,t,n)=>{const{gradingColumn:a,courseContent:i}=e,r=n.nextParams.password,s=i.isGroupContent,o=i.assignedGroups?i.assignedGroups[0].groupId:null;return t.launchAttempt(a,r,s,o)}]},require:()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(20),n.e(32),n.e(43),n.e(33),n.e(39),n.e(21),n.e(59),n.e(105),n.e(164)]).then(n.bind(null,"RTst")),pageTitle:"components.services.proctoring.delivery.attempt.pageTitle",peekViewName:"proctored-assessment-peek"}).baseState("base.proctoring-review",{url:"^/proctoring/review?courseId&contentId&attemptId",peekStates:[],onEnter:()=>{e("body").addClass("proctoring-attempt-open")},onExit:()=>{e("body").removeClass("proctoring-attempt-open")},resolve:{translations:[s.serviceName,e=>e.loadAllBundles(["components/services/proctoring","features/course/content/assessment/assessment"])],[c.d]:a.resolve,[u.c]:h.resolve,currentContent:[c.d,l.d,d.c,(e,t,n)=>e.contents.$find(t.nextParams.contentId).$asPromise().then((e=>(n.setCurrentContent(e),e)))],currentAttempt:[c.d,l.d,(e,t)=>e.gradebook.attempts.$find(t.nextParams.attemptId,{expand:"toolAttemptDetail,alignedGoals,viewUrl"}).$asPromise()],currentGradedQuestionAttempts:["$q","currentAttempt",(e,t)=>{const n=e.defer();return t.assessment.gradedQuestionAttempts.$fetch({expand:"questionAttempt.question,questionAttempt.answerCorrectness"}).$asPromise().then((e=>{e.setPostStatusAndGroupAttemptId(t),n.resolve(e)})),n.promise}]},require:()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(43),n.e(33),n.e(105),n.e(708)]).then(n.bind(null,"Mpwm")),pageTitle:"components.services.proctoring.delivery.review.pageTitle"})}])}).call(this,n("71td"))},ORAk:function(e,t){e.exports='<div>\n    <div bb-dir>\n        <div ui-view="{0}" bb-offcanvas-pausal-scope></div>\n    </div>\n</div>'},OTLg:function(e,t,n){"use strict";var a=n("Llzl"),i=n("pjml"),r=n("vYaK"),s=n("f8ya");class o{constructor(e){this.content=e,this._groups=[],this._memberships=[],this.counts={count:0,withAccommodationCount:0,dueDateAccommodationCount:0,timeLimitAccommodationCount:0,maxLimit:0},this.refreshGroups()}set groups(e){this.dueDateGroups=[],this.timeLimitGroups=[],this._groups=null!=e?e.filter((e=>(e.accommodation=s.a.fromTypes(e.dueDateExceptionType,e.timeLimitExceptionType),e.accommodation.dueDate.hasAccommodation&&this.dueDateGroups.push(e),e.accommodation.timeLimit.hasAccommodation&&this.timeLimitGroups.push(e),e.accommodation.hasAccommodation))):[]}get groups(){return this._groups}sortGroups(e){this._groups.sort(e),this.dueDateGroups.sort(e),this.timeLimitGroups.sort(e)}refreshGroups(){null!=this.content&&(this.groups=this.content.assignedGroups)}set memberships(e){this.dueDateMembers=[],this.timeLimitMembers=[],this._memberships=null!=e?e.filter((e=>{const t=e.accommodation();return t.dueDate.hasAccommodation&&this.dueDateMembers.push(e),t.timeLimit.hasAccommodation&&this.timeLimitMembers.push(e),t.hasAccommodation})):[]}get memberships(){return this._memberships}get nGroups(){return this.groups.length}get nGroupsDueDate(){return this.groups.filter((e=>e.accommodation.dueDate.hasAccommodation)).length}get nGroupsTimeLimit(){return this.groups.filter((e=>e.accommodation.timeLimit.hasAccommodation)).length}get nUsers(){return this.counts.withAccommodationCount}get nUsersDueDate(){return this.counts.dueDateAccommodationCount}get nUsersTimeLimit(){return this.counts.timeLimitAccommodationCount}get isGroupContent(){if(null==this.content)return!1;const e=this.content.assignedGroups&&0!==this.content.assignedGroups.length;return this.content.isGroupContent||e||0!==this.groups.length}get nInstances(){return this.isGroupContent?this.nGroups:this.nUsers}get nInstancesDueDate(){return this.isGroupContent?this.nGroupsDueDate:this.nUsersDueDate}get nInstancesTimeLimit(){return this.isGroupContent?this.nGroupsTimeLimit:this.nUsersTimeLimit}get nInstancesShown(){if(this.isGroupContent){if(this.showDueDateAccommodation&&this.showTimeLimitAccommodation)return this.nGroups;if(this.showDueDateAccommodation)return this.nGroupsDueDate;if(this.showTimeLimitAccommodation)return this.nGroupsTimeLimit}else{if(this.showDueDateAccommodation&&this.showTimeLimitAccommodation)return this.nUsers;if(this.showDueDateAccommodation)return this.nUsersDueDate;if(this.showTimeLimitAccommodation)return this.nUsersTimeLimit}}get showAccommodation(){return this.showDueDateAccommodation||this.showTimeLimitAccommodation}get showDueDateAccommodation(){if(null==this.content)return!1;return this.content.hasDueDate()&&this.content.getDueDate()&&this.hasDueDateAccommodation}get showTimeLimitAccommodation(){return null!=this.content&&(this.content.getTimedTestDetail().hasTimeLimit&&this.hasTimeLimitAccommodation)}get hasAccommodation(){return this.hasDueDateAccommodation||this.hasTimeLimitAccommodation}get hasDueDateAccommodation(){return this.nInstancesDueDate>0}get hasTimeLimitAccommodation(){return this.nInstancesTimeLimit>0}}n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return u}));const l="ultra.services.accommodation.Service",c="accommodationService",d=["id","isAvailable","role","user.*","userId","courseRole","dueDateExceptionType","timeLimitExceptionType","permissions","user.rowStatus"],u=[...d,"displayOrder"],m=["alignedGoals","assignedGroups","isGroupContent"];class p{constructor(e){this.courseModel=e,this._cache={},this._invalidCache={}}createContentAccommodation(e){const t=new o(e);return null!=e&&e.id&&(e.assignedGroups&&!this._invalidCache[e.id]?t.refreshGroups():this.fetchGroupsOrCounts(t)),t}getContentAccommodation(e){return null==e?this.createContentAccommodation(e):((null==this._cache[e.id]||this._invalidCache[e.id])&&(this._cache[e.id]=this.createContentAccommodation(e),this._invalidCache[e.id]=!1),this._cache[e.id])}forceNewContentAccommodation(e){null!=e&&(this._invalidCache[e.id]=!0)}invalidateContentAccommodationOtherThan(e){null!=e&&Object.keys(this._cache).forEach((t=>{t!==e.id&&(this._invalidCache[t]=!0)}))}refreshAccommodation(e){null!=e.content&&(e.isGroupContent?e.refreshGroups():this.fetchCount(e.content.courseId,e))}fetchGroupsOrCounts(e){null!=e.content&&(null==e.content.isGroupContent||e.isGroupContent?e.content.$fetch({fields:m.join(","),expand:"selfEnrollmentGroups.group"}).$then((t=>{e.refreshGroups(),e.isGroupContent||this.fetchCount(t.courseId,e)})):this.fetchCount(e.content.courseId,e))}sortGroupsByTitle(e){e.sortGroups(((e,t)=>e.groupTitle.localeCompare(t.groupTitle)))}fetchCount(e,t){this.courseModel.$new(e).memberships.getDetailsCount().then((e=>{t.counts=e}))}fetchMemberships(e,t){this.courseModel.$new(e).memberships.$refresh({fields:d.join(","),sort:"user.givenName"}).$then((e=>t.memberships=e))}}p.$inject=[r.serviceName];a.module(l,[i.N]).service(c,class extends p{})},ObAk:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n("oPIA");class i{constructor(){this.subscribeToEvents=(e,t)=>{e.subscriptions.forEach((e=>{if(!this.checkIfValidSubscription(e))return void console.warn(`Received subscription to invalid event type ${e}`);const n=this.subscriptions.get(e)||new Set;n.add(t),this.subscriptions.set(e,n);const a=this.subscribeCallbacks.get(e);a&&a.forEach((e=>e(t)))}))},this.unsubscribeFromEvents=(e,t)=>{e.subscriptions.forEach((e=>{if(!this.subscriptions.has(e))return void console.warn(`Integration is not subscribed to ${e}, not unsubscribing`);const n=this.subscriptions.get(e);n.delete(t),this.subscriptions.set(e,n);const a=this.unsubscribeCallbacks.get(e);a&&a.forEach((e=>e(t)))}))},this.onSubscriptionEventCallback=(e,t)=>{const n=this.subscribeCallbacks.get(e)||[];return n.push(t),this.subscribeCallbacks.set(e,n),()=>this.removeCallback(e,t,this.subscribeCallbacks)},this.onUnsubscriptionEventCallback=(e,t)=>{const n=this.unsubscribeCallbacks.get(e)||[];return n.push(t),this.unsubscribeCallbacks.set(e,n),()=>this.removeCallback(e,t,this.unsubscribeCallbacks)},this.getSubscribedIntegrations=e=>this.subscriptions.get(e)||new Set,this.checkIfValidSubscription=e=>Object.values(a.fb).some((t=>t===e)),this.removeCallback=(e,t,n)=>{if(!n.has(e))return;const a=n.get(e);a.splice(a.indexOf(t),1),n.set(e,a)},this.subscriptions=new Map,this.subscribeCallbacks=new Map,this.unsubscribeCallbacks=new Map}}},OcoR:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return c}));n("3Yz5");var a=n("Llzl"),i=n("Fvsw"),r=n("oQrK"),s=n("lEL+"),o=n("Ediv"),l=n("yC9S");const c="ultra.components.directives.firstVisit";class d{constructor(e,t,n){this.$q=e,this.bbContext=t,this.timeout=n,this.restrict="E",this.template=o,this.link=(e,t,n)=>{this.alterBodyStyles(e,"ftue-on");const a="ultraui.first.time."+n.path+"."+n.place+".visited";e.firstVisit=!1,e.loadImage=(e,t,n,a=null)=>{const i=n.inViewTarget;e&&"both"===t&&!i.src.match(new RegExp(a+"$"))&&(i.src=a)},this.bbContext.getPreference(a,"false").then((n=>{"false"===n.value?(e.firstVisit=!0,this.bbContext.setPreference(a,"true"),this.resizeWelcomeWindow(e,t)):"true"===n.value&&(e.firstVisit=!1)}))}}alterBodyStyles(t,n){e("body").addClass(n),t.$on("$destroy",(()=>{e("body").removeClass(n)}))}resizeWelcomeWindow(t,n){const a=()=>{const e=n.find(".current-view"),t=e.offset().top,a=this.$q.defer(),i=this.$q.defer();n.closest("body").animate({scrollTop:t},{duration:500,always(){a.resolve()}}),n.closest("html").animate({scrollTop:t},{duration:500,always(){i.resolve()}}),this.$q.all([a.promise,i.promise]).then((()=>e.find("a.ftue-img").focus()))};let i;const s=()=>{this.timeout.cancel(i),i=this.timeout((()=>{const t=n.find(".ftue-new-slide");for(let n=0;n<t.length;n++){const a=t.eq(n),i=a.find(".slide-content").height()+a.find(".slide-control").height()+parseInt(a.find(".slide-content").css("top"),10)+40;a.css("min-height",i);const r=e(window).height();r>i&&a.css("height",r)}a()}),t,250,!1)},o=t=>{const n=e(t.target).closest(".ftue-new-slide").next();e(n).addClass("current-view").siblings().removeClass("current-view"),a()};n.on("click",".scroll-button",o),r.a.detect().desktop()&&l.b.OnWindow("resize",s,t),t.$on("$destroy",(()=>{n.off("click",".scroll-button",o)}))}}d.$inject=["$q",i.b,s.b],a.module(c,[i.a,"angular-inview",s.a]).directive("bbFirstVisit",["$injector",e=>e.instantiate(d)])}).call(this,n("71td"))},OmEq:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r}));const a="[A-Z0-9._%+-]+@[A-Z0-9.-]+\\.[A-Z]{2,24}\\s*",i=new RegExp("^"+a+",?$","i"),r=new RegExp("^"+a+"(,+\\s*\\n*"+a+")*,*\\s*$","i")},OvxF:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));n("T4UF"),n("67oV");var a=n("nsO7"),i=n("Llzl"),r=n("0JpG"),s=n("XGja"),o=n("+4Px"),l=n("mkvA"),c=n("Y+9S");const d="ultra.components.directives.modal";class u{constructor(e,t,n,i,r){this.scope=e,this.element=t,this.attrs=n,this.transcludes=i,this.bbLocalize=r,this.ariaType="dialog",this.ariaType=e.modalAriaType?e.modalAriaType:this.ariaType,this.analyticsIdTagPrefix=e.analyticsIdTagPrefix||"";const s=e.modalTranslateOptions&&e.modalTranslateOptions();this.titleKey=e.modalTitleKey,this.titleString=r.translateSync(a.merge({key:e.modalTitleKey},s?s.title:{})),this.dismissKey=e.modalDismissKey,(e.modalDismissKey||s&&s.dismiss)&&(this.dismissString=r.translateSync(a.merge({key:e.modalDismissKey},s?s.dismiss:{})));const o=t.find("[name=modal-footer] button");t.find(".reveal-modal__footer").addClass("buttons-"+o.length+"-md")}handleKeyDown(e){e.keyCode===o.u?(e.preventDefault(),e.shiftKey?s.c(this.element):s.b(this.element)):e.keyCode===o.g&&(e.stopPropagation(),this.dismiss())}dismiss(){this.scope.modalDismissCallback?this.scope.modalDismissCallback():this.scope.$parent.$dismiss(),Object(c.o)(c.c.ModelDismissed)}}u.$inject=["scope","element","attrs","transcludes",r.serviceName];class m{constructor(e){this.$injector=e,this.replace=!0,this.restrict="E",this.template=l,this.transclude=!0,this.scope={modalDismissCallback:"&?",modalDismissKey:"@?",modalTitleKey:"@?",modalTranslateOptions:"&?",modalAriaType:"@?",analyticsIdTagPrefix:"@"},this.link=(e,t,n,a,i)=>{e.modal=this.$injector.instantiate(u,{scope:e,element:t,attrs:n,transcludes:i})}}}m.$inject=["$injector","$rootScope"],i.module(d,["multi-transclude"]).directive("bbModal",["$injector",e=>e.instantiate(m)])},"Oyr+":function(e,t,n){"use strict";n("juDU"),n("9RbK"),n("1dyP");var a=n("nsO7"),i=n("71td"),r=n("Llzl"),s=n("nbDY"),o=n.n(s),l=n("X455"),c=n("0JpG"),d=(n("67oV"),n("0+Qs")),u=n("rxY8"),m=n("jT78"),p=n("okL3");const h="ultra.directives.bbProgress";class g{constructor(e,t,n,a,i){this.scope=e,this.bbLocalize=t,this.interval=n,this.$q=a,this.spinner=i,this.processingSpinnerArgs={canvasSize:43,scaleX:1.5,scaleY:1.5},this.cancelUpload=(e,t,n)=>{e.stopImmediatePropagation(),e.preventDefault();const a=this.scope.inProgressFiles.filter((e=>e.id===t&&this.isIdentifierInProgressFile(e.inProgressFileId,n)))[0];this.cancelUploadFile(a)},this.scope.$on("cancel-upload-all",(e=>{this.scope.inProgressFiles.forEach((e=>{this.cancelUploadFile(e)}))}))}cancelUploadFile(e){e.content&&this.scope.$root.$broadcast(z,e.content,W.DeleteContent),e.interval&&this.interval.cancel(e.interval);const t=this.scope.inProgressFiles.splice(this.scope.inProgressFiles.indexOf(e),1)[0];this.scope.$root.$broadcast(z,e.id,t,W.Cancel,this.scope.targetDiv,this.scope.primaryKey&&this.scope.primaryKey())}remove(e){a.remove(this.scope.inProgressFiles,(t=>t.ui&&e.ui&&t.ui.fileId&&e.ui.fileId?t.ui.fileId===e.ui.fileId&&this.isIdentifierInProgressFile(t.inProgressFileId,e.inProgressFileId):!(!e.ui||!e.ui.id)&&(t.id===e.ui.id&&this.isIdentifierInProgressFile(t.inProgressFileId,e.inProgressFileId)))),this.scope.$root.$broadcast(z,this.scope.fileUploadDivId,0,e.id,W.Cancel,this.scope.primaryKey&&this.scope.primaryKey())}isIdentifierInProgressFile(e,t){return!e||!t||e===t}transformModelForDisplay(e){return{barId:e.file.id?e.file.id.replace(/\D/g,""):"",content:e.content,currentMimeType:e.currentMimeType,currentProgress:0,file:e.file,fileName:e.fileName,fileSize:e.file.size,id:e.id,inProgressFileId:e.inProgressFileId||"",interval:null,ui:e.ui}}getProgressIdAttr(e){return e.inProgressFileId?`file-progress-${e.barId}-${e.inProgressFileId}`:`file-progress-${e.barId}`}setProgress(e,t,n,i){let r,s,o,l,c;if(n){c=a.find(this.scope.inProgressFiles,(e=>e.file.id===n&&this.isIdentifierInProgressFile(e.inProgressFileId,i)));const e=this.scope.targetDiv?`-${i}`:"",t=`#file-progress-${n.replace(/\D/g,"")}${e}`;l=this.scope.element.find(t+" .progress-circle .bar"),o=this.scope.element.find(t+" .processing-spinner .canvas")}else{c=this.scope.inProgressFiles.find((t=>t.id===e&&this.isIdentifierInProgressFile(t.inProgressFileId,i)));const t=this.scope.inProgressFiles.indexOf(c);l=this.scope.element.find(".progress-circle-svg .bar").eq(t),o=this.scope.element.find(".processing-spinner .canvas").eq(t)}if(!c)return;if(c.currentProgress>=t)return;null!=c.interval&&this.interval.cancel(c.interval);const d=c.currentProgress;c.interval=this.interval((()=>{c&&(c.currentProgress++,r=l.attr("stroke-dashoffset"),s=r-r*(.01*c.currentProgress),l.css({strokeDashoffset:s+"px"}),100===c.currentProgress&&(c.isProcessing||(this.spinner.initInlineLoader(o,this.processingSpinnerArgs).start(),c.isProcessing=!0),n?this.scope.$root.$broadcast(z,n,W.UploadProgressComplete):this.scope.$root.$broadcast(z,this.scope.fileUploadDivId,this.scope.inProgressFiles.indexOf(c),e,W.UploadProgressComplete),this.interval.cancel(c.interval)))}),this.scope,20,t-d)}}g.$inject=["scope",c.serviceName,d.b,"$q",u.b];class b{constructor(e,t,n){this.$injector=e,this.interval=t,this.bbLocalize=n,this.template=p,this.restrict="E",this.scope={displayResults:"=",progressId:"=",targetDiv:"@",primaryKey:"&?"},this.link=(e,t,n)=>{e.element=t,e.progress=this.$injector.instantiate(g,{scope:e}),e.progress.progressId=n.id||"directive-"+Math.floor(1e4*Math.random())+"-"+Math.floor(1e4*Math.random()),e.inProgressFiles=[],e.$on(z,((n,a,i,r,s)=>{if(null!=i&&(null!=i.content&&i.content.ui.fileUploadId===e.progress.progressId||e.progress.progressId===i.progressId||e.targetDiv&&e.targetDiv===s))if(r!==W.Uploading||i.content)if(r===W.Uploaded)e.progress.displayResults||e.progress.remove(i);else if(r===W.Error)e.progress.remove(i);else if(r===W.CommenceUpload)if(null!=i.content){if(e.fileUploadDivId=a,t.attr("id")===i.targetElement.attr("id")){e.inProgressFiles.push(e.progress.transformModelForDisplay(i));const n=this.interval((()=>{t.find(".progress-circle").length>0&&(e.$root.$broadcast(z,a,i,W.ProgressRenderComplete),this.interval.cancel(n))}),e,100,10)}}else i.progressId===e.progress.progressId&&(e.inProgressFiles.push(e.progress.transformModelForDisplay(i)),e.$root.$broadcast(z,a,i,W.ProgressRenderComplete));else r===W.Cancel&&e.progress.remove(i);else if(e.fileUploadDivId=a,e.inProgressFiles.push(e.progress.transformModelForDisplay(i)),e.progress.displayResults){e.lastPiesRendered=0;const n=this.interval((()=>{const r=t.find(".progress-circle").length;if(r>e.lastPiesRendered){for(let t=e.lastPiesRendered;t<e.lastPiesRendered+r;t++)e.$root.$broadcast(z,a,t,e.inProgressFiles[t].id,W.ProgressRenderComplete,i.inProgressFileId),this.interval.cancel(n);this.interval.cancel(n)}e.lastPiesRendered=r}),e,100,10)}else e.$root.$broadcast(z,a,e.inProgressFiles.length-1,e.inProgressFiles[e.inProgressFiles.length-1].id,W.ProgressRenderComplete,i.inProgressFileId,e.targetDiv)})),e.$on(z,((t,n,a,i,r,s,o,l)=>{(o&&o===e.targetDiv||i&&i.attr&&i.attr("id")===e.element.attr("id")&&r===W.UpdateProgress)&&e.progress.setProgress(n,a,l,s)})),e.progress.displayResults=!0,e.$watch("::displayResults",(t=>{e.progress.displayResults=t}))}}}b.$inject=["$injector",d.b,c.serviceName],r.module(h,[m.a]).directive("bbProgress",["$injector",e=>e.instantiate(b)]);var f=n("5MwF"),v=n("Vsv2"),y=n("k9iv"),S=n("b2lU"),C=n("A+IJ"),E=n("12mu"),I=n("pjml"),k=n("lEL+"),w=n("hkqm"),T=n("TnpK"),O=n("Q/M7"),A=n("GbAM"),P=n("fYJU"),x=n("jx5I"),$=n("RK4w"),N=n("8jry"),D=n("ByeC"),L=n("Za2G"),j=n("mhLG"),M=n("EN13"),G=n("YCUs"),R=n("ofgY"),B=n("W7eU"),F=n("Tfg2"),U=n("yZnR");n.d(t,"f",(function(){return _})),n.d(t,"e",(function(){return z})),n.d(t,"d",(function(){return q})),n.d(t,"b",(function(){return H})),n.d(t,"a",(function(){return V})),n.d(t,"c",(function(){return W}));const _="ultra.directives.bbFileUpload",z="bbFileUpload",q="thirdPartyFileSelectedEvent",H="fileSelected",V="dismissUploadModalEvent";class W extends o.a{}W.AllUploadsCompleted=new W("allUploadsCompleted"),W.AssignDropTarget=new W("assignDropTarget"),W.Cancel=new W("cancel"),W.CommenceUpload=new W("commenceUpload"),W.ContentCreated=new W("contentCreated"),W.Delete=new W("delete"),W.DeleteContent=new W("deleteContent"),W.Error=new W("error"),W.File=new W("file"),W.FileDrop=new W("fileDrop"),W.Folder=new W("folder"),W.LinkProgress=new W("linkProgress"),W.OutlineAddContentButtonFileSelected=new W("outlineAddContentButtonFileSelected"),W.ProgressRenderComplete=new W("progressRenderComplete"),W.UpdateFileTypes=new W("updateFileTypes"),W.UpdateProgress=new W("updateProgress"),W.Uploaded=new W("uploaded"),W.Uploading=new W("uploading"),W.UploadProgressComplete=new W("uploadProgressComplete");class K extends o.a{constructor(e,t){super(e),this.errorKey=t}getErrorKey(){return this.errorKey}}K.General=new K("generalFileUploadError","components.directives.fileUpload.errorFull"),K.Security=new K("securityFileUploadError","components.directives.fileUpload.errorSecurity");class Y{static generateTempFileId(){return`${Math.floor(1e4*Math.random())}-${Math.floor(1e4*Math.random())}`}}class J{constructor(e,t,n,s,o,l,d,u,m,p,h,g,b,v,y,S,E,I,k){if(this.scope=e,this.element=t,this.attrs=n,this.contextCourseMembership=s,this.bbLocalize=o,this.cloudDrive=l,this.interval=d,this.$modal=u,this.$http=m,this.timeout=p,this.$compile=h,this.Upload=g,this.ultraState=b,this.FileUtilityFactory=v,this.errorModal=y,this.toast=S,this.$q=E,this.contextUser=I,this.$sceService=k,this.aborted=!1,this.alertedUserForFolderIncompatibility=!1,this.fileReviewVisible=!1,this.isMultipleUpload=!1,this.letMeChooseSelected=!1,this.progressVisible=!1,this.successVisible=!1,this.transcludeVisible=!0,this.uploadInProgress=!1,this.isUploadCompleteEventRegistered=!1,this.allowOversizedFiles=!1,this.currentUploadCount=0,this.failedUploadCount=0,this.idCounter=0,this.originalUploadCount=0,this.successfulUploadCount=0,this.allowedFileTypes="",this.allowMultiple=!1,this.hideTranscludeDuringUpload=!0,this.id="",this.isContent=!1,this.monitorLeave=!1,this.useDefaultSuccessMethod=!1,this.isThirdPartyUpload=!1,this.oversizedFiles=[],this.model={fileLocation:null,files:[]},this.uploadingFiles=[],this.uploadsInProgress={},this.cancelUpload=(e,t)=>{const n=this.getUploadingFileIndexById(e,t);this.scope.isThirdPartyUpload&&n>=0?this.uploadingFiles.splice(n,1):this.uploadsInProgress[e]&&n>=0&&(this.abortUpload(e),this.aborted=!0,this.originalUploadCount--,this.resetFileInput(),n>=0&&this.uploadingFiles.splice(n,1),this.allowMultiple&&0!==this.model.files.length||this.hideTranscludeDuringUpload&&(this.fileReviewVisible=!1,this.transcludeVisible=!0)),this.uploadingFiles&&0!==this.uploadingFiles.length||(this.uploadInProgress=!1)},this.updateModel=(e,t,n,a,i)=>{const r=e.mimeType?e.mimeType:n,s=this.fileUtil.calculateSize(t.size),o={fileLocation:e.fileLocation,webLocation:e.webLocation,fileName:e.fileName,currentMimeType:r,fileSize:this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.fileUpload.sizeOutput",params:{label:s.sizeLabel,size:parseFloat(s.size.toFixed(2)).toString()}}),rawFileSize:t.size,isMedia:e.isMedia,uploadDate:this.uploadDate,targetClass:a,ui:{position:i}};return this.allowMultiple?this.model.files.push(o):this.model.files[0]=o,this.model.fileLocation=e.fileLocation,this.currentFileName=o.fileName,o},this.success=(e,t)=>{this.currentUploadCount--,this.model.files=[],this.currentUploadCount<=0&&(this.oversizedFiles.length&&this.openMaxSizeWarning(),this.scope.$root.$broadcast(z,W.AllUploadsCompleted,null,null,null,this.scope.primaryKey&&this.scope.primaryKey())),"/v1/files"===this.attrs.url&&this.useDefaultSuccessMethod&&this.hideTranscludeDuringUpload&&(this.transcludeVisible=!0)},this.displayUploadError=e=>{this.scope.errorModalErrorKey=e?e.getErrorKey():K.General.getErrorKey(),this.modalInstance=this.$modal.open({template:B,scope:this.scope,resolve:{translations:[c.serviceName,e=>e.loadBundle("components/directives/file-upload")]}}),this.modalInstance.result.then((()=>{}),(()=>{this.resetFileInput(),this.hideTranscludeDuringUpload&&(this.transcludeVisible=!0)}))},this.getMoreSupportURL=()=>this.contextCourseMembership.isStudentOrGuestMembership()||this.contextUser.userModel.isStudent()||this.contextUser.userModel.isGuest()?"http://help.blackboard.com/001_563en_US":"http://help.blackboard.com/001_562en_US",this.progress=(e,t,n)=>{this.scope.$root.$broadcast(z,e,t,n,W.UpdateProgress,void 0,this.scope.targetDiv)},this.conductUpload=(e,t,n)=>{let i,r,s=0;if(r=n?this.uploadingFiles.filter((e=>e.id===n))[0]:this.uploadingFiles.filter((t=>t.ui.primaryKey===e.ui.primaryKey))[0],i=e.targetElement?e.targetElement:this.scope.targetElement,this.scope.isThirdPartyUpload){if(e){const n=e;n.ui.index=t,n.ui.position=this.scope.position&&this.scope.position(),n.ui.targetDiv=this.getContentOutlineCloudKey(!0)||this.scope.targetDiv,this.scope.thirdPartyDownloadHandler(n),this.oversizedFiles.length&&this.openMaxSizeWarning()}}else{let n=O.j()+f.a.apiBasePath+"/v1/files?expand=mimeType,isMedia";this.scope.fileLocation&&(n=n+"&fileLocation="+this.scope.fileLocation),this.scope.webLocation&&(n=n+"&webLocation="+this.scope.webLocation),this.scope.extraParams&&(n=n+"&"+a.map(this.scope.extraParams(),((e,t)=>`${encodeURIComponent(t)}=${encodeURIComponent(e)}`)).join("&")),this.uploadsInProgress[r.id]=this.Upload.upload({url:n,method:"POST",headers:{"Content-Type":e.type},data:e.data,file:e.file,fileName:e.fileName}).progress((e=>{s=parseInt((100*e.loaded/e.total).toString(),10),100!==s?r.currentProgress=s:r.currentProgress<100&&(r.currentProgress=99),this.progress(r.id,s,i)})).success(((n,a,i,s)=>{const o=this.interval((()=>{if(100===r.currentProgress||0===r.currentProgress){const a=this.updateModel(n,e.file,e.currentMimeType,e.targetClass,this.scope.position&&this.scope.position());if(a.ui.originFileName=e.fileName,this.success(a,t),this.successfulUploadCount++,this.removeUploadingFile(e),(!this.uploadingFiles||0===this.uploadingFiles.length)&&(this.uploadInProgress=!1,this.failedUploadCount+this.successfulUploadCount===this.originalUploadCount)){let e;e=this.originalUploadCount>1?0===this.failedUploadCount?this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.fileUpload.aria.multipleFiles.uploadSuccessful.plural",params:{filesCount:this.originalUploadCount},noWrap:!0}):this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.fileUpload.aria.multipleFiles.uploadFinished.plural",params:{successfulFilesCount:this.originalUploadCount-this.failedUploadCount,filesCount:this.originalUploadCount},noWrap:!0})+" "+this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.fileUpload.aria.multipleFiles.failedFiles.plural",params:{filesCount:this.failedUploadCount,filenameList:this.bbLocalize.formatItemsSync(this.failedUploadFilenames,this.failedUploadFilenames.length,null,this.scope,!1,{noWrap:!0})},noWrap:!0}):this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.fileUpload.aria.singleFile.uploadSuccessful",noWrap:!0}),this.scope.$root.$broadcast(A.a,e)}a.ui.id=e.id,null!=e.content?this.scope.$root.$broadcast(z,this.scope.fileUploadDivId,e.content,a,W.Uploaded,this.scope.targetDiv,this.isMultipleUpload):this.scope.$root.$broadcast(z,this.scope.fileUploadDivId,a,W.Uploaded,this.scope.targetDiv,this.scope.primaryKey&&this.scope.primaryKey()),this.interval.cancel(o)}}),this.scope,100,5e3,!0)})).error((t=>{if(this.removeUploadingFile(e),this.failedUploadCount++,this.failedUploadFilenames.push(e.fileName),(!this.uploadingFiles||0===this.uploadingFiles.length)&&(this.uploadInProgress=!1,this.failedUploadCount+this.successfulUploadCount===this.originalUploadCount)){let e;e=this.originalUploadCount>1?this.failedUploadCount===this.originalUploadCount?this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.fileUpload.aria.multipleFiles.uploadFailed",noWrap:!0}):this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.fileUpload.aria.multipleFiles.uploadFinished.plural",params:{successfulFilesCount:this.originalUploadCount-this.failedUploadCount,filesCount:this.originalUploadCount},noWrap:!0})+" "+this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.fileUpload.aria.multipleFiles.failedFiles.plural",params:{filesCount:this.failedUploadCount,filenameList:this.bbLocalize.formatItemsSync(this.failedUploadFilenames,this.failedUploadFilenames.length,null,this.scope,!1,{noWrap:!0})},noWrap:!0}):this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.fileUpload.aria.singleFile.uploadFailed",noWrap:!0}),this.scope.$root.$broadcast(A.a,e)}if(this.scope.$root.$broadcast(z,this.scope.fileUploadDivId,e,W.Error,this.scope.targetDiv,this.scope.primaryKey&&this.scope.primaryKey()),this.aborted)this.aborted=!1;else{const e=t&&422===t.status?K.Security:K.General;this.displayUploadError(e)}}))}},this.prepareToUpload=(e,t,n,i)=>{this.resetFileInput();const s=JSON.stringify({fileLocation:this.model.fileLocation});let o=e.type;o||(o=this.unknownMimeType);const l="img-icon-document",c=e.name||e.filename;let d;if(this.scope.isThirdPartyUpload){d={id:e.id,currentMimeType:o,currentProgress:0,data:s,file:e,fileName:c,inProgressFileId:Y.generateTempFileId(),targetClass:l,type:e.type},d.ui=r.copy(e.ui),d.ui?d.ui.primaryKey=this.scope.primaryKey&&this.scope.primaryKey():d.ui={primaryKey:this.scope.primaryKey&&this.scope.primaryKey()},t&&this.isZipFile(c)&&(d.ui.needUnzip=t),d.ui.fileId=e.id,this.uploadingFiles.push(d),this.isUploadCompleteEventRegistered||(this.scope.$on("uploadComplete",((e,t,n)=>{if(a.findIndex(this.uploadingFiles,(e=>t.ui.fileId===e.ui.fileId))>=0){const e=this.getContentOutlineCloudKey(!0,n)||this.scope.targetDiv,a=this.getContentOutlineCloudKey(!1,n)||this.scope.primaryKey&&this.scope.primaryKey();this.scope.$root.$broadcast(z,this.scope.fileUploadDivId,t,W.Uploaded,e,a),this.removeUploadingFile(t)}this.uploadingFiles&&0!==this.uploadingFiles.length||(this.uploadInProgress=!1)})),this.isUploadCompleteEventRegistered=!0);const n=this.getContentOutlineCloudKey(!0)||this.scope.targetDiv,i=this.getContentOutlineCloudKey(!1)||this.scope.primaryKey&&this.scope.primaryKey();this.scope.$root.$broadcast(z,this.scope.fileUploadDivId,d,W.Uploading,n,i)}else d={content:i,currentMimeType:o,currentProgress:0,data:s,file:e,fileName:c,id:Y.generateTempFileId(),progressId:null,targetClass:l,type:e.type},d.ui={primaryKey:this.scope.primaryKey&&this.scope.primaryKey()},this.uploadingFiles.push(d),null!=i?this.scope.$root.$broadcast(z,this.scope.fileUploadDivId,d,W.FileDrop,this.scope.targetDiv):this.scope.$root.$broadcast(z,this.scope.fileUploadDivId,d,W.Uploading,this.scope.targetDiv,this.scope.primaryKey&&this.scope.primaryKey())},this.uploadFiles=(e,t)=>{this.isContent||(this.fileReviewVisible=!0),this.hideTranscludeDuringUpload&&(this.transcludeVisible=!1),e.forEach((n=>{this.isContent?this.isFolder(n).then((e=>{e?(this.scope.$root.$broadcast(z,this.scope.fileUploadDivId,n,W.Folder),this.scope.isChrome||this.alertedUserForFolderIncompatibility||(this.alertedUserForFolderIncompatibility=!0,this.errorModal.handleError(this.browserFolderWarning))):(this.uploadInProgress=!0,this.scope.$root.$broadcast(z,this.scope.fileUploadDivId,n,W.File),this.currentUploadCount++)})):(this.uploadInProgress=!0,this.prepareToUpload(n,t,e.indexOf(n),null))}))},this.calculateSizeInMib=e=>e/1048576,this.openMaxSizeWarning=()=>{this.maxFileSizeScope=this.scope.$new();let e="";const t=this.scope.fileUploadSettings;this.maxFileSizeScope.shouldIncludeSupportLink=""!==t.supportLink,this.maxFileSizeScope.shouldRecommendAltStorageLocations=""!==t.recommendedAlternatives,this.maxFileSizeScope.shouldIncludeSupportLink&&(e=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.fileUpload.maxSizeWarningSupportLinkText",params:{supportLink:t.supportLink},noWrap:!0}),e=this.$sceService.trustAsHtml(e)),this.maxFileSizeScope.maxFileSize=t.maxUploadSizeInBytes,this.maxFileSizeScope.alternateStorage=t.recommendedAlternatives,this.maxFileSizeScope.supportLink=e,this.maxFileSizeScope.closeModal=this.closeModal,this.maxFileSizeScope.calculateSizeInMib=this.calculateSizeInMib,this.maxFileSizeScope.overSizedFiles=this.oversizedFiles,this.oversizedFiles=[],this.modalInstance=this.$modal.open({template:U,scope:this.maxFileSizeScope,resolve:{translations:[c.serviceName,e=>e.loadBundle("components/directives/file-upload")]}})},this.continueCurrentUpload=(e,t)=>{e.length>0&&this.uploadFiles(e,t)},this.uploadEnabled=()=>(this.allowMultiple||this.allowMultipleSelects||0===this.uploadingFiles.length&&0===this.model.files.length)&&!this.scope.isThirdPartyUpload,this.fileUploadClick=()=>{this.uploadEnabled()&&this.element.find(".fileUploadInput").trigger("click",!0)},this.modalCancelUpload=()=>{this.modalInstance.dismiss()},this.addContent=e=>{e&&this.modalInstance.close(e)},this.closeModal=e=>{if(null===e||r.isUndefined(e))return this.modalInstance.close();e?this.modalInstance.close(e):(this.modalInstance.close(e),this.resetFileInput())},this.closeModalAndChooseFiles=()=>{this.closeModal(!0),this.resetFileInput(),this.element.find(".file-upload-container div:first-child").eq(0).click()},this.containsPackageFile=(e,t)=>{t?(this.modalInstance=this.$modal.open({template:G,scope:this.scope,resolve:{translations:[c.serviceName,e=>e.loadBundle("components/directives/file-upload")]}}),this.modalInstance.result.then((t=>{t&&this.continueCurrentUpload(e,t)}),(e=>{this.notifyUploadCancelled(),this.resetFileInput()}))):this.continueCurrentUpload(e)},this.containsZipFile=e=>{0!==e.filter((e=>this.isZipFile(e.name))).length?(this.modalInstance=this.$modal.open({template:F,scope:this.scope,resolve:{translations:[c.serviceName,e=>e.loadBundle("components/directives/file-upload")]}}),this.modalInstance.result.then((t=>{this.continueCurrentUpload(e,t)}),(e=>{this.notifyUploadCancelled(),this.resetFileInput()}))):this.containsPackageFile(e)},this.checkAllowedFileTypesAndValidateFileSizes=e=>{e=this.validateUploadFileSizes(e);const t=this.validateFiles(e);if(!e.length&&this.oversizedFiles.length)return this.openMaxSizeWarning(),this.notifyUploadCancelled(),void this.resetFileInput();t.length!==e.length?(this.validFiles=t,this.modalInstance=this.$modal.open({template:this.disallowedFileTypeErrorTemplate||N,scope:this.scope,resolve:{translations:[c.serviceName,e=>e.loadBundle("components/directives/file-upload")]}}),this.modalInstance.result.then((e=>{this.scope.skipZipFileCheck&&this.scope.skipZipFileCheck()?this.continueCurrentUpload(t,!1):this.containsZipFile(t)}),(e=>{this.notifyUploadCancelled(),this.resetFileInput()}))):this.scope.skipZipFileCheck&&this.scope.skipZipFileCheck()?this.continueCurrentUpload(t,!1):this.containsZipFile(t)},this.removeFoldersIfBreaksDepthLimit=e=>{this.scope.depth&&this.scope.depth()>C.l?this.removeFolders(e,j):this.checkAllowedFileTypesAndValidateFileSizes(e)},this.removeFoldersIfDisallowed=e=>{this.scope.disallowFolderUploads&&this.scope.disallowFolderUploads()?this.removeFolders(e,D):this.removeFoldersIfBreaksDepthLimit(e)},this.removeFolders=(e,t)=>{const n={};this.$q.all(e.map((e=>this.isFolder(e).then((t=>t?n:e))))).then((a=>{const i=a.filter((e=>e!==n));i.forEach((e=>{e.path=null})),i.length!==e.length?(this.scope.hasFiles=0!==i.length,this.modalInstance=this.$modal.open({template:t,scope:this.scope,resolve:{translations:[c.serviceName,e=>e.loadBundle("components/directives/file-upload")]}}),this.modalInstance.result.then((e=>{this.checkAllowedFileTypesAndValidateFileSizes(i)}),(e=>{this.notifyUploadCancelled(),this.resetFileInput()}))):this.checkAllowedFileTypesAndValidateFileSizes(i)}))},this.ensurePlurality=e=>{e.length>1&&!this.allowMultiple?(this.uploadedFiles=e,this.modalInstance=this.$modal.open({template:L,scope:this.scope,resolve:{translations:[c.serviceName,e=>e.loadBundle("components/directives/file-upload")]}}),this.modalInstance.result.then((t=>{const n=i('input[type="radio"][name="fileListing"]:checked').val();this.removeFoldersIfDisallowed([e[n]])}),(e=>{this.notifyUploadCancelled(),this.resetFileInput()}))):this.removeFoldersIfDisallowed(e)},this.onFileSelect=(e,t,n,a,r,s)=>{if(!(s&&(i(s.target).is(".js-no-file-drop")||i(s.target).is(".js-show-add-options"))||e&&e.length&&"Blob"===e[0].constructor.name))if(e.length){let t;this.isMultipleUpload=e.length>1,this.scope.$root.$broadcast(z,this.scope.primaryKey&&this.scope.primaryKey(),W.AssignDropTarget),this.scope.$root.$broadcast(z,this.scope.primaryKey&&this.scope.primaryKey(),W.OutlineAddContentButtonFileSelected),this.setUploadDate(),this.ensurePlurality(e),this.originalUploadCount=e.length,this.failedUploadCount=this.successfulUploadCount=0,this.failedUploadFilenames=[],t=this.originalUploadCount>1?this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.fileUpload.aria.multipleFiles.uploadStarted.plural",params:{filesCount:this.originalUploadCount},noWrap:!0}):this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.fileUpload.aria.singleFile.uploadStarted",noWrap:!0}),this.scope.$root.$broadcast(A.a,t)}else this.throwModalForNonFileUpload()},this.confirmLeaveDuringUpload=(e,t,n)=>{!this.uploadInProgress&&!this.cloudDrive.isGettingFilesInfo||J.isLeaveConfirmModalOpened||(e.preventDefault(),this.modalInstance=this.$modal.open({template:$,scope:this.scope,resolve:{translations:[c.serviceName,e=>e.loadBundle("components/directives/file-upload")]}}),J.isLeaveConfirmModalOpened=!0,this.modalInstance.result.then((e=>{J.isLeaveConfirmModalOpened=!1,this.scope.isThirdPartyUpload||this.abortAllUploads(),this.aborted=!0,this.uploadInProgress=!1,this.uploadingFiles.forEach((e=>{this.scope.$root.$broadcast(z,this.scope.fileUploadDivId,e,W.Cancel,this.scope.targetDiv,this.scope.primaryKey&&this.scope.primaryKey())})),this.ultraState.go(t.name,n)}),(()=>{J.isLeaveConfirmModalOpened=!1,this.scope.$root.$broadcast("$stateChangeAbort",{reason:"ABORTED_BY_FILE_UPLOAD"})})))},this.initialState=this.ultraState.current.name,this.allowMultipleSelects=e.$eval(e.allowMultipleSelects),this.scope.isChrome=/Chrome/.test(navigator.userAgent),this.disallowedFileTypeErrorTemplate=this.scope.disallowedFileTypeErrorTemplate,e.dragClass="drag",e.$on("bb-drag-start",(()=>{e.dragClass=""})),e.$on("file-drag-restore",(()=>{e.dragClass="drag"})),!e.isThirdPartyUpload){if(!n.url)throw new Error("'url' attribute required in file upload");if(this.url=n.url,!n.data)throw new Error("'data' attribute required in file upload")}this.element.find(".file-upload:first").on("click",((e,t)=>{this.scope.clickEnabled&&!this.scope.clickEnabled()||t||this.fileUploadClick()})),["hideTranscludeDuringUpload","useDefaultSuccessMethod","allowedFileTypes","forceReselectDisallowedFiles","allowMultiple","isContent","fileUploadClick","allowOversizedFiles"].forEach((e=>{const t=this.scope.$watch(e,(n=>{null!=n&&(t(),this[e]=n)}))}));const w=this.scope.$watch("targetDiv",(n=>{if(null!=n)w(),this.scope.targetElement=t.find(n),0===this.scope.targetElement.length&&(this.scope.targetElement=i(n));else{this.progressVisible=!0;const n=this.interval((()=>{const e=t.find(".file-upload-panel");e.length>0&&(this.scope.targetElement=e,this.interval.cancel(n))}),e,100,10)}})),T=this.scope.$watch("monitorLeave",(e=>{e&&(this.registerRouterStateChangeEventHandlers(),T())}));this.isThirdPartyUpload=e.isThirdPartyUpload,this.loadTranslations(),this.fileUtil=this.FileUtilityFactory()}getContentOutlineCloudKey(e,t){const n=e?"#progress":"progress",a=t||this.scope.cloudUploadSelectedContentId;if(a)return`${n}${a}`}throwModalForNonFileUpload(){this.modalInstance=this.$modal.open({template:M,scope:this.scope,resolve:{translations:[c.serviceName,e=>e.loadBundle("components/directives/file-upload")]}}),this.modalInstance.result.catch((e=>{this.notifyUploadCancelled(),this.resetFileInput()}))}endsWith(e,t){return e.lastIndexOf(t),e.lastIndexOf(t)===e.length-t.length}getUploadingFileIndexById(e,t){const n=this.uploadingFiles.filter((n=>n.id===e&&this.validateIdentifier(n.inProgressFileId,t)))[0];return this.uploadingFiles.indexOf(n)}isFolder(e){const t=this.$q.defer();if("directory"===e.type)t.resolve(!0);else if(e instanceof Blob){const n=new FileReader;n.onload=()=>{1===n.readyState&&n.abort(),t.resolve(!1)},n.onerror=()=>{this.isLikelyAFile(e)&&(this.displayUploadError(),this.scope.$root.$broadcast(z,this.scope.fileUploadDivId,e,W.Error,this.scope.targetDiv,this.scope.primaryKey&&this.scope.primaryKey()),t.reject()),t.resolve(!0)},n.readAsText(this.sliceFileHelper(e))}else t.resolve(!1);return t.promise}sliceFileHelper(e){return e.slice(0,1)}isZipFile(e){return".zip"===e.substring(e.lastIndexOf(".")).toLowerCase()}isLikelyAFile(e){return"directory"!==e.type&&(""!==e.type||e.size>4096)}loadTranslations(){this.bbLocalize.loadBundle("components/directives/file-upload").then((()=>{this.browserFolderWarning=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.fileUpload.browserFolderWarning"}),this.cancelUploadText=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.fileUpload.cancelUploadText"}),this.unknownMimeType=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.fileUpload.unknownMimeType"}),this.uploaded=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.fileUpload.uploaded"}),this.uploading=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.fileUpload.uploading"})}))}notifyUploadCancelled(){this.scope.$root.$broadcast(z,this.scope.fileUploadDivId,null,W.Cancel,this.scope.targetDiv,this.scope.primaryKey&&this.scope.primaryKey())}removeUploadingFile(e){a.remove(this.uploadingFiles,(t=>t.ui&&e.ui&&t.ui.fileId&&e.ui.fileId?t.inProgressFileId&&e.inProgressFileId?t.ui.fileId===e.ui.fileId&&t.inProgressFileId===e.inProgressFileId:t.ui.fileId===e.ui.fileId:t.inProgressFileId&&e.inProgressFileId?e&&t.fileName===e.fileName&&t.inProgressFileId===e.inProgressFileId:e&&t.fileName===e.fileName)),delete this.uploadsInProgress[e.id]}resetFileInput(){const e=i(document.body).find(".fileUploadInput");for(let t=0;t<e.length;t++){e.eq(t)[0].value=""}}registerRouterStateChangeEventHandlers(){this.scope.$on("$stateChangeStart",((e,t,n,a,i)=>{a.name===t.name||t.name===this.initialState||this.isStateIgnored(a,t)||this.confirmLeaveDuringUpload(e,t,n)}))}isStateIgnored(e,t){if(this.scope.ignoredStates&&this.scope.ignoredStates())for(const n of this.scope.ignoredStates())if(e.name.indexOf(n)>=0||t.name.indexOf(n)>=0)return!0;return!1}setUploadDate(){this.bbLocalize.formatDatetime(new Date,c.ILocaleDatetimeFormat.Short).then((e=>{this.uploadDate=e}))}validateFiles(e){if(""===this.allowedFileTypes)return e;let t=[],n=!1;this.allowedFileTypes.indexOf("/")>0?(n=!0,t[0]=this.allowedFileTypes.substr(0,this.allowedFileTypes.indexOf("/")),t[1]=this.allowedFileTypes.substr(this.allowedFileTypes.indexOf("/")+1)):t=this.allowedFileTypes.toLowerCase().split(",");const a=[];for(let i=0;i<e.length;i++){const r=e[i];if(n){const e=[];e[0]=r.type.substr(0,this.allowedFileTypes.indexOf("/")),e[1]=r.type.substr(this.allowedFileTypes.indexOf("/")+1),t[0]!==e[0]||t[1]!==e[1]&&"*"!==t[1]||a.push(r)}else for(let e=0;e<t.length;e++)if("."!==t[e].charAt(0)&&(t[e]="."+t[e]),this.endsWith(r.name.toLowerCase(),t[e])){a.push(r);break}}return a}validateUploadFileSizes(e){if(this.currentUploadCount=0,this.oversizedFiles=[],this.allowOversizedFiles)return e;const t=this.scope.fileUploadSettings.maxUploadSizeInBytes;return this.oversizedFiles=e.filter((e=>e.size>t)),e.filter((e=>e.size<=t))}abortUpload(e){this.uploadsInProgress[e].abort(),delete this.uploadsInProgress[e]}abortAllUploads(){Object.keys(this.uploadsInProgress).forEach((e=>this.abortUpload(e)))}validateIdentifier(e,t){return!e||!t||e===t}}J.isLeaveConfirmModalOpened=!1;class Z{constructor(e,t,n,a,i,r,s,o,l,c,d,u,m,p,h,g,b){this.contextCourseMembership=e,this.bbLocalize=t,this.cloudDrive=n,this.$modal=a,this.$http=i,this.interval=r,this.timeout=s,this.$compile=o,this.Upload=l,this.ultraStateService=c,this.FileUtilityFactory=d,this.errorModal=u,this.toast=m,this.$q=p,this.contextUser=h,this.fileUploadSettingsService=g,this.$sceService=b,this.replace=!1,this.transclude=!0,this.restrict="E",this.template=R,this.scope={allowedFileTypes:"@",allowMultiple:"=",allowMultipleSelects:"@",cancelUpload:"=",clickEnabled:"&?",confirmLeaveDuringUpload:"=",closeModal:"=",closeModalAndChooseFiles:"@",delete:"=",disableDrag:"&?",disallowFolderUploads:"&?",extensions:"=",cloudUploadSelectedContentId:"<?",fileUploadClick:"=",forceReselectDisallowedFiles:"&?",hideTranscludeDuringUpload:"=",isContent:"=",improperAmountOfFilesUpload:"=",isThirdPartyUpload:"=?",primaryKey:"&?",modalCancelUpload:"=",monitorLeave:"=",onFileSelect:"=",position:"&?",showUnzippedSelection:"=",skipZipFileCheck:"&?",targetDiv:"@",thirdPartyDownloadHandler:"=",uploadUnzippedFiles:"=",unzippedFileSelection:"=",uploadEnabled:"=",useDefaultSuccessMethod:"=",fileLocation:"@?",webLocation:"@?",ignoredStates:"&?",extraParams:"&?",depth:"&?",initialUpload:"=?",disallowedFileTypeErrorTemplate:"@?",allowOversizedFiles:"<?"},this.link=(e,t,n,a)=>{e.fileUploadDivId=`fileUploadDiv-${Y.generateTempFileId()}`,e.targetElement=t.find(".file-upload-panel"),e.fileUpload=new J(e,t,n,this.contextCourseMembership,this.bbLocalize,this.cloudDrive,this.interval,this.$modal,this.$http,this.timeout,this.$compile,this.Upload,this.ultraStateService,this.FileUtilityFactory,this.errorModal,this.toast,this.$q,this.contextUser,this.$sceService),e.$on(q,((t,n,a)=>{t.stopPropagation&&t.stopPropagation(),a&&a===(e.primaryKey&&e.primaryKey())&&e.fileUpload.onFileSelect(n),e.$emit(H,n,a)})),e.$on(V,(()=>{e.fileUpload.modalInstance&&e.fileUpload.modalInstance.dismiss()})),e.$on(z,((t,n,a,i,r,s,o,l)=>{if(n===e.fileUploadDivId)if(r===W.Cancel)e.fileUpload.cancelUpload(i,s);else if(r===W.ProgressRenderComplete)"number"==typeof a&&e.fileUpload.conductUpload(e.fileUpload.uploadingFiles.filter((t=>t.id===i&&e.fileUpload.validateIdentifier(t.inProgressFileId,s)))[0],a,i);else if(r===W.UploadProgressComplete){const t=e.fileUpload.uploadingFiles.filter((t=>t.id===i&&e.fileUpload.validateIdentifier(t.inProgressFileId,s)))[0];t&&(t.currentProgress=100)}})),e.$on(z,((n,a,i,r,s)=>{a===(e.primaryKey&&e.primaryKey())&&s===W.UpdateFileTypes&&(e.fileUpload.allowedFileTypes=i,t.find("input").attr("accept",i),r())})),e.$on(z,((t,n,a,i)=>{n===e.fileUploadDivId&&a&&a.fileName&&i===W.ProgressRenderComplete&&e.fileUpload.conductUpload(a,0,a.id)})),e.$on(z,((t,n,a,i)=>{if(n===e.fileUploadDivId&&i===W.ContentCreated){const t=this.interval((()=>{e.fileUpload.prepareToUpload(a.ui.file,!1,0,a),this.interval.cancel(t)}),e,100,20)}})),e.$on(z,((t,n,a,i,r,s)=>{if(n===e.fileUploadDivId&&s===W.LinkProgress)for(let t=0;t<e.fileUpload.uploadingFiles.length;t++)a.content?e.fileUpload.uploadingFiles[t].fileName===a.fileName&&e.fileUpload.uploadingFiles[t].file.path===a.file.path&&e.fileUpload.uploadingFiles[t].id===a.id&&(e.fileUpload.uploadingFiles[t].progressId=a.content.ui.fileUploadId,e.$root.$broadcast(z,e.fileUploadDivId,a,W.CommenceUpload)):e.fileUpload.uploadingFiles[t].fileName===a.fileName&&e.fileUpload.uploadingFiles[t].file.path===a.file.path&&e.fileUpload.uploadingFiles[t].id===a.id&&null==e.fileUpload.uploadingFiles[t].progressId&&(e.fileUpload.uploadingFiles[t].progressId=e.fileUpload.isContent?null:i,e.fileUpload.uploadingFiles[t].targetElement=r,e.$root.$broadcast(z,e.fileUploadDivId,a,W.CommenceUpload))})),e.fileUploadSettings=this.fileUploadSettingsService.getSettings(),e.initialUpload&&e.fileUpload.uploadFiles([e.initialUpload],!1)}}}Z.$inject=[l.d,c.serviceName,v.b,E.b,"$http",d.b,k.b,"$compile","Upload",T.d,S.b,y.c,w.b,"$q",P.b,x.b,"$sce"],r.module(_,["ngFileUpload",l.a,c.moduleName,v.a,d.a,E.a,I.N,S.c,k.a,h,y.b,w.a,T.b,x.a]).directive(z,["$injector",e=>e.instantiate(Z)])},P2dS:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return m})),n.d(t,"a",(function(){return p}));var a=n("D57K"),i=n("nsO7"),r=n("Llzl"),s=n("pjml"),o=n("aHpC"),l=n("jhBu"),c=n("ZQFV"),d=n("zGdY");const u="ultra.components.services.gradebookColumnCategory.Service",m="gradeColumnCategoryService";let p=class e{constructor(e,t,n,a){this.$q=e,this.$rootScope=t,this.entitlementService=n,this.CourseModel=a,this.categoriesByCourse={}}getIconByGradebookCategory(t,n){let a=null;return null!=t&&(!1!==n&&t!==d.W.Attendance||t in e.ICON_NAME_BY_CATEGORY_TITLE&&(a=e.ICON_NAME_BY_CATEGORY_TITLE[t]),a||(a=e.DEFAULT_ICON_FOR_CATEGORY)),a}getCategoryIcon(t){let n=e.DEFAULT_ICON_FOR_CATEGORY;return t&&t.title&&(n=this.getIconByGradebookCategory(t.title,t.isUserDefined)),n}loadGradeCategories(e){return this.CourseModel.$new(e).gradebook.categories.$fetch().$asPromise()}getOrLoadCategoriesForCourse(e,t){if((t||!this.categoriesByCourse[e])&&this.userCanViewGradebookCategories(e))return this.loadGradeCategories(e).then((t=>(this.reorderCategories(t,0),this.categoriesByCourse[e]=t,t)));const n=this.$q.defer();return n.resolve(this.categoriesByCourse[e]),n.promise}userCanViewGradebookCategories(e){return this.entitlementService.isEntitled(c.q.ViewUserGrades,e)||this.entitlementService.isEntitled(c.q.ViewGradebookMetaData,e)}getFilteredCategoriesForCourse(e,t){return this.getOrLoadCategoriesForCourse(e,!0).then((e=>i.filter(e,t)))}updateCategoriesForCourse(e,t){if(this.categoriesByCourse[e]){const n=this.categoriesByCourse[e],a=i.findIndex(n,(e=>e.id===t.id));-1===a?n.splice(0,0,t):n.splice(a,1,t)}}deleteCategoriesForCourse(e,t){if(this.categoriesByCourse[e]){const n=this.categoriesByCourse[e],a=i.findIndex(n,(e=>e.id===t.id));a>-1&&n.splice(a,1)}}reorderCategories(e,t){const n=e.length;for(let a=t;a<n;++a){const t=e[a];t.isUserDefined&&(e.splice(a,1),e.unshift(t))}}};p.DEFAULT_ICON_FOR_CATEGORY="custom-item",p.ICON_NAME_BY_CATEGORY_TITLE=Object.freeze({[d.W.Assignment]:"assignment",[d.W.Attendance]:"attendance",[d.W.Blog]:"blog",[d.W.Discussion]:"discussion",[d.W.Exam]:"exam",[d.W.Homework]:"homework",[d.W.Journal]:"journal",[d.W.Presentation]:"presentation",[d.W.Quiz]:"quiz",[d.W.Survey]:"survey",[d.W.Test]:"test"}),p=Object(a.a)([Object(a.c)(0,Object(o.b)("$q")),Object(a.c)(1,Object(o.b)("$rootScope")),Object(a.c)(2,Object(o.b)(l.b)),Object(a.c)(3,Object(o.b)(s.m.serviceName))],p);r.module(u,[l.a]).service(m,p)},P43K:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n("Llzl"),i=n("w9Zy"),r=n("TnpK"),s=n("fYJU"),o=n("pjml"),l=n("qhd3"),c=n("nmzr");const d="ultra.features.base.profile.update.basicProfile.routes";a.module(d,["ui.router",i.d,o.N,r.b]).config([r.c,e=>{e.peekState(c.D.UPDATE_PROFILE_PEEK,{url:"/update?focusField",require:()=>Promise.all([n.e(43),n.e(78),n.e(97),n.e(719)]).then(n.bind(null,"SqGJ")),pageTitle:"base.profile.update.sectionTitle",resolve:{currentUser:[l.serviceName,s.b,(e,t)=>e.$find(t.userId).$asPromise()]}}).peekState(c.D.UPDATE_LANGUAGE_PEEK,{url:"/language",require:()=>n.e(673).then(n.bind(null,"Upnn")),pageTitle:"base.profile.updateLanguage.pageTitle",resolve:{currentUser:[l.serviceName,s.b,(e,t)=>e.$find(t.userId).$asPromise()]}})}])},PCGa:function(e,t,n){},PIPc:function(e,t){e.exports='\x3c!-- this button is for screenreader users only and should be placed at the end of an infinite scroll list in the DOM so that they know that more items can be loaded --\x3e\n<button class="sr-only load-more-items"\n        ng-click="infiniteScroll.loadMoreItems()"\n        tabindex="-1"\n        ng-disabled="infiniteScroll.disabled || infiniteScroll.remainingCount <= 0"\n        bb-load-bundle="components/directives/infinite-scroll"\n        bb-translate translate-values="infiniteScroll.loadMoreLocalizationValues"\n        analytics-id="{{::infiniteScroll.localizationKeysPrefix + \'.loadMoreButton.label.plural\'}}">{{::infiniteScroll.localizationKeysPrefix + \'.loadMoreButton.label.plural\'}}</button>\n'},PSJS:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"MessageLifeCycleEnum",(function(){return c})),n.d(t,"MessageType",(function(){return d})),n.d(t,"serviceName",(function(){return u}));var a=n("nbDY"),i=n.n(a),r=n("yCC5"),s=n("Rjd/"),o=n("nkTj"),l=n("z6Q5");class c extends i.a{}c.Published=new c("PUBLISHED"),c.Deleted=new c("DELETED"),c.Drafted=new c("DRAFT");class d extends i.a{next(){let e=parseInt(this.toString(),10)+1;const t=d.getKeys();return t.length<e&&(e=t.length-1),d[t[e]]}}d.Discussion=new d("0"),d.Comment=new d("1"),d.Reply=new d("2"),d.ClassConversation=new d("3");const u=r.P;s.a.factory(u,["restmod","$q",o.c,l.b,(t,n,a,i)=>t.model().mix({replies:{mask:!0},parent:{mask:!0},states:{hasOne:r.F},discussion:{mask:!0},type:{mask:!0},isAvailable:{mask:!0},user:{mask:!0},lastUpdateUser:{mask:!0},ui:{mask:!0,init:()=>({isEdit:!1})},postDate:{serialize:"date"},editDate:{serialize:"date"},"gradedColumn.dueDate":{serialize:"date"},$hooks:{"after-fetch-many":function(){"messages"===this.$scope.$partial&&this.forEach((e=>{e.type=d.Discussion,e.parent=e,e.discussion=e,e.states.readStateInd=e.messageStatus.isRead}))},"after-destroy":function(e){e.data&&this.$unwrap(e.data)}},$extend:{Record:{getReplies(e,t){if(t&&0===this.messageStatus.numberOfChildren)return this.replies=this.$scope.$collection(),this.replies.$asPromise=()=>n((e=>e(this.replies))),this.replies;const a=this;return this.$scope.$collection().$send({method:"GET",url:this.$scope.$url()+"/"+this.id+"/replies",params:{sort:e.sort,limit:e.limit,offset:e.offset,userId:e.userId,groupId:e.groupId,messageLifecycle:e.messageLifecycle}},(function(e){this.$unwrap(e.data),a.replies=this,a.ui.count=e.data.paging.count,this.forEach((e=>{e.type=a.type.next(),e.parent=a,e.discussion=a.discussion,e.states.readStateInd=e.messageStatus.isRead}))}))},saveReply(t,n={}){const a=this.$scope.$url()+"/"+this.id+"/replies?"+e.param(n);return this.$scope.$build().$send({method:"POST",url:a,data:t.$wrap()},(function(e){this.$unwrap(e.data),this.replies=this.$scope.$collection()}))},getRepliesCount(t={}){const n=this.$scope.$url()+"/"+this.id+"/replies/count?"+e.param(t),a=this;return this.$scope.$build().$send({method:"GET",url:n},(function(e){a.ui.count=e.data.count}),(function(){a.ui.count=0}))},updateMessageStatus(t,n={}){const a=this.$scope.$url()+"/"+this.id+"/states?"+e.param(n);return this.$scope.$build().$send({method:"PATCH",url:a,data:t.$wrap()},(function(e){return this.states=this.$unwrap(e.data),this.states}),(function(e){400===e.status||e.$response&&e.$response.status}))},copy(e){Object.getOwnPropertyNames(e).filter((e=>"$"!==e[0])).forEach((t=>{this[t]=e[t]}))}},Collection:{batchGetReplies(e){let t="?";e&&Object.keys(e).forEach((n=>{t+=n,t+="="+e[n]+"&"}));const a=n.defer(),r=[],s=t=>{const a=n.defer();return i.performBatch((()=>{n.all(t.map((t=>t.getReplies(e,!0).$asPromise()))).then(a.resolve)})),a.promise.then((e=>(e.forEach(((e,n)=>{const a=t[n];e.forEach((e=>{e.type=a.type.next(),e.parent=a,e.discussion=a.discussion,e.states.readStateInd=e.messageStatus.isRead,r.push(e)}))})),r)))};return s(this).then(s).then(a.resolve),a.promise}}}})])}.call(this,n("71td"))},PZ5L:function(e,t){e.exports='<bb-modal id="notification-modal-api-error"\n          class="notification"\n          modal-title-key="components.services.error-modal.error-course-not-found.title"\n          analytics-id-tag-prefix="components.services.error-modal">\n  <div name="modal-contents">\n    <p bb-translate>components.services.error-modal.error-course-not-found.description</p>\n    <pre>{{ response | json }}</pre>\n  </div>\n  \x3c!-- htmlhint:analytics-id:disable --\x3e\n  <button name="modal-footer-button-primary"\n          ng-click="$parent.$dismiss()"\n          class="button js-primary-button"\n          bb-translate\n          analytics-id="components.services.error-modal.dismiss.button"\n  >\n    components.services.error-modal.dismiss\n  </button>\n  \x3c!-- htmlhint:analytics-id:enable --\x3e\n</bb-modal>'},PdQf:function(e,t,n){"use strict";var a;n.d(t,"a",(function(){return a})),n.d(t,"n",(function(){return s})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return l})),n.d(t,"e",(function(){return c})),n.d(t,"g",(function(){return d})),n.d(t,"m",(function(){return u})),n.d(t,"c",(function(){return m})),n.d(t,"i",(function(){return p})),n.d(t,"h",(function(){return h})),n.d(t,"j",(function(){return g})),n.d(t,"k",(function(){return b})),n.d(t,"l",(function(){return f})),n.d(t,"f",(function(){return v})),function(e){e.AllCourseMembers="allCourseMembers",e.AllCourseInstructors="allCourseInstructors",e.AllCourseStudents="allCourseStudents"}(a||(a={}));const i={[a.AllCourseMembers]:"all",[a.AllCourseInstructors]:"rolebucket:TEACHING",[a.AllCourseStudents]:"rolebucket:TAKING"},r={all:a.AllCourseMembers,"rolebucket:TEACHING":a.AllCourseInstructors,"rolebucket:TAKING":a.AllCourseStudents},s=Array.from(Object.keys(i));function o(){return i[a.AllCourseMembers]}function l(){return i[a.AllCourseInstructors]}function c(){return i[a.AllCourseStudents]}function d(e,t,n){let a="",r="";return e&&t&&n&&(r=i[n.split(".").pop()],a=t.translateSync({locale:t.getLocale(e),key:n,noWrap:!0,noEscape:!0})),{id:r,givenName:a,familyName:"",userName:void 0}}function u(e,t,n){const a=[];return null==e||e.forEach((e=>{s.indexOf(e.split(".").pop())>=0&&a.push(d(t,n,e))})),a}function m(){return{id:o(),givenName:"",familyName:"",userName:void 0}}function p(e){return(null==e?void 0:e.id)===o()}function h(e){return(null==e?void 0:e.id)===l()}function g(e){return(null==e?void 0:e.id)===c()}function b(e){return p(e)||h(e)||g(e)}function f(e){return Object.values(a).includes(e)}function v(e){return r[e]}},PqsU:function(e,t){e.exports='<bb-modal id="notification-modal-api-error"\n          class="notification"\n          modal-title-key="components.services.error-modal.error-conflict.title"\n          analytics-id-tag-prefix="components.services.error-modal">\n  <div name="modal-contents">\n    <p bb-translate>components.services.error-modal.error-conflict.description</p>\n    <bb-session-debug-modal-button></bb-session-debug-modal-button>\n  </div>\n  <button name="modal-footer-button-primary"\n          ng-click="$parent.$dismiss()"\n          class="button js-primary-button"\n          analytics-id="components.services.error-modal.dismiss"\n          bb-translate>components.services.error-modal.dismiss</button>\n</bb-modal>\n'},Q74M:function(e,t,n){"use strict";var a;!function(e){e.ViewAdmin="system.admin.VIEW",e.ViewAdminTop="system.administration.top.VIEW",e.ViewAdminSupportPanel="system.admin.support.panel.VIEW",e.ModifyCustomCss="system.ultra.customCSS.MODIFY",e.ViewBrands="system.portaloptions.brand.VIEW",e.CreateBrand="system.portaloptions.brand.CREATE",e.ModifyBrand="system.portaloptions.brand.MODIFY",e.DeleteBrand="system.portaloptions.brand.DELETE"}(a||(a={})),t.a=a},QaOk:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return r}));var a=n("Llzl"),i=n("+4Px");const r="ultra.directives.accessibility.arrowKeyNavigation",s="bb-arrow-key-container",o="bb-arrow-key-destination",l="["+s+"]",c="["+o+"]";class d{constructor(t){this.$parse=t,this.restrict="A",this.link=(t,n,a)=>{const r=this.$parse(a.bbArrowKeyNavigation)(null);if("rows"!==r.layout&&"columns"!==r.layout&&"both"!==r.layout)throw new Error("bb-arrow-key-navigation directive is missing or has an invalid layout specified");if(r.tabDirection&&"vertical"!==r.tabDirection&&"horizontal"!==r.tabDirection)throw new Error("bb-arrow-key-navigation directive has an invalid tabDirection specified");n.on("keydown",(t=>{const a=e(t.target);let s=t.keyCode;r.tabDirection&&s===i.u&&("vertical"===r.tabDirection?s=t.shiftKey?i.v:i.d:"horizontal"===r.tabDirection&&(s=t.shiftKey?i.j:i.s)),"rows"===r.layout&&(s=this.rotateKeyCode(s)),r.upEqualsLeft&&(s=this.upEqualsLeftKeyCode(s));this.navigate(a,n,s,r.wrap,r.explicit)&&(this.body.removeClass("hide-focus-outline"),t.preventDefault(),t.stopPropagation())})),t.$on("$destroy",(()=>{n.off()}))},this.body=e("body")}navigate(e,t,n,a,r){let d;switch(n){case i.v:if(r){const n=parseInt(e.closest(l).attr("bb-arrow-key-container"),10),i=t.find(this.containerWithValue(n)).find(c).filter(":visible"),r=i.index(e.closest(c));"0"===e.attr("tabindex")||0===r&&!a||(d=i.eq(r-1))}else d=e.closest(c).prev(c),!d.length&&a&&(d=e.closest(l).find(c).last());break;case i.d:if(r){const n=e.closest(l).attr("bb-arrow-key-container"),i=t.find(this.containerWithValue(n)).find(c).filter(":visible"),r=i.index(e.closest(c));d=i.eq(r+1),!d.length&&a&&(d=i.first())}else d=e.closest(c).next(c),!d.length&&a&&(d=e.closest(l).find(c).first());break;case i.j:if(r){const n=parseInt(e.closest(l).attr(s),10),a=e.closest(c).attr(o);d=t.find(this.containerWithValue(n-1)).find(this.destinationWithValue(a)).first()}else{const t=e.closest(c).prevAll(c).length,n=this.getPreviousContainer(e).find(c);n.length?d=n.eq(t).add(n.last()).first():a&&t>0&&(d=e.closest(l).nextAll(l).last().find(c).eq(t))}break;case i.s:if(r){const n=parseInt(e.closest(l).attr(s),10),a=e.closest(c).attr(o);d=t.find(this.containerWithValue(n+1)).find(this.destinationWithValue(a)).first()}else{const t=e.closest(c).prevAll(c).length,n=this.getNextContainer(e).find(c);n.length?d=n.eq(t).add(n.last()).first():a&&(d=e.closest(l).prevAll(l).last().find(c).eq(t))}}return!(!d||!d.length)&&(d.focus(),!0)}containerWithValue(e){return"["+s+'="'+e+'"]'}destinationWithValue(e){return"["+o+'="'+e+'"]'}getPreviousContainer(e){return e.closest(l).prevAll(l).first()}getNextContainer(e){return e.closest(l).nextAll(l).first()}rotateKeyCode(e){switch(e){case i.v:return i.j;case i.d:return i.s;case i.j:return i.v;case i.s:return i.d}}upEqualsLeftKeyCode(e){switch(e){case i.j:return i.v;case i.s:return i.d;default:return e}}}d.$inject=["$parse"],a.module(r,[]).directive("bbArrowKeyNavigation",["$injector",e=>e.instantiate(d)])}).call(this,n("71td"))},Qbdf:function(e,t,n){"use strict";var a=n("D57K"),i=n("pjml"),r=n("yC9S"),s=n("ZzR9"),o=n("nsO7"),l=n("zGdY");class c{constructor(){this._cache={},this.hookUserModel=o.once((e=>{const t=this;return this.offHookUserModelFunc||(this.offHookUserModelFunc=e.$mixHook("after-feed",(function(){t.cache(this.id,this)}))),this.offHookUserModelFunc}))}destroy(){this._cache={},this.offHookUserModel()}miss(e){return e.filter((e=>!(e in this._cache)))}hit(e){const t=[].concat(e),n=this.miss(t);return o.isEmpty(n)}get(e,t){const n=this._cache[e];return!n&&t?t:n}invalidate(e){delete this._cache[e]}cache(e,t){e&&t&&!t.isPlaceHolder&&(this._cache[e]=t)}fetchUsers(e,t,n){const a=n.defer(),i=this.miss([].concat(e));return o.isEmpty(i)?a.resolve(this):(this.offHookUserModelFunc||this.hookUserModel(t),t.findMany(i,{},[l.S.NotFound]).$then((e=>{a.resolve(this)}))),a.promise}offHookUserModel(){this.offHookUserModelFunc&&(this.offHookUserModelFunc(),this.offHookUserModelFunc=void 0)}}class d extends c{constructor(e){super(),this.courseId=e}}var u=n("aHpC"),m=n("qhd3"),p=n("vYaK"),h=n("0JpG"),g=n("x+T+"),b=n("lVRt"),f=n("PZ5L");n.d(t,"b",(function(){return v})),n.d(t,"e",(function(){return y})),n.d(t,"c",(function(){return S})),n.d(t,"a",(function(){return C})),n.d(t,"d",(function(){return E}));const v="ultra.service.course-context.course",y="currentCourseModel",S=y+"Provider",C=v+"."+y+".changed",E=b.c;let I=class{constructor(e,t,n,a,i,o){this.$q=e,this.$rootScope=t,this.bbLocalize=n,this.entitlementCache=a,this.CourseModel=i,this.UserModel=o;const l=this;r.b.OnRootScope(t,s.b.$stateHasCourseInContextChanged,((e,t,n)=>{n&&!t&&l.clear()}))}get courseId(){return this._courseId}get course(){return this._courseModel}get usersCache(){return this._usersCache}load(e){return e?e&&this.courseId===e&&this.course?this.course.$asPromise():this.loadCourse(e).then((t=>this.$q.all([this.loadLocalizationBundle(t),this.entitlementCache.loadCourseEntitlements(e)]).then((()=>(this.update(e,t),this._courseModel)))),(e=>this.$q.reject(Object.assign(e||{},{goToBasePage:!0})))):this.$q.when(null)}loadCourse(e){return this.CourseModel.$find(e,{expand:"instructorsMembership, instructorsMembership.courseRole, effectiveAvailability, isChild"}).$allow([404]).$asPromise().then((t=>{const n=t.$response;if(n&&404===n.status){const t=new Error("Course "+e+" not found");return Object.assign(t,{goToBasePage:!0,errorModalConfig:{response:n,template:f}}),this.$q.reject(t)}return t}))}loadLocalizationBundle(e){let t;return t=e.isClassic()||!e.locale?this.bbLocalize.getLocale(this.$rootScope):e.locale,this.$q.all([this.bbLocalize.loadLocale(t),this.bbLocalize.loadBundle("features/course/course",t)])}clear(){this.update(null,null)}update(e,t){const n=this.courseId,a=this.course;this._courseId=e,this._courseModel=t,this._usersCache&&this._usersCache.courseId!==e&&(this._usersCache.destroy(),this._usersCache=null),e&&(this._usersCache=new d(e),this._usersCache.hookUserModel(this.UserModel)),this.$rootScope.$broadcast(C,{id:e,model:t},{id:n,model:a})}refreshStudentPreviewStatus(){return this._courseModel.studentPreview.$fetch()}};I=Object(a.a)([Object(a.c)(0,Object(u.b)("$q")),Object(a.c)(1,Object(u.b)("$rootScope")),Object(a.c)(2,Object(u.b)(h.serviceName)),Object(a.c)(3,Object(u.b)(g.c)),Object(a.c)(4,Object(u.b)(p.serviceName)),Object(a.c)(5,Object(u.b)(m.serviceName))],I);const k=[i.N,h.moduleName,g.b];angular.module(v,k).provider(y,class{constructor(){this.$get=["$injector",e=>e.instantiate(I)],this.name=E,this.resolve=["$state",y,(e,t)=>{const n=e.nextParams.courseId;return t.load(n)}]}})},RDfZ:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return p}));n("yDoS");var a=n("Llzl"),i=n("Qbdf"),r=n("0JpG"),s=n("pjml"),o=n("lEL+"),l=n("TnpK"),c=n("oNH7"),d=n("H+SH"),u=n("CPVT"),m=n("eQBN");const p="ultra.directives.conversionStatusBar";class h{constructor(t,n,a,i,r,s,o,l,c){this.$scope=t,this.$rootScope=n,this.$q=a,this.$modal=i,this.CourseModel=r,this.ultraState=s,this.contextCourse=o,this.bbLocalize=l,this.timeout=c,this.displayGuidanceBackToClassic=!1,this.identifyCourse().then((e=>{this.course=e,this.courseId=this.course.id,this.showStatusBar=!1,this.course.canConvert()&&(this.showStatusBar=this.course.isUltraPreview())})),t.$on("confirmNewExperience",(()=>{this.useTheNewExperience()})),t.$on(m.a,((e,t)=>{this.inPreview=t,this.updateStatusClass(),this.showStatusBar=this.course.isUltraPreview()})),t.$on("$stateChangeSuccess",(()=>{this.updateStatusClass()})),t.$on("$destroy",(()=>{e("body").removeClass("has-conversion-status-bar")}))}get showStatusBar(){return this._showStatusBar}set showStatusBar(e){const t=this._showStatusBar;this._showStatusBar=e,t!==e&&this.updateStatusClass()}updateStatusClass(){!this.showStatusBar||this.hideStatusBar()||this.inPreview?e("body").removeClass("has-conversion-status-bar"):e("body").addClass("has-conversion-status-bar")}identifyCourse(){return this.courseId=this.$scope.courseId?this.$scope.courseId:this.contextCourse.courseId,this.$scope.$parent.course?this.$scope.$parent.course.model.$asPromise():this.CourseModel.$find(this.courseId).$asPromise()}useTheNewExperience(){this.course.setUltraStatusDecided().then((()=>{this.showStatusBar=!1,this.$rootScope.$broadcast("reloadCourse",this.courseId)}))}backToClassic(){this.course.undoCourseConversion().then((e=>{const t=e.$response;if(200===t.status)this.ultraState.transitionTo(this.course.getBaseRoute()),this.$rootScope.$broadcast("convertToClassicCourse",this.course.id);else if(400===t.status||404===t.status){this.$modal.open({template:d,scope:this.$scope,resolve:{translations:[r.serviceName,e=>e.loadBundle("features/course/outline/course-outline")]}}).result.then((()=>{this.ultraState.transitionTo(this.course.getBaseRoute())}))}}))}hideStatusBar(){return(this.ultraState.current.name.match(/\.peek\./g)||[]).length>1}}h.$inject=["scope","$rootScope","$q","$modal",s.m.serviceName,l.d,i.e,r.serviceName,o.b];class g{constructor(e){this.$injector=e,this.restrict="E",this.template=c,this.scope={courseId:"@?"},this.link=e=>{e.conversionStatusBarController=this.$injector.instantiate(h,{scope:e})}}}g.$inject=["$injector"],a.module(p,[i.b,r.moduleName,s.N,l.b,o.a,u.a]).directive("bbConversionStatusBar",["$injector",e=>e.instantiate(g)])}).call(this,n("71td"))},"RJ/U":function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n("Llzl"),i=n("0JpG"),r=n("TnpK"),s=n("Qbdf"),o=n("nmzr");const l="ultra.course.question-banks.routes";a.module(l,[i.moduleName,r.b,s.b]).config([r.c,s.c,(e,t)=>{e.peekState(o.F.QUESTION_BANKS,{url:"/banks",resolve:{[s.d]:t.resolve,translations:[i.serviceName,e=>e.loadBundle("features/course/question-banks/question-banks")]},peekStates:[o.F.IMPORT_DETAILS,o.F.EDIT_QUESTION_BANK],peekViewName:"question-banks-peek",panelClass:"full",require:()=>n.e(594).then(n.bind(null,"lXpl")),pageTitle:"course.question-banks.pageTitle"}).peekState(o.F.IMPORT_DETAILS,{url:"/importDetails/{taskId:_[0-9]+_1}",require:()=>n.e(635).then(n.bind(null,"zGGy")),pageTitle:"course.question-banks.import-details.pageTitle"}).peekState(o.F.EDIT_QUESTION_BANK,{url:"/editBank/{assessmentId}?isNew",peekViewName:"question-bank-edit-peek",panelClass:"full",require:()=>Promise.all([n.e(3),n.e(13),n.e(12),n.e(669)]).then(n.bind(null,"Ryyg")),pageTitle:"course.question-banks.edit-question-bank.pageTitle"})}])},RK4w:function(e,t){e.exports='<bb-modal id="close-without-saving-modal" class="notification"\n          modal-title-key="components.directives.fileUpload.closeDuringUploadTitle"\n          analytics-id-tag-prefix="components.directives.fileUpload">\n  <div name="modal-contents">\n    <p>\n      <bb-translate>components.directives.fileUpload.closeDuringUploadInstructions</bb-translate>\n    </p>\n  </div>\n  <button name="modal-footer-button-primary" class="button js-primary-button" ng-click="fileUpload.closeModal()" analytics-id="components.directives.fileUpload.closeDuringUploadClose">\n    <bb-translate>components.directives.fileUpload.closeDuringUploadClose</bb-translate>\n  </button>\n  <button name="modal-footer-button-secondary" class="button button--secondary js-secondary-button" ng-click="fileUpload.modalCancelUpload()" analytics-id="components.directives.fileUpload.closeDuringUploadGoBack">\n    <bb-translate>components.directives.fileUpload.closeDuringUploadGoBack</bb-translate>\n  </button>\n</bb-modal>\n'},RNuw:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n("nsO7"),i=n("Llzl");function r(e,t,n,r){const s={};return e.$watchCollection((()=>t),((t,o)=>{const l=Object.keys(t).filter((e=>!Object.prototype.hasOwnProperty.call(s,e)&&t[e]&&Object.prototype.hasOwnProperty.call(t[e],"$viewValue")&&(!r||!(r.indexOf(e)>-1))));i.forEach(l,(i=>{s[i]=e.$watch((()=>t[i].$viewValue),((e,r)=>{!t[i].$dirty&&(null==r||Number.isNaN(Number(r)))||a.isEqual(e,r)||n(e,r)}))}));const c=Object.keys(o).filter((e=>!Object.prototype.hasOwnProperty.call(t,e)&&o[e]&&Object.prototype.hasOwnProperty.call(o[e],"$viewValue")));i.forEach(c,(e=>{s[e](),delete s[e]}))})),()=>{i.forEach(s,(e=>{e()}))}}},ReOc:function(e,t,n){"use strict";var a=n("nsO7"),i=n("NI+y"),r=n("Q/M7"),s=n("5MwF");t.a=new class{getHistory(){return i.b.getHistory()}getSiteId(){return this.context?this.context.getSystemInfo().siteId:null}getUserAgent(){return navigator.userAgent}getUser(){return this.userService?this.userService.userModel:null}init(e,t,n,a){this.context=e,this.userService=t,i.b.setStorage(n,a)}async getDebugInfoRaw(){const e=this.getUser(),t=await this.getHistory();return{userAgent:this.getUserAgent(),siteId:this.getSiteId(),siteDomain:r.j(),buildNumber:s.a.buildInfo.buildNumber,ultraVersion:s.a.buildInfo.ultraVersion,learnVersion:s.a.buildInfo.learnVersion,userId:e?e.id:null,userName:e?e.userName:null,analyticsHistory:t,generatedTime:(new Date).toUTCString()}}async getDebugInfoFriendly(){const e=await this.getDebugInfoRaw(),t=[],n={innerHeight:null,innerWidth:null,outerHeight:null,outerWidth:null};let i=!1;return t.push("===== Basic Session Info ===="),t.push(`Debug Exported at: ${e.generatedTime}`),t.push(`User Agent: ${e.userAgent}`),t.push(`Site Domain: ${e.siteDomain}`),t.push(`Build Number: ${e.buildNumber}`),t.push(`Ultra Version: ${e.ultraVersion}`),t.push(`Learn Version: ${e.learnVersion}`),e.siteId?t.push(`Learn Site ID: ${e.siteId}`):t.push("Learn Site ID: site id unavailable, no context provided"),e.userId?t.push(`User: ${e.userName} (${e.userId})`):t.push("User: user id unavailable, no context provided"),t.push("===== Recent Analytics History (oldest first) ====="),e.analyticsHistory.forEach((e=>{e.screenDimension&&!a.isEqual(n,e.screenDimension)&&(t.push(`${e.timestamp}: Screen Size ${i?"changed to ":"is "} ${e.screenDimension.innerHeight} x ${e.screenDimension.innerWidth}`),Object.assign(n,e.screenDimension),i=!0),"click"===e.action?t.push(`${e.timestamp}: clicked on ${e.analyticsId}`):"pageview"===e.action?t.push(`${e.timestamp}: navigated to ${e.analyticsId}`):"request error"===e.action&&t.push(`${e.timestamp}: Request error: ${e.analyticsId}`)})),t}}},"Rjd/":function(e,t,n){"use strict";n("QLzv"),n("qY1S");var a=n("Llzl"),i=n("nkTj"),r=n("z6Q5");const s=a.module("ultra.models",["restmod","angular-data.DSCacheFactory",i.d,r.a]);t.a=s},SBFF:function(e,t){e.exports='<div ng-show="isShown" class="guidance-container stop-click-propagation" aria-hidden="true">\n  <p ng-show="title" ng-transclude="title" class="guidance-title"></p>\n  <p ng-transclude></p>\n</div>'},SGFZ:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return s}));var a=n("Llzl"),i=n("Fvsw"),r=n("TnpK");const s="ultra.components.directives.ultraState.peekSref";class o{constructor(t,n,a,i){this.$parse=t,this.uiSrefDirective=n,this.ultraState=a,this.context=i,this.restrict=this.uiSrefDirective[0].restrict,this.scope=!0,this.require=this.uiSrefDirective[0].require,this.link=(t,n,a,i)=>{const r=this.$parse(a.bbPeekSref)(t)||a.bbPeekSref,s=n.closest("[data-base-state-name]").data("baseStateName")||this.context.basePage;this.ultraState.getPeekStateName(r,s).then((r=>{a.uiSref=r;this.uiSrefDirective[0].compile(n,a,void 0)(t,n,a,i),a.bbPreventRoutingClick&&n.bind("click",(t=>{e(t.target).closest(a.bbPreventRoutingClick).length>0&&t.preventDefault()}))}))}}}o.$inject=["$parse","uiSrefDirective",r.d,i.b],a.module(s,["ui.router",i.a,r.b]).directive("bbPeekSref",["$injector",e=>e.instantiate(o)])}).call(this,n("71td"))},Sa5G:function(e,t,n){"use strict";var a=n("nbDY"),i=n.n(a);class r extends i.a{}r.Text=new r("textBlock"),r.Html=new r("htmlBlock"),r.File=new r("fileBlock"),r.AttemptFile=new r("attemptFileBlock");var s=r;class o extends i.a{static stringToEnum(e){let t=null;switch(e){case o.SingleText.toString():t=o.SingleText;break;case o.SingleFile.toString():t=o.SingleFile;break;default:t=o.TextAndFiles}return t}}o.SingleText=new o("SingleText"),o.SingleFile=new o("SingleFile"),o.TextAndFiles=new o("TextAndFiles");class l extends i.a{getOptionValue(){switch(this){case l.Add:return"+";case l.Subtract:return"-";case l.Multiply:return"*";case l.Divide:return"/";case l.Open_Parenthesis:return"(";case l.Close_Parenthesis:return")";case l.Value:return"value"}}}l.Add=new l("ADD"),l.Subtract=new l("SUBTRACT"),l.Multiply=new l("MULTIPLY"),l.Divide=new l("DIVIDE"),l.Open_Parenthesis=new l("OPEN_PARENTHESIS"),l.Close_Parenthesis=new l("CLOSE_PARENTHESIS"),l.Value=new l("VALUE");var c=n("7CA4"),d=n("Y3OE"),u=n("pqmn");class m extends i.a{constructor(e,t){super(e),this.keys=t,this.keys.buttonKey||(this.keys.buttonKey="base.courses.conversion.ok")}}m.ConversionInProgress=new m("ConversionInProgress",{titleKey:"base.courses.conversion.beingConverted",bodyKey:"base.courses.conversion.mayTakeAwhile",ariaAlertKey:"base.courses.conversion.beingConvertedAlert"}),m.ConversionComplete=new m("ConversionComplete",{titleKey:"base.courses.conversion.hasBeenConverted",bodyKey:"base.courses.conversion.clickToSeeNewCourse",buttonKey:"base.courses.conversion.seeNewExperience",ariaAlertKey:"base.courses.conversion.hasBeenConvertedAlert"}),m.OrgConversionInProgress=new m("OrgConversionInProgress",{titleKey:"base.organizations.conversion.beingConverted",bodyKey:"base.courses.conversion.mayTakeAwhile",ariaAlertKey:"base.organizations.conversion.beingConvertedAlert"}),m.OrgConversionComplete=new m("OrgConversionComplete",{titleKey:"base.organizations.conversion.hasBeenConverted",bodyKey:"base.organizations.conversion.clickToSeeNewCourse",buttonKey:"base.courses.conversion.seeNewExperience",ariaAlertKey:"base.organizations.conversion.hasBeenConvertedAlert"}),m.StudentTryAgain=new m("StudentTryAgain",{titleKey:"base.courses.noAccess.studentCurrentlyNoAccess",bodyKey:"base.courses.noAccess.studentTryAgain"}),m.StudentNoLongerAccessible=new m("StudentNoLongerAccessible",{titleKey:"base.courses.noAccess.studentCourseHasEnded",bodyKey:"base.courses.noAccess.studentNoLongerAccess"}),m.ParticipantTryAgain=new m("ParticipantTryAgain",{titleKey:"base.organizations.noAccess.studentCurrentlyNoAccess",bodyKey:"base.organizations.noAccess.studentTryAgain"}),m.ParticipantNoLongerAccessible=new m("ParitcipantNoLongerAccessible",{titleKey:"base.organizations.noAccess.studentCourseHasEnded",bodyKey:"base.organizations.noAccess.studentNoLongerAccess"}),m.None=new m("None",{titleKey:"",bodyKey:""});var p=m,h=n("lCpV");class g extends i.a{}g.Assignment=new g("Assignment"),g.Test=new g("Test"),g.Exam=new g("Exam"),g.Homework=new g("Homework"),g.Presentation=new g("Presentation"),g.Quiz=new g("Quiz");class b extends i.a{}b.Letter=new b("Letter"),b.Percentage=new b("Percentage"),b.Points=new b("Points"),b.Text=new b("Text");var f=n("dtd2");class v extends i.a{}v.Email=new v("email"),v.Mobile=new v("mobile"),v.SMS=new v("sms"),v.Voice=new v("voice"),v.Dashboard=new v("dashboard");var y=v;n("bzJv");class S extends i.a{}S.Available=new S("AVAILABLE"),S.Opened=new S("OPENED"),S.Started=new S("STARTED"),S.Saved=new S("SAVED"),S.Submitted=new S("SUBMITTED");var C,E=S;n("KiLF");!function(e){e.SingleOccurrence="S",e.PeriodicOccurrence="P"}(C||(C={}));var I,k=C;!function(e){e.ViewPostedCourseAnnouncement="course.announcements.VIEW",e.ViewUnpostedCourseAnnouncement="course.announcements.admin.VIEW",e.CreateCourseAnnouncement="course.announcements.CREATE",e.ModifyCourseAnnouncement="course.announcements.MODIFY",e.DeleteCourseAnnouncement="course.announcements.DELETE",e.ViewPostedSystemAnnouncement="system.announcements.VIEW",e.ViewUnpostedSystemAnnouncement="system.announcements.admin.VIEW",e.CreateSystemAnnouncement="system.announcements.CREATE",e.ModifySystemAnnouncement="system.announcements.MODIFY",e.DeleteSystemAnnouncement="system.announcements.DELETE"}(I||(I={}));var w,T=I,O=n("nawZ");!function(e){e.ViewCalendar="course.calendar.VIEW"}(w||(w={}));var A,P=w;!function(e){e.CreateContent="course.content.CREATE",e.DeleteContent="course.content.DELETE",e.ModifyContent="course.content.MODIFY",e.ViewContent="course.content.VIEW",e.ViewAsDesigner="course.content.designer.VIEW",e.DeployAssessment="course.content.assessment.deploy.EXECUTE",e.ModifyContentAvailability="course.content.availability.MODIFY"}(A||(A={}));var x,$,N=A,D=n("Z+K4");!function(e){e.CourseExportArchiveWithPassword="course.archive.user.password.EXECUTE"}(x||(x={})),function(e){e.CreateRubrics="course.rubrics.CREATE",e.ModifyRubrics="course.rubrics.MODIFY",e.ViewRubrics="course.rubrics.VIEW"}($||($={}));var L,j=$;!function(e){e.EmailAllUsers="course.email-all-users.EXECUTE"}(L||(L={}));var M,G=L;!function(e){e.CreateGroups="course.groups.CREATE",e.DeleteGroups="course.groups.DELETE",e.ModifyGroups="course.groups.MODIFY",e.ViewGroups="course.groups.VIEW",e.ViewGroupsAsAdmin="course.groups.admin.VIEW",e.ManageGroupMembership="course.group-user.manage.EXECUTE"}(M||(M={}));var R,B=M;!function(e){e.Modify="content.embedded-iframe.MODIFY"}(R||(R={}));var F,U=R,_=n("Q74M");!function(e){e.CreatePortalOptionsModuleManagement="system.portaloptions.managemodules.CREATE",e.ModifyPortalOptionsModuleManagement="system.portaloptions.managemodules.MODIFY",e.ViewBrand="system.portaloptions.brand.VIEW",e.CreateBrand="system.portaloptions.brand.CREATE",e.ModifyBrand="system.portaloptions.brand.MODIFY",e.DeleteBrand="system.portaloptions.brand.DELETE",e.ModifyUltraThemeData="system.ultra.themedata.MODIFY",e.ViewBuildingBlock="system.buildingblocks.VIEW"}(F||(F={}));var z,q=F;!function(e){e.ModifyContent="content.trustedcontent.MODIFY"}(z||(z={}));var H=z;n.d(t,"c",(function(){return s})),n.d(t,"e",(function(){return c.a})),n.d(t,"g",(function(){return d.a})),n.d(t,"h",(function(){return u.a})),n.d(t,"i",(function(){return p})),n.d(t,"m",(function(){return h.a})),n.d(t,"p",(function(){return f.a})),n.d(t,"q",(function(){return y})),n.d(t,"u",(function(){return E})),n.d(t,"r",(function(){return k})),n.d(t,"a",(function(){return T})),n.d(t,"b",(function(){return O.a})),n.d(t,"d",(function(){return P})),n.d(t,"f",(function(){return N})),n.d(t,"j",(function(){return D.a})),n.d(t,"k",(function(){return x})),n.d(t,"l",(function(){return j})),n.d(t,"n",(function(){return G})),n.d(t,"o",(function(){return B})),n.d(t,"w",(function(){return U})),n.d(t,"s",(function(){return _.a})),n.d(t,"t",(function(){return q})),n.d(t,"v",(function(){return H}))},SeO5:function(e,t){e.exports='<bb-modal id="content-deleted-modal"\n          class="notification"\n          modal-title-key="base.stream.modal.accessDenied.title"\n          analytics-id-tag-prefix="base.stream.modal.accessDenied">\n  <div name="modal-contents">\n    <p bb-translate>base.stream.modal.accessDenied.body</p>\n  </div>\n  <button name="modal-footer-button-primary" class="button confirm-ok js-primary-button" ng-click="$parent.$close()" bb-translate analytics-id="global.ok">global.ok</button>\n</bb-modal>\n'},Si89:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return m}));var a=n("D57K"),i=n("Llzl"),r=n("5MwF"),s=n("aHpC"),o=n("fYJU"),l=n("emI2"),c=n("wQOJ"),d=n("TnpK");const u="ultra.service.context.landingPage",m="landingPageService",p="base.recentActivity";let h=class{constructor(e,t,n,a,i,r){this.$q=e,this.$timeout=t,this.currentUser=n,this.preferences=a,this.institutionApi=i,this.ultraState=r}navigateToLandingPage(){return this.getLandingPage().then((e=>this.ultraState.go(e)))}getLandingPage(){return this.currentUser.userModel.$asPromise().then((e=>e.isGuest()?this.convertLandingPageToRoute():this.preferences.getPreference("ultraui.first.time.welcome.welcome.visited").then((()=>this.convertLandingPageToRoute()),(e=>404===e.$response.status?r.a.features.devtools_disableFtue?this.convertLandingPageToRoute():"welcome":this.convertLandingPageToRoute()))))}convertLandingPageToRoute(){return this.currentUser.userModel.$asPromise().then((e=>{switch(e.landingPage){case"ActivityStream":return"base.recentActivity";case"InstitutionPage":return this.getInstitutionPageRoute();case"CourseList":return"base.courses";default:return p}}))}getInstitutionPageRoute(){const e=this.$q.defer(),t=this.$timeout((()=>e.resolve(p)),6e3);return this.institutionApi.getHealth().then((()=>this.institutionApi.getEffectiveVariantIdWithPermissions())).then((({canEdit:e,canView:t})=>e?"base.institution-page-admin":t?"base.institution-page":p)).catch((()=>p)).then((n=>{this.$timeout.cancel(t),e.resolve(n)})),e.promise}};h=Object(a.a)([Object(a.c)(0,Object(s.b)("$q")),Object(a.c)(1,Object(s.b)("$timeout")),Object(a.c)(2,Object(s.b)(o.b)),Object(a.c)(3,Object(s.b)(l.c)),Object(a.c)(4,Object(s.b)(c.b)),Object(a.c)(5,Object(s.b)(d.d))],h);i.module(u,[o.a,l.b,c.a,d.b]).service(m,h)},Sjpn:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n("Llzl"),i=n("TnpK");const r="ultra.features.base.profile.privacy.routes";a.module(r,["ui.router",i.b]).config([i.c,e=>{e.peekState("privacy",{url:"/privacy",require:()=>Promise.all([n.e(43),n.e(78),n.e(151)]).then(n.bind(null,"0OB5")),pageTitle:"base.profile.updatePrivacySettings.pageTitle"})}])},TAnh:function(e,t,n){"use strict";var a=n("Llzl"),i=n("4GL6"),r=n("e6jQ"),s=n("usTV");n.d(t,"a",(function(){return o}));const o="ultra.components.directives.squareToggle";class l{constructor(e,t,n){this.scope=e,this.element=t,this.attrs=n,this.radioGroupName=r.a(),this.oneControlId=r.a(),this.twoControlId=r.a()}handleKeyUp(e){13!==e.keyCode&&32!==e.keyCode||(this.scope.property=e.target.value)}handleClick(e){this.scope.property=e.target.value}}l.$inject=["scope","element","attrs"];class c{constructor(e){this.$injector=e,this.restrict="E",this.template=s,this.scope={oneIconClass:"@",oneAriaLabel:"@",oneAriaControls:"@?",oneViewValue:"@",oneTooltipTemplate:"@?",oneTooltipScope:"&?",property:"=",twoIconClass:"@",twoAriaLabel:"@",twoAriaControls:"@?",twoViewValue:"@",twoTooltipTemplate:"@?",twoTooltipScope:"&?",analyticsIdTagPrefix:"@?"},this.compile=(e,t)=>(a.isDefined(t.oneTooltipTemplate)&&e.find("input.input-one").attr("bb-complex-tooltip",""),a.isDefined(t.twoTooltipTemplate)&&e.find("input.input-two").attr("bb-complex-tooltip",""),{post:(e,t,n)=>{e.squareToggle=this.$injector.instantiate(l,{scope:e,element:t,attrs:n})}})}}c.$inject=["$injector"],a.module(o,[i.b]).directive("bbSquareToggle",["$injector",e=>e.instantiate(c)])},TB6y:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var a=n("D57K"),i=(n("9RbK"),n("cf0z"),n("KCTV"),n("aHpC")),r=n("71td"),s=n("nsO7"),o=n("Llzl"),l=n("e6jQ"),c=n("lUN/"),d=n("lEL+"),u=n("+4Px"),m=n("7+Tq"),p=n("d7QB");const h="ultra.directives.bbFoundation";window.Foundation.libs.dropdown.dirs._base=function(e){var t,n;const a=this.offsetParent().offset(),i=e.offset();i.top-=a.top,i.left-=a.left,i.missRight=!1,i.missTop=!1,i.missLeft=!1,i.leftRightFlag=!1;const r=null!==(n=null===(t=this.closest(".panel-wrap")[0])||void 0===t?void 0:t.clientWidth)&&void 0!==n?n:window.innerWidth,s=(window.innerWidth-r)/2;let o=r;if(!this.hasClass("mega")){const t=this.outerWidth(),n=e.offset();n.top<=this.outerHeight()&&(i.missTop=!0,o=window.innerWidth-s,i.leftRightFlag=!0),n.left-s+t>r?(i.missRight=!0,i.missLeft=!1):n.left-s-t<=0&&(i.missLeft=!0,i.missRight=!1)}return this.toggleClass("miss-right",i.missRight),this.toggleClass("miss-left",i.missLeft),i};const g=window.Foundation.libs.dropdown.dirs.bottom;window.Foundation.libs.dropdown.dirs.bottom=function(e,t){var n;const a=window.Foundation.libs.dropdown,i=g.call(this,e,t);return!a.rtl||(null===(n=e[0].dataset)||void 0===n?void 0:n.defaultPositioning)?i:this.offsetParent()[0]===e.offsetParent()[0]?{...i,left:0}:{...i,left:e.offset().left}};const b=window.Foundation.libs.dropdown.dirs.right;window.Foundation.libs.dropdown.dirs.right=function(e,t){const n=window.Foundation.libs.dropdown,a=b.call(this,e,t);return n.rtl?{...a,left:a.left-e.outerWidth()}:a};const f=window.Foundation.libs.dropdown.adjust_pip;window.Foundation.libs.dropdown.adjust_pip=function(e,...t){e.hasClass("disable-pip-adjustment")||f.apply(this,[e,...t])};const v=(e,t,n,a)=>{e.$on("$destroy",(()=>{window.Foundation.scope===t[0]&&(window.Foundation.scope=null),s.forEach(window.Foundation.libs,(e=>{e.scope===t[0]&&(e.scope=null),delete e.bindings,delete e.settings.callback}))}));["small","small-only","medium","medium-only","large","large-only","xlarge","xlarge-only","xxlarge"].forEach((e=>{window.Foundation.media_queries[e]=r(".foundation-mq-"+e).css("font-family").replace(/^[\/\\'"]+|(;\s?})+|[\/\\'"]+$/g,"")})),c.a();const i=e=>{e.each(((t,a)=>{const i=r(a),s=i.hasClass("active"),o=i.children("a").first(),l=i.children(".content").first(),c=r("body");l.attr("aria-hidden",!s+""),o.attr({"aria-selected":s,"aria-expanded":s});const d=i.find(':tabbable[role!="tab"]').add(i.find('[tabindex="-1"]')).add(i.find("input")).not(i.children("a").first());s?d.attr("tabindex",0):d.attr("tabindex","-1"),n||(o.on("keydown",(n=>{if(n.keyCode===u.v||n.keyCode===u.j){const n=0===t?e.length-1:t-1;r(e.get(n)).children("a").first().focus()}else if(n.keyCode===u.d||n.keyCode===u.s){const n=t===e.length-1?0:t+1;r(e.get(n)).children("a").first().focus()}else n.keyCode===u.i?r(e.get(0)).children("a").first().focus():n.keyCode===u.e&&r(e.get(e.length-1)).children("a").first().focus();c.removeClass("hide-focus-outline")})),l.on("keydown",(n=>{if(n.ctrlKey&&n.keyCode===u.v)o.focus();else if(n.ctrlKey&&n.keyCode===u.q){const n=0===t?e.length-1:t-1;r(e.get(n)).children("a").first().focus()}else if(n.ctrlKey&&n.keyCode===u.p){const n=t===e.length-1?0:t+1;r(e.get(n)).children("a").first().focus()}c.removeClass("hide-focus-outline")}))),i.addClass("accordion-complete")}))},o=t.find(".accordion");o.length>0&&o.each(((e,t)=>{const n=r(t),a=n.find(".accordion-navigation:not(.accordion-complete)");n.attr("role","tablist"),a.each(((t,n)=>{const a=r(n),i=a.children("a").first(),s=a.children(".content").first();i.attr("role","tab"),s.attr("role","tabpanel");const o=l.a(),c="accordion"+e+"-"+o+"-header"+t,d="accordion"+e+"-"+o+"-panel"+t;i.attr("id",c),s.attr("id",d),i.attr("href","#"+d),i.attr("aria-controls",d),s.attr("aria-labelledby",c)})),i(a)})),a(t,e),t.foundation({accordion:{multi_expand:!0,callback:e=>{e.closest(".accordion").removeAttr("aria-multiselectable");const t=e.closest(".accordion").children(".accordion-navigation");i(t)}},dropdown:{}})};let y=class{constructor(e,t){this.dropdownInit=e,this.integrationEventEmitterService=t,this.onDestroyHandler=null,this.restrict="A",this.link=(e,t,n)=>{this.onDestroyHandler=this.integrationEventEmitterService.addIntegrationEventClickListener(t);const a=e.$eval(n.rubricOverride);e.$on("$destroy",(()=>{this.onDestroyHandler&&this.onDestroyHandler()})),v(e,t,a,this.dropdownInit)},this.onDestroyHandler=null}};y=Object(a.a)([Object(a.c)(0,Object(i.b)(m.b)),Object(a.c)(1,Object(i.b)(p.b))],y);let S=class{constructor(e,t,n){this.timeout=e,this.dropdownInit=t,this.integrationEventEmitterService=n,this.onDestroyHandler=null,this.restrict="A",this.link=(e,t,n)=>{this.onDestroyHandler=this.integrationEventEmitterService.addIntegrationEventClickListener(t);const a=e.$eval(n.rubricOverride);e.$on("$destroy",(()=>{this.onDestroyHandler&&this.onDestroyHandler()})),this.timeout((()=>{v(e,t,a,this.dropdownInit)}),e,0,!1)},this.onDestroyHandler=null}};S=Object(a.a)([Object(a.c)(0,Object(i.b)(d.b)),Object(a.c)(1,Object(i.b)(m.b)),Object(a.c)(2,Object(i.b)(p.b))],S);let C=class{constructor(e,t,n){this.timeout=e,this.dropdownInit=t,this.integrationEventEmitterService=n,this.onDestroyHandler=null,this.restrict="A",this.link=(e,t,n)=>{this.onDestroyHandler=this.integrationEventEmitterService.addIntegrationEventClickListener(t);const a=e.$eval(n.rubricOverride);e.$on("$destroy",(()=>{this.onDestroyHandler&&this.onDestroyHandler()}));const i=e.$watch(n.bbFoundationWait,(n=>{n&&(i(),this.timeout((()=>{v(e,t,a,this.dropdownInit)}),e,0,!1))}))}}};C=Object(a.a)([Object(a.c)(0,Object(i.b)(d.b)),Object(a.c)(1,Object(i.b)(m.b)),Object(a.c)(2,Object(i.b)(p.b))],C);let E=class{constructor(e,t,n){this.timeout=e,this.dropdownInit=t,this.integrationEventEmitterService=n,this.onDestroyHandler=null,this.restrict="A",this.link=(e,t,n)=>{this.onDestroyHandler=this.integrationEventEmitterService.addIntegrationEventClickListener(t);const a=e.$eval(n.rubricOverride);e.$on("$destroy",(()=>{this.onDestroyHandler&&this.onDestroyHandler()})),e.$watch(n.bbFoundationWaitContinuous,(n=>{n&&this.timeout((()=>{v(e,t,a,this.dropdownInit)}),e,0,!1)}),null!=n.bbDeepWatch&&n.bbDeepWatch)}}};E=Object(a.a)([Object(a.c)(0,Object(i.b)(d.b)),Object(a.c)(1,Object(i.b)(m.b)),Object(a.c)(2,Object(i.b)(p.b))],E),o.module(h,[d.a,m.a,p.a]).directive("bbFoundation",["$injector",e=>e.instantiate(y)]).directive("bbFoundationDefer",["$injector",e=>e.instantiate(S)]).directive("bbFoundationWait",["$injector",e=>e.instantiate(C)]).directive("bbFoundationWaitContinuous",["$injector",e=>e.instantiate(E)])},TFjq:function(e,t){e.exports='<bb-modal id="notification-modal-api-error"\n          class="notification error-something-broke-modal"\n          modal-title-key="components.services.error-modal.error-something-broke.title"\n          analytics-id-tag-prefix="components.services.error-modal.error-something-broke">\n  <div name="modal-contents">\n    <p bb-translate>components.services.error-modal.error-something-broke.description</p>\n    <pre>{{ response | json }}</pre>\n    <bb-session-debug-modal-button></bb-session-debug-modal-button>\n  </div>\n  <button name="modal-footer-button-primary"\n          class="button large reload-page-button js-primary-button"\n          onclick="location.reload(true)"\n          analytics-id="components.services.error-modal.reloadPage"\n          bb-translate>components.services.error-modal.reloadPage</button>\n</bb-modal>\n'},TT9l:function(e,t,n){"use strict";var a=n("ERkP"),i=n("7nmT"),r=n("e6jQ"),s=n("v6Sp");const o=()=>{const[e]=a.useState(Object(r.b)()),[t,n]=a.useState(!1),i=a.useRef();return a.createElement("div",{ref:i,className:"course-banner-integration-container"+(t?"":" no-integration-content")},a.createElement(s.d,{portalId:e,selector:"course.banner.top",onContentsChanged:e=>{n(!!e),i.current.dispatchEvent(new CustomEvent("banner-resize",{bubbles:!0}))}}))};n.d(t,"a",(function(){return l}));const l=new class{constructor(){this.subscriptions=[],this.createBanner=()=>{if(this.currentBanner)return this.currentBanner;const e=document.createElement("div");return i.render(a.createElement(o,null),e),this.currentBanner=e,this.notifySubscribers(),this.currentBanner},this.destroyBanner=()=>{this.currentBanner?(i.unmountComponentAtNode(this.currentBanner),this.currentBanner=null,this.notifySubscribers()):console.warn("There is no integration banner present to unmount.")},this.currentPanelBanner=()=>{if(this.bannerStack.length)return this.bannerStack[this.bannerStack.length-1].state},this.pushBanner=e=>{this.bannerStack.push(e),1!==this.bannerStack.length&&this.bannerStack[this.bannerStack.length-2].orphan()},this.popBanner=e=>{this.bannerStack=this.bannerStack.filter((t=>t.state.stateName!==e)),this.bannerStack.length?this.bannerStack[this.bannerStack.length-1].adopt(this.currentBanner):this.destroyBanner()},this.bannerStack=[]}watchBanner(e){return this.subscriptions.push(e),setTimeout((()=>e(this.currentBanner))),()=>this.subscriptions=this.subscriptions.filter((t=>t!==e))}notifySubscribers(){this.subscriptions.forEach((e=>e(this.currentBanner)))}}},TUnR:function(e,t,n){"use strict";var a=n("ERkP"),i=n("MC1S"),r=n("In+A");class s{constructor(e,t){this.shownStateChanged=e,this.shown=!1,this.viewed=!1,this.onShown=()=>{this.setShown(!0)},this.onHidden=e=>{this.setShown(!1),e||this.markViewed()},this.markViewed=()=>{this.viewed=!0},this.componentType="",this.componentKey=t}shouldShow(){return Promise.resolve(!this.viewed)}setShown(e){this.shown=e,this.shownStateChanged(e)}}let o=!1;const l=()=>{o||(o=!0,Object(r.g)({name:r.a,priority:r.b}))};var c=(e,t,n)=>{l();const[i,r]=a.useState(!1),[o,c]=a.useState((()=>()=>{}));return a.useEffect((()=>{const a=new s(r,n);return e.registerComponent(a),t.sendStart(),c((()=>()=>{r(!1),a.markViewed(),e.hideComponent(a.componentKey)})),()=>{e.deregisterComponent(a)}}),[n,t,e]),[i,o]};var d=e=>{const{componentKey:t}=e,[n,s]=c(r.f,r.e,t);return n?a.createElement(i.TeachingBubble,{onDismiss:s,...e}):null},u=n("tMbR"),m=n("np6O"),p=n("3/0u"),h=n("WBPx"),g=n("dIht"),b=n("7O4Y"),f=n("Hj9i"),v=n("Agfx"),y=n("THXI");const S=Object(v.makeStyles)((e=>Object(v.createStyles)({msModalContainer:{position:"relative",left:"0px",right:"0px",top:"2px",bottom:"0.02px",background:y.c.white,border:"1px solid "+e.palette.secondary.main,boxSizing:"border-box",borderRadius:"2px",width:"460px",height:"780x"},msModalText:{position:"relative",textAlign:"center"},msDialogContent:{height:"300px",[e.breakpoints.up("sm")]:{height:"400px"}},msModalHeader:{margin:"auto"},msModalBody:{position:"absolute",textAlign:"center",p:{margin:"auto"}},animation:{position:"relative"}})));var C=n("Afl9"),E=n("oCLu"),I=n.n(E),k=n("caKH");const w="guidance.featureIntroduction",T=e=>{const{steps:t,componentKey:n,iconButtonAriaLabel:i}=e,[s,o]=a.useState(!1),[l,c]=a.useState(0),d=Object(C.a)(),u=S(),[v,y]=Object(f.a)(`${w}.${n}`),E=t.length-1;return v||s?a.createElement("div",null,a.createElement(m.AnalyticsIconButton,{analyticsId:`${w}.icon-button`,"aria-label":i,className:Object(b.a)(!s&&d.animatedIconButton),onClick:()=>((e,t)=>{r.f.stopQueue(),e(!0),t()})(o,y),onFocus:e=>e.stopPropagation()},a.createElement(g.a,{className:d.icon})),a.createElement(k.c,{isOpen:s,onDismiss:()=>(e=>{e(!1),r.f.startQueue()})(o),analyticsId:"guidanceFeatureIntroduction.dialog"},a.createElement("div",{className:Object(b.a)(u.msDialogContent)},a.createElement("div",{className:Object(b.a)(u.animation)},a.createElement(I.a,{ariaLabel:t[l].imageAriaLabel,options:{loop:!0,autoplay:!0,animationData:t[l].imageSource,rendererSettings:{preserveAspectRatio:"xMidYMid slice"}}})),a.createElement("div",{className:Object(b.a)(u.msModalText)},a.createElement("div",{className:Object(b.a)(u.msModalHeader)},a.createElement("h2",null,t[l].title)),a.createElement("div",{className:Object(b.a)(u.msModalBody)},a.createElement("p",null,t[l].body)))),a.createElement(p.DialogFooter,null,a.createElement(h.AnalyticsDefaultButton,{onClick:()=>l>0?c(l-1):o(!1),analyticsId:"guidanceFeatureIntroduction.defaultButton"},t[l].secondaryButtonText),a.createElement(h.AnalyticsPrimaryButton,{onClick:()=>l<E?c(l+1):o(!1),analyticsId:"guidanceFeatureIntroduction.primaryButton"},t[l].primaryButtonText)))):null};n.d(t,"c",(function(){return d})),n.d(t,"a",(function(){return u.a})),n.d(t,"b",(function(){return T})),n.d(t,"d",(function(){return f.a}))},TWlR:function(e,t,n){"use strict";var a=n("td+C"),i=n("fN3Q");const r={includeProcessingEvent:!0};class s{constructor(e,t,n,a){this.integrationService=e,this.generateId=t,this.activeMessages=new Map,this.integrationService.addIntegrationMessageType(`${n}:response`,this.correlatedMessageResponseCallback.bind(this)),a.includeProcessingEvent&&this.integrationService.addIntegrationMessageType(`${n}:processing`,this.correlatedMessageProcessingCallback.bind(this))}sendMessage(e,t){return new Promise(((n,a)=>{const i=this.generateId(),r=this.createMessageTimeout(i,a);this.integrationService.sendMessage({...e,correlationId:i,timeout:5e3},t),this.activeMessages.set(i,{integrationId:t,timeoutId:r,resolvePromise:n,rejectPromise:a})}))}correlatedMessageResponseCallback(e,t){const n=this.getCorrelatedMessage(e,t.id);n&&(this.activeMessages.delete(e.correlationId),window.clearTimeout(n.timeoutId),n.resolvePromise(e))}correlatedMessageProcessingCallback(e,t){const n=this.getCorrelatedMessage(e,t.id);n&&(window.clearTimeout(n.timeoutId),n.timeoutId=this.createMessageTimeout(e.correlationId,n.rejectPromise))}createMessageTimeout(e,t){return window.setTimeout((()=>{this.activeMessages.delete(e);const n=`Correlated message '${e}' timed out`;console.warn(n),t(new Error(n))}),5e3)}getCorrelatedMessage(e,t){const n=e.correlationId,a=this.activeMessages.get(n);return a?a.integrationId!==t?(console.error(`Correlated message '${n}' does not belong to '${t}'`),null):a:(console.error(`Couldn't find a correlated message with correlation id '${n}'`),null)}}t.a=(e,t={})=>new s(a.a,i.v4,e,{...r,...t})},Tfg2:function(e,t){e.exports='<bb-modal class="notification"\n          modal-title-key="components.directives.fileUpload.zipTitle"\n          modal-dismiss-key="components.directives.fileUpload.takeMeBack"\n          analytics-id-tag-prefix="components.directives.fileUpload">\n  <div name="modal-contents">\n    <p>\n      <bb-translate>components.directives.fileUpload.zipFull</bb-translate>\n    </p>\n  </div>\n  <button name="modal-footer-button-primary" role="button" ng-click="fileUpload.closeModal(true)" class="button js-primary-button" analytics-id="components.directives.fileUpload.unzipFile">\n    <bb-translate>components.directives.fileUpload.unzipFile</bb-translate>\n  </button>\n  <button name="modal-footer-button-secondary" role="button" ng-click="fileUpload.closeModal(false)" class="button button--secondary js-secondary-button" analytics-id="components.directives.fileUpload.uploadAsZip">\n    <bb-translate>components.directives.fileUpload.uploadAsZip</bb-translate>\n  </button>\n</bb-modal>\n'},TnpK:function(e,t,n){"use strict";(function(e){n.d(t,"b",(function(){return I})),n.d(t,"d",(function(){return k})),n.d(t,"c",(function(){return w})),n.d(t,"a",(function(){return O}));n("JzsJ"),n("KUD0");var a=n("nsO7"),i=n("Llzl"),r=n("yC9S"),s=n("t6zR"),o=n("0JpG"),l=n("yA26"),c=n("w9Zy"),d=n("5MwF"),u=n("Fvsw"),m=n("lVRt"),p=n("jhBu"),h=n("lEL+"),g=n("k9iv"),b=n("ZzR9"),f=n("Q/M7"),v=n("Y+9S"),y=n("ORAk"),S=n("TT9l"),C=n("nmzr"),E=n("6fZB");const I="ultra.router",k="ultraState",w=k+"Provider",T="DefaultBasePage",O=".peek.";function A(e){e&&Object.keys(e).forEach((t=>{const n=e[t];Array.isArray(n)&&(e[t]=Array.from(new Set(n)),1===e[t].length&&(e[t]=n[0]))}))}function P(e,t){const n=/^(\^)?(\??)(\w+)/.exec(e),a={searchParents:!1,optional:!1,name:t};return n&&(a.searchParents="^"===n[1],a.optional="?"===n[2],a.name=n[3]?n[3]:t),a}function x(e){if(a.isString(e))return e;const t=e[e.length-1];return a.isString(t)?t:""}class ${constructor(t,n){this.$stateProvider=t,this.addedStates={},this.initAllStates=!1,this.$get=["$rootScope","$state","$injector","$sce","$window",c.e,u.b,T,h.b,g.c,(t,n,a,i,o,l,c,u,m,p)=>{this.$state=n,this.$rootScope=t,this.defaultBasePage=u,this.context=c,this.timeout=m;const h=this.baseStates.map((e=>e.name));if(r.b.OnRootScope(t,b.b.$stateChangeSuccess,((e,t)=>{o.top===o.self&&-1!==h.indexOf(t.name)&&(c.basePage=t.name,sessionStorage.setItem(s.a.getBasePageStorageKey(),c.basePage))})),r.b.OnRootScope(t,b.b.$stateChangeSuccess,((e,t,n,a,i)=>{if(a.name&&t.name&&a.name.split(O).length<t.name.split(O).length)return;const r=""===a.name,s=a.panelClass||"peek",o=t.panelClass||"peek";this.timeout((()=>{"peek"!==s||"full"!==o||r||l.expandTopPanel(),"full"===s&&"peek"===o&&l.shrinkTopPanel()}),this.$rootScope,0,!1)})),r.b.OnRootScope(t,b.b.$stateChangeStart,((e,t,i,r,s)=>{n.next=t,A(i),n.nextParams=i,r&&(n.prev={name:r.name}),A(s),n.prevParams=s,t.routingFunction&&(e.preventDefault(),a.invoke(t.routingFunction))})),r.b.OnRootScope(t,b.b.$stateChangeError,((t,a,r,s,o,l)=>{l.errorModalConfig&&p.openModal(l.modalConfig);if(l&&l.userNotEntitled)n.go(u);else if(l.goToBasePage)n.goCurrentBasePage();else{if(f.m("inPreviewMode",window.location.href)){const t=i.trustAsResourceUrl(f.c(`/ultra/courses/${n.nextParams.courseId}/outline/?inPreviewMode=true`));e(window.parent.document).find("#preview-iframe").attr("src",t)}if(!d.a.production)throw console.error("$stateChangeError when moving from "+s.name+" to "+a.name),l}})),this.initAllStates)this.createAllStates();else{this.registerPeekStates(n.get(this.defaultBasePage));const e=n.get(sessionStorage.getItem(s.a.getBasePageStorageKey())||this.defaultBasePage);e&&e.name!==this.defaultBasePage&&this.registerPeekStates(e)}return n}],this.baseStates=[],this.peekStates={},this.absoluteUrls=[],t.decorator("resolve",(function(e,t){const n=t?t(e):e.resolve;return n.childrenStates&&n.childrenStates.length>0&&n.childrenStates.push(a.once(n.childrenStates.pop())),n})),t.decorator("resolve",(function(e,t){const n=t?t(e):e.resolve;for(let e of Object.keys(n)){const t=n[e],i=P(e,e);i.optional&&(delete n[e],e=i.name,n[e]=t);const r=x(t);if(r){const t=P(r,e);t.searchParents?n[e]=[t.name,e=>e&&e.isLazy?e():e]:console.error("Illegal resolve format. Did you forget to prepend ^?")}if(i.optional){const t=n[e],i=t.slice?t.slice(0,t.length-1):[];n[e]=["$injector",...i,(e,...n)=>{const r=a.once((()=>{const a={};for(let e=0;e<i.length;e++)a[i[e]]=n[e];return e.invoke(t,void 0,a)}));return r.isLazy=!0,r}]}}return n})),t.decorator("url",(function(e,t){const a=t(e);return a&&(a.exec=function(t,...r){const s=this.regexp.source;new RegExp(s.substr(0,s.length-1)+"/").test(t)&&n.invoke(e.resolve.childrenStates||[i.noop]);const o=r?[t].concat(r):[t];return a.constructor.prototype.exec.apply(this,o)}),a})),(e=>{const n=this;t.state=function(...t){return n.addedStates["string"==typeof t[0]?t[0]:t[0].name]=!0,e.apply(this,t)}})(t.state)}baseState(e,t){window.top!==window&&f.m("inPreviewMode",window.location.href)&&(t.require=()=>n.e(718).then(n.bind(null,"shLZ")),t.peekViewName=void 0),t=this.getStateWithName(e,t),this.baseStates.push(t);return(t.resolve=t.resolve||{}).childrenStates=[()=>{this.registerPeekStates(t)}],this.$stateProvider.state(t),this}peekState(e,t){const n=(t=this.getStateWithName(e,t)).name.split(".")[0];return this.peekStates[n]=this.peekStates[n]&&this.peekStates[n].concat(t)||[t],this}state(e,t){return t=this.getStateWithName(e,t),this.$stateProvider.state(t),this}registerPeekStates(e){if(e&&e.peekStates){const t={};if(t.name=e.name+".peek",!Object.prototype.hasOwnProperty.call(this.addedStates,t.name)&&null==this.$state.get(t.name)){let a;t.onExit=[c.e,k,(e,n)=>{a&&S.a.popBanner(t.name),e.close(t.name)}],t.resolve={offCanvasArgs:[k,n=>{const i=$.getPanelStateNameFromNextState(n.next.name,t.name),r=n.get(i),s=S.a.currentPanelBanner(),o=s&&"full"!==s.panelClass&&"full"===r.panelClass;return(2===i.split(O).length||o)&&(a=S.a.createBanner()),{banner:a,panelClass:r&&r.panelClass||"peek",pageTitle:r&&r.pageTitle,template:y.replace("{0}",this._getPanelName(e)),close:()=>(this.$rootScope.bbOffcanvasOpened&&n.go(e.name),!1),stateName:t.name,overlay:null==r||null==r.overlay||r.overlay}}]},e.peekViewName?(t.views={},t.views[e.peekViewName]={require:()=>Promise.resolve().then(n.bind(null,"yA26"))}):t.require=()=>Promise.resolve().then(n.bind(null,"yA26")),this.$stateProvider.state(t)}this.createAllPeekStates(e,e.peekStates)}}createAllPeekStates(e,t){const n=e.name+O;t.forEach((t=>{(this.peekStates[t]||[]).forEach((t=>{this._checkAbsoluteUrl(t);const a=n+t.name;if(Object.prototype.hasOwnProperty.call(this.addedStates,a)||null!=this.$state.get(a))return;const r=i.copy(t);r.name=a,r.abstract||(r.urlHandler=["$location",k,"$match",(t,n,i)=>{const r=e=>{const t=e.split("."),n=a.split(".");return t.forEach(((e,t)=>{n[t]=e})),n.join(".")};if(null!=n.$current.navigable&&!n.includes(e.name))return!1;{let e;e=this._isAbsoluteUrl(t.url())?r(sessionStorage.getItem(s.a.getBasePageStorageKey())||this.defaultBasePage):a,null==n.get(e)&&(e=r(this.defaultBasePage)),n.$current.name!==e&&n.transitionTo(e,i,{location:!1})}}]),r.views||(r.views={},r.views[this._getPanelName(e)]={template:r.template,controller:r.controller,require:r.require}),delete r.template,delete r.controller,delete r.require,r.getPageTitle&&(r.pageTitle=r.getPageTitle());const o=()=>{r.peekStates&&r.peekStates.length>0&&("full"===r.panelClass||r.allowChildPeekStates?this.registerPeekStates(r):this.createAllPeekStates(e,r.peekStates))};if(this.initAllStates)this.$stateProvider.state(r),o();else{(r.resolve=r.resolve||{}).childrenStates=[o],this.$stateProvider.state(r),r.peekStates&&r.peekStates.length>0&&"full"!==r.panelClass&&!r.allowChildPeekStates&&this.createAllPeekStates(e,r.peekStates)}}))}))}static getPanelStateNameFromNextState(e,t){const n=e.indexOf(O,t.length);return-1!==n?e.substr(0,n):e}_getPanelName(e){return e.name.split(".").join("-").concat("-panel@")}_checkAbsoluteUrl(e){if(e.url&&0===e.url.indexOf("^")){const t=e.url.match(/\/:[a-zA-Z]+/);let n=e.url;t&&(n=n.substring(0,t.index)),n=n.substring(1);const a=n.match(/\(\?:([^\)]*)/);a?a[1].split("|").forEach((e=>{this.absoluteUrls.push(`/${e}`)})):-1===this.absoluteUrls.indexOf(n)&&this.absoluteUrls.push(n)}}_isAbsoluteUrl(e){return a.find(this.absoluteUrls,(t=>0===e.indexOf(t)))}createAllStates(){this.baseStates&&this.baseStates.length>0&&this.baseStates.forEach((e=>{this.registerPeekStates(e)}))}createAllStatesOnInit(){this.initAllStates=!0}getStateWithName(e,t){return i.isObject(e)?t=e:t.name=e,this._initStateEntitlements(t),t}_initStateEntitlements(e){this._initSystemEntitlementChecks(e),this._initCourseEntitlementChecks(e)}_initSystemEntitlementChecks(e){e.systemEntitlement&&(e.resolve||(e.resolve={}),e.resolve.systemEntitlement=["$q",p.b,(t,n)=>n.hasSystemEntitlement(e.systemEntitlement).then(this._configureStateChangeCallback(t))])}_configureStateChangeCallback(e){return t=>{const n=e.defer();return t?n.resolve():n.reject({userNotEntitled:!0}),n.promise}}_ensureCourseIdParam(e,t){return t.nextParams.courseId?e.resolve():e.reject("Cannot check course entitlements when the state does not have a courseId parameter.")}_guardEntitlementInjectable(e){const t=Array.isArray(e)?e.slice(0,e.length-1):[];return["$q","$injector",k,...t,(n,i,r,...s)=>{const o=a.zipObject(t,s);return this._ensureCourseIdParam(n,r).then((()=>{try{return i.invoke(e,void 0,o)}catch(e){return n.reject(e)}})).then(this._configureStateChangeCallback(n)).catch((()=>n.reject({userNotEntitled:!0})))}]}_getDefaultEntitlementInjectable(e){return[p.b,k,(t,n)=>"string"==typeof e?t.hasCourseEntitlement(e,n.nextParams.courseId):t.hasAnyCourseEntitlement(e,n.nextParams.courseId)]}_initCourseEntitlementChecks(e){let t;e.courseEntitlement&&(t=this._getDefaultEntitlementInjectable(e.courseEntitlement)),e.resolve&&Object.prototype.hasOwnProperty.call(e.resolve,"courseEntitlement")&&(t=e.resolve.courseEntitlement),t&&(e.resolve||(e.resolve={}),e.resolve.courseEntitlement=this._guardEntitlementInjectable(t))}}$.$inject=["$stateProvider","$injector"];i.module(I,["ui.router","oc.lazyLoad",u.a,c.d,l.moduleName,h.a]).provider(k,$).constant(T,d.a.defaultBasePage).config(["$provide","$ocLazyLoadProvider",(e,t)=>{e.decorator("$state",["$injector","$delegate","$resolve","$q","$$animateJs","$ocLazyLoad","$rootScope",u.b,c.e,(e,t,n,r,s,l,d,u,p)=>{t.goPeekState=(...e)=>p.getTopElement().then((n=>{const a=n&&n.name||u.basePage;return t.getPeekStateName(e[0],a).then((n=>(e[0]=n,t.go.apply(t,e))))})),t.leavePeekState=e=>{null==e&&(e=t.current.name);const n=e.lastIndexOf(O);return-1!==n?t.go(e.substring(0,n)):r.when()},t.peekHref=(e,n,a)=>(a?r.when(new c.a(null,null,a)):p.getTopElement()).then((i=>(a=i&&i.name||u.basePage,t.getPeekStateName(e,a).then((e=>t.href(e,n)))))),t.isPeekPanelOpen=()=>-1!==t.current.name.indexOf(".peek."),t.getPeekStateName=(n,a)=>a===u.basePage?r.when(a+O+n):p.getElement(a).then((()=>{const e=$.getPanelStateNameFromNextState(t.current.name,a),i=e.lastIndexOf(O),r=t.current.name.substring(i+O.length).split(".")[0],s=n.split(".")[0];if(r===s)return t.current.name.substring(0,i+O.length)+n;const o=n.replace(/[.*+\-?^${}()|[\]\\]/g,"\\$&"),l=new RegExp("(^|\\.)"+o+"(\\.|$)");let c=e.search(l);if(-1!==c){const t=new RegExp("(^|\\.)"+o+"(\\.)");return c=e.search(t)?c+1:c,e.substring(0,c+n.length)}const d=t.get(e);return"full"===d.panelClass||d.allowChildPeekStates&&-1!==d.peekStates.indexOf(s)?e+O+n:e.substring(0,i+O.length)+n})).then((n=>{const a=function(n){if(!t.get(n.join("."))){const e=n.pop();a(n),n.push(e)}e.invoke((t.get(n.join("."))&&t.get(n.join(".")).resolve||{}).childrenStates||[i.noop])};return a(n.replace(/\n/g,"").replace(/(^[^\(\)]*)\(.*\)$/,"$1").split(".")),n})),t.goCurrentBasePage=()=>t.go(t.getBaseState()),t.goToRoute=(e,n)=>t.go(e,n),t.getBaseState=()=>u.basePage,t.search=(e,n,a)=>{const r=t.params;if(i.isString(e)&&n?r[e]=n:Object.keys(e).forEach((t=>{r[t]=e[t]})),t.current.name)return t.go(t.current.name,r,a)},t.getCurrentUrlParams=()=>{const e=t.$current.url.parameters(),n=Object.create(null);return e.forEach((e=>{t.params[e]&&(n[e]=t.params[e])})),n},t.requireAllStates=function(){const e=this,t=this.get(),n=[];return t.forEach((t=>{t&&null!=t.name&&n.push(e.requireState(t.name))})),r.all(n)},t.requireState=function(e){const t=this,n=e.split("."),s=[];for(let e=0;e<n.length;e++)s.push(n.slice(0,e+1).join("."));const c=()=>{const e=s.shift();if(null==e)return!0;const n=t.get(e);if(!n)return c();let d=[];const u=[];if(n.require&&(i.isArray(n.require)||(n.require=[n.require]),d=d.concat(n.require),u.push(n)),n.views&&i.isObject(n.views)&&Object.keys(n.views).forEach((e=>{const t=n.views[e];t.require&&(i.isArray(t.require)||(t.require=[t.require]),d=d.concat(t.require),u.push(t))})),d.length<1)return c();const m=r.defer(),p=[],h=new Map,g=d.map((e=>e().then((t=>(h.set(e,t),t)))));return r.all(a.compact(g)).then((()=>{u.forEach((e=>{i.isArray(e.require)&&(e.require.forEach((t=>{const a=h.get(t),r=a.panelDefinition||{},s=r&&r.moduleName||a.moduleName;s&&p.push(l.load({name:s}));const c=r&&r.template||a.template;c&&!e.template&&(e.template=c);const d=r&&r.templateProvider||a.templateProvider;d&&(e.templateProvider=d);const u=r&&r.controllerName||a.controllerName;u&&!e.controller&&(e.controller=u);const m=r&&r.resolve;m&&(e.resolve=i.extend(e.resolve||{},m));const g=r&&r.translations;g&&(e.resolve=i.extend(e.resolve||{},{loadedTranslations:["$q",o.serviceName,(e,t)=>e.all(g.map((e=>t.loadBundle(e))))]}));const b=r&&r.pageTitle;b&&!n.pageTitle&&(n.pageTitle=b)})),e.require=!1)})),r.all(a.compact(p)).then((()=>{m.resolve(c())}),(e=>{m.reject(e)}))}),(e=>{m.reject(e)})),m.promise};return c()};const h=t.transitionTo;t.transitionTo=function(...e){const t=this;let n=e[0];return i.isObject(n)&&(n=n.self.name),r.all([this.requireState(n)]).then((()=>h.apply(t,e)))};const g=t.href;t.href=(e,t,n)=>g(e,t,i.extend(n||{},{absolute:!0})),t.getCurrentResolvedValues=function(){return t.$current&&t.$current.locals&&t.$current.locals.resolve?t.$current.locals.resolve.$$values:{}};const f=(e,n)=>{if(!n||!n.name)return!1;if(e===m.c&&"resolve"in n&&e in n.resolve)return!0;if(e===m.b&&"resolve"in n&&e in n.resolve)return!0;const i=t.get(a.dropRight(n.name.split(".")).join("."));return f(e,i)};return t.hasCourseInContext=e=>f(m.c,e),t.hasContentInContext=e=>f(m.b,e),C.Z.setRouteHandler(function(e,t){return{goPeekState:(t,...n)=>Object(E.a)(e.goPeekState(t,...n)),goToRoute:(t,n)=>Object(E.a)(e.goToRoute(t,n)),leavePeekState:t=>Object(E.a)(e.leavePeekState(t)),getPeekHref:(t,n,a)=>Object(E.a)(e.peekHref(t,n,a)),getHref:(t,n,a)=>e.href(t,n,a),search:(t,n)=>Object(E.a)(e.search(t,null,n)),onRouteChanging:e=>t.$on(b.b.$stateChangeStart,((t,n,a,i,r)=>{const s={toState:n,toParams:a,fromState:i,fromParams:r,preventRouteChange:t.preventDefault.bind(t)};e(s)}))}}(t,d)),t}])}]),i.module(I).run(["$rootScope",k,u.b,T,function(e,t,n,a){const i=sessionStorage.getItem(s.a.getBasePageStorageKey());n.basePage=i||a,e.$on(b.b.$stateChangeSuccess,((n,a,i,r,s)=>{const o=t.hasCourseInContext(r),l=t.hasCourseInContext(a);o!==l&&e.$broadcast(b.b.$stateHasCourseInContextChanged,l,o);const c=t.hasContentInContext(r),d=t.hasContentInContext(a);c!==d&&e.$broadcast(b.b.$stateHasContentInContextChanged,d,c);const u=a.name&&Object(v.i)(a.name),m=r.name&&Object(v.i)(r.name);Object(v.p)(u,m)}))}])}).call(this,n("71td"))},U8wS:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n("Llzl"),i=n("5MwF"),r=n("TnpK");const s="ultra.data-ui.routes";a.module(s,[r.b]).config([r.c,e=>{e.baseState("base.dataUi",{url:"^/data-ui",require:()=>n.e(672).then(n.bind(null,"gNT0")),onEnter:[r.d,e=>{i.a.production&&e.go("base.not-found")}]})}])},UD9g:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return d})),n.d(t,"a",(function(){return u}));var a=n("nsO7"),i=n("Llzl"),r=n("0JpG"),s=n("pjml"),o=n("TnpK"),l=n("3bn4");const c="ultra.course.engagement.course-no-grade-content-goal-alignment",d="ultra.course.engagement.course-no-grade-content-goal-alignment.service",u="no-grade-content-goal-alignment",m=["course","goal-alignment","goal"];class p extends l.a{constructor(){super(...arguments),this.panelClass="peek no-grade-content-goal-peek"}resolveGoalAlignableContent(){return["$q",r.serviceName,"$injector",o.d,s.m.serviceName,(e,t,n,a,i)=>{let r,s,o=null;return a.nextParams&&a.nextParams.contentId&&(o=a.nextParams.contentId),a.nextParams&&a.nextParams.id&&(o=a.nextParams.id),o&&"create"!==o?i.$find(a.nextParams.courseId).$asPromise().then((e=>(r=e,e.contents.$find(o).$asPromise()))).then((e=>{s=e})).then((()=>e.all([r.contents.$find(s.id,{expand:"alignedGoals,permissions"}).$asPromise(),t.loadBundle(`features/${m.join("/")}`)]).then((([e])=>this.groupGoals(r.contents.$buildRaw(e),t))))):e.when([])}]}getPeekStateName(){return u}groupGoals(e,t){let n="alignedGoalsDefaultTitle";return e.isDiscussion()?n="goalsAlignedWithDiscussion":e.isDocument()?n="goalsAlignedWithDocument":e.isFile()?n="goalsAlignedWithFile":e.isLink()?n="goalsAlignedWithLink":e.isLtiLink()?n="goalsAlignedWithLtiLink":e.isLtiPlacement()&&(n="goalsAlignedWithLtiPlacement"),[{getContentTitleForGoalAlignment:()=>t.translateSync({locale:null,key:`${m.join(".")}.${n}`}),getContentIdForGoalAlignment:i.bind(e,e.getContentIdForGoalAlignment),isCurrentUserEligibleToAlignGoals:i.bind(e,e.isCurrentUserEligibleToAlignGoals),alignedGoals:e.alignedGoals?e.alignedGoals.map((t=>(t.content=e,t))):[],coreContent:e}]}getOverrideSubTitle(){return[o.d,s.m.serviceName,(e,t)=>{let n=null;return e.nextParams&&e.nextParams.contentId&&(n=e.nextParams.contentId),e.nextParams&&e.nextParams.id&&(n=e.nextParams.id),n?t.$find(e.nextParams.courseId).$asPromise().then((e=>e.contents.$find(n).$asPromise())).then((e=>e.title)):""}]}}p.$inject=["$injector","$q"],i.module(c,[o.b,r.moduleName]).config([o.c,e=>{const t=new p;e.peekState(t.getPeekStateName(),t)}]).service(d,["$injector",r.serviceName,function(e){return{resolveGoalAlignableContents:()=>e.invoke((new p).resolveGoalAlignableContent(),null,{}).then((e=>[e,a.flatten(a.compact(e.map((e=>e.alignedGoals)))).length]))}}])},UP3t:function(e,t){e.exports='<div class="bb-course-catalog-link" ng-if="shouldDisplayCatalogLink">\n  <a href="javascript:void(0);"\n     class="catalog-anchor-tag"\n     ng-if="!isExternalCatalog"\n     ng-click="handleCatalogLink()"\n     course-org-token-resolver\n     aria-label="{{ariaLabel}}"\n     analytics-id="base.baseCourses.courseCatalog.link">\n    <span ng-if="windowSizeService.isLargeBreakpoint()">\n      <bb-translate course-org-token-resolver>base.baseCourses.link</bb-translate>\n      <bb-svg-icon class="catalog-icon-large-breakpoint" size="medium" icon="programs" />\n    </span>\n    <bb-svg-icon class="catalog-icon-small-breakpoint" size="small" icon="course_catalog_default" ng-if="!windowSizeService.isLargeBreakpoint()" />\n  </a>\n  <a class="catalog-anchor-tag"\n     ng-if="isExternalCatalog"\n     href="{{ ::externalCatalogUrl }}"\n     target="_blank"\n     rel="noopener noreferrer"\n     course-org-token-resolver\n     bb-translate-attrs="{\'aria-label\': \'base.baseCourses.aria-label.externalLink\'}"\n     analytics-id="base.baseCourses.courseCatalog.externalLink.link">\n    <span ng-if="windowSizeService.isLargeBreakpoint()">\n      <bb-translate course-org-token-resolver>base.baseCourses.externalLink</bb-translate>\n      <bb-svg-icon class="catalog-icon-large-breakpoint" size="medium" icon="programs" />\n    </span>\n    <bb-svg-icon class="catalog-icon-small-breakpoint" size="small" icon="course_catalog_default" ng-if="!windowSizeService.isLargeBreakpoint()" />\n  </a>\n</div>\n'},UiBk:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var a=n("Llzl"),i=n("0JpG"),r=n("Qbdf"),s=n("36CG"),o=n("X455"),l=n("8W6D"),c=n("p7NW"),d=n("2Tae"),u=n("TnpK"),m=n("gkef"),p=n("nmzr");const h="ultra.course.rubrics.router";a.module(h,[i.moduleName,u.b,m.a,d.b,r.b,s.d,o.a]).config([u.c,r.c,o.b,s.e,(e,t,a,s)=>{e.peekState(p.G.Rubric.RUBRIC,{abstract:!0,url:"/rubric",resolve:{translations:["$q",i.serviceName,(e,t)=>e.all([t.loadBundle("features/course/rubric/rubric"),t.loadBundle("components/services/rubric"),t.loadBundle("features/course/goal-alignment/goal")])],[r.d]:t.resolve,mode:()=>l.a.NONE}}).peekState(p.G.Rubric.RUBRIC_MODE,{url:"?rubricId&mode",panelClass:"full",pageTitle:"course.rubric.title",peekStates:[d.a],peekViewName:"rubric-grid-peek@",require:()=>Promise.all([n.e(103),n.e(0),n.e(1),n.e(2),n.e(95),n.e(581)]).then(n.bind(null,"gAA+")),resolve:{currentRubric:[r.d,c.g,u.d,(e,t,n)=>{switch(n.nextParams&&n.nextParams.mode.toLowerCase()){case l.a.CREATE.toString():return t.generateDefaultRubric(e);case l.a.EDIT.toString():return n.nextParams.rubricId?e.rubrics.$find(n.nextParams.rubricId,{expand:"rows.alignedGoals,permissions"}).$asPromise():null;case l.a.COPY.toString():return e.rubrics.$find(n.nextParams.rubricId,{expand:"rows.alignedGoals,permissions"}).$asPromise().then((e=>t.createRubricCopy(e)));default:return null}}],hasEvaluations:["currentColumn",u.d,(e,t)=>(t.nextParams&&t.nextParams.mode.toLowerCase())===l.a.EDIT.toString()&&(e?e.hasEvaluations():null)],mode:[u.d,e=>{switch(e.nextParams&&e.nextParams.mode.toLowerCase()){case l.a.CREATE.toString():return l.a.CREATE;case l.a.EDIT.toString():return l.a.EDIT;case l.a.COPY.toString():return l.a.COPY;default:return l.a.NONE}}]}}).peekState(p.G.Rubric.RUBRIC_EVALUATION,{url:"/rubric-evaluation?userId&columnId",panelClass:"peek",pageTitle:"course.rubricEvaluation.title",params:{columnId:null,groupId:null,userId:{array:!1}},require:()=>Promise.all([n.e(32),n.e(737)]).then(n.bind(null,"nWWf")),resolve:{translations:["$q",i.serviceName,(e,t)=>e.all([t.loadBundle("features/course/rubric/rubric"),t.loadBundle("components/services/rubric")])],[o.c]:a.resolve,offCanvasArgs:["offCanvasArgs",m.b,(e,t)=>(e.overlay=!t.isLargeBreakpoint(),e)]}}).peekState(p.G.Rubric.RUBRIC_VIEW,{url:"/rubric-view?columnId",panelClass:"peek",pageTitle:"course.rubricView.title",params:{columnId:null},require:()=>Promise.all([n.e(32),n.e(738)]).then(n.bind(null,"L8+l")),resolve:{translations:["$q",i.serviceName,(e,t)=>e.all([t.loadBundle("features/course/rubric/rubric"),t.loadBundle("components/directives/rubric/rubric-view"),t.loadBundle("components/services/rubric")])],offCanvasArgs:["offCanvasArgs",m.b,(e,t)=>(e.overlay=!t.isLargeBreakpoint(),e)]}})}])},UioO:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n("Llzl"),i=n("0JpG");const r="ultra.components.directives.bbDatetime";class s{constructor(e,t,n){this.$parse=e,this.$q=t,this.bbLocalize=n,this.restrict="E",this.scope={value:"&"},this.link=(e,t,n)=>{const r=n.format,s=n.timezoneFormat;e.$watch((()=>e.value()),(n=>{let o=i.ILocaleDatetimeFormat.Short,l=i.ILocaleTimezoneFormat.Short;if(!a.isDate(n))return t.html("");if(r&&(o=this.bbLocalize.getFormatEnum(i.ILocaleDatetimeFormat,r)),s&&(l=this.bbLocalize.getFormatEnum(i.ILocaleTimezoneFormat,s)),r&&s)this.bbLocalize.translate({locale:this.bbLocalize.getLocale(e),key:`components.directives.datetime.datetimeWithTimezone.${r.toUpperCase()}_datetime_${s.toUpperCase()}_timezone`,params:{datetime:n},noWrap:!0,noEscape:!0}).then((e=>{t.html(e)}));else{(s?this.bbLocalize.formatTimezone(n,l):this.bbLocalize.formatDatetime(n,o,e)).then((e=>{t.html(e)}))}}),!0)}}}s.$inject=["$parse","$q",i.serviceName];a.module(r,[i.moduleName]).directive("bbDatetime",["$injector",e=>e.instantiate(s)])},Us01:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n("Llzl"),i=n("0JpG");const r="ultra.directives.bbTranslate";class s{constructor(e,t,n,i,r,s,o,l,c){if(this.$parse=e,this.$rootScope=t,this.bbLocalize=n,this.$interpolate=i,this.scope=r,this.iElement=s,this.iAttr=o,this.rawKey=l,this.translateValuesExist=c,this.interpolateParams={},this.analyticsIdSet=!1,this.intSym="{{",o.bbTranslate=o.bbTranslate||s.text(),s.text(""),o.bbTranslate&&!o.bbTranslate.match(this.intSym)&&this.onAttrUpdate(o.bbTranslate),this.attrWatcher=o.$observe("bbTranslate",this.onAttrUpdate.bind(this)),this.translateValuesExist){let e;o.$observe("translateValues",(t=>{if(t){e&&e();const n=this.$parse(t);e=r.$parent.$watch(n.bind(null,r.$parent),(e=>{a.extend(this.interpolateParams,e),this.updateTranslation()}),!0)}}))}const d=this.$rootScope.$on("$translateChangeSuccess",(()=>this.updateTranslation()));r.$on("$destroy",(()=>d()))}shouldUnwatch(e){return e.indexOf(this.intSym)<0&&this.rawKey.indexOf(this.intSym)<0||(e.indexOf("::")>=0&&this.rawKey.indexOf("::")>=0||void 0)}unwatch(){this.attrWatcher(),this.interpolatedAttrWatcher&&this.interpolatedAttrWatcher()}onTranslationIdUpdate(e){e&&(e=e.replace(/^\s+|\s+$/g,""),this.updateTranslation(e))}onAttrUpdate(e){if(e!==this.bbTranslateAttrValue)if(this.bbTranslateAttrValue=e,e.match(this.intSym)){this.interpolatedAttrWatcher&&this.interpolatedAttrWatcher();const t=this.$interpolate(e);this.interpolatedAttrWatcher=this.scope.$watch((()=>t(this.scope)),this.onTranslationIdUpdate.bind(this))}else this.onTranslationIdUpdate(e)}updateTranslation(e=this.translationId){e&&(this.translationId=e,this.bbLocalize.translate({locale:this.bbLocalize.getLocale(this.scope),key:e,params:this.interpolateParams}).then((t=>{t===e?this.iElement.text(t):this.iElement.html(t),this.shouldUnwatch(this.bbTranslateAttrValue)&&this.unwatch()}),(()=>{this.iElement.text(e)})))}}s.$inject=["$parse","$rootScope",i.serviceName,"$interpolate","scope","iElement","iAttr","rawKey","translateValuesExist"];class o{constructor(e){this.$injector=e,this.restrict="AE",this.scope=!0,this.compile=(e,t)=>{const n=t.bbTranslate=(t.bbTranslate||e.text()||"").replace(/^[\s\n]+|[\s\n]+$/g,"");if(!n)return;const a=t.translateValues?t.translateValues:void 0;return(e,t,i)=>this.$injector.instantiate(s,{scope:e,iElement:t,iAttr:i,rawKey:n,translateValuesExist:a})}}}o.$inject=["$injector"],a.module(r,[i.moduleName]).directive("bbTranslate",["$injector",e=>e.instantiate(o)])},V0gA:function(e,t,n){"use strict";n.r(t),n.d(t,"serviceName",(function(){return p})),n.d(t,"RecurWeekDay",(function(){return h})),n.d(t,"MetadataOnCalendarItemCardLinkType",(function(){return g}));n("QLzv");var a=n("Llzl"),i=n("nbDY"),r=n.n(i),s=n("5MwF"),o=n("VdDF"),l=n("yCC5"),c=n("Rjd/"),d=n("g66W"),u=n("nkTj"),m=n("zGdY");const p=l.k;class h extends r.a{constructor(e,t){super(e),this.handle=e,this.dayOfWeek=t}}var g;h.Sunday=new h(m.ec.Sunday,0),h.Monday=new h(m.ec.Monday,1),h.Tuesday=new h(m.ec.Tuesday,2),h.Wednesday=new h(m.ec.Wednesday,3),h.Thursday=new h(m.ec.Thursday,4),h.Friday=new h(m.ec.Friday,5),h.Saturday=new h(m.ec.Saturday,6),function(e){e.Course="Course",e.External="External"}(g||(g={})),c.a.factory(p,["restmod","RMUtils",u.c,(e,t,n)=>{const i=s.a.apiBasePath+"/v1/calendars/calendarItems";return e.model(i).mix({startDate:{serialize:"date"},endDate:{serialize:"date"},"recurRules.until":{serialize:"date"},"recurRules.originalStart":{serialize:"date"},"recurRules.originalEnd":{serialize:"date"},ui:{mask:!0,init:()=>({})},$extend:{isDueItem(){return!!this.dynamicCalendarItemProps},isAllDayEvent(){return 0===this.startDate.getHours()&&0===this.startDate.getMinutes()&&23===this.endDate.getHours()&&59===this.endDate.getMinutes()},isConditionalRelease(){return!(this.permissions&&this.permissions.edit)&&m.w.Restricted===this.visibility},getTruncatedLocation(e){return d.e(this.location,e)},Record:{$buildUrl(e){return this.$pk&&this.$pk.itemSourceType&&this.$pk.itemSourceId?t.joinUrl(t.joinUrl(e.$url(),this.$pk.itemSourceType),this.$pk.itemSourceId):null}},Model:{inferKey:e=>({itemSourceType:e.itemSourceType,itemSourceId:e.itemSourceId}),unpack:(e,t)=>{const n=e.$response.config;if(e.$isCollection){if("PUT"===n.method&&Array.isArray(t))return t.map((e=>e.statusCode>=200&&e.statusCode<300?a.fromJson(e.body):e.body));e.paging=t&&t.paging,e.permissions=t&&t.permissions;const i=t&&t.results;return i&&i.forEach((e=>{e.recurRules&&!e.recurRules.timeZoneId&&(e.recurRules.timeZoneId=o.a.getCurrentTimeZoneId())})),i}const i="POST"===n.method&&Array.isArray(t)?t[0]:t;return i.recurRules&&!i.recurRules.timeZoneId&&(i.recurRules.timeZoneId=o.a.getCurrentTimeZoneId()),i}}}})}])},V17J:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return r}));var a=n("Llzl"),i=n("+4Px");const r="ultra.components.directives.accessibility.enterKeyUpFocus";class s{constructor(t){this.injector=t,this.restrict="A",this.link=(t,n,a)=>{n.on("keydown",(e=>{e.keyCode!==i.f||a.bbTriggerEnterKeydown||e.preventDefault()})),n.on("keyup",(n=>{if(n.keyCode===i.f&&(n.preventDefault(),n.stopPropagation(),t.$apply((()=>{t.$eval(a.ngClick||a.bbClick,{$event:n}),t.$eval(a.ngBlur,{$event:n})})),a.bbEnterKeyUpFocus)){const t=e(a.bbEnterKeyUpFocus);if(a.indexToFocus){const e=Number(a.indexToFocus);t.eq(e).focus()}else t.focus()}}))}}}s.$inject=["$injector"],a.module(r,[]).directive("bbEnterKeyUpFocus",["$injector",e=>e.instantiate(s)])}).call(this,n("71td"))},V6ed:function(e,t,n){"use strict";(function(e){n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return m}));n("MISG");var a=n("9zo4"),i=n("Llzl"),r=n("nsO7"),s=n("+4Px"),o=n("lUN/"),l=n("lEL+");const c="ultra.directives.accessibility.hideFocusOutline",d="hide-focus-outline",u="is-focusVisible";class m{constructor(e){this.bbTimeout=e,this.restrict="A",this.link=(e,t,n)=>{o.a(),t.addClass(d),t.removeClass(u),m.instanceCount+=1,m.ensureEvents(t),e.$on("$destroy",(()=>{m.instanceCount-=1,0===m.instanceCount&&m.unregisterEvents(),t.off()}))}}static enableFocusOutline(){e(document.body).removeClass(d),e(document.body).addClass(u)}static ensureEvents(t){function n(e){e.keyCode===s.u&&(m.enableFocusOutline(),a.a.isLastNavigationByKeyboard=!0)}m.eventHandlers||(m.eventHandlers={keyup:n,keydown:n,mousedown:r.debounce((function(n){t.addClass(d),t.removeClass(u),a.a.isLastNavigationByKeyboard=!1,a.a.lastClickedElement=e(n.target).closest(":tabbable"),r.delay((()=>{a.a.lastClickedElement&&0===a.a.lastClickedElement.parents("body").length&&(a.a.lastClickedElement=void 0)}),800)}),200)},Object.keys(m.eventHandlers).forEach((e=>{document.addEventListener(e,m.eventHandlers[e],!0)})))}static unregisterEvents(){Object.keys(m.eventHandlers).forEach((e=>{document.removeEventListener(e,m.eventHandlers[e],!0)})),m.eventHandlers=null}}m.$inject=[l.b],m.instanceCount=0,m.eventHandlers=null,i.module(c,[l.a]).directive("bbFocusHelper",["$injector",e=>e.instantiate(m)])}).call(this,n("71td"))},VAMW:function(e,t,n){"use strict";var a;!function(e){e.ContentUpdate="content-update",e.CloseFolderById="close-folder-immediately-by-id",e.UpdateReviewState="update-state",e.RouterStateChangeStart="$stateChangeStart"}(a||(a={}));var i=n("ERkP");const r=Object(i.createContext)(void 0),s=r.Provider;function o(){const e=Object(i.useContext)(r);if(!e)throw new Error("[Transit Services]: Invalid Scope Context");return e}function l(){const e=o();return Object(i.useMemo)((()=>e.$applyAsync.bind(e)),[e])}function c(e,t=[]){const n=o(),[{watchedValue:a},r]=Object(i.useState)((()=>({watchedValue:e(n)})));return Object(i.useEffect)((()=>n.$watchCollection(e,(e=>{r({watchedValue:e})}))),t),a}var d,u,m=n("kNOQ");function p(e,t){const n=o(),a=Object(m.b)(t);Object(i.useEffect)((()=>n.$on(e,((e,...t)=>{a(e,...t)}))),[e,n,a])}function h(e,t=[]){const n=o(),[{watchedValue:a},r]=Object(i.useState)((()=>({watchedValue:e(n)})));return Object(i.useEffect)((()=>n.$watch(e,(e=>{r({watchedValue:e})}),!0)),t),a}!function(e){e.Approved="Approved",e.Excluded="Excluded",e.NeedsApproval="NeedsApproval"}(d||(d={})),function(e){e.Scorm="ScormService",e.Lti="LtiService",e.CurrentCourseMembership="CurrentCourseMembershipService",e.ConditionalReleaseCourseModelOperations="ConditionalReleaseCourseModelOperations",e.Context="ContextService",e.ContentIcon="ContentIconService",e.Entitlement="EntitlementService",e.Ally="AllyService",e.Content="ContentService",e.CourseContentModelOperations="CourseContentModelOperations",e.PeerReview="PeerReview",e.CreateContentCourseModelOperations="CreateContentCourseModelOperations",e.DeleteContentCourseModelOperations="DeleteContentCourseModelOperations",e.LearningModuleRefreshChildrenOperations="LearningModuleRefreshChildrenOperations",e.ContentFolderRefresher="ContentFolderRefresher",e.CloudDriveService="CloudDriveService",e.AngularMenuCloserService="AngularMenuCloserService",e.CanEnableForcedSequenceService="CanEnableForcedSequenceService"}(u||(u={}));const g=new Map,b=e=>{g.set(e.key,e)};function f(e){const t=g.get(e);if(!t)throw Error(`No service found with key: ${e}\nDid you forget to register a service with that key?`);return t}n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return s})),n.d(t,"g",(function(){return l})),n.d(t,"h",(function(){return c})),n.d(t,"i",(function(){return p})),n.d(t,"j",(function(){return h})),n.d(t,"f",(function(){return b})),n.d(t,"e",(function(){return f})),n.d(t,"a",(function(){return d})),n.d(t,"d",(function(){return u}))},VdDF:function(e,t,n){"use strict";var a=n("RZND"),i=n("wgY5"),r=n("nsO7");let s;class o{static isValidDate(e){return Object(r.isDate)(e)&&!Number.isNaN(e.getTime())}static isWithinDateRange(e,t,n=!0){let a=!0,i=!0;return t.start&&(a=n?t.start<=e:t.start<e),t.end&&(i=n?t.end>=e:t.end>e),a&&i}static testWithinDateRange(e,t,n=!0){const a=e=>{const t=new Date(e.getTime());return t.setSeconds(0,0),t},r={when:e&&a(e),range:{start:t&&t.start&&a(t.start),end:t&&t.end&&a(t.end)}},s=!r.when||!r.range||o.isWithinDateRange(r.when,{end:r.range.end,start:r.range.start},n);let l=!0;if(!s){let e=!0;r.range.start&&o.isSameDay(r.range.start,r.when)&&(e=n?i(r.when).isSameOrAfter(r.range.start,"minute"):i(r.when).isAfter(r.range.start,"minute"));let t=!0;r.range.end&&o.isSameDay(r.range.end,r.when)&&(t=n?i(r.when).isSameOrBefore(r.range.end,"minute"):i(r.when).isBefore(r.range.end,"minute")),l=e&&t}return{isValidDate:!l||s,isValidTime:l}}static isSameDay(e,t){return e.getDate()===t.getDate()&&e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()}static getCurrentTimeZoneId(){return s||(s=a.determine().name()),s}static parseStringToDate(e){return Object(r.isDate)(e)?e:null==e||""===e?null:new Date(e)}static convertToLocalDate(e){const t=o.parseStringToDate(e);return null!==t&&t.setMinutes(t.getMinutes()+t.getTimezoneOffset()),t}static parseDateToISOString(e){return null==e||Number.isNaN(Number(e.getDate()))?"":e.toISOString()}static compareDates(e,t,n=!0){return e&&t?[e,t].sort(((e,t)=>e.getTime()-t.getTime()))[n?0:1]:e||t}static breakdownSeconds(e){const t=Math.floor(e%60),n=e/60,a=Math.floor(n%60),i=n/60,r=Math.floor(i%24);return{days:Math.floor(i/24),hours:r,minutes:a,seconds:t}}}t.a=o},VfFK:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n("Llzl"),i=n("0JpG"),r=n("TnpK");const s="ultra.course.attendance.routes";a.module(s,[r.b]).config([r.c,e=>{e.peekState("attendance",{url:"/attendance?courseId&attendanceView&meetingId&memberId&isSingleUserView",resolve:{translations:["$q",i.serviceName,(e,t)=>e.all([t.loadBundle("features/course/attendance/attendance")])]},reloadOnSearch:!1,require:()=>Promise.all([n.e(70),n.e(760)]).then(n.bind(null,"kmhM")),pageTitle:"course.attendance.pageTitle",panelClass:"full",peekStates:["attendance-settings","attendance-student-records"]}).peekState("attendance-settings",{url:"/settings",resolve:{translations:["$q",i.serviceName,(e,t)=>e.all([t.loadBundle("features/course/attendance/attendance")])]},require:()=>Promise.all([n.e(70),n.e(759)]).then(n.bind(null,"qT3r")),pageTitle:"course.attendance.settings.pageTitle"}).peekState("attendance-student-records",{url:"/studentRecords/:membershipId?userId",resolve:{translations:["$q",i.serviceName,(e,t)=>e.all([t.loadBundle("features/course/attendance/attendance")])]},require:()=>Promise.all([n.e(70),n.e(183)]).then(n.bind(null,"OYHs")),pageTitle:"course.attendance.studentRecords.pageTitle"}).peekState("attendance-student-view",{url:"/attendanceGrade?courseId",resolve:{translations:["$q",i.serviceName,(e,t)=>e.all([t.loadBundle("features/course/attendance/attendance")])]},require:()=>Promise.all([n.e(70),n.e(183)]).then(n.bind(null,"OYHs")),pageTitle:"course.attendance.studentRecords.pageTitle"})}])},Vsv2:function(e,t,n){"use strict";var a=n("D57K"),i=n("Llzl"),r=n("HAJP"),s=n("0JpG"),o=n("pjml"),l=n("gkef"),c=n("emI2"),d=n("5MwF"),u=n("Q/M7");const m="cloud.account.tokens";var p;!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initialized=1]="Initialized",e[e.Failed=2]="Failed"}(p||(p={}));class h{constructor(e,t,n,a,i,r){this.$q=e,this.bbLocalize=t,this.$timeout=n,this.bbScriptLoader=a,this.preference=i,this.$rootScope=r,this.credentials={},this.status=p.Uninitialized,this.enabledServices=d.a.cloudStorageIntegrationServices,this.showDummyProvider=!1}get isInitialized(){return this.status===p.Initialized}init(){const e=this.$q.defer(),t=this.loaderUrl||"https://cloud-storage-integration.blackboardcdn.com/loader/js/loader.js",n=t.substring(0,t.indexOf("/loader"))+"/authenticator/js/cloud-storage-integration-authenticator.js";if(this.status===p.Initialized)e.resolve();else if(this.status===p.Failed)e.resolve();else{let a,i=!1,r=p.Uninitialized,s=p.Uninitialized;const o=()=>{i||r!==p.Uninitialized&&s!==p.Uninitialized&&(r===p.Initialized?(this.status=p.Initialized,e.resolve()):(this.status=p.Failed,e.resolve()),i=!0,this.$timeout.cancel(a))};a=this.$timeout((()=>{this.authenticator||(s=p.Failed,console.error("Authenticator initialization timed out. Disabling Authenticator Service.")),this.explorer||(r=p.Failed,console.error("CloudStorageIntegration initialization timed out.  Disabling CloudStorageIntegration Service.")),o()}),d.a.cloudStorageIntegrationInitializationTimeout||1e4),this.$q.all({CloudStorageIntegration:this.bbScriptLoader.getScript(t,{exports:"CloudStorageIntegration"}).then((e=>{this.explorer=e.explorer,r=p.Initialized,o()})),CloudStorageIntegrationAuth:this.bbScriptLoader.getScript(n,{exports:"CloudStorageIntegration"}).then((e=>{this.authenticator=e.authenticator,s=p.Initialized,o()}))}).catch((()=>{this.authenticator||(s=p.Failed,console.error("Failed to load cloudStorageIntegration authenticator. Disabling Authenticator Service.")),this.explorer||(r=p.Failed,console.error("Failed to load cloudStorageIntegration.  Disabling CloudStorageIntegration Service.")),o()}))}return e.promise}getExplorer(e){let t=e?this.explorerInstance_multi:this.explorerInstance_single;if(!t){const n={app_id:this.clientId,retrieve_token:!0,multiselect:e,display_backdrop:!0,create_folder:!1,types:["files"],text_direction:this.bbLocalize.isRTL(this.$rootScope)?"rtl":"ltr",show_dummy_provider:this.showDummyProvider};(this.enabledServices||[]).length>0&&(n.services=this.enabledServices),this.apiUrl&&(n.base_url=u.i(this.apiUrl)),this.useLoaderExplorer&&(n.use_loader_explorer=this.useLoaderExplorer),n.persist="none",t=this.explorer(n),t.on("success",(e=>{this.currentChooserPromiseObject&&(this.currentChooserPromiseObject.resolve(e),this.currentChooserPromiseObject=null)})),t.on("cancel",(()=>{this.currentChooserPromiseObject&&(this.currentChooserPromiseObject.resolve(),this.currentChooserPromiseObject=null)})),t.on("error",(e=>{this.currentChooserPromiseObject&&(this.currentChooserPromiseObject.reject(e),this.currentChooserPromiseObject=null)})),t.on("addAccount",(e=>{this.preference.getPreference(m).then((t=>{const n=this.deleteCloudStorageIntegrationAccount(JSON.parse(t.value),e.id);n.push(e),this.preference.setPreference(m,JSON.stringify(n))})).catch((()=>{const t=[];t.push(e),this.preference.setPreference(m,JSON.stringify(t))}))})),t.on("deleteAccount",(e=>{this.preference.getPreference(m).then((t=>{const n=this.deleteCloudStorageIntegrationAccount(JSON.parse(t.value),e);this.preference.setPreference(m,JSON.stringify(n))}))})),e?this.explorerInstance_multi=t:this.explorerInstance_single=t}return t}openFilePicker(e,t){if(this.currentChooserPromiseObject){const e=this.$q.defer();return e.reject(new Error("multiple explorer instances are not allowed")),e.promise}return this.currentChooserPromiseObject=this.$q.defer(),this.init().then((()=>{if(this.status===p.Initialized){const n=this.getExplorer(t);return this.preference.getPreference(m,"[]",!0).then((t=>{const a=JSON.parse(t.value).map((e=>e.bearer_token.key));n.update({locale:e,tokens:a}),n.choose()})).catch((t=>{console.error(t);n.update({locale:e,tokens:[]}),n.choose()}))}})),this.currentChooserPromiseObject.promise}getCloudStorageIntegrationInfo(){return{client_id:this.clientId,base_url:this.apiUrl}}deleteCloudStorageIntegrationAccount(e,t){return e.filter((e=>e.id!==t))}}var g=n("aHpC"),b=n("VAMW"),f=n("6fZB");n.d(t,"a",(function(){return v})),n.d(t,"b",(function(){return y}));const v="ultra.service.cloud.drive",y="cloudDrive";class S{constructor(e){this.cloudDriveStorage=e}openFilePicker(e,t){return Object(f.a)(this.cloudDriveStorage.openFilePicker(e,t))}}class C{constructor(e,t,n){this.service=e,this.CloudDriveModel=t,this.CloudDriveTaskModel=n,this.key=b.d.CloudDriveService}isCloudServiceAvailable(){return Object(f.a)(this.service.isCloudServiceAvailable())}get cloudDriveStorage(){return new S(this.service.cloudDriveStorage)}}let E=class{constructor(e,t,n,a,i,r,s,o,l){this.$rootScope=e,this.$q=t,this.$timeout=n,this.bbLocalize=a,this.CloudDriveModel=i,this.CloudDriveTaskModel=r,this.windowSize=s,this.bbScriptLoader=o,this.preferences=l,this.isGettingFilesInfo=!1,this.currentLocale=this.bbLocalize.getAppLocale(),Object(b.f)(new C(this,i,r))}cloudDriveStorageFactory(e){const t=new h(this.$q,this.bbLocalize,this.$timeout,this.bbScriptLoader,this.preferences,this.$rootScope);return t.clientId=e.clientId,t.redirectUrl=e.redirectUrl,t.provider=e.name,t.apiUrl=e.apiUrl,t.loaderUrl=e.loaderUrl,t.useLoaderExplorer=e.useLoaderExplorer,t.persist=e.persist,t.tokens=e.tokens,t}getCloudDrivesInfo(){const e=this.$q.defer();return this.cloudDrivesInfo?e.resolve():this.CloudDriveModel.$collection().$fetch().$then((t=>{this.cloudDrivesInfo=t,i.forEach(this.cloudDrivesInfo,(e=>{"cloudstorageintegration"===e.name&&(this.cloudDriveStorage=this.cloudDriveStorageFactory(e))})),e.resolve()}),(t=>{e.reject(t)})),e.promise}initializeCloudDrive(){const e=this.$q.defer();return this.getCloudDrivesInfo().then((()=>{this.cloudDriveStorage?this.cloudDriveStorage.isInitialized&&this.currentLocale===this.bbLocalize.getAppLocale()?e.resolve(this.cloudDriveStorage):(this.currentLocale=this.bbLocalize.getAppLocale(),this.cloudDriveStorage.init().then((()=>{e.resolve(this.cloudDriveStorage)}))):e.reject("No such cloud drive!")})),e.promise}isCloudServiceAvailable(){const e=this.$q.defer();return this.initializeCloudDrive().then((t=>{e.resolve(t.isInitialized)})).catch((()=>{e.resolve(!1)})),e.promise}getDriveUserInfo(){const e=this.$q.defer(),t=this.cloudDriveStorage.driveUserInfo,n=this.cloudDriveStorage.accessToken;return t?e.resolve(t):n?e.resolve(this.CloudDriveModel.$new("CloudStorageIntegration").me.$fetch({accessToken:n}).$asPromise()):e.resolve(),e.promise}};E=Object(a.a)([Object(a.c)(0,Object(g.b)("$rootScope")),Object(a.c)(1,Object(g.b)("$q")),Object(a.c)(2,Object(g.b)("$timeout")),Object(a.c)(3,Object(g.b)(s.serviceName)),Object(a.c)(4,Object(g.b)(o.h.serviceName)),Object(a.c)(5,Object(g.b)(o.i.serviceName)),Object(a.c)(6,Object(g.b)(l.b)),Object(a.c)(7,Object(g.b)(r.b)),Object(a.c)(8,Object(g.b)(c.c))],E);i.module(v,[o.N,l.a,r.a,c.b]).service(y,E)},"W/rt":function(e,t){e.exports='<bb-modal class="notification"\n          modal-title-key="components.services.error-modal.error-persist-question.title"\n          analytics-id-tag-prefix="components.services.error-modal.error-persist-question">\n  <div name="modal-contents">\n    <p bb-translate>components.services.error-modal.error-persist-question.description</p>\n    <bb-session-debug-modal-button></bb-session-debug-modal-button>\n  </div>\n  <button name="modal-footer-button-primary"\n          ng-click="$parent.$dismiss()"\n          class="button large reload-page-button js-primary-button"\n          analytics-id="components.services.error-modal.error-persist-question.alt"\n          bb-translate>components.services.error-modal.error-persist-question.alt</button>\n</bb-modal>\n'},W7eU:function(e,t){e.exports='<bb-modal class="notification"\n          modal-title-key="components.directives.fileUpload.errorTitle"\n          analytics-id-tag-prefix="components.directives.fileUpload">\n  <div name="modal-contents">\n    <p>\n      <bb-translate>{{::errorModalErrorKey}}</bb-translate>\n    </p>\n  </div>\n  <button name="modal-footer-button-primary" role="button" class="button js-primary-button" ng-click="$parent.$dismiss()" analytics-id="components.directives.fileUpload.cancelUploadText">\n    <bb-translate>components.directives.fileUpload.cancelUploadText</bb-translate>\n  </button>\n</bb-modal>\n'},WIGI:function(e,t,n){"use strict";function a(e,t,n){"function"==typeof aptrinsic&&t.getRoles().then((t=>(function(e,t,n){var a,i,r;const s=null!==(a=t.locale)&&void 0!==a?a:n.getAppLocale(),o={id:`${e.siteId}_${t.uuid}`,insRoles:t.insRoles,systemRole:t.systemRole,systemRoles:t.systemRoles,locale:s},l={id:e.siteId,institutionName:e.institutionName,institutionType:e.institutionType,country:e.country,region:e.region,acceptSurveys:null!==(i=e.acceptSurveys)&&void 0!==i&&i,productUpdates:null!==(r=e.productUpdates)&&void 0!==r&&r};aptrinsic("identify",o,l)}(e.getSystemInfo(),t,n),t)))}function i(e){"function"==typeof aptrinsic&&aptrinsic("set","globalContext",e)}function r(){"function"==typeof aptrinsic&&aptrinsic("remove","globalContext",["courseRole"])}n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return r}))},WShm:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return s}));var a=n("Llzl"),i=n("0JpG");const r="ultra.directives.validate.date",s="bbValidateDate";class o{constructor(e,t){this.$parse=e,this.bbLocalize=t,this.require="ngModel",this.restrict="A",this.getISODate=e=>e.getFullYear()+"-"+("0"+(e.getMonth()+1)).slice(-2)+"-"+("0"+e.getDate()).slice(-2),this.getDateParser=(e,t,n,a)=>r=>{if(a.$isEmpty(r))return a.$setValidity("date",!0),null;let s;try{s=this.bbLocalize.parseDateSync(r,i.ILocaleDateFormat.Short,e,a.$modelValue)}catch(e){return a.$setValidity("date",!1),a.$modelValue}return a.$setValidity("date",!0),"date"!==n.type&&(r=this.bbLocalize.formatDateSync(s,i.ILocaleDateFormat.Short,e))!==a.$viewValue&&(a.$setViewValue(r),t.is(":focus")||a.$render()),s},this.getMinDateValidator=(e,t,n,a)=>t=>{const r=this.$parse(n.min)(e),s=a.$isEmpty(t)||t.getTime()>r.getTime();return s?delete a.$error.minDate:a.$error.minDate={dateMin:this.bbLocalize.formatDateSync(r,i.ILocaleDateFormat.Short)},s},this.getMaxDateValidator=(e,t,n,a)=>t=>{const r=this.$parse(n.max)(e),s=a.$isEmpty(t)||t.getTime()<r.getTime();return s?delete a.$error.maxDate:a.$error.maxDate={dateMax:this.bbLocalize.formatDateSync(r,i.ILocaleDateFormat.Short)},s},this.getDateFormatter=(e,t,n,a)=>()=>{a.$setValidity("date",!0);const t=a.$modelValue;return a.$isEmpty(t)?"":"date"===n.type?this.getISODate(t):this.bbLocalize.formatDateSync(t,i.ILocaleDateFormat.Short,e)},this.link=(e,t,n,a)=>{a.$parsers.push(this.getDateParser(e,t,n,a)),a.$formatters.push(this.getDateFormatter(e,t,n,a)),n.min&&(a.$validators.minDateValidator=this.getMinDateValidator(e,t,n,a)),n.max&&(a.$validators.maxDateValidator=this.getMaxDateValidator(e,t,n,a)),t.on("blur",(()=>{a.$render()}))}}}o.$inject=["$parse",i.serviceName];a.module(r,[i.moduleName]).directive(s,["$parse",i.serviceName,(e,t)=>new o(e,t)])},"X/qj":function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return p}));var a=n("D57K"),i=n("ZQFV"),r=n("Llzl"),s=n("Fvsw"),o=n("Qbdf"),l=n("fYJU"),c=n("jhBu"),d=n("Sa5G"),u=n("aHpC");const m="ultra.components.services.gradebookPermission",p="gradebookPermission";let h=class{constructor(e,t,n,a){this.context=e,this.currentCourse=t,this.currentUser=n,this.entitlementService=a}isEntitled(e,t){return this.entitlementService.isEntitled(e,t)}canDeanonymizeGrades(e){return this.isEntitled("course.gradebook-deanonymize.EXECUTE",e)}canEnterFeedback(e){return this.isEntitled("course.gradebook-grades.feedback.EXECUTE",e)}canEnterGrades(e){return this.canExecute(e)}canViewAssessmentException(e){return this.isEntitled(d.b.ViewException,e)}canDelegatedEnterAttemptFeedback(e,t){return this.canDelegatedModifyAttempt(e,t)&&this.canEnterFeedback()}canDelegatedEnterAttemptGrades(e,t){return this.canDelegatedModifyAttempt(e,t)&&this.canEnterGrades()}canDelegatedModifyAttempt(e,t){return!e.delegatedGrading||(!t||(!!e.isUserReconciler(this.currentUser.userId)||!t.isReconciled()))}canDelegatedReconcileAttempt(e){return e.delegatedGrading&&e.isUserReconciler(this.currentUser.userId)}canExecute(e){return this.isEntitled("course.gradebook-grades.EXECUTE",e)}canModify(e){return this.isEntitled(i.q.ModifyGradebook,e)}canModifyItemDueDate(e){return this.isEntitled("course.gradebook-item.duedate.MODIFY",e)}canObserve(e){return this.isEntitled(i.q.Observe,e)}canOverrideGrades(e){return this.canExecute(e)}canPostGrades(e,t){const n=t||this.context.column,a=e||this.currentCourse.courseId;return n&&n.delegatedGrading?n.isUserReconciler(this.currentUser.userId)&&this.isEntitled("course.gradebook-grades.publish.EXECUTE",a):this.isEntitled("course.gradebook-grades.publish.EXECUTE",a)}canView(e){return this.isEntitled(i.q.ViewGradebookMetaData,e)}canViewAttempts(e){return this.isEntitled(i.q.ViewAttempts,e)}canViewGrades(e){return this.isEntitled("course.gradebook-grades.VIEW",e)}canViewBulkDownload(e){return this.isEntitled(i.q.ViewGrades,e)}};h=Object(a.a)([Object(a.c)(0,Object(u.b)(s.b)),Object(a.c)(1,Object(u.b)(o.e)),Object(a.c)(2,Object(u.b)(l.b)),Object(a.c)(3,Object(u.b)(c.b))],h);r.module(m,[c.a,o.b,s.a]).service(p,h)},X455:function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"d",(function(){return g})),n.d(t,"b",(function(){return b})),n.d(t,"c",(function(){return f}));var a=n("D57K"),i=n("vYaK"),r=n("pjml"),s=n("zGdY"),o=n("yC9S"),l=n("lVRt"),c=n("aHpC"),d=n("fYJU"),u=n("eQBN"),m=n("VAMW"),p=n("Qbdf");const h="ultra.service.course-context.membership",g="currentCourseMembership",b=g+"Provider",f=l.a;class v{constructor(e){this.service=e,this.key=m.d.CurrentCourseMembership}isActAsInstructorMembership(){return this.service.isActAsInstructorMembership()}isStudentMembership(){return this.service.isStudentMembership()}}let y=class{constructor(e,t,n,a,i){this.$q=e,this.$rootScope=t,this.currentUser=n,this.studentPreview=a,this.CourseModel=i;const r=this;o.b.OnRootScope(t,p.a,((e,t,n)=>{null!=t&&null!==t.id||r.clear()})),Object(m.f)(new v(this))}get courseMembership(){return this._courseMembership}clear(){this._courseMembership=null}load(e){return e?this.currentUser.userId?this.courseMembership&&this.courseMembership.course&&this.courseMembership.userId===this.currentUser.userId?e.id!==this.courseMembership.course.id?this.$q.reject(new Error("Cannot resolve course membership because given course does not match the one for the current course membership")):this.courseMembership.$asPromise():e.users.$find(this.currentUser.userId,{expand:"courseRole"}).$allow(["400-499"]).$asPromise().then((e=>(this._courseMembership=e,this._courseMembership.isInStudentPreview=()=>this.studentPreview.isInIframeOfPreviewMode(),e))):this.$q.reject(new Error("Cannot resolve course membership because currentUser service has no userId")):this.$q.reject(new Error("Cannot load course membership because no course model was provided"))}hasCourseMembership(){return!(!this.courseMembership||this.courseMembership.$response.status===s.S.NotFound)}availabilityHasBeenBypassed(){return this.courseMembership&&this.courseMembership.availabilityHasBeenBypassed()}courseIsOpen(){return this.courseMembership&&this.courseMembership.courseIsOpen()}courseIsPrivate(){return this.courseMembership&&this.courseMembership.courseIsPrivate()}courseIsComplete(){return this.courseMembership&&this.courseMembership.courseIsComplete()}isStudentMembership(){return this.courseMembership&&this.courseMembership.isStudentMembership()}isGuestMembership(){return this.courseMembership&&this.courseMembership.isGuestMembership()}isStudentOrGuestMembership(){return this.courseMembership&&this.courseMembership.isStudentOrGuestMembership()}isActAsInstructorMembership(){return this.courseMembership&&this.courseMembership.isActAsInstructorMembership()}isTeachingAssistantMembership(){return this.courseMembership&&this.courseMembership.isTeachingAssistantMembership()}isInRoleBucket(e){return this.courseMembership&&this.courseMembership.isInRoleBucket(e)}isDueDateExcepted(){return this.courseMembership&&this.courseMembership.isDueDateExcepted()}};y=Object(a.a)([Object(a.c)(0,Object(c.b)("$q")),Object(a.c)(1,Object(c.b)("$rootScope")),Object(a.c)(2,Object(c.b)(d.b)),Object(a.c)(3,Object(c.b)(u.e)),Object(a.c)(4,Object(c.b)(i.serviceName))],y);const S=[d.a,r.N,u.b];angular.module(h,S).provider(g,class{constructor(){this.$get=["$injector",e=>e.instantiate(y)],this.name=f,this.resolve=[l.c,u.e,g,"$q",(e,t,n)=>t.init(e).then((()=>n.load(e)))]}})},XGja:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return o}));var a=n("71td"),i=n("lUN/");function r(e,t){i.a();const n=e?e.find(":tabbable"):a(":tabbable"),r=t||a(document.activeElement);let s=0;if(1===r.length){const e=n.index(r);e+1<n.length&&(s=e+1)}n.eq(s).focus()}function s(e,t){i.a();const n=e?e.find(":tabbable"):a(":tabbable"),r=t||a(document.activeElement);let s=n.length-1;if(1===r.length){const e=n.index(r);e>0&&(s=e-1)}n.eq(s).focus()}function o(e,t,n){i.a(),e.is(":tabbable")||null!=e.attr("tabindex")?e.is(":tabbable")&&"-1"===e.attr("tabindex")&&e.removeAttr("tabindex"):e.attr("tabindex","-1"),n&&e.closest(n).removeClass("ng-hide"),t?t(e):e.focus()}},XfOu:function(e,t,n){"use strict";n.r(t),n.d(t,"serviceName",(function(){return s})),n.d(t,"sortRubricData",(function(){return o}));n("QLzv");var a=n("yCC5"),i=n("Rjd/"),r=n("nkTj");const s=a.Xb;function o(e){e.columnHeaders&&e.columnHeaders.length>0&&e.columnHeaders.sort(((e,t)=>e.position-t.position)),e.rows&&e.rows.length>0&&(e.rows.sort(((e,t)=>e.position-t.position)),e.rows.forEach((e=>{e.cells&&e.cells.length>0&&e.cells.sort(((e,t)=>e.position-t.position))})))}function l(e){e.rows&&e.rows.length>0&&e.rows.forEach((t=>{t.isCurrentUserEligibleToAlignGoals=function(){return!0===e.permissions.edit&&!e.readOnly},t.getContentIdForGoalAlignment=function(){return"blackboard.plugin.rubric.api.core.data.RubricRow;"+t.id},t.getContentTitleForGoalAlignment=()=>t.header}))}i.a.factory(s,["restmod",r.c,(e,t)=>e.model().mix({$extend:{Record:{canDelete(){return this.permissions&&this.permissions.delete},isCurrentUserEligibleToAlignGoals(){return this.permissions&&!0===this.permissions.edit},getContentIdForGoalAlignment(){return"blackboard.plugin.rubric.api.core.data.Rubric;"+this.id},getContentTitleForGoalAlignment(){return this.title},saveAlignedGoals(e,t){let n;return t&&(n=t.map((e=>({goalId:e.id,isVisibleToStudent:!0,goal:e})))),e&&(this.rows=this.rows.map((t=>(t.id===e&&(t.alignedGoals=n),t)))),this.$send({method:"PATCH",url:this.$url(),data:{rows:this.rows}}).$then((()=>{this.$getPreviousVersion()&&(this.$getPreviousVersion().rows=this.rows)}))}}},$hooks:{"after-request":function(e){e&&e.data&&(e.data.rows&&e.data.columnHeaders?(o(e.data),l(e.data)):e.data.results&&e.data.results.length>0&&e.data.results.forEach((e=>{e.rows&&e.columnHeaders&&(o(e),l(e))})))},"before-save":function(e){e.data.columnHeaders&&e.data.columnHeaders.forEach(((e,t)=>{e.position=t})),e.data.rows&&e.data.rows.forEach(((e,t)=>{e.position=t,e.cells.forEach(((e,t)=>{e.position=t}))}))}}})])},"Xq/A":function(e,t,n){"use strict";var a=n("Llzl"),i=n("Sa5G"),r=n("g66W");var s=n("DsaG"),o=n("Q/M7"),l=n("e6jQ"),c=n("AuQm"),d=n("IbyE");n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return m})),n.d(t,"a",(function(){return b}));const u="ultra.services.bbml-editor",m="bbMLEditorService",p="file",h="embedded-unsafe-html",g="http://localhost";class b{constructor(e,t,n){this.$q=e,this.DSCacheFactory=t,this.fileViewer=n}static get VERSION_INDICATOR_PREFIX(){return'\x3c!-- {"bbMLEditorVersion":'}static get CURRENT_VERSION_INDICATOR(){return b.VERSION_INDICATOR_PREFIX+"1} --\x3e"}static get EMBEDDED_LINK_PREFIX(){return"https://"}getBbMLFileType(e){const t=e.dataset;return(null==t?void 0:t.bbtype)||p}convertBbMLToContentBlocks(e){var t;const n=new Set,a=[];let s=!1;var o;o=e,r.i(o,b.VERSION_INDICATOR_PREFIX)&&(s=!0);const l=document.createElement("div");l.innerHTML=e;for(let e=0;e<l.children.length;e++){const r=l.children[e];let s;if("A"===r.tagName&&this.getBbMLFileType(r)===p)s=this.convertBbMLToFileBlock(r),s.blockType=i.c.File;else if("DIV"===r.tagName){const e=r.innerHTML.trim();e&&(s={blockType:i.c.Text,textBlock:e,id:this.getBlockIdFromBbML(r)})}else if("A"===r.tagName&&this.getBbMLFileType(r)===h){const{dataset:e,href:n}=r;let a;if(null==e?void 0:e.bbfile)try{a=null===(t=JSON.parse(e.bbfile))||void 0===t?void 0:t.linkName}catch(e){}s={blockType:i.c.Html,textBlock:"",fileBlock:{downloadUrl:n,file:{fileName:a}},id:this.getBlockIdFromBbML(r)}}s&&!n.has(s.id)&&(n.add(s.id),a.push(s))}return s||0!==a.length||(this.contains(e,b.EMBEDDED_LINK_PREFIX)||(s=!0),a.push({blockType:i.c.Text,textBlock:e,id:this.generateBlockId()})),{contentBlocks:a,isBbmlEditorCompliant:s}}contains(e,t){return(e||"").indexOf(t)>-1}convertBbMLToFileBlock(e){var t;const n=e.dataset,a={file:{}};let i=null;if(null==n?void 0:n.bbfile)try{const e=JSON.parse(n.bbfile);a.isDecorative=e.isDecorative,a.alternativeText=e.alternativeText,a.linkName=e.linkName,a.currentMimeType=e.mimeType,a.render=null!==(t=e.render)&&void 0!==t?t:d.s.Inline,a.ui={isRenderedInline:Object(c.ib)(a.render)},a.viewerData={},e.bbFileUuid&&(a.viewerData.bbFileUuid=e.bbFileUuid),e.viewerUuid&&(a.viewerData.viewerUuid=e.viewerUuid),e.viewerUrl&&(a.viewerData.viewerUrl=e.viewerUrl),e.viewerTimeToWait&&(a.viewerData.viewerTimeToWait=parseInt(e.viewerTimeToWait+"",10))}catch(e){}a.linkName||(a.linkName=e.innerHTML.substr(0,e.innerHTML.lastIndexOf("?"))),a.currentMimeType||(a.currentMimeType=e.innerHTML.substr(e.innerHTML.lastIndexOf("?")+1)),a.ui||(a.ui={isRenderedInline:this.fileViewer.shouldRenderInlineByDefault(a)}),i=this.getBlockIdFromBbML(e);let r=e.href;return 0===r.indexOf(g)&&(r=Object(o.c)(r.substr(g.length))),a.downloadUrl=r,this.fileViewer.initUiField(a),{fileBlock:a,id:i}}getBlockIdFromBbML(e){const t=e.dataset;return(null==t?void 0:t.bbid)?t.bbid:e.id?e.id:this.generateBlockId()}convertContentBlocksToBbML(e,t){const n=document.createElement("div");if(e.forEach((e=>{var t,a;if(e.blockType===i.c.File){const a=document.createElement("a"),i=a.dataset;if(a.href=e.fileBlock.downloadUrl,i.bbid=e.id,e.fileBlock.ui){const n={};n.render=null!==(t=e.fileBlock.render)&&void 0!==t?t:d.s.Inline,null!=e.fileBlock.isDecorative&&(n.isDecorative=e.fileBlock.isDecorative),e.fileBlock.alternativeText&&(n.alternativeText=e.fileBlock.alternativeText),e.fileBlock.linkName&&(n.linkName=e.fileBlock.linkName),e.fileBlock.currentMimeType&&(n.mimeType=e.fileBlock.currentMimeType),e.fileBlock.viewerData&&(e.fileBlock.viewerData.bbFileUuid&&(n.bbFileUuid=e.fileBlock.viewerData.bbFileUuid),e.fileBlock.viewerData.viewerUuid&&(n.viewerUuid=e.fileBlock.viewerData.viewerUuid)),i.bbfile=JSON.stringify(n)}a.innerHTML=e.fileBlock.linkName,n.appendChild(a)}else if(e.blockType===i.c.Text&&e.textBlock){const t=document.createElement("div");t.dataset.bbid=e.id,t.innerHTML=e.textBlock,n.appendChild(t)}else if(e.blockType===i.c.Html&&(null===(a=null==e?void 0:e.fileBlock)||void 0===a?void 0:a.downloadUrl)){const t=document.createElement("a"),{downloadUrl:a,file:i}=e.fileBlock,{fileName:r}=i,s=t.dataset;s.bbid=e.id,s.bbfile=JSON.stringify({linkName:r}),s.bbtype=h,t.href=a,n.appendChild(t)}e.isNewToBbML&&delete e.isNewToBbML})),n.innerHTML){let a="";return t&&e&&e.length&&(a=b.CURRENT_VERSION_INDICATOR),a+n.innerHTML}return n.innerHTML}generateBlockId(){return"bbml-editor-id_"+l.b()}writeBbMLLink(e,t,n){if(0===n.length)return;let a="";n.length>1&&(a+="<ul>"),n.forEach((e=>{n.length>1&&(a+="<li>"),"lti"===e.type?a+='<a data-bbfile="'+e.data+'" data-bbtype="lti" href="#">'+e.title+"</a>":a+='<a href="'+e.url+'" target="_blank">'+e.title+"</a>",n.length>1&&(a+="</li>")})),n.length>1&&(a+="</ul>")}}b.$inject=["$q","DSCacheFactory",s.b];a.module(u,["angular-data.DSCacheFactory",s.a]).service(m,b)},XseH:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return s}));n("my/J");var a=n("nsO7"),i=n("Llzl"),r=n("H8CZ");const s="ultra.components.directives.hasFooter";class o{constructor(t,n,i){this.scope=t,this.element=n,this.attrs=i,this.domChanged=()=>{const t=this.element.find("footer:not(.notification)").filter(":visible").filter((function(){return e(this).height()>0})),n=this.element.find(".import-status-bar").filter(":visible").filter((function(){return e(this).height()>0}));t.length>0||n.length>0?(e(this.element).addClass("has-footer"),e(this.element).hasClass("in-preview-mode")&&e(window.parent.document).find("body").addClass("has-footer-in-preview-mode"),t.find(".navigation-visible").length>0&&e(this.element).addClass("has-navigation-footer")):(e(this.element).removeClass("has-footer"),e(this.element).hasClass("in-preview-mode")&&e(window.parent.document).find("body").removeClass("has-footer-in-preview-mode"))};const s=a.debounce(this.domChanged,100,{leading:!0,trailing:!0});this.observer=new MutationObserver(s),this.observer.observe(n[0],{childList:!0,subtree:!0,attributes:!0,attributeFilter:["class","style"]}),r.b(this.element,s),r.a(this.element,s),this.scope.$on("$destroy",(()=>{this.observer.disconnect(),r.b(this.element,s),r.a(this.element,s)}))}}o.$inject=["scope","element","attrs"];class l{constructor(e){this.$injector=e,this.restrict="A",this.link=(e,t,n)=>{e.hasfooter=this.$injector.instantiate(o,{scope:e,element:t,attrs:n})}}}l.$inject=["$injector"],i.module(s,[]).directive("bbHasFooter",["$injector",e=>e.instantiate(l)])}).call(this,n("71td"))},"Y/dt":function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return r})),n.d(t,"c",(function(){return s})),n.d(t,"e",(function(){return o})),n.d(t,"f",(function(){return l}));const a="EVENT_ATTEMPT_SAVING_START",i="EVENT_ATTEMPT_SAVING_DONE",r="EVENT_ATTEMPT_SUBMITTING_START",s="EVENT_ATTEMPT_SUBMITTING_DONE",o="EVENT_ATTEMPT_TRIGGER_SAVE",l="bb-assessment-persist-pending-saves"},Y3OE:function(e,t,n){"use strict";var a=n("IbyE");t.a=a.i},Y88D:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return i}));var a=n("Llzl");const i="ultra.components.directives.accessibility.clickFocus";class r{constructor(t,n){this.injector=t,this.timeout=n,this.restrict="A",this.link=(t,n,a)=>{a.bbClickFocus.length&&n.on("click",(()=>{this.timeout((()=>{if(a.indexToFocus){const t=Number(a.indexToFocus);e(a.bbClickFocus).eq(t).focus()}else{e(a.bbClickFocus).focus()}}),120)}))}}}r.$inject=["$injector","$timeout"],a.module(i,[]).directive("bbClickFocus",["$injector",e=>e.instantiate(r)])}).call(this,n("71td"))},YCUs:function(e,t){e.exports='<bb-modal class="notification"\n          modal-title-key="components.directives.fileUpload.packageTitle"\n          analytics-id-tag-prefix="components.directives.fileUpload">\n  <div name="modal-contents">\n    <p>\n      <bb-translate>components.directives.fileUpload.packageFull</bb-translate>\n    </p>\n  </div>\n  <div name="modal-footer" class="reveal-modal__footer-content reveal-modal__footer-content--gray">\n    <div class="reveal-modal__footer-buttons">\n      <span class="reveal-modal__footer-button-container">\n        <button role="button" class="button button--secondary js-secondary-button dismiss-message expand" ng-click="fileUpload.modalCancelUpload()" analytics-id="components.directives.fileUpload.takeMeBack">\n          <bb-translate>components.directives.fileUpload.takeMeBack</bb-translate>\n        </button>\n      </span>\n      <span class="reveal-modal__footer-button-container">\n        <button role="button" ng-click="fileUpload.addContent(true)" class="button button--secondary js-secondary-button" bb-translate-attrs="{\'aria-label\':\'components.directives.fileUpload.addAllContent\'}" analytics-id="components.directives.fileUpload.addAllContent">\n          <bb-translate>components.directives.fileUpload.addAllContent</bb-translate>\n        </button>\n      </span>\n      <span class="reveal-modal__footer-button-container">\n        <button role="button" ng-click="fileUpload.addContent(false)" class="button js-primary-button" bb-translate-attrs="{\'aria-label\':\'components.directives.fileUpload.letMeChoose\'}" analytics-id="components.directives.fileUpload.letMeChoose">\n          <bb-translate>components.directives.fileUpload.letMeChoose</bb-translate>\n        </button>\n      </span>\n    </div>\n  </div>\n</bb-modal>\n'},"YOs/":function(e,t,n){"use strict";var a=n("nsO7"),i=n("Llzl"),r=n("e6jQ"),s=n("lr7J"),o=n("0JpG"),l=n("en1n"),c=n("o2qC");n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return u}));const d="ultra.components.directives.table";function u(e,t,n){let a=e+"("+t+")";return n&&(a+=","+n+"("+t+")"),a}class m{constructor(e,t,n,r){this.scope=e,this.element=t,this.$q=n,this.localizeService=r,this.fetchingMoreRows=!1,this.initialDataLoaded=!1,this.throttledShowMore=a.throttle((()=>{const e=this.scope.config();if(this.scope.tableData().length<e.totalCount&&!this.fetchingMoreRows){this.fetchingMoreRows=!0;const t=this.$q.defer();this.scope.$emit("table.showMore",{instanceId:e.instanceId,callback:e=>{t.resolve(e)}}),this.scope.$root.$broadcast(s.a,e.instanceId+"-scroll-tray",t.promise),t.promise.then((()=>{this.fetchingMoreRows=!1}))}}),500);const o=this.scope.$watch("config()",(e=>{i.isDefined(e)&&(o(),this.init())}))}init(){const e=this.scope.config();e.instanceId=e.instanceId||r.a(),e.currentSortDirection=e.currentSortDirection||"asc",e.currentSortColumnIndex=e.currentSortColumnIndex||0,e.columns.forEach((e=>{i.isUndefined(e.visible)&&(e.visible=!0)}));const t=this.scope.$watchCollection("tableData()",(e=>{i.isArray(e)&&(this.initialDataLoaded=!0,t())}));if(e.customBreakpointFn){const t=a.throttle((t=>{e.customBreakpointFn(t)}),500);this.scope.$watch((()=>l.g()),(e=>{t(e)}))}this.addEventListeners(),this.setCaption()}addEventListeners(){this.element.on("click","tr th.sortable-header",(e=>{const t=i.element(e.currentTarget).attr("data-heading-index");if(i.isDefined(t)){const e=parseInt(t,10);this.sort(e)}}))}setCaption(){const e=this.scope.config();this.localizeService.loadBundle("components/directives/table").then((()=>{const t=this.localizeService.translateSync({locale:this.localizeService.getLocale(this.scope),key:"components.directives.table.caption",params:{caption:e.title,column:e.columns[e.currentSortColumnIndex].heading,direction:this.localizeService.translateSync({locale:this.localizeService.getLocale(this.scope),key:"components.directives.table."+e.currentSortDirection})},noWrap:!0});this.element.find("caption").text(t)}))}sort(e){const t=this.scope.config();this.initialDataLoaded=!1,t.currentSortColumnIndex===e?t.currentSortDirection="asc"===t.currentSortDirection?"desc":"asc":t.currentSortDirection="asc",t.currentSortColumnIndex=e,this.scope.$emit("table.sorted",{instanceId:t.instanceId,columnIndex:t.currentSortColumnIndex,sortDirection:t.currentSortDirection,callback:()=>{this.initialDataLoaded=!0,this.setCaption()}})}showMore(){this.throttledShowMore()}}m.$inject=["scope","element","$q",o.serviceName];class p{constructor(e){this.$injector=e,this.restrict="E",this.template=c,this.transclude=!0,this.scope={config:"&",tableData:"&"},this.controller=["$scope",function(e){this.getConfig=function(){return e.config()}}],this.link=(e,t)=>{e.table=this.$injector.instantiate(m,{scope:e,element:t})}}}p.$inject=["$injector"],i.module(d,[s.b,o.moduleName]).directive("bbTable",["$injector",e=>e.instantiate(p)])},YRs5:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n("Llzl"),i=n("Qbdf"),r=n("0JpG"),s=n("TnpK"),o=n("nmzr");const l="ultra.course.course-tasks.router";a.module(l,[i.b,r.moduleName,s.b]).config([i.c,s.c,(e,t)=>{t.peekState(o.p.COURSE_TASKS_LOGS,{abstract:!0,url:"/courseTasks",require:()=>Promise.all([n.e(68),n.e(98)]).then(n.bind(null,"+nHB")),resolve:{[i.d]:e.resolve,translations:[r.serviceName,e=>e.loadBundle("features/course/course-tasks")]},panelClass:"full"}).peekState(o.p.COURSE_TASKS_PANEL,{url:"/tasks",views:{"course-tasks@":{require:[()=>Promise.all([n.e(68),n.e(766)]).then(n.bind(null,"+KHK")),()=>Promise.all([n.e(68),n.e(98)]).then(n.bind(null,"+nHB"))]}},pageTitle:"course.courseTasks.tasks.title",peekStates:["content-manage"],panelClass:"full"}).peekState(o.p.COURSE_LOGS_PANEL,{url:"/logs",views:{"course-tasks@":{require:[()=>Promise.all([n.e(68),n.e(765)]).then(n.bind(null,"WRh5")),()=>Promise.all([n.e(68),n.e(98)]).then(n.bind(null,"+nHB"))]}},pageTitle:"course.courseTasks.logs.title",panelClass:"full"})}])},"YVo+":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n("Llzl"),i=n("w9Zy"),r=n("TnpK"),s=n("nmzr");const o="profile.update-password.routes";a.module(o,[i.d,r.b]).config([r.c,e=>{e.peekState(s.D.UPDATE_PASSWORD_PEEK,{url:"/password/update",require:()=>n.e(660).then(n.bind(null,"aJE6")),pageTitle:"base.profile.update-password.pageTitle"})}])},YfM7:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n("Llzl"),i=n("5MwF"),r=n("TnpK");const s="ultra.base.demo.routes";a.module(s,[r.b]).config([r.c,e=>{i.a.features.componentDemos&&e.peekState("demoComponent",{url:"/component/:componentId",require:()=>n.e(703).then(n.bind(null,"YZN4")),panelClass:"full",pageTitle:"Sample Component"})}])},YzQO:function(e,t,n){"use strict";function a(e){if(e&&e.length){return e.hasClass("bb-editor")||e.is("[analytics-on]")||a(e.parent())}return!1}function i(e){var t;return!!(null===(t=null==e?void 0:e.closest)||void 0===t?void 0:t.call(e,"[data-no-angulartics-click]"))}function r(e){if(e&&e.length)return e.closest("[bb-click-to-invoke-child]").length>0?e.attr("analytics-id"):e.attr("analytics-id")||e.find("[analytics-id]").attr("analytics-id")}function s(e){if(!e||!e.length)return;const t=e.closest("[analytics-id]").attr("analytics-id");return t||(e.attr("[bb-click-to-invoke-child]")||e.closest("[bb-click-to-invoke-child]").length>0?e.find("[analytics-id]").attr("analytics-id")||e.closest("[bb-click-to-invoke-child]").find("[analytics-id]").attr("analytics-id"):void 0)}function o(e){if(e&&e.length){switch((e.prop("tagName")||"").toLowerCase()){case"a":case"input":case"button":return r(e);default:return o(e.parent())}}}function l(e){if(e&&e.length)return e.attr("analytics-context")||l(e.parent())}n.d(t,"e",(function(){return a})),n.d(t,"f",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return l}))},"Z+K4":function(e,t,n){"use strict";var a;!function(e){e.DeleteAdaptiveRelease="course.adaptiverelease.DELETE",e.ModifyAdaptiveRelease="course.adaptiverelease.MODIFY",e.ViewAdaptiveRelease="course.adaptiverelease.VIEW",e.ModifyAdaptiveReleaseDates="course.adaptiverelease.dates.MODIFY",e.DeleteAssessment="course.assessment.DELETE",e.ModifyAssessment="course.assessment.MODIFY",e.ViewAssessment="course.assessment.VIEW",e.ModifyAttendance="course.attendance.MODIFY",e.ViewAttendance="course.attendance.VIEW",e.ViewChildCourse="course.children.VIEW",e.ModifyAllowConversationReplies="course.conversations.allow-replies.MODIFY",e.MessageAllMembersInCourse="course.conversations.message-all-members.CREATE",e.MessageAllActAsInstructorInCourse="course.conversations.message-all-act-as-instructor-roles.CREATE",e.MessageAllStudentsInCourse="course.conversations.message-all-students.CREATE",e.ModifyTimeLimitAccomodation="course.timelimit-exception.MODIFY",e.ModifyDueDateException="course.duedate-exception.MODIFY",e.ViewTimeLimitAccomodation="course.timelimit-exception.VIEW",e.ViewDueDateException="course.duedate-exception.VIEW",e.ViewPreviewStudent="course.user-impersonate.EXECUTE",e.ModifyBannerImage="course.banner.MODIFY",e.ModifyBannerVisibility="course.banner.visibility.MODIFY"}(a||(a={})),t.a=a},ZBYA:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return s}));var a=n("Llzl"),i=n("pjml");const r="ultraUi.components.services.predict.institutionPreference",s="predictInstitutionPreference";class o{constructor(e,t){this.$rootScope=e,this.predictInstitutionPreferenceModel=t}getInstitutionPreference(e){return this.predictInstitutionPreferenceModel.getInstitutionPreference(e)}}o.$inject=["$rootScope",i.cb.serviceName];a.module(r,[i.N]).service(s,o)},ZMjE:function(e,t){e.exports='<div class="import-status-bar import-course-error" ng-class="{\'below\': contentImportStatusBarController.hideStatusBar()}"\n     ng-if="display" bb-load-bundle="components/directives/import-status-bar">\n  <div class="row">\n      <div bb-first-time-container>\n        <div class="columns guidance-wrapper import-status-bar-message">\n          <span class="successful-import-message ellipsis" bb-focus bb-translate ng-if="contentImportStatusBarController.notCarriedForwardItemsCount === 0">\n            course.import.statusBar.success\n          </span>\n          <bb-guidance component-key="importAnalysis" page-container-selector=".course-outline"\n                       class="guidance-element-overlay push-right push-top" ng-if="contentImportStatusBarController.notCarriedForwardItemsCount > 0">\n            <bb-translate>course.import.statusBar.tooltip.main</bb-translate>\n          </bb-guidance>\n          <a bb-focus \n             href="javascript:void(0);" \n             class="not-copied-details" \n             ng-if="contentImportStatusBarController.notCarriedForwardItemsCount > 0"\n             ng-class="{\'not-carry-details-warn\': contentImportStatusBarController.notCarriedForwardItemsCount > 0}"\n             ng-click="contentImportStatusBarController.goToImportReport()"\n             analytics-id="course.import.statusBar.importReport.link">\n            <div class="status-bar-alarm" bb-guidance-target component-key="importAnalysis">\n                <bb-translate class="ellipsis" translate-values="{ count: contentImportStatusBarController.notCarriedForwardItemsCount }">\n                  course.import.statusBar.itemsCount.plural\n                </bb-translate>\n            </div>\n          </a>\n        </div>\n      </div>\n    <div class="columns confirm-column right">\n      <button class="button default js-import-confirm" \n              ng-click="contentImportStatusBarController.confirm()"\n              analytics-id="course.import.statusBar.confirm.button">\n        <span bb-translate="course.import.statusBar.confirm"></span>\n      </button>\n      \x3c!-- POST v1 --\x3e\n      \x3c!--<button tabindex="0" class="right inverse undo-import" ng-click="contentImportStatusBarController.undo()">--\x3e\n      \x3c!--<span>Undo Import</span>--\x3e\n      \x3c!--</button>--\x3e\n    </div>\n  </div>\n</div>'},ZQFV:function(e,t,n){"use strict";var a={};n.r(a),n.d(a,"GRADE_POINTS_DECIMALS_RULE_1",(function(){return Oe})),n.d(a,"GRADE_POINTS_DECIMALS_RULE_2",(function(){return Ae})),n.d(a,"GRADE_POINTS_DECIMALS_RULE_3",(function(){return Pe})),n.d(a,"GRADE_POINTS_MAX_EDIT_DECIMALS",(function(){return xe})),n.d(a,"GRADE_POINTS_MAX_EDIT_INTEGRALS",(function(){return $e})),n.d(a,"GRADE_MAX_POINTS",(function(){return Ne})),n.d(a,"GRADE_MIN_POINTS",(function(){return De})),n.d(a,"GRADE_DEFAULT_POINTS",(function(){return Le})),n.d(a,"REDUCE_ERR_MARGIN_VALUE",(function(){return je})),n.d(a,"GradeUnits",(function(){return Me})),n.d(a,"GradePillSizes",(function(){return Ge})),n.d(a,"GradePercentileColor",(function(){return Re})),n.d(a,"GRADE_PILL_DEFAULT_BG_CLASS",(function(){return Be})),n.d(a,"parseGradeValue",(function(){return Fe})),n.d(a,"GradeNumberDisplayRule1Format",(function(){return Ue})),n.d(a,"GradeNumberDisplayRule2Format",(function(){return _e})),n.d(a,"GradeNumberDisplayRule3Format",(function(){return ze})),n.d(a,"GradeNumberEditFormat",(function(){return qe})),n.d(a,"determineDisplayRuleFromDigitCount",(function(){return He})),n.d(a,"sumFloatValues",(function(){return Ve})),n.d(a,"determineDisplayRuleFromNumber",(function(){return We})),n.d(a,"getPercentileColor",(function(){return Ke})),n.d(a,"gradeNeedsPosting",(function(){return Ye})),n.d(a,"getGradePillType",(function(){return Je})),n.d(a,"shouldShowPastDueZeroIndicator",(function(){return Ze})),n.d(a,"getGradeInputAriaLabelKey",(function(){return Qe}));var i=n("ERkP"),r=n("7nmT"),s=n("uDfI"),o=n("4JTD"),l=n("3/0u"),c=n("WBPx"),d=n("SToD"),u=n("caKH");const m=Object(d.a)((e=>{const{localize:t,downloadErrorDialogHidden:n,onCloseDialog:a}=e,{translate:r}=t;return i.createElement("div",null,i.createElement(u.c,{hidden:n,onDismiss:a,dialogContentProps:{type:l.DialogType.normal,title:r("gradebook.download-submissions.noneSelectedDialog.title"),subText:r("gradebook.download-submissions.noneSelectedDialog.body")},modalProps:{isAlert:!0},analyticsId:"download-submissions-error-dialog"},i.createElement(l.DialogFooter,null,i.createElement(c.AnalyticsDefaultButton,{onClick:()=>a(),analyticsId:"download-submissions-error-dialog-dialog-footer-primary-button"},r("gradebook.download-submissions.noneSelectedDialog.close")))))}));var p=n("Zwiy");class h extends i.PureComponent{constructor(){super(...arguments),this.cancel=()=>{this.props.onLeaveAction()},this.download=()=>{this.props.onDownloadAction()}}render(){const{localize:e}=this.props,{translate:t}=e;return i.createElement(p.BbPanelFooter,{primaryButtonProps:{text:t("gradebook.download-submissions.footer.submitButton"),onClick:this.download,id:"button-download"},secondaryButtonProps:{text:t("gradebook.download-submissions.footer.cancelButton"),onClick:this.cancel,id:"button-cancel"},analyticsId:"gradebook.downloadSubmissions.footer"})}}const g=Object(d.a)(h);var b=n("tN4z");class f extends i.PureComponent{constructor(){super(...arguments),this.onToggleSelected=()=>{this.props.onToggleSelected(this.props.contentItem)}}render(){const{contentItem:e,isSelected:t,rowIndex:n}=this.props,{date:a,name:r}=e;return i.createElement("tr",{className:`download-submissions-table__row js-item-id-${e.studentId}`,role:"row","aria-rowindex":n},i.createElement("td",{className:"download-submissions-content-table__cell -fixed-checkbox",role:"gridcell","aria-colindex":1,"aria-describedby":"download-submissions-content-table__cell__header--id-checkbox"},i.createElement("div",{className:"download-submissions-content-table__cell__data-wrapper"},i.createElement("div",{className:"download-submissions-content-table__cell__data-wrapper__data"},i.createElement(b.AnalyticsFormControlLabel,{label:"",htmlFor:`download-submissions.content-table-cell-checkbox-${n}`,className:"download-submissions-content-table__cell__checkbox",control:i.createElement(b.AnalyticsCheckbox,{id:`download-submissions.content-table-cell-checkbox-${n}`,onChange:this.onToggleSelected,checked:t,"aria-label":r,analyticsId:"downloadSubmissions.contentTable.cell.checkbox"}),analyticsId:"downloadSubmissions.contentTable.cell.label"})))),i.createElement("td",{className:"download-submissions-content-table__cell--title -column-name",role:"gridcell",tabIndex:-1,"aria-colindex":2,"aria-describedby":"download-submissions-content-table__cell__header--id-name"},i.createElement("div",{className:"download-submissions-content-table__cell__data-wrapper"},i.createElement("div",{className:"download-submissions-content-table__cell__data-wrapper__data"},r))),i.createElement("td",{className:"download-submissions-content-table__cell -column-date",role:"gridcell",tabIndex:-1,"aria-colindex":3,"aria-describedby":"download-submissions-content-table__cell__header--id-date"},i.createElement("div",{className:"download-submissions-content-table__cell__data-wrapper"},i.createElement("div",{className:"download-submissions-content-table__cell__data-wrapper__data"},this.formatDateString(a)))),i.createElement("td",{className:"download-submissions-content-table__cell -padder -padder-cell","aria-hidden":!0}))}formatDateString(e){const{localize:t}=this.props,{translate:n}=t;return e?i.createElement("div",null,n("gradebook.download-submissions.table.submissionDatetime",{datetime:e})):n("gradebook.download-submissions.table.submissionNoDatetime")}}const v=Object(d.a)(f);var y,S,C=n("j92x"),E=n("Begd"),I=n("0x+l"),k=n("myse");!function(e){e[e.name=0]="name",e[e.date=1]="date"}(y||(y={})),function(e){e[e.ascending=0]="ascending",e[e.descending=1]="descending"}(S||(S={}));class w extends i.PureComponent{constructor(e){super(e),this.onNameHeaderClick=()=>{this.handleSort(y.name,O,A)},this.onDateHeaderClick=()=>{this.handleSort(y.date,x,$)},this.getColumnSortInformation=e=>{if(this.state.sortColumn===e){if(this.state.sortDirection===S.ascending)return{icon:i.createElement(I.SortArrowAscending,null),sorted:"sortedAscending"};if(this.state.sortDirection===S.descending)return{icon:i.createElement(I.SortArrowDescending,null),sorted:"sortedDescending"}}return{icon:null,sorted:"unsorted"}},this.onSelectAllToggle=()=>{this.props.onSelectAllToggle()},this.state={sortColumn:y.name,sortDirection:S.ascending}}displaySpinnerOrChildren(){const{children:e,errorLoading:t,loadingContent:n,localize:a}=this.props,{translate:r}=a;return t?i.createElement("div",{className:"error-message","data-testid":"error-message"},i.createElement("div",{className:"download-submissions-content-table__error_message"},r("gradebook.download-submissions.table.errorLoading"))):n?i.createElement(E.Spinner,{className:"download-submissions-content-table__table__spinner",size:E.SpinnerSize.xLarge,"aria-label":r("gradebook.download-submissions.table.loadContent")}):i.createElement("table",{className:"download-submissions-content-table__table",role:"grid","aria-readonly":"true"},i.createElement("thead",null,this.renderHeader()),i.createElement("tbody",null,e))}handleSort(e,t,n){if(e===this.state.sortColumn)switch(this.state.sortDirection){case S.ascending:this.setState({sortDirection:S.descending}),this.props.onSortColumn(n);break;case S.descending:this.setState({sortDirection:S.ascending}),this.props.onSortColumn(t)}else this.setState({sortColumn:e,sortDirection:S.ascending}),this.props.onSortColumn(t)}render(){return i.createElement("div",{className:"download-submissions-content-table"},i.createElement("div",null,this.displaySpinnerOrChildren()))}renderHeader(){const{localize:e,selectAllStatus:t}=this.props,{translate:n}=e,a=this.renderSortButton(this.getColumnSortInformation(y.name)),r=this.renderSortButton(this.getColumnSortInformation(y.date)),s="gradebook.downloadSubmissions.column.name.header",o="gradebook.downloadSubmissions.column.date.header",l=this.props.analyticsEventAugmentor(k.AnalyticsEventTypes.CLICK_EVENT,this.onNameHeaderClick,s),c=this.props.analyticsEventAugmentor(k.AnalyticsEventTypes.CLICK_EVENT,this.onDateHeaderClick,o);return i.createElement("tr",{className:"download-submissions-content-table__row -header",role:"row"},i.createElement("th",{className:"download-submissions-content-table__cell--header -fixed-checkbox",role:"columnheader",id:"download-submissions-content-table__cell__header--id-checkbox","aria-label":n("gradebook.download-submissions.header.selectColumn")},i.createElement("div",{className:"download-submissions-content-table__cell__data-wrapper"},i.createElement("div",{className:"download-submissions-content-table__cell__data-wrapper__data"},i.createElement(b.AnalyticsFormControlLabel,{label:"",className:"download-submissions-content-table__cell__checkbox","aria-label":n("gradebook.download-submissions.header.selectAll"),htmlFor:"gradebook.downloadSubmissions.header.selectAll.triStateCheckbox",control:i.createElement(b.AnalyticsCheckbox,{id:"gradebook.downloadSubmissions.header.selectAll.triStateCheckbox",checked:t===C.CheckStateTypesEnum.CHECKED,indeterminate:t===C.CheckStateTypesEnum.PARTIAL,onChange:this.onSelectAllToggle,analyticsId:"gradebook.downloadSubmissions.header.selectAll.triStateCheckbox"}),analyticsId:"gradebook.downloadSubmissions.header.selectAll.label"})))),i.createElement("th",{className:"download-submissions-content-table__cell--header -column-name",role:"columnheader","aria-sort":this.getAriaSortState(y.name),id:"download-submissions-content-table__cell__header--id-name",tabIndex:-1,onClick:l,"data-analytics-id":s},i.createElement("span",{className:"download-submissions-content-table__cell__data-wrapper",role:"button",tabIndex:0},i.createElement("div",{className:"download-submissions-content-table__cell__data-wrapper__data"},n("gradebook.download-submissions.table.nameColumn")),a)),i.createElement("th",{className:"download-submissions-content-table__cell--header -column-date",role:"columnheader","aria-sort":this.getAriaSortState(y.date),id:"download-submissions-content-table__cell__header--id-date",tabIndex:-1,onClick:c,"data-analytics-id":o},i.createElement("span",{className:"download-submissions-content-table__cell__data-wrapper",role:"button",tabIndex:0},i.createElement("div",{className:"download-submissions-content-table__cell__data-wrapper__data"},n("gradebook.download-submissions.table.dateColumn")),r)),i.createElement("td",{className:"download-submissions-content-table__cell--header -padder","aria-hidden":!0}))}renderSortButton(e){const{localize:t}=this.props,{translate:n}=t;return e.icon?i.createElement("div",{className:"download-submissions-content-table__cell__data-wrapper--icon",title:n(`gradebook.download-submissions.screenReaderSortUpdates.${e.sorted}`)},e.icon):i.createElement("div",{className:"download-submissions-content-table__cell__data-wrapper--arrow-container",title:n(`gradebook.download-submissions.screenReaderSortUpdates.${e.sorted}`)},i.createElement(I.SortArrows,null))}getAriaSortState(e){if(this.state.sortColumn===e){if(this.state.sortDirection===S.ascending)return"ascending";if(this.state.sortDirection===S.descending)return"descending"}return"none"}}const T=Object(k.withAnalytics)(Object(d.a)(w)),O=(e,t)=>P(e.name.toLowerCase(),t.name.toLowerCase()),A=(e,t)=>O(t,e),P=(e,t)=>e.localeCompare(t),x=(e,t)=>N(e.date,t.date),$=(e,t)=>N(t.date,e.date),N=(e,t)=>e>t||!e&&t?1:e<t||e&&!t?-1:0;class D extends i.PureComponent{constructor(e){super(e),this.handleColumnSort=e=>{this.setState({sortRule:e})},this.renderErrorDialog=()=>i.createElement(m,{onCloseDialog:this.closeErrorDialog,downloadErrorDialogHidden:this.state.downloadErrorDialogHidden}),this.renderDownloadDialog=()=>i.createElement(_,{hidden:this.state.downloadDialogHidden,onCloseDialog:this.closeDownloadDialog,onDownload:this.onDownload,selectedItems:this.state.selectedItems}),this.toggleSelectedItem=e=>{this.setState((t=>{const n=t.selectedItems.findIndex((t=>t.studentId===e.studentId));return n>=0?{selectedItems:[...t.selectedItems.slice(0,n),...t.selectedItems.slice(n+1)]}:{selectedItems:[...t.selectedItems,e]}}))},this.getSelectAllStatus=()=>{const{contentItems:e}=this.props;return e&&void 0!==e.length&&0===e.length?C.CheckStateTypesEnum.UNCHECKED:e.every((e=>this.state.selectedItems.some((t=>e.studentId===t.studentId))))?C.CheckStateTypesEnum.CHECKED:this.state.selectedItems.length>0?C.CheckStateTypesEnum.PARTIAL:C.CheckStateTypesEnum.UNCHECKED},this.onSelectAllToggle=()=>{this.selectAllToggle()},this.downloadSubmissions=()=>{0===this.state.selectedItems.length?this.setState({downloadErrorDialogHidden:!1}):this.setState({downloadDialogHidden:!1})},this.onDownload=e=>{this.props.downloadSubmissions(e),this.closeDownloadDialog()},this.closeErrorDialog=()=>{this.setState({downloadErrorDialogHidden:!0})},this.closeDownloadDialog=()=>{this.setState({downloadDialogHidden:!0})},this.state={selectedItems:[],sortRule:O,downloadErrorDialogHidden:!0,downloadDialogHidden:!0}}render(){const{contentItems:e,courseName:t,loadingContent:n,errorLoading:a,localize:r}=this.props,{sortRule:s}=this.state,{translate:o}=r,l=this.getSelectAllStatus(),c=e.sort(s);return i.createElement("div",{className:"download-submissions-panel panel-wrap"},this.renderErrorDialog(),this.renderDownloadDialog(),i.createElement("div",{className:"download-submissions-panel__content"},i.createElement("div",{className:"download-submissions-panel__header"},i.createElement(p.BbPanelHeader,{title:o("gradebook.download-submissions.header.title"),smallHeaderTitle:t,type:p.BbPanelType.full,analyticsId:"gradebook.downloadSubmissions.header.title",navMenuAriaLabel:o("global.navigationMenu")})),i.createElement("div",{className:"download-submissions-panel__content__header"},o("gradebook.download-submissions.header.contents")),i.createElement("div",{className:"download-submissions-panel__content__table"},i.createElement(T,{loadingContent:n,errorLoading:a,selectAllStatus:l,onSelectAllToggle:this.onSelectAllToggle,onSortColumn:this.handleColumnSort,analyticsId:"gradebook.downloadSubmissions.panel.contentTable"},c.map(((e,t)=>i.createElement(v,{key:e.studentId,contentItem:e,isSelected:!!this.state.selectedItems.find((t=>e.studentId===t.studentId)),rowIndex:t+1,onToggleSelected:this.toggleSelectedItem}))))),i.createElement("div",{className:"download-submissions-panel__footer"},i.createElement(g,{onDownloadAction:this.downloadSubmissions,onLeaveAction:this.props.onLeaveAction}))))}selectAllToggle(){const{contentItems:e}=this.props;this.setState((t=>({selectedItems:this.getSelectAllStatus()===C.CheckStateTypesEnum.CHECKED?[]:e.slice(0)})))}}const L=Object(d.a)(D);var j=n("zGdY"),M=n("IbyE"),G=n("9OUN");class R extends i.PureComponent{constructor(e){super(e),this.downloadSubmissions=e=>{const{courseId:t,columnId:n,onLeaveAction:a}=this.props,i={course:t,column:n,studentIds:{students:e.map((e=>e.studentId))}};Object(M.Tb)(i).then((()=>{a()}))},this.state={loadingContent:!0,errorLoading:!1}}componentWillUnmount(){this.setState({loadingContent:!0})}render(){const{contentItems:e,courseName:t,onLeaveAction:n}=this.props,{loadingContent:a,errorLoading:r}=this.state;return i.createElement(L,{courseName:t,contentItems:e,onLeaveAction:n,loadingContent:a,errorLoading:r,downloadSubmissions:this.downloadSubmissions})}async componentDidMount(){const{courseId:e,columnId:t,loadCourseMembershipsByCourseId:n,loadGradebookAttemptsByColumnId:a}=this.props;try{const i=[],r=n({courseId:e,roleBucket:j.y.Taking});i.push(r);const s=a({courseId:e,columnId:t});i.push(s),await Promise.all(i).then((async()=>{await this.setState({loadingContent:!1,errorLoading:!1})}))}catch(e){await this.setState({loadingContent:!1,errorLoading:!0})}}}const B=Object(s.b)(((e,t)=>{const{courseId:n,columnId:a,localize:i}=t,{translate:r}=i,s=[],o=M.Yb.courseMembership.getCourseMembershipsByCourseId(e,n,j.y.Taking);return o.forEach((t=>{const i=M.Yb.user.getUserById(e,t.userId),o=(e=>{if(e.length>0){const t=e.reduce(((e,t)=>e&&e.attemptDate>t.attemptDate?e:t));return new Date(t.attemptDate)}return null})(M.Yb.gradebookAttempt.getGradebookAttemptsByUserId(e,n,a,t.userId)),l={name:r("gradebook.download-submissions.table.name",{user:i}),studentId:t.userId,date:o};s.push(l)})),{courseMembers:o,contentItems:s}}),(e=>Object(G.b)({loadCourseMembershipsByCourseId:M.V.courseMembership.loadCourseMembershipsByCourseId,loadGradebookAttemptsByColumnId:M.V.gradebookAttempt.loadGradebookAttemptsByColumnId},e)))(R),F=Object(d.a)(B);var U=n("uxze");const _=Object(d.a)((e=>{const{localize:t,hidden:n,onCloseDialog:a,onDownload:r,selectedItems:s}=e,{translate:o}=t,d=i.createElement(U.Link,{href:o("gradebook.download-submissions.downloadDialog.helpLink"),target:"_blank",analyticsId:"download-submissions-dialog-help-link"},o("gradebook.download-submissions.downloadDialog.help"));return i.createElement("div",null,i.createElement(u.c,{hidden:n,onDismiss:a,dialogContentProps:{type:l.DialogType.normal,title:o("gradebook.download-submissions.downloadDialog.title"),subText:o("gradebook.download-submissions.downloadDialog.body")},modalProps:{isAlert:!0},analyticsId:"download-submissions-dialog"},i.createElement(l.DialogFooter,{helpLink:d},i.createElement(c.AnalyticsDefaultButton,{onClick:()=>a(),analyticsId:"download-submissions-dialog-dialog-footer-primary-button"},o("gradebook.download-submissions.downloadDialog.cancelButton")),i.createElement(c.AnalyticsPrimaryButton,{onClick:()=>r(s),analyticsId:"download-submissions-dialog-dialog-footer-primary-button"},o("gradebook.download-submissions.downloadDialog.downloadButton")))))}));var z,q,H=n("nsO7"),V=n("7O4Y");!function(e){e.Default="default",e.Mini="mini",e.Large="large"}(z||(z={})),function(e){e.Grey="grey",e.Black="black",e.Green="green",e.YellowGreen="yellow-green",e.Yellow="yellow",e.Orange="orange",e.Red="red"}(q||(q={}));const W="--";var K,Y,J;!function(e){e.MaxExceeded="maxExceeded",e.WrongFormat="wrongFormat"}(K||(K={})),function(e){e.Points="points",e.Percentage="percentage",e.Tabular="tabular",e.UnitBased="unitBased"}(Y||(Y={})),function(e){e.Points="points",e.PointsEach="points.each"}(J||(J={}));var Z=n("Agfx"),Q=n("QgAF"),X=n("THXI");const ee=Object(Z.makeStyles)((e=>{const t="120px",n="140px",a=X.d.greenHover,i=X.d.yellowGreenHover,r=X.d.yellowHover,s=X.d.brightOrangeHover,o=X.d.redHover,l=X.d.disabledHover,c=e.palette.background.b9,d=X.d.green,u=X.d.yellowGreen,m=X.d.yellow,p=X.d.brightOrange,h=X.d.red,g=e.palette.background.b5,b=e.palette.background.b9,f=e.palette.background.b3,v=e.palette.focus.main,y=e.palette.error.main,S={fontFamily:e.typography.fontFamily,lineHeight:"normal",overflow:"hidden",padding:"0 8px",borderRadius:"30px",display:"inline-flex",justifyContent:"center",alignItems:"center","box-sizing":"border-box",fontWeight:X.h.fontWeightSemiBold,"&.default":{height:"30px",minWidth:"70px",maxWidth:t,fontSize:e.typography.fontSizeDefault},"&.mini":{height:"26px",minWidth:"50px",maxWidth:t,fontSize:e.typography.fontSizeDefault},"&.large":{height:"36px",minWidth:"90px",maxWidth:"150px",fontSize:e.typography.fontSizeLarge,padding:"0 12px"},"&.green, &.yellow-green, &.yellow, &.orange, &.red, &.grey":{border:"0",color:X.l.primary},"&.black":{border:"0",background:c,color:e.palette.common.white},"&.grey":{background:g},"&.green":{background:d},"&.yellow-green":{background:u},"&.yellow":{background:m},"&.orange":{background:p},"&.red":{background:h},"&.icon-pill":{justifyContent:"left","&.default":{maxWidth:n},"&.mini":{maxWidth:n},"&.large":{maxWidth:"160px"}}};return Object(Z.createStyles)({pill:{...S,border:`1px solid ${b}`,background:"white",transition:"background-color 0.2s cubic-bezier(0.55, 0, 0.1, 1)","&:hover":{background:f,cursor:"pointer"},"&:hover .hyphens-hover":{color:e.palette.grey[800]},"&.focus":{border:`1px solid ${v}`,boxShadow:`inset 0 0 0 1px ${v}`},"&.active":{background:"white",border:`1px solid ${v}`,boxShadow:`inset 0 0 0 4px ${Object(Q.fade)(v,.1)}`},"&.error":{background:"white",border:`1px solid ${y}`,boxShadow:`inset 0 0 0 4px ${Object(Q.fade)(y,.1)}`},"&.black:hover":{background:l},"&.green:hover":{background:a},"&.yellow-green:hover":{background:i},"&.yellow:hover":{background:r},"&.orange:hover":{background:s},"&.red:hover":{background:o},"&.disabled-max-width":{maxWidth:"inherit"}},readonlyPill:{"&&":{...S}},containerCallOut:{color:y,display:"flex","& div":{paddingRight:"12px"}},containerPill:{display:"inline-flex",alignItems:"center"},iconAlertCallOut:{paddingTop:"4px",paddingRight:"4px"}})})),te=Object(d.a)((e=>{const{hasFocus:t,hasError:n,pillSize:a,pillColor:r,errorKey:s,localize:{translate:o},showIconButton:l,maxWidthDisabled:c}=e,{errorId:d,analyticsId:u,onClick:m,onPointerDown:p,onPointerUp:h}=e,g=ee(e),f=Object(i.useRef)(null),[v,y]=Object(i.useState)(!1),[S,C]=Object(i.useState)(!1),E=Object(V.a)(g.pill,"pill",{"icon-pill":l,focus:t,active:v,[a||"default"]:!0,[r]:!0,error:n,"disabled-max-width":c}),k=()=>{v&&(h(),y(!1))};Object(i.useEffect)((()=>(document.addEventListener("pointerup",k),()=>{document.removeEventListener("pointerup",k)}))),Object(i.useEffect)((()=>{C(n)}),[n]);const w={onClick:l?null:()=>{n&&C(!0),m()},onPointerDown:l?null:()=>{p(),y(!0)},onPointerUp:l?null:k};return i.createElement(i.Fragment,null,i.createElement(b.AnalyticsTooltip,{placement:"bottom-start",title:i.createElement("div",{role:"alert",className:g.containerCallOut,id:d},i.createElement("div",{className:g.iconAlertCallOut},i.createElement(I.Attention,null)),o(`gradePill.errors.${s}`,{maxDigits:5,maxDecimalDigits:2})),analyticsId:`${u}.tooltip`,open:S},i.createElement("div",{className:g.containerPill},i.createElement("div",{className:E,ref:f,...w},e.children))))})),ne=()=>i.createElement("span",{className:"pill-hyphens"},W),ae=(Object(Z.makeStyles)((()=>Object(Z.createStyles)({pillHyphens:{marginRight:"2px"},pillPercentage:{marginLeft:"2px"}}))),Object(Z.makeStyles)((()=>Object(Z.createStyles)({pillPointsSeparator:{margin:"0 3px"}})))),ie=(Object(d.a)((e=>{const{pointsPossible:t,localize:{formatNumber:n}}=e,a=ae(e);return i.createElement(i.Fragment,null,i.createElement("span",{className:"pill-hyphens"},W),i.createElement("span",{className:a.pillPointsSeparator},"/"),i.createElement("span",{className:"pill-points-possible"},n(t,We(t))))})),Object(Z.makeStyles)((()=>Object(Z.createStyles)({pillSeparator:{margin:"0px 3px"}})))),re=Object(d.a)((e=>{const{grade:t,pointsPossible:n,localize:{formatNumber:a}}=e,r=ie(e);return i.createElement(i.Fragment,null,i.createElement("span",{className:"js-pill-grade"},a(t,We(t))),i.createElement("span",{className:r.pillSeparator},"/"),i.createElement("span",{className:"pill-points-possible"},a(n,Ue)))})),se=(e,t)=>{if("number"!=typeof e||"number"!=typeof t)return q.Grey;if(0===t||0===e&&0===t)return q.Grey;const n=100*e/t;return n>=90?q.Green:n>=80&&n<90?q.YellowGreen:n>=70&&n<80?q.Yellow:n>=60&&n<70?q.Orange:q.Red},oe=(e,t,n,a,i)=>{if(null==t)return null;if(e===Y.Points||e===Y.UnitBased)return a.formatNumber(t,We(t));if(e===Y.Percentage){const e=100*t/n,i=a.formatNumber(e,We(e));return a.translate("gradePill.percentageGrade",{displayGrade:i})}return e===Y.Tabular?((e,t,n)=>{const a=100*t/n,i=Object(H.orderBy)(e,["lowerBound"],["desc"]);for(const e of i)if(a>=e.lowerBound)return e.symbol;return""})(i,t,n):null},le=Object(d.a)((e=>{const{grade:t,pointsPossible:n,localize:a}=e;return i.createElement("div",null,oe(Y.Percentage,t,n,a))})),ce=Object(Z.makeStyles)((()=>Object(Z.createStyles)({gradedTabularContent:{overflow:"hidden",textOverflow:"ellipsis","& span":{whiteSpace:"nowrap"}}}))),de=e=>{const{symbolGrade:t}=e,n=t,a=ce(e);return i.createElement("div",{className:a.gradedTabularContent},i.createElement("span",null,n))},ue=Object(Z.makeStyles)((()=>Object(Z.createStyles)({unitBasedContent:{margin:"0 3px","& span":{whiteSpace:"nowrap"}}}))),me=Object(d.a)((e=>{const{unit:t,localize:{translate:n}}=e,a=ue(e);return i.createElement("div",{className:a.unitBasedContent},i.createElement("span",null,n(`gradebook.grade.${t}`)))})),pe=Object(d.a)((e=>{const{grade:t,unit:n,localize:{formatNumber:a}}=e;return i.createElement(i.Fragment,null,i.createElement("span",null,null==t?"--":a(t,We(t))),i.createElement(me,{unit:n}))}));var he=n("6Wru");const ge=Object(Z.makeStyles)((e=>Object(Z.createStyles)({pillInput:{overflow:"hidden",textOverflow:"ellipsis",background:"none",border:"none",textAlign:"center",fontWeight:"inherit",margin:"0px",padding:"0px",fontSize:"inherit",color:"inherit",outline:"none",cursor:"pointer","&:focus":{border:"none",fontWeight:e.typography.fontWeightRegular},"&::placeholder":{color:"inherit"}},pillInputContainer:{overflow:"hidden"},contentRef:{width:"auto",visibility:"hidden",position:"absolute"}}))),be=e=>{const{regroupNumber:t,parseNumber:n,formatNumber:a}=Object(he.a)(),{grade:r,displayGrade:s,hasFocus:o}=e,{analyticsId:l,id:c,showRegroupedGrade:d,onFocus:u,onBlur:m,onError:p,onErrorSolved:h}=e,{ariaLabel:g,ariaDescribedBy:b,ariaHidden:f,emptyGradeNotAllowed:v}=e,[y,S]=Object(i.useState)(!1),[C,E]=Object(i.useState)(null),[I,k]=Object(i.useState)(0),[w,T]=Object(i.useState)({value:r,regrouped:null!=r?t(a(r,{round:"truncate",maximumFractionDigits:2})):"",cursorPosition:0}),O=ge(e),A=Object(i.useRef)(null),P=Object(i.useRef)(null),x=Object(i.useRef)(null);return Object(i.useEffect)((()=>{o&&A.current.focus()}),[o]),Object(i.useLayoutEffect)((()=>{k(x.current.offsetWidth+2)}),[w,o]),Object(i.useLayoutEffect)((()=>{const e=P.current.offsetWidth;o||I===e||k(e)}),[I]),Object(i.useEffect)((()=>{y||h()}),[y]),Object(i.useEffect)((()=>{const e=null!=r?t(a(r,{round:"truncate",maximumFractionDigits:2})):"",n=e.length;T({value:r,regrouped:e,cursorPosition:n})}),[r,a,t]),Object(i.useEffect)((()=>{const{cursorPosition:e}=w;A.current.setSelectionRange(e,e)}),[w]),i.createElement(i.Fragment,null,i.createElement("div",{className:O.pillInputContainer,ref:P},i.createElement("input",{id:c,className:O.pillInput,value:o||d||!s?w.regrouped:s,ref:A,onBlur:()=>{y&&p(C),!y&&m&&m(w.value)},onChange:e=>{const a=e.target.value,i=t(a)||a,r=n(i.trim()),s=e.target.selectionStart;if(a)if(Number.isNaN(r))T({value:null,regrouped:a,cursorPosition:s}),S(!0),E(K.WrongFormat);else{T({value:r,regrouped:i,cursorPosition:(o=a,l=i,c=s,l.length>o.length?c+1:l.length<o.length?c-1:c)});const e=(e=>{if(null==e)return!0;const t=Math.abs(Math.trunc(e)).toString().length,n=e===Math.trunc(e)?0:e.toString().split(".")[1].length;return!(t>5||n>2)})(r);S(!e),e||E(K.MaxExceeded)}else Number.isNaN(r)&&(T({value:null,regrouped:i,cursorPosition:0}),v?(S(!0),E(K.WrongFormat)):(S(!1),E(null)));var o,l,c},onKeyDown:e=>{13===e.keyCode&&(y?p(C):A.current.blur())},style:{width:`${I}px`},maxLength:11,"analytics-id":`${l}.input`,"aria-label":g,"aria-describedby":b,"aria-hidden":f,tabIndex:f?-1:0,"aria-invalid":!!y,placeholder:W,onFocus:u,readOnly:!o}),i.createElement("div",{className:O.contentRef,ref:x},o||d||!s?w.regrouped||W:s)))},fe=Object(Z.makeStyles)((()=>Object(Z.createStyles)({pendingContent:{fontStyle:"italic"}}))),ve=Object(d.a)((e=>{const{localize:{translate:t}}=e,n=fe(e);return i.createElement("div",{className:n.pendingContent},i.createElement("span",null,t("gradePill.pendingState")))})),ye=Object(Z.makeStyles)((()=>Object(Z.createStyles)({pillPointsSeparator:{margin:"0 3px"}}))),Se=Object(d.a)((e=>{const{pointsPossible:t,localize:{formatNumber:n}}=e,a=ye(e);return i.createElement(i.Fragment,null,i.createElement("span",{className:a.pillPointsSeparator},"/"),i.createElement("span",{className:"pill-points-possible"},n(t,We(t))))})),Ce=Object(d.a)((e=>{const{grade:t,pointsPossible:n,hasFocus:a,variant:r,symbolsMap:s,unit:o,emptyGradeNotAllowed:l}=e,{pillSize:c,gradeColorVariant:d,analyticsId:u,id:m,localize:p,onBlur:h}=e,{ariaLabel:g,ariaHidden:b,ariaDescribedBy:f}=e,[v,y]=Object(i.useState)(t),[S,C]=Object(i.useState)(oe(r,t,n,p,s)),[E,I]=Object(i.useState)(!1),[k,w]=Object(i.useState)(a||!1),[T,O]=Object(i.useState)(!1),[A,P]=Object(i.useState)(null),x=Object(H.uniqueId)("errorMessageId"),$=Object(H.uniqueId)("complementId"),N=i.createElement(Se,{pointsPossible:n}),D=i.createElement(me,{unit:o});Object(i.useEffect)((()=>{y(t),C(oe(r,t,n,p,s))}),[t]);let L,j;(k&&r!==Y.UnitBased||E&&r===Y.Points)&&(L=N),r===Y.UnitBased&&(L=D),E||k||null==v||r===Y.UnitBased||(j=d||se(v,n),r===Y.Points&&(L=N));const M=T?`${f} ${$} ${x}`:`${f} ${$}`;return i.createElement(te,{pillSize:c,pillColor:j,hasFocus:k,hasError:T,errorKey:A,errorId:x,showIconButton:!!e.children,analyticsId:u,maxWidthDisabled:r===Y.UnitBased,onClick:()=>{w(!0)},onPointerDown:()=>{I(!0)},onPointerUp:()=>{I(!1)}},e.children,i.createElement(be,{grade:v,displayGrade:S,emptyGradeNotAllowed:l,analyticsId:`${u}.gradableContent`,ariaLabel:g,hasFocus:k,onFocus:()=>{w(!0)},onBlur:e=>{y(e),C(oe(r,e,n,p,s)),w(!1),h&&h(e)},onError:e=>{O(!0),P(e)},ariaDescribedBy:M,ariaHidden:b,id:m,showRegroupedGrade:e.showRegroupedGrade,onErrorSolved:()=>{O(!1),P(null)}}),L&&i.createElement("div",{id:$},L))})),Ee=Object(Z.makeStyles)((e=>Object(Z.createStyles)({iconButton:{minWidth:0,padding:0,"&.default":{marginRight:"9px"},"&.mini":{marginRight:"4px"},"&.large":{marginRight:"10px"},"&:hover":{color:"inherit"}},rubricIcon:{fontSize:e.typography.fontSizeMedium}}))),Ie=e=>{const{analyticsId:t,ariaLabel:n,onClick:a,size:r}=e,s=Ee(e),o=Object(V.a)(s.iconButton,r||"default"),l=Object(V.a)(s.rubricIcon,r||"default");return i.createElement(b.AnalyticsIconButton,{className:o,"aria-label":n,color:"inherit",onClick:a,analyticsId:`${t}.iconButton`},i.createElement(I.Rubric,{className:l}))},ke=e=>{const{pillSize:t,pillColor:n,showIconButton:a}=e,r=ee(e),s=Object(V.a)(r.readonlyPill,"readonly-pill",n,t||"default",{"icon-pill":a});return i.createElement("div",{className:s},e.children)},we=e=>{const{variant:t,grade:n,pointsPossible:a,isPending:r,symbolGrade:s,unit:o}=e;if(r)return i.createElement(ve,null);switch(t){case Y.Percentage:return null!=n&&null!=a?i.createElement(le,{grade:n,pointsPossible:a}):i.createElement(ne,null);case Y.Tabular:return null!=s?i.createElement(de,{symbolGrade:s}):i.createElement(ne,null);case Y.UnitBased:return null!=o?i.createElement(pe,{grade:n,unit:o}):i.createElement(ne,null);default:return null!=a&&null!=n?i.createElement(re,{grade:n,pointsPossible:a}):i.createElement(ne,null)}},Te=e=>{const{grade:t,symbolGrade:n,pointsPossible:a,isPending:r,variant:s,pillSize:o,gradeColorVariant:l,unit:c}=e,d=l||se(t,a);return i.createElement(ke,{pillSize:o,pillColor:d,showIconButton:!!e.children},e.children,i.createElement(we,{grade:t,symbolGrade:n,pointsPossible:a,isPending:r,variant:s,unit:c}))},Oe=2,Ae=1,Pe=0,xe=2,$e=5,Ne=99999,De=0,Le=100,je=1e3;var Me,Ge,Re;!function(e){e.Points="points",e.Percent="percent",e.PointsPerQuestion="points.each"}(Me||(Me={})),function(e){e.Default="default",e.Mini="mini",e.Large="large"}(Ge||(Ge={})),function(e){e.Green="green",e.Yellowgreen="yellowgreen",e.Yellow="yellow",e.Orange="orange",e.Red="red",e.Disabled="color-disabled",e.Ungraded="white",e.Override="grey"}(Re||(Re={}));const Be=Re.Ungraded;function Fe(e,t=!1){let n;n=e<999||!t?Oe:e<9999?Ae:Pe;const a=new RegExp(`^-?\\d+(?:\\.\\d{0,${n}})?`);return"number"==typeof e?e.toString().match(a)[0]:"string"==typeof e?e.match(a)[0]:""}const Ue={minimumFractionDigits:0,maximumFractionDigits:Oe,useGrouping:!0,minimumIntegerDigits:1,round:"truncate"},_e={minimumFractionDigits:0,maximumFractionDigits:Ae,useGrouping:!0,minimumIntegerDigits:1,round:"truncate"},ze={minimumFractionDigits:0,maximumFractionDigits:Pe,useGrouping:!0,minimumIntegerDigits:1,round:"truncate"},qe={minimumFractionDigits:0,maximumFractionDigits:xe,useGrouping:!0,minimumIntegerDigits:1,style:"decimal",round:"truncate"};function He(e){return e.integerCount>=0&&e.integerCount<4?Ue:4===e.integerCount?_e:ze}function Ve(e){const t=e.reduce(((e,t)=>e+=t*je),null);return null===t?t:t/je}function We(e){const t={integerCount:0,fractionalCount:0};if(!Number.isNaN(Number(e)))for(;Math.abs(e)>10**t.integerCount;)t.integerCount=t.integerCount+1;return He(t)}function Ke(e,t){if(!t)return Re.Disabled;let n;return n=e>=90?Re.Green:e>=80&&e<90?Re.Yellowgreen:e>=70&&e<80?Re.Yellow:e>=60&&e<70?Re.Orange:Re.Red,n}const Ye=e=>{var t;return e.manualStatus===j.Bb.NoOverride&&e.status===j.J.NeedsGrading&&null!=(null===(t=e.displayGrade)||void 0===t?void 0:t.score)||e.manualStatus===j.Bb.ReadyToPost},Je=e=>e===j.Ub.Percent?Y.Percentage:e===j.Ub.Tabular?Y.Tabular:Y.Points,Ze=e=>!!(null==e?void 0:e.scoredByAutomaticZero),Qe=e=>{let t="gradebook.grade.grade-input.aria.scoreInputEmpty";return Ze(e)?t="gradebook.grade.grade-input.aria.pastDueZeroScoreInputGraded":void 0!==(null==e?void 0:e.score)&&(t="gradebook.grade.grade-input.aria.scoreInputGraded"),t};var Xe=n("MC1S");const et=Object(Z.makeStyles)((e=>({downloadTestResultsPanelHeader:{height:"auto","& .ms-Panel-header":{boxShadow:"none"}},downloadTestResultsPanelBody:{top:0,overflow:"auto",height:"auto",position:"relative",marginBottom:"48px",[e.breakpoints.up("sm")]:{marginTop:"24px"}},errorMessage:{backgroundColor:"#F9DBD7",display:"flex",padding:"1rem",[e.breakpoints.up("sm")]:{margin:"0 -1.875rem"}},downloadTestResultsPanelFooter:{position:"absolute",bottom:0,left:0,right:0,"& .ms-Panel-footer":{justifyContent:"center"}},panelSection:{padding:"14px 10px",borderBottom:`1px solid ${e.palette.border.main}`,"&:last-child":{borderBottom:"none",paddingBottom:0},"&:first-child":{paddingTop:0},"& fieldset":{border:0,margin:0,padding:0},"& h2":{fontWeight:"bold",marginBottom:"8px"}}})));var tt;!function(e){e.Delimiter="delimiter-type",e.Format="format-of-results",e.Attempts="attempts"}(tt||(tt={}));const nt=e=>`id-${e.toLowerCase()}-radio`,at=e=>i.createElement(b.AnalyticsRadioGroup,{analyticsId:e.analyticsId,id:e.radioGroupId,legendVariant:"h2",legendText:e.legendText,name:e.name,value:e.selectedValue,onChange:e.onChangeHandler},e.groupDescription&&i.createElement("div",null,i.createElement("p",null,e.groupDescription)),e.radioProps.map((t=>i.createElement("div",{key:t.value},i.createElement(b.AnalyticsFormControlLabel,{analyticsId:t.labelAnalyticsId,htmlFor:nt(t.value),value:t.value,control:i.createElement(b.AnalyticsRadio,{analyticsId:t.radioAnalyticsId,checked:t.value===e.selectedValue,onChange:e.onChangeHandler,id:nt(t.value)}),label:t.label})))));var it=n("etrl"),rt=n("nmzr"),st=n("ddKs"),ot=n("IVC4");const lt=Object(d.a)((e=>{const{localize:t,courseName:n,isOrganization:a}=e,[r,s]=i.useState(j.mb.Tab),[o,l]=i.useState(j.nb.User),[c,d]=i.useState(j.lb.AllAttempts),[u,m]=i.useState(!1),[p,h]=i.useState(!1),g=a?"organization.":"",f=()=>{rt.Z.leavePeekState()},v="course.grades.download-test-results",y=et();return i.createElement("div",{id:"download-test-results-panel"},i.createElement("div",{className:"panel-wrap"},i.createElement("header",{className:`panel-header simple-header ${y.downloadTestResultsPanelHeader}`},i.createElement(Xe.BbPanelHeader,{smallHeaderTitle:n,type:Xe.BbPanelType.peek,analyticsId:`${v}.header`,title:t.translate("course.grades.download-test-results.pageTitle"),navMenuAriaLabel:t.translate("global.navigationMenu")})),u&&i.createElement("div",{className:y.errorMessage,id:"error-block"},i.createElement(b.AnalyticsIconButton,{analyticsId:`${v}.error.attention`},i.createElement(ot.a,null)),i.createElement("span",null,t.translate("course.grades.download-test-results.errorMessage")),i.createElement(b.AnalyticsIconButton,{id:"close-error",analyticsId:`${v}.error.close`,onClick:()=>{m(!1)}},i.createElement(st.Close,null))),i.createElement("div",{className:`panel-body panel-content ${y.downloadTestResultsPanelBody}`},i.createElement("div",{className:y.panelSection},i.createElement(at,{analyticsId:`${v}.delimiter.radiogroup`,radioGroupId:"delimiter-radio-group",name:tt.Delimiter,legendText:t.translate("course.grades.download-test-results.fileType"),selectedValue:r,onChangeHandler:e=>{s(e.target.value)},radioProps:[{labelAnalyticsId:`${v}.delimiter.excel.label`,radioAnalyticsId:`${v}.delimiter.excel.radio`,value:j.mb.Tab,label:t.translate("course.grades.download-test-results.excel")},{labelAnalyticsId:`${v}.delimiter.comma.label`,radioAnalyticsId:`${v}.delimiter.comma.radio`,value:j.mb.Comma,label:t.translate("course.grades.download-test-results.comma")}]})),i.createElement("div",{className:y.panelSection},i.createElement(at,{analyticsId:`${v}.results-format.radiogroup`,radioGroupId:"results-format-radio-group",name:tt.Format,legendText:t.translate("course.grades.download-test-results.formatOfResults"),groupDescription:t.translate(`${g}course.grades.download-test-results.formatDescription`),selectedValue:o,onChangeHandler:e=>{l(e.target.value)},radioProps:[{labelAnalyticsId:`${v}.format.student.label`,radioAnalyticsId:`${v}.format.student.radio`,value:j.nb.User,label:t.translate(`${g}course.grades.download-test-results.student`)},{labelAnalyticsId:`${v}.format.question-and-student.label`,radioAnalyticsId:`${v}.format.question-and-student.radio`,value:j.nb.QuestionAndUser,label:t.translate(`${g}course.grades.download-test-results.questionAndStudent`)}]})),i.createElement("div",{className:y.panelSection},i.createElement(at,{analyticsId:`${v}.attempts.radiogroup`,radioGroupId:"attempts-radio-group",name:tt.Attempts,legendText:t.translate("course.grades.download-test-results.attemptsToDownload"),groupDescription:t.translate(`${g}course.grades.download-test-results.attemptsDescription`),selectedValue:c,onChangeHandler:e=>{d(e.target.value)},radioProps:[{labelAnalyticsId:`${v}.attempts.all-attempts.label`,radioAnalyticsId:`${v}.attempts.all-attempts.radio`,value:j.lb.AllAttempts,label:t.translate("course.grades.download-test-results.allAttempts")},{labelAnalyticsId:`${v}.attempts.valid-attempts.label`,radioAnalyticsId:`${v}.attempts.valid-attempts.radio`,value:j.lb.ValidAttempts,label:t.translate("course.grades.download-test-results.validAttempts")}]})))),i.createElement("div",{className:y.downloadTestResultsPanelFooter},i.createElement(Xe.BbPanelFooter,{primaryButtonProps:{onClick:async()=>{h(!0);const t={delimiter:r,resultFormat:o,attempts:c};let n;try{n=await Object(M.Ub)(e.courseId,e.columnId,t),Object(it.saveAs)(n.blob,n.filename),f()}catch(e){console.error(e),m(!0)}},disabled:p,text:t.translate("course.grades.download-test-results.download"),id:"button-download"},secondaryButtonProps:{onClick:f,text:t.translate("course.grades.download-test-results.cancel"),id:"button-cancel"},analyticsId:`${v}.footer`})))})),ct=e=>e.isDisabled?i.createElement(Te,{grade:e.grade,variant:Y.Points,pointsPossible:e.pointsPossible}):i.createElement(Ce,{grade:e.grade,pointsPossible:e.pointsPossible,variant:Y.Points,onBlur:e.save,showRegroupedGrade:!0,analyticsId:"ultra.components.directives.assessment.gradePill"});var dt=n("eqO1");const ut=Object(Z.makeStyles)((e=>Object(Z.createStyles)({overallGradeWrapper:{justifyContent:"center",alignContent:"center","& $overallGradeSetupContent":{[e.breakpoints.up("sm")]:{textAlign:"left"}},"& $row":{[e.breakpoints.up("md")]:{flexDirection:"row"}},"& $overallBorder":{[e.breakpoints.up("sm")]:{display:"block",paddingRight:"16px",maxWidth:"575px"},"& $overallGradeImgWrapper":{[e.breakpoints.up("sm")]:{float:"left"},"& $overallGradeImage":{[e.breakpoints.up("sm")]:{marginBottom:"0",marginTop:"16px",marginRight:"7px",marginLeft:"initial"}}},"& $overallGradeSetupHeading":{[e.breakpoints.up("sm")]:{marginTop:"16px",fontSize:e.typography.fontSizeLarge}},"& $overallGradeSetupText":{[e.breakpoints.up("sm")]:{marginBottom:"0px",textAlign:"left"}}},"& $setupOverallBtn":{[e.breakpoints.up("sm")]:{width:"100%",marginTop:"20px",marginLeft:"0"}}},buttonWrapper:{display:"flex",flexDirection:"column"},overallGradeWrapperFixed:{justifyContent:"center",alignContent:"center"},overallGradeSetupContent:{padding:"8px",border:"none",marginTop:"30px",textAlign:"center"},row:{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"},overallGradeImgWrapper:{minHeight:"inherit"},overallGradeImage:{height:"70px",width:"70px",marginBottom:"14px"},overallSetupContent:{},overallGradeSetupHeading:{"&&":{display:"block",fontSize:e.typography.fontSizeMedium,fontWeight:e.typography.fontWeightSemiBold,marginBottom:"4px"}},overallGradeSetupText:{lineHeight:"1.4",textAlign:"center",color:e.palette.text.secondary,marginBottom:"10px"},setupOverallBtn:{width:"auto",marginBottom:"10px",display:"inline-block"},hideThisMessageLinkOverride:{marginTop:"10px",fontSize:e.typography.fontSizeSmall},overallBorder:{display:"flex",flexDirection:"column",alignItems:"center"}}))),mt=Object(d.a)((({onClose:e,onHideMessage:t,hidden:n,localize:a})=>i.createElement(u.c,{analyticsId:"hideOverallGrade.dialog",dialogContentProps:{type:Xe.DialogType.normal,title:a.translate("components.common.hideOverallGradeDialog.title"),subText:a.translate("components.common.hideOverallGradeDialog.text"),showCloseButton:!0,className:"js-hide-overall-grade-component-dialog"},hidden:n,onDismiss:e},i.createElement(Xe.DialogFooter,null,i.createElement(c.AnalyticsDefaultButton,{analyticsId:"components.common.hideOverallGradeDialog.cancel.button",onClick:e},a.translate("components.common.hideOverallGradeDialog.cancel")),i.createElement(c.AnalyticsPrimaryButton,{analyticsId:"components.common.hideOverallGradeDialog.hide.button",className:"js-hide-overall-grade-component-dialog-hide-button",onClick:t},a.translate("components.common.hideOverallGradeDialog.hideButton"))))));var pt=n("aLuL"),ht=n.n(pt);const gt={key:"setupOverallGradeMessageIsHidden",value:"true",visibleToStudents:!1},bt=Object(d.a)((e=>{const t=Object(s.d)(),{analyticsId:n,localize:a,showFixedView:r,courseId:o,setupOverallGradeHideMessageCallback:l}=e,[c,d]=i.useState(!0),u=Object(dt.t)(),m=ut(u),p=r?m.overallGradeWrapperFixed:m.overallGradeWrapper,h=i.useCallback((()=>{d(!0)}),[]),g=i.useCallback((()=>{t(M.V.coursePreference.persistCoursePreference(gt,o)).then((()=>{l&&l()}))}),[o,l,t]),b=`${n}.setup-button`,f=`${n}.hide-message-button`,v=Object(k.useAnalyticsAugmentEventOnElement)(k.AnalyticsEventTypes.CLICK_EVENT,(()=>rt.Z.goPeekState(Object(rt.X)())),b);return i.createElement("div",{className:`${p} js-overall-grade-setup${r?"-fixed":""}`},i.createElement(mt,{hidden:c,onClose:h,onHideMessage:g}),i.createElement("div",{className:m.overallGradeSetupContent},i.createElement("div",{className:`${m.row}`},i.createElement("div",{className:m.overallBorder},i.createElement("div",{className:m.overallGradeImgWrapper},i.createElement("div",{className:m.overallGradeImage,dangerouslySetInnerHTML:{__html:ht.a},"aria-hidden":!0})),i.createElement("div",null,i.createElement("h2",{className:`heading ${m.overallGradeSetupHeading}`},a.translate("components.common.overallPanel.title")),i.createElement("p",{className:m.overallGradeSetupText},a.translate("components.common.overallPanel.text")))),i.createElement("div",{className:m.buttonWrapper},i.createElement("button",{onClick:v,type:"button",className:`button ${m.setupOverallBtn} js-overall-grade-setup-button`,"data-analytics-id":b},a.translate("components.common.overallPanel.setupButton")),i.createElement("button",{className:`button-anchor ${m.hideThisMessageLinkOverride} js-hide-this-message-button`,onClick:()=>d(!1),"data-analytics-id":f,"aria-haspopup":"dialog"},a.translate("components.common.overallPanel.hideThisMessage"))))))}));var ft=n("AuQm");const vt=Object(dt.l)((()=>Object(dt.e)({loadingIcon:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%"}})));var yt=n("/n7R");const St="gradepill.color.preference.settings",Ct=()=>{const e=Object(s.d)();Object(i.useEffect)((()=>{e(M.V.systemPreference.loadSystemPreference({key:St}))}),[e]);const t=(n=St,Object(s.e)((e=>M.Yb.systemPreference.getSystemPreferenceByKey(e,n))));var n;return!(!t||!t.value)&&!JSON.parse(t.value).isColorEnabled},Et=Object(d.a)((({row:e,isOverallGradeConfigured:t,gradingSchema:n,className:a,localize:r,overallGradeColumn:s,pillSize:o})=>{let l,c,d,u,m;!(null==s?void 0:s.possible)||(null==n?void 0:n.scaleType)!==j.Ub.Score&&(null==n?void 0:n.scaleType)!==j.Ub.Tabular||(u=s.possible);Ct()&&(l=q.Black);const p=()=>{switch(null==n?void 0:n.scaleType){case j.Ub.Tabular:return Y.Tabular;case j.Ub.Percent:return Y.Percentage;case j.Ub.Score:return Y.Points}return Y.Tabular},h=e.overallGrade,g=i.useRef(null);if(!t)return i.createElement(yt.AnalyticsTooltip,{title:r.translate("gradebook.studentList.table.overallGradeNotSetUpTooltip"),placement:"left-end",analyticsId:"gradebook.student-list.overall-grade-column"},i.createElement("div",{ref:g},i.createElement(Te,{variant:Y.Tabular,gradeColorVariant:l,pillSize:o})));if(!h||!n)return n&&n.scaleType===j.Ub.Score?i.createElement(Te,{variant:Y.Points,gradeColorVariant:l,pointsPossible:s&&s.possible,pillSize:o}):i.createElement(Te,{variant:p(),gradeColorVariant:l,pillSize:o});if(null==h?void 0:h.displayGrade){null!==h.manualGrade&&(u=h.pointsPossible);const e=h.displayGrade,t=e.isOverride;t&&(l=q.Grey),t&&e.perfCode?(c=e.perfCode.code,m=Y.Tabular):e.grade&&void 0!==e.score?(m=Y.Tabular,c=e.grade,d=e.score):void 0!==e.score?e.requiresSchemaKnowledgeToDisplay?(m=Y.Percentage,d=e.score,u=100):(m=Y.Points,d=parseFloat(e.score.toFixed(2))):m=p()}return i.createElement("div",{className:a},i.createElement(Te,{grade:d,symbolGrade:c,variant:m,pointsPossible:u,gradeColorVariant:l,pillSize:o}))}));var It=n("n7/H");const kt=Object(Z.makeStyles)({anchor:{color:"inherit",textDecoration:"inherit","&:hover, &:focus, &:active":{color:"inherit",textDecoration:"inherit"}}}),wt=Object(Z.makeStyles)({accommodations:{display:"inline",marginRight:"4px",verticalAlign:"middle","& svg":{height:"16px",width:"16px"}}}),Tt=e=>{const t=(n=null==e?void 0:e.courseId,Object(s.e)((e=>n?M.Yb.courseMembership.getMembershipPermissions(e,n):void 0)));var n;return!(!e||!t)&&M.a.hasAccommodations(e,t)};var Ot=n("50Q+");const At=Object(d.a)((({localize:e})=>{const t=wt();return i.createElement(ft.a,{className:t.accommodations,titleAccess:e.translate("gradebook.studentList.fullNameComponent.aria.accommodations")})})),Pt=Object(d.a)((({row:e,isLink:t})=>{const n=i.createElement(Ot.e,{user:e.user,format:It.ILocaleUsernameFormat.Short,ariaHidden:!1}),a=kt(),r=Tt(e.membership),s="gradebook.studentListView.fullNameColumn.link",o=Object(k.useAnalyticsAugmentEventOnElement)(k.AnalyticsEventTypes.CLICK_EVENT,k.defaultOnClick,s);return t?i.createElement("a",{href:"#",className:a.anchor,"data-analytics-id":s,onClick:o},r?i.createElement(At,null):null,n):i.createElement(i.Fragment,null,r?i.createElement(At,null):null,n)})),xt=Object(d.a)((({row:e,localize:t})=>e.membership.lastAccessDate?i.createElement(i.Fragment,null,t.formatDatetime(e.membership.lastAccessDate,It.ILocaleDatetimeFormat.Short)):i.createElement(i.Fragment,null,"")));var $t=n("119o"),Nt=n("6RBU");const Dt=Object(d.a)((e=>{const{localize:t,row:n,className:a,courseId:r}=e,s=n.membership.permissions.editDueDateException||n.membership.permissions.editTimeLimitException,o=n.membership.isAvailable||void 0===n.membership.isAvailable,l=i.useCallback((()=>{rt.Z.goPeekState(Object(rt.ab)({courseId:r,recipientIds:n.user.id}))}),[n.user.id,r]),c=i.useCallback((()=>{rt.Z.goPeekState(Object(rt.db)({membershipId:n.membership.id}))}),[n.membership.id]),d={items:[...s?[{icon:i.createElement($t.a,null),key:"accomodations",name:t.translate("gradebook.studentList.table.actionsMenu.accommodations"),onClick:c}]:[],...o?[{icon:i.createElement(Nt.a,null),key:"messageStudent",name:t.translate("gradebook.studentList.table.actionsMenu.messageStudent"),onClick:l}]:[]]};return s||o?i.createElement(Xe.ActionMenu,{analyticsId:"gradebook.studentListView.studentList",ariaLabel:t.translate("gradebook.studentList.table.actionsMenu.moreOptions",{fullName:t.formatUsername(n.user,It.ILocaleUsernameFormat.Short)}),menuProps:d,className:a}):null}));var Lt;!function(e){e.fullName="fullName",e.lastAccessDate="lastAccessDate",e.overallGrade="overallGrade",e.studentId="studentId",e.username="username",e.actionMenu="actionMenu"}(Lt||(Lt={}));const jt=Lt.fullName,Mt=e=>({row:t})=>{const n=e(t);return n?i.createElement(i.Fragment,null,n):i.createElement(i.Fragment,null,"")},Gt={[Lt.fullName]:{largeBreakpointSize:3,key:Lt.fullName,renderContent:e=>i.createElement(Pt,{...e,isLink:!0}),sortable:!0},[Lt.studentId]:{largeBreakpointSize:1,key:Lt.studentId,renderContent:Mt((e=>e.user.studentId)),sortable:!0},[Lt.username]:{largeBreakpointSize:2,key:Lt.username,renderContent:Mt((e=>e.user.userName)),sortable:!0},[Lt.lastAccessDate]:{largeBreakpointSize:4,key:Lt.lastAccessDate,renderContent:xt,sortable:!0},[Lt.overallGrade]:{largeBreakpointSize:2,key:Lt.overallGrade,renderContent:Et,sortable:!1},[Lt.actionMenu]:{largeBreakpointSize:1,key:Lt.actionMenu,renderContent:e=>i.createElement("div",{onClick:e=>e.stopPropagation()},i.createElement(Dt,{row:e.row,courseId:e.courseId})),hideHeaderText:!0,sortable:!1}},Rt=[Lt.fullName,Lt.studentId,Lt.username,Lt.lastAccessDate,Lt.overallGrade,Lt.actionMenu],Bt=(e,t)=>e.filter((e=>e.key!==Lt.overallGrade||t)),Ft=[{label:"25",value:"25"},{label:"50",value:"50"},{label:"100",value:"100"}],Ut=Ft.map((e=>Number(e.value))),_t=Object(Z.makeStyles)((e=>Object(Z.createStyles)({fullNameCell:{fontWeight:e.typography.fontWeightSemiBold}}))),zt=({analyticsId:e,column:t,colIndex:n,data:a,isOverallGradeConfigured:r,hoverClass:s,courseId:o,gradingSchema:l,overallGradeColumn:c})=>{const d=_t(),u=((e,t,n)=>e===Lt.fullName?`${t.fullNameCell} ${n}`:"")(t.key,d,s);return i.createElement(b.AnalyticsTableCell,{"aria-colindex":n,"aria-describedby":`studentListTable_header_${t.key}`,analyticsId:`${e}.tableCell.${t.key}`,className:`js-student-list-view-table-body-cell ${u}`,tabIndex:-1},i.createElement(t.renderContent,{row:a,isOverallGradeConfigured:r,courseId:o,gradingSchema:l,overallGradeColumn:c}))},qt=Object(Z.makeStyles)((e=>Object(Z.createStyles)({hoverTarget:{},tableRow:{"&:hover":{backgroundColor:e.palette.background.b3,cursor:"pointer","& $hoverTarget":{textDecoration:"underline"}}},disabled:{cursor:"default","&:hover":{textDecoration:"none",cursor:"default"},"& a:hover":{cursor:"default"}}}))),Ht=({data:e,courseId:t,analyticsId:n,isOverallGradeConfigured:a,columns:r,rowIndex:s,gradingSchema:o,overallGradeColumn:l})=>{var c,d,u;const m=qt(),p=i.useCallback((()=>{var n,a;rt.Z.goPeekState(Object(rt.gb)({courseId:t,userId:null===(n=null==e?void 0:e.user)||void 0===n?void 0:n.id,membershipId:null===(a=null==e?void 0:e.membership)||void 0===a?void 0:a.id}))}),[t,null===(c=null==e?void 0:e.user)||void 0===c?void 0:c.id,null===(d=null==e?void 0:e.membership)||void 0===d?void 0:d.id]),h=i.useMemo((()=>Bt(r,a)),[r,a]);return i.createElement(b.AnalyticsTableRow,{"aria-rowindex":s,analyticsId:`${n}.tableRow`,className:`js-student-list-view-body-row ${m.tableRow}`,key:null===(u=null==e?void 0:e.user)||void 0===u?void 0:u.id,onClick:p},h.map(((r,s)=>i.createElement(zt,{colIndex:s+1,analyticsId:n,data:e,column:r,key:r.key,isOverallGradeConfigured:a,hoverClass:m.hoverTarget,courseId:t,gradingSchema:o,overallGradeColumn:l}))))},Vt=Object(d.a)((({analyticsId:e,bodyData:t,columns:n,isDataLoading:a,localize:r,courseId:s,isOverallGradeConfigured:o,gradingSchema:l,overallGradeColumn:c})=>{const d=vt();return i.createElement(b.AnalyticsTableBody,{analyticsId:`${e}.tableBody`,className:"js-student-list-view-body"},a?i.createElement(b.AnalyticsTableRow,{analyticsId:`${e}.loadingIcon.tableRow.container`},i.createElement(b.AnalyticsTableCell,{analyticsId:`${e}.loadingIcon.tableCell.container`,colSpan:n.length},i.createElement("div",{className:d.loadingIcon},i.createElement(b.AnalyticsCircularProgress,{ariaLabel:r.translate("components.studentListView.loadingIconAriaLabel"),size:"large"})))):t.map(((t,a)=>{var r;return i.createElement(Ht,{rowIndex:a+1,data:t,key:null===(r=t.user)||void 0===r?void 0:r.id,courseId:s,isOverallGradeConfigured:o,analyticsId:e,columns:n,gradingSchema:l,overallGradeColumn:c})})))}));var Wt=n("X0Ke");const Kt=Object(Z.makeStyles)((e=>Object(Z.createStyles)({cell:{backgroundColor:e.palette.common.white,borderTop:"none",paddingTop:"0",paddingBottom:"0"},headerTitle:{display:"inline-flex"},invisibleIcon:{height:"8px",verticalAlign:"middle",color:e.palette.common.black},tooltip:{maxWidth:"175px"},nowrap:{whiteSpace:"nowrap"}})));var Yt=n("no1s");const Jt=Object(d.a)((({analyticsId:e,column:t,localize:n,isOverallGradeHidden:a})=>{const r=Kt(),s=t.key===Lt.studentId,o=`${e}.tableCell.${t.key}`;return t.sortable?i.createElement(Wt.a,{id:`studentListTable_header_${t.key}`,analyticsId:o,columnId:t.key,tableCellProps:{className:`js-student-list-view-table-header-cell js-student-list-view-table-header-cell-${t.key} large-${t.largeBreakpointSize} ${r.cell}${s?` ${r.nowrap}`:""}`}},n.translate(`gradebook.studentList.table.${t.key}`)):i.createElement(b.AnalyticsTableCell,{analyticsId:o,className:`js-student-list-view-table-header-cell js-student-list-view-table-header-cell-${t.key} large-${t.largeBreakpointSize} ${r.cell}${s?` ${r.nowrap}`:""}`,tabIndex:-1},t.hideHeaderText?"":n.translate(`gradebook.studentList.table.${t.key}`),t.key===Lt.overallGrade&&a&&i.createElement(Yt.Tooltip,{classes:{tooltip:r.tooltip},title:n.translate("course.grades.gradeVisibilityTooltip"),placement:"top"},i.createElement(b.AnalyticsIconButton,{className:r.invisibleIcon,analyticsId:`${e}.tableCell.${t.key}.visibilityInformationTooltip.button`,"aria-label":n.translate("course.grades.gradeVisibilityIcon")},i.createElement(I.Invisible,null))))})),Zt=Object(Z.makeStyles)({row:{height:"40px"}}),Qt=({analyticsId:e,columns:t,isOverallGradeHidden:n,isOverallGradeConfigured:a})=>{const r=Zt(),s=i.useMemo((()=>Bt(t,a)),[t,a]);return i.createElement(b.AnalyticsTableHead,{analyticsId:`${e}.tableHead`,className:"js-student-list-view-header"},i.createElement(b.AnalyticsTableRow,{analyticsId:`${e}.tableRow`,className:`js-student-list-view-header-row ${r.row}`},s.map((t=>i.createElement(Jt,{analyticsId:e,column:t,key:`studentListView.tableHeaderCell.${t.key}`,isOverallGradeHidden:n})))))},Xt=Object(d.a)((e=>{const{analyticsId:t,isLoading:n,bodyData:a,columnData:r,courseId:s,isOverallGradeConfigured:o,isOverallGradeHidden:l,gradingSchema:c,onSortChanged:d,localize:u,overallGradeColumn:m}=e,p=i.useCallback((e=>(d&&d(e.sortColumnId,e.sortDirection),!0)),[d]),h=i.useCallback(((e,t)=>{const n=u.translate(`gradebook.studentList.table.${e}`);return u.translate(`components.studentListTable.ariaSortMessage.${t}`,{columnName:n})}),[u]);return i.createElement(b.AnalyticsSortableTable,{id:"student-list-view_table",analyticsId:`${t}.table`,tableProps:{className:"js-student-list-view-table"},getAriaSortMessage:h,onSortChanged:p,initialSortColumnId:jt,initialSortDirection:"asc"},i.createElement(Qt,{analyticsId:`${t}.table`,columns:r,isOverallGradeHidden:l,isOverallGradeConfigured:o}),i.createElement(Vt,{analyticsId:`${t}.table`,bodyData:a,columns:r,isDataLoading:n,courseId:s,isOverallGradeConfigured:o,gradingSchema:c,overallGradeColumn:m}))}));var en=n("GuFu");const tn=(e,t,n)=>{const a=Object(s.d)(),r=(e=>Object(s.e)((t=>M.Yb.gradebookGrade.getGradebookGradesByColumnId(t,e))))(t),o={};(r||[]).forEach((e=>{o[e.userId]=e}));const l=n.filter((e=>{var t,n;return!o[e.userId]||(null===(n=null===(t=o[e.userId])||void 0===t?void 0:t.api)||void 0===n?void 0:n.isInvalidated)})).map((e=>e.id));if(Object(i.useEffect)((()=>{e&&l.length&&t&&a(M.V.gradebookGrade.loadBulkView(e,[t],l))}),[a,e,t,l.join(",")]),r){const e=(e=>e.filter((e=>{var t;return!(null===(t=null==e?void 0:e.api)||void 0===t?void 0:t.isInvalidated)})))(r);e.forEach((e=>{e.userId&&(o[e.userId]=e)}))}return o},nn=e=>Object(s.e)((t=>M.Yb.gradebookColumn.getGradebookColumnsByCourseId(t,e))),an=e=>{const t=Object(s.d)();return Object(i.useEffect)((()=>{t(M.V.gradebookColumn.loadGradebookColumnsByCourseId(e))}),[t,e]),nn(e).filter((e=>e.externalGrade))[0]},rn=Object(Z.makeStyles)((e=>Object(Z.createStyles)({loadingIcon:{display:"inline-flex",width:"100%",alignItems:"center",justifyContent:"center"},firstStudentCard:{borderTop:`1px solid ${e.palette.border.main}`},overallGradeInfo:{paddingBottom:"16px",fontStyle:"italic"},infoIcon:{verticalAlign:"middle",marginRight:"8px"}})));var sn=n("bWNV"),on=n("oYCK");const ln=Object(Z.makeStyles)((e=>Object(Z.createStyles)({smallBreakpointGradePill:{marginTop:"14px"},cardRoot:{"&:hover":{backgroundColor:e.palette.background.b3},"&:hover a $smallBreakpointUserName":{textDecoration:"underline"},borderStyle:"none none solid none",borderBottom:`1px solid ${e.palette.border.main}`},cardContent:{display:"flex"},smallBreakpointUserName:{fontWeight:e.typography.fontWeightSemiBold},smallBreakpointStudentId:{marginBottom:"8px"},cardLink:{"&:hover, &:active, &:focus":{color:"inherit",textDecoration:"inherit"},color:"inherit",textDecoration:"inherit",width:"100%"},smallBreakpointActionMenu:{alignSelf:"flex-end",position:"absolute",right:"0px"}})));var cn=n("l0qt");const dn=Object(d.a)((e=>{var t;const{localize:n,data:a,isOverallGradeConfigured:r,gradingSchema:s,classes:o,overallGradeColumn:l}=e;return i.createElement(i.Fragment,null,i.createElement("div",{className:`${o.smallBreakpointUserName}`},i.createElement(Pt,{row:a})),(null===(t=a.user)||void 0===t?void 0:t.studentId)&&i.createElement("div",{className:o.smallBreakpointStudentId},a.user.studentId),a.membership.lastAccessDate&&i.createElement("div",null,n.translate("gradebook.studentList.card.lastAccessedOn",{lastAccessDateControl:(e=>i.createElement(xt,{row:e}))(a)})),r&&i.createElement(Et,{row:a,className:o.smallBreakpointGradePill,isOverallGradeConfigured:r,gradingSchema:s,overallGradeColumn:l}))})),un=Object(k.withAnalytics)(Object(d.a)((e=>{var t,n;const{analyticsId:a,data:r,courseId:s,isOverallGradeConfigured:o,gradingSchema:l,analyticsEventAugmentor:c,overallGradeColumn:d}=e,u=ln(),m=(e=>{const[t,n]=Object(i.useState)("#");return Object(i.useEffect)((()=>{rt.Z.getPeekHref(Object(rt.gb)(e)).then((e=>{n(e)}))}),[e]),t})({courseId:s,userId:null===(t=null==r?void 0:r.user)||void 0===t?void 0:t.id,membershipId:null===(n=null==r?void 0:r.membership)||void 0===n?void 0:n.id}),p="gradebook.studentListView.studentCard.link";return i.createElement(sn.a,{analyticsId:`${a}.card`,className:u.cardRoot},i.createElement(on.a,{analyticsId:`${a}.cardContent`,className:u.cardContent},i.createElement("a",{className:u.cardLink,href:m,"data-analytics-id":p,onClick:c(cn.AnalyticsEventTypes.CLICK_EVENT,k.defaultOnClick,p)},i.createElement(dn,{data:r,isOverallGradeConfigured:o,gradingSchema:l,classes:u,overallGradeColumn:d})),i.createElement(Dt,{row:r,className:u.smallBreakpointActionMenu,courseId:s})))}))),mn=Object(d.a)((e=>{const{analyticsId:t,localize:n,bodyData:a,isLoading:r,courseId:s,isOverallGradeConfigured:o,isOverallGradeHidden:l,gradingSchema:c,overallGradeColumn:d}=e,u=rn();return r?i.createElement("div",{className:u.loadingIcon},i.createElement(b.AnalyticsCircularProgress,{ariaLabel:n.translate("components.studentListView.loadingIconAriaLabel"),size:"large"})):i.createElement(i.Fragment,null,l&&i.createElement("div",{className:u.overallGradeInfo},i.createElement(I.Information,{className:u.infoIcon}),i.createElement("span",null,n.translate("course.grades.gradeVisibilityTooltip"))),a.map(((e,n)=>i.createElement("div",{className:0===n?u.firstStudentCard:"",key:n},i.createElement(un,{key:e.user.userName,analyticsId:t,data:e,courseId:s,isOverallGradeConfigured:o,gradingSchema:c,overallGradeColumn:d})))))})),pn=Object(Z.makeStyles)((e=>Object(Z.createStyles)({pageInfo:{display:"inline-flex",margin:"14px 16px 13px 0",alignItems:"center",fontWeight:e.typography.fontWeightBold},pageInfoSmall:{textAlign:"center",marginTop:"8px",fontWeight:e.typography.fontWeightBold},pageSize:{display:"inline-flex",margin:"14px 0 13px 0",alignItems:"center"},searchTextControl:{[e.breakpoints.up("md")]:{width:"340px"},width:"100%",margin:"14px 0 13px 0"},smallIconButton:{minWidth:"26px",maxHeight:"40px"},tableHeader:{display:"inline-flex",justifyContent:"space-between",width:"100%",flexDirection:"column",[e.breakpoints.up("md")]:{flexDirection:"row"}},searchTooltipWrapper:{display:"flex",alignItems:"center"},pagingOptions:{display:"inline-flex",flexDirection:"row",marginBottom:"13px",justifyContent:"center",[e.breakpoints.up("md")]:{justifyContent:"flex-start",marginBottom:"0px"},"& .page-size-component button, .paging-component-button":{border:`1px solid ${e.palette.text.hint}`,boxSizing:"border-box"}},pagingControl:{paddingTop:"35px","& .paging-component":{[e.breakpoints.up("sm")]:{justifyContent:"flex-end"},"& .paging-component-button":{border:`1px solid ${e.palette.text.hint}`,boxSizing:"border-box"}}}}))),hn=e=>{const t=Object(s.d)();return Object(i.useEffect)((()=>{t(M.V.course.fetchCourse(e))}),[t,e]),Object(s.e)((t=>M.Yb.course.getCourseById(t,e)))},gn=(e,t)=>{const[n,a]=i.useState(0),[r,s]=((e,t)=>{const[n,a]=Object(i.useState)(window.localStorage.getItem(e)||t);return Object(i.useEffect)((()=>{a(window.localStorage.getItem(e)||t)}),[e]),[n,t=>{window.localStorage.setItem(e,t),a(t)}]})(`${e}.studentListViewPageSize`,Ft[0].value),o=t?25:Number(r),l=i.useRef(t);return i.useEffect((()=>{if(l.current===t)return;l.current=t;const e=t?Number(r):25,i=Math.floor(e*n/o);a(i)}),[t,r,n,o]),{effectiveItemsPerPage:o,page:n,setPage:a,itemsPerPage:r,setItemsPerPage:s}},bn=(e,t)=>{const n=Object(s.d)(),a=Object(s.e)((e=>M.Yb.gradebookSchema.areGradebookSchemasLoading(e))),r=Object(s.e)((e=>M.Yb.gradebookSchema.getGradebookSchemaById(e,t)));return Object(i.useEffect)((()=>{e&&t&&!r&&!a&&n(M.V.gradebookSchema.loadGradebookSchema({courseId:e,schemaId:t}))}),[n,e,t,r,a]),r};const fn=(e,t)=>Math.max(1,Math.ceil(e/t)),vn=Object(d.a)((e=>{var t,n,a,r,o,l,c;const{analyticsId:d,courseId:u,localize:m,currentUserId:p}=e,h=pn(Object(dt.t)()),g=Object(dt.t)(),f=Object(dt.s)(g.breakpoints.down("xs")),{page:v,setPage:y,itemsPerPage:S,setItemsPerPage:C,effectiveItemsPerPage:E}=gn(p,f),[k,w]=i.useState(""),[T,O]=i.useState(),[A,P]=i.useState(),[x,$]=i.useState(!1),N=i.useRef(),D=((e,t)=>e===Lt.lastAccessDate?[{field:j.gb.LastAccessDate,direction:t}]:e===Lt.studentId?[{field:j.gb.StudentId,direction:t}]:e===Lt.username?[{field:j.gb.Username,direction:t}]:[{field:j.gb.FamilyName,direction:e===Lt.fullName?t:j.Wb.Ascending},{field:j.gb.GivenName,direction:e===Lt.fullName?t:j.Wb.Ascending}])(T,A),L=an(u),{memberships:G,users:R,view:B}=Object(en.g)({courseId:u,filter:{searchString:k,roleBucket:[j.y.Taking]},paging:{limit:E,offset:v*E},sort:D}),F=Object(en.i)(gt.key,u),U=(e=>{const t=Object(s.d)();return Object(i.useEffect)((()=>{t(M.V.gradebookColumn.loadGradebookColumnsByCourseId(e))}),[t,e]),nn(e).length>0})(u),_=tn(u,null==L?void 0:L.id,G),z=(e=>{const t=hn(e),n=!0===(null==t?void 0:t.isAvailable)&&!0===(null==t?void 0:t.isClosed);return Object(en.t)(e,"course.gradebook.MODIFY")&&t&&!n})(u),q=z&&U&&!L&&"true"!==(null==F?void 0:F.value),V=bn(u,null==L?void 0:L.gradingSchemaId),W=i.useCallback(Object(H.debounce)((e=>{y(0),w(e)}),250),[]),K=i.useCallback((e=>{y(0),C(e.toString())}),[y,C]),Y=G.map((e=>({user:R[e.userId],membership:e,overallGrade:_&&_[e.userId]}))),J=i.useCallback(((e,t)=>{O(e),P(t)}),[]),Z=Rt.map((e=>Gt[e]));const Q=!(null===(t=null==L?void 0:L.visible)||void 0===t||t),X=m.translate("gradebook.studentList.common.search."+(f?"short":"long")),ee=null!==(a=null===(n=null==B?void 0:B.paging)||void 0===n?void 0:n.count)&&void 0!==a?a:0,te=Number.isInteger(null===(r=null==B?void 0:B.paging)||void 0===r?void 0:r.offset)?B.paging.offset+1:0,ne=Number.isInteger(null===(o=null==B?void 0:B.paging)||void 0===o?void 0:o.offset)?B.paging.offset+Y.length:0,ae="student-list-filter-tooltip";let ie;ie=L?(null==B?void 0:B.isLoading)||!Q&&!V:null==B?void 0:B.isLoading;const re=i.useCallback((()=>{$(!0)}),[]),se=i.useCallback((()=>{$(!1)}),[]);return i.useEffect((()=>{const e=N.current;return e&&(e.addEventListener("focus",re),e.addEventListener("blur",se)),()=>{e&&(e.removeEventListener("focus",re),e.removeEventListener("blur",se))}}),[re,se]),i.createElement(i.Fragment,null,i.createElement("div",{className:h.tableHeader},i.createElement("div",{className:h.searchTooltipWrapper},i.createElement(ft.M,{inputId:"student-list-filter-input",analyticsId:`${d}.filter.input`,inputRef:N,label:m.translate("gradebook.studentList.common.search.abbreviated"),InputProps:{inputProps:{"aria-describedby":ae}},TextFieldProps:{fullWidth:!1,className:h.searchTextControl},onChange:W}),i.createElement(b.AnalyticsTooltip,{id:ae,analyticsId:`${d}.filter.tooltip`,open:x,placement:"top-start",onOpen:re,onClose:se,title:X},i.createElement(b.AnalyticsIconButton,{id:"student-list-filter-tooltip-iconButton",analyticsId:`${d}.filter.tooltip.iconButton`,className:h.smallIconButton,"aria-label":m.translate("gradebook.studentList.common.search.tooltipAriaLabel")},i.createElement(I.Information,null)))),i.createElement("div",{className:h.pagingOptions},!f&&i.createElement(i.Fragment,null,!ie&&i.createElement(ft.G,{className:h.pageInfo,totalItems:ee,rangeStart:te,rangeEnd:ne}),i.createElement(ft.H,{className:h.pageSize,pageSizeOptions:(le=Ft,le.map((({value:e})=>Number(e)))),initialPageSize:(oe=S,Ut.indexOf(Number(oe))<0?{value:"25",label:"25"}:{value:`${oe}`,label:`${oe}`}).value,onPageSizeChange:K,analyticsId:d})),(null==B?void 0:B.paging)&&i.createElement(ft.I,{page:v,className:"paging-component",compact:f,numberOfPages:fn(null===(l=null==B?void 0:B.paging)||void 0===l?void 0:l.count,E),onPageChange:y,analyticsId:d}))),f&&i.createElement(mn,{analyticsId:d,bodyData:Y,isLoading:ie,isOverallGradeConfigured:!!L,isOverallGradeHidden:Q,courseId:u,gradingSchema:V,overallGradeColumn:L}),!f&&i.createElement(Xt,{analyticsId:d,columnData:Z,bodyData:Y,isLoading:ie,isOverallGradeConfigured:!!L,isOverallGradeHidden:Q,courseId:u,onSortChanged:J,gradingSchema:V,overallGradeColumn:L}),(null==B?void 0:B.paging)&&i.createElement("div",{className:h.pagingControl},i.createElement(ft.I,{className:"paging-component",compact:f,page:v,numberOfPages:fn(null===(c=null==B?void 0:B.paging)||void 0===c?void 0:c.count,E),onPageChange:y,analyticsId:d}),f&&!ie&&i.createElement(ft.G,{className:h.pageInfoSmall,totalItems:ee,rangeStart:te,rangeEnd:ne})),q&&i.createElement(bt,{analyticsId:`${d}.overallGradeSetup`,showFixedView:!1,courseId:u}));var oe,le})),yn=Object(Z.makeStyles)((()=>Object(Z.createStyles)({panelFooter:{position:"absolute",bottom:0,left:0,right:0,"& .ms-Panel-footer":{justifyContent:"center"}}}))),Sn=Object(d.a)((e=>{const{analyticsId:t,onClickApply:n,onClickCancel:a,isFiltersPanelDirty:r,localize:{translate:s}}=e,o=yn();return i.createElement("div",{className:o.panelFooter},i.createElement(p.BbPanelFooter,{primaryButtonProps:{text:s("gradebook.gridFiltersPanel.footer.apply"),onClick:n,disabled:!r},secondaryButtonProps:{text:s("gradebook.gridFiltersPanel.footer.cancel"),onClick:a},analyticsId:t}))})),Cn=Object(Z.makeStyles)((()=>Object(Z.createStyles)({header:{"& .ms-Panel-header":{boxShadow:"none"}},body:{marginTop:"24px",marginBottom:"48px"},clearFilters:{marginBottom:"8px",height:"29px"},filter:{marginBottom:"16px"}}))),En=Object(d.a)((e=>{const{inputId:t,analyticsId:n,courseId:a,onSelectionChange:r,localize:{translate:o}}=e,l=e.selectedMembershipIds||[],c=l.join(""),d=Object(s.e)((e=>M.Yb.courseMembership.getUsersFromMembershipIds(e,l).map((e=>null==e?void 0:e.id)))),[u,m]=Object(i.useState)(d),p=Object(s.e)((e=>M.Yb.courseMembership.getCourseMembershipsByUserIds(e,a,u).map((e=>null==e?void 0:e.id)))),h=p.join(""),g=Object(s.e)((e=>M.Yb.courseMembership.getUsersFromMembershipIds(e,p))),[f,v]=Object(i.useState)(!1),y=Object(i.useCallback)((e=>{v(!0),m(e.map((e=>null==e?void 0:e.id)))}),[m]);Object(i.useEffect)((()=>{f&&h!==c&&r(p),v(!1)}),[h,c,f]),Object(i.useEffect)((()=>{m(d)}),[d.join(""),u.join("")]);const S={inputId:t,analyticsId:n,courseId:a,placeholder:o("gradebook.gridFiltersPanel.memberships.placeholder"),selectedUsers:g,onMemberSelectionChanged:y,selectionLimit:100,label:o("gradebook.gridFiltersPanel.memberships.label"),roleBuckets:[j.y.Taking]};return!u.some((e=>!e))?i.createElement(Ot.c,{...S}):i.createElement(b.AnalyticsCircularProgress,{ariaLabel:o("gradebook.gridFiltersPanel.memberships.loading"),size:"small"})})),In=Object(d.a)((e=>{const{inputId:t,courseId:n,analyticsId:a,localize:{translate:r},onSelectionChange:o,selectedGroupIds:l}=e,c=Object(i.useCallback)((e=>{o(e.map((e=>e.id)))}),[o]),d=Object(s.e)((e=>M.Yb.group.getCourseGroupsByIds(e,l)));return!d.some((e=>!e))?i.createElement(Ot.b,{inputId:t,label:r("gradebook.gridFiltersPanel.groups.label"),courseId:n,analyticsId:a,placeholder:r("gradebook.gridFiltersPanel.groups.placeholder"),selectionLimit:100,selectedGroups:d,onSelectedGroupsChanged:c}):i.createElement(b.AnalyticsCircularProgress,{ariaLabel:r("gradebook.gridFiltersPanel.groups.loading"),size:"small"})}));var kn=n("9Ktm");const wn=(e,t)=>{if(e.localizableTitle){const n=e.localizableTitle.languageKey.toLowerCase();return t.translate(`categories.${n}`)}return e.title},Tn=/-/g,On=Object(Z.makeStyles)((()=>Object(Z.createStyles)({choiceLabel:{marginLeft:"-8px"}}))),An=Object(d.a)((e=>{const t=On(),{categories:n,selectedCategoryIds:a,onSelectionChange:r,localize:s,analyticsId:o,currentLocale:l}=e,c=((e,t,n)=>e&&e.sort(((e,a)=>{var i;const r=wn(e,t),s=wn(a,t),o=(null===(i=null==n?void 0:n.match(Tn))||void 0===i?void 0:i.length)>1?n.split("-",2).join("-"):n;return r.localeCompare(s,o)})))(n,s,l),d=Object(i.useCallback)((e=>{const t=e.target.value;r(((e,t)=>{const n=[...e],a=n.indexOf(t);return-1!==a?n.splice(a,1):n.push(t),n})(a,t))}),[a,r]);return i.createElement(kn.a,{legendText:s.translate("gradebook.gridFiltersPanel.categoriesTitle"),legendVariant:"h4"},c.map((e=>i.createElement(b.AnalyticsFormControlLabel,{label:wn(e,s),className:t.choiceLabel,htmlFor:e.id,control:i.createElement(b.AnalyticsCheckbox,{id:e.id,value:e.id,checked:a.includes(e.id),analyticsId:`${o}.pickCategoryCheckbox.${e.id}`}),analyticsId:`${o}.pickCategoryLabel.${e.id}`,key:e.id,onChange:d}))))})),Pn=e=>{const t=Object(s.d)(),n=Object(s.e)((t=>M.Yb.gradebookCategory.getGradebookCategoriesByCourseId(t,e)));return Object(i.useEffect)((()=>{n||t(M.V.gradebookCategory.loadGradebookCategoriesByCourseId(e))}),[t,e,n]),n};var xn=Pn;const $n=Object(Z.makeStyles)((e=>Object(Z.createStyles)({dialogTitle:{"& h1":{fontFamily:e.typography.fontFamily}}}))),Nn=Object(d.a)((e=>{const{showConfirmationModal:t,analyticsId:n,localize:{translate:a},handleOnClose:r,handleOnConfirmation:s}=e,o="cancel-grid-advanced-filters",l=$n(e);return i.createElement(i.Fragment,null,i.createElement(u.a,{analyticsId:n,open:t,maxWidth:"md",onClose:r,"aria-labelledby":`${o}-dialog-title`},i.createElement(b.AnalyticsDialogTitle,{analyticsId:`${n}.titleClose.button`,id:`${o}-dialog-title`,onClick:r,className:l.dialogTitle},a("gradebook.gridFiltersPanel.confirmationDialog.title")),i.createElement(b.AnalyticsDialogContent,{analyticsId:`${n}.content`},i.createElement(b.AnalyticsDialogContentText,{analyticsId:"",id:`${o}-dialog-description`},a("gradebook.gridFiltersPanel.confirmationDialog.content"))),i.createElement(b.AnalyticsDialogActions,{analyticsId:`${n}.actions`},i.createElement(b.AnalyticsDefaultButton,{analyticsId:`${n}.close.button`,onClick:r},a("gradebook.gridFiltersPanel.confirmationDialog.cancel")),i.createElement(b.AnalyticsPrimaryButton,{analyticsId:`${n}.confirmation.button`,onClick:s},a("gradebook.gridFiltersPanel.confirmationDialog.confirmation")))))})),Dn=Object(d.a)((e=>{const{inputId:t,analyticsId:n,courseId:a,onSelectionChange:r,localize:{translate:o},selectedColumnsIds:l}=e,c=Object(s.e)((e=>{const t=M.Yb.gradebookColumn.getGradebookColumnsByIds(e,l);return Object.keys(t).map((e=>t[e]))})),d=Object(i.useCallback)((e=>{r(e.map((e=>e.id)))}),[r]);return!c.some((e=>!e))?i.createElement(Ot.d,{inputId:t,analyticsId:`${n}.pickColumns`,courseId:a,onColumnSelectionChanged:d,selectedColumns:c,selectionLimit:100,label:o("gradebook.gridFiltersPanel.gradebookColumns.label"),placeholder:o("gradebook.gridFiltersPanel.gradebookColumns.placeholder")}):i.createElement(b.AnalyticsCircularProgress,{ariaLabel:o("gradebook.gridFiltersPanel.gradebookColumns.loading"),size:"small"})})),Ln=Object(Z.makeStyles)((e=>Object(Z.createStyles)({choiceLabel:{marginLeft:"-8px"},paragraph:{color:e.palette.text.secondary,marginBottom:"12px",fontStyle:"italic",fontWeight:e.typography.fontWeightRegular},divider:{border:"1px solid",borderColor:e.palette.secondary.main,margin:"16px 0px 0px 0px",height:"0px"}})));var jn=n("mrT9"),Mn=n("oNm+");const Gn=Object(d.a)((e=>{const t=Ln(),{childCourses:n,selectedChildCourseIds:a,localize:r,onSelectionChanged:s,analyticsId:o}=e,l=Object(i.useCallback)((e=>{const t=e.target.value;s(function(e,t){const n=[...e],a=n.indexOf(t);return-1!==a?n.splice(a,1):n.push(t),n}(a,t))}),[a,s]);return i.createElement(Z.CheckboxGroup,{legendText:r.translate("gradebook.gridFiltersPanel.mergedCourses.label"),legendVariant:"h4"},i.createElement(jn.a,{className:t.paragraph,variant:"subtitle2"},r.translate("gradebook.gridFiltersPanel.mergedCourses.guide")),n.map(((e,n)=>i.createElement(b.AnalyticsFormControlLabel,{label:e.childCourse.name,className:t.choiceLabel,htmlFor:`standard-checkbox-${e.childCourse.id}`,control:i.createElement(b.AnalyticsCheckbox,{id:`standard-checkbox-${e.childCourse.id}`,checked:a.includes(e.childCourse.id),value:e.childCourse.id,onChange:l,analyticsId:`${o}.pickMergedCourse.Checkbox.${e.childCourse.id}`}),analyticsId:`${o}.pickMergedCourse.${n}`,key:e.childCourse.id}))),i.createElement(Mn.a,{className:`${t.divider}`,variant:"middle"}))})),Rn=Object(d.a)((e=>{var t,n,a,r,o,l,c,d,u,m;const{courseId:h,onFiltersChanged:g,analyticsId:f,localize:{translate:v}}=e,y=Cn(),[S,C]=i.useState(!1),E=Object(s.e)((e=>M.Yb.app.getLocation(e).queryParams)),I=null!==(n=null===(t=null==E?void 0:E.memberId)||void 0===t?void 0:t.split(","))&&void 0!==n?n:[],k=null!==(r=null===(a=null==E?void 0:E.courseGroupId)||void 0===a?void 0:a.split(","))&&void 0!==r?r:[],w=null!==(l=null===(o=null==E?void 0:E.gradebookColumnId)||void 0===o?void 0:o.split(","))&&void 0!==l?l:[],T=null!==(d=null===(c=null==E?void 0:E.gradebookCategoryId)||void 0===c?void 0:c.split(","))&&void 0!==d?d:[],O=null!==(m=null===(u=null==E?void 0:E.childCourseId)||void 0===u?void 0:u.split(","))&&void 0!==m?m:[],[A,P]=Object(i.useState)(I),[x,$]=Object(i.useState)(O),[N,D]=Object(i.useState)(w),[L,j]=Object(i.useState)(T),[G,R]=Object(i.useState)(k),[B,F]=Object(i.useState)(!1),U=Pn(h),_=(e=>{const t=Object(s.e)((t=>M.Yb.courseChildren.byParentCourseId(t,e))),n=Object(s.d)();return i.useEffect((()=>{t||n(M.V.courseChildren.loadChildCourses(e))}),[n,e,t]),t})(h),z=(e=>{const[t,n]=Object(i.useState)(!1),a=Object(s.e)((e=>M.Yb.app.getRoute(e).params));return Object(i.useEffect)((()=>{const{selectedMembershipIds:t,selectedGroupIds:i,selectedCourses:r,selectedCategoryIds:s,selectedColumnIds:o}=e,l=a.memberId?a.memberId!==(null==t?void 0:t.join(",")):(null==t?void 0:t.length)>0,c=a.courseGroupId?a.courseGroupId!==(null==i?void 0:i.join(",")):(null==i?void 0:i.length)>0,d=a.childCourseId?a.childCourseId!==(null==r?void 0:r.join(",")):(null==r?void 0:r.length)>0,u=a.gradebookCategoryId?a.gradebookCategoryId!==(null==s?void 0:s.join(",")):(null==s?void 0:s.length)>0,m=a.gradebookColumnId?a.gradebookColumnId!==(null==o?void 0:o.join(",")):(null==o?void 0:o.length)>0;n(l||c||d||u||m)}),[a.memberId,a.courseGroupId,a.childCourseId,a.gradebookCategoryId,a.gradebookColumnId,e.selectedMembershipIds,e.selectedGroupIds,e.selectedCourses,e.selectedCategoryIds,e.selectedColumnIds]),t})({selectedMembershipIds:A,selectedGroupIds:G,selectedCourses:x,selectedCategoryIds:L,selectedColumnIds:N});Object(i.useEffect)((()=>{g(z)}),[z]);const q=Object(i.useCallback)((()=>{const e={...E,memberId:void 0,childCourseId:void 0,gradebookCategoryId:void 0,gradebookColumnId:void 0,courseGroupId:void 0};A.length>0&&(e.memberId=A.join(",")),x.length>0&&(e.childCourseId=x.join(",")),L.length>0&&(e.gradebookCategoryId=L.join(",")),N.length>0&&(e.gradebookColumnId=N.join(",")),G.length>0&&(e.courseGroupId=G.join(",")),rt.Z.search(e),g(!1),rt.Z.leavePeekState()}),[L,G,A,x,N]),H=Object(i.useCallback)((()=>{A.length>0&&P([]),x.length>0&&$([]),L.length>0&&j([]),N.length>0&&D([]),G.length>0&&R([]),F(!1),g(!0)}),[g,L,G,A,x,N]),V=Object(i.useCallback)((()=>{g(!1),C(!1),rt.Z.leavePeekState()}),[g]),W=Object(i.useCallback)((()=>{z?C(!0):(g(!1),rt.Z.leavePeekState())}),[z,g]);Object(i.useEffect)((()=>{F(A.length>0||x.length>0||N.length>0||L.length>0||G.length>0)}),[L,G,A,x,N]);const K=v("gradebook.gridFiltersPanel.header.clearAll");return i.createElement("div",{className:"grid-filters-panel"},S&&i.createElement(Nn,{analyticsId:`${f}.cancel`,showConfirmationModal:S,handleOnClose:()=>C(!1),handleOnConfirmation:V}),i.createElement("div",{className:"panel-wrap"},i.createElement("div",{className:`panel-header simple-header ${y.header}`},i.createElement(p.BbPanelHeader,{title:v("gradebook.gridFiltersPanel.header.title"),smallHeaderTitle:v("gradebook.gridFiltersPanel.header.smallTitle"),type:p.BbPanelType.peek,analyticsId:`${f}.header`,hideNavMenu:!0,panelContentRight:B?i.createElement(b.AnalyticsLink,{className:y.clearFilters,"aria-label":K,variant:"button",tabIndex:0,href:"#",analyticsId:`${f}.clearAllFilters`,onClick:H},K):null})),i.createElement("div",{className:`panel-body panel-content ${y.body}`},(null==_?void 0:_.length)>0?i.createElement("div",{className:`${y.filter}`},i.createElement(Gn,{childCourses:_,analyticsId:`${f}.mergedCoursesPicker`,selectedChildCourseIds:x,onSelectionChanged:$})):null,i.createElement("div",{className:`${y.filter}`},i.createElement(En,{inputId:"student-picker",courseId:h,selectedMembershipIds:A,onSelectionChange:P,analyticsId:`${f}.membershipsPicker`})),i.createElement("div",{className:`${y.filter}`},i.createElement(In,{inputId:"groups-picker",courseId:h,selectedGroupIds:G,analyticsId:`${f}.groupsPicker`,onSelectionChange:R})),i.createElement("div",{className:`${y.filter}`},i.createElement(Dn,{inputId:"gradable-items-picker",courseId:h,analyticsId:`${f}.gradebookColumnsPicker`,selectedColumnsIds:N,onSelectionChange:D})),(null==U?void 0:U.length)&&i.createElement("div",{className:`${y.filter}`},i.createElement(An,{analyticsId:`${f}.categoriesPicker`,categories:U,selectedCategoryIds:L,onSelectionChange:j})))),i.createElement(Sn,{onClickApply:q,onClickCancel:W,isFiltersPanelDirty:z,analyticsId:`${f}.footer`}))}));var Bn=n("YK4x"),Fn=n("1t0C");const Un=Object(Z.makeStyles)((e=>Object(Z.createStyles)({gradeOptionDescription:{color:e.palette.text.secondary,marginLeft:"20px"}})));var _n;!function(e){e.Gradebook="gradebook",e.GradeHistory="gradeHistory"}(_n||(_n={}));const zn=[_n.Gradebook,_n.GradeHistory],qn=[j.M.Tab,j.M.Comma],Hn=[{id:"_All",value:j.L.AllTime},{id:"_6Months",value:j.L.SixMonths},{id:"_30Days",value:j.L.ThirtyDays},{id:"_14Days",value:j.L.FourteenDays},{id:"_7Days",value:j.L.SevenDays},{id:"_1Day",value:j.L.OneDay}],Vn=[j.N.MyDevice,j.N.ContentCollection],Wn=i.memo((e=>{const{analyticsId:t,gradeOption:n,onChangeGradeOption:a}=e,r=Object(Bn.a)(),s=Un(),o="gradebook.grades-download";return i.createElement(i.Fragment,null,i.createElement(jn.a,{variant:"h2",gutterBottom:!0},r(`${o}.downloadOptions`)),i.createElement(b.AnalyticsRadioGroup,{analyticsId:`${t}.grade-options`,hasCustomLegend:!1,legendVariant:"h3",legendText:r(`${o}.gradeRecords.title`),value:n,onChange:e=>a(e.target.value)},zn.map((e=>i.createElement(i.Fragment,{key:e},i.createElement(Fn.FormControlLabel,{value:e,htmlFor:`radio-${e}-id`,control:i.createElement(b.AnalyticsRadio,{id:`radio-${e}-id`,analyticsId:`${t}.${e}.input.radio`,inputProps:{"aria-describedby":`${e}-record-id`}}),label:r(`${o}.gradeRecords.${e}.title`)}),i.createElement(jn.a,{id:`${e}-record-id`,component:"span",className:s.gradeOptionDescription},r(`${o}.gradeRecords.${e}.description`)))))))}));var Kn=n("SKvq");const Yn=Object(Z.makeStyles)((()=>Object(Z.createStyles)({showMoreButton:{marginTop:"8px"}})));var Jn=n("RPob");const Zn=e=>!!e.id&&!!e.columnName,Qn=e=>({value:e.id||"-",label:e.columnName||"-",checked:!1}),Xn=e=>e.filter(Zn).map(Qn),ea=e=>e.filter((e=>e.calculationType===j.p.NonCalculated&&Zn(e))).map(Qn),ta=e=>{var t;const{courseId:n,onChange:a,analyticsId:r,converter:s,selectedColumnIds:o,onChangeSelectAllItems:l,selectAllItems:c,children:d}=e,u=Object(Bn.a)(),m=Yn(),p="gradebook.grades-download.grade-history.RecordDetails",[h,g]=Object(i.useState)(50),[f,v]=Object(i.useState)([]),{columns:y,view:S,totalColumns:C}=((e,t,n)=>{var a,i;const{gradebookColumns:r,view:s}=Object(en.o)({courseId:e,paging:{limit:n}});return{columns:t(r),totalColumns:null!==(i=null===(a=null==s?void 0:s.paging)||void 0===a?void 0:a.count)&&void 0!==i?i:0,view:s}})(n,s,h);Object(i.useEffect)((()=>{if(null==S?void 0:S.isLoading)return;const e=((e,t,n)=>e.map((e=>({...e,checked:!!n||t.includes(e.value)}))))(y,o,c);v(e)}),[null==S?void 0:S.isLoading,null===(t=null==S?void 0:S.paging)||void 0===t?void 0:t.limit]);const E=Object(i.useCallback)((e=>{v((t=>{const n=e(t);return null==a||a(n),n}))}),[v,a]);return(null==S?void 0:S.isLoading)?i.createElement(Kn.CircularProgress,{ariaLabel:u(`${p}.MultiselectCheckbox.loading`),size:"small"}):i.createElement(i.Fragment,null,i.createElement(ft.N,{analyticsId:r,items:f,checkboxGroupLegendText:u(`${p}.header.title`),headerDescription:u(`${p}.header.description`),selectAllItemsLabel:u(`${p}.MultiselectCheckbox.selectAll.Label`),onChange:E,onChangeSelectAllItems:l}),C>50&&h!==C&&i.createElement(b.AnalyticsLink,{analyticsId:"course.grades.grades-download-settings.showMore",className:m.showMoreButton,component:"button",onClick:()=>{g(C)}},u("gradebook.grades-download.common.showMore")),d)},na=Object(Z.makeStyles)((e=>Object(Z.createStyles)({fileTypeDescription:{color:e.palette.text.secondary,marginBottom:"13px"}}))),aa=i.memo((e=>{const{analyticsId:t,delimiterType:n,onChangeDelimiterType:a}=e,r=Object(Bn.a)(),s=na(),o="gradebook.grades-download";return i.createElement(b.AnalyticsRadioGroup,{id:"gradesDownload.delimiterType.RadioGroup",analyticsId:`${t}.delimiterType.RadioGroup`,hasCustomLegend:!1,legendVariant:"h3",legendText:r(`${o}.delimiterType.LegendText`),value:n,onChange:e=>a(e.target.value)},i.createElement("span",{className:s.fileTypeDescription},r(`${o}.delimiterType.description`)),qn.map((e=>i.createElement(b.AnalyticsFormControlLabel,{key:e,value:e,htmlFor:`radio-${e}-id`,control:i.createElement(b.AnalyticsRadio,{analyticsId:`${t}.delimiterType.${e}.Radio`,id:`radio-${e}-id`}),label:r(`${o}.delimiterType.${e}.Label`),analyticsId:`course.grades.grades-download-settings.${e}.input.radio`}))))}));var ia=n("XtkS");const ra=Object(Z.makeStyles)((e=>Object(Z.createStyles)({switchControlRoot:{marginLeft:"auto"},switchFormControlLabelPlacementStart:{marginRight:"0"},switchFormControlLabel:{display:"flex",justifyContent:"space-between",marginLeft:"0"},switchFormControlLabelDisabled:{color:`${e.palette.primary.light}`},switchFormControlRoot:{width:"100%"}}))),sa=e=>{const{enableFlag:t,flagValue:n,setFlagValue:a,flagControlId:r,i18nFlagLabelKey:s,analyticsId:o,disabled:l}=e,c=Object(Bn.a)(),d=ra();return t?i.createElement("div",{className:"bottom-option stretch-message"},i.createElement(ia.a,{className:d.switchFormControlRoot},i.createElement(Fn.FormControlLabel,{label:c(s),htmlFor:r,control:i.createElement(b.AnalyticsSwitch,{analyticsId:`${o}.switchExtraCheck`,id:r,checked:n,onChange:e=>{a(e.target.checked)},disabled:!!l,classes:{root:d.switchControlRoot}}),labelPlacement:"start",className:d.switchFormControlLabel,classes:{labelPlacementStart:d.switchFormControlLabelPlacementStart,label:d.switchFormControlLabelDisabled}}))):null},oa=Object(Z.makeStyles)((e=>Object(Z.createStyles)({contentCollection:{display:"flex",marginTop:"10px","& input":{border:"0",marginBottom:"0"},[e.breakpoints.down("xs")]:{flexDirection:"column"}},contentCollectionFormControl:{flex:"1",[e.breakpoints.down("xs")]:{marginBottom:"16px"}}}))),la=i.memo((e=>{const{analyticsId:t,saveLocation:n,contentCollectionUrl:a,onChangeSaveLocation:r,onChangeContentCollectionUrl:s}=e,o=Object(Bn.a)(),l=oa(),c="gradebook.grades-download",d=n===j.N.ContentCollection;return i.createElement(i.Fragment,null,i.createElement(b.AnalyticsRadioGroup,{id:"gradesDownload.saveLocation.RadioGroup",analyticsId:`${t}.saveLocation.RadioGroup`,hasCustomLegend:!1,legendVariant:"h3",legendText:o(`${c}.saveLocation.LegendText`),value:n,onChange:e=>r(e.target.value)},Vn.map((e=>i.createElement(b.AnalyticsFormControlLabel,{key:e,value:e,htmlFor:`radio-${e}-id`,control:i.createElement(b.AnalyticsRadio,{analyticsId:`course.grades.grades-download-settings.${e}.input.radio`,id:`radio-${e}-id`}),label:o(`${c}.saveLocation.${e}.Label`),analyticsId:`${t}.saveLocation.${e}.Label`})))),d&&i.createElement("div",{className:l.contentCollection},i.createElement(b.AnalyticsTextField,{analyticsId:"course.grades.grades-download-settings.content.collection.input.text",id:"content-collection-url-input",className:l.contentCollectionFormControl,value:a,onChange:e=>s(e.target.value)}),i.createElement(b.AnalyticsPrimaryButton,{analyticsId:"course.grades.grades-download-settings.browse",onClick:()=>{rt.Z.goPeekState({routeName:"content-collection-picker",getArgs:()=>({pickerType:"Folder",multi:"false"})})}},o(`${c}.saveLocation.browse`))))})),ca=Object(Z.makeStyles)((e=>Object(Z.createStyles)({messageFeedback:{color:e.palette.text.secondary}}))),da=({enableFlag:e,messageKey:t})=>{const n=Object(Bn.a)(),a=ca();return e?i.createElement("div",{className:"bottom-option stretch"},i.createElement("span",{className:a.messageFeedback},n(t))):null},ua=e=>Object(dt.e)({styles:{backgroundColor:e.palette.border.main,margin:"20px 0"}}),ma=({courseId:e,analyticsId:t,delimiterType:n,saveLocation:a,contentCollectionUrl:r,onChangeSaveLocation:s,onChangeContentCollectionUrl:o,onChangeDelimiterType:l,includeFeedbackFlag:c,setIncludeFeedbackFlag:d,includeFeedbackControlId:u,onChangeSelectedColumnItems:m,selectedColumnIds:p,onChangeSelectAllItems:h,selectAllItems:g})=>{const b=Object(Z.makeStyles)(ua)(),[f,v]=Object(i.useState)(!1),y="gradebook.grades-download.grade-history.RecordDetails",S=((e,t)=>{const n=Object(i.useCallback)((n=>{((e,t,n)=>{((e,t,n)=>{if(!e)return!1;let a=0;for(let i=0;i<e.length;i++)if(t(e[i])&&(a+=1,n(a)))return!0;return!1})(e,(e=>e.checked),(e=>e>1))?(t(!0),n(!1)):t(!1)})(n,e,t)}),[e,t]);return n})(v,d),C=Object(i.useCallback)((e=>{S(e),m(e)}),[S,m]);return i.createElement(i.Fragment,null,i.createElement(ta,{courseId:e,analyticsId:t,selectedColumnIds:p,selectAllItems:g,onChange:C,converter:Xn,onChangeSelectAllItems:h},i.createElement(sa,{analyticsId:t,enableFlag:!0,flagControlId:u,flagValue:c,setFlagValue:d,disabled:f,i18nFlagLabelKey:`${y}.MultiselectCheckbox.includeFeedback.Label`}),i.createElement(da,{messageKey:`${y}.MultiselectCheckbox.includeFeedback.FeedbackDescription`,enableFlag:f})),i.createElement(Mn.a,{className:b.styles}),i.createElement(aa,{analyticsId:t,delimiterType:n,onChangeDelimiterType:l}),i.createElement(Mn.a,{className:b.styles}),i.createElement(la,{analyticsId:t,saveLocation:a,contentCollectionUrl:r,onChangeSaveLocation:s,onChangeContentCollectionUrl:o}))},pa=i.memo((({options:e,analyticsId:t,defaultSelectedValue:n,onChange:a})=>{const r=Object(Bn.a)(),s="gradebook.grades-download.grade-history",[o,l]=Object(i.useState)(n);return i.createElement(b.AnalyticsTextField,{fullWidth:!0,className:"lastmodifiedDatePicker_Container",analyticsId:`${t}.lastmodifiedDatePicker`,id:"lastmodifiedDatePicker",select:!0,label:r(`${s}.lastmodifiedDatePicker.Label`),"aria-label":r(`${s}.lastmodifiedDatePicker.AriaLabel`),value:o,onChange:e=>{const t=e.target.value;l(t),a(t)}},e.map((e=>i.createElement(b.AnalyticsMenuItem,{button:!0,key:e.id,value:e.value,analyticsId:`${t}.lastmodifiedDatePicker.${e.value}`},r(`${s}.lastmodifiedDatePicker.${e.id}.Label`)))))})),ha=({courseId:e,analyticsId:t,delimiterType:n,lastModifiedDate:a,onChangeDelimiterType:r,onChangeLastModifiedDate:s,includeDeletedItemsFlag:o,setIncludeDeletedItemsFlag:l,includeDeletedItemsControlId:c,saveLocation:d,contentCollectionUrl:u,onChangeSaveLocation:m,onChangeContentCollectionUrl:p,onChangeSelectedColumnItems:h,selectedColumnIds:g,onChangeSelectAllItems:b,selectAllItems:f})=>{const v=Object(Z.makeStyles)(ua)();return i.createElement(i.Fragment,null,i.createElement(ta,{courseId:e,analyticsId:t,selectedColumnIds:g,selectAllItems:f,converter:ea,onChangeSelectAllItems:b,onChange:h},i.createElement(sa,{analyticsId:t,enableFlag:!0,flagControlId:c,flagValue:o,setFlagValue:l,i18nFlagLabelKey:"gradebook.grades-download.grade-history.RecordDetails.MultiselectCheckbox.includeDeletedItems.Label"})),i.createElement(Mn.a,{className:v.styles}),i.createElement(pa,{analyticsId:t,defaultSelectedValue:a,options:Hn,onChange:s}),i.createElement(Mn.a,{className:v.styles}),i.createElement(aa,{analyticsId:t,delimiterType:n,onChangeDelimiterType:r}),i.createElement(Mn.a,{className:v.styles}),i.createElement(la,{analyticsId:t,saveLocation:d,contentCollectionUrl:u,onChangeSaveLocation:m,onChangeContentCollectionUrl:p}))},ga=Object(Z.makeStyles)((e=>Object(Z.createStyles)({body:{marginTop:"22px",marginBottom:"48px",[e.breakpoints.down("xs")]:{marginTop:"0"}},divider:{...ua(e).styles}}))),ba=Object(Z.makeStyles)((()=>Object(Z.createStyles)({panelFooter:{position:"absolute",bottom:0,left:0,right:0,"& .ms-Panel-footer":{justifyContent:"center"}}}))),fa=e=>{const{onClickDownload:t,onClickCancel:n,isDownloadDisabled:a,isGradeHistory:r}=e,s=Object(Bn.a)(),o=ba(),l=r?"course.grades.grades-download.settings.gradeHistoryDownloadAction":"course.grades.grades-download.settings.downloadAction";return i.createElement("div",{className:o.panelFooter},i.createElement(p.BbPanelFooter,{primaryButtonProps:{text:s("gradebook.grades-download.footer.download"),onClick:t,disabled:a},secondaryButtonProps:{text:s("gradebook.grades-download.common.cancel"),onClick:n},analyticsId:l}))};var va=n("yqjG"),ya=n("qFlV"),Sa=n("0b2F"),Ca=n("TbPE");const Ea="course.grade.gradesDownloadSettings.download",Ia="gradebook.grades-download.download",ka=e=>{const{isOpen:t,isGradeHistory:n,onClose:a,onTryAgain:r}=e,s=Object(Bn.a)(),o=s(n?`${Ia}.gradeHistoryFailed`:`${Ia}.gradebookFailed`);return i.createElement(u.a,{open:t,onClose:a,"aria-labelledby":"download-grades-error-title","aria-describedby":"download-grades-error-modal",analyticsId:`${Ea}.error.modal`},i.createElement(va.a,{onClose:a,id:"download-grades-error-title"},s(`${Ia}.failedTitle`)),i.createElement(ya.a,null,i.createElement(Sa.a,{id:"download-grades-error-modal"},o)),i.createElement(Ca.a,null,i.createElement(b.AnalyticsDefaultButton,{analyticsId:`${Ea}.cancel.button`,onClick:a},s("gradebook.grades-download.common.cancel")),i.createElement(b.AnalyticsPrimaryButton,{analyticsId:`${Ea}.tryAgain.button`,onClick:r},s(`${Ia}.tryAgain`))))},wa=(e,t)=>e&&t?j.K.HistoryLogAll:e&&!t?j.K.HistoryLog:t?j.K.All:j.K.ByColumns,Ta=(e,t)=>{switch(e){case j.L.AllTime:t.setTime(0);break;case j.L.FourteenDays:t.setDate(t.getDate()-14);break;case j.L.OneDay:t.setDate(t.getDate()-1);break;case j.L.SevenDays:t.setDate(t.getDate()-7);break;case j.L.SixMonths:t.setDate(t.getDate()-180);break;case j.L.ThirtyDays:t.setDate(t.getDate()-30)}return t};var Oa=n("AYd1"),Aa=n("Y+9S");const Pa=e=>{const{courseId:t,analyticsId:n}=e,a=ga(),r=Object(Bn.a)(),[o,l]=Object(i.useState)(_n.Gradebook),[c,d]=Object(i.useState)(j.L.AllTime),[u,m]=Object(i.useState)(!1),[h,g]=Object(i.useState)(!1),[b,f]=Object(i.useState)([]),[v,y]=Object(i.useState)(j.M.Tab),[S,C]=Object(i.useState)(j.N.MyDevice),[E,I]=Object(i.useState)(""),[k,w]=Object(i.useState)(!1),[T,O]=Object(i.useState)(!1),[A,P]=Object(i.useState)(!1),x=hn(t),$=o===_n.GradeHistory;(e=>{const t=Object(s.e)((e=>M.Yb.app.getRoute(e).name)),n=Object(i.useCallback)((n=>{if("classic-picker-submit"===n.data.messageId&&(t.endsWith("peek.content-collection-picker")&&rt.Z.leavePeekState(t),n.data.items.length)){const t=n.data.items[0];e(t.filePath)}"classic-picker-cancel"===n.data.messageId&&t.endsWith("peek.content-collection-picker")&&rt.Z.leavePeekState(t)}),[t]);Object(i.useEffect)((()=>(window.addEventListener("message",n),()=>{window.removeEventListener("message",n)})),[n])})(I);const{enqueueSnackbar:N}=Object(ft.mb)(ft.S.GradesDownloadToasts,!1),D=Object(i.useCallback)((e=>{l(e),f([]),m(!1),g(!1),O(!1)}),[]),L=Object(i.useCallback)((e=>{y(e)}),[y]),G=Object(i.useCallback)((e=>{C(e)}),[C]),R=Object(i.useCallback)((e=>{I(e)}),[I]),B=Object(i.useCallback)((e=>{d(e)}),[d]),F=Object(i.useCallback)((e=>{f((e=>e.filter((e=>e.checked)).map((e=>e.value)))(e))}),[f]),U=Object(i.useCallback)((e=>{O(e)}),[O]),_=async()=>{Object(Aa.o)(Aa.c.GradeBookDownloadButtonClicked);const e={icon:i.createElement(Oa.a,null),snackbarMessage:r("gradebook.grades-download.download.successful"),isPersistent:!1},n={closeButtonAriaLabel:r("gradebook.grades-download.download.closeSnackbarAriaLabel")},a={delimiterType:v,downloadTo:S,dataScopeType:wa($,T),contentCollectionUrl:E,columnIds:T?void 0:b,isShowComments:!!$||h,lastModifiedDate:$?Ta(c,new Date):void 0,isDeletedItemsIncluded:!!$&&u};P(!0);try{const i=await Object(M.Sb)(t,a);"SUCCESS"===i.responseCode?(N(e,n),S===j.N.MyDevice&&i.downloadUrl&&(e=>{const t=Object(Jn.j)();window.location.href=t+e})(i.downloadUrl),rt.Z.leavePeekState()):w(!0)}catch(e){w(!0)}finally{P(!1)}};return i.createElement(i.Fragment,null,i.createElement("div",{className:"panel-wrap"},i.createElement("div",{className:"panel-header simple-header"},i.createElement(p.BbPanelHeader,{title:r("gradebook.grades-download.header.title"),smallHeaderTitle:null==x?void 0:x.displayName,type:p.BbPanelType.peek,analyticsId:`${n}.header`,hideNavMenu:!0})),i.createElement("div",{className:`panel-body panel-content ${a.body}`},i.createElement(Wn,{analyticsId:n,gradeOption:o,onChangeGradeOption:D}),i.createElement(Mn.a,{className:a.divider}),!$&&i.createElement(ma,{courseId:t,analyticsId:n,delimiterType:v,saveLocation:S,selectedColumnIds:b,contentCollectionUrl:E,selectAllItems:T,onChangeDelimiterType:L,includeFeedbackFlag:h,setIncludeFeedbackFlag:g,includeFeedbackControlId:"include-feedback",onChangeSaveLocation:G,onChangeContentCollectionUrl:R,onChangeSelectedColumnItems:F,onChangeSelectAllItems:U}),$&&i.createElement(ha,{courseId:t,analyticsId:n,delimiterType:v,lastModifiedDate:c,selectAllItems:T,onChangeDelimiterType:L,onChangeLastModifiedDate:B,includeDeletedItemsFlag:u,setIncludeDeletedItemsFlag:m,includeDeletedItemsControlId:"include-deleteditems",saveLocation:S,contentCollectionUrl:E,selectedColumnIds:b,onChangeSaveLocation:G,onChangeContentCollectionUrl:R,onChangeSelectedColumnItems:F,onChangeSelectAllItems:U}))),i.createElement(fa,{onClickCancel:()=>{rt.Z.leavePeekState()},onClickDownload:()=>_(),isDownloadDisabled:(()=>{const e=b.length;return!!(A||0===e&&!u||S===j.N.ContentCollection&&""===E)})(),isGradeHistory:$}),i.createElement(ka,{isOpen:k,isGradeHistory:$,onClose:()=>w(!1),onTryAgain:()=>{w(!1),_()}}))},xa={marginRight:"8px",marginBottom:"8px",height:"29px"},$a=Object(Z.makeStyles)((()=>Object(Z.createStyles)({skeletonChip:{...xa,backgroundColor:"rgba(0, 0, 0, 0.3 )",display:"inline-flex",width:"80px",borderRadius:"16px",transform:"initial"}}))),Na=()=>{const e=$a();return i.createElement(Z.Skeleton,{className:e.skeletonChip})},Da=Object(d.a)((e=>{const{userNameFormat:t,analyticsId:n,localize:a,membershipId:r,courseId:o,onDelete:l,className:c}=e,d=Object(i.useCallback)((()=>l(r)),[l,r]),u=((e,t)=>{const n=Object(s.d)(),a=Object(s.e)((e=>M.Yb.courseMembership.getCourseMembershipByMembershipId(e,t)));Object(i.useEffect)((()=>{a&&a.userId||n(M.V.courseMembership.loadCourseMembershipByMemberId(e,t))}),[n,t,e,a]);const r=Object(s.e)((e=>{let t=null==a?void 0:a.user;return t||(t=M.Yb.user.getUserById(e,null==a?void 0:a.userId)),t})),o=null==a?void 0:a.userId;return Object(i.useEffect)((()=>{o&&!r&&n(M.V.user.loadUser(o))}),[n,r,o]),r})(o,r);return u?i.createElement(b.AnalyticsChip,{analyticsId:n,disabled:!u,className:c,label:a.formatUsername(u,t||It.ILocaleUsernameFormat.Short),onDelete:d}):i.createElement(Na,null)})),La=e=>{const{analyticsId:t,courseId:n,groupId:a,onDelete:r,className:o}=e,l=Object(i.useCallback)((()=>r(a)),[r,a]),c=((e,t)=>{const n=Object(s.d)(),a=Object(s.e)((e=>M.Yb.group.getGroupByGroupId(e,t)));return Object(i.useEffect)((()=>{a||n(M.V.group.loadGroupById(e,t))}),[n,a,t,e]),a})(n,a);return c?i.createElement(b.AnalyticsChip,{analyticsId:t,disabled:!c,label:c.title,onDelete:l,className:o}):i.createElement(Na,null)},ja=e=>{const{analyticsId:t,courseId:n,columnId:a,onDelete:r,className:o}=e,l=Object(i.useCallback)((()=>r(a)),[r,a]),c=((e,t)=>{const n=Object(s.d)(),a=Object(s.e)((e=>M.Yb.gradebookColumn.getGradebookColumnById(e,t)));return Object(i.useEffect)((()=>{a||n(M.V.gradebookColumn.loadGradebookColumn({courseId:e,columnId:t}))}),[n,a,t,e]),a})(n,a);return c?i.createElement(b.AnalyticsChip,{analyticsId:t,disabled:!c,className:o,label:c.columnName,onDelete:l}):i.createElement(Na,null)},Ma=Object(d.a)((e=>{const{localize:t,analyticsId:n,categoryId:a,onDelete:r,className:o}=e,l=Object(i.useCallback)((()=>r(a)),[r,a]),c=Object(s.e)((e=>M.Yb.gradebookCategory.getGradebookCategoryById(e,a)));return c?i.createElement(b.AnalyticsChip,{analyticsId:n,disabled:!c,className:o,label:wn(c,t),onDelete:l}):i.createElement(Na,null)})),Ga=e=>{const{analyticsId:t,parentCourseId:n,childCourseId:a,onDelete:r,className:o}=e,l=Object(i.useCallback)((()=>r(a)),[r,a]),c=((e,t)=>{const n=Object(s.d)(),a=Object(s.e)((e=>M.Yb.courseChildren.byChildCourseId(e,t)));return Object(i.useEffect)((()=>{a||n(M.V.courseChildren.loadChildCourse(e,t))}),[n,e,t,a]),a})(n,a);return(null==c?void 0:c.childCourse)?i.createElement(b.AnalyticsChip,{analyticsId:t,disabled:!c,label:c.childCourse.name,onDelete:l,className:o}):i.createElement(Na,null)},Ra={marginRight:"8px",marginBottom:"8px",height:"29px"},Ba=Object(Z.makeStyles)((e=>Object(Z.createStyles)({filterChips:{display:"flex",flexWrap:"wrap",marginTop:"8px"},filtersApplied:{...Ra,fontWeight:e.typography.fontWeightSemiBold},clearFilters:{...Ra},chip:{paddingTop:"7px",backgroundColor:"rgba(0, 0, 0, 0.3 )",...Ra},chipButton:{marginBottom:"-4px"}})));function Fa(e,t){return e.filter((e=>e!==t))}const Ua=Object(d.a)((e=>{const{courseId:t,localize:n,analyticsId:a,membershipIds:r,onMembershipIdsChanged:s,groupIds:o,onGroupIdsChanged:l,gradeColumnIds:c,onGradeColumnIdsChanged:d,gradeCategoryIds:u,onGradeCategoryIdsChanged:m,childCourseIds:p,onChildCourseIdsChanged:h,onClearAllFilters:g}=e,f=Ba(),v=Object(i.useCallback)((e=>s(Fa(r,e))),[s,r]),y=r.map(((e,n)=>i.createElement(Da,{analyticsId:`${a}.courseMember.chip.${n}`,courseId:t,membershipId:e,onDelete:v,key:e,className:f.chip}))),S=Object(i.useCallback)((e=>l(Fa(o,e))),[l,o]),C=o.map(((e,n)=>i.createElement(La,{analyticsId:`${a}.group.chip.${n}`,courseId:t,groupId:e,onDelete:S,key:e,className:f.chip}))),E=Object(i.useCallback)((e=>{d(Fa(c,e))}),[c,d]),I=c.map(((e,n)=>i.createElement(ja,{key:e,columnId:e,courseId:t,analyticsId:`${a}.gradeColumn.chip.${n}`,onDelete:E,className:f.chip}))),k=Object(i.useCallback)((e=>{m(Fa(u,e))}),[u,m]),w=u.map(((e,n)=>i.createElement(Ma,{key:n,analyticsId:`${a}.gradeColumn.chip.${n}`,onDelete:k,courseId:t,categoryId:e,className:f.chip}))),T=Object(i.useCallback)((e=>{h(Fa(p,e))}),[p,Fa]),O=p.map(((e,n)=>i.createElement(Ga,{key:n,analyticsId:`${a}.gradeColumn.chip.${n}`,onDelete:T,parentCourseId:t,childCourseId:e,className:f.chip}))),A=n.translate("gradebook.filterChips.filtersApplied"),P=n.translate("gradebook.filterChips.clearAll");return i.createElement("div",{className:f.filterChips},i.createElement("span",{className:f.filtersApplied},A),y,C,I,w,O,i.createElement(b.AnalyticsLink,{className:f.clearFilters,variant:"button",analyticsId:`${a}.clearAllFilters`,onClick:g,tabIndex:0,"aria-label":P,href:"#"},P))})),_a=e=>{var t,n,a,r,o;const l=Object(s.e)((e=>{var t;return null===(t=M.Yb.app.getRoute(e).params)||void 0===t?void 0:t.courseId})),c=Object(s.e)((e=>M.Yb.app.getLocation(e).queryParams)),d=[null==c?void 0:c.gradebookView,null==c?void 0:c.memberId,null==c?void 0:c.courseGroupId,null==c?void 0:c.gradebookColumnId,null==c?void 0:c.gradebookCategoryId,null==c?void 0:c.childCourseId],u=(null===(t=null==c?void 0:c.memberId)||void 0===t?void 0:t.split(","))||[],m=(null===(n=null==c?void 0:c.courseGroupId)||void 0===n?void 0:n.split(","))||[],p=(null===(a=null==c?void 0:c.gradebookColumnId)||void 0===a?void 0:a.split(","))||[],h=(null===(r=null==c?void 0:c.gradebookCategoryId)||void 0===r?void 0:r.split(","))||[],g=(null===(o=null==c?void 0:c.childCourseId)||void 0===o?void 0:o.split(","))||[];xn(l);const b=Object(i.useCallback)((e=>{const t={...c,memberId:e.length>0?e.join(","):void 0};rt.Z.search(t)}),d),f=Object(i.useCallback)((e=>{const t={...c,courseGroupId:e.length>0?e.join(","):void 0};rt.Z.search(t)}),d),v=Object(i.useCallback)((e=>{const t={...c,gradebookColumnId:e.length>0?e.join(","):void 0};rt.Z.search(t)}),d),y=Object(i.useCallback)((e=>{const t={...c,gradebookCategoryId:e.length>0?e.join(","):void 0};rt.Z.search(t)}),d),S=Object(i.useCallback)((e=>{const t={...c,childCourseId:e.length>0?e.join(","):void 0};rt.Z.search(t)}),d),C=Object(i.useCallback)((()=>{const e={...c,memberId:void 0,courseGroupId:void 0,gradebookColumnId:void 0,gradebookCategoryId:void 0,childCourseId:void 0};rt.Z.search(e)}),d);return i.createElement(Ua,{courseId:l,membershipIds:u,groupIds:m,gradeColumnIds:p,gradeCategoryIds:h,childCourseIds:g,analyticsId:e.analyticsId,onMembershipIdsChanged:b,onGroupIdsChanged:f,onGradeColumnIdsChanged:v,onGradeCategoryIdsChanged:y,onChildCourseIdsChanged:S,onClearAllFilters:C})};var za;!function(e){e.AllGrading="course.gradebook-grades.EXECUTE",e.DeanonymizeGrades="course.gradebook-deanonymize.EXECUTE",e.EnterFeedback="course.gradebook-grades.feedback.EXECUTE",e.EnterItemGrades="course.gradebook-grades.attempt.EXECUTE",e.ExportGradebookData="course.gradebook-data.export.EXECUTE",e.FullGradebookAccess="course.gradebook.MODIFY",e.ModifyGradebook="course.gradebook.MODIFY",e.ModifyItemDueDate="course.gradebook-item.duedate.MODIFY",e.Observe="observer.gradebook.VIEW",e.OverrideItemGrades="course.gradebook-grades.override.EXECUTE",e.ProvideGradingFeedback="course.gradebook-grades.feedback.EXECUTE",e.PublishGrades="course.gradebook-grades.publish.EXECUTE",e.ViewAttempts="course.gradebook.attempts.VIEW",e.ViewGradebook="course.gradebook.VIEW",e.ViewGradebookMetaData="course.gradebook-metadata.VIEW",e.OverrideGrade="course.gradebook-grades.override.EXECUTE",e.ViewGrades="course.gradebook-grades.VIEW",e.ViewUserGrades="course.user.grades.VIEW"}(za||(za={}));var qa=n("UE5/"),Ha=n("jZnR");const Va=Object(qa.a)((e=>Object(Ha.a)({categoryRuleHeader:{display:"block",fontSize:e.typography.fontSizeLarge,fontWeight:e.typography.fontWeightSemiBold,marginBottom:"16px"},categoryRuleDescription:{display:"block",fontSize:e.typography.fontSizeSmall,marginTop:"8px"},dropLabel:{display:"flex",alignItems:"center",marginLeft:"20px",flexWrap:"wrap",marginTop:"15px",fontWeight:e.typography.fontWeightRegular},dropScoreInformation:{color:e.palette.text.hint,fontSize:e.typography.fontSizeSmall,fontStyle:"italic",marginLeft:"20px"},dropScoresErrorMessage:{fontSize:e.typography.fontSizeSmall,color:e.palette.error.main},minOrMaxRadio:{display:"block",marginLeft:"20px"},numberInput:{width:"50px",margin:"0 10px"},radio:{marginTop:"16px",display:"block"},radioDescription:{marginLeft:"20px",fontSize:e.typography.fontSizeSmall,marginBottom:"6px"},radioLabel:{fontWeight:e.typography.fontWeightSemiBold},tooManyItemsDroppedErrorMessage:{color:e.palette.error.main,fontSize:e.typography.fontSizeSmall,marginLeft:"20px"}})));var Wa,Ka=n("9EWH");!function(e){e.DropScores="DROP_SCORES",e.GradeCalculationUseOnlyOption="USE_ONLY"}(Wa||(Wa={}));const Ya=(e,t)=>{var n,a,i;let r=(null==e?void 0:e.dropLow)||(null==e?void 0:e.dropHigh)?Wa.DropScores:null;null===r&&(r=(null==e?void 0:e.useOnly)?Wa.GradeCalculationUseOnlyOption:null);const s={dropLow:null!==(n=null==e?void 0:e.dropLow)&&void 0!==n?n:0,dropHigh:null!==(a=null==e?void 0:e.dropHigh)&&void 0!==a?a:0,useOnly:null!==(i=null==e?void 0:e.useOnly)&&void 0!==i?i:null};return{enabled:!!r,selectedRuleType:r,rules:{...s},numGradableItems:null!=t?t:0,initialState:{enabled:!!r,selectedRuleType:r,rules:{...s}}}},Ja="TOGGLE_ENABLED",Za="SELECT_RULE",Qa="SET_DROP_LOW",Xa="SET_DROP_HIGH",ei="SET_USE_ONLY",ti="INITIALIZE_STATE",ni="ROLLBACK_INITIAL_STATE",ai={dropHigh:0,dropLow:0,useOnly:null},ii=(e,t)=>{if(t.type===Ja)return Object(Ka.b)(e,(t=>{t.enabled=!e.enabled,t.selectedRuleType=null,t.rules=ai}));if(t.type===Za)return Object(Ka.b)(e,(e=>{e.selectedRuleType=t.payload.ruleType,e.rules=ai}));if(t.type===Qa)return Object(Ka.b)(e,(e=>{e.rules.dropLow=t.payload.dropLow}));if(t.type===Xa)return Object(Ka.b)(e,(e=>{e.rules.dropHigh=t.payload.dropHigh}));if(t.type===ei)return Object(Ka.b)(e,(e=>{e.rules.useOnly=t.payload.useOnly}));if(t.type===ti)return Ya(t.payload.rules,t.payload.numGradableItems);if(t.type===ni){const t=e.initialState;return Object(Ka.b)(e,(e=>{e.enabled=t.enabled,e.rules=t.rules,e.selectedRuleType=t.selectedRuleType}))}return e},ri=i.createContext({calculationRule:Ya(void 0,0),dispatch:e=>{}}),si=()=>i.useContext(ri),oi=({calculationRule:e,numGradableItems:t,children:n})=>{const[a,r]=i.useReducer(ii,Ya(e,t));return i.useEffect((()=>{r(pi(e,t))}),[e,t]),i.createElement(ri.Provider,{value:{calculationRule:a,dispatch:r}},n)},li=e=>!e.enabled||(e.selectedRuleType===Wa.DropScores?(e=>{var t,n;if(null===e.rules.dropLow||null===e.rules.dropHigh)return!1;const a=null!==(t=e.rules.dropHigh)&&void 0!==t?t:0,i=null!==(n=e.rules.dropLow)&&void 0!==n?n:0;return!(!Number.isInteger(a)||!Number.isInteger(i)||a<0||i<0||0===i&&0===a)})(e):e.selectedRuleType===Wa.GradeCalculationUseOnlyOption&&!!e.rules.useOnly),ci=e=>{var t,n;return(null!==(t=e.rules.dropHigh)&&void 0!==t?t:0)+(null!==(n=e.rules.dropLow)&&void 0!==n?n:0)+1},di=()=>e=>null!=e&&!!Number.isInteger(e),ui=e=>{const t=e.initialState;return e.enabled!==t.enabled||(e.selectedRuleType!==t.selectedRuleType||(e.rules.dropHigh!==t.rules.dropHigh||(e.rules.dropLow!==t.rules.dropLow||e.rules.useOnly!==t.rules.useOnly)))},mi=e=>({type:Za,payload:{ruleType:e}}),pi=(e,t)=>({type:ti,payload:{rules:e,numGradableItems:t}}),hi=()=>({type:ni}),gi=Object(d.a)((({localize:e})=>{var t,n;const a=Va(),{calculationRule:r,dispatch:s}=si(),o=i.useCallback((()=>r.selectedRuleType===Wa.DropScores),[r]),l=o()&&i.createElement(ft.F,{ariaDescribedBy:"drop-scores-message",ariaLabel:e.translate("gradebook.overallGradeCalculationPanel.dropLowestScores"),analyticsId:"features.course.grades.overall-grade.calculation-rule-panel.dropLow.number.input",className:Object(V.a)(a.numberInput,"js-drop-low-scores-input"),min:0,onChange:e=>s({type:Qa,payload:{dropLow:e}}),value:null!==(t=r.rules.dropLow)&&void 0!==t?t:null,validate:di(),required:!1,hideErrorMessage:!0}),c=o()&&i.createElement(ft.F,{ariaDescribedBy:"drop-scores-message",ariaLabel:e.translate("gradebook.overallGradeCalculationPanel.dropHighestScores"),analyticsId:"features.course.grades.overall-grade.calculation-rule-panel.dropHigh.number.input",className:Object(V.a)(a.numberInput,"js-drop-high-scores-input"),min:0,onChange:e=>s({type:Xa,payload:{dropHigh:e}}),value:null!==(n=r.rules.dropHigh)&&void 0!==n?n:null,validate:di(),required:!1,hideErrorMessage:!0});return i.createElement(i.Fragment,null,i.createElement(b.AnalyticsFormControlLabel,{analyticsId:"features.course.grades.overall-grade.calculation-rule-panel.dropScores.radio.label",checked:o(),className:Object(V.a)(a.radio,"js-drop-scores-radio"),control:i.createElement(b.AnalyticsRadio,{analyticsId:"features.course.grades.overall-grade.calculation-rule-panel.dropScores.radio",id:Wa.DropScores}),disabled:!r.enabled,htmlFor:Wa.DropScores,label:i.createElement("span",{className:a.radioLabel},e.translate("gradebook.overallGradeCalculationPanel.dropScoresTitle")),onChange:e=>s(mi(e.target.value)),value:Wa.DropScores}),i.createElement("p",{className:a.radioDescription},e.translate("gradebook.overallGradeCalculationPanel.dropScoresDescription")),o()&&i.createElement(i.Fragment,null,(!!(d=r).rules.dropLow&&d.rules.dropLow>0||!!d.rules.dropHigh&&d.rules.dropHigh>0)&&r.numGradableItems<ci(r)&&i.createElement("p",{className:Object(V.a)(a.tooManyItemsDroppedErrorMessage,"js-too-many-items-message"),id:"drop-scores-message"},e.translate("gradebook.overallGradeCalculationPanel.tooManyItemsDroppedWarning",{minGradableItems:ci(r)})),i.createElement(b.AnalyticsInputLabel,{className:a.dropLabel,analyticsId:"features.course.grades.overall-grade.calculation-rule-panel.dropLow.number.input.label"},e.translate("gradebook.overallGradeCalculationPanel.dropLowestScores",{numberInput_LOCALIZED:l})),i.createElement(b.AnalyticsInputLabel,{className:a.dropLabel,analyticsId:"features.course.grades.overall-grade.calculation-rule-panel.dropHigh.number.input.label","aria-describedby":"drop-scores-message"},e.translate("gradebook.overallGradeCalculationPanel.dropHighestScores",{numberInput_LOCALIZED:c}))));var d}));class bi{constructor(e){this.exclude_alias=e}}class fi{constructor(){this.type="item",this.alias=""}}var vi,yi;!function(e){e.UseMinScore="min",e.UseMaxScore="max"}(vi||(vi={})),function(e){e.UseLowestScore="LOWEST",e.UseHighestScore="HIGHEST",e.Default="DEFAULT"}(yi||(yi={}));class Si{constructor(){this.element=new fi,this.weight=0}}const Ci=(e=[],{average:t=!1}={})=>({average:t,elements:e});class Ei{constructor(e=[],{running:t=!0}={}){this.weights=e,this.running=t}static is(e){return!!e&&(e instanceof Ei||"weights"in e)}}class Ii{constructor(e=Ci(),{running:t=!0}={}){this.selected=e,this.running=t}static is(e){return!!e&&(e instanceof Ii||"selected"in e)}}class ki{constructor({aliases:e,formula:t},n){var a,i;this.aliases=e,this.formula=t;const r=[];for(let e=0;e<=n.length;e++){const t=n.item(e);if(t)switch(t.nodeName){case"ci":case"mi":{const[,e]=null!==(i=/^@X@BBCalColElem\([^:]+:(.*)\)@X@$/.exec(null!==(a=t.textContent)&&void 0!==a?a:""))&&void 0!==i?i:[];try{const t=JSON.parse(e);"running"in t&&r.push(t.running)}catch(t){console.warn("Invalid non-JSON function body",e)}break}}}this.running=0===r.length||r.some((e=>!1!==e))}static is(e){return!!e&&(e instanceof ki||"formula"in e)}}function wi(e,t){return Ei.is(e)?t.weighted(e):Ii.is(e)?t.sumSelected(e):t.advanced(e)}const Ti=Object(d.a)((({localize:e})=>{const t=Va(),{calculationRule:n,dispatch:a}=si(),r=e=>{var t;a((t=e.target.value,{type:ei,payload:{useOnly:t}}))};return i.createElement("div",null,i.createElement(b.AnalyticsFormControlLabel,{analyticsId:"features.course.grades.overall-grade.calculation-rule-panel.useOnly.radio.label",checked:n.selectedRuleType===Wa.GradeCalculationUseOnlyOption,className:Object(V.a)(t.radio,"js-overall-grade-use-only-radio"),control:i.createElement(b.AnalyticsRadio,{analyticsId:"features.course.grades.overall-grade.calculation-rule-panel.useOnly.radio",id:Wa.GradeCalculationUseOnlyOption}),disabled:!n.enabled,htmlFor:Wa.GradeCalculationUseOnlyOption,label:i.createElement("span",{className:t.radioLabel},e.translate("gradebook.overallGradeCalculationPanel.useOnlyTitle")),onChange:e=>a(mi(e.target.value)),value:Wa.GradeCalculationUseOnlyOption}),i.createElement("p",{className:t.radioDescription},e.translate("gradebook.overallGradeCalculationPanel.useOnlyDescription")),n.selectedRuleType===Wa.GradeCalculationUseOnlyOption&&i.createElement(i.Fragment,null,i.createElement(b.AnalyticsFormControlLabel,{analyticsId:"features.course.grades.overall-grade.calculation-rule-panel.min.radio.label",checked:n.rules.useOnly===vi.UseMinScore,className:Object(V.a)(t.minOrMaxRadio,"js-use-only-lowest-grade"),control:i.createElement(b.AnalyticsRadio,{analyticsId:"features.course.grades.overall-grade.calculation-rule-panel.min.radio",id:vi.UseMinScore}),htmlFor:vi.UseMinScore,label:e.translate("gradebook.overallGradeCalculationPanel.useOnlyLowest"),onChange:r,value:vi.UseMinScore}),i.createElement(b.AnalyticsFormControlLabel,{analyticsId:"features.course.grades.overall-grade.calculation-rule-panel.max.radio.label",checked:n.rules.useOnly===vi.UseMaxScore,className:Object(V.a)(t.minOrMaxRadio,"js-use-only-highest-grade"),control:i.createElement(b.AnalyticsRadio,{analyticsId:"features.course.grades.overall-grade.calculation-rule-panel.max.radio",id:vi.UseMaxScore}),htmlFor:vi.UseMaxScore,label:e.translate("gradebook.overallGradeCalculationPanel.useOnlyHighest"),onChange:r,value:vi.UseMaxScore})))})),Oi=Object(d.a)((({localize:e})=>{const t=Va(),{calculationRule:n,dispatch:a}=si();return i.createElement("div",null,i.createElement("span",{className:t.categoryRuleHeader},e.translate("gradebook.overallGradeCalculationPanel.categoryCalculationRuleTitle")),i.createElement(b.AnalyticsFormControlLabel,{analyticsId:"features.course.grades.overall-grade.calculation-rule-panel.enable.switch.label",checked:!!n.enabled,className:"js-enable-calculation-rule",control:i.createElement(b.AnalyticsSwitch,{analyticsId:"features.course.grades.overall-grade.calculation-rule-panel.enable.switch",id:"enable"}),htmlFor:"enable",label:e.translate("gradebook.overallGradeCalculationPanel.enableCalculationRule"),onChange:()=>a({type:Ja})}),i.createElement("span",{className:t.categoryRuleDescription},e.translate("gradebook.overallGradeCalculationPanel.categoryCalculationRuleDescription")),i.createElement("span",{className:t.categoryRuleDescription},e.translate("gradebook.overallGradeCalculationPanel.categoryCalculationRuleDescriptionXPlus1Rule")),i.createElement(gi,null),i.createElement(Ti,null))})),Ai=Object(qa.a)((e=>Object(Ha.a)({ruleButton:{fontSize:"12px",minHeight:"unset"},ruleText:{flexShrink:0},warning:{color:e.palette.error.main,"&:hover, &:focus, &:active":{color:e.palette.error.main}}}))),Pi=e=>{var t,n;if(!e)return!1;const a=null!==(t=e.dropLow)&&void 0!==t?t:0,i=null!==(n=e.dropHigh)&&void 0!==n?n:0;return a>0||i>0||!!e.useOnly},xi=(e,t)=>{var n,a;if(!Pi(t))return!1;const i=null!==(n=t.dropLow)&&void 0!==n?n:0,r=null!==(a=t.dropHigh)&&void 0!==a?a:0;return i>0||r>0?i+r>=e:!t.useOnly},$i=Object(d.a)((({ButtonProps:e,calculationRule:t,numGradableItemsInCategory:n,localize:a})=>{const r=Ai(),s=((e,t)=>xi(e,t)?I.AlertError:Pi(t)?I.Edit:I.Add)(n,t),o=((e,t)=>{var n,a;if((null==e?void 0:e.dropLow)||(null==e?void 0:e.dropHigh)){const i=Number(null!==(n=e.dropLow)&&void 0!==n?n:0)+Number(null!==(a=e.dropHigh)&&void 0!==a?a:0);return t.translate("course.grades.overallGrade.editDropScores.plural",{numOfDrops:i})}let i="";return i=(null==e?void 0:e.useOnly)?e.useOnly===vi.UseMaxScore?"course.grades.overallGrade.useOnlyHighest":"course.grades.overallGrade.useOnlyLowest":"course.grades.overallGrade.editCalculationRules",t.translate(i)})(t,a),l=xi(n,t);return i.createElement(b.AnalyticsIconButton,{...e,className:Object(V.a)(r.ruleButton,{[r.warning]:l},null==e?void 0:e.className),analyticsId:"course.grades.overallGrade.editCalculationRule"},i.createElement(s,null),i.createElement(b.AnalyticsTypography,{className:r.ruleText,component:"span",variant:"inherit"},o))}));function Ni(e){if(!e.formula||""===e.formula)return null;const t=(new DOMParser).parseFromString(e.formula,"text/xml").children[0];if("math"!==t.nodeName)return null;const n=t.childNodes;if(0===n.length)return null;if(n.length>1||-1===["ci","mi"].indexOf(n[0].nodeName))return new ki(e,n);const a=n[0];switch(a.nodeName){case"ci":case"mi":{if(null===a.textContent)return null;const t=/^@X@BBCalColElem\(([^:]+):(.*)\)@X@$/.exec(a.textContent);if(null===t)return null;const[,i,r]=t;try{const t=JSON.parse(r);if("sum"===i){return t.selected.elements.some((e=>"equal"===e.mode))?new ki(e,n):new Ii(t.selected,{running:t.running})}return"wgt"===i?new Ei(t.weights,{running:t.running}):new ki(e,n)}catch(e){return console.error(e),null}}}return null}function Di(e,t,n=Object.keys(t.reduce(((e,t)=>t.gradebookCategoryId?{...e,[t.gradebookCategoryId]:null}:e),{}))){var a;const i=null!==(a=null==e?void 0:e.aliases)&&void 0!==a?a:{},r=e?Ni(e):null,s=r?wi(r,{weighted:e=>e.weights.map((e=>e.element)),sumSelected:e=>e.selected.elements,advanced:()=>[]}):[],o=s.reduce(((e,t)=>"cat"===t.type?{...e,[i[t.alias]]:t}:e),{}),l=s.reduce(((e,t)=>"item"===t.type?{...e,[i[t.alias]]:t}:e),{}),c=Ei.is(r)?r.weights.reduce(((e,t)=>({...e,[t.element.alias]:t.weight})),{}):{},d=t.filter((e=>!l[e.id])),u=(e,t,{isExempted:n}={})=>{var a,i,r;const s=e.id;if(!s)return null;const o=null!==(i=null===(a=null==t?void 0:t.exclude_list)||void 0===a?void 0:a.map((e=>e.exclude_alias)))&&void 0!==i?i:[];return{column:e,el:t,id:s,isCalculation:e.calculationType!==j.p.NonCalculated,isUncategorizedItem:void 0===e.gradebookCategoryId,isCategory:!1,isExempted:null!=n?n:!!t&&!!o.includes(t.alias),weight:t&&null!==(r=c[t.alias])&&void 0!==r?r:0}},m=n.map((e=>e?((e,t)=>{var n,a,s,o,l,m;const p=null!==(a=null===(n=null==t?void 0:t.exclude_list)||void 0===n?void 0:n.map((e=>e.exclude_alias)))&&void 0!==a?a:[],h=p.filter((e=>e!==(null==t?void 0:t.alias))).map((e=>i[e]));return{calculationRule:{dropLow:Number(null!==(s=null==t?void 0:t.drop_low)&&void 0!==s?s:0),dropHigh:Number(null!==(o=null==t?void 0:t.drop_high)&&void 0!==o?o:0),useOnly:null!==(l=null==t?void 0:t.maxmin)&&void 0!==l?l:null},el:t,id:e,isCalculation:!1,isCategory:!0,isUncategorizedItem:!1,isExempted:t&&!!p.includes(t.alias)||Ii.is(r)&&void 0===t,weight:t&&null!==(m=c[t.alias])&&void 0!==m?m:0,childGradeItems:d.filter((t=>t.gradebookCategoryId===e)).map((e=>u(e,void 0,{isExempted:!!h.find((t=>t===e.id))}))).filter((e=>null!==e))}})(e,o[e]):null)),p=Object.values(l).map((e=>({el:e,column:t.find((t=>t.id===i[e.alias]))}))).map((({column:e,el:t})=>void 0!==e?u(e,t):null)),h=t.filter((e=>e.calculationType!==j.p.NonCalculated&&!e.externalGrade&&!l[e.id])).map((e=>u(e))),g=t.filter((e=>!e.gradebookCategoryId&&e.calculationType===j.p.NonCalculated&&!e.externalGrade&&!l[e.id])).map((e=>u(e)));return{items:m.concat(p).concat(h).concat(g).filter((e=>!!e)),formula:r}}function Li(e,t,n){return{formula:`<math xmlns="http://www.w3.org/1998/Math/MathML"><mi>@X@BBCalColElem(${e}:${JSON.stringify(t)})@X@</mi></math>`,aliases:n}}function ji(e){const t=e.id.split("_")[1];return e.isCategory?`c_${t}`:`i_${t}`}function Mi(e){return e.reduce((({aliases:t,elements:n},a)=>{var i,r,s,o,l;const c=new fi;if(c.alias=ji(a),c.exclude_list=[],t[c.alias]=a.id,a.isExempted&&(null===(i=c.exclude_list)||void 0===i||i.push(new bi(c.alias))),a.isCategory){c.type="cat";const n=a.calculationRule;if(n&&((null!==(r=n.dropLow)&&void 0!==r?r:0)>0&&(c.drop_low=String(null==n?void 0:n.dropLow)),(null!==(s=n.dropHigh)&&void 0!==s?s:0)>0&&(c.drop_high=String(null==n?void 0:n.dropHigh)),n.useOnly&&(c.maxmin=n.useOnly)),!a.isExempted){const n=e.filter((e=>!e.isCategory)).filter((e=>{var t;return(null===(t=e.column)||void 0===t?void 0:t.gradebookCategoryId)===a.id}));(null!==(o=a.childGradeItems)&&void 0!==o?o:[]).filter((e=>e.isExempted)).concat(n).forEach((e=>{var n;const a=ji(e);t[a]=e.id,null===(n=c.exclude_list)||void 0===n||n.push(new bi(a))}))}}else c.type="item";return(null===(l=c.exclude_list)||void 0===l?void 0:l.length)||(c.exclude_list=void 0),{aliases:t,elements:[...n,c]}}),{aliases:{},elements:[]})}function Gi(e,t){const n=new Ei;n.running=t;const{aliases:a,elements:i}=Mi(e),r=e.reduce(((e,t)=>({...e,[ji(t)]:t.isExempted?0:t.weight})),{});return n.weights=i.map((e=>{const t=new Si;return t.element=e,t.weight=r[e.alias],t})),Li("wgt",n,a)}function Ri(e,t){const{aliases:n,elements:a}=Mi(e),i=Ci(a);return Li("sum",new Ii(i,{running:t}),n)}const Bi=Object(Z.makeStyles)((e=>Object(Z.createStyles)({usersGroups:{textOverflow:"ellipsis",overflow:"hidden"},groupTitle:{whiteSpace:"nowrap",fontWeight:e.typography.fontWeightMedium,color:e.palette.text.secondary}}))),Fi=e=>{const{userId:t,filteredGroupIds:n=[],localize:a}=e,r=Bi(),o=Object(s.e)((e=>n.map((t=>M.Yb.group.getGroupByGroupId(e,t))).filter((e=>{var n;return null===(n=null==e?void 0:e.memberships)||void 0===n?void 0:n.some((e=>e.userId===t))})))),l=a.formatItems(o.map((e=>e.title)));return i.createElement("div",{className:r.usersGroups},i.createElement(Yt.Tooltip,{title:l,placement:"top"},i.createElement("span",{className:r.groupTitle}," ",l," ")))},Ui=Object(d.a)((e=>{var t,n;const a=Object(s.e)((e=>M.Yb.app.getLocation(e).queryParams)),r=null!==(n=null===(t=null==a?void 0:a.courseGroupId)||void 0===t?void 0:t.split(","))&&void 0!==n?n:[];return i.createElement(Fi,{filteredGroupIds:r,...e})})),_i=[{field:j.gb.IsPreviewStudent,direction:j.Wb.Ascending},{field:j.gb.FamilyName,direction:j.Wb.Ascending},{field:j.gb.GivenName,direction:j.Wb.Ascending}],zi={roleBucket:[j.y.Taking]};var qi=n("dCsl"),Hi=n("IPrp"),Vi=n("4p3y"),Wi=n("WaTp"),Ki=n("GAfu"),Yi=n("+Koh"),Ji=n("U7v+"),Zi=n("hipI"),Qi=n("sY4P");const Xi=Object(Z.makeStyles)((e=>Object(Z.createStyles)({actionContainer:{alignItems:"center",display:"flex",flex:0,"&::before":{backgroundColor:e.palette.border.main,content:'" "',height:"50%",left:0,position:"absolute",width:"2px"}},contentContainer:{alignItems:"flex-start",display:"flex",flexDirection:"column",flex:1,justifyContent:"center","& h4":{display:"-webkit-box",overflow:"hidden",textOverflow:"ellipsis",wordBreak:"break-word",WebkitBoxOrient:"vertical",WebkitLineClamp:2}},controlsContainer:{alignItems:"center",display:"flex",flex:0},iconContainer:{alignItems:"center",display:"flex",flex:0,justifyContent:"center"},itemContainer:{alignItems:"stretch",borderColor:e.palette.border.main,borderStyle:"solid",borderWidth:0,display:"flex",flexDirection:"row",padding:e.spacing(.5),"& > div":{position:"relative"}},rootContainer:{backgroundColor:e.palette.background.default,borderColor:e.palette.border.main,borderWidth:"1px"}}))),er=({Action:e,ActionProps:t,ContainerProps:n,Content:a,ContentProps:r,Controls:s,Icon:o,RootProps:l,children:c,testId:d})=>{const u=Xi();return i.createElement(Z.Box,{"data-testid":d,...l,className:Object(V.a)(u.rootContainer,null==l?void 0:l.className)},i.createElement(Z.Box,{...n,className:Object(V.a)(u.itemContainer,null==n?void 0:n.className)},void 0!==o?i.createElement(Z.Box,{className:u.iconContainer},o):void 0,i.createElement(Z.Box,{...r,className:Object(V.a)(u.contentContainer,null==r?void 0:r.className)},a),i.createElement(Z.Box,{className:u.controlsContainer},s),void 0!==e?i.createElement(Z.Box,{...t,className:Object(V.a)(u.actionContainer,null==t?void 0:t.className)},e):void 0),c)};var tr=n("WkyU");const nr=Object(Z.makeStyles)((e=>Object(Z.createStyles)({input:{"& > div":{paddingRight:({unitHint:e=""})=>""!==e?"10px":void 0}},root:{display:"inline-block",position:"relative",width:"4.5rem"},unitHint:{alignItems:"center",bottom:0,display:"flex",justifyContent:"center",position:"absolute",right:0,top:0,textAlign:"center",width:"1.5rem"},weightNotApplicable:{textAlign:"center",color:e.palette.text.disabled}}))),ar=({alias:e,analyticsId:t="course.grades.overallGrade.weight.input.text",disabled:n=!1,isNotApplicable:a=!1,onBlur:r,onFocus:s,unitHint:o="",value:l,...c})=>{const d=nr({unitHint:o}),u=Object(Bn.a)(),m=`overall-grade-weight-validation-${e}`,[p,h]=i.useState(l),[g,b]=i.useState(!1),[f,v]=i.useState(""),y=i.useCallback(((e,t)=>{null==r||r(t,p)}),[r,p]),S=i.useCallback(((...e)=>{h(l),null==s||s(...e)}),[s,l]);return i.useEffect((()=>{n&&(b(!0),v(""))}),[n]),i.createElement(Z.Box,{className:d.root},a?i.createElement(Z.Typography,{className:d.weightNotApplicable,variant:"body1"},u("course.grades.overallGrade.NA")):i.createElement(i.Fragment,null,i.createElement(tr.a,{id:m,open:""!==f,placement:"top",title:f},i.createElement(ft.s,{analyticsId:t,ariaDescribedBy:""!==f?m:void 0,disabled:n,className:d.input,error:!g,helperText:void 0,hideErrorMessage:!0,onChangeValidState:(e,t)=>{b(e),v(e?"":t.trim())},max:100,min:0,onBlurNative:y,onFocus:S,value:l,...c})),""!==o?i.createElement(Z.Box,{"aria-hidden":!0,className:d.unitHint},i.createElement(Z.Typography,null,o)):void 0))};var ir=n("USWt");const rr=Object(Z.makeStyles)((e=>Object(Z.createStyles)({actionPropsUnavailable:{visibility:"hidden"},contentEditCalculationRuleButton:{paddingBottom:e.spacing(.5),paddingRight:e.spacing(1),paddingTop:e.spacing(.5)},controlButton:{padding:e.spacing(1)},controlButtonUnavailable:{visibility:"hidden"},controlButtonLockedActive:{color:e.palette.brand.main},icon:{visibility:"hidden"},itemContainer:{backgroundColor:({isExempted:t})=>t?e.palette.background.b2:"initial","& > div":{padding:e.spacing(1)}},itemRoot:{background:"none",borderBottomStyle:"solid","&:last-child":{borderBottomStyle:"none"}},pointsPossibleContainer:{color:e.palette.text.hint,margin:"0 10px",textAlign:"right",width:"80px"}})));function sr({alias:e,categoryName:t,icon:n,isExempted:a,isReadOnly:r,onClickExempt:s,onClickLink:o,pointsPossible:l,subTitle:c,title:d,valueType:u}){const m=`child-item-${e}-overflow-menu`,p=Object(Z.useTheme)(),h=Object(Z.useMediaQuery)(p.breakpoints.down("sm")),g=rr({isExempted:a}),{translate:f,formatNumber:v}=Object(he.a)(),y="points"===u,S=!s,C=i.useMemo((()=>Object(Ot.m)(n)),[n]),[E,I]=i.useState(null),k=i.useCallback((e=>{e.stopPropagation(),I(e.currentTarget)}),[]);return i.createElement(er,{RootProps:{className:g.itemRoot},ContainerProps:{className:g.itemContainer},Icon:i.createElement(C,{className:g.icon}),Content:i.createElement(i.Fragment,null,i.createElement(jn.a,{component:"div",variant:"h4"},f(d)),void 0!==c?i.createElement(jn.a,{variant:"body2"},f(c)):void 0),Controls:i.createElement(i.Fragment,null,y?i.createElement(Z.Box,{"data-test-id":"points-possible",className:g.pointsPossibleContainer},v(l,{maximumFractionDigits:2})):void 0,h&&y&&!r?void 0:i.createElement(b.AnalyticsIconButton,{analyticsId:"course.grades.overallGrade.toggleExempt.button","aria-label":f(a?"course.grades.overallGrade.unexemptItem":"course.grades.overallGrade.exemptItem",{title:d}),"aria-pressed":a,className:Object(V.a)(g.controlButton,{[g.controlButtonUnavailable]:S}),disabled:r||S,onClick:s},i.createElement(Wi.a,{className:a?g.controlButtonLockedActive:void 0})),r||!h||y?void 0:i.createElement(b.AnalyticsIconButton,{analyticsId:"course.grades.overallGrade.unlink.button","aria-label":f("course.grades.overallGrade.unlinkFromCategoryName",{title:t}),onClick:o},i.createElement(ir.a,null)),!r&&y&&h?i.createElement(i.Fragment,null,i.createElement(b.AnalyticsIconButton,{analyticsId:"course.grades.overallGrade.toggleItemMobileOverflowMenu.toggle","aria-controls":E?m:void 0,"aria-expanded":null!==E,"aria-haspopup":"menu",className:Object(V.a)(g.controlButton),onClick:k},i.createElement(Yi.Menu,null)),i.createElement(b.AnalyticsMenu,{analyticsId:"course.grades.overallGrade.toggleItemMobileOverflowMenu.menu",anchorEl:E,id:m,onClose:e=>{var t;null===(t=e.stopPropagation)||void 0===t||t.call(e),I(null)},open:null!==E,MenuListProps:{"aria-label":f("course.grades.overallGrade.overflowActions")}},S?void 0:i.createElement(b.AnalyticsMenuItem,{"data-analytics-id":"course.grades.overallGrade.toggleExempt.button",analyticsId:"course.grades.overallGrade.toggleExempt.button",button:!0,"aria-label":f(a?"course.grades.overallGrade.unexemptCategory":"course.grades.overallGrade.exemptCategory",{title:d}),"aria-pressed":a,onClick:s},i.createElement(Z.ListItemIcon,null,i.createElement(Wi.a,{className:a?g.controlButtonLockedActive:void 0})),i.createElement(Z.ListItemText,null,i.createElement(jn.a,null,f("course.grades.overallGrade.exempt")))),i.createElement(b.AnalyticsMenuItem,{"data-analytics-id":"course.grades.overallGrade.unlink.button",analyticsId:"course.grades.overallGrade.unlink.button","aria-label":f("course.grades.overallGrade.unlinkFromCategoryName",{title:t}),button:!0,onClick:o},i.createElement(Z.ListItemIcon,null,i.createElement(ir.a,null)),i.createElement(Z.ListItemText,null,i.createElement(jn.a,null,f("course.grades.overallGrade.unlinkFromCategory")))))):void 0),Action:h?void 0:i.createElement(b.AnalyticsIconButton,{analyticsId:"course.grades.overallGrade.unlink.button","aria-label":f("course.grades.overallGrade.unlinkFromCategoryName",{title:t}),className:r?g.controlButtonUnavailable:void 0,disabled:r,onClick:o},i.createElement(ir.a,null)),ActionProps:{className:r?g.actionPropsUnavailable:void 0},testId:d})}const or=Object(Z.makeStyles)((e=>Object(Z.createStyles)({contentEditCalculationRuleButton:{paddingBottom:e.spacing(.5),paddingRight:e.spacing(1),paddingTop:e.spacing(.5)},contentSubTextContainer:{display:"flex",flexDirection:"row","& > *":{paddingLeft:e.spacing(1),paddingRight:e.spacing(1),position:"relative"},"& > *:not(:first-child):before":{borderLeft:`solid 1px ${e.palette.border.dark}`,content:'""',display:"inline-block",height:"18px",left:0,position:"absolute"},"& > *:first-child":{paddingLeft:0}},contentSubTextItems:{color:e.palette.text.hint},controlButton:{padding:e.spacing(1)},controlButtonUnavailable:{visibility:"hidden"},controlButtonLockedActive:{color:e.palette.brand.main},itemContainer:{backgroundColor:({isExempted:t})=>t?e.palette.background.b2:"initial",borderBottomWidth:({isExpanded:e})=>e?"1px":"0",boxShadow:({isExpanded:t})=>t?`${e.palette.border.dark} 0px 4px 5px -3px`:"none","& > div":{padding:e.spacing(1)}},itemRoot:{borderStyle:"solid",marginBottom:e.spacing(.25),marginTop:e.spacing(.25)},childrenContainer:{display:({isExpanded:e})=>e?"block":"none"},noChildrenContainer:{color:e.palette.text.secondary,padding:"20px",textAlign:"center"},pointsPossibleContainer:{color:e.palette.text.hint,margin:"0 10px",textAlign:"right",width:"80px"}})));function lr({alias:e,calculationRule:t,childItems:n=[],icon:a,isExempted:r,isLocked:s,isReadOnly:o,numGradableItemsInCategory:l,onBlurWeight:c,onChangeWeight:d,onClickEditCalculationRule:u,onClickExempt:m,onClickLock:p,pointsPossible:h,title:g,valueType:f,weight:v}){const y=Object(Z.useTheme)(),S=Object(Z.useMediaQuery)(y.breakpoints.down("sm")),{translate:C,formatNumber:E}=Object(he.a)(),I="points"===f,[k,w]=i.useState(!1),T=!u,O=!m,A=!p,P=O&&T,x=i.useMemo((()=>({isCompact:S,isExempted:r,isExpanded:k})),[S,r,k]),$=or(x),N=`item-${e}-overflow-menu`,D=`category-children-${e}`,L=`${D}-toggle`,[j,M]=i.useState(null),G=i.useCallback((e=>{e.stopPropagation(),M(e.currentTarget)}),[]),R=i.useCallback((e=>{e.stopPropagation(),w((e=>!e))}),[]),B=i.useMemo((()=>Object(Ot.m)(a)),[a]);return i.createElement(er,{RootProps:{className:$.itemRoot},ContainerProps:{className:$.itemContainer},Icon:i.createElement(B,null),Content:i.createElement(i.Fragment,null,i.createElement(jn.a,{component:"div",variant:"h4"},C(g)),i.createElement(Z.Box,{className:$.contentSubTextContainer},i.createElement(jn.a,{className:$.contentSubTextItems},C("course.grades.overallGrade.nItems.plural",{n:n.length})),o||S||T?void 0:i.createElement($i,{calculationRule:t,numGradableItemsInCategory:l,ButtonProps:{"aria-label":C("course.grades.overallGrade.editCalculationRulesForCategory",{title:g}),className:$.contentEditCalculationRuleButton,disabled:r,onClick:u}}))),ContentProps:{onClick:e=>{S&&null===j&&R(e)}},Controls:i.createElement(i.Fragment,null,S?i.createElement(b.AnalyticsIconButton,{analyticsId:"course.grades.overallGrade.overallGradeController.collapse","aria-controls":k?D:void 0,"aria-expanded":k,"aria-label":C(k?"course.grades.overallGrade.collapseItemsForCategory":"course.grades.overallGrade.expandItemsForCategory",{title:g}),id:L,onClick:R},k?i.createElement(Zi.a,null):i.createElement(Ji.a,null)):void 0,o||S||I?void 0:i.createElement(b.AnalyticsIconButton,{analyticsId:"course.grades.overallGrade.toggleLocked.button","aria-label":C(s?"course.grades.overallGrade.unlockWeightForCategory":"course.grades.overallGrade.lockWeightForCategory",{title:g}),"aria-pressed":s,className:Object(V.a)($.controlButton,{[$.controlButtonUnavailable]:A}),disabled:A||r,onClick:p},!s||r?i.createElement(Qi.a,null):i.createElement(Ki.a,null)),I&&void 0!==h?i.createElement(Z.Box,{"data-test-id":"points-possible",className:$.pointsPossibleContainer},E(h,{maximumFractionDigits:2})):i.createElement(ar,{alias:e,analyticsId:"course.grades.overallGrade.updateTotalWeight.input.text",ariaLabel:C("course.grades.overallGrade.weightForCategory",{title:g}),disabled:o||s||r,isNotApplicable:!d,onBlur:c,onChange:d,unitHint:"%",value:v}),o||!S||I?void 0:i.createElement(b.AnalyticsIconButton,{analyticsId:"course.grades.overallGrade.toggleLocked.button","aria-label":C(!s||r?"course.grades.overallGrade.lockWeightForCategory":"course.grades.overallGrade.unlockWeightForCategory",{title:g}),"aria-pressed":s,className:Object(V.a)($.controlButton,{[$.controlButtonUnavailable]:A}),disabled:A||r,onClick:p},!s||r?i.createElement(Qi.a,null):i.createElement(Ki.a,null)),o||!S?i.createElement(b.AnalyticsIconButton,{analyticsId:"course.grades.overallGrade.toggleExempt.button","aria-label":C(r?"course.grades.overallGrade.unexemptCategory":"course.grades.overallGrade.exemptCategory",{title:g}),"aria-pressed":r,className:Object(V.a)($.controlButton,{[$.controlButtonUnavailable]:O}),disabled:o||O,onClick:m},i.createElement(Wi.a,{className:r?$.controlButtonLockedActive:void 0})):void 0,!o&&S?i.createElement(i.Fragment,null,i.createElement(b.AnalyticsIconButton,{analyticsId:"course.grades.overallGrade.toggleItemMobileOverflowMenu.toggle","aria-controls":j?N:void 0,"aria-expanded":null!==j,"aria-haspopup":"menu",className:Object(V.a)($.controlButton,{[$.controlButtonUnavailable]:P}),disabled:P,onClick:G},i.createElement(Yi.Menu,null)),i.createElement(b.AnalyticsMenu,{analyticsId:"course.grades.overallGrade.toggleItemMobileOverflowMenu.menu",anchorEl:j,id:N,onClose:e=>{var t;null===(t=e.stopPropagation)||void 0===t||t.call(e),M(null)},open:null!==j,MenuListProps:{"aria-label":C("course.grades.overallGrade.overflowActions")}},i.createElement(b.AnalyticsMenuItem,{"data-analytics-id":"course.grades.overallGrade.toggleExempt.button",analyticsId:"course.grades.overallGrade.toggleExempt.button","aria-label":C(r?"course.grades.overallGrade.unexemptCategory":"course.grades.overallGrade.exemptCategory",{title:g}),"aria-pressed":r,button:!0,onClick:m},i.createElement(Z.ListItemIcon,null,i.createElement(Wi.a,{className:r?$.controlButtonLockedActive:void 0})),i.createElement(Z.ListItemText,null,i.createElement(jn.a,null,C("course.grades.overallGrade.exempt")))),i.createElement(b.AnalyticsMenuItem,{"data-analytics-id":"course.grades.overallGrade.editCalculationRule",analyticsId:"course.grades.overallGrade.editCalculationRule","aria-label":C("course.grades.overallGrade.editCalculationRulesForCategory",{title:g}),button:!0,disabled:r,onClick:u},i.createElement(Z.ListItemIcon,null,i.createElement(qi.a,null)),i.createElement(Z.ListItemText,null,i.createElement(jn.a,null,C("course.grades.overallGrade.editCalculationRules")))))):void 0),Action:S?void 0:i.createElement(b.AnalyticsIconButton,{analyticsId:"course.grades.overallGrade.overallGradeController.collapse","aria-controls":k?D:void 0,"aria-label":C(k?"course.grades.overallGrade.collapseItemsForCategory":"course.grades.overallGrade.expandItemsForCategory",{title:g}),"aria-expanded":k,id:L,onClick:R},k?i.createElement(Vi.a,null):i.createElement(Hi.a,null))},i.createElement(Z.Box,{id:D,role:"region","aria-labelledby":L,className:Object(V.a)($.childrenContainer,0===n.length?$.noChildrenContainer:null)},n.length>0?n.map((e=>i.createElement(sr,{key:e.alias,...e,categoryName:g,isReadOnly:o,valueType:f}))):i.createElement(jn.a,null,C("course.grades.overallGrade.noItemsInThisCategory"))))}var cr=n("kbTF");const dr=Object(Z.makeStyles)((e=>Object(Z.createStyles)({actionPropsUnavailable:{visibility:"hidden"},controlButton:{padding:e.spacing(1)},controlButtonUnavailable:{visibility:"hidden"},controlButtonLockedActive:{color:e.palette.brand.main},itemContainer:{backgroundColor:({isExempted:t})=>t?e.palette.background.b2:"initial","& > div":{padding:e.spacing(1)}},itemRoot:{borderStyle:"solid",marginBottom:e.spacing(.25),marginTop:e.spacing(.25)},pointsPossibleContainer:{color:e.palette.text.hint,margin:"0 10px",textAlign:"right",width:"80px"}})));function ur({alias:e,isExempted:t,isLocked:n,isReadOnly:a,onBlurWeight:r,onChangeWeight:s,onClickExempt:o,onClickLink:l,onClickLock:c,pointsPossible:d=0,subTitle:u,title:m,valueType:p,weight:h}){const g=Object(Z.useTheme)(),f=Object(Z.useMediaQuery)(g.breakpoints.down("sm")),v=dr({isExempted:t}),{translate:y,formatNumber:S}=Object(he.a)(),C="points"===p,E=i.useMemo((()=>`item-${e}-overflow-menu`),[e]),[I,k]=i.useState(null),w=i.useCallback((e=>{e.stopPropagation(),k(e.currentTarget)}),[]);return i.createElement(er,{RootProps:{className:v.itemRoot},ContainerProps:{className:v.itemContainer},Content:i.createElement(i.Fragment,null,i.createElement(jn.a,{component:"div",variant:"h4"},y(m)),f?void 0:i.createElement(jn.a,{variant:"body2"},y(u))),Controls:i.createElement(i.Fragment,null,a||f||C?void 0:i.createElement(b.AnalyticsIconButton,{analyticsId:"course.grades.overallGrade.toggleLocked.button","aria-label":y(!n||t?"course.grades.overallGrade.lockWeightForItem":"course.grades.overallGrade.unlockWeightForItem",{title:m}),"aria-pressed":n,className:v.controlButton,onClick:c,disabled:t},!n||t?i.createElement(Qi.a,null):i.createElement(Ki.a,null)),C?i.createElement(Z.Box,{"data-test-id":"points-possible",className:v.pointsPossibleContainer},S(d,{maximumFractionDigits:2})):i.createElement(ar,{alias:e,analyticsId:"course.grades.overallGrade.updateTotalWeight.input.text",ariaLabel:y("course.grades.overallGrade.weightForItem",{title:m}),disabled:a||n||t,onBlur:r,onChange:s,value:h,unitHint:"%"}),a||!f||C?void 0:i.createElement(b.AnalyticsIconButton,{analyticsId:"course.grades.overallGrade.toggleLocked.button","aria-label":y(!n||t?"course.grades.overallGrade.lockWeightForItem":"course.grades.overallGrade.unlockWeightForItem",{title:m}),"aria-pressed":n,className:v.controlButton,disabled:t,onClick:c},!n||t?i.createElement(Qi.a,null):i.createElement(Ki.a,null)),a||!f?i.createElement(b.AnalyticsIconButton,{analyticsId:"course.grades.overallGrade.toggleExempt.button","aria-label":y(t?"course.grades.overallGrade.unexemptItem":"course.grades.overallGrade.exemptItem",{title:m}),"aria-pressed":t,className:v.controlButton,disabled:a,onClick:o},i.createElement(Wi.a,{className:t?v.controlButtonLockedActive:void 0})):void 0,!a&&f?i.createElement(i.Fragment,null,i.createElement(b.AnalyticsIconButton,{analyticsId:"course.grades.overallGrade.toggleItemMobileOverflowMenu.toggle","aria-controls":I?E:void 0,"aria-expanded":null!==I,"aria-haspopup":"menu",onClick:w},i.createElement(Yi.Menu,null)),i.createElement(b.AnalyticsMenu,{analyticsId:"course.grades.overallGrade.toggleItemMobileOverflowMenu.menu",anchorEl:I,id:E,onClose:()=>k(null),open:null!==I,MenuListProps:{"aria-label":y("course.grades.overallGrade.overflowActions")}},i.createElement(b.AnalyticsMenuItem,{"data-analytics-id":"course.grades.overallGrade.toggleExempt.button",analyticsId:"course.grades.overallGrade.toggleExempt.button","aria-label":y(t?"course.grades.overallGrade.unexemptItem":"course.grades.overallGrade.exemptItem",{title:m}),"aria-pressed":t,button:!0,onClick:o},i.createElement(Z.ListItemIcon,null,i.createElement(Wi.a,{className:t?v.controlButtonLockedActive:void 0})),i.createElement(Z.ListItemText,null,i.createElement(jn.a,null,y("course.grades.overallGrade.exempt")))),i.createElement(b.AnalyticsMenuItem,{"data-analytics-id":"course.grades.overallGrade.link.button",analyticsId:"course.grades.overallGrade.link.button","aria-label":y("course.grades.overallGrade.linkToCategoryName",{title:u}),button:!0,onClick:l},i.createElement(Z.ListItemIcon,null,i.createElement(cr.a,null)),i.createElement(Z.ListItemText,null,i.createElement(jn.a,null,y("course.grades.overallGrade.linkToCategory")))))):void 0),Action:f?void 0:i.createElement(b.AnalyticsIconButton,{analyticsId:"course.grades.overallGrade.link.button","aria-label":y("course.grades.overallGrade.linkToCategoryName",{title:u}),className:a?v.controlButtonUnavailable:void 0,disabled:a,onClick:l},i.createElement(cr.a,null)),ActionProps:{className:a?v.actionPropsUnavailable:void 0}})}var mr=n("nOKu"),pr=n("HFqc"),hr=n("yUsM");const gr=Object(Z.makeStyles)((e=>Object(Z.createStyles)({showMore:{"&, &:active, &:focus, &:hover":{color:e.palette.text.primary},marginLeft:"8px"},details:{display:({expandDetails:e})=>e?"block":"none","& svg":{verticalAlign:"middle"}}}))),br={excludeIcon:i.createElement(Wi.a,null),lockIcon:i.createElement(mr.a,null),unlinkIcon:i.createElement(pr.a,null)},fr=({calculationType:e})=>{const t=Object(Z.useTheme)(),n=Object(Z.useMediaQuery)(t.breakpoints.down("sm")),a=Object(Bn.a)(),[r,s]=i.useState(),o=null!=r?r:!n,l=gr({expandDetails:o});const c=i.useMemo((()=>{switch(e){case"weighted":return i.createElement(i.Fragment,null,i.createElement("li",null,a("course.grades.overallGrade.calculationDetail.li0",br)),i.createElement("li",null,a("course.grades.overallGrade.calculationDetail.li3",br)),i.createElement("li",null,a("course.grades.overallGrade.calculationDetail.li2",br)));case"points":return i.createElement(i.Fragment,null,i.createElement("li",null,a("course.grades.overallGrade.calculationDetail.li4",br)),i.createElement("li",null,a("course.grades.overallGrade.calculationDetail.li2",br)));case"advanced":return}}),[e,a]);return i.createElement(i.Fragment,null,i.createElement("span",null,a(function(){switch(e){case"weighted":return"course.grades.overallGrade.calculationDetail.p0";case"points":return"course.grades.overallGrade.calculationDetail.p1";case"advanced":return"course.grades.overallGrade.calculationDetail.p2"}}())),c?i.createElement(i.Fragment,null,i.createElement(b.AnalyticsLink,{"aria-controls":o?"overall-grade-detail-expand":void 0,"aria-expanded":o,analyticsId:"course.grades.overallGrade.calculationDetail.showMore",className:l.showMore,component:"button",id:"overall-grade-detail-expand-toggle",onClick:function(e){e.preventDefault(),e.stopPropagation(),s(!o)}},i.createElement(hr.a,{component:"span"},a(o?"course.grades.overallGrade.calculationDetail.showLess":"course.grades.overallGrade.calculationDetail.showMore"))),i.createElement("div",{id:"overall-grade-detail-expand",role:"region","aria-labelledby":"overall-grade-detail-expand-toggle",className:l.details},i.createElement("ul",null,c))):void 0)},vr=Object(Z.makeStyles)((e=>Object(Z.createStyles)({filterWrapper:{display:"flex",flex:1,flexDirection:"column",[e.breakpoints.up("sm")]:{flexDirection:"row",flexWrap:"wrap",alignContent:"center",gap:"12px"}},textFieldFilter:{display:"flex",margin:"8px 0px",flexGrow:1,[e.breakpoints.up("sm")]:{minWidth:"200px"},[e.breakpoints.up("md")]:{flexGrow:0}}}))),yr=e=>{const{analyticsId:t,gradingFilterSelected:n,scoreProviderHandler:a,studentFilterSelected:r,initialStudentFilter:o,initialGradingFilter:l,isDelegated:c,isUserReconciler:d,isGroupContent:u}=e,m=Object(Bn.a)(),p=Object(en.h)("course.grades.gradebook-item.filters","organization.grades.gradebook-item.filters"),h=((e,t)=>{const n=Object(Bn.a)(),a=Object(en.h)("course.grades.gradebook-item.filters","organization.grades.gradebook-item.filters");return Object(i.useMemo)((()=>{const i=new Map;switch(t?i.set(j.Xb.allStatuses,n("course.grades.gradebook-item.filters.studentStatus.allGroupStatuses")):i.set(j.Xb.allStatuses,n(a("course.grades.gradebook-item.filters.studentStatus.allStatuses"))),e.toString()){case M.O.UltraAssignment.toString():case M.O.ClassicAssignment.toString():case M.O.Test.toString():i.set(j.Xb.noAttempt,n("course.grades.gradebook-item.filters.studentStatus.noSubmission")),i.set(j.Xb.attemptInProgress,n("course.grades.gradebook-item.filters.studentStatus.draftSaved")),i.set(j.Xb.attemptSubmitted,n("course.grades.gradebook-item.filters.studentStatus.submitted"));break;case M.O.Journal.toString():case M.O.Discussion.toString():i.set(j.Xb.noAttempt,n("course.grades.gradebook-item.filters.studentStatus.noEntry")),i.set(j.Xb.attemptSubmitted,n("course.grades.gradebook-item.filters.studentStatus.entryMade"));break;case M.O.Scorm.toString():i.set(j.Xb.noAttempt,n("course.grades.gradebook-item.filters.studentStatus.noSubmission")),i.set(j.Xb.attemptInProgress,n("course.grades.gradebook-item.filters.studentStatus.draftSaved")),i.set(j.Xb.attemptSubmitted,n("course.grades.gradebook-item.filters.studentStatus.submitted"))}return i}),[e,t,n,a])})(a,u),g=((e,t,n)=>{const a=Object(Bn.a)();return Object(i.useMemo)((()=>{const i=new Map;switch(i.set(j.O.allStatuses,a("course.grades.gradebook-item.filters.gradingStatus.allStatuses")),e.toString()){case M.O.UltraAssignment.toString():case M.O.ClassicAssignment.toString():case M.O.Test.toString():t?n?(i.set(j.O.needsGrading,a("course.grades.gradebook-item.filters.gradingStatus.needsToReconcile")),i.set(j.O.gradeNeedsPosting,a("course.grades.gradebook-item.filters.gradingStatus.needsPosting")),i.set(j.O.nothingToGrade,a("course.grades.gradebook-item.filters.gradingStatus.nothingToReconcile")),i.set(j.O.completed,a("course.grades.gradebook-item.filters.gradingStatus.completed"))):(i.set(j.O.needsGrading,a("course.grades.gradebook-item.filters.gradingStatus.needsGrading")),i.set(j.O.completed,a("course.grades.gradebook-item.filters.gradingStatus.completed"))):(i.set(j.O.needsGrading,a("course.grades.gradebook-item.filters.gradingStatus.needsGrading")),i.set(j.O.gradeNeedsPosting,a("course.grades.gradebook-item.filters.gradingStatus.needsPosting")),i.set(j.O.completed,a("course.grades.gradebook-item.filters.gradingStatus.completed"))),i.get(j.O.nothingToGrade)||i.set(j.O.nothingToGrade,a("course.grades.gradebook-item.filters.gradingStatus.nothingToGrade"));break;case M.O.Journal.toString():case M.O.Discussion.toString():case M.O.Scorm.toString():i.set(j.O.needsGrading,a("course.grades.gradebook-item.filters.gradingStatus.needsGrading")),i.set(j.O.gradeNeedsPosting,a("course.grades.gradebook-item.filters.gradingStatus.needsPosting")),i.set(j.O.nothingToGrade,a("course.grades.gradebook-item.filters.gradingStatus.nothingToGrade")),i.set(j.O.completed,a("course.grades.gradebook-item.filters.gradingStatus.completed"))}return i}),[e,t,n,a])})(a,c,d),f=vr(),v=o&&h.has(o)?o:j.Xb.allStatuses,y=l&&g.has(l)?l:j.O.allStatuses,[S,C]=i.useState(v),[E,I]=i.useState(y),k=(e=>{const t=Object(s.e)((e=>{var t,n;return null===(n=null===(t=M.Yb.app.getLocation(e))||void 0===t?void 0:t.queryParams)||void 0===n?void 0:n.gradingStatus}));return Object(i.useEffect)((()=>{t&&e(Object(j.lc)(t))}),[e,t]),e=>{rt.Z.search({gradingStatus:e,page:"1"})}})((e=>{E!==e&&(I(e),n(e))})),w=(e=>{const t=Object(s.e)((e=>{var t,n;return null===(n=null===(t=M.Yb.app.getLocation(e))||void 0===t?void 0:t.queryParams)||void 0===n?void 0:n.studentStatus}));return Object(i.useEffect)((()=>{t&&e(Object(j.mc)(t))}),[t,e]),e=>{rt.Z.search({studentStatus:e,page:"1"})}})((e=>{S!==e&&(C(e),r(e))})),T=m(u?"course.grades.gradebook-item.filters.groupStatusFilterLabel":p("course.grades.gradebook-item.filters.studentStatusFilterLabel"));return i.createElement("div",{className:f.filterWrapper},i.createElement(b.AnalyticsTextField,{analyticsId:`${t}.student-status`,select:!0,id:"submission-list-dropdown-filters-student-status",label:T,floatingLabel:!0,value:h.get(S),className:f.textFieldFilter},[...h.keys()].map((e=>i.createElement(b.AnalyticsMenuItem,{analyticsId:`${t}.student-status.${e}.list-item`,button:!0,onClick:()=>(e=>{S!==e&&w(e)})(e),key:e,value:h.get(e)},h.get(e))))),i.createElement(b.AnalyticsTextField,{analyticsId:`${t}.grading-status`,select:!0,id:"submission-list-dropdown-filters-grading-status",label:m("course.grades.gradebook-item.filters.gradingStatusFilterLabel"),floatingLabel:!0,value:g.get(E),className:f.textFieldFilter},[...g.keys()].map((e=>i.createElement(b.AnalyticsMenuItem,{analyticsId:`${t}.grading-status.${e}.list-item`,button:!0,onClick:()=>(e=>{E!==e&&k(e)})(e),key:e,value:g.get(e)},g.get(e))))))},Sr=Object(Z.makeStyles)((e=>{const t=e.spacing(2.5),n=e.spacing(1);return Object(Z.createStyles)({root:{display:"inline-flex",flexDirection:"row"},buttonBase:{backgroundColor:e.palette.background.default,border:`solid 1px ${e.palette.border.main}`,borderRightWidth:0,color:"#666",margin:0,paddingBottom:n,paddingLeft:t,paddingRight:t,paddingTop:n,"&:first-child":{borderBottomLeftRadius:4,borderTopLeftRadius:4},"&:last-child":{borderBottomRightRadius:4,borderRightWidth:1,borderTopRightRadius:4},".side-panel-content &":{cursor:"pointer"}},buttonSelected:{backgroundColor:e.palette.common.black,borderColor:e.palette.common.black,color:e.palette.common.white}})})),Cr=({isReadOnly:e=!1,onClick:t,selected:n})=>{const a=Sr(),r=Object(Bn.a)(),s="overall-grade-tab-calculation-type";function o(e,n){e.stopPropagation(),t(n)}return i.createElement(Z.Box,{className:a.root},i.createElement(Z.FormControlLabel,{className:Object(V.a)(a.buttonBase,"points"===n?a.buttonSelected:null),control:i.createElement(Z.HideOffScreen,{component:"span"},i.createElement("input",{checked:"points"===n,"data-analytics-id":"course.grades.overallGrade.tab.points.radio",disabled:e,id:"overall-grade-tab-points",name:s,onChange:e=>o(e,"points"),tabIndex:-1,type:"radio",value:"points"})),label:r("course.grades.overallGrade.points"),tabIndex:0}),i.createElement(Z.FormControlLabel,{className:Object(V.a)(a.buttonBase,"weighted"===n?a.buttonSelected:null),control:i.createElement(Z.HideOffScreen,{component:"span"},i.createElement("input",{checked:"weighted"===n,"data-analytics-id":"course.grades.overallGrade.tab.weighted.radio",disabled:e,id:"overall-grade-tab-weighted",name:s,onChange:e=>o(e,"weighted"),tabIndex:-1,type:"radio",value:"weighted"})),disabled:e,label:r("course.grades.overallGrade.weighted"),tabIndex:0}),i.createElement(Z.FormControlLabel,{className:Object(V.a)(a.buttonBase,"advanced"===n?a.buttonSelected:null),control:i.createElement(Z.HideOffScreen,{component:"span"},i.createElement("input",{checked:"advanced"===n,"data-analytics-id":"course.grades.overallGrade.tab.advanced.radio",disabled:e,id:"overall-grade-tab-advanced",name:s,onChange:e=>o(e,"advanced"),tabIndex:-1,type:"radio",value:"advanced"})),label:r("course.grades.overallGrade.advanced"),tabIndex:0}))};var Er=n("jAJq"),Ir=n("h/yM"),kr=n("Gt+H"),wr=n("aw66");const Tr=Object(Z.makeStyles)((e=>Object(Z.createStyles)({root:{alignItems:"center",display:"flex",height:"100%",justifyContent:"center",width:"100%"},calculationTypeButtonsContainer:{paddingLeft:"60px","& button":{marginRight:"16px"}},calculationTypeContainer:{maxWidth:"650px",minWidth:"350px",width:"50%","& ul":{listStyleType:"none"}},calculationTypeOptionContainer:{marginTop:e.spacing(3),"&:last-of-type":{marginBottom:e.spacing(6)}},calculationTypeOptionDetailsContainer:{marginLeft:"20px"},calculationTypeOptionTitle:{lineHeight:"32px"},calculationTypeOptionsContainer:{paddingLeft:"60px"},description:{color:e.palette.text.secondary},exampleRowChild:{},exampleTable:{minWidth:"350px","& tr":{height:"24px"},"& tr.example-row-child th, & tr.example-row-child td":{paddingTop:0},"& th, & td":{border:"none",padding:0,paddingTop:"16px"}}}))),Or=({description:e,example:t,isSelected:n,value:a})=>{const r=Tr(),s=Object(Bn.a)(),o=`overall-grade-wizard-option-${a}`,l=`${o}-description`,[c,d]=i.useState(!1);return i.createElement(Z.Box,{className:r.calculationTypeOptionContainer},i.createElement(Z.FormControlLabel,{control:i.createElement(b.AnalyticsRadio,{analyticsId:`course.grades.overallGrade.wizard.${a}.radio`,id:o,inputProps:{"aria-checked":n,"aria-describedby":e?l:void 0},value:a}),htmlFor:o,label:i.createElement(Z.Typography,{className:r.calculationTypeOptionTitle},s(`course.grades.overallGrade.wizard.options.${a}.name`))}),i.createElement(Z.Box,{className:r.calculationTypeOptionDetailsContainer},void 0!==e?i.createElement(Z.Box,{id:l,className:r.description},e):void 0,void 0!==t?i.createElement(i.Fragment,null,i.createElement(b.AnalyticsLink,{"aria-controls":`overall-grade-wizard-${a}-example`,"aria-expanded":c,"aria-label":s(c?`course.grades.overallGrade.wizard.options.${a}.hideExampleUnique`:`course.grades.overallGrade.wizard.options.${a}.showExampleUnique`),analyticsId:`course.grades.overallGrade.wizard.${a}.example.button`,component:"button",id:`overall-grade-wizard-${a}-example-toggle`,onClick:function(e){e.stopPropagation(),d((e=>!e))}},i.createElement(Z.Typography,{component:"span"},s(c?"course.grades.overallGrade.wizard.hideExample":"course.grades.overallGrade.wizard.showExample"))),c?i.createElement(Z.Box,{id:`overall-grade-wizard-${a}-example`},t):void 0):void 0))},Ar=({onCancel:e,onComplete:t})=>{const n=Tr(),{translate:a,formatNumber:r}=Object(he.a)(),[s,o]=i.useState("points");return i.createElement(Z.Box,{className:n.root},i.createElement(Z.Box,{className:n.calculationTypeContainer},i.createElement(Er.a,{component:"fieldset"},i.createElement(Ir.a,{component:"legend"},i.createElement(Z.Typography,{variant:"h2"},a("course.grades.overallGrade.wizard.header")),i.createElement(Z.Typography,null,a("course.grades.overallGrade.wizard.description"))),i.createElement(Z.Box,{className:n.calculationTypeOptionsContainer},i.createElement(Z.RadioGroup,{hasCustomLegend:!0,defaultValue:"points",onChange:function(e,t){o(t)}},i.createElement(Or,{example:i.createElement(Z.Table,{className:n.exampleTable},i.createElement(Z.TableBody,null,i.createElement(kr.a,null,i.createElement(wr.a,{component:"th"},a("course.grades.overallGrade.wizard.options.points.example.assignmentsCategory")),i.createElement(wr.a,null,a("course.grades.overallGrade.wizard.options.points.example.nPoints",{points:r(200)}))),i.createElement(kr.a,{className:"example-row-child"},i.createElement(wr.a,{component:"th"},a("course.grades.overallGrade.wizard.options.points.example.assignment1")),i.createElement(wr.a,null,a("course.grades.overallGrade.wizard.options.points.example.nPoints",{points:r(100)}))),i.createElement(kr.a,{className:"example-row-child"},i.createElement(wr.a,{component:"th"},a("course.grades.overallGrade.wizard.options.points.example.assignment2")),i.createElement(wr.a,null,a("course.grades.overallGrade.wizard.options.points.example.nPoints",{points:r(100)}))),i.createElement(kr.a,null,i.createElement(wr.a,{component:"th"},a("course.grades.overallGrade.wizard.options.points.example.finalExam")),i.createElement(wr.a,null,a("course.grades.overallGrade.wizard.options.points.example.nPoints",{points:r(300)}))),i.createElement(kr.a,null,i.createElement(wr.a,{component:"th"},a("course.grades.overallGrade.wizard.options.points.example.overallGrade")),i.createElement(wr.a,null,a("course.grades.overallGrade.wizard.options.points.example.outOfPoints",{points:r(500)}))))),isSelected:"points"===s,value:"points"}),i.createElement(Or,{example:i.createElement(Z.Table,{className:n.exampleTable},i.createElement(Z.TableBody,null,i.createElement(kr.a,null,i.createElement(wr.a,{component:"th"},a("course.grades.overallGrade.wizard.options.points.example.assignmentsCategory")),i.createElement(wr.a,null,a("course.grades.overallGrade.wizard.options.weighted.example.nPercent",{percent:r(40)}))),i.createElement(kr.a,{className:"example-row-child"},i.createElement(wr.a,{component:"th"},a("course.grades.overallGrade.wizard.options.points.example.assignment1")),i.createElement(wr.a,null)),i.createElement(kr.a,{className:"example-row-child"},i.createElement(wr.a,{component:"th"},a("course.grades.overallGrade.wizard.options.points.example.assignment2")),i.createElement(wr.a,null)),i.createElement(kr.a,null,i.createElement(wr.a,{component:"th"},a("course.grades.overallGrade.wizard.options.points.example.finalExam")),i.createElement(wr.a,null,a("course.grades.overallGrade.wizard.options.weighted.example.nPercent",{percent:r(60)}))),i.createElement(kr.a,null,i.createElement(wr.a,{component:"th"},a("course.grades.overallGrade.wizard.options.points.example.overallGrade")),i.createElement(wr.a,null,a("course.grades.overallGrade.wizard.options.weighted.example.outOfPercent",{percent:r(100)}))))),isSelected:"weighted"===s,value:"weighted"}),i.createElement(Or,{description:i.createElement(Z.Typography,null,a("course.grades.overallGrade.wizard.options.advanced.description")),isSelected:"advanced"===s,value:"advanced"})))),i.createElement(Z.Box,{className:n.calculationTypeButtonsContainer},i.createElement(b.AnalyticsDefaultButton,{analyticsId:"course.grades.overallGrade.wizard.cancel.button",onClick:function(t){t.stopPropagation(),e()}},a("course.grades.overallGrade.wizard.cancel")),i.createElement(b.AnalyticsPrimaryButton,{analyticsId:"course.grades.overallGrade.wizard.next.button",disabled:void 0===s,onClick:function(e){e.stopPropagation(),void 0!==s&&t({calculationType:s})}},a("course.grades.overallGrade.wizard.next")))))},Pr=Object(Z.makeStyles)((()=>Object(Z.createStyles)({gradableItemExempt:{position:"absolute",inset:0,display:"flex",flexDirection:"column",justifyContent:"flex-start"},panelContent:{padding:"0 30px",flexGrow:1},panelContentRow:{marginTop:"24px"},panelFooter:{width:"100%",bottom:0,"& > div":{padding:"0 30px"},"& button":{margin:0,"&:first-child":{marginRight:"8px"}}},footerButton:{height:"38px",alignSelf:"center"}}))),xr=e=>{const{showConfirmationModal:t,onCancel:n,onConfirmation:a}=e,r=Object(Bn.a)(),s=`${e.analyticsId}.cancel-unsaved.dialog`,o="cancel-unsaved.dialog-title";return i.createElement(u.a,{className:"cancel-unsaved-confirmation-dialog",analyticsId:s,open:t,onClose:n,maxWidth:"md","aria-labelledby":o},i.createElement(b.AnalyticsDialogTitle,{analyticsId:`${s}.title`,id:o,onClick:n},r("gradebook.closeExemptionPanelConfirmationModal.title")),i.createElement(b.AnalyticsDialogContent,{analyticsId:`${s}.content`},i.createElement(b.AnalyticsDialogContentText,{analyticsId:`${s}.body`},r("gradebook.closeExemptionPanelConfirmationModal.content"))),i.createElement(b.AnalyticsDialogActions,{analyticsId:`${s}.actions`},i.createElement(b.AnalyticsDefaultButton,{analyticsId:`${s}.cancel.button`,onClick:n},r("gradebook.closeExemptionPanelConfirmationModal.cancel")),i.createElement(b.AnalyticsPrimaryButton,{analyticsId:`${s}.confirmation.button`,onClick:a},r("gradebook.closeExemptionPanelConfirmationModal.close"))))},$r="gradebook.gradableItem.ExemptPanel",Nr=()=>{const e=Pr(),t=Object(Bn.a)(),n=Object(s.d)(),{userId:a,columnId:r,courseId:o}=function(e){const t=new URLSearchParams(window.location.search);return e.reduce(((e,n)=>{const a=t.get(n);return a&&(e[n]=a),e}),{})}(["userId","columnId","courseId"]),l=Object(s.e)((e=>M.Yb.gradebookGrade.getGradebookGradesByColumnIdAndUserId(e,r,a)),s.c)[0],c=Object(s.e)((e=>M.Yb.user.getUserById(e,a))),d=Object(s.e)((e=>M.Yb.gradebookColumn.getGradebookColumnById(e,r))),[u,m]=Object(i.useState)(!!(null==l?void 0:l.isExempt)),[p,h]=Object(i.useState)(!1),[g,b]=Object(i.useState)(!1),[f,v]=Object(i.useState)(!1),y=!!(null==l?void 0:l.isExempt)!==u,S=y&&!f,C=H.memoize((()=>{b(!0)}));Object(rt.bb)(S,C),Object(i.useEffect)((()=>{p&&!y&&rt.Z.leavePeekState()}),[p,y]);const E={showConfirmationModal:g,onCancel:()=>b(!1),onConfirmation:()=>{b(!1),v(!0),rt.Z.leavePeekState()},analyticsId:$r},I={headerText:t("components.directives.grade.submission-list-row.per-gradable-item.title"),subHeaderText:(null==d?void 0:d.columnName)||"",analyticsIdPrefix:"gradebook.gradableItem.ExemptPanel ",showMenuToggleButton:!0,readyToFocus:!1};return i.createElement("div",{className:e.gradableItemExempt},i.createElement(ft.R,{...I}),i.createElement("div",{className:e.panelContent},i.createElement("div",{className:e.panelContentRow},i.createElement(Xe.TextField,{value:`${(null==c?void 0:c.givenName)||""} ${(null==c?void 0:c.familyName)||""}`,disabled:!0,label:t("components.directives.grade.submission-list-row.per-gradable-item.selectedStudentLabel")})),i.createElement("div",{className:e.panelContentRow},i.createElement(Xe.Checkbox,{defaultChecked:!!(null==l?void 0:l.isExempt),label:t("components.directives.grade.submission-list-row.per-gradable-item.checkboxExemptLabel"),onChange:e=>m((null==e?void 0:e.target).checked),analyticsId:"gradebook.gradableItem.ExemptPanel.checkbox"}))),i.createElement("div",{className:e.panelFooter},i.createElement(Xe.BbPanelFooter,{primaryButtonProps:{text:t("components.directives.save-buttons.notSaved"),disabled:!y,onClick:()=>(n(l?M.V.gradebookGrade.updateGradeByGradeId(l,{...l,isExempt:u}):M.V.gradebookGrade.createGradeByUserId({courseId:o,columnId:r,userId:a,isExempt:u})),void h(!0)),className:e.footerButton},secondaryButtonProps:{text:t("components.directives.save-buttons.cancel"),onClick:()=>rt.Z.leavePeekState(),className:e.footerButton},analyticsId:"gradebook.gradableItem.ExemptPanel.footer"})),i.createElement(xr,{...E}))};const Dr=Object(Z.makeStyles)((e=>Object(Z.createStyles)({studentTabs:{borderBottom:`1px solid ${e.palette.border.main}`,margin:"0 -30px",padding:"0 30px"}})));var Lr;!function(e){e.Grades="grades",e.Progress="progress"}(Lr||(Lr={}));const jr=e=>{const{onChange:t,value:n,analyticsId:a}=e,r=Dr(),s=Object(Bn.a)(),o=Object(en.h)("gradebook","organization.gradebook"),l=[{id:Lr.Grades,ariaControls:`student-tab-panel-${Lr.Grades}`,displayKey:"gradebook.studentTabs.grades"},{id:Lr.Progress,ariaControls:`student-tab-panel-${Lr.Progress}`,displayKey:o("gradebook.studentTabs.progress")}];return i.createElement("div",{className:r.studentTabs},i.createElement(b.AnalyticsTabs,{onChange:(e,n)=>t(n),value:null!=n?n:l[0].id,analyticsId:`${a}.grade.studentTabs`},l.map((e=>i.createElement(b.AnalyticsTab,{analyticsId:`${a}.grade.studentTabs.${e.id}`,className:`js-student-tab-${e.id}`,key:`student-tab-${e.id}`,value:e.id,id:`student-tab-${e.id}`,label:s(e.displayKey),"aria-controls":e.ariaControls})))))},Mr=Object(Z.makeStyles)((e=>Object(Z.createStyles)({container:{display:"flex",flexDirection:"row",paddingLeft:"10px",paddingRight:"10px",[e.breakpoints.up("sm")]:{paddingRight:"0px"},[e.breakpoints.up("md")]:{paddingLeft:"0px"}},userDetailContainer:{flex:1},userFieldContainer:{display:"flex",flexDirection:"row",padding:"2px 5px","& button":{minWidth:0,minHeight:0,padding:"0 5px"}},nameIdContainer:{display:"flex",flexDirection:"column",flexFlow:"row wrap",[e.breakpoints.up("sm")]:{flexDirection:"row"}},username:{paddingRight:"0px",[e.breakpoints.up("sm")]:{paddingRight:"10px"}},userLabel:{fontWeight:e.typography.fontWeightSemiBold,paddingRight:"5px"},noWrap:{whiteSpace:"nowrap"},userValues:{wordBreak:"break-all"},pipeSymbol:{display:"none",[e.breakpoints.up("sm")]:{display:"block",margin:"0px 5px"}},pronounceContainer:{display:"flex",flexDirection:"column",[e.breakpoints.up("sm")]:{flexDirection:"row"}}}))),Gr=Object(Z.makeStyles)((()=>({studentMenuItem:{minWidth:"200px"},studentMenuIcon:{marginRight:"11px",marginLeft:"6px",display:"flex",alignItems:"center"},container:{display:"flex",height:"fit-content"},iconButton:{margin:"0px 10px"}}))),Rr=e=>{const{displayName:t,membership:n}=e,a=Object(Bn.a)(),r=Gr(),o=Object(dt.t)(),l=Object(dt.s)(o.breakpoints.up("md")),[c,d]=i.useState(void 0),u=Object(s.e)((e=>M.Yb.app.getLocation(e).queryParams)),m=Object(s.e)((e=>M.Yb.app.getRoute(e).params)),p=null==n?void 0:n.id,h=null==u?void 0:u.userId,g=null==m?void 0:m.courseId,f=i.useCallback((()=>{d(void 0),rt.Z.goPeekState(Object(rt.ab)({courseId:g,recipientIds:h}))}),[h,g]),v=i.useCallback((()=>{d(void 0),rt.Z.goPeekState(Object(rt.db)({membershipId:p}))}),[p]),y=i.useCallback((()=>{d(void 0),rt.Z.goPeekState(Object(rt.fb)({userId:h}))}),[h]),S=[{id:"student-activity",analyticsId:"gradebook.components.student-action-menu.student-activity",text:a("gradebook.individualStudentDetails.studentActivity"),icon:i.createElement(I.BeastAnalytics,null),onClick:y,show:!0},{id:"accommodations",analyticsId:"gradebook.components.student-action-menu.accommodations",text:a("gradebook.studentList.table.actionsMenu.accommodations"),icon:i.createElement(I.Accommodations,null),onClick:v,show:(null==n?void 0:n.permissions.editDueDateException)||(null==n?void 0:n.permissions.editTimeLimitException)},{id:"send-message",analyticsId:"gradebook.components.student-action-menu.send-message",text:a("gradebook.individualStudentDetails.sendMessage"),icon:i.createElement(I.Messages,null),onClick:f,show:null==n?void 0:n.isAvailable}];return i.createElement("div",{className:r.container},l?S.map((e=>e.show&&i.createElement(b.AnalyticsIconButton,{analyticsId:e.analyticsId,id:e.id,key:e.id,onClick:e.onClick,className:r.iconButton},e.icon,i.createElement(b.AnalyticsTypography,{component:"span",variant:"inherit"},e.text)))):i.createElement(i.Fragment,null,i.createElement(b.AnalyticsIconButton,{analyticsId:"gradebook.components.common.student-action-menu.moreOptions",id:"student-action-menu-button","aria-controls":c?"student-action-menu":void 0,"aria-haspopup":"menu","aria-label":a("gradebook.studentList.table.actionsMenu.moreOptions",{fullName:t}),"aria-expanded":!!c,onClick:e=>{d(e.currentTarget)}},i.createElement(I.Menu,null)),i.createElement(b.AnalyticsMenu,{variant:"menu",id:"student-action-menu",anchorEl:c,open:!!c,onClose:()=>{d(void 0)},MenuListProps:{"aria-labelledby":"student-action-menu-button"},analyticsId:"gradebook.components.student-action-menu.menu"},S.map((e=>e.show&&i.createElement(b.AnalyticsMenuItem,{analyticsId:e.analyticsId,id:e.id,key:e.id,className:r.studentMenuItem,button:!0,onClick:e.onClick},i.createElement("span",{className:r.studentMenuIcon},e.icon),i.createElement("span",null,e.text)))))))},Br=e=>{var t,n,a;const{user:r,membership:s}=e,{translate:o,formatDatetime:l,formatUsername:c}=Object(he.a)(),d=Mr(),u=c(r,It.ILocaleUsernameFormat.Short,{noWrap:!0});return i.createElement("div",{className:d.container},i.createElement("div",{className:d.userDetailContainer},i.createElement("div",{className:d.userFieldContainer},i.createElement("div",{className:d.userLabel},o("gradebook.individualStudentDetails.lastAccess")),i.createElement("div",{className:d.userValues},s.lastAccessDate?l(s.lastAccessDate,It.ILocaleDatetimeFormat.Short):o("gradebook.individualStudentDetails.noActivity"))),i.createElement("div",{className:d.nameIdContainer},r.userName&&i.createElement("div",{className:d.userFieldContainer},i.createElement("div",{className:d.userLabel},o("gradebook.individualStudentDetails.userName")),i.createElement("div",{className:Object(V.a)(d.userValues,d.username)},r.userName)),r.studentId&&i.createElement("div",{className:d.userFieldContainer},i.createElement("div",{className:d.userLabel},o("gradebook.individualStudentDetails.studentId")),i.createElement("div",{className:d.userValues},r.studentId))),i.createElement("div",{className:d.pronounceContainer},r.pronouns&&i.createElement("div",{className:d.userFieldContainer},i.createElement("div",{className:d.userLabel},o("gradebook.individualStudentDetails.pronouns")),i.createElement("div",{className:d.noWrap},r.pronouns)),r.pronouns&&(r.pronunciation||(null===(t=r.pronunciationAudio)||void 0===t?void 0:t.permanentUrl))&&i.createElement("span",{className:d.pipeSymbol},"|"),(r.pronunciation||(null===(n=r.pronunciationAudio)||void 0===n?void 0:n.permanentUrl))&&i.createElement("div",{className:d.userFieldContainer},i.createElement("div",{className:Object(V.a)(d.userLabel,d.noWrap)},o("gradebook.individualStudentDetails.pronounceAs")),r.pronunciation&&i.createElement("div",{className:d.userValues},r.pronunciation),(null===(a=r.pronunciationAudio)||void 0===a?void 0:a.permanentUrl)&&i.createElement(ft.D,{analyticsId:"gradebook.individual-student-grades-info.user.pronunciation",src:r.pronunciationAudio.permanentUrl,ariaLabel:o("gradebook.individualStudentDetails.pronunciationAriaLabel")})))),i.createElement(Rr,{displayName:u,membership:s}))};var Fr=n("c3rw");const Ur=Object(Z.makeStyles)((e=>Object(Z.createStyles)({container:{width:"100%",display:"flex",justifyContent:"center",overflow:"hidden",whiteSpace:"nowrap",[e.breakpoints.up("md")]:{justifyContent:"space-between"}},headerContainer:{display:"flex",maxWidth:"100%",[e.breakpoints.up("md")]:{flex:1,minWidth:0}},iconContainer:{display:"flex",margin:"0px 4px",alignItems:"center"},accommodationsIcon:{color:e.palette.brand.main,marginRight:"10px"},headerText:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:e.palette.primary.contrastText,[e.breakpoints.up("md")]:{color:e.palette.text.primary}}}))),_r=Object(Z.makeStyles)((e=>Object(Z.createStyles)({container:{display:"flex",alignItems:"center"},currentGrade:{display:"none",[e.breakpoints.up("md")]:{display:"flex",marginRight:"8px",alignItems:"center"}}}))),zr=e=>{const{courseId:t,membership:n,user:a}=e,r=Object(Bn.a)(),s=_r(),o=Object(dt.t)(),l=Object(dt.s)(o.breakpoints.up("md")),c=an(t),d=bn(t,null==c?void 0:c.gradingSchemaId),u=tn(t,(null==c?void 0:c.id)||null,[n]),m=!1===(null==c?void 0:c.visible),p={user:a,membership:n,overallGrade:u&&u[n.userId],overallGradeColumn:c},h=l?z.Large:z.Default;return i.createElement(i.Fragment,null,p.overallGrade&&i.createElement("div",{className:s.container,"data-testid":"test-grade-pill-container"},m&&i.createElement(Z.Tooltip,{title:r("gradebook.grade.tooltip.gradeVisibility")},i.createElement(b.AnalyticsIconButton,{analyticsId:"gradebook.individualStudentOverallGradePill.visibilityInformationTooltip.button","aria-label":r("gradebook.grade.gradeVisibilityIcon")},i.createElement(I.Invisible,null))),i.createElement(b.AnalyticsTypography,{component:"span",variant:"h3",className:s.currentGrade},r("gradebook.grade.currentGrade")),i.createElement(Et,{row:p,isOverallGradeConfigured:!!c,gradingSchema:d,overallGradeColumn:c,pillSize:h})))},qr=()=>{var e;const{translate:t,formatUsername:n}=Object(he.a)(),a=Ur(),r=Object(dt.t)(),o=Object(dt.s)(r.breakpoints.up("md")),l=Object(s.e)((e=>M.Yb.app.getLocation(e).queryParams)),c=Object(s.e)((e=>M.Yb.app.getRoute(e).params)),d=null==l?void 0:l.userId,u=null==l?void 0:l.membershipId,m=null==c?void 0:c.courseId,p=Object(en.n)(d),h=Object(s.e)((e=>M.Yb.courseMembership.getCourseMembershipByMembershipId(e,u))),g=Object(en.d)(m),f=i.createElement(Ot.e,{user:p,format:It.ILocaleUsernameFormat.Short,ariaHidden:!1}),v=Tt(h),y=p&&n(p,It.ILocaleUsernameFormat.Short,{noWrap:!0}),S=i.createElement("div",{className:a.container},i.createElement("div",{className:a.headerContainer},o&&i.createElement("div",null,i.createElement(Fr.b,{size:"medium",src:null===(e=null==p?void 0:p.avatar)||void 0===e?void 0:e.permanentUrl,alt:y})),i.createElement(b.AnalyticsTypography,{component:"h1",variant:o?"display1":"h3",className:a.headerText},f),v&&i.createElement("div",{className:a.iconContainer},i.createElement(I.Accommodations,{className:a.accommodationsIcon,titleAccess:t("gradebook.studentList.fullNameComponent.aria.accommodations")}))),o&&h&&i.createElement(zr,{courseId:m,user:p,membership:h}));return i.createElement(ft.R,{headerText:S,subHeaderText:(null==g?void 0:g.displayName)||"",analyticsIdPrefix:"gradebook.components.individual-student-grades-panel-header",showMenuToggleButton:!0,readyToFocus:!0},h&&i.createElement(zr,{courseId:m,user:p,membership:h}))};var Hr=n("kwLz"),Vr=n("ERsv"),Wr=n("Jirr");const Kr=Object(Z.makeStyles)((e=>({userCardContainer:{display:"flex",width:"100%",alignItems:"center"},avatar:{minWidth:"unset",display:"flex"},userContainer:{marginLeft:"12px",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},userDetails:{display:"flex"},iconContainer:{display:"flex",alignItems:"center"},accommodationIcon:{color:e.palette.brand.main,marginRight:"10px"},userName:{fontWeight:e.typography.fontWeightSemiBold},roleBadge:{textTransform:"uppercase",fontSize:e.typography.fontSizeXSmall,fontWeight:e.typography.fontWeightBold,backgroundColor:e.palette.background.b10,padding:"0px 10px"},courseRole:{color:e.palette.text.secondary}}))),Yr=e=>{var t;const{avatarSize:n,showRoleInBadge:a,role:r,user:s,showAccommodation:o}=e,l=Kr(),{translate:c,formatUsername:d}=Object(he.a)(),u=d(s,It.ILocaleUsernameFormat.Short),m=Object(en.h)("global.course.","global.organization.");return i.createElement("div",{className:l.userCardContainer},i.createElement("div",{className:l.avatar},i.createElement(b.AnalyticsAvatar,{size:n,alt:u,"aria-hidden":!0,src:null===(t=null==s?void 0:s.avatar)||void 0===t?void 0:t.permanentUrl})),i.createElement("div",{className:l.userContainer},i.createElement("div",{className:l.userDetails},o&&i.createElement("div",{className:l.iconContainer},i.createElement(I.Accommodations,{className:l.accommodationIcon,titleAccess:c("gradebook.studentList.fullNameComponent.aria.accommodations")})),i.createElement(Ot.e,{userNameStyles:l.userName,format:It.ILocaleUsernameFormat.Short,ariaHidden:!0,user:s})),r&&(a?i.createElement(Wr.b,{classes:{badge:l.roleBadge},position:"inline",badgeContent:c(m(`global.course.role.${r}`)),offScreenLabel:c(m(`global.course.role.${r}`))}):i.createElement("div",{className:l.courseRole},c(m(`global.course.role.${r}`))))))},Jr=Object(Z.makeStyles)((()=>({graderInfo:{paddingLeft:"4px"},feedBackPanel:{height:"50%",position:"relative",overflowY:"auto"}}))),Zr=e=>{var t,n;const{feedback:a,onFeedbackSave:r,openCloudStorageIntegrationModal:o,lastFeedbackAuthor:l,feedbackIsDirty:c,cancelFuncRef:d}=e,[u,m]=i.useState(!0),[p,h]=i.useState(!1),[g,b]=i.useState(null!==(t=null==a?void 0:a.rawText)&&void 0!==t?t:""),f=i.useRef(null==a?void 0:a.rawText),v=i.useRef(Object(Vr.generateToBbML)(g)),y=Jr(),{translate:S,locale:C}=Object(he.a)(),E=Object(en.m)(),I=Object(s.e)((e=>M.Yb.app.getRoute(e).params.courseId)),k=Object(s.e)((e=>M.Yb.app.getLocation(e).queryParams.userId)),w=Object(en.t)(I,za.EnterFeedback),T=Object(s.e)((e=>M.Yb.course.getCourseById(e,I))),O=Object(en.n)(null==l?void 0:l.userId),A=Object(s.e)((e=>M.Yb.courseMembership.getCourseMembershipsByUserIds(e,I,[null==l?void 0:l.userId])[0])),P=null==A?void 0:A.role,x=i.useCallback((()=>{c&&c(!Object(Jn.e)(f.current,g),f.current,u)}),[c,a,f.current,u,g]);i.useEffect((()=>{var e;const t=null!==(e=null==a?void 0:a.rawText)&&void 0!==e?e:"";b(t),f.current=t,v.current=Object(Vr.generateToBbML)(t),m(!!t||!w),d&&(d.current=$),x()}),[a,w,k]);const $=i.useCallback((()=>{f.current=g,g&&(x(),m(!0))}),[x,g]);return i.createElement(i.Fragment,null,i.createElement(Hr.a,{analyticsId:"gradebook.grade-and-feedback.offline-items.feedback",panelTitle:S("gradebook.gradeFeedback.offlineGradesAndFeedback.pageTitle"),configProps:{isOrganization:T.isOrganization,courseColorClass:"",editorConfigProps:{apiBasePath:M.cb.apiBasePath,courseId:I,onClickCancel:$,onClickSave:async()=>{if(g||!Object(Jn.e)(f.current,g)){h(!0),m(!0);try{const e=await v.current(!0);await r(e)}finally{h(!1)}}},xsrfToken:M.cb.xsrf,locale:C,fileUploadSettings:E,openCloudStorageIntegrationModal:o},primaryFeedbackConfigProps:{onFeedbackChange:e=>{v.current=e.toBbML;const t=e.toBbML();f.current=t,x()},onClickEdit:()=>{m(!1)},editorIsReadOnly:u}},primaryGraderFeedback:{isFeedbackEditable:!p&&w,rawTextFeedback:null!==(n=f.current)&&void 0!==n?n:""},isInlineMode:!0}),u&&g&&O&&i.createElement("div",{className:y.graderInfo},i.createElement(Yr,{avatarSize:"small",role:P,showRoleInBadge:!0,user:O,showAccommodation:!1})))};var Qr=n("np6O");const Xr=Object(Z.makeStyles)((()=>({navigationLabel:{padding:"0 10px"},navigationContainer:{display:"flex",justifyContent:"space-between",padding:"16px 30px",width:"100%"}}))),es=e=>{const{onNavigateToNextFeedback:t,onNavigateToPreviousFeedback:n,shouldDisableNextFeedback:a,shouldDisablePreviousFeedback:r}=e,{translate:s,isRtl:o}=Object(he.a)(),l=Xr(),c=Object(en.h)("gradebook.","organization.gradebook.");return i.createElement("div",{className:l.navigationContainer},o()?i.createElement(i.Fragment,null,i.createElement(Qr.AnalyticsIconButton,{onClick:t,disabled:a,analyticsId:"offline-feedback.feedback-navigator.next","aria-label":s(c("gradebook.gradeFeedback.offlineGradesAndFeedback.nextStudent"))},i.createElement(I.ArrowLeft,null),i.createElement("span",{className:l.navigationLabel},s(c("gradebook.gradeFeedback.offlineGradesAndFeedback.nextStudent")))),i.createElement(Qr.AnalyticsIconButton,{onClick:n,disabled:r,analyticsId:"offline-feedback.feedback-navigator.previous","aria-label":s(c("gradebook.gradeFeedback.offlineGradesAndFeedback.previousStudent"))},i.createElement("span",{className:l.navigationLabel},s(c("gradebook.gradeFeedback.offlineGradesAndFeedback.previousStudent"))),i.createElement(I.ArrowRight,null))):i.createElement(i.Fragment,null,i.createElement(Qr.AnalyticsIconButton,{onClick:n,disabled:r,analyticsId:"offline-feedback.feedback-navigator.previous","aria-label":s(c("gradebook.gradeFeedback.offlineGradesAndFeedback.previousStudent"))},i.createElement(I.ArrowLeft,null),i.createElement("span",{className:l.navigationLabel},s(c("gradebook.gradeFeedback.offlineGradesAndFeedback.previousStudent")))),i.createElement(Qr.AnalyticsIconButton,{onClick:t,disabled:a,analyticsId:"offline-feedback.feedback-navigator.next","aria-label":s(c("gradebook.gradeFeedback.offlineGradesAndFeedback.nextStudent"))},i.createElement("span",{className:l.navigationLabel},s(c("gradebook.gradeFeedback.offlineGradesAndFeedback.nextStudent"))),i.createElement(I.ArrowRight,null))))},ts="offline-items.save-feedback-confirmation",ns=e=>{const{exitCallback:t}=e,n=Object(Bn.a)(),[a,r]=i.useState(!1),[s,o]=i.useState(!1),[l,c]=i.useState(!1),d=(e=!1,t=!1)=>{o(e),r(!0),c(t)};return i.createElement(u.a,{analyticsId:ts,open:!a,maxWidth:"md",onClose:()=>d(),"aria-labelledby":"save-feedback-confirmation-dialog-title",TransitionProps:{onExited:()=>{t(s,l),r(!1)}}},i.createElement(b.AnalyticsDialogTitle,{analyticsId:"offline-items.save-feedback-confirmation.titleClose.button",id:"save-feedback-confirmation-dialog-title",onClose:()=>d()},n("gradebook.gradeFeedback.confirmation.title-x-bb-save-feedback")),i.createElement(b.AnalyticsDialogContent,{analyticsId:"offline-items.save-feedback-confirmation.content"},i.createElement(b.AnalyticsDialogContentText,{analyticsId:"offline-items.save-feedback-confirmation.contentText",id:"save-feedback-confirmation-dialog-description"},n("gradebook.gradeFeedback.confirmation.instructions-x-bb-save-feedback"))),i.createElement(b.AnalyticsDialogActions,{analyticsId:"offline-items.save-feedback-confirmation.actions"},i.createElement(b.AnalyticsDefaultButton,{analyticsId:"offline-items.save-feedback-confirmation.close.button",onClick:()=>d(!1,!0)},n("gradebook.gradeFeedback.confirmation.cancel-x-bb-save-and-close")),i.createElement(b.AnalyticsPrimaryButton,{analyticsId:"offline-items.save-feedback-confirmation.save-feedback.button",onClick:()=>d(!0,!0)},n("gradebook.gradeFeedback.confirmation.ok-x-bb-save-feedback"))))},as=e=>{const{exitCallback:t}=e,n=Object(Bn.a)(),a=Object(en.h)("gradebook.","organization.gradebook."),[r,s]=i.useState(!1),[o,l]=i.useState(!1),c=(e=!1)=>{l(e),s(!0)};return i.createElement(u.a,{analyticsId:"offline-items.post-grade-confirmation",open:!r,maxWidth:"md",onClose:()=>c(),"aria-labelledby":"post-grade-confirmation-dialog-title",TransitionProps:{onExited:()=>{t(o),s(!1)}}},i.createElement(b.AnalyticsDialogTitle,{analyticsId:"offline-items.post-grade-confirmation.titleClose.button",id:"post-grade-confirmation-dialog-title",onClick:()=>c()},n("gradebook.gradeFeedback.confirmation.title-x-bb-grade-options")),i.createElement(b.AnalyticsDialogContent,{analyticsId:"offline-items.post-grade-confirmation.content"},i.createElement(b.AnalyticsDialogContentText,{analyticsId:"offline-items.post-grade-confirmation.contentText",id:"post-grade-confirmation-dialog-description"},n(a("gradebook.gradeFeedback.confirmation.instructions-x-bb-grade-column-post-grades")))),i.createElement(b.AnalyticsDialogActions,{analyticsId:"offline-items.post-grade-confirmation.actions"},i.createElement(b.AnalyticsDefaultButton,{analyticsId:"offline-items.post-grade-confirmation.cancel.button",onClick:()=>c()},n("global.cancel")),i.createElement(b.AnalyticsPrimaryButton,{analyticsId:"offline-items.post-grade-confirmation.post-grade.button",onClick:()=>c(!0)},n("gradebook.gradeFeedback.offlineGradesAndFeedback.overflowMenu.postGrade"))))},is=Object(Z.makeStyles)((()=>({gradeMenuItem:{minWidth:"278px"},gradeMenuIcon:{marginRight:"5px",marginLeft:"6px"}}))),rs=e=>{const{gradeDetail:t,onGradeUpdate:n}=e,a=Object(Bn.a)(),r=Object(s.d)(),o=is(),l=Object(s.e)((e=>M.Yb.app.getRoute(e).params.courseId)),c=Object(s.e)((e=>M.Yb.app.getRoute(e).params.columnId)),[d,u]=i.useState(void 0),m=!!d,p=i.useCallback((()=>{u(void 0)}),[]),h=i.useCallback((e=>{u(e.currentTarget)}),[]),{displayModal:g,modal:f}=Object(ft.lb)(as),v=[{key:a("gradebook.gradeFeedback.offlineGradesAndFeedback.overflowMenu.postGrade"),analyticsId:"gradebook.components.common.grade-submission.grade-action-menu.postGrade",text:a("gradebook.gradeFeedback.offlineGradesAndFeedback.overflowMenu.postGrade"),icon:i.createElement(I.Post,{className:o.gradeMenuIcon}),onClick:async()=>{p();const{confirmed:e}=await g();e&&(async()=>{if(await r(M.V.gradebookGrade.postGradeByGradeId({courseId:l,columnId:c,id:t.id})),n){const e={...t};e.manualStatus=j.Bb.IsPosted,e.status=j.J.Graded,n(e)}r(M.V.gradebookGrade.loadBulkView(l,[c],[t.memberId],{expand:["grade.instructorFeedback","grade.lastFeedbackAuthor"]})),r(M.V.columnSummary.loadColumnSummary({courseId:l,columnId:c}))})()}}];return i.createElement(i.Fragment,null,i.createElement(b.AnalyticsIconButton,{analyticsId:"gradebook.components.common.grade-submission.grade-action-menu.trigger",id:"grade-action-menu-button","aria-controls":d?"grade-action-menu":void 0,"aria-haspopup":"menu","aria-label":a("gradebook.gradeFeedback.offlineGradesAndFeedback.overflowMenu.aria"),"aria-expanded":m,onClick:h},i.createElement(I.Menu,null)),i.createElement(b.AnalyticsMenu,{variant:"menu",id:"grade-action-menu",anchorEl:d,open:!!d,onClose:p,MenuListProps:{"aria-labelledby":"grade-action-menu-button"},transformOrigin:{vertical:0,horizontal:"right"},analyticsId:"gradebook.components.common.grade-submission.grade-action-menu"},v.map((e=>i.createElement(b.AnalyticsMenuItem,{analyticsId:e.analyticsId,key:e.key,className:o.gradeMenuItem,button:!0,onClick:e.onClick},i.createElement(Z.ListItemIcon,null,e.icon),i.createElement(Z.ListItemText,null,e.text))))),f)},ss=Object(Z.makeStyles)((e=>({postGrades:{display:"flex",float:"right"},gradeSubmissionCard:{display:"flex",width:"100%"},gradeAdditionalInfo:{fontWeight:e.typography.fontWeightRegular,color:e.palette.text.hint,right:"0px",float:"right"},gradingSection:{position:"relative",width:"35%"},profileCard:{width:"65%"}}))),os=e=>{const{analyticsId:t,student:n,role:a,onGradeInputBlur:r,gradeDetail:o,onGradeUpdate:l,membership:c}=e,d=Object(Bn.a)(),u=ss(),m=Object(s.e)((e=>M.Yb.app.getRoute(e).params.courseId)),p=Object(s.e)((e=>M.Yb.app.getRoute(e).params.columnId)),h=Ct(),g=Object(s.e)((e=>M.Yb.gradebookColumn.getGradebookColumnById(e,p))),b=null==g?void 0:g.gradingSchemaId,f=bn(m,b),v=Object(s.e)((e=>M.Yb.courseEntitlements.userHasCourseEntitlement(e,m,za.PublishGrades))),y=Tt(c);return i.createElement("div",{className:u.gradeSubmissionCard},i.createElement("div",{className:u.profileCard},i.createElement(Yr,{avatarSize:"medium",user:n,role:a,showAccommodation:y})),i.createElement("div",{className:u.gradingSection},i.createElement("div",{className:u.postGrades},f&&i.createElement(Ce,{grade:null==o?void 0:o.manualScore,variant:Je(f.scaleType),analyticsId:t,pointsPossible:g.possible,ariaLabel:d(Qe(null==o?void 0:o.displayGrade),{user:n,grade:null==o?void 0:o.manualScore,total:g.possible}),onBlur:r,gradeColorVariant:h?q.Black:void 0,symbolsMap:f.symbols}),o&&v&&Ye(o)&&i.createElement(rs,{gradeDetail:o,onGradeUpdate:l})),Ze(null==o?void 0:o.displayGrade)&&i.createElement("div",{className:u.gradeAdditionalInfo},d("gradebook.grade.grade-input.pastDueZero"))))},ls=e=>{const{gradeDetail:t,onGradeUpdate:n,student:a,role:r,membership:o}=e,[l,c]=i.useState(null),d=Object(s.d)(),u=Object(s.e)((e=>M.Yb.app.getRoute(e).params.courseId)),m=Object(s.e)((e=>M.Yb.app.getRoute(e).params.columnId)),p=Object(s.e)((e=>M.Yb.app.getLocation(e).queryParams.userId)),h=Object(s.e)((e=>M.Yb.gradebookGrade.getGradebookGradesByColumnIdAndUserId(e,m,p)[0]));return i.useEffect((()=>{var e;(null===(e=null==t?void 0:t.displayGrade)||void 0===e?void 0:e.score)?c(t.displayGrade.score):c(null)}),[t]),i.useEffect((()=>{n&&h&&n(h)}),[h,n]),i.createElement(os,{analyticsId:"offline-grades.gradePill",onGradeInputBlur:async e=>{void 0!==e&&e!==l&&(c(e),t&&(null==t?void 0:t.id)?await d(M.V.gradebookGrade.updateGradeByGradeId(t,{...t,manualScore:e})):await d(M.V.gradebookGrade.createGradeByUserId({courseId:u,columnId:m,userId:p,manualScore:e})),d(M.V.gradebookGrade.loadBulkView(u,[m],[o.id],{expand:["grade.instructorFeedback","grade.lastFeedbackAuthor"]})),d(M.V.columnSummary.loadColumnSummary({courseId:u,columnId:m})))},student:a,membership:o,role:r,gradeDetail:t,onGradeUpdate:n})},cs=Object(Z.makeStyles)((e=>({peekPanel:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",flexDirection:"column"},peekPanelHeader:{"& .ms-Panel-subTitle, .ms-Panel-headerText":{paddingLeft:"16px",maxWidth:"200px",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",[e.breakpoints.up("sm")]:{maxWidth:"400px"}}},hideHeader:{display:"none"},peekPanelBody:{padding:"16px",overflowY:"auto",flex:1,[e.breakpoints.up("sm")]:{padding:"30px"},"& h3":{fontSize:e.typography.fontSizeDefault}}})));const ds=M.V.gradebookGrade.createGradeByUserId,us=M.V.gradebookGrade.updateGradeByGradeId,ms=e=>{var t,n,a;const{courseName:r,onGradeUpdate:o,onFeedbackUpdate:l,openCloudStorageIntegrationModal:c,onFeedbackDirty:d}=e,u=Object(Bn.a)(),m=Object(s.d)(),p=cs(),h=i.useRef(!1),g=i.useRef(!0),[b,f]=i.useState(0),v=Object(s.e)((e=>M.Yb.app.getLocation(e).queryParams.userId)),y=Object(s.e)((e=>M.Yb.app.getLocation(e).queryParams.page)),S=Object(s.e)((e=>M.Yb.app.getLocation(e).queryParams.limit)),C=Object(s.e)((e=>M.Yb.app.getLocation(e).queryParams.q)),E=Object(s.e)((e=>M.Yb.app.getRoute(e).params.courseId)),I=Object(s.e)((e=>M.Yb.app.getRoute(e).params.columnId)),k=i.useRef(),w=function(e,t=""){const n=Object(s.d)();return Object(i.useEffect)((()=>{e&&t&&n(M.V.gradebookColumn.loadGradebookColumn({columnId:t,courseId:e,allowedErrors:[j.S.Forbidden]}))}),[n,e,t]),Object(s.e)((e=>M.Yb.gradebookColumn.getGradebookColumnById(e,t)))}(E,I),T=Object(en.t)(E,za.ViewGradebookMetaData),O=Object(en.g)({courseId:E,filter:{searchString:C,roleBucket:[j.y.Taking]},sort:[{field:j.gb.IsPreviewStudent,direction:j.Wb.Ascending},{field:j.gb.FamilyName,direction:j.Wb.Ascending},{field:j.gb.GivenName,direction:j.Wb.Ascending}]}),{memberships:A}=O,{users:P}=(e=>{const[t,n]=Object(i.useState)([]),{memberships:a,users:r,view:s}=e;return Object(i.useEffect)((()=>{if(a&&a.length&&!(null==s?void 0:s.isLoading)){const e=[];a.forEach((t=>{t.userId&&e.push(r[t.userId])})),n(e)}}),[null==s?void 0:s.isLoading,JSON.stringify(a)]),{users:t}})(O),x=Object(s.e)((e=>M.Yb.gradebookGrade.getGradebookGradesByColumnIdAndUserId(e,I,v)[0])),$=i.useRef((null===(t=null==x?void 0:x.instructorFeedback)||void 0===t?void 0:t.rawText)||""),N=()=>Number(S||25);i.useEffect((()=>{P&&P.length&&v&&f((()=>{const e=P.findIndex((e=>e.id===v)),t=e,n=N(),a=Math.ceil((e+1)/n).toString();return-1!==e&&y!==a&&rt.Z.search({page:a}),t})())}),[P,v]),i.useEffect((()=>{l&&x&&l(x)}),[x,l]);const D=()=>{h.current=!1,m(M.V.gradebookGrade.loadBulkView(E,[I],[A[b].id],{expand:["grade.instructorFeedback","grade.lastFeedbackAuthor"]}))},L=i.useCallback(((e=$.current)=>{var t;Object(Jn.e)(e,null===(t=null==x?void 0:x.instructorFeedback)||void 0===t?void 0:t.rawText)||(x?(async(e,t)=>{await m(us(e,{...e,instructorFeedback:{...e.instructorFeedback,rawText:t}})),D()})(x,e):(async e=>{await m(ds({columnId:I,courseId:E,userId:v,instructorFeedback:{rawText:e}})),D()})(e),d(!1,!0))}),[x,A,I,E,m,v]),{displayModal:G,modal:R}=Object(ft.lb)(ns),B=async()=>{const{confirmed:e,results:t}=await G();return e&&await L(),k.current(),t},F=()=>{var e;const t=b,n=N();rt.Z.search({userId:null===(e=P[t+1])||void 0===e?void 0:e.id,page:Math.ceil((t+2)/n).toString()}),f((e=>e+1))},U=()=>{var e;const t=b,n=N();rt.Z.search({userId:null===(e=P[t-1])||void 0===e?void 0:e.id,page:Math.ceil(t/n).toString()}),f((e=>e-1))};return i.useEffect((()=>{const e={type:Aa.c.OfflineGradesAndFeedbacksPanelOpened,status:Aa.b.Success,pageTitle:u("gradebook.gradeFeedback.offlineGradesAndFeedback.pageTitle")};Object(Aa.r)(e)}),[]),i.createElement("div",{id:"offline-grades-and-feedback-panel"},i.createElement("div",{className:p.peekPanel},i.createElement("header",{className:Object(V.a)(p.peekPanelHeader,Object(Aa.m)()&&p.hideHeader)},i.createElement(Xe.BbPanelHeader,{smallHeaderTitle:r,type:Xe.BbPanelType.peek,analyticsId:"gradebook.grade-and-feedback.offline-items-feedback-panel-header",title:null!==(n=null==w?void 0:w.columnName)&&void 0!==n?n:"",navMenuAriaLabel:u("global.navigationMenu")})),0!==P.length&&T&&-1!==b&&i.createElement(i.Fragment,null,i.createElement("div",{className:p.peekPanelBody},i.createElement("h2",null,u("gradebook.gradeFeedback.offlineGradesAndFeedback.gradesAndFeedbackTitle")),i.createElement(ls,{gradeDetail:x,student:P[b],role:null===(a=A[b])||void 0===a?void 0:a.role,membership:A[b],onGradeUpdate:o}),i.createElement(Zr,{cancelFuncRef:k,feedback:null==x?void 0:x.instructorFeedback,feedbackIsDirty:(e,t,n)=>{h.current=e,$.current=t,g.current=n,d(e,n)},onFeedbackSave:L,lastFeedbackAuthor:null==x?void 0:x.lastFeedbackAuthor,openCloudStorageIntegrationModal:c})),i.createElement(es,{onNavigateToNextFeedback:async()=>{if(b+1!==P.length)if(!h.current||g.current)F();else{await B()&&F()}},onNavigateToPreviousFeedback:async()=>{if(!(b<1))if(!h.current||g.current)U();else{await B()&&U()}},shouldDisableNextFeedback:b===P.length-1,shouldDisablePreviousFeedback:0===b}))),R)};var ps=n("8jBL");const hs=Object(Z.makeStyles)((e=>Object(Z.createStyles)({feedbackIcon:{color:e.palette.brand.main}}))),gs=e=>{const{student:t}=e,n=hs(e),a=Object(Bn.a)();return i.createElement(b.AnalyticsTooltip,{placement:"bottom-start",title:a("gradebook.gradeFeedback.offlineGradesAndFeedback.viewFeedback"),analyticsId:"gradebook.components.common.edit-feedback-tooltip.title"},i.createElement(b.AnalyticsIconButton,{analyticsId:"gradebook.components.common.edit-feedback-tooltip.icon-button",onClick:()=>{t.id&&rt.Z.goPeekState(Object(rt.W)({userId:t.id}))},"aria-label":a("gradebook.gradeFeedback.offlineGradesAndFeedback.viewFeedbackAriaLabel",{student:t})},i.createElement(ps.Feedback,{className:n.feedbackIcon})))},bs=Object(Z.makeStyles)((e=>Object(Z.createStyles)({offlineListFilters:{display:"flex",flexDirection:"column",minWidth:0,margin:"0px",[e.breakpoints.up("sm")]:{flexDirection:"row",justifyContent:"space-between",minWidth:"500px",height:"auto"}},offlineListSearchBox:{[e.breakpoints.up("sm")]:{maxWidth:"290px",margin:0,width:"100%"}},pageSizeContainer:{display:"inline-flex",alignItems:"center",borderBottom:`1px solid ${e.palette.secondary.main}`,padding:"20px 17px",[e.breakpoints.up("sm")]:{padding:0,borderBottom:"none"}},itemsPerPage:{padding:0,"& button":{border:`1px solid ${e.palette.text.hint}`,marginLeft:0,"&:hover":{border:`1px solid ${e.palette.text.hint}`}}}}))),fs=[25,50,100],vs=e=>{const{onSearchBoxTextChange:t,onPageSizeChange:n,initialPageSize:a}=e,r=bs(),o=Object(Bn.a)(),l=Object(s.e)((e=>M.Yb.app.getLocation(e).queryParams.name)),[c,d]=i.useState(l||""),u=i.useCallback((e=>{d(e),t(e)}),[t]);return i.useEffect((()=>{u(l||"")}),[l]),i.createElement("div",{className:r.offlineListFilters},i.createElement(ft.M,{value:c,inputId:"offline-items-list-search-input",label:o("gradebook.gridFiltersPanel.memberships.placeholder"),analyticsId:"gradebook.offline-grades-list.search",onChange:u,onClear:()=>u(""),className:r.offlineListSearchBox}),i.createElement("div",{className:r.pageSizeContainer},i.createElement(ft.H,{className:r.itemsPerPage,pageSizeOptions:fs,initialPageSize:a,onPageSizeChange:n,analyticsId:"gradebook.offline-grades-list.onPageSizeChange.selector"})))};n.d(t,"U",(function(){return ys})),n.d(t,"O",(function(){return Ss})),n.d(t,"f",(function(){return lt})),n.d(t,"G",(function(){return ct})),n.d(t,"C",(function(){return bt})),n.d(t,"J",(function(){return gt})),n.d(t,"K",(function(){return vn})),n.d(t,"o",(function(){return Ce})),n.d(t,"I",(function(){return Ie})),n.d(t,"H",(function(){return Te})),n.d(t,"p",(function(){return Y})),n.d(t,"s",(function(){return J})),n.d(t,"F",(function(){return q})),n.d(t,"t",(function(){return Rn})),n.d(t,"r",(function(){return Pa})),n.d(t,"e",(function(){return _a})),n.d(t,"q",(function(){return za})),n.d(t,"b",(function(){return Oi})),n.d(t,"d",(function(){return Wa})),n.d(t,"ab",(function(){return si})),n.d(t,"c",(function(){return oi})),n.d(t,"T",(function(){return li})),n.d(t,"S",(function(){return ui})),n.d(t,"W",(function(){return pi})),n.d(t,"X",(function(){return hi})),n.d(t,"g",(function(){return $i})),n.d(t,"n",(function(){return vi})),n.d(t,"m",(function(){return yi})),n.d(t,"P",(function(){return Ei})),n.d(t,"a",(function(){return ki})),n.d(t,"Y",(function(){return wi})),n.d(t,"V",(function(){return Ni})),n.d(t,"Z",(function(){return Di})),n.d(t,"R",(function(){return Gi})),n.d(t,"Q",(function(){return Ri})),n.d(t,"i",(function(){return Ui})),n.d(t,"k",(function(){return _i})),n.d(t,"j",(function(){return zi})),n.d(t,"A",(function(){return lr})),n.d(t,"B",(function(){return ur})),n.d(t,"z",(function(){return fr})),n.d(t,"N",(function(){return yr})),n.d(t,"D",(function(){return Cr})),n.d(t,"E",(function(){return Ar})),n.d(t,"l",(function(){return Nr})),n.d(t,"L",(function(){return Lr})),n.d(t,"M",(function(){return jr})),n.d(t,"u",(function(){return Br})),n.d(t,"v",(function(){return qr})),n.d(t,"x",(function(){return Zr})),n.d(t,"y",(function(){return ms})),n.d(t,"h",(function(){return gs})),n.d(t,"w",(function(){return vs}));const ys={renderDownloadSubmissionsPanel:(e,t,n)=>{r.render(i.createElement(o.a,{locale:n.locale,babelfishInstance:n.babelfishInstance,babelfishFormatInstance:n.babelfishFormatInstance,bundlesToLoad:["gradebook/locales/[locale]/gradebook.json"],isRtl:n.isRtl},i.createElement(b.AnalyticsJssThemeProvider,{isRtl:n.isRtl},i.createElement(s.a,{store:t},i.createElement(F,{...n.componentProps})))),e)},destroyComponent:e=>{r.unmountComponentAtNode(e)}},Ss=a},ZQey:function(e,t,n){"use strict";var a;n.d(t,"a",(function(){return a})),function(e){e.Open="OPEN",e.Complete="COMPLETE",e.Private="PRIVATE",e.PrivateDuration="PRIVATE_DURATION",e.PrivateDurationClassic="PRIVATE_DURATION_CLASSIC",e.OpenTermClassic="OPEN_TERM_CLASSIC",e.PrivateTermClassic="PRIVATE_CLASSIC",e.TermOpen="OPEN_TERM",e.TermComplete="COMPLETE_TERM",e.TermPrivate="PRIVATE_TERM",e.OpenClassic="OPEN_CLASSIC"}(a||(a={}))},Za2G:function(e,t){e.exports='<bb-modal class="notification" \n          modal-title-key="components.directives.fileUpload.improperAmountOfFilesTitle"\n          analytics-id-tag-prefix="components.directives.fileUpload">\n  <div name="modal-contents">\n    <p>\n      <bb-translate>components.directives.fileUpload.improperAmountOfFilesFull</bb-translate>\n    </p>\n    <div class="file-list">\n      <div ng-repeat="file in fileUpload.uploadedFiles">\n        <input ng-if="$index===0" class="toggle-input" type="radio" id="{{\'fileListing\' + $index}}" name="fileListing" value="{{$index}}" checked analytics-id="components.directives.checked.input.radio">\n        <input ng-if="$index!==0" class="toggle-input" type="radio" id="{{\'fileListing\' + $index}}" name="fileListing" value="{{$index}}" analytics-id="components.directives.not.checked.input.radio">\n        <label class="toggle-label" for="{{\'fileListing\' + $index}}" style="white-space: nowrap">{{file.name}}</label><br />\n      </div>\n    </div>\n  </div>\n  <button name="modal-footer-button-primary" role="button" class="button js-primary-button" ng-click="fileUpload.closeModal()" analytics-id="components.directives.fileUpload.uploadSelectedFile">\n    <bb-translate>components.directives.fileUpload.uploadSelectedFile</bb-translate>\n  </button>\n  <button name="modal-footer-button-secondary" role="button" class="button button--secondary js-secondary-button" ng-click="fileUpload.modalCancelUpload()" analytics-id="components.directives.fileUpload.cancelUploadText">\n    <bb-translate>components.directives.fileUpload.cancelUploadText</bb-translate>\n  </button>\n</bb-modal>\n'},Zjmk:function(e,t,n){"use strict";var a=n("ERkP"),i=n.n(a),r=n("GuFu"),s=n("tN4z"),o=n("SToD"),l=n("AuQm"),c=n("myse"),d=n("Agfx");const u=Object(d.makeStyles)((e=>Object(d.createStyles)({root:{"& #user-profile-pronouns-control-label":{fontWeight:e.typography.fontWeightBold}},description:{color:e.palette.text.hint,marginTop:"10px"}})));var m=n("50Q+");const p="user-profile-pronouns-description",h=Object(o.a)((({analyticsId:e,localize:t,approvedPronouns:n,defaultValue:a,onPronounsChanged:r})=>{const{translate:o}=t,d=u(),[h,g]=i.a.useState([]),[b,f]=i.a.useState([]);i.a.useEffect((()=>{g(n.map((e=>({value:e.name,label:e.name})))),f(a.map((e=>({value:e,label:e}))))}),[n,a]);const v=i.a.useCallback((e=>o("userProfile.pronouns.tagpicker.aria.itemRemoved",{pronoun:e.label})),[o]),y=i.a.useCallback((e=>{const t=null!=e?e:[];f(t),r(t)}),[r]),S=Object(c.useAnalyticsAugmentEventOnElement)(c.AnalyticsEventTypes.CLICK_EVENT,(()=>{}),`${e}.open.picker`);return i.a.createElement(i.a.Fragment,null,i.a.createElement(l.J,{styles:{input:e=>({...e,...m.n})},isMulti:!0,classes:{root:d.root},analyticsId:e,isClearable:!1,removeTagAriaLabel:v,inputId:"user-profile-pronouns-control",label:o("userProfile.pronouns.tagpicker.label"),placeholder:o("userProfile.pronouns.tagpicker.placeholder"),noOptionsMessage:()=>o("userProfile.pronouns.tagpicker.pickerSuggestion.noPronounsFound"),value:b,options:h,onChange:y,onMenuOpen:S,"aria-describedby":p}),i.a.createElement(s.AnalyticsTypography,{id:p,className:d.description,component:"p"},o("userProfile.pronouns.description")))}));var g=n("uDfI"),b=n("IbyE"),f=n("zGdY");const v=Object(d.makeStyles)((e=>Object(d.createStyles)({requestPronounDescriptionRoot:{marginTop:"10px"},requestPronounFormRoot:{width:"100%",marginTop:"15px"},requestPronounsFormInputRoot:{"&$requestPronounsFormInputRoot":{paddingRight:0}},requestPronounsFormInputLabel:{fontWeight:e.typography.fontWeightBold},requestPronounsFormInputSendButton:{borderRadius:0}}))),y=Object(o.a)((({localize:e,analyticsId:t,approvedPronouns:n})=>{const i=v(),[r,o]=a.useState(""),[l,c]=a.useState(""),[d,u]=a.useState(!1),[m,p]=a.useState(!1),h=Object(g.d)(),y=a.useCallback((t=>{const a=t.target.value;o(a);!(null==n?void 0:n.find((e=>{var t;return 0===(null===(t=null==e?void 0:e.name)||void 0===t?void 0:t.localeCompare(a))})))?""!==l&&c(""):c(null==e?void 0:e.translate("userProfile.pronouns.request.pronounExists"))}),[n,l,e]),S=a.useCallback((()=>{h(b.V.userPronouns.addSystemPronoun({name:r,status:f.Ib.Pending})).then((()=>{c(""),p(!0)})).catch((t=>{t instanceof b.U&&c(null==e?void 0:e.translate("admin-pages.approved-pronouns.list.add-option-xss-violation"))}))}),[r,h,e]),C=d&&m,E=d&&!m,I=!d,k={};return""!==l&&(k.error=!0,k.helperText=l),a.createElement(a.Fragment,null,C&&a.createElement(s.AnalyticsTypography,{className:i.requestPronounDescriptionRoot,"aria-live":"polite",role:"status"},null==e?void 0:e.translate("userProfile.pronouns.request.sent")),E&&a.createElement(a.Fragment,null,a.createElement(s.AnalyticsTextField,{classes:{root:i.requestPronounFormRoot},analyticsId:`${t}.request.inputField`,id:"request-new-pronouns",label:null==e?void 0:e.translate("userProfile.pronouns.request.label"),placeholder:null==e?void 0:e.translate("userProfile.pronouns.request.placeholder"),value:r,onChange:y,...k,InputLabelProps:{classes:{root:i.requestPronounsFormInputLabel}},InputProps:{endAdornment:a.createElement(s.AnalyticsInputAdornment,{analyticsId:`${t}.input.adornment`,id:"send-pronoun-request",position:"end",disableTypography:!0},a.createElement(s.AnalyticsPrimaryButton,{classes:{root:i.requestPronounsFormInputSendButton},onClick:S,analyticsId:`${t}.request.send`,disabled:""!==l||""===r},null==e?void 0:e.translate("userProfile.pronouns.request.sendLabel"))),classes:{root:i.requestPronounsFormInputRoot}}})),I&&a.createElement(s.AnalyticsTypography,{className:i.requestPronounDescriptionRoot},(null==e?void 0:e.translate("userProfile.pronouns.request.description"))+" ",a.createElement(s.AnalyticsLink,{analyticsId:`${t}.pronouns.request.show.inputField`,"aria-label":null==e?void 0:e.translate("userProfile.pronouns.request.makeRequestAriaLabel"),component:"button",onClick:()=>u(!0)},null==e?void 0:e.translate("userProfile.pronouns.request.makeRequest"))))})),S=Object(o.a)((e=>{const{localize:t,currentLocale:n,babelfishInstance:i,babelfishFormatInstance:o,isRtl:l,...c}=e,d=Object(r.x)(),u=Object(r.A)(),m=d.loading||u.loading;return a.createElement("div",null,m&&a.createElement(s.AnalyticsCircularProgress,{ariaLabel:t.translate("userProfile.pronouns.loadingAriaLabel"),size:"small"}),!m&&a.createElement(a.Fragment,null,a.createElement(h,{...c,analyticsId:"userProfile.pronouns.TagPicker",approvedPronouns:u.list}),d.enabled&&a.createElement(y,{approvedPronouns:u.list,analyticsId:"userProfile.pronouns"})))}));function C(e){return(e.pronouns||"").split(",").map((e=>e.trim())).join(", ")}var E=n("yQJI");const I=Object(o.a)((e=>{const{localize:t,onAudioRecorded:n,onAudioDeleted:i,src:r}=e,s=new E.b((e=>n(e)));return a.createElement(l.E,{recordLabel:t.translate("userProfile.pronunciation.recordButtonLabel"),playLabel:t.translate("userProfile.pronunciation.playButtonLabel"),onAudioDeleted:i,analyticsId:"userProfile.pronunciation",recordingSession:s,src:r})}));n.d(t,"b",(function(){return S})),n.d(t,"c",(function(){return C})),n.d(t,"a",(function(){return I}))},"ZzN+":function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return c}));var a=n("Llzl"),i=n("5MwF"),r=n("pjml"),s=n("0+Qs"),o=n("zGdY");const l="ultra.service.course.conversion",c="courseConversion";class d{constructor(e,t,n,a,i,r){this.interval=e,this.CourseModel=t,this.$modal=n,this.$q=a,this.$rootScope=i,this.ScheduledTaskModel=r,this.showPreviewAlert=!0,this.taskCache={},this.queuedTaskCache={}}_getConversionTask(e){return this.ScheduledTaskModel.$find(e)}isPreview(e){return!e.isOpen()&&e.isUltraPreview()}isConversionComplete(e){return!e||(e===o.Ob.Complete||e===o.Ob.CompleteErrors)}isConversionSuccess(e){return!e||e===o.Ob.Complete}setCheckConversionIntervalIfNotExist(e,t){this.taskCache[e.courseId]||this.setCheckConversionInterval(e,t)}setCheckConversionInterval(e,t){const n=this.cancelConversionInterval(e);this.removeQueuedTaskFromCache(e),void 0===t&&n&&(t=n.onCompleteCallback),e.refreshConvertToUltraStatus().then((n=>{this.queuedTaskCache[e.courseId]=n.ui.convertToUltraTaskId,this._getConversionTask(this.queuedTaskCache[e.courseId]).$then((n=>{this.setUpIntervalToPollForConversionTaskCompletion(n,e,t)}))}))}setUpIntervalToPollForConversionTaskCompletion(e,t,n){const a=e.taskTitle;if(a&&(a.indexOf("ConvertTOUltraQueuedOperation")>=0||a.indexOf("UndoUltraQueuedOperation")>=0)){let a;const r=()=>{a()};if(a=()=>{this._getConversionTask(e.taskId).$then((e=>{const n=e.taskStatus.toString(),a=this.isConversionComplete(n),i=this.isConversionSuccess(n);if(a){const r=this.cancelConversionInterval(t);this.removeQueuedTaskFromCache(t),r&&r.onCompleteCallback&&r.onCompleteCallback(n,{complete:a,success:i,taskId:e.taskId,taskTitle:e.taskTitle})}}))},!this.taskCache[t.courseId]){const e=i.a.production?6e4:6e3;this.taskCache[t.courseId]={interval:this.interval(r,this.$rootScope,e),onCompleteCallback:n}}}}cancelConversionInterval(e){const t=this.taskCache[e.courseId];return t&&(this.interval.cancel(t.interval),this.taskCache[e.courseId]=null),t}removeQueuedTaskFromCache(e){delete this.queuedTaskCache[e.courseId]}}d.$inject=[s.b,r.m.serviceName,"$modal","$q","$rootScope",r.nb.serviceName];a.module(l,[r.N,s.a]).service(c,d)},ZzR9:function(e,t,n){"use strict";var a,i;n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i})),function(e){e.$stateChangeError="$stateChangeError",e.$stateChangeStart="$stateChangeStart",e.$stateChangeSuccess="$stateChangeSuccess",e.$stateNotFound="$stateNotFound",e.$stateHasCourseInContextChanged="$stateHasCourseInContextChanged",e.$stateHasContentInContextChanged="$stateHasContentInContextChanged"}(a||(a={})),function(e){e.$locationChangeStart="$locationChangeStart",e.$locationChangeSuccess="$locationChangeSuccess"}(i||(i={}))},ZzYr:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n("D57K"),i=n("TnpK"),r=n("Qbdf"),s=n("aHpC"),o=n("Llzl");const l="ultra.components.directives.courseOrgTokenReplacementDirective",c=[{coursePrefix:"base.baseCourses",orgPrefix:"base.baseOrganizations"},{coursePrefix:"base.courses",orgPrefix:"base.organizations"},{coursePrefix:"course",orgPrefix:"organization"},{coursePrefix:"components.directives.message",orgPrefix:"components.directives.message.organization"},{coursePrefix:"components.directives.learning-module.ghost-panel",orgPrefix:"components.directives.learning-module.orgs-ghost-panel"},{coursePrefix:"components.directives.calendar",orgPrefix:"components.directives.calendar.organization"},{coursePrefix:"components.directives.content-visibility",orgPrefix:"components.directives.content-visibility.organization"},{coursePrefix:"components.directives.grade",orgPrefix:"components.directives.grade.organization"}];class d{constructor(e,t,n,a,i){this.element=e,this.attributes=t,this.scope=n,this.ultraState=a,this.currentCourse=i;try{if((a.includes("base.organizations.**")||i.course&&i.course.isOrganization)&&(t.bbTranslate&&(t.bbTranslate=this.replaceToken(t.bbTranslate),e.attr("bb-translate",this.replaceToken(t.bbTranslate))),t.bbTranslateAttrs)){let n=t.bbTranslateAttrs;o.forEach(this.scope.$eval(n),(e=>{n=n.replace(e,this.replaceToken(e))})),t.bbTranslateAttrs=n,e.attr("bb-translate-attrs",n)}}catch(e){}}replaceToken(e){if(e){const t=c.find((t=>e.startsWith(t.coursePrefix)));if(t)return e.replace(t.coursePrefix,t.orgPrefix)}return e}}let u=class{constructor(e,t){this.ultraState=e,this.currentCourse=t,this.restrict="A",this.scope=!1,this.priority=-1,this.compile=()=>(e,t,n)=>new d(t,n,e,this.ultraState,this.currentCourse)}};u=Object(a.a)([Object(a.c)(0,Object(s.b)(i.d)),Object(a.c)(1,Object(s.b)(r.e))],u),o.module(l,[i.b]).directive("courseOrgTokenResolver",["$injector",e=>e.instantiate(u)])},aD4H:function(e,t){e.exports='<ng-form name="baseForm" bb-autosave save-func="saveForm.save()" validation-func="saveForm.validate()" delay-autosave="delayAutosave()"\n         debounce-save-destination="debounceSaveDestination()" novalidate>\n    <div ng-transclude />\n    <bb-save-buttons validate-save="saveForm.validate()"\n                     save-action="saveForm.saveClicked()"\n                     cancel-action="saveForm.cancelClicked()"\n                     delete-action="saveForm.deleteClicked()"\n                     hide-save="hideFooter"\n                     hide-cancel="hideFooter"\n                     mousedown-action="saveForm.mouseDown()"\n                     can-delete="canDelete"\n                     display-delete-after-saving="displayDeleteAfterSaving()"\n                     delete-confirmation-resource-type="{{deleteConfirmationResourceType}}"\n                     must-show-delete-confirmation="true"\n                     choices="choices"\n                     analytics-id-tag-prefix="{{::analyticsIdTagPrefix}}.saveForm">\n                          \x3c!-- TODO: will update the above must-show-delete-confirmation after PR #818 (update confirmation needed) is merged --\x3e\n    </bb-save-buttons>\n</ng-form>\n'},aHpC:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return s})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return l}));var a=n("nsO7");function i(e,...t){const n=Symbol(e.name);return function(a,i,r){const s=r.value;r.value=function(...a){return this[n]=this[n]||e.apply(null,[s].concat(t||[])),this[n].apply(this,a)}}}const r=function(e){return i(a.debounce,e)},s=function(...e){return function(t,n,i){const r=i.value,s=Symbol("@ScopeOnce("+t.constructor.name+"."+n+")"),o=Symbol("@ScopeOnce("+t.constructor.name+"."+n+")");i.value=function(...t){const n=this,i=n.$scope||n.scope;if(!i)throw new Error("NO_SCOPE_FOUND");return Object(a.isEmpty)(e)||(n[o]=n[o]||Object(a.once)((()=>{i.$watchGroup(e,(()=>{n[s]=null}))})),n[o]()),n[s]=n[s]||Object(a.once)((function(...e){return r.apply(n,e)})),n[s].apply(n,t)}}},o=function(e){if(!e)throw new Error("Empty name is not accepted");return function(t,n,a){if("function"!=typeof t)throw new Error("@Inject only supports constructor arguments");t.$inject=t.$inject||[],t.$inject[a]=e}},l=function(){return function(e,t,n){const a=n.value;n.value=function(...e){const t=a.apply(this,e),n=this.$injector;if(!n)throw new Error("$injector NotFound, the decorator requires $injector to be injected into class.");n.invoke(["$rootScope","$q",(e,n)=>{n.when(t).then((()=>e.$applyAsync()))}])}}}},aLuL:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 38 38" xml:space="preserve"><path fill="#C26FD2" d="M3 3.5V34c0 2.2 1.8 4 4 4h22c2.2 0 4-1.8 4-4V3.5H3z"/><path fill="#955CA1" d="M33 7H6.5A3.51 3.51 0 0 1 3 3.5 3.51 3.51 0 0 1 6.5 0H33v7z"/><path fill="#955CA1" d="M7 3.5H3V34c0 2.2 1.8 4 4 4V3.5z"/><path fill="#DFF1FF" d="M3.164 4.5C3.599 5.938 4.925 7 6.5 7H33V2H6.5C4.925 2 3.599 3.062 3.164 4.5z"/><path fill="#D498DF" d="M32 1v5H6.5C5.122 6 4 4.878 4 3.5S5.122 1 6.5 1H32m1-1H6.5C4.575 0 3 1.575 3 3.5S4.575 7 6.5 7H33V0z"/><path fill="#DFF1FF" d="M32 2h1v4h-1z"/><path fill="none" stroke="#C4DAE8" stroke-linecap="round" stroke-miterlimit="10" d="M7.5 4.5h25"/><path fill="#955CA1" d="M31 1h2v1h-2zM9.022 4h4.312v2H9.022z"/><path fill="#7B5080" d="M27.82 32.431h-1.026c.119-.186.206-.395.206-.631V7h-8.01v22.462l6.211 3.377c.149.086.315.129.486.146v.008h.063c.016.001.032.007.05.007.012 0 .021-.006.033-.007h1.988v-.562zm-2.018-.432L25.8 32l.002-.001z"/><path fill="#7B5080" d="M11 7h-1v24.8c0 .63.493 1.134 1.111 1.182v.011h.056c.012 0 .021.007.033.007.017 0 .034-.006.051-.007h1.018v-.265h-.266L19 28.924l.014.008V7H11zm.201 25-.004-.001.004.001zm.105-.031c-.004.003-.009.002-.014.004.005-.002.01-.001.014-.004L19 27.785l-7.694 4.184z"/><path fill="#965CA1" d="M28 7H11v24.8a1.202 1.202 0 0 0 1.799 1.039L20 28.924l7.201 3.916A1.201 1.201 0 0 0 29 31.8V7h-1zM12.055 31.928zm.142.071.004.001H12.2l-.003-.001zM20 27.785l-7.694 4.184c-.004.003-.009.002-.014.004.005-.002.009-.001.014-.004L20 27.785l7.694 4.184c.004.003.009.002.014.004-.004-.002-.009-.001-.014-.004L20 27.785zM27.799 32l.004-.001-.004.001zm.123-.05.023-.022a.12.12 0 0 1-.023.022z"/><path fill="#C26FD2" d="m20.006 14 1.547 3.135 3.46.502-2.504 2.44.591 3.446-3.094-1.627-3.094 1.627.591-3.446L15 17.637l3.459-.502z"/><path fill="#FFF" d="M23.101 24.022a.49.49 0 0 1-.232-.058l-2.862-1.505-2.861 1.505a.5.5 0 0 1-.725-.527l.547-3.186-2.314-2.256a.5.5 0 0 1 .276-.854l3.199-.465 1.431-2.899c.168-.34.729-.34.896 0l1.432 2.899 3.199.465a.5.5 0 0 1 .276.854l-2.314 2.256.547 3.186a.5.5 0 0 1-.495.585zm-3.095-2.627c.08 0 .16.02.232.058l2.198 1.155-.42-2.446a.5.5 0 0 1 .145-.443l1.777-1.732-2.457-.356a.5.5 0 0 1-.376-.273l-1.1-2.227-1.099 2.227a.5.5 0 0 1-.376.273l-2.457.356 1.777 1.732c.118.115.172.28.145.443l-.42 2.446 2.197-1.155a.513.513 0 0 1 .234-.058z"/><path fill="#C26FD2" d="M28.984 7H11.022l-2-3h17.962z"/><path fill="none" stroke="#C4DAE8" stroke-linecap="round" stroke-miterlimit="10" d="M7.5 2.5h25"/></svg>'},abE0:function(e,t){e.exports='<bb-modal class="notification" modal-translate-options="modalTranslateOptions"\n          modal-aria-type="{{modalAriaType}}"\n          analytics-id-tag-prefix="components.directives.confirmationNeeded">\n  <div name="modal-contents">\n    <p ng-bind-html="::modalStrings.instructions"></p>\n    <div ng-show="confirmationNeeded.choices && confirmationNeeded.choices.length > 0" ng-repeat="choice in confirmationNeeded.choices">\n      <input id="{{choice.key}}" ng-disabled="choice.isDisable" ng-model="choice.value" type="checkbox" analytics-id="components.directives.confirmationNeeded.input.checkbox"/>\n      <label for="{{choice.key}}" bb-translate="{{choice.localizedKey}}"></label>\n    </div>\n  </div>\n  <button name="modal-footer-button-primary" class="button confirm-ok js-primary-button" ng-click="okAction()" analytics-id="primary.button.okAction.button">{{::modalStrings.ok}}</button>\n  <button name="modal-footer-button-secondary" class="button button--secondary confirm-cancel js-secondary-button" ng-click="cancelAction()" analytics-id="secondary.button.cancelAction.button">{{::modalStrings.cancel}}</button>\n</bb-modal>\n'},adx1:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n("nsO7");class i{constructor(){this.events=Object.create(null)}$onEvent(e,t){return this.events[e]=this.events[e]||[],this.events[e].push(t),a.once((()=>{a.remove(this.events[e],(e=>e===t))}))}$emitEvent(e,...t){const n={type:e};(this.events[e]||[]).forEach((e=>{e.call(this,n,...t)}))}}},ajRr:function(e,t){e.exports='<svg width="199" height="200" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M99.5 0C154.45 0 199 44.55 199 99.5S154.45 199 99.5 199 0 154.45 0 99.5 44.55 0 99.5 0Z" fill="#E3F4FC"/><path fill-rule="evenodd" clip-rule="evenodd" d="M7.01 137.07c14.78 36.42 50.5 62.11 92.23 62.11 41.73 0 77.45-25.69 92.23-62.11H7.01Z" fill="#D2EDFA"/><path d="M139.71 158.59h-77c-2.21 0-4-1.79-4-4v-108c0-2.21 1.79-4 4-4h77c2.21 0 4 1.79 4 4v108c0 2.21-1.79 4-4 4Z" fill="#545C61"/><path d="M139.71 158.59h-77c-2.21 0-4-1.79-4-4v-104c0-2.21 1.79-4 4-4h77c2.21 0 4 1.79 4 4v104c0 2.21-1.79 4-4 4Z" fill="#3F4549"/><path d="M63.71 60.59a4 4 0 1 0 0-8 4 4 0 0 0 0 8Z" fill="#2F3437"/><path d="M54.69 58.59h9.04c1.09 0 1.98-.89 1.98-1.98v-.04c0-1.09-.89-1.98-1.98-1.98h-9.04c-1.09 0-1.98.89-1.98 1.98v.04c0 1.09.89 1.98 1.98 1.98Z" fill="#C1C1BC"/><path opacity=".2" d="M63.73 54.59h-2c1.09 0 1.98.89 1.98 1.98v.04c0 1.09-.89 1.98-1.98 1.98h2c1.09 0 1.98-.89 1.98-1.98v-.04c0-1.1-.89-1.98-1.98-1.98Z" fill="#000"/><path d="M63.71 82.59a4 4 0 1 0 0-8 4 4 0 0 0 0 8Z" fill="#2F3437"/><path d="M54.69 80.59h9.04c1.09 0 1.98-.89 1.98-1.98v-.04c0-1.09-.89-1.98-1.98-1.98h-9.04c-1.09 0-1.98.89-1.98 1.98v.04c0 1.09.89 1.98 1.98 1.98Z" fill="#C1C1BC"/><path opacity=".2" d="M63.73 76.59h-2c1.09 0 1.98.89 1.98 1.98v.04c0 1.09-.89 1.98-1.98 1.98h2c1.09 0 1.98-.89 1.98-1.98v-.04c0-1.1-.89-1.98-1.98-1.98Z" fill="#000"/><path d="M63.71 104.59a4 4 0 1 0 0-8 4 4 0 0 0 0 8Z" fill="#2F3437"/><path d="M54.69 102.59h9.04c1.09 0 1.98-.89 1.98-1.98v-.04c0-1.09-.89-1.98-1.98-1.98h-9.04c-1.09 0-1.98.89-1.98 1.98v.04c0 1.09.89 1.98 1.98 1.98Z" fill="#C1C1BC"/><path opacity=".2" d="M63.73 98.59h-2c1.09 0 1.98.89 1.98 1.98v.04c0 1.09-.89 1.98-1.98 1.98h2c1.09 0 1.98-.89 1.98-1.98v-.04c0-1.1-.89-1.98-1.98-1.98ZM63.73 120.59h-2c1.09 0 1.98.89 1.98 1.98v.04c0 1.09-.89 1.98-1.98 1.98h2c1.09 0 1.98-.89 1.98-1.98v-.04c0-1.1-.89-1.98-1.98-1.98Z" fill="#000"/><path d="M63.71 148.59a4 4 0 1 0 0-8 4 4 0 0 0 0 8Z" fill="#2F3437"/><path d="M54.69 146.59h9.04c1.09 0 1.98-.89 1.98-1.98v-.04c0-1.09-.89-1.98-1.98-1.98h-9.04c-1.09 0-1.98.89-1.98 1.98v.04c0 1.09.89 1.98 1.98 1.98Z" fill="#C1C1BC"/><path opacity=".2" d="M63.73 142.59h-2c1.09 0 1.98.89 1.98 1.98v.04c0 1.09-.89 1.98-1.98 1.98h2c1.09 0 1.98-.89 1.98-1.98v-.04c0-1.1-.89-1.98-1.98-1.98Z" fill="#000"/><path d="M120.73 102.59H83.69c-1.09 0-1.98-.89-1.98-1.98v-.04c0-1.09.89-1.98 1.98-1.98h37.04c1.09 0 1.98.89 1.98 1.98v.04c0 1.09-.89 1.98-1.98 1.98ZM109.73 112.59H93.69c-1.09 0-1.98-.89-1.98-1.98v-.04c0-1.09.89-1.98 1.98-1.98h16.04c1.09 0 1.98.89 1.98 1.98v.04c0 1.09-.89 1.98-1.98 1.98ZM120.73 92.59H83.69c-1.09 0-1.98-.89-1.98-1.98v-.04c0-1.09.89-1.98 1.98-1.98h37.04c1.09 0 1.98.89 1.98 1.98v.04c0 1.09-.89 1.98-1.98 1.98Z" fill="#545C61"/><path d="M143.71 69.59v-17l3.26 1.09a4 4 0 0 1 2.74 3.79v7.23c0 1.72-1.1 3.25-2.74 3.79l-3.26 1.1Z" fill="#39E079"/><path d="M143.71 87.59v-17l3.26 1.09a4 4 0 0 1 2.74 3.79v7.23c0 1.72-1.1 3.25-2.74 3.79l-3.26 1.1Z" fill="#26D4FA"/><path d="M143.71 106.59v-17l3.26 1.09a4 4 0 0 1 2.74 3.79v7.23c0 1.72-1.1 3.25-2.74 3.79l-3.26 1.1Z" fill="#C26FD2"/><path opacity=".2" d="m145.71 53.25-2-.66v17l2-.67V53.25ZM145.71 71.25l-2-.66v17l2-.67V71.25ZM145.71 90.25l-2-.66v17l2-.67V90.25Z" fill="#000"/><path d="M49.14 123.43a.996.996 0 0 1-1.41 0l-21.57-21.57a3 3 0 0 1 0-4.24l2.12-2.12a.996.996 0 1 1 1.41 1.41l-2.12 2.12a.996.996 0 0 0 0 1.41l21.57 21.57c.39.4.39 1.03 0 1.42Z" fill="#EB5840"/><path opacity=".2" d="M49.14 123.43a.996.996 0 0 1-1.41 0l-21.57-21.57a3 3 0 0 1 0-4.24l2.12-2.12a.996.996 0 1 1 1.41 1.41l-2.12 2.12a.996.996 0 0 0 0 1.41l21.57 21.57c.39.4.39 1.03 0 1.42Z" fill="#000"/><path d="m96.87 151.36-7.07 7.07-38.88-38.9 7.06-7.06 38.89 38.89Z" fill="#F9F9F9"/><path opacity=".2" d="m93.34 154.9-3.54 3.53-38.88-38.89 3.53-3.53 38.89 38.89Z" fill="#000"/><path d="M106.04 166c.44.44.44 1.16 0 1.6-.44.44-1.16.44-1.6 0l-2.98-2.98c-.44-.44-.44-1.16 0-1.6.44-.44 1.16-.44 1.6 0l2.98 2.98Z" fill="#3E3E3E"/><path d="m58.69 111.76-8.49 8.49-24.79-24.79a5.939 5.939 0 0 1 0-8.4l.08-.08a5.939 5.939 0 0 1 8.4 0l24.8 24.78ZM103.95 165.48l-.03.03c-.82.82-2.09.96-3.07.33l-10.12-6.48 7.07-7.07 6.48 10.12c.62.98.49 2.25-.33 3.07Z" fill="#EB5840"/><path opacity=".2" d="m57.98 112.47-7.071 7.071.707.707 7.071-7.071-.707-.707Z" fill="#000"/><path opacity=".2" d="m25.45 87.02-.04.04a5.939 5.939 0 0 0 0 8.4l24.79 24.79 4.24-4.24-28.99-28.99ZM94.26 155.82l-3.54 3.54 10.12 6.48c.97.62 2.25.49 3.07-.33l.01-.01-9.66-9.68Z" fill="#000"/><path d="m98.29 152.77-7.09 7.09a.984.984 0 0 1-1.4 0l-.01-.01a.984.984 0 0 1 0-1.4l7.09-7.09a.984.984 0 0 1 1.4 0l.01.01c.39.39.39 1.01 0 1.4Z" fill="#EB5840"/><path opacity=".2" d="m93.34 154.9-3.54 3.54a.984.984 0 0 0 0 1.4l.01.01c.39.39 1.01.39 1.4 0l3.54-3.54-1.41-1.41Z" fill="#000"/><path opacity=".2" d="m98.73 153.75-.55-.87-6.86 6.86.86.55 6.55-6.54Z" fill="#000"/><path opacity=".1" d="M103.73 175.59H60.69c-1.09 0-1.98-.89-1.98-1.98v-.04c0-1.09.89-1.98 1.98-1.98h43.04c1.09 0 1.98.89 1.98 1.98v.04c0 1.09-.89 1.98-1.98 1.98Z" fill="#000"/></svg>'},aohr:function(e,t,n){"use strict";var a;!function(e){e.CcAdvisors="CC_ADVISORS",e.DisableAdvisorViewAllStudents="DISABLE_ADVISOR_VIEW_ALL_STUDENTS",e.EmailBranding="EMAIL_BRANDING",e.EmailSender="EMAIL_SENDER",e.EnableLogOut="ENABLE_LOG_OUT",e.InstructorViewMajorDegreeColumn="INSTRUCTOR_VIEW_MAJOR_DEGREE_COLUMN",e.OverrideLanguagePack="OVERRIDE_LANGUAGE_PACK",e.TypeaheadCourseLimit="TYPEAHEAD_COURSE_LIMIT",e.TypeaheadStudentLimit="TYPEAHEAD_STUDENT_LIMIT"}(a||(a={})),t.a=a},b2lU:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));var a=n("0JpG");const i="fileUtility",r="FileUtilFactory";var s;!function(e){e.bytes="components.directives.fileUpload.bytes",e.GB="components.directives.fileUpload.GB",e.KB="components.directives.fileUpload.KB",e.MB="components.directives.fileUpload.MB"}(s||(s={}));class o{constructor(e,t){this.bbLocalize=e,this.$q=t,this.calculateSize=e=>{let t=s.bytes;return e>1e3&&(e/=1e3,t=s.KB,e>1e3&&(e/=1e3,t=s.MB,e>1e3&&(e/=1e3,t=s.GB))),{size:e,sizeLabel:t}}}getLocalizedSize(e,t,n=1){const a=this.calculateSize(e),i=this.bbLocalize.translateSync({locale:t,key:a.sizeLabel}),r=this.bbLocalize.translateSync({locale:t,key:"global.localizedNumber",params:{number:a.sizeLabel===s.bytes?a.size:parseFloat(a.size.toFixed(n))},noWrap:!0});return this.bbLocalize.translateSync({locale:t,key:"components.directives.fileUpload.sizeOutput",params:{size:r,label:i},noWrap:!0,noEscape:!0})}}o.$inject=[a.serviceName,"$q"],angular.module(i,[a.moduleName]).factory(r,["$injector",e=>function(){return e.instantiate(o)}])},bF8R:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return m}));var a=n("nsO7"),i=n("Llzl"),r=n("pjml"),s=n("fYJU"),o=n("o5Lu"),l=n("Bu0u"),c=n("zGdY"),d=n("0JpG");const u="ultra.components.services.courseContent",m="courseContent";class p{constructor(e,t,n,a,i,r,s){this.$q=e,this.$rootScope=t,this.$log=n,this.grade=a,this.contextUser=i,this.UserModel=r,this.bbLocalize=s,this.contentDataResult=new h}loadContentAndGrades(e){let t;if(e.content)t=e.content.$asPromise&&e.content.$asPromise()||this.$q.when(e.content);else{if(!e.contentId)throw new l.a({message:"Content or contentId must be provided."});{const n="assignedGroups,selfEnrollmentGroups.group"+(e.contentExtraExpand?","+e.contentExtraExpand:"");t=e.course.contents.$find(e.contentId,{expand:n}).$asPromise()}}if(!this.contextUser.userId)throw new l.a({message:"There is no userId in the context."});return t.then((t=>{const n=new h;return n.courseContent=t,n.groupMembers=[],e.column?n.gradingColumn=e.column:n.gradingColumn=e.course.gradebook.columns.$buildRaw(t.getAssociatedGradingColumn(e.columnId)),n.gradingColumn.rubricAssociations||n.gradingColumn.$fetch({expand:"associatedRubrics"}).$asPromise().then((e=>{n.gradingColumn.rubricAssociations=e.rubricAssociations})),this.grade.loadGrade({attemptQueryParams:{expand:"toolAttemptDetail,alignedGoals,members,attempts,attempts.toolAttemptDetail,lastFeedbackAuthor,attempts.lastFeedbackAuthor",overrideAggregationModel:r.C.AttemptAggregationModel.Last},gradeQueryParams:{expand:"attemptsLeft"},courseId:e.course.id,column:n.gradingColumn,content:n.courseContent,userId:this.contextUser.userId},!0).then((i=>{if(n.submitter=this.contextUser.userModel,i){if(n.gradeDetail=i,n.attempt=i.ui.attempt,n.groupAttempt=i.ui.groupAttempt,t.isGroupContent)return this.getGroupMembers(e.course,t,n.groupAttempt).then((e=>(n.groupMembers=e,n.groupAttempt&&(n.submitter=a.find(e,(e=>e.id===n.groupAttempt.submittedBy)),!n.submitter&&(n.submitter=null,n.groupAttempt.submittedBy))?this.UserModel.$find(n.groupAttempt.submittedBy).$then((e=>{n.submitter=e||null}),(e=>this.$log.error(e.$response))).$asPromise().then((()=>n)):n)))}else if(t.isGroupContent)return this.getGroupMembers(e.course,t).then((e=>(n.groupMembers=e,n)));return n}))}))}getGroupMembers(e,t,n){return t.assignedGroups&&t.assignedGroups.length>0?e.groups.$find(t.assignedGroups[0].groupId,{expand:"memberships",excludeUnavailableMembers:!0}).$asPromise().then((t=>e.memberships.$refresh({fields:"id, user, courseRole",roleBucket:c.y.Taking}).$asPromise().then((e=>this.sortGroupMembers(e,t))))):this.$q.when([])}sortGroupMembers(e,t){const n={},a=[];let i=t.memberships||t.members;e.forEach((e=>{e.user&&(e.user.ui=e.user.ui||{},n[e.user.id]=e.user)}));const r=[];return i.forEach((e=>{const t=e.userId||e,a=n[t];if(a){const e=this.bbLocalize.formatUsername(a,d.ILocaleUsernameFormat.Short,this.$rootScope);r.push(e),e.then((e=>{a.ui.formatUserName=e}))}})),this.$q.all(r).then((()=>(i=i.filter((e=>!!n[e.userId||e])),i.sort(((e,t)=>{const a=e.userId||e,i=t.userId||t;return n[a].ui.formatUserName.localeCompare(n[i].ui.formatUserName)})),i.forEach((e=>{const t=e.userId||e;n[t]&&(a.push(n[t]),delete n[t])})),a)))}}p.$inject=["$q","$rootScope","$log",o.n,s.b,r.Jb.serviceName,d.serviceName];class h{}i.module(u,[r.N,s.a]).service(m,p)},bMxM:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return h}));var a=n("D57K"),i=n("Llzl"),r=n("pjml"),s=n("P2dS"),o=n("IbyE"),l=n("zGdY"),c=n("VAMW"),d=n("6fZB"),u=n("vhkR"),m=n("aHpC");const p="ultra.components.services.courseContentIconService",h="courseContentIconService",g=["-a","-c","-o","-hc"].join("|").replace(/-/g,""),b=new RegExp(`-(${g})$`,"g");class f{constructor(e){this.service=e,this.key=c.d.ContentIcon}getIconClass(e){return Object(d.a)(this.service.getIconClass(e))}}let v=class e{constructor(e,t,n){this.$q=e,this.gradeColumnCategory=t,this.ltiService=n,Object(c.f)(new f(this))}getIconClass(t){const n=r.p.ContentHandler;let a,i="";if(t&&t.contentHandler){const s=t.contentHandler.toString(),c=n.parse(s);i=c&&c.iconClass;const d=t.getAssociatedGradingColumn?t.getAssociatedGradingColumn():null;if(d&&d.gradebookCategory&&d.gradebookCategory.title)i=this.getColumnIconClassAsString(d);else if(t.contentDetail){if(n.File.isEqualTo(c)){const a=t.contentDetail[n.File.toString()]&&t.contentDetail[n.File.toString()].file&&t.contentDetail[n.File.toString()].file.mimeType||"";i=e.fileMIMETypeToIconClass[a]=e.fileMIMETypeToIconClass[a]||Object(o.yb)(a)}if(n.CourseLink.isEqualTo(c)&&(a=t.getLinkContentSource().$then((e=>{const t=n.parse(e.contentHandler.toString());i=t&&t.iconClass}))),n.LtiLink.isEqualTo(c)){const e=o.C.isCloudDocument(t),a=o.C.getCloudDocumentType(t),r=a===l.yb.CloudCollaboration&&e,s=a===l.yb.Embedded&&e;r?i=n.CollaborativeCloudDocumentPlacement.iconClass:s&&(i=n.CloudDocumentPlacement.iconClass)}}n.Folder.isEqualTo(c)&&(i=t.contentDetail&&t.contentDetail[n.Folder.toString()]&&t.contentDetail[n.Folder.toString()].isBbPage?n.Document.iconClass:t.ui&&t.ui.isOpen?r.p.FolderContentHandlerIcon.OpenFolder.toString():r.p.FolderContentHandlerIcon.ClosedFolder.toString())}return a?a.$asPromise().then((()=>this.$q.when(i||e.DEFAULT_ICON_CLASS))):this.$q.when(i||e.DEFAULT_ICON_CLASS)}getColumnIconClassAsString(t){var n,a,i;let r="";const c=(null===(n=t.isDiscussion)||void 0===n?void 0:n.call(t))||(null===(a=t.isJournal)||void 0===a?void 0:a.call(t));if(t.externalGrade?r=e.GRADE_OVERALL_ICON_CLASS:t.calculationType&&l.p.NonCalculated!==t.calculationType?r=e.GRADE_CALCULATIONS_ICON_CLASS:t.gradebookCategory&&t.gradebookCategory.title&&!c&&(r=this.gradeColumnCategory.getCategoryIcon(t.gradebookCategory)),(""===r||r===s.a.DEFAULT_ICON_FOR_CATEGORY&&c)&&t.scoreProviderHandle){const n=o.O.parse(t.scoreProviderHandle.toString());null!=n&&(r=n.iconClass,(null===(i=t.isScormSCO)||void 0===i?void 0:i.call(t))&&(r+=e.SCORM_SCO_ICON_CLASS_SUFFIX))}return r}getColumnIconClass(t){const n=this.getColumnIconClassAsString(t);return this.$q.when(n||e.DEFAULT_ICON_CLASS)}getIconName(e){return e.replace("img-icon-","")}getIconNameForLocalization(e){return e.replace(b,"")}};v.DEFAULT_ICON_CLASS="img-icon-document-blank",v.GRADE_OVERALL_ICON_CLASS="img-icon-overall-grade",v.GRADE_CALCULATIONS_ICON_CLASS="img-icon-calculation",v.SCORM_SCO_ICON_CLASS_SUFFIX="-sco",v.fileMIMETypeToIconClass=Object.create(null),v=Object(a.a)([Object(a.c)(0,Object(m.b)("$q")),Object(a.c)(1,Object(m.b)(s.c)),Object(a.c)(2,Object(m.b)(u.b))],v);i.module(p,[s.b,u.a]).service(h,v)},bTsL:function(e,t){e.exports='<div class="dropdown-directive">\n  <select id="{{::listId}}" ng-if="::dropdown.useNativeSelect()" ng-model="dropdown.selectedItem"\n          ng-options="item.name disable when item.isHeader for item in itemList"\n          ng-class="{\'drowdown-group\': listKind === \'group\'}"\n          ng-change="dropdown.clickItem()" analytics-id="directives.dropdown.item.select">\n    \x3c!--for the listkind=group, ios mobile will show a blank option--\x3e\n    <option ng-if="dropdown.shouldHaveBlankOption(listKind)" class="default-option" value="" analytics-id="directive.dropdown.option"></option>\n  </select>\n\n  <ul ng-attr-role="{{dropdown.getRole()}}"\n      ng-class="{\'feature-filter\': listKind !== \'custom\', \'selection-full-width\': selectionFullWidth(), \'force-above\': forceAbove}"\n      id="{{::listId}}" ng-if="::!dropdown.useNativeSelect()" class="f-dropdown ignore-accordion" data-dropdown-content\n      aria-hidden="true" tabindex="-1">\n    <li class="list-header" ng-if="listHeader">\n      <a href="javascript:void(0);"\n         analytics-id="{{::analyticsIdTagPrefix}}.listHeader.link"\n      >\n        {{listHeader}}\n      </a>\n    </li>\n    <li role="presentation" ng-repeat="item in itemList" ng-if="listKind === \'filter\'"\n        ng-class="{\'item-selected\': selectedItem === item}"\n        class="{{item.extraClass}}"\n    >\n      <a href="javascript:void(0);"\n         role="option"\n         aria-selected="{{selectedItem === item}}"\n         aria-setsize="{{itemList.length}}"\n         aria-posinset="{{itemList.indexOf(item) + 1}}"\n         class="js-filter-id-{{::item.index}}"\n         data-filter-id="{{::item.nature.toString()}}"\n         ng-click="dropdown.selectItem(item)"\n         analytics-id="{{::analyticsIdTagPrefix}}.{{item.name.split(\' \').join(\'\')}}.link">\n        <span class="ellipse" title="{{item.name}}">{{item.name}}</span>\n        <i></i>\n      </a>\n    </li>\n    <li ng-repeat="item in itemList" ng-if="listKind === \'avatar-list\'">\n      <a href="javascript:void(0);"\n         class="item-container"\n         analytics-id="{{::analyticsIdTagPrefix}}.{{item.name}}.avatar.link">\n        <div class="info-container">\n          <div class="avatar-container">\n            <bb-avatar user="item" inactive="!dropdown.isUserCourseAvailable(item.id)"></bb-avatar>\n          </div>\n          <div class="username-container">\n            <bb-username user="item" format="short" show-pronouns="true" show-pronunciation="true"></bb-username>\n            <div ng-if="selectedItem === item" class="sub-text" ng-bind-html="selectedText"></div>\n          </div>\n        </div>\n      </a>\n    </li>\n    <li role="presentation" ng-if="listKind === \'group\'" ng-repeat="item in itemList"\n        ng-class="{\'group-header-li\': item.isHeader }">\n      <a href="javascript:void(0);"\n         role="option"\n         aria-setsize="{{itemList.length}}"\n         aria-posinset="{{itemList.indexOf(item) + 1}}"\n         ng-class="{\'group-header\': item.isHeader}"\n         ng-attr-tabindex="{{ item.isHeader ? -1 : 0 }}"\n         ng-click="dropdown.selectItem(item, $event)"\n         analytics-id="{{::analyticsIdTagPrefix}}.{{item.name}}.group.link">\n        <span class="ellipse" title="{{item.name}}">{{item.name}}</span>\n      </a>\n    </li>\n    <div bb-dropdown-transclude></div>\n  </ul>\n</div>\n'},bd3f:function(e,t){e.exports='<p class="sr-only read-info-polite" role="alert" aria-live="polite">{{readInfo.message}}</p>\n<p class="sr-only read-info-assertive" role="alert" aria-live="assertive">{{readInfo.alertMessage}}</p>'},bd9L:function(e,t,n){"use strict";n.d(t,"g",(function(){return u})),n.d(t,"f",(function(){return m})),n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return h})),n.d(t,"a",(function(){return g})),n.d(t,"e",(function(){return b})),n.d(t,"d",(function(){return f}));var a=n("Llzl"),i=n("nbDY"),r=n.n(i),s=n("+brj"),o=n("7/CN"),l=n("RNuw"),c=n("lEL+"),d=n("AuQm");const u="ultra.directives.autosave",m="bb-autosave-save-to-server-now",p="bb-autosave-browser-delete",h="bb-autosave-form",g="bb-autosave-save-trigger-debounce",b=1e4,f=3;class v extends r.a{}v.BrowserLocalStorage=new v("browserLocalStorage"),v.BrowserSessionStorage=new v("browserSessionStorage"),v.Server=new v("server");class y{constructor(e,t,n,a,i){switch(this.$q=e,this.scope=t,this.formController=n,this.browserStorage=a,this.timeout=i,this.timeoutMillis=2e3,this.startAutoSubmit=!1,this.saveNumber=0,this.saveTo=this.scope.debounceSaveDestination&&v.parse(this.scope.debounceSaveDestination())||v.Server,this.saveTo){case v.BrowserSessionStorage:this.browserStorageDestination=s.a.SessionStorage;break;case v.BrowserLocalStorage:this.browserStorageDestination=s.a.LocalStorage}this.checkForDirectiveConfigErrors(),t.timeoutMillis?this.timeoutMillis=t.timeoutMillis():this.browserStorageDestination&&(this.timeoutMillis=1e3),this.setupListeners(),this.browserStorageDestination&&this.restoreFromBrowser(),this.setupWatcher()}setupListeners(){this.scope.$on("bb-autosave-interrupt-timer",(()=>{this.timeout.cancel(this.autoSaveTimeout)})),this.scope.$on(g,(()=>{this.scope.delayAutosave&&this.scope.delayAutosave()||this.debounceSave()})),this.scope.$on(m,(()=>{this.scope.delayAutosave&&this.scope.delayAutosave()||(this.timeout.cancel(this.autoSaveTimeout),this.saveToServerNow())})),this.scope.$on("bb-autosave-save-to-browser-now",(()=>{this.scope.delayAutosave&&this.scope.delayAutosave()||(this.scope.$emit(h,d.d.Change),this.timeout.cancel(this.autoSaveTimeout),this.saveToBrowserNow())})),this.scope.$on("bb-autosave-browser-restore",(()=>{this.restoreFromBrowser()})),this.scope.$on(p,(()=>{this.deleteFromBrowser()})),this.scope.$on("bb-start-auto-submission",((e,t)=>{this.startAutoSubmit=!0,t.resolve()})),this.scope.$on("bb-cancel-auto-submission",(()=>{this.startAutoSubmit=!1}))}setupWatcher(){const e=(e,t)=>{if(!this.scope.delayAutosave||!this.scope.delayAutosave()){if(null===e&&""===t)return;this.debounceSave()}};if(!this.scope.delayAutosave||!this.scope.delayAutosave())return l.a(this.scope,this.formController,e);const t=this.scope.$watch((()=>this.scope.delayAutosave()),(n=>{null==n||n||(l.a(this.scope,this.formController,e),t())}))}checkForDirectiveConfigErrors(){if(this.saveTo.isEqualTo(v.Server)&&(!this.scope.saveFunc||!this.scope.validationFunc))throw new Error("saving to the server requires save-func and validate to be defined")}isValid(){return this.formController.$valid&&this.scope.validationFunc()}debounceSave(){if(this.startAutoSubmit)return;this.scope.useSaveNumbers&&(this.saveNumber=this.saveNumber+1);const e=this.saveNumber;this.scope.$emit(h,d.d.Change,void 0,{id:this.scope.autoSaveContextId,area:this.scope.autoSaveContextArea,saveNumber:e}),this.scope.$emit("bb-autosave-form-to-browser",d.d.Change),this.timeout.cancel(this.autoSaveTimeout);const t=()=>{this.saveToDestination(e)};!this.autoSaveTimeout&&this.scope.useLeadingEdge?(this.saveToDestination(e),this.autoSaveTimeout=this.timeout((()=>{}),this.scope,this.timeoutMillis)):this.autoSaveTimeout=this.timeout(t,this.scope,this.timeoutMillis)}saveToDestination(e){this.saveTo.isEqualTo(v.Server)?this.saveToServerNow(e):this.browserStorageDestination&&this.saveToBrowserNow()}saveToServerNow(e=0){if(this.startAutoSubmit||!o.c()){if(!this.scope.saveFunc||!this.scope.validationFunc)throw new Error("saving to the server requires save-func and validate to be defined");this.isValid()?(this.scope.$emit(h,d.d.Saving,void 0,{id:this.scope.autoSaveContextId,area:this.scope.autoSaveContextArea,saveNumber:e}),this.scope.saveFunc().then((t=>{this.scope.$emit(h,d.d.Saved,t,{id:this.scope.autoSaveContextId,area:this.scope.autoSaveContextArea,saveNumber:e}),this.browserStorageDestination&&this.deleteFromBrowser()}),(t=>{this.scope.$emit(h,d.d.SaveFailure,t,{id:this.scope.autoSaveContextId,area:this.scope.autoSaveContextArea,saveNumber:e})}))):this.scope.$emit(h,d.d.ValidationFailure)}}saveToBrowserNow(){if(!this.browserStorageDestination)throw new Error("saving/restoring with browser storage requires the debounceSaveDestination attribute be set");this.scope.$emit("bb-autosave-form-to-browser",d.d.Saving),this.browserStorage.serializeCurrentRouteScopes(this.browserStorageDestination,this.scope.$parent).then((e=>{this.scope.$emit("bb-autosave-form-to-browser",d.d.Saved,e)}))}restoreFromBrowser(){if(!this.browserStorageDestination)throw new Error("saving/restoring with browser storage requires the debounceSaveDestination attribute be set");return this.browserStorage.deserializeCurrentRouteScopes(this.browserStorageDestination,this.scope.$parent).then((e=>{if(e)return this.scope.$root.$broadcast("bb-autosave-browser-restore-data",e),e}))}deleteFromBrowser(){if(!this.browserStorageDestination)throw new Error("saving/restoring with browser storage requires the debounceSaveDestination attribute be set");return this.browserStorage.deleteCurrentRouteScopes(this.browserStorageDestination)}}y.$inject=["$q","scope","formController",s.c,c.b];class S{constructor(e){this.$injector=e,this.restrict="A",this.require="^form",this.scope={debounceSaveDestination:"&?",delayAutosave:"&?",saveFunc:"&?",autoSaveContextId:"@?",autoSaveContextArea:"@?",timeoutMillis:"&?",validationFunc:"&?",useLeadingEdge:"<?",useSaveNumbers:"<?"},this.link=(e,t,n,a)=>{e.autoSave=this.$injector.instantiate(y,{scope:e,formController:a})}}}S.$inject=["$injector"],a.module(u,[c.a,s.b]).directive("bbAutosave",["$injector",e=>e.instantiate(S)])},bzJv:function(e,t,n){"use strict";var a;!function(e){e.NotStarted="NotStarted",e.Started="Started",e.Completed="Completed",e.PastDue="PastDue",e.Unavailable="Unavailable"}(a||(a={})),t.a=a},cFWd:function(e,t,n){"use strict";var a=n("nsO7"),i=n("Llzl"),r=n("oQrK"),s=n("+4Px"),o=n("lEL+"),l=n("bTsL"),c=n("yC9S");n.d(t,"a",(function(){return d}));const d="ultra.components.directives.dropdown";class u{constructor(e,t,n,o){if(this.scope=e,this.element=t,this.$window=n,this.timeout=o,this.RESIZE_DELAY=150,this.isMobile=!1,this.isIos=!1,this.setMaxHeight=()=>{const e=this.element.offset().top,t=i.element(this.$window).height();let n=34;"avatar-list"===this.scope.listKind&&(n=57);let a=Math.max(Math.floor((this.scope.forceAbove?e:t-e)/n),2);this.scope.simplifiedMaxItemsPerPage&&this.scope.simplifiedMaxItemsPerPage()>0&&(a=Math.min(a,this.scope.simplifiedMaxItemsPerPage())),this.element.find(".dropdown-directive").css({maxHeight:n*a+2})},this.element.addClass("bb-dropdown"),this.isMobile=!r.a.detect().desktop(),this.isIos=r.a.detect().ios(),this.selectedItem=this.scope.selectedItem,e.$watch("::selectedItem",(e=>{this.selectedItem=e})),!this.useNativeSelect()){let t;this.element.on("keyup",(e=>{e.keyCode!==s.f&&e.keyCode!==s.t||e.stopPropagation()})),this.element.on("opened.fndtn.dropdown",(()=>{this.setMaxHeight(),this.scope.$applyAsync(),t=c.b.OnWindow("resize",a.debounce(this.setMaxHeight,this.RESIZE_DELAY),e),(this.scope.onOpen||i.noop)()})),this.element.on("closed.fndtn.dropdown",(()=>{t(),(this.scope.onClose||i.noop)()}))}}selectItem(e,t){e.isHeader?t.stopPropagation():this.scope.clickFunction({item:e})}getRole(){let e;return e="menu"===this.scope.listKind?"menu":"listbox",e}clickItem(){this.selectedItem&&(this.scope.selectedItem=this.selectedItem,this.scope.clickFunction({item:this.selectedItem}))}useNativeSelect(){return!this.scope.forceCustomDropdown&&this.isMobile&&"avatar-list"!==this.scope.listKind&&"custom"!==this.scope.listKind&&"region"!==this.scope.listKind}isUserCourseAvailable(e){const t=this.scope.getUserCourseAvailabilities&&this.scope.getUserCourseAvailabilities();return!(t&&!t[e])}shouldHaveBlankOption(e){return this.isIos&&"group"===e}}u.$inject=["scope","element","$window",o.b];class m{constructor(e){this.$injector=e,this.restrict="E",this.template=l,this.transclude=!0,this.scope={listId:"@",itemList:"=",listKind:"@",selectedItem:"=?",selectedText:"@?",listHeader:"@?",clickFunction:"&?",onOpen:"&?",onClose:"&?",getUserCourseAvailabilities:"&?userCourseAvailabilities",selectionFullWidth:"&?",simplifiedMaxItemsPerPage:"&?",forceAbove:"=?",forceCustomDropdown:"=?",analyticsIdTagPrefix:"@?"},this.link=(e,t,n,a,i)=>{e.dropdown=this.$injector.instantiate(u,{scope:e,element:t})}}}m.$inject=["$injector"];class p{constructor(e){this.$injector=e,this.restrict="EA",this.link=(e,t,n,a,i)=>{"custom"===e.listKind||"region"===e.listKind||"menu"===e.listKind?i(((n,a)=>{a.dropdown=e.dropdown,t.replaceWith(n)})):t.remove()}}}p.$inject=["$injector"],i.module(d,[o.a]).directive("bbDropdown",["$injector",e=>e.instantiate(m)]).directive("bbDropdownTransclude",["$injector",e=>e.instantiate(p)])},cGmE:function(e,t){e.exports='<bb-modal id="notification-modal-api-error"\n          class="notification"\n          modal-title-key="components.services.error-modal.error.title"\n          analytics-id-tag-prefix="components.services.error-modal">\n  <div name="modal-contents">\n    <p bb-translate>components.services.error-modal.error.description</p>\n    <pre>{{ response | json }}</pre>\n    <bb-session-debug-modal-button></bb-session-debug-modal-button>\n  </div>\n  <button name="modal-footer-button-primary"\n          ng-click="$parent.$dismiss()"\n          class="button js-primary-button"\n          analytics-id="components.services.error-modal.dismiss"\n          bb-translate>components.services.error-modal.dismiss</button>\n</bb-modal>\n'},cMqb:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n("9zo4"),i=n("Llzl"),r=n("w9Zy"),s=n("XGja");const o="ultra.directives.accessibility.focus";class l{constructor(e,t){this.bbOffcanvas=e,this._accessibility=t,this.restrict="A",this.link=(e,t,n)=>{const a=n.keepTriggerFocus,i=e.$watch(n.bbFocus,(e=>{null!=e&&"true"!==e.toString().toLowerCase()||!this._accessibility.isElementInActivePanel(t)||(s.a(t,this.bbOffcanvas.safeFocus.bind(this.bbOffcanvas)),"true"!==a&&i())}))}}}l.$inject=[r.e,a.c],i.module(o,[r.d]).directive("bbFocus",["$injector",e=>e.instantiate(l)])},cQcs:function(e,t){e.exports='<div class="reveal-modal-bg fade"\n     ng-class="{in: animate, dark: darkenBackdrop}"\n     ng-click="close($event)"\n     style="display: block"\n     analytics-id="components.services.backdrop"\n></div>'},cYWG:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return o}));var a=n("Llzl"),i=n("nsO7"),r=n("5MwF");const s="ultra.components.services.angular.http.ease",o="shelfLifeInEase";class l{constructor(e,t){this.$q=e,this.$log=t,this._queue={},this._queueSeq=0,this.delay=500}enqueue(e){e.shelfLifeInEase=(e.params||{})[o]||this.delay,(e.params||{})[o]=void 0;const t=this.$q.defer(),n=(new Date).getTime();if(!i.some(this._queue,((a,i)=>{if(!a)return!1;if(a.completedAt&&n-a.completedAt>a.shelfLifeInEase)return this._queue[i]=void 0,!1;let r;return(a.originalUrl||a.url)===(e.originalUrl||e.url)&&(r=this.isServableBy(a,e)),!!r&&(a.httpEaseResponseQ.promise.then((e=>{this.$q.when(r(e)).then((e=>{t.resolve(e)}))})),!0)}))){const n="x"+this._queueSeq++;e.originalUrl=e.url,e.httpEaseResponseQ=this.$q.defer(),e.httpEaseResponseQ.promise.finally((()=>{e.completedAt=(new Date).getTime()})),this._queue[n]=e,t.resolve()}return t.promise}getHttpInterceptor(){const e=e=>t=>{const n=t.config||t;return this.isDebouncable(n)?e(n,t):this.$q.when(t)};return{request:e((e=>e.cache?e:this.enqueue(e).then((t=>void 0===t?e:i.extend(e,{method:"JSONP",cache:{get:()=>t}}))))),responseError:e=>{const t=e.config;return t.httpEaseResponseQ&&t.httpEaseResponseQ.resolve([e.status,JSON.parse(JSON.stringify(e.data)),{}]),this.$q.reject(e)},response:e(((e,t)=>(e.httpEaseResponseQ&&e.httpEaseResponseQ.resolve([t.status,void 0===t.data?void 0:JSON.parse(JSON.stringify(t.data)),{}]),this.$q.when(t))))}}isDebouncable(e){return r.a.features.httpEase&&"GET"===e.method&&new RegExp("^(http.+)?(/learn/api/.*)$").test(e.url)}isServableBy(e,t){if(!(e.method===t.method))return null;const n=(()=>{const n=e=>{const t=[];return i(e).keys().sortBy().value().forEach((n=>{"expand"!==n&&t.push(`${encodeURIComponent(n)}=${encodeURIComponent(e[n])}`)})),t.join("&")};return n(e.params)===n(t.params)})(),a=(()=>{const n={};return((e.params||{}).expand||"").split(",").forEach((e=>{""!==e&&(n[e]=e)})),((t.params||{}).expand||"").split(",").every((e=>""===e||Object.prototype.hasOwnProperty.call(n,e)))})();if(n&&a)return this.$log.debug(`Eased ${t.url}`,e,t),e=>e;this.$log.warn(`Concurrent Requests Captured - "${t.method} ${t.url}" (with different parameters). Please consider to merge them for performance`)}}l.$inject=["$q","$log"];const c=a.module(s,["ng"]);r.a.features.learnApiCaching||c.config(["$httpProvider",function(e){e.interceptors.push(["$injector",e=>e.instantiate(l).getHttpInterceptor()])}])},cacA:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n("Llzl"),i=n("Qbdf"),r=n("X455"),s=n("0JpG"),o=n("TnpK"),l=n("nmzr");const c="ultra.base.messages.routes";a.module(c,[i.b,r.a,o.b]).config([o.c,i.c,r.b,(e,t,a)=>{e.peekState("create-message",{url:"/create?courseId&{allowReplies:bool}",resolve:{[i.d]:t.resolve,[r.c]:a.resolve},require:()=>Promise.all([n.e(49),n.e(51),n.e(73)]).then(n.bind(null,"BrlV")),pageTitle:"components.directives.message.newMessage",panelClass:"full"}).peekState("edit-message",{url:"/edit/:conversationId?courseId&offset&count",require:()=>Promise.all([n.e(49),n.e(51),n.e(73)]).then(n.bind(null,"BrlV")),pageTitle:"components.directives.message.message",panelClass:"full"}).peekState(l.n.COURSE_MESSAGE,{url:"/message?courseId&recipientIds&conversationPerRecipient",onExit:["$rootScope","$stateParams",(e,t)=>{var n,a;n=e,a=t.courseId,n.$broadcast("bb-message-refresh",a)}],resolve:{[r.c]:a.resolve,translations:[s.serviceName,e=>e.loadBundle("features/base/messages/base-messages")]},require:()=>Promise.all([n.e(49),n.e(51),n.e(73)]).then(n.bind(null,"BrlV")),pageTitle:"base.messages.newMessage",panelClass:"full"})}])},cwoR:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n("Llzl"),i=n("0JpG"),r=n("TnpK");const s="ultra.base.system-content-market.router";a.module(s,[i.moduleName,r.b]).config([r.c,e=>{e.peekState("system-content-market",{url:"/systemcontentmarket",require:()=>Promise.all([n.e(86),n.e(643)]).then(n.bind(null,"tcBX")),resolve:{translations:["$q",i.serviceName,(e,t)=>e.all([t.loadBundle("features/base/system-content-market/system-content-market"),t.loadBundle("features/course/content-market/content-market"),t.loadBundle("features/course/books-and-tools/books-and-tools")])]},panelClass:"full",pageTitle:"base.systemContentMarket.title",params:{mode:null}})}])},d7QB:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return s}));var a=n("Llzl"),i=n("N7x3");const r="ultra.components.services.event-emitter",s="integration-event-emitter";class o{constructor(){this.emitIntegrationEvent=e=>{e.originalEvent||(e.originalEvent=e.originalEvent||{}),e.originalEvent.manualFireFlag||(this._triggerForceClick(e.target),e.originalEvent.manualFireFlag=!0)},this.addIntegrationEventClickListener=e=>(e.on("click",this.emitIntegrationEventOnClickHandler),()=>{e.off("click",e.selector,this.emitIntegrationEventOnClickHandler)}),this.emitIntegrationEventOnClickHandler=e=>this.emitIntegrationEvent(e)}_triggerForceClick(e){a.element(e).trigger(i.a.integrationForceClick)}}a.module(r,[]).service(s,o)},d8yC:function(e,t,n){"use strict";function a(e){const t=[];let n=0;e.forEach(((e,a)=>{n+=Math.floor(e),t.push({integer:Math.floor(e),remainder:e-Math.floor(e),index:a})}));let a=100-n;if(a>0){t.sort(((e,t)=>t.remainder-e.remainder));let e=0;for(;a>0;)t[e].integer>0||t[e].remainder>0?(t[e].integer+=1,e++,a-=1):e++,e===t.length&&(e=0);t.sort(((e,t)=>e.index-t.index))}return t.map((e=>e.integer))}function i(e,t){const n=e.toString(),a=n.indexOf(".");if(a>0&&n.length-a-1>t){const e=n.slice(0,a+t+1);return parseFloat(e)}return e}n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}))},dtd2:function(e,t,n){"use strict";var a=n("nbDY"),i=n.n(a);class r extends i.a{}r.Outline=new r("outline"),r.Inline=new r("inline"),t.a=r},e6ZA:function(e,t,n){"use strict";n.r(t);n("BfLg"),n("Ddvy"),n("OkIp"),n("dY8P"),n("W67r"),n("juDU"),n("9RbK"),n("1dyP"),n("RB+a"),n("nsGK"),n("LNcM"),n("T4UF"),n("FNJT"),n("zhNR"),n("abLi"),n("B1ET"),n("1wt3"),n("rEGj"),n("qY1S"),n("lGTS"),n("Jsos"),n("HopG");const a=new Map;class i{constructor(e){this.name=e,this.id=`$BroadcastChannel$${e}$`,a.has(this.id)||a.set(this.id,new Set),a.get(this.id).add(this),this.onStorage=this._onStorage.bind(this),window.addEventListener("storage",this.onStorage),this.messageChannel=new MessageChannel}close(){window.removeEventListener("storage",this.onStorage);const e=a.get(this.id);e.delete(this),e.size||a.delete(this.id)}_onStorage({key:e,newValue:t,storageArea:n}){if(n===window.localStorage&&null!==t&&e.substring(0,this.id.length)===this.id)try{const e=JSON.parse(t);this.dispatchEvent(new MessageEvent("message",{data:e}))}catch(e){this.dispatchEvent(new ErrorEvent("messageerror",{error:e,message:"Failed to deserialize incoming message."}))}}postMessage(e){e=JSON.stringify(e);const t=`${this.id}${Date.now()}$${Math.random()}`;window.localStorage.setItem(t,e),setTimeout((()=>window.localStorage.removeItem(t)),500),a.get(this.id).forEach((t=>{t!==this&&t.dispatchEvent(new MessageEvent("message",{data:JSON.parse(e)}))}))}get onmessage(){return this.messageChannel.port1.onmessage}set onmessage(e){this.messageChannel.port1.onmessage=e}get onmessageerror(){return this.messageChannel.port1.onmessageerror}set onmessageerror(e){return this.messageChannel.port1.onmessageerror=e}addEventListener(...e){return this.messageChannel.port1.addEventListener.apply(this.messageChannel.port1,e)}removeEventListener(...e){return this.messageChannel.port1.removeEventListener.apply(this.messageChannel.port1,e)}dispatchEvent(...e){return this.messageChannel.port1.dispatchEvent.apply(this.messageChannel.port1,e)}}"BroadcastChannel"in window||(window.BroadcastChannel=i);var r=n("71td"),s=n("Llzl"),o=n("ssIi"),l=n("0uRC"),c=n("V8Kl"),d=n("OrNH"),u=n("kcGO"),m=n("/5AG"),p=n("IbyE");const h={"course-content":u.h,"course-core":m.t,"learn-data-services":p.Wb};let g,b={};function f(e=h){return e!==g&&(b=function(e=h){const t={};return Object.keys(e).forEach((n=>{const a=e[n];Object.keys(null!=a?a:{}).forEach((e=>{const i=a[e];t[`${n}/${e}`]=i}))})),g=e,Object.freeze(t)}(e)),b}function*v(){const e=f(),t=Object.keys(e).map((t=>Object(d.f)(function(e,t=e.name){return function*(){for(;;)try{yield Object(d.b)(e);break}catch(e){console.error(`Uncaught error in saga ${t}:`,e)}}}(e[t],t))));yield Object(d.a)(t)}var y=n("In+A"),S=n("lEL+");const C="ultra.components.directives.animatedGif";class E{constructor(e,t){this.$injector=e,this.timeout=t,this.restrict="E",this.link=(e,t,n)=>{const a=s.element('<img role="presentation" alt="" style="width:0; height:0">');a.attr("src",t.attr("src")),t.append(a),this.timeout((()=>{t.attr("alt")&&a.attr("alt",t.attr("alt"))}),e,0,!1);const i=()=>{a.off("load",i),a.attr("src",""),a.addClass("animated-gif"),this.timeout((()=>{a.removeAttr("style"),a.attr("src",t.attr("src"))}),e,250,!1)};a.on("load",i)}}}E.$inject=["$injector",S.b],s.module(C,[S.a]).directive("bbAnimatedGif",["$injector",e=>e.instantiate(E)]);n("4MCF"),n("p95z");var I=n("NI+y"),k=n("5MwF"),w=n("Qbdf"),T=n("YzQO"),O=n("pjml"),A=n("w9mJ"),P=n("myse"),x=n("ZzR9"),$=n("TnpK");const N="ultra.bb.angulartics";let D=e=>{},L=(e,t)=>{},j={subscribeToFramework:P.subscribeToFramework};s.module(N,["angulartics","angulartics.scroll",O.N,A.a,w.b]).config(["$analyticsProvider",e=>{e.registerPageTrack((e=>{D(e)})),e.registerEventTrack(((e,t)=>{L(e,t)})),r.fn.extend({waypoint(){return this.each((function(){r(this).triggerHandler("scrollby")}))}})}]).run(["$rootScope","$timeout",O.b.serviceName,A.b,w.e,(e,t,n,a,i)=>{const r=a.getQueue("telemetry");function o(e){r.enqueue((()=>t((()=>(I.b.addHistory(e),n.$create(e))),1e3,!1)))}function l(){return i.course?{id:i.course.id,uuid:i.course.uuid,batchUid:i.course.batchUid,ultraStatus:i.course.ultraStatus}:null}function c(e){if(e){if("{"===e[0])try{return JSON.parse(e)}catch(e){}return{value:e}}}j.subscribeToFramework("UltraTelemetry",((e,t)=>{const{analyticsId:n,...a}=null!=t?t:{};e===P.AnalyticsEventTypes.CLICK_EVENT&&o({action:"click",analyticsId:n,context:a,url:document.URL,applicationId:k.a.telemetryAppId,course:l()}),e===P.AnalyticsEventTypes.CHANGE_EVENT&&o({action:"change",analyticsId:n,context:a,url:document.URL,applicationId:k.a.telemetryAppId,course:l()})})),D=e=>{o({action:"pageview",analyticsId:e,url:document.URL,applicationId:k.a.telemetryAppId,course:l(),screenDimension:{innerHeight:window.innerHeight,innerWidth:window.innerWidth,outerHeight:window.outerHeight,outerWidth:window.outerWidth}})},L=(e,t)=>{!t.id||"click"!==t.eventType&&"scrollby"!==t.eventType||o({action:t.eventType,analyticsId:t.id,url:document.URL,context:c(t.context),applicationId:k.a.telemetryAppId,course:l()})},e.$on(x.b.$stateChangeSuccess,((e,t,n,a)=>{var i;(null===(i=null==t?void 0:t.name)||void 0===i?void 0:i.startsWith(null==a?void 0:a.name))||function(e){if(!e)return[];const t=e.split($.a),n=[];let a="";return t.forEach((e=>{""!==e&&(a=a.length>0?`${a}${$.a}${e}`:e,n.push(a))})),n}(null==a?void 0:a.name).forEach((e=>{var n;!(null===(n=null==t?void 0:t.name)||void 0===n?void 0:n.startsWith(e))&&e.includes($.a)&&o({action:"panelclosed",analyticsId:e,url:document.URL,applicationId:k.a.telemetryAppId,course:l()})}))}));document.addEventListener("click",(e=>{var t,n;if(Object(T.f)(e.target))return;const a=s.element(e.target),i=a.closest("a"),r="_blank"===i.attr("target"),d=Object(T.e)(a);let u,m;d||(u=Object(T.b)(a)||Object(T.d)(a.parent())),!u&&r&&(u=a.attr("analytics-id")||"external-link"),u&&(d||(m=c(Object(T.a)(a))),r&&(m=null!=m?m:{},m.value=null!==(t=m.value)&&void 0!==t?t:i.attr("href"),m.valueType=null!==(n=m.valueType)&&void 0!==n?n:"link"),o({action:"click",analyticsId:u,url:document.URL,context:m,applicationId:k.a.telemetryAppId,course:l()}))}),!0)}]);var M=n("/KQw"),G=n("lmMM"),R=n("0JpG");const B="ultra.components.directives.dir";class F{constructor(e){this.bbLocalize=e,this.restrict="A",this.link=(e,t,n)=>{e.$watch("locale",(()=>{n.attr=n.attr||"dir",n.rtl=n.rtl||"rtl",n.ltr=n.ltr||"ltr",this.bbLocalize.isRTL(e)?t.attr(n.attr,n.rtl):t.attr(n.attr,n.ltr)}))}}}F.$inject=[R.serviceName],s.module(B,[]).directive("bbDir",["$injector",e=>e.instantiate(F)]);var U=n("Xq/A"),_=n("07uq"),z=n("Us01"),q=n("t3AZ"),H=n("J0Qq");const V="ultra.directives.bbTime";class W{constructor(e,t){this.$parse=e,this.bbLocalize=t,this.restrict="AE"}compile(e){const t=e.html();return(e,n,a)=>{const i=t=>{const i=this.bbLocalize.getFormatEnum(R.ILocaleTimeFormat,a.format)||R.ILocaleTimeFormat.Short;if("true"===a.epoch){const e=new Date(0);e.setUTCSeconds(t),t=e}const r=e=>{"bb-time"===n.prop("tagName").toLowerCase()?n.replaceWith(e):n.html(e)};null==t?r(""):this.bbLocalize.formatTime(t,i,e).then(r)};let r;"true"===a.autoUpdate?a.$observe("bbTime",(()=>{r=new Date(this.$parse(a.bbTime)(e)),i(r)})):(r=this.$parse(t)(e)||new Date(this.$parse(a.bbTime)(e)),i(r))}}}W.$inject=["$parse",R.serviceName];s.module(V,[R.moduleName]).directive("bbTime",["$injector",e=>e.instantiate(W)]);var K=n("UioO");const Y="ultra.directives.bbNumber";class J{constructor(e,t){this.$parse=e,this.bbLocalize=t,this.restrict="AE"}compile(e){const t=e.html();return(e,n,a)=>{const i=this.$parse(t)(e);this.bbLocalize.formatNumber(i,e).then((e=>{"bb-number"===n.prop("tagName").toLowerCase()?n.replaceWith(e):n.html(e)}))}}}J.$inject=["$parse",R.serviceName];s.module(Y,[R.moduleName]).directive("bbNumber",["$injector",e=>e.instantiate(J)]);var Z=n("Oyr+"),Q=n("bd9L"),X=n("pIXs"),ee=n("43zP"),te=n("aD4H"),ne=n("AuQm");const ae="ultra.directives.saveForm";class ie{constructor(e,t){this.scope=e,this.$q=t,this.queuedSave=!1,e.editMode?(e.$broadcast("bb-save-button",ne.d.Saved),this.autoSaveState=ee.a.Saved):this.autoSaveState=ee.a.NotSaved,e.$on(Q.c,((t,n,a)=>{switch(e.$broadcast("bb-save-button",n,a),n){case ne.d.Change:this.autoSaveState=ee.a.NotSaved;break;case ne.d.Saving:this.autoSaveState=ee.a.Saving;break;case ne.d.Saved:this.autoSaveState=ee.a.Saved;case ne.d.SaveFailure:case ne.d.ValidationFailure:}}))}validate(){return this.scope.validate()&&this.scope.baseForm&&this.scope.baseForm.$valid}save(){if(this.validate()){if(this.savePromise)this.queuedSave||(this.queuedSave=!0,this.savePromise=this.savePromise.finally((()=>(this.savePromise=null,this.queuedSave=!1,this.save()))));else{this.autoSaveState=ee.a.Saving;const e=this.scope.save();this.savePromise=e.then((e=>(this.autoSaveState=ee.a.Saved,e)))}return this.savePromise}}saveClicked(){if(this.autoSaveState===ee.a.NotSaved)return this.save().then((()=>{this.scope.$emit("autosave-button-click",{target:"save"}),this.scope.showAlertMessage&&this.scope.showAlertMessage()}));this.scope.$emit("autosave-button-click",{target:"save"})}cancelClicked(){if(this.scope.cancel){const e=this.scope.cancel();e?e.then((()=>{this.scope.$emit("autosave-button-click",{target:"cancel"})})):this.scope.$emit("autosave-button-click",{target:"cancel"})}}deleteClicked(){if(this.scope.delete){const e=this.scope.delete();e?e.then((()=>{this.scope.$emit("autosave-button-click",{target:"delete"})})):this.scope.$emit("autosave-button-click",{target:"delete"})}}mouseDown(){this.scope.$emit("bb-autosave-interrupt-timer"),this.scope.$emit("autosave-button-click",{target:"mouseDown"})}}class re{constructor(e){this.$q=e,this.transclude=!0,this.restrict="E",this.scope={save:"&",cancel:"&?",validate:"&",delete:"&?",canDelete:"=",deleteConfirmationResourceType:"@?",choices:"=?",editMode:"=",hideFooter:"=",baseForm:"=?",delayAutosave:"&?",displayDeleteAfterSaving:"&?",debounceSaveDestination:"&?",showAlertMessage:"&?",analyticsIdTagPrefix:"@"},this.link=(e,t)=>{e.saveForm=new ie(e,this.$q)},this.template=te}}re.$inject=["$q"],s.module(ae,[Q.g,X.a]).directive("bbSaveForm",["$injector",e=>e.instantiate(re)]);var se=n("gZo5");const oe="ultra.services.security",le="xsrf",ce="X-Blackboard-XSRF",de="xsrf-token-changed";class ue{constructor(e,t){this.$rootScope=e,this.crossWindowMessaging=t,this.xsrfCallbacks=new Set,e.$on(de,((e,t)=>this.updateToken(t))),e.$on("$destroy",(()=>{this.xsrfCallbacks.clear()}))}registerXsrfCallback(e){this.xsrfCallbacks.add(e),this.token&&this.invokeXsrfCallback(e)}unregisterXsrfCallback(e){return this.xsrfCallbacks.delete(e)}getToken(){return this.token}updateToken(e){return this.token===e||(this.token=e,this.xsrfCallbacks.forEach((e=>this.invokeXsrfCallback(e))),this.crossWindowMessaging.postMessage(de,this.token)),this.token}invokeXsrfCallback(e){try{e(this.token)}catch(e){}}}ue.$inject=["$rootScope",se.b];s.module(oe,[se.a]).service(le,ue);var me=n("Fvsw"),pe=n("fYJU"),he=n("Si89"),ge=n("t6zR"),be=n("QaOk"),fe=n("Y88D"),ve=n("FR7u"),ye=n("+g6d"),Se=n("RDfZ"),Ce=n("V17J"),Ee=n("tcaZ"),Ie=n("V6ed"),ke=n("P2dS"),we=n("g66W"),Te=n("w9Zy"),Oe=n("SBFF");const Ae="ultra.components.directives.bbGuidance",Pe=/[_-]/g;Object(y.g)({name:y.a,priority:y.b});class xe{constructor(e,t,n,a){this.ultraState=e,this.offCanvas=t,this.timeout=n,this.$document=a,this.require="^bbFirstTimeContainer",this.replace=!0,this.restrict="E",this.scope={componentKey:"@",pageContainerSelector:"@?",alwaysShow:"@",displayPriority:"&?",broadcastGuidanceHideEvent:"@?",onGuidanceEnabledEvent:"@?",disableHideInPanelState:"@?",forceShowInPanelState:"@?"},this.transclude={title:"?bbGuidanceTitle"},this.template=Oe,this.link=(e,t,n,a)=>{if(!e.componentKey)throw new Error("'component-key' attribute required in bb-guidance");e.componentKey=we.a(e.componentKey,Pe);const i=t.closest(".bb-offcanvas-panel").attr("data-base-state-name"),s=!!e.onGuidanceEnabledEvent,o=new y.d(t.get(0),y.a,e.componentKey,a.manager,a.firstTimeHelper,y.e,e.displayPriority&&e.displayPriority(),s);o.setShouldShow((()=>{const n=r(t).parent().is(":visible"),s=!!e.pageContainerSelector&&r(e.pageContainerSelector).is(":visible");return n||s?a.firstTimeHelper.shouldShow(o.componentKey,i,e.$eval(e.alwaysShow)):Promise.resolve(!1)})),e.isShown=o.shown,o.onShownChanged((t=>{e.$applyAsync((()=>{e.isShown=t}))})),o.registerToManager();const l=t=>{r(t.target).parents().addBack();const n=!!e.disableHideInPanelState&&this.ultraState.includes(e.disableHideInPanelState);!e.isShown||this.ultraState.transition||n||(o.hide(),this.$document[0].removeEventListener("click",l,!0),e.broadcastGuidanceHideEvent&&e.$root.$broadcast(e.broadcastGuidanceHideEvent))},c=()=>{o.showComponent(),this.$document[0].addEventListener("click",l,!0)};let d;d=null,e.onGuidanceEnabledEvent?(d=e.$root.$on(e.onGuidanceEnabledEvent,(()=>{c()})),d=e.$root.$on("show-guidance-component",(()=>{this.timeout((()=>{c()}),e,600)})),a.firstTimeHelper.shouldShow("predict.wizard").then((t=>{const n=!!e.forceShowInPanelState&&this.ultraState.includes(e.forceShowInPanelState);t&&!n||c()}))):this.$document[0].addEventListener("click",l,!0),e.$on("$destroy",(()=>{o.deregisterFromManager(),this.$document[0].removeEventListener("click",l,!0),d&&d()}))},this.ultraState=e}}xe.$inject=[$.d,Te.e,S.b,"$document"],s.module(Ae,[$.b,Ee.a]).directive("bbGuidance",["$injector",e=>e.instantiate(xe)]);const $e="ultra.components.directives.guidanceTarget";class Ne{constructor(e,t,n){this.element=e,this.componentKey=t,this.containerController=n,this.manager=n.manager}get multiTargetSupport(){return this.containerController.firstTimeHelper.hasMultiTargetSupport(this.componentKey)}registerToManager(){this.manager&&(this.hideImpl(),this.manager.registerTarget(this))}deregisterToManager(){this.manager&&this.manager.deregisterTarget(this)}onShown(){this.showImpl()}onHidden(){this.hideImpl()}showImpl(){this.element.addClass("is-guided")}hideImpl(){this.element.removeClass("is-guided")}}class De{constructor(){this.require="^bbFirstTimeContainer",this.restrict="A",this.link=(e,t,n,a)=>{if("false"!==n.showGuidanceTarget){let i=n.componentKey;const r=n.componentKeyList,s=[],o=(e,n)=>{const a=new Ne(t,e,n);a.registerToManager(),s.push(a)};if(!i&&!r)throw new Error("'component-key' or 'component-key-list' attribute required in bb-guidance-target");if(r){const t=e.$watch(r,(e=>{e&&e.length>0&&(e.forEach((e=>{e=we.a(e,Pe),o(e,a)})),t())}))}if(i&&(i=we.a(i,Pe),o(i,a)),"true"!==n.keepGuidanceWhenFocusout){const n=()=>{e.$root.$broadcast("hide-ftue-component",i)};t.on("focusout",n),t.on("keypress",n),e.$on("$destroy",(()=>{t.off("focusout",n),t.off("keypress",n)}))}e.$on("$destroy",(()=>{s.forEach((e=>e.deregisterToManager()))}))}}}}s.module($e,[Ee.a]).directive("bbGuidanceTarget",["$injector",e=>e.instantiate(De)]);var Le=n("XseH"),je=n("iVgd"),Me=n("/qpZ");const Ge="ultra.components.directives.keyHideFtue";class Re{constructor(){this.restrict="A",this.link=(e,t,n)=>{const a=n.bbKeyHideFtue;if(!a)throw new Error("'bb-key-hide-ftue' attribute should have value");const i=()=>{e.$root.$broadcast("hide-ftue-component",a)};t.on("focusout",i),t.on("keypress",i),e.$on("$destroy",(()=>{t.off("focusout",i),t.off("keypress",i)}))}}}s.module(Ge,[]).directive("bbKeyHideFtue",["$injector",e=>e.instantiate(Re)]);var Be=n("cMqb"),Fe=n("+4Px");const Ue="ultra.directives.accessibility.focusNext";class _e{constructor(){this.restrict="A",this.link=(e,t,n)=>{const a="true"===n.bbFocusNextOneTimeOnly;!function(e,t,n){e.on("keydown.focusNext",(a=>{if(a.keyCode===Fe.u&&!a.shiftKey&&t){const i=s.element(t);i.length>=1&&-1!==parseInt(i.attr("tabindex"),10)&&(i.first().focus(),a.preventDefault(),n&&e.off("keydown.focusNext"))}}))}(t,n.bbFocusNext,a)}}}s.module(Ue,[]).directive("bbFocusNext",["$injector",e=>e.instantiate(_e)]);const ze="ultra.directives.accessibility.focusPrev";class qe{constructor(){this.restrict="A",this.link=(e,t,n)=>{const a="true"===n.bbFocusPrevOneTimeOnly;!function(e,t,n){e.on("keydown.focusPrev",(a=>{if(a.keyCode===Fe.u&&a.shiftKey&&t){const i=s.element(t);i.length>=1&&-1!==i.prop("tabindex")&&(i.first().focus(),a.preventDefault(),n&&e.off("keydown.focusPrev"))}}))}(t,n.bbFocusPrev,a)}}}s.module(ze,[]).directive("bbFocusPrev",["$injector",e=>e.instantiate(qe)]);var He=n("i8dz"),Ve=n("K3JI"),We=n("GbAM"),Ke=n("vhkR"),Ye=n("OvxF"),Je=n("TB6y"),Ze=n("ZMjE");const Qe="ultra.directives.contentImportStatusBar";class Xe{constructor(e,t,n,a,i,r,o,l,c){this.$scope=e,this.$rootScope=t,this.element=n,this.$q=a,this.CourseModel=i,this.ultraState=r,this.context=o,this.bbLocalize=l,this.contextCourse=c,this.identifyCourse().then((t=>{this.course=t,this.baseState=r.current.name,n.detach().appendTo(s.element(".side-panel-content")),e.$on("$destroy",(()=>{s.element(".side-panel-content > "+n.get(0).tagName).length>0&&s.element(".side-panel-content > "+n.get(0).tagName).remove()})),e.$watch("taskId",(()=>{e.taskId&&this.getItemsCount().then((e=>{this.notCarriedForwardItemsCount=e}))}))}))}identifyCourse(){return this.courseId=this.$scope.courseId?this.$scope.courseId:this.contextCourse.courseId,this.$scope.$parent.course?this.$scope.$parent.course.model.$asPromise():this.CourseModel.$find(this.courseId).$asPromise()}confirm(){const e="courseImport"+this.course.id.replace(/\_/g,".");this.context.setPreference(e,"false").then((()=>{this.$scope.display=!1}))}undo(){const e="courseImport"+this.course.id.replace(/\_/g,".");this.context.setPreference(e,"true").then((()=>{this.$scope.display=!1}))}goToImportReport(){this.ultraState.goPeekState("content-manage.import-report",{id:this.$scope.taskId})}hideStatusBar(){return-1!==this.ultraState.current.name.indexOf(this.baseState)&&this.ultraState.current.name.length>this.baseState.length}getItemsCount(){return this.course.getImportCopyTaskStatus(this.$scope.taskId).then((e=>{const t=e.$response.data.conversionReportTORest;if(t){return t.filter((e=>O.l.ConversionReportStatus.Success!==e.ultraConversionStatus)).length}return 0}))}}Xe.$inject=["scope","$rootScope","element","$q",O.m.serviceName,$.d,me.b,R.serviceName,w.e];class et{constructor(e){this.$injector=e,this.restrict="E",this.template=Ze,this.scope={display:"=",taskId:"=",courseId:"@?"},this.link=(e,t)=>{e.contentImportStatusBarController=this.$injector.instantiate(Xe,{scope:e,element:t})}}}et.$inject=["$injector"],s.module(Qe,[me.a,R.moduleName,O.N,$.b]).directive("bbContentImportStatusBar",["$injector",e=>e.instantiate(et)]);var tt=n("yA26"),nt=n("SGFZ");const at="ultra.directives.preventClick";class it{constructor(e,t){this.$parse=e,this.$rootScope=t,this.priority=101,this.restrict="A",this.compile=(e,t)=>{const n=this.$parse(t.bbPreventClickIf);return{pre:(e,t)=>{t.on("click",(t=>{function a(){if(n(e,{$event:t}))return t.stopImmediatePropagation(),t.preventDefault(),!1}this.$rootScope.$$phase?e.$evalAsync(a):e.$apply(a)}))}}}}}it.$inject=["$parse","$rootScope"],s.module(at,[]).directive("bbPreventClickIf",["$injector",e=>e.instantiate(it)]);var rt=n("yC9S"),st=n("bd3f");const ot="ultra.components.directives.accessibility.readInfo";class lt{constructor(e,t,n,a){this.scope=e,this.element=t,this.attrs=n,this.timeout=a,this.message="",this.alertMessage="",rt.b.OnRootScope(e,"read-info-directive",((t,n)=>{this.message=n,a((()=>{this.message=""}),e,1e3)})),rt.b.OnRootScope(e,"read-info-directive-alert",((t,n,i)=>{void 0!==i?(this.alertMessage="",a((()=>{this.alertMessage=n}),e,i)):(this.alertMessage=n,a((()=>{this.alertMessage=""}),e,1e3))}))}}lt.$inject=["scope","element","attrs",S.b];class ct{constructor(e,t){this.$injector=e,this.$compile=t,this.restrict="A",this.link=(e,t,n)=>{t.append(this.$compile(st)(e)),e.readInfo=this.$injector.instantiate(lt,{scope:e,element:t,attrs:n})}}}ct.$inject=["$injector","$compile"],s.module(ot,[S.a]).directive("bbReadInfo",["$injector",e=>e.instantiate(ct)]);var dt=n("7/0s");const ut="ultra.components.directives.accessibility.skipLink";class mt{constructor(){this.restrict="E",this.scope={bbSkipLinkTarget:"@",bbSkipLinkFocusNext:"@?"},this.template=dt,this.link=(e,t,n)=>{t.find(".skip-link").on("click",(()=>{let e=t.closest(".bb-offcanvas-panel");e.length||(e=t.closest("#site-wrap"));const a=e.find(n.bbSkipLinkTarget).first();a.focus(),a.is(document.activeElement)||null!=a.attr("tabindex")||(a.attr("tabindex","-1"),a.focus())}))}}}s.module(ut,[]).directive("bbSkipLink",["$injector",e=>e.instantiate(mt)]);var pt=n("TAnh"),ht=n("YOs/"),gt=n("Dwp2"),bt=n("fGgA"),ft=n("4HBD"),vt=n("3vti"),yt=n("cFWd"),St=n("HDxW"),Ct=n("zXZW"),Et=n("k9iv"),It=n("nsX6"),kt=n("OcoR"),wt=n("td+C"),Tt=n("v6Sp"),Ot=n("oPIA"),At=n("e6jQ");var Pt=new class{constructor(e,t){this.integrationService=e,this.portalManager=t,this.sendNewPortal=e=>{this.integrationService.sendEventMessage({type:Ot.i,eventType:Ot.fb.PortalNew,portalId:e.portalId,selector:e.selector,selectorData:e.selectorData},e.owningIntegrationId)},this.sendRemovedPortal=e=>{this.integrationService.sendEventMessage({type:Ot.i,eventType:Ot.fb.PortalRemove,portalId:e.portalId,selector:e.selector,selectorData:e.selectorData},e.owningIntegrationId)},this.sendCallbackPortal=e=>{this.integrationService.sendMessage({type:Ot.f.PortalCallback,callbackId:e.callbackId,portalId:e.portalId,event:e.event},e.owningIntegrationId)},this.sendRenderFailure=e=>{e.requestingIntegrationId?this.integrationService.sendMessage({type:Ot.F,portalId:e.portalId,status:Ot.p.Failure,error:e.error,errorMessage:e.errorMessage},e.requestingIntegrationId):console.warn("Unable to send error to targetless portal")},this.onPortalEvent=(e,t)=>{switch(e){case Ot.eb.NewPortal:this.sendNewPortal(t);break;case Ot.eb.RemovedPortal:this.sendRemovedPortal(t);break;case Ot.eb.CallbackPortal:this.sendCallbackPortal(t);break;case Ot.eb.FailedValidationPortal:this.sendRenderFailure(t)}},this.updatePortal=(e,t)=>{if(!e)return;const{portalId:n,contents:a}=e;this.portalManager.updatePortal({portalId:n,contents:a,requestingIntegrationId:t.id},(()=>{const e=this.portalManager.getPortalData(n).getOwningIntegrationId();if(e&&e!==t.id)return{portalId:n,error:Ot.K.Authorization,errorMessage:`Portal ${n} is already owned by ${e} -- not allowing render from ${t.id}`,requestingIntegrationId:t.id}}))&&(this.portalManager.setPortalOwnership(n,t.id),this.sendRenderSuccess(t.id,n))},this.sendRenderSuccess=(e,t)=>{this.integrationService.sendMessage({type:Ot.F,portalId:t,status:Ot.p.Success},e)}}init(){this.integrationContainer=document.querySelector(".integration-react-container"),this.portalManager.addPortalListener(this.onPortalEvent),this.integrationService.addIntegrationMessageType(Ot.G,this.updatePortal)}generateUniqueDomElement(){const e=At.b(),t=document.createElement("div");return t.id=e,this.integrationContainer.appendChild(t),t}getIntegrationContainer(){return this.integrationContainer}}(wt.a,Tt.e),xt=n("ERkP"),$t=n("7nmT"),Nt=n("MC1S"),Dt=n("wWlP"),Lt=n("caKH");const jt=e=>{const{integrationId:t,contents:n,portalId:a}=e;return xt.createElement(Tt.d,{portalType:Gt,initialOwningIntegrationId:t,initialContents:n,portalId:a})};var Mt=n("4JTD");const Gt="modal",Rt={[Ot.X.Small]:Nt.DialogType.small,[Ot.X.Large]:Nt.DialogType.large,[Ot.X.Medium]:Nt.DialogType.normal};var Bt=new class{constructor(e,t,n,a){this.integrationService=e,this.integrationPortalService=t,this.componentManager=n,this.portalManager=a,this.modalWhitelist=new Map,this.isValidModalElement=(e,t)=>{if(!Ot.O.has(e.props.width))return console.warn(`Invalid prop \`width\` of value ${e.props.width} supplied to ${e.tag}, expected one of [${Object.values(Ot.N)}].`),!1;if(!e.children)return console.warn(`Children are needed for ${Ot.r.Modal}, but no value for \`children\` was given.`),!1;if("string"==typeof e.children)return console.warn("Incorrect children value: expected `Array` but received `string`."),!1;const n=[Ot.r.ModalHeader,Ot.r.ModalBody,Ot.r.ModalFooter];if(e.children.length!==n.length)return console.warn(`Incorrect number of children elements: expected ${n.length}, but received ${e.children.length}.`),!1;for(let a=0;a<n.length;a++){const i=e.children[a];if(i.tag!==n[a])return console.warn(`Incorrect order of children: position ${a} expected ${n[a]}, but received ${i.tag}.`),!1;if(!this.componentManager.isValidComponent({componentContext:Gt,componentName:n[a],contents:i,integrationId:t}))return!1}return!0},this.onPortalModal=(e,t)=>{if(!this.isValidRequestParameters(e,t))return;const n=Dt.a.length()>0,a=Lt.b.getInstance().isModalDisplaying();if(this.componentManager.overMaxComponents(Gt)||a||n)return console.error("A modal is already open; not opening another one."),void this.sendModalMessage(t,null,e.modalId,Ot.p.Failure,Ot.s.ModalAlreadyOpenError,"A modal is already open; not opening another one.");if(!this.portalManager.validateContents({portalType:Gt,contents:e.contents,integrationId:t.id}).passed)return void this.sendModalMessage(t,null,e.modalId,Ot.p.Failure,Ot.s.FailedComponentValidationError,`Component validation failed; not rendering ${Ot.r.Modal}.`);this.modalId=e.modalId,this.owningIntegration=t;const i=At.b();this.currentModal=this.integrationPortalService.generateUniqueDomElement();const r={owningIntegrationId:t.id,portalId:i,element:this.currentModal};return this.render(r,e.contents).then((()=>{this.sendModalMessage(t,r.portalId,this.modalId,Ot.p.Success)}))},this.isValidRequestParameters=(e,t)=>e.type&&e.type===Ot.M.ModalNew?e.modalId?!!e.contents||(console.warn("Not a valid new modal request, `contents` were not provided."),this.sendModalMessage(t,null,e.modalId,Ot.p.Failure,Ot.s.MissingContentsError,"Not a valid new modal request, `contents` were not provided."),!1):(console.warn("Not a valid new modal request, `modalId` must be a unique non-empty value."),this.sendModalMessage(t,null,e.modalId,Ot.p.Failure,Ot.s.InvalidIdError,"Not a valid new modal request, `modalId` must be a unique non-empty value."),!1):(console.warn(`Not a valid new modal request, \`type\` must be ${Ot.M.ModalNew}.`),this.sendModalMessage(t,null,e.modalId,Ot.p.Failure,Ot.s.InvalidRequestTypeError,`Not a valid new modal request, \`type\` must be ${Ot.M.ModalNew}.`),!1),this.render=(e,t)=>new Promise((n=>{$t.render(xt.createElement(Mt.a,{babelfishInstance:this.bbLocalize.intl,babelfishFormatInstance:this.bbLocalize.frmt,locale:this.bbLocalize.getLocale(null),isRtl:this.bbLocalize.isRTL()},xt.createElement(jt,{integrationId:e.owningIntegrationId,portalId:e.portalId,contents:t})),e.element,(()=>{n()}))})),this.onPortalModalClose=(e,t)=>this.owningIntegration&&this.owningIntegration.id!==t.id?(console.warn(`The integration ${t.id} does not own the modal of ${e.modalId}; not closing modal`),void this.sendModalCloseResponseMessage(t,e.modalId,Ot.p.Failure,Ot.s.WrongOwnerError,`The integration ${t.id} does not own the modal of ${e.modalId}; not closing modal`)):this.modalId!==e.modalId?(console.warn(`No modal has an id of ${e.modalId}`),void this.sendModalCloseResponseMessage(t,e.modalId,Ot.p.Failure,Ot.s.ModalNotFoundError,`No modal has an id of ${e.modalId}`)):void this.closePortalModal(e.modalId,t),this.closePortalModal=(e,t)=>{this.currentModal&&($t.unmountComponentAtNode(this.currentModal),this.sendModalCloseResponseMessage(t||this.owningIntegration,e||this.modalId,Ot.p.Success))},this.sendModalMessage=(e,t,n,a,i,r)=>{this.integrationService.sendMessage({type:Ot.M.ModalResponse,status:a,portalId:t,modalId:n,...i&&{error:i},...r&&{errorMessage:r}},e)},this.sendModalCloseResponseMessage=(e,t,n,a,i)=>{this.integrationService.sendMessage({type:Ot.M.ModalCloseResponse,status:n,modalId:t,...a&&{error:a},...i&&{errorMessage:i}},e)}}init(e){this.bbLocalize=e,this.integrationService.addIntegrationMessageType(Ot.M.ModalNew,this.onPortalModal),this.integrationService.addIntegrationMessageType(Ot.M.ModalClose,this.onPortalModalClose),this.initializeWhitelist()}initializeWhitelist(){this.modalWhitelist.set(Ot.r.Modal,{props:{width:!0},isValid:(e,t)=>this.isValidModalElement(e,t),render:(e,t,n)=>{const{width:a,...i}=t,r=Rt[a];return xt.createElement(Lt.c,{...i,dialogContentProps:{type:r},hidden:!1,onDismiss:()=>this.closePortalModal()},n)}}),this.modalWhitelist.set(Ot.r.ModalHeader,{props:{title:!1},isValid:e=>(e.props&&e.props.title&&"string"!=typeof e.props.title&&console.warn(`Invalid prop \`title\` value: expected \`string\` but received \`${typeof e.props.title}\`, defaulting to no title.`),!0),render:(e,t,n)=>xt.createElement(Nt.DialogHeader,{...t,analyticsId:"integration.modal.header",showCloseButton:!0,onDismiss:()=>this.closePortalModal(),closeButtonAriaLabel:this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(null),key:"global.close"})},n)}),this.modalWhitelist.set(Ot.r.ModalBody,{isValid:e=>!0,render:(e,t,n)=>xt.createElement("div",{key:t.key},n)}),this.modalWhitelist.set(Ot.r.ModalFooter,{isValid:e=>!0,render:(e,t,n)=>xt.createElement(Nt.DialogFooter,{...t},n)}),this.componentManager.addComponentType(Gt,1,this.modalWhitelist)}}(wt.a,Pt,Tt.b,Tt.e),Ft=n("q/wk"),Ut=n("N7x3"),_t=n("x9Ok");const zt=e=>{const{component:t,contents:n}=e,[a,i]=xt.useState(t.shown);return xt.useEffect((()=>(i(t.shown),t.addListener(i),()=>{t.removeListener(i)})),[t]),a&&xt.createElement(Tt.d,{portalType:nn,initialOwningIntegrationId:t.integrationId,initialContents:n,portalId:t.portalId})};var qt=n("uFyr"),Ht=n("jGf1"),Vt=n("xkx/");const Wt={[Ot.X.Small]:250,[Ot.X.Medium]:300,[Ot.X.Large]:500},Kt={[Ot.y.Light]:Vt.DefaultPalette.white,[Ot.y.Dark]:Vt.DefaultPalette.neutralDark},Yt={[Ot.Q.BottomLeft]:Ht.ScreenPosition.bottomLeft,[Ot.Q.BottomRight]:Ht.ScreenPosition.bottomRight,[Ot.Q.TopLeft]:Ht.ScreenPosition.topLeft,[Ot.Q.TopRight]:Ht.ScreenPosition.topRight},Jt=(e,t)=>{const n=Wt[Ot.X.Medium];return!e.isSmallBreakpoint()||Wt[t]<=n?Wt[t]:(console.warn("Requested prop `size` is greater than current breakpoint size: reducing `size` to medium breakpoint."),n)},Zt=e=>{if(e.isSmallBreakpoint())return Nt.DirectionalHint.bottomCenter},Qt=(e,t)=>{if(e.isSmallBreakpoint())return Object(Ht.getScreenPositionPoint)(Ht.ScreenPosition.bottomCenter);if(t.selector.type===Ot.S.Region){const e=Yt[t.selector.value];return Object(Ht.getScreenPositionPoint)(e)}return t.targetElementFinder()},Xt=e=>e.isLargeBreakpoint()?Ot.w.Large:e.isMediumBreakpoint()?Ot.w.Medium:Ot.w.Small,en=Object(qt.windowResizingResponsiveComponentWrapper)((e=>{const{children:t,hideBeak:n,key:a,notificationData:i,onDismiss:r,size:s,theme:o,UltraWindowSize:l}=e,c=Qt(l,i),d=Xt(l),u=Jt(l,s),m=Kt[o],p=Zt(l);return xt.createElement(Nt.Callout,{key:a,target:c,onDismiss:r,calloutWidth:u,setInitialFocus:!0,isBeakVisible:!n,directionalHint:p,className:`integration-notification-${o}`,backgroundColor:m,minPagePadding:d,allowDismissOnFocusTarget:!0},xt.createElement("div",{tabIndex:0},t))}));class tn{constructor(e,t){this.notificationData=e,this.guidanceManager=t,this.componentType="IntegrationNotification",this.priority=2*y.c,this.isInitialHide=!1,this._shown=!1,this.listeners=[],this.shouldShow=()=>new Promise(((e,t)=>{e(!!this.notificationData.targetElementFinder())})),this.addListener=e=>{this.listeners.push(e)},this.removeListener=e=>{const t=this.listeners.indexOf(e);-1!==t&&this.listeners.splice(t,1)},this.onShown=()=>{this.setShown(!0)},this.onHidden=e=>{this.setShown(!1)},this.dispose=()=>{this.listeners=[],this.guidanceManager.deregisterComponent(this)},this.componentKey=`integration.notification.${e.portalId}`,this.notificationId=e.notificationId,this.portalId=e.portalId,this.integrationId=e.owningIntegrationId,this.data=e,this.guidanceManager.registerComponent(this),this.guidanceManager.startQueue()}get shown(){return this._shown}setShown(e){this.shown!==e&&(this._shown=e,this.listeners.forEach((t=>t(e))))}}const nn="notification";var an=new class{constructor(e,t,n,a,i){this.integrationService=e,this.integrationPortalService=t,this.componentManager=n,this.ftueManager=a,this.portalManager=i,this.notificationWhitelist=new Map,this.isValidNotificationElement=e=>Ot.Y.has(e.props.size)?(e.props.theme&&!Ot.z.has(e.props.theme)&&console.warn(`Invalid prop \`theme\` of value ${e.props.theme} supplied to ${e.tag}, expected one of [${Object.values(Ot.y)}];\n        defaulting to ${Ot.y.Light} theme.`),e.props.hideBeak&&"boolean"!=typeof e.props.hideBeak&&console.warn(`Invalid prop \`hideBeak\` value: expected a \`boolean\` but received \`${typeof e.props.hideBeak}\`; defaulting to a visible beak.`),!0):(console.warn(`Invalid prop \`size\` of value ${e.props.size} supplied to ${e.tag}, expected one of [${Object.values(Ot.X)}].`),!1),this.findElementByAnalyticsId=e=>{if(!e)return null;const t=document.querySelector(`[data-analytics-id="${e}"]`);return t||document.querySelector(`[analytics-id="${e}"]`)},this.createFTUEComponent=(e,t)=>{const n=new tn(t,this.ftueManager),a={component:n,element:t.element};return n.addListener((n=>{if(!n)return void this.sendNotificationStatus(e,t.portalId,t.notificationId,Ot.x.Removed);if(!t.targetElementFinder())return this.closeNotification(t.portalId),void this.sendNotificationStatus(e,t.portalId,t.notificationId,Ot.x.Failed);this.currentNotification=a,this.sendNotificationStatus(e,t.portalId,t.notificationId,Ot.x.Visible)})),this.notificationMap.set(t.portalId,a),n},this.onPortalNotification=(e,t)=>{if(!e.selector||!Ot.T.has(e.selector.type))return console.warn(`Invalid selector type provided ${e.selector&&e.selector.type}`),void this.sendNotificationResponseMessage(t,null,Ot.p.Failure,Ot.v.InvalidSelectorError,`Invalid selector type provided ${e.selector&&e.selector.type}`);if(e.selector.type===Ot.S.Region&&!Ot.R.has(e.selector.value))return console.warn(`Invalid selector value provided ${e.selector&&e.selector.value}`),void this.sendNotificationResponseMessage(t,null,Ot.p.Failure,Ot.v.InvalidSelectorError,`Invalid selector value provided ${e.selector&&e.selector.value}`);if(!this.portalManager.validateContents({portalType:nn,contents:e.contents,integrationId:t.id}).passed)return void this.sendNotificationResponseMessage(t,null,Ot.p.Failure,Ot.v.FailedComponentValidationError,`Component validation failed; not rendering ${Ot.u.Notification}.`);const n=this.getTargetElementFinder(e.selector,t);if(!n)return;const a={element:this.integrationPortalService.generateUniqueDomElement(),portalId:At.b(),notificationId:At.b(),owningIntegrationId:t.id,targetElementFinder:n,selector:e.selector},i=this.createFTUEComponent(t,a);return this.render(i,a.element,e.contents).then((()=>{this.sendNotificationResponseMessage(t,a.notificationId,Ot.p.Success),this.sendNotificationStatus(t,a.portalId,a.notificationId,Ot.x.Queued)}))},this.removeNotificationFromQueue=e=>{e.dispose(),this.notificationMap.delete(e.portalId)},this.clearPortalNotification=()=>{this.notificationMap.forEach((e=>{const t=this.findNotification(e.component.notificationId);this.currentNotification&&this.currentNotification.component.notificationId===t.notificationId?this.closeNotification(t.portalId):this.removeNotificationFromQueue(t)}))},this.onPortalNotificationClose=(e,t)=>{const n=this.findNotification(e.notificationId);return n?n.integrationId!==t.id?(console.warn(`${t.id} does not have ownership of the current notification`),void this.sendCloseNotificationResponse(t,e.notificationId,Ot.p.Failure,Ot.v.NoOwnershipError,`${t.id} does not have ownership of the current notification--not closing notification`)):(this.currentNotification&&this.currentNotification.component.notificationId===e.notificationId?this.closeNotification():(this.removeNotificationFromQueue(n),this.sendNotificationStatus(t,n.portalId,n.notificationId,Ot.x.Removed)),void this.sendCloseNotificationResponse(t,e.notificationId,Ot.p.Success)):(console.warn("Notification not found"),void this.sendCloseNotificationResponse(t,e.notificationId,Ot.p.Failure,Ot.v.NotificationNotFoundError,"Notification not found"))},this.render=(e,t,n)=>new Promise((a=>{$t.render(xt.createElement(Mt.a,{babelfishInstance:this.bbLocalize.intl,babelfishFormatInstance:this.bbLocalize.frmt,locale:this.bbLocalize.getLocale(null),isRtl:this.bbLocalize.isRTL()},xt.createElement(zt,{component:e,contents:n})),t,(()=>{a()}))})),this.sendCloseNotificationResponse=(e,t,n,a,i)=>{this.integrationService.sendMessage({type:Ot.P.NotificationCloseResponse,notificationId:t,status:n,...a&&{error:a},...i&&{errorMessage:i}},e)},this.sendNotificationResponseMessage=(e,t,n,a,i)=>{this.integrationService.sendMessage({type:Ot.P.NotificationResponse,status:n,notificationId:t,...a&&{error:a},...i&&{errorMessage:i}},e)},this.sendNotificationStatus=(e,t,n,a)=>{this.integrationService.sendMessage({type:Ot.P.NotificationStatus,status:a,notificationId:n,portalId:t},e)},this.closeNotification=e=>{if(!this.currentNotification&&!e)return;let t=this.currentNotification;e&&(t=this.notificationMap.get(e)),t&&($t.unmountComponentAtNode(t.element),setTimeout((()=>{this.removeNotificationFromQueue(t.component),this.currentNotification=void 0}),500))},this.notificationMap=new Map}init(e){this.bbLocalize=e,this.integrationService.addIntegrationMessageType(Ot.P.NotificationNew,this.onPortalNotification),this.integrationService.addIntegrationMessageType(Ot.P.NotificationClose,this.onPortalNotificationClose),this.notificationWhitelist.set(Ot.u.Notification,{props:{size:!0,theme:!1,hideBeak:!1,directionalHint:!1},isValid:e=>this.isValidNotificationElement(e),render:(e,t,n)=>{const{key:a,size:i,theme:r=Ot.y.Light,hideBeak:s}=t,o=this.notificationMap.get(e);return xt.createElement(en,{size:i,hideBeak:s,key:a,notificationData:o.component.data,onDismiss:()=>{this.closeNotification(e)},theme:r},n)}}),this.componentManager.addComponentType(nn,0,this.notificationWhitelist)}getTargetElementFinder(e,t){if(e.type===Ot.S.Region)return()=>this.integrationPortalService.getIntegrationContainer();const n=()=>this.findElementByAnalyticsId(e.value);if(n())return n;console.warn("Invalid notification target"),this.sendNotificationResponseMessage(t,null,Ot.p.Failure,Ot.v.InvalidTargetError,"Invalid notification target")}findNotification(e){const t=Array.from(this.notificationMap.values()).find((t=>t.component.notificationId===e));if(t)return t.component}}(wt.a,Pt,Tt.b,y.f,Tt.e);var rn=n("Zwiy"),sn=n("YK4x");const on=e=>{const t=Object(sn.a)(),{panelType:n,panelTitle:a,panelSubtitle:i,integrationId:r,showPanel:s,portalId:o,onPanelClose:l,stackIndex:c,useCustomPadding:d,closeButtonAriaLabel:u,resolver:m}=e,p=null!=u?u:t("global.close");return xt.createElement(rn.BbPanel,{isOpen:s,onDismiss:()=>l(o,r),type:n,stackIndex:c,analyticsId:"components.directives.integration.integrationPanel",excludeContentPadding:d,closeButtonAriaLabel:p},xt.createElement(rn.BbPanelHeader,{title:a,smallHeaderTitle:i,navMenuAriaLabel:t("global.navigationMenu")}),xt.createElement("div",{className:"integration-panel"},xt.createElement("div",{className:"integration-panel-contents"},xt.createElement(Tt.d,{portalId:o,initialOwningIntegrationId:r,portalType:ln,skipCustomValidation:!0,onRegistered:m}))))},ln="panel",cn=e=>{switch(e){case Ot.W.Full:return Nt.BbPanelType.full;case Ot.W.Small:return Nt.BbPanelType.peek;default:return console.warn(`Received unknown panel type ${e}`),null}};var dn=new class{constructor(e,t,n,a){this.integrationService=e,this.integrationPortalService=t,this.componentManager=n,this.portalManager=a,this.onPortalPanel=(e,t)=>{const{panelTitle:n,correlationId:a,useCustomPadding:i}=e;if(this.componentManager.overMaxComponents(ln))return console.warn("Panel is already open; not opening another one"),void this.sendPanelMessage(t,null,Ot.p.Failure,a);if(!n)return console.warn("Received a panel event without a panelTitle; not opening panel"),void this.sendPanelMessage(t,null,Ot.p.Failure,a);if(null===cn(e.panelType))return void this.sendPanelMessage(t,null,Ot.p.Failure,a);const r=At.b();if(!this.updatePanelAttributes(e,r))return console.warn("Received a panel event without proper attributes or with a missing callback id."),void this.sendPanelMessage(t,null,Ot.p.Failure,a);const s=this.integrationPortalService.generateUniqueDomElement();return s.className="integration-panel",this.currentPanelData={element:s,panelType:e.panelType,panelTitle:e.panelTitle,panelSubtitle:e.panelSubtitle,owningIntegrationId:t.id,portalId:r,useCustomPadding:i||!1,closeButtonAriaLabel:e.closeButtonAriaLabel},this.renderPanel(this.currentPanelData,!0).then((()=>{this.sendPanelMessage(t,this.currentPanelData.portalId,Ot.p.Success,a)}))},this.updatePanelAttributes=(e,t)=>{const n=e.attributes;if(!n)return!0;let a={};const i=Object.keys(n).filter((e=>!n[e]||!n[e].callbackId));return i.length>0?(console.warn(`Panel attributes [${i.join(",")}] are missing callbackId parameters`),!1):(Object.keys(n).forEach((e=>{const t=n[e];a={...a,[e]:{callbackId:t.callbackId}}})),this.panelAttributesEvents.set(t,{portalId:t,subscribedAttributes:a}),!0)},this.renderPanel=(e,t)=>{const n=document.getElementsByClassName("bb-offcanvas-panel").length+1,a=cn(e.panelType);return new Promise((i=>{$t.render(xt.createElement(Mt.a,{locale:this.bbLocalize.getLocale(null),babelfishInstance:this.bbLocalize.intl,babelfishFormatInstance:this.bbLocalize.frmt,isRtl:this.bbLocalize.isRTL()},xt.createElement(on,{panelType:a,panelTitle:e.panelTitle,panelSubtitle:e.panelSubtitle,integrationId:e.owningIntegrationId,showPanel:t,portalId:e.portalId,onPanelClose:this.onPanelCloseAction,stackIndex:n,useCustomPadding:e.useCustomPadding,resolver:i,closeButtonAriaLabel:e.closeButtonAriaLabel})),e.element)}))},this.onPortalPanelClose=(e,t)=>{const n=t.id,a=this.portalManager.getPortalData(e.id);if(a){if(a.getOwningIntegrationId()===n)return this.renderPanel(this.currentPanelData,!1);console.warn(`The integration ${n} does not own the portalId of ${e.id}; not closing anything`)}else console.warn(`no panel has an id of ${e.id}`)},this.onPanelCloseAction=(e,t)=>{this.renderPanel(this.currentPanelData,!1);const n=this.portalManager.getPortalData(e);if(!n)return;const a=Ot.U.onClose,i=this.panelAttributesEvents.get(n.portalId),r=i&&i.subscribedAttributes[a],s=this.integrationService.findIntegration(t);if(this.portalManager.removePortal({portalId:e,owningIntegrationId:t}),this.removePanel(this.currentPanelData.element),this.currentPanelData=null,r&&s){const e={type:Ot.f.PortalCallback,callbackId:i.subscribedAttributes[a].callbackId,portalId:n.portalId,event:a};this.integrationService.sendMessage(e,s)}},this.sendPanelMessage=(e,t,n,a)=>{this.integrationService.sendMessage({type:Ot.V.PanelResponse,status:n,portalId:t,correlationId:a},e)},this.panelAttributesEvents=new Map}init(e){this.bbLocalize=e,this.integrationService.addIntegrationMessageType(Ot.V.PanelNew,this.onPortalPanel),this.integrationService.addIntegrationMessageType(Ot.V.PanelClose,this.onPortalPanelClose),this.componentManager.addComponentType(ln,1)}removePanel(e){if(!e)return;setTimeout((()=>{$t.unmountComponentAtNode(e),e.remove()}),500)}}(wt.a,Pt,Tt.b,Tt.e),un=n("vJBG"),mn=n("zJP2"),pn=n("4vd5"),hn=n("CY5M");const gn=e=>{const{handle:t,customParameters:n,courseId:a,style:i}=e,r=((e,t,n)=>{const[a,i]=Object(xt.useState)("");return Object(xt.useEffect)((()=>{const a=Object(hn.i)({bbFileData:{linkType:p.i.LtiPlacement.toString()},handle:e,courseId:n});a.customParameters=t,i(Object(hn.k)(a))}),[e,t,n]),a})(t,n,a);return xt.createElement("iframe",{src:r,style:i})};var bn=new class{constructor(e){this.componentManager=e}init(e){this.componentManager.addGlobalComponent(Ot.j.LtiLaunch,{props:{handle:!0,customParameters:!1,courseId:!1,style:!1},isValid:e=>!e.children,render:(t,n)=>{var a,i;const r=null!==(a=n.courseId)&&void 0!==a?a:null===(i=e.getCurrentUrlParams())||void 0===i?void 0:i.courseId;return xt.createElement(gn,{courseId:r,...n})}})}}(Tt.b),fn=n("Agfx");const vn=Object(fn.makeStyles)({container:{maskImage:e=>`url(${e.url})`,WebkitMaskImage:e=>`url(${e.url})`,height:e=>`${e.height}`,width:e=>`${e.width}`,backgroundColor:"currentColor"}}),yn=new RegExp(`(^[\\u0000-\\u001F ]*${/d([\r\n\t])*a\1*t\1*a\1*:\1*i\1*m\1*a\1*g\1*e\1*\/\1*s\1*v\1*g\1*\+\1*x\1*m\1*l\1*;\1*/i.source})|(${/^(?:http(s)?:\/\/)?[\w.-]+(?:\.[\w\.-]+)+[\w\-\._~:/?#[\]@!\$&'\(\)\*\+,;=.]+$/i.source})`,"i"),Sn=new Map([["uef--base-nav-svg","svg-icon medium-icon default integration-svg-icon"]]),Cn=new Map([["classname",e=>Object(Tt.h)(e,Sn)]]),En=e=>{const{url:t,height:n,width:a,className:i,style:r}=e,s=vn({url:t,height:n,width:a});return xt.createElement("div",{className:`${i} ${s.container}`,style:r})};var In=new class{constructor(e){this.componentManager=e,this.init=()=>{this.componentManager.addGlobalComponent(Ot.j.SvgIcon,{props:{url:!0,height:!0,width:!0,className:!1,style:!1},isValid:e=>this.isValidSvgUrl(e.props),render:(e,t)=>xt.createElement(En,{...t}),transformers:Cn})},this.isValidSvgUrl=e=>e.url?e.height||e.width?!!yn.test(e.url)||(console.warn(`Unsupported URI received for ${Ot.j.SvgIcon}: [${e.url}] Only HTTPS and data:image/svg+xml data URIs are supported.`),!1):(console.warn(`A height and/or width is required for ${Ot.j.SvgIcon}, but no value for \`height\` and/or \`width\` was given.`),!1):(console.warn(`A url is required for ${Ot.j.SvgIcon}, but no value for \`url\` was given.`),!1)}}(Tt.b),kn=n("7n5u");const wn=new Map([["uef--action-menu--extension","action-menu-extension"],["uef--action-menu--labeled","action-menu-labeled"]]),Tn=new Map([["uef--course-details--menu-label","blue-link select-value"]]);var On=new class{constructor(e){this.componentManager=e}init(){const e=new Map;e.set("items",((e,t,n)=>e?e.map((e=>({...e,callback:Object(Tt.g)(e.callbackId,Ot.L.onClick,t,n)}))):e)),this.componentManager.addGlobalComponent(Ot.j.ActionMenu,{props:{items:!0,label:!0,className:!0,labelClassName:!0},transformers:e,isValid:e=>!e.children,render:(e,t)=>{var n;if(!t.items)return;const a=t.items.map(((e,t)=>({key:t,name:e.name,onClick:e.callback}))),i=t.label?xt.createElement("span",{className:Object(Tt.h)(t.labelClassName,Tn)},t.label):null,r={items:a},s=`components.services.integration.${t.analyticsId||"unknown"}.actionMenu`;return xt.createElement(Nt.ActionMenu,{ariaLabel:t.ariaLabel,menuProps:r,className:null!==(n=Object(Tt.h)(t.className,wn))&&void 0!==n?n:"action-menu-extension",analyticsId:s},i)}})}}(Tt.b);const An=(e,t,n)=>{Ft.a.init(),Pt.init(),un.a.init(e,t),mn.a.init(t),dn.init(e),Bt.init(e),an.init(e),Ut.a.addHoverListener(),Ut.a.addClickListener(),_t.b.subscribe(((e,t)=>{wt.a.sendEventMessage({type:Ot.i,eventType:Ot.fb.Route,routeName:e,routeData:t})}),_t.a.Changed),_t.b.subscribe(((e,t)=>{e.includes("classic")&&an.clearPortalNotification(),wt.a.sendEventMessage({type:Ot.i,eventType:Ot.fb.RouteChanging,routeName:e,routeData:t})}),_t.a.Changing),pn.a.init(e),bn.init(n),In.init(),On.init(),kn.b.init()};class Pn{constructor(e,t){this.routeListener=e,this._started=!0,this.handleRouteChanging=()=>{this.started=!1},this.handleRouteChanged=()=>{this.started=!0},this.onStateChanged=e=>{this.startedCallback=e},t.addWatcher(this)}start(){this.routeListener.subscribe(this.handleRouteChanging,_t.a.Changing),this.routeListener.subscribe(this.handleRouteChanged,_t.a.Changed)}get started(){return this._started}set started(e){this._started=e,this.startedCallback&&this.startedCallback(e)}}var xn=n("0+Qs"),$n=n("4HXK"),Nn=n("eUpQ"),Dn=n("WIGI"),Ln=n("6Ksg"),jn=n("vT39"),Mn=n("WShm"),Gn=n("OmEq");const Rn="ultra.directives.validate.emailAddress";class Bn{constructor(){this.require="ngModel",this.link=(e,t,n,a)=>{a.$validators.email=function(e){return Gn.b.test(e)||!e}}}}s.module(Rn,[]).directive("bbValidateEmailAddress",["$injector",e=>e.instantiate(Bn)]);const Fn="ultra.directives.validate.emailAddresses";class Un{constructor(){this.require="ngModel",this.link=(e,t,n,a)=>{a.$validators.email=function(e){return!e||Gn.a.test(e)}}}}s.module(Fn,[]).directive("bbValidateEmailAddresses",["$injector",e=>e.instantiate(Un)]);const _n="ultra.directives.validate.input";class zn{constructor(){this.require="?ngModel",this.link=(e,t,n,a)=>{a&&(t.on("focusin",(()=>{a.$focused=!0,e.$root.$$phase||e.$$phase||e.$root.$digest()})),t.on("focusout",(()=>{a.$focused=!1,e.$root.$$phase||e.$$phase||e.$root.$digest()})))}}}s.module(_n,[]).directive("input",["$injector",e=>e.instantiate(zn)]).directive("textarea",["$injector",e=>e.instantiate(zn)]);const qn="ultra.directives.validate.kvp";class Hn{constructor(){this.require="ngModel",this.restrict="A",this.link=(e,t,n,a)=>{a.$validators.kvp=this.getKVPValidator(e,t,n,a)}}getKVPValidator(e,t,n,a){return(e,t)=>{const n=t+"";if(""===n)return!0;let a=!0;return n.split("\n").forEach((e=>{if(e.trim().length>0&&a){2!==e.split("=").length&&(a=!1)}})),a}}}s.module(qn,[]).directive("bbValidateKeyValuePair",["$injector",e=>e.instantiate(Hn)]);var Vn=n("f4B+");const Wn="ultra.directives.validate.maxlength",Kn="bbValidateMaxlength";class Yn{constructor(e){this.bbLocalize=e,this.require="ngModel",this.restrict="A",this.getMaxlengthValidator=(e,t,n,a)=>e=>{const t=r("<textarea/>").val(e).text()||e;if(null==t)return!0;const i=n.bbValidateMaxlength;if(null==i||""===i)return!0;let s=t.length;"true"===(!!n.maxlengthAfterEscape&&n.maxlengthAfterEscape)&&(s=Vn.a.HTML(t).length);let o=n.maxlengthNotice?n.maxlengthNotice:Math.floor(.9*i).toString();return o.match(/\%$/)&&(o=o.replace(/\D/,""),o=Math.floor(i*(1-o/100)).toString()),s>i?(delete a.$warning.maxlengthWarning,a.$error.maxlength={maxlength:i,diff:s-i},a.$errorImmediate.maxlengthImmediate={maxlength:i,diff:s-i},!1):s>=o?(delete a.$error.maxlength,delete a.$errorImmediate.maxlengthImmediate,a.$warning.maxlengthWarning={maxlength:i,left:i-s},!0):(delete a.$error.maxlength,delete a.$errorImmediate.maxlengthImmediate,delete a.$warning.maxlengthWarning,!0)},this.link=(e,t,n,a)=>{a.$validators.maxlengthValidator=this.getMaxlengthValidator(e,t,n,a),a.$warning||(a.$warning={}),a.$errorImmediate||(a.$errorImmediate={})}}}s.module(Wn,[R.moduleName]).directive(Kn,[R.serviceName,e=>new Yn(e)]);const Jn="ultra.directives.validate.number";class Zn{constructor(e){this.bbLocalize=e,this.require="ngModel",this.restrict="A",this.selectionStart=0,this.selectionEnd=0,this.oldViewValue="",this.getNumberParser=(e,t,n,a)=>t=>{if(a.$isEmpty(t))return a.$setValidity("numberInvalid",!0),t;const i=this.regroup(e,a);let r=this.bbLocalize.parseNumberSync(i,e);if(Number.isNaN(r))return a.$setValidity("numberInvalid",!1),r;a.$setValidity("numberInvalid",!0);const s=this.bbLocalize.getDecimalStringForScope(e);let o=r.toString();const l=o.split(String(s)),c=n&&n.maxDecimal?Number(n.maxDecimal):R.Service.defaultDecimalPrecision;return l.length>1&&l[1].length>c&&(o=l[0]+s+l[1].substring(0,c),r=parseFloat(o),this.reformatFromModel(a,r)),this.updateSelection(e,a,this.target,this.key),r},this.getMinValidator=(e,t,n,a)=>e=>{const t=parseFloat(n.min),i=a.$isEmpty(e);if(!i&&Number.isNaN(Number(e)))return delete a.$error.numberSmall,!1;const r=i||e>=t;return r?delete a.$error.numberSmall:a.$error.numberSmall={min:t},r},this.getMaxValidator=(e,t,n,a)=>e=>{const t=parseFloat(n.max),i=a.$isEmpty(e);if(!i&&Number.isNaN(Number(e)))return delete a.$error.numberLarge,!1;const r=i||e<=t;return r?delete a.$error.numberLarge:a.$error.numberLarge={max:t},r},this.getNumberFormatter=(e,t,n,a)=>t=>{const i=t||a.$modelValue;if(a.$setValidity("numberInvalid",!0),i||0===i){const t=n&&n.maxDecimal?n.maxDecimal:R.Service.defaultDecimalPrecision;return this.bbLocalize.formatNumberSync(parseFloat(i),e,{maximumFractionDigits:t,useGrouping:!0})}return""},this.regroup=(e,t)=>{const n=this.bbLocalize.regroupNumberSync(t.$viewValue,e);return t.$viewValue!==n&&(t.$viewValue=n,t.$render(),t.$validate()),n},this.reformatFromModel=(e,t)=>{t=t||e.$modelValue;const n=e.$formatters;let a=n.length,i=t;for(;a--;)i=n[a](i);e.$viewValue!==i&&(e.$viewValue=i,e.$render(),e.$validate())},this.allowInput=(e,t,n,a)=>{if(!t||!t.key)return!1;const i=a.$viewValue,{selectionStart:r,selectionEnd:s}=t.target,o=this.bbLocalize.getGroupingStringForScope(e),l=this.bbLocalize.getDecimalStringForScope(e),c=this.bbLocalize.parseNumberSync(i,e),d=n&&n.maxDecimal?Number(n.maxDecimal):R.Service.defaultDecimalPrecision,u=s-r>1,m=t.key===o,p=s-r==0&&"Backspace"===t.key&&i[r-1]===o,h=s-r==0&&"Delete"===t.key&&i[r]===o,g=s-r==1&&i[r]===o&&("Backspace"===t.key||"Delete"===t.key),b=s-r==0&&!Number.isNaN(Number(t.key))&&this.target.selectionStart>i.indexOf(l)&&i.split(l)[1]&&i.split(l)[1].length>=d;u||Number.isNaN(c)||!(p||h||m||g||b)||t.preventDefault()},this.updateSelection=(e,t,n,a)=>{if(!a||-1!==["ArrowLeft","ArrowUp","ArrowRight","ArrowDown","Shift","Meta","Tab","End","Home","-"].indexOf(a))return;const i=Math.max(0,this.selectionEnd+t.$viewValue.length-this.oldViewValue.length);n.selectionStart=i,n.selectionEnd=i},this.link=(e,t,n,a)=>{t.on("blur",(()=>{a.$valid&&this.reformatFromModel(a)})),t.on("focus",(()=>{t.select()})),t.on("keydown",(t=>{this.target=t.target,this.key=t.key,this.selectionStart=this.target.selectionStart,this.selectionEnd=this.target.selectionEnd,this.oldViewValue=a.$viewValue,this.allowInput(e,t,n,a)})),a.$parsers.push(this.getNumberParser(e,t,n,a)),a.$formatters.push(this.getNumberFormatter(e,t,n,a)),n.min&&(a.$validators.minValidator=this.getMinValidator(e,t,n,a),n.$observe("min",(()=>{a.$validate()}))),n.max&&(a.$validators.maxValidator=this.getMaxValidator(e,t,n,a),n.$observe("max",(()=>{a.$validate()})))}}}s.module(Jn,[R.moduleName]).directive("bbValidateNumber",[R.serviceName,e=>new Zn(e)]);const Qn="ultra.directives.validate.time";class Xn{constructor(e){this.bbLocalize=e,this.require="ngModel",this.restrict="A",this.getISOTime=e=>("0"+e.getHours()).slice(-2)+":"+("0"+e.getMinutes()).slice(-2),this.getTimeParser=(e,t,n,a)=>i=>{if(a.$isEmpty(i))return a.$setValidity("time",!0),a.$modelValue;let r;try{r=this.bbLocalize.parseTimeSync(i,R.ILocaleTimeFormat.Short,e,a.$modelValue)}catch(e){return a.$setValidity("time",!1),a.$modelValue}return a.$setValidity("time",!0),(i="time"===n.type?this.getISOTime(r):this.formatTime(r,e))!==a.$viewValue&&(a.$setViewValue(i),t.is(":focus")||a.$render()),r},this.getTimeFormatter=(e,t,n,a)=>()=>{a.$setValidity("time",!0);const i=a.$modelValue;return a.$isEmpty(i)?t.val():"time"===n.type?this.getISOTime(i):this.formatTime(i,e)},this.link=(e,t,n,a)=>{a.$parsers.push(this.getTimeParser(e,t,n,a)),a.$formatters.push(this.getTimeFormatter(e,t,n,a)),t.on("blur",(()=>{a.$render()}))}}formatTime(e,t){return"ar-sa"===this.bbLocalize.getLocale(t)?this.getISOTime(e):this.bbLocalize.formatTimeSync(e,R.ILocaleTimeFormat.Short,t)}}s.module(Qn,[R.moduleName]).directive("bbValidateTime",[R.serviceName,e=>new Xn(e)]);const ea=new RegExp("^(?:(?:https?|ftp)://)?(?:(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))(?::\\d{2,5})?(?:/\\S*)?$","i"),ta=(new RegExp("^(http://|https://)"),"ultra.directives.validate.url");class na{constructor(){this.require="ngModel",this.restrict="A",this.link=(e,t,n,a)=>{a.$validators.url=this.getUrlValidator(e,t,n,a),a.$warning||(a.$warning={}),a.$errorImmediate||(a.$errorImmediate={})}}getUrlValidator(e,t,n,a){return e=>{if(!e)return a.$error.urlInvalid&&delete a.$error.urlInvalid,!0;const t=e+"";return ea.test(t)?(delete a.$error.urlInvalid,!0):(a.$error.urlInvalid=!0,!1)}}}s.module(ta,[]).directive("bbValidateUrl",["$injector",e=>e.instantiate(na)]);var aa=n("lDJ8");const ia=[Ln.b,jn.a,Mn.b,Rn,Fn,_n,qn,Wn,Jn,Qn,ta,aa.a];var ra=n("2qV7"),sa=n("Q/M7"),oa=n("HtY7"),la=n("H8CZ");const ca="ultra.components.directives.preventEventBubbling";class da{constructor(e,t,n){this.scope=e,this.element=t,this.attrs=n,n.bbPreventEventBubbling&&t.on(n.bbPreventEventBubbling,(function(e){e.stopPropagation()}))}}da.$inject=["scope","element","attrs"];class ua{constructor(e){this.$injector=e,this.restrict="A",this.link=(e,t,n)=>{e.bbPreventEventBubbling=this.$injector.instantiate(da,{scope:e,element:t,attrs:n})}}}ua.$inject=["$injector"],s.module(ca,[]).directive("bbPreventEventBubbling",["$injector",e=>e.instantiate(ua)]);const ma="ultra.components.directives.sizeToFitTextArea";class pa{constructor(e,t,n,a){if(this.scope=e,this.element=t,this.attrs=n,this.timeout=a,this.defaultHeight=null!=this.scope.defaultHeight?parseInt(this.scope.defaultHeight,10):37,"textarea"!==t[0].tagName.toLowerCase())throw new Error("This directive is only for use as an attribute on textareas");this.maxHeight=this.scope.maxHeight?parseInt(this.scope.maxHeight,10):null,t.addClass("size-to-fit-textarea"),null!=e.textareaModel?this.scope.$watch("textareaModel",((e,t)=>{e!==t&&this.sizeToFit()})):t.keyup(this.sizeToFit.bind(this)),this.timeout((()=>{this.minHeight="true"===this.scope.initialHeightLock?this.element.get(0).clientHeight:null,this.sizeToFit()}),this.scope,0,!1)}sizeToFit(){const e=this.element.get(0);e.clientHeight===e.scrollHeight&&(e.style.height=this.defaultHeight+"px");let t=e.clientHeight;(!this.maxHeight||this.maxHeight>t)&&(t=Math.max(e.scrollHeight,t,this.minHeight),this.scope.maxHeight&&(t=Math.min(this.maxHeight,t)),t>e.clientHeight&&(e.style.height=t+"px"))}}pa.$inject=["scope","element","attrs",S.b];class ha{constructor(e){this.$injector=e,this.replace=!1,this.restrict="A",this.priority=1,this.terminal=!1,this.scope={defaultHeight:"@",maxHeight:"@",initialHeightLock:"@",textareaModel:"=?"},this.link=(e,t,n)=>{e.sizetofittextarea=this.$injector.instantiate(pa,{scope:e,element:t,attrs:n})}}}ha.$inject=["$injector"],s.module(ma,[S.a]).directive("bbSizeToFitTextarea",["$injector",e=>e.instantiate(ha)]);const ga="ultra.components.directives.bbPreventDrag";class ba{constructor(e){this.$rootScope=e,this.restrict="A",this.link=(e,t)=>{t.attr("draggable","false"),t.on("dragstart",(e=>{const t=e.originalEvent.target;if(!(t.ownerDocument.activeElement.className.includes("bb-editor")||t.getAttribute&&"true"===t.getAttribute("draggable")))return!1}))}}}ba.$inject=["$rootScope"],s.module(ga,[]).directive("bbPreventDrag",["$injector",e=>e.instantiate(ba)]);n("my/J");var fa=n("nsO7");const va="ultra.components.directives.formlabel",ya="bbFormLabelDecorator";class Sa{constructor(e,t,n){this.$q=e,this.$log=t,this.timeout=n,this.restrict="A",this.scope=!0,this.waitForElement=(e,t)=>{null==t.elementInspectStartAt&&(t.elementInspectStartAt=(new Date).getTime());const n=this.$q.defer();return this.timeout((()=>s.element(document.getElementById(e))),t,50).then((a=>{a.length>0?n.resolve(a):(new Date).getTime()-t.elementInspectStartAt>Sa.elementInspectTimeout?n.reject("Cannot find element #"+e+" in "+Sa.elementInspectTimeout+"ms"):this.waitForElement(e,t).then((e=>{n.resolve(e)})).catch((e=>{n.reject(e)}))})),n.promise},this.link=(e,t,n)=>{const a=e.$eval(n.bbFormLabelDecorator)||{},i=n.for;i&&this.waitForElement(i,e).then((t=>{const n=()=>{e.attrsElement=fa.mapValues(fa.keyBy(t[0].attributes,"nodeName"),(e=>e.nodeValue))};a.autoupdate&&(e.domObserver=new MutationObserver(n),e.domObserver.observe(t[0],{childList:!1,attributes:!0,subtree:!1})),n()})).catch((e=>{this.$log.warn(e)})),e.$watchGroup(fa.compact(["attrsElement",n.bbFormLabelDecorator]),(e=>{Sa.decorators.forEach((n=>{n(t,s.extend({},e[0],e[1]))}))})),e.$on("$destroy",(()=>{void 0!==e.domObserver&&e.domObserver.disconnect()}))}}}Sa.elementInspectTimeout=1e4,Sa.$inject=["$q","$log","timeout"],Sa.decorators=[(e,t)=>{const n=t.required;!0===n||["true","required",""].indexOf(n)>=0?e.addClass("required"):e.removeClass("required")}],s.module(va,[]).directive(ya,["$injector",e=>e.instantiate(Sa)]);var Ca=n("+e2k"),Ea=n("D57K"),Ia=n("GGEJ");n("JbSi"),n("0Y4C");const ka="ultra.components.directives.collabSessionIcon";let wa=class{constructor(e,t,n){this.$scope=e,this.$element=t,this.bbLocalize=n}$onChanges(e){this.bbLocalize.translate({locale:this.bbLocalize.getLocale(this.$scope),key:this.runningSessionFlag?"components.directives.collab-session-icon.aria-label.active-collab":"components.directives.collab-session-icon.aria-label.inactive-collab"}).then((e=>{this.$element.attr("aria-label",e)}))}};wa.$inject=["$scope","$element",R.serviceName],wa=Object(Ea.a)([Object(rt.a)({moduleName:ka,componentName:"bbCollabSessionIcon",template:Ia,bindings:{runningSessionFlag:"<"},requireModules:[R.moduleName]})],wa);const Ta="ultra.directives.elementimage.accessibility",Oa="aria-label",Aa=["components","directives","element-image","element-image-accessibility"];class Pa{constructor(e,t){this.$injector=e,this.bbLocalize=t,this.restrict="C",this.link=(e,t,n)=>{if(t.attr(Oa))return;let a=t.attr("class");const i=n=>{const a=/\bimg-icon-[\w-]+\b/.exec(n);null===a?t.removeAttr(Oa):(this.loadBundle.then((()=>{t.attr(Oa,this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(e),key:Aa.join(".")+"."+a[0].replace(/-[aco]$/,"")}))})),e.$digest())};requestAnimationFrame((()=>{i(a)}));const r=new MutationObserver(fa.debounce((()=>{requestAnimationFrame((()=>{const e=t.attr("class");a!==e&&(a=e,i(a))}))}),100,{leading:!0}));r.observe(t[0],{attributes:!0,attributeFilter:["class"]}),e.$on("$destroy",(()=>{r.disconnect()}))},this.loadBundle=t.loadBundle(Aa.join("/"))}}Pa.$inject=["$injector",R.serviceName],s.module(Ta,[R.moduleName]).directive("elementImage",["$injector",e=>e.instantiate(Pa)]);var xa=n("cYWG"),$a=n("K/D1");const Na=["scheduledTasks","telemetry"];let Da=null;class La{constructor(){this.pendingRequests=[],this.httpRequestLog=[],this.registerWebRequestListener()}registerWebRequestListener(){window.addEventListener("message",(e=>{e.source===window&&e.data&&e.data.type&&e.data.details&&this.handleWebRequestMessage(e.data.type,e.data.details)}))}handleWebRequestMessage(e,t){if(this.isMonitoredUrl(t.url))switch(e){case"onBeforeRequest":this.onRequestStarted(t);break;case"onCompleted":case"onErrorOccurred":this.onRequestCompleted(t)}}isMonitoredUrl(e){return e&&e.indexOf("/learn/api/v1")>=0&&0===Na.filter((t=>e.indexOf(t)>-1)).length}onRequestStarted(e){this.pendingRequests.push(e)}onRequestCompleted(e){const t=fa.findIndex(this.pendingRequests,(t=>t.requestId===e.requestId));if(t>-1){const n=this.pendingRequests[t],a={requestId:e.requestId,type:e.type,method:e.method,url:e.url,statusCode:e.statusCode,elapsedTime:e.timeStamp-n.timeStamp,requestBody:n.requestBody,error:e.error};this.httpRequestLog.push(a),this.pendingRequests.splice(t,1)}}dumpHttpRequestLog(){const e={};window.httpRequestLog.forEach((t=>{const n=t.method+" "+t.url;null==e[n]&&(e[n]=[]),e[n].push(t.params)}));for(const t of Object.keys(e))if(Object.prototype.hasOwnProperty.call(e,t)){const n=e[t];console.log(t+" ["+n.length+"]",n)}}clearHttpRequestLog(){this.httpRequestLog.length=0}}var ja=n("oQrK");const Ma="ultra.services.zoomUtility";s.module(Ma,[]),ja.a.detect().mobile()&&r(document).on("mouseover","input, textarea, select, .editor-element",(function(){r(this).css("font-size","16px")}));var Ga=n("aHpC"),Ra=n("gkef"),Ba=n("eQBN"),Fa=n("90v0");const Ua="ultraUi.components.directives.conversion.previewHeader";let _a=class{constructor(e,t,n,a,i){this.scope=e,this.element=t,this.attrs=n,this.windowSize=a,this.studentPreview=i;const r=e.course,s=a.isMediumBreakpoint()||a.isLargeBreakpoint();this.scope.shouldShowHeader=s&&r.isUltraPreview(),this.scope.hasExceptionReport=!!r.ultraConversionReportId,e.$on("reloadCourse",((e,t)=>{t===r.id&&(this.scope.shouldShowHeader=r.isUltraPreview())}))}};_a=Object(Ea.a)([Object(Ea.c)(0,Object(Ga.b)("scope")),Object(Ea.c)(1,Object(Ga.b)("element")),Object(Ea.c)(2,Object(Ga.b)("attrs")),Object(Ea.c)(3,Object(Ga.b)(Ra.b)),Object(Ea.c)(4,Object(Ga.b)(Ba.e))],_a);class za{constructor(e){this.$injector=e,this.restrict="AE",this.template=Fa,this.scope={course:"="},this.link=(e,t,n)=>{e.previewHeader=this.$injector.instantiate(_a,{scope:e,element:t,attrs:n})}}}za.$inject=["$injector"],s.module(Ua,[Ba.b]).directive("bbPreviewHeader",["$injector",e=>e.instantiate(za)]);const qa="ultra.service.filters.timespan",Ha=[{symbol:"d",base:86400,label:"days"},{symbol:"h",base:3600,label:"hours"},{symbol:"m",base:60,label:"minutes"},{symbol:"s",base:1,label:"seconds"}];s.module(qa,[R.moduleName]).filter("timeSpan",["$log",R.serviceName,function(e,t){const n={};return Ha.forEach((e=>{n[e.symbol]=e})),function(a,i="hm",r){const s={},o={};return fa.forEach(i,(t=>{const a=t.toLowerCase();Object.prototype.hasOwnProperty.call(n,a)?o[a]=a!==t:e.error(`${a} is not supported!`)})),fa(n).filter((e=>Object.prototype.hasOwnProperty.call(o,e.symbol))).forEach((e=>{const i=e.symbol,l=1===fa.size(o),c=Math.floor(a/n[i].base),d=n[i].label;(c>0||!0===o[i]||l&&0===fa.size(s))&&(s[d]=t.translateSync({locale:t.getLocale(r),key:`global.timeSpan.${d}.plural`,params:{v:c},noEscape:!0})),a%=n[i].base,delete o[i]})),fa.defaults(s,{days:"",hours:"",minutes:"",seconds:""}),t.translateSync({locale:t.getLocale(r),key:"global.timeSpan.oneline",params:s,noWrap:!0,noEscape:!0}).trim().replace(/\s+/g," ")}}]);const Va=[qa];var Wa=n("0fB1"),Ka=n("z6Q5");const Ya="ultra.service.batch-utility-rest-api.directive";s.module(Ya,[Ka.a,S.a]).directive("bbBatchScope",[Ka.b,S.b,function(e,t){return{restrict:"A",link(n){let a,i;n.$on("BEFORE_REQUEST",(function(r,s){r.stopPropagation(),s.params=s.params||{},s.params[Ka.c]||(a=a||e.newToken(),s.params[Ka.c]=a),a&&(t.cancel(i),i=t((()=>{a.send(),a=null}),n))}))}}}]);var Ja=n("gCXj"),Za=n("BXiQ"),Qa=n("tb/u");const Xa="ultra.directives.user-avatar-group";s.module(Xa,[Za.a]).directive("bbUserAvatarGroup",(function(){return{restrict:"E",template:Qa,scope:{users:"=?"},link(e,t){t.addClass("avatar element-image"),e.$watch("users",(t=>{t&&(e.displayUsers=Object(fa.compact)([e.users[0],e.users.length>2?{id:"_groupedusers_"+(e.users.length-1),getInitials:()=>"+"+(e.users.length-1),avatar:{permanentUrl:"default"},lastModifiedAt:void 0}:e.users[1]]))}))}}}));var ei=n("zFCC"),ti=n("NXdT"),ni=n("/jNt");var ai=new class{init(){if(this._isEventAlreadyWrapped)return;const e=window.XMLHttpRequest.prototype.open;window.XMLHttpRequest.prototype.open=function(...t){return this.addEventListener("load",(function(){if(this.status>399){const e=new URL(this.responseURL).pathname.substring(1),n=e.substr(0,e.lastIndexOf("/"));if(!fa.includes(["learn/api/v1/users/me/preferences","learn/api/v1/systemPreferences","telemetry/api/v1/browser"],n)){const n=this.responseText.replace(/(\r\n|\n|\r)/gm,"").substr(0,150),a=`${t[0]} ${e} ${this.status} - ${this.statusText} "${n}"`;I.b.addHistory({applicationId:"",analyticsId:a,action:"request error",url:e})}}})),e.apply(this,[].slice.call(t))},this._isEventAlreadyWrapped=!0}};let ii;n.d(t,"userId",(function(){return ii})),n.d(t,"moduleName",(function(){return ri})),n.d(t,"shouldUseAbsoluteUrl",(function(){return di})),n.d(t,"appInjector",(function(){return oi})),n.d(t,"init",(function(){return pi}));const ri="ultra";let si;window.Foundation.libs.reveal.settings.dismiss_modal_class="close-reveal-modal, .reveal-close",!Da&&function(){const e=sa.j();return!k.a.production||e.indexOf("perf-ultra")>-1||e.indexOf("mylearn.int.bbpd.io")>-1||e.indexOf(".dev.bbpd.io")>-1||e.indexOf(".animal.bbsaas.io")>-1}()&&(Da=new La,window.httpRequestLog=Da.httpRequestLog,window.pendingRequests=Da.pendingRequests,window.dumpHttpRequestLog=Da.dumpHttpRequestLog,window.clearHttpRequestLog=Da.clearHttpRequestLog,window.disableFtueGuidance=()=>{k.a.disableAllFtueGuidance=!0});let oi,li=["angulartics","angulartics.scroll","ngAnimate","ngAria","ngMessages","ngOnload","ngSanitize","ui.router","angular-data.DSCacheFactory","fng","ngRedux",C,N,be.a,Ya,M.a,oa.a,fe.a,ve.a,ye.a,G.d,Se.a,H.a,K.a,B,yt.a,Ce.a,Z.f,Ee.a,Be.a,Ie.b,Ue,ze,va,Je.a,He.a,ke.b,Ae,$e,Le.a,Ve.a,Qe,Ge,je.a,Me.a,We.c,Ke.a,U.b,Ye.a,_.a,Y,tt.moduleName,nt.a,at,ot,ae,ut,vt.b,pt.a,ht.b,gt.a,V,bt.b,q.a,z.a,ft.a,oe,me.a,he.a,Et.b,St.a,Ct.a,It.a,kt.a,ca,ga,_t.c,xn.a,$n.a,S.a,O.N,ma,Ca.a,ka,Ta,ra.a,$.b,$a.a,xa.b,Ma,Ua,Wa.a,Ja.a,Za.a,Xa,ni.c,ei.b,ti.b].concat(ia).concat(Va);function ci(){return si=Object(l.b)(),s.module(ri,li).config([R.providerName,e=>{e.setOptions({production:k.a.production})}]).config(["$locationProvider",$.c,"$urlRouterProvider",(e,t,n)=>{e.html5Mode(!0),n.rule(((e,t)=>{const n=t.url();if(!n)return;const a=sa.r(n);return"/"===a[a.length-1]?a.substring(0,a.length-1):void 0})),n.otherwise(((e,t)=>{const n=t.url(),a=e.get($.d);if("/"===sa.r(n)){e.get(he.b).navigateToLandingPage()}else a.go("base.not-found")}))}]).config(["$ocLazyLoadProvider",e=>{e.config({loadedModules:[ri]})}]).config(["$animateProvider",e=>{e.classNameFilter(/angular-animate/)}]).config(["$compileProvider",e=>{e.debugInfoEnabled(!k.a.production)}]).config(["$httpProvider",e=>{e.useApplyAsync(!0),ui(e)}]).config(["DSCacheFactoryProvider",e=>{e.setCacheDefaults({capacity:1e3,maxAge:18e5,deleteOnExpire:"passive"})}]).config(["$ariaProvider",e=>{e.config({bindRoleForClick:!1,bindKeydown:!1,ariaRequired:!1,ariaInvalid:!1,tabindex:!1})}]).config(["$logProvider",e=>{e.debugEnabled(!k.a.production)}]).config(["$provide",function(e){e.decorator("$rootScope",["$delegate",function(e){return Object.defineProperty(e.constructor.prototype,"$$digestPaused",{get(){const e=this;return Object.prototype.hasOwnProperty.call(e,"$$__digestPaused")&&null!=e.$$__digestPaused?e.$$__digestPaused:(e.$parent||{}).$$digestPaused}}),e}])}]).config(["$ngReduxProvider",e=>{const t=window,n=[si,c.a],a=[];if(!k.a.production){const e=Object(o.createLogger)({level:"info",collapsed:!0});n.unshift(e),t.__REDUX_DEVTOOLS_EXTENSION__&&a.push(t.__REDUX_DEVTOOLS_EXTENSION__&&t.__REDUX_DEVTOOLS_EXTENSION__())}e.createStoreWith(p.Vb,n,a)}]).config(["$qProvider",e=>{e.errorOnUnhandledRejections(!1)}])}function di(e){return e&&e.url&&(e.url.indexOf("/api/")>=0||e.url.indexOf("/partner-cloud/app/")>=0)}function ui(e){e.interceptors.push((()=>({request:e=>(di(e)&&(e.url=sa.c(e.url)),e)})))}function mi(e){e.run(["$rootScope","$ngRedux",R.serviceName,St.b,le,(e,t,n,a,i)=>{let r;i.registerXsrfCallback((e=>{Object(p.db)({apiBasePath:k.a.apiBasePath,xsrf:e,partnerCloudBasePath:k.a.partnerCloudBasePath})})),si.run(v);const s=t.connect((e=>({})),p.V.app)(((e,t)=>{r=t}));e.$on("destroy",s),e.$on(x.b.$stateChangeSuccess,((t,a,i,s,o)=>{r&&r.handleStateChangeSuccess({toState:a,toParams:i});let l="base.recentActivity";s.name&&(l=s.name),e.previousState=l,e.previousStateSref=`${l}${o?`(${JSON.stringify(o)})`:""}`,e.index=Object.create(null),e.index.locale=(n.getLocale(e)||"").replace("_","-");const c=()=>{const t=a.pageTitle||"base.ultra";n.translate({locale:e.index.locale,key:t}).then((t=>{e.index.title=t}))};new Promise(((e,t)=>{try{if(a.pageTitleHandler){const t=a.pageTitleHandler;t.build({injector:oi,name:a.name,pageTitle:a.pageTitle}).process(),e(t)}else c()}catch(e){console.error(`Uncaught error in dynamic title for state ${a.name}:`,e),t()}})).then(null,c)})),e.$on(x.a.$locationChangeSuccess,((e,t)=>{if(!r)return;const n=t.split("?")[1],a={};if(n){const e=new URLSearchParams(n);for(const[t,n]of Array.from(e.entries()))a[t]=n}r.handleLocationChangeSuccess({queryParams:a})}));const o=a.subscribe();e.$on("destroy",o)}]).run(["$http",me.b,le,(e,t,n)=>{n.registerXsrfCallback((t=>{e.defaults.headers.common[ce]=t,s.element.ajaxSetup({headers:{[ce]:t}})})),s.element.ajaxPrefilter((e=>{di(e)&&(e.url=sa.c(e.url))}))}]).run(["$rootScope",me.b,pe.b,R.serviceName,function(e,t,n,a){e.context=t,e.$on("bbCurrentUserModified",(()=>{n.userModel.$fetch()})),Object(Dn.b)(t,n,a)}]).run(["$rootScope",e=>{e.Modernizr=window.Modernizr}])}function pi(){sa.m("inPreviewMode",window.location.href)&&r("body").addClass("in-preview-mode"),s.element(document).ready((()=>{s.module("pre-bootstrap-ultra",["ng",me.a]).config(["$httpProvider",e=>{ui(e)}]);const e=s.injector(["pre-bootstrap-ultra"]),t=e.get(me.b),n=e.get(pe.b),a=e.get("$http"),i=e.get(S.b),o=e.get("$q");r(document).foundation(),/Android/.test(navigator.appVersion)&&"function"==typeof document.activeElement.scrollIntoViewIfNeeded&&window.addEventListener("resize",(()=>{"INPUT"===document.activeElement.tagName&&i((()=>{document.activeElement.scrollIntoViewIfNeeded()}),this.scope,0,!1)}));const l=sa.j(),c=window.__initialContext.xsrf?o.when({data:{xsrfToken:window.__initialContext.xsrf}}):a.get(l+k.a.apiBasePath+"/v1/utilities/xsrfToken");o.all([n.userModel.$asPromise(),c,t.getSystemInfo().$asPromise()]).then((e=>{const t=e[0];ii=t.id;const a=e[2];ge.a.userId=ii,Nn.a.setClientOffset(a.now.getTime()-(new Date).getTime());const i=r("base"),o=i.attr("href");i.attr("href",k.a.basePath+"/"),oi=s.bootstrap(document.documentElement,[ri],{strictDi:!0});const l=oi.get(me.b),c=oi.get(le);oi.get(_t.d).addRouteListener();new Pn(_t.b,y.e).start(),c.updateToken(e[1].data.xsrfToken),n._setUserId(ii),c.registerXsrfCallback((e=>{l.sessionId=e,l.xsrfToken=e})),hn.m.init(window),wt.a.init(window),An(oi.get(R.serviceName),oi.get("$ngRedux"),oi.get($.d)),ai.init(),i.attr("href",o)})).catch((e=>{401===e.status&&(window.location.href="/?new_loc="+encodeURIComponent(window.location.pathname+(window.location.search||"")+(window.location.hash||"")))})).finally((()=>{const e=()=>{const e=r("#initial-load-area");if(e&&e.length>0){if(window.__e2eTestingEnabled)return void e.remove();e.addClass("fade-out");const t=t=>{if(!t.data.noTransitions&&"opacity"!==t.originalEvent.propertyName)return!1;e.remove()};la.b(e,t),setTimeout((()=>e.remove()),500)}};if(window.__e2eTestingEnabled)e();else if(oi){const t=oi.get("$rootScope");let n;const a=t.$on("$stateChangeSuccess",(()=>{e(),a(),n()}));n=t.$on("$stateChangeError",(()=>{e(),n(),a()})),t.$on("hideInitialLoadingArea",(()=>{e()}))}else e()}))}))}if(k.a.production){mi(ci()),pi()}else Promise.all([n.e(571),n.e(269)]).then((()=>{Promise.resolve().then(n.bind(null,"tWb8")).then((e=>{li=li.concat(e.modules);const t=ci();mi(t),e.init(t),pi()}))}).bind(null,n)).catch((()=>{}))},e6jQ:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));let a=0;function i(){return a++,"id_"+a}function r(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}},eQBN:function(e,t,n){"use strict";n.d(t,"b",(function(){return g})),n.d(t,"e",(function(){return b})),n.d(t,"c",(function(){return f})),n.d(t,"d",(function(){return v})),n.d(t,"a",(function(){return y}));var a=n("D57K"),i=n("aHpC"),r=n("yC9S"),s=n("Q/M7"),o=n("ZzR9"),l=n("qhd3"),c=n("lVRt"),d=n("12mu"),u=n("0JpG"),m=n("x+T+"),p=n("hkqm"),h=n("zIHT");const g="ultra.service.studentPreview",b="studentPreview",f=b+"Provider",v=c.d,y="TOGGLE-PREVIEW",S="in-preview-mode-parent";let C=class{constructor(e,t,n,a,i,s,l,c){this.$q=e,this.$rootScope=t,this.$sce=n,this.entitlementCache=a,this.localize=i,this.modal=s,this.toast=l,this.UserModel=c,r.b.OnRootScope(this.$rootScope,o.b.$stateHasCourseInContextChanged,((e,t,n)=>{var a;n&&!t&&(null===(a=this.previewStatus)||void 0===a?void 0:a.previewing)&&this.exitPreviewMode()})),r.b.OnRootScope(this.$rootScope,o.a.$locationChangeSuccess,((e,t)=>{this.isInIframeOfPreviewMode()&&this.course&&sessionStorage.setItem(this.previewUrlStorageKey,t)}))}get previewUrlStorageKey(){return`PREVIEW_URL_${this.course.id}`}get course(){return this._course}get previewStatus(){return this._previewStatus}get previewUrl(){return this._previewUrl}load(){return this.course.studentPreview.$fetch().$asPromise().then((e=>(this._previewStatus=e,this.updateClasses(),e.courseMembershipId?this.course.memberships.$new(e.courseMembershipId).$fetch().$asPromise().then((t=>(e.user=this.UserModel.$buildRaw(e.user),e.user.memberships.push(this.course.memberships.$buildRaw(t)),e))):this.$q.when(e))))}init(e){var t;return(null===(t=this.course)||void 0===t?void 0:t.id)===e.id&&this.previewStatus?this.$q.resolve(this.previewStatus):(this._course=e,this.setPreviewUrl(),this.load())}setPreviewUrl(){const e=sessionStorage.getItem(this.previewUrlStorageKey);let t;t=e?Object(s.a)(e,"inPreviewMode","true"):Object(s.c)(`/ultra/courses/${this.course.id}/outline/?inPreviewMode=true`),this._previewUrl=this.$sce.trustAsResourceUrl(t)}openStartPreviewModal(){const e=this.$rootScope.$new();return e.courseOrgTokenPrefix=this.course.isOrganization?"components.services.organization":"components.services",document.body.classList.add("dialog-pop-up-in-preview-mode"),this.modal.open({scope:e,template:h,resolve:{translations:[u.serviceName,e=>e.loadBundle("components/services/student-preview")]}}).result}updateClasses(){var e;(null===(e=this.previewStatus)||void 0===e?void 0:e.previewing)?document.body.classList.add(S):(document.body.classList.remove(S),document.body.classList.remove("has-footer-in-preview-mode"))}showToastNotification(e){this.toast.show({messageKey:e,icon:"icon-check",toastStatus:"success"})}exitPreviewMode(e=!1){return this.entitlementCache.clearEntitlementCache(this.course.id),this.$q.all([this.course.studentPreview.withParams({discardData:e}).$destroy().$asPromise(),this.localize.loadBundle("components/services/student-preview")]).then((e=>this.entitlementCache.loadCourseEntitlements(this.course.id).then((()=>{this.$rootScope.$broadcast(y,!1),this.setPreviewUrl(),this.showToastNotification("components.services.studentPreview.previewEnded"),this._previewStatus=e[0],this.updateClasses()}))))}launchPreviewMode(){return this.openStartPreviewModal().then((()=>this.course.studentPreview.$save().$asPromise().then((e=>{this._previewStatus=e,this.$rootScope.$broadcast(y,!0),this.updateClasses()}))))}resetPreviewMode(){return this.course.studentPreview.withParams({discardData:!0}).$destroy().$asPromise().then((()=>this.course.studentPreview.$save().$asPromise().then((()=>{this.setPreviewUrl(),this.showToastNotification("components.services.studentPreview.activityReset")}))))}isInIframeOfPreviewMode(){var e;return(null===(e=this.previewStatus)||void 0===e?void 0:e.previewing)&&window.top!==window}};C=Object(a.a)([Object(a.c)(0,Object(i.b)("$q")),Object(a.c)(1,Object(i.b)("$rootScope")),Object(a.c)(2,Object(i.b)("$sce")),Object(a.c)(3,Object(i.b)(m.c)),Object(a.c)(4,Object(i.b)(u.serviceName)),Object(a.c)(5,Object(i.b)(d.b)),Object(a.c)(6,Object(i.b)(p.b)),Object(a.c)(7,Object(i.b)(l.serviceName))],C);angular.module(g,[m.b,u.moduleName,d.a,p.a]).provider(b,class{constructor(){this.$get=["$injector",e=>e.instantiate(C)],this.name=v,this.resolve=[c.c,b,(e,t)=>t.init(e)]}})},eUpQ:function(e,t,n){"use strict";class a{static getServerTime(){return new Date((new Date).getTime()+a.clientTimeDifferenceMS)}static getServerTimeAsEpochTime(){return this.getServerTime().getTime()/1e3}static setClientOffset(e){a.clientTimeDifferenceMS=e}}a.clientTimeDifferenceMS=0,t.a=a},emI2:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return l}));var a=n("D57K"),i=n("pjml"),r=n("aHpC");const s="ultra.service.preference",o="preferenceService",l=250;let c=class{constructor(e,t){this.$q=e,this.MyPreferenceModel=t,this.preferences={}}getPreference(e,t,n){const a=this.$q.defer();return n||!Object.prototype.hasOwnProperty.call(this.preferences,e)?this.MyPreferenceModel.$find(e).$allow([404]).$asPromise().then((n=>{if(n.$response&&404===n.$response.status){if(void 0===t)return void a.reject(n);this._addPreferenceToCache(e,t),a.resolve(this.preferences[e])}else this.preferences[n.key]=n,a.resolve(n)}),(e=>{a.reject(e)})):a.resolve(this.preferences[e]),a.promise}_addPreferenceToCache(e,t,n){const a=this.MyPreferenceModel.$new(e);a.key=e,a.value=t,a.isRequired=!n,this.preferences[e]=a}setPreference(e,t,n){if(e.length>l)throw new Error("Preference key is too long!");return this._addPreferenceToCache(e,t,n),this.preferences[e].$save().$asPromise()}};c=Object(a.a)([Object(a.c)(0,Object(r.b)("$q")),Object(a.c)(1,Object(r.b)(i.O.serviceName))],c);angular.module(s,[i.N]).service(o,c)},en1n:function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return m})),n.d(t,"e",(function(){return h})),n.d(t,"g",(function(){return f})),n.d(t,"f",(function(){return v})),n.d(t,"k",(function(){return y})),n.d(t,"j",(function(){return S})),n.d(t,"h",(function(){return C})),n.d(t,"l",(function(){return E})),n.d(t,"m",(function(){return I})),n.d(t,"i",(function(){return k})),n.d(t,"n",(function(){return O}));n("9RbK");var a=n("71td"),i=n("xkx/");const r=39.9375,s=40,o=63.9375,l=89.9375,c=119.9375;let d;const u=e=>e*parseFloat(a("html").css("font-size"));var m;!function(e){e.Small="small",e.Medium="medium",e.Large="large",e.Xlarge="xlarge",e.Xxlarge="xxlarge"}(m||(m={}));const p=function(){return d||(d={small:{start:0,end:u(r)},medium:{start:u(r),end:u(o)},large:{start:u(o),end:u(l)},xlarge:{start:u(l),end:u(c)},xxlarge:{start:u(c),end:999999999}}),d};let h=p,g=null;a(window).resize((()=>{g=null}));const b=function(){return null==g&&(g=a(window).width()),g};let f=b;function v(){const e=h(),t=f();return t>=e.small.start&&t<e.small.end?m.Small:t>=e.medium.start&&t<e.medium.end?m.Medium:t>=e.large.start&&t<e.large.end?m.Large:t>=e.xlarge.start&&t<e.xlarge.end?m.Xlarge:m.Xxlarge}function y(){return v()===m.Small}function S(){return v()===m.Medium}function C(){return v()===m.Large}function E(){return v()===m.Xlarge}function I(){return v()===m.Xxlarge}function k(){return C()||E()||I()}function w(e){return e.replace("@media","").trim()}const T={smallUp:window.matchMedia(w(i.BbMediaQueries.smallUp)),smallOnly:window.matchMedia(w(i.BbMediaQueries.smallOnly)),mediumUp:window.matchMedia(w(i.BbMediaQueries.mediumUp)),mediumOnly:window.matchMedia(w(i.BbMediaQueries.mediumOnly)),largeUp:window.matchMedia(w(i.BbMediaQueries.largeUp)),largeOnly:window.matchMedia(w(i.BbMediaQueries.largeOnly)),xlargeUp:window.matchMedia(w(i.BbMediaQueries.xLargeUp)),xlargeOnly:window.matchMedia(w(i.BbMediaQueries.xLargeOnly)),xxlargeUp:window.matchMedia(w(i.BbMediaQueries.xXLargeUp))},O={smallUp:T.smallUp,smallOnly:T.smallOnly,mediumUp:T.mediumUp,mediumOnly:T.mediumOnly,largeUp:T.largeUp,largeOnly:T.largeOnly,xlargeUp:T.xlargeUp,xlargeOnly:T.xlargeOnly,xxlargeUp:T.xxlargeUp,"small-up":T.smallUp,"small-only":T.smallOnly,"medium-up":T.mediumUp,"medium-only":T.mediumOnly,"large-up":T.largeUp,"large-only":T.largeOnly,"xlarge-up":T.xlargeUp,"xlarge-only":T.xlargeOnly,"xxlarge-up":T.xxlargeUp}},"f4B+":function(e,t,n){"use strict";var a=n("71td"),i=n("BqZm"),r=n.n(i);class s extends r.a{static text(e){return a("<div></div>").html(e).text()}}Object.setPrototypeOf(s,r.a),t.a=s},f8ya:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return d}));var a,i=n("zGdY");!function(e){e.Add="Add",e.Delete="Delete",e.ValueChange="ValueChange",e.NoChange="NoChange"}(a||(a={}));class r{constructor(e,t){this.type=e,this.value=t}equals(e){return null==e?this.hasNoAccommodation():this.type===i.Zb.Custom?this.value===e.value:this===e||this.type===e.type}hasNoAccommodation(){return!1}get hasAccommodation(){return!this.hasNoAccommodation()}}class s extends r{compare(e){return this.equals(e)?a.NoChange:this.hasAccommodation?a.Add:a.Delete}}class o extends s{constructor(){super(i.D.Normal)}hasNoAccommodation(){return!0}}class l extends r{compare(e){return this.equals(e)?a.NoChange:this.hasAccommodation?e.hasAccommodation?a.ValueChange:a.Add:a.Delete}toKey(){switch(this.type){case i.Zb.NoAccommodation:return"NoAccommodation";case i.Zb.Unlimited:return"Unlimited";default:return"Custom"}}}class c extends l{constructor(){super(i.Zb.NoAccommodation)}hasNoAccommodation(){return!0}}class d{constructor(e,t){null!=e&&(this.dueDate=e),null!=t&&(this.timeLimit=t)}static fromTypes(e,t){const n=new d;var a;return n.dueDate=null==(a=e)||a===i.D.Normal?new o:new s(a),n.timeLimit=function(e){if(null==e||e===i.Zb.NoAccommodation)return new c;if(e!==i.Zb.Unlimited){const t=parseInt(e+"",10);return new l(i.Zb.Custom,t)}return new l(e)}(t),n}clone(){return this.timeLimit.type===i.Zb.Custom?d.fromTypes(this.dueDate.type,this.timeLimit.value):d.fromTypes(this.dueDate.type,this.timeLimit.type)}equals(e){return e.dueDate.equals(this.dueDate)&&e.timeLimit.equals(this.timeLimit)}compare(e){return{dueDate:this.dueDate.compare(e.dueDate),timeLimit:this.timeLimit.compare(e.timeLimit)}}get hasAccommodation(){return this.dueDate.hasAccommodation||this.timeLimit.hasAccommodation}}},fGgA:function(e,t,n){"use strict";n("zAxy");var a=n("7O4Y"),i=n("nsO7"),r=n("71td"),s=n("Llzl"),o=n("0JpG"),l=n("lEL+"),c=n("gkef"),d=n("/J7e"),u=n("+4Px"),m=n("e6jQ");n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return h}));const p="ultra.components.directives.tooltip";class h{constructor(e,t,n,a,i,s){this.scope=e,this.element=t,this.attrs=n,this.localizeService=a,this.timeoutService=i,this.windowSizeService=s,this.tooltipCreated=!1,this.tooltip=null,this.pip=null,this.timeout=null,this.timeoutMS=500,h.initEnhancedTooltipEvents(),this.controlId=this.attrs.tooltipId||`tooltip-${m.a()}`,this.tooltipPosition=this.attrs.tooltipPosition||"top","true"===this.attrs.tooltipAlwaysUnderline&&this.getTriggerElement().addClass("tooltip-always-underline"),this.$body=r("body"),this.attrs.$observe("title",(e=>{e&&(this.content=e,this.updateTooltip())})),this.scope.$on("$destroy",(()=>{this.getTooltip()&&this.getTooltip().remove(),this.$body=null,this.tooltip=null,this.pip=null})),"true"!==this.attrs.tooltipDisableOnMouseLeave&&t.on("mouseleave",(()=>{(this.windowSizeService.isLargeBreakpoint()||"true"===this.attrs.tooltipEnableOnMouseLeaveForAllBreakpoints)&&(this.timeoutMS>0?this.timeout=this.timeoutService((()=>{this.hideTooltip()}),this.scope,this.timeoutMS):this.hideTooltip())})),"true"!==this.attrs.tooltipDisableOnMouseOver&&t.on("mouseover",(()=>{(this.windowSizeService.isLargeBreakpoint()||"true"===this.attrs.tooltipEnableOnMouseOverForAllBreakpoints)&&this.showTooltip()})),"true"!==this.attrs.tooltipDisableOnFocus&&(t.on("focus",(()=>{r("body").hasClass("hide-focus-outline")||this.showTooltip()})),t.on("blur",(()=>{this.hideTooltip()}))),t.on("click",(e=>{if(!r("body").hasClass("hide-focus-outline"))return"true"===this.attrs.tooltipHideOnActivation&&this.hideTooltip(),void e.stopPropagation();const t=this.windowSizeService.isSmallBreakpoint(),n=this.windowSizeService.isMediumBreakpoint();if("true"===this.attrs.tooltipOpenOnActivation||t||n){if("true"===this.attrs.tooltipDisableOnMediumDownBreakpoint&&(n||t))return;this.isTooltipVisible()?this.hideTooltip():(this.showTooltip(),e.stopPropagation())}else this.hideTooltip()})),t.on("keydown",(e=>{e.which===u.g&&this.isTooltipVisible()?(this.hideTooltip(),e.stopPropagation()):e.which!==u.t&&e.which!==u.f||("true"===this.attrs.tooltipOpenOnActivation?this.isTooltipVisible()?this.hideTooltip():(this.showTooltip(),e.stopPropagation()):"true"===this.attrs.tooltipHideOnActivation&&this.hideTooltip())}))}isTooltipVisible(){return this.getTooltip()&&"false"===this.getTooltip().attr("aria-hidden")}cancelTimeout(){this.timeout&&this.timeoutService.cancel(this.timeout)}showTooltip(){this.content&&(this.tooltipCreated||(this.addTooltipToDom(),this.attrs.tooltipInitImmediate)?(this.getTriggerElement().attr("title",""),(s.isUndefined(this.attrs.tooltipOnOverflowOnly)||"true"===this.attrs.tooltipOnOverflowOnly&&"true"===s.element(this.getTriggerElement().children()[0]).attr("data-overflowed"))&&(this.cancelTimeout(),this.hideAllTooltips(),this.positionTooltip(),this.getTooltip().attr("aria-hidden","false"),this.postShowTooltip())):this.timeoutService((()=>{this.showTooltip()}),this.scope,100))}hideTooltip(){this.tooltipCreated&&this.getTooltip().attr("aria-hidden","true").css({top:0,left:0})}hideAllTooltips(){r("body").find(".enhanced-tooltip").attr("aria-hidden","true").css({top:0,left:0})}addTooltipToDom(){const e=void 0===this.attrs.tooltipCenterContent||"true"===this.attrs.tooltipCenterContent,t="true"===this.attrs.tooltipDarkTheme,n=Object(a.a)("enhanced-tooltip","tooltip-max-width",{"tooltip-center-content":e,"tooltip-dark-theme":t},this.attrs.tooltipClassNames),i=r(`<span class="${n}" aria-hidden="true" role="tooltip" id="${this.controlId}">${this.getPipHtml()}</span>`);this.addTooltipStyles(i),this.addTooltipContent(i),this.addTooltipEvents(i),this.addTooltipClose(i),this.$body.append(i),this.getTriggerElement().attr("aria-describedby",this.controlId),this.tooltipCreated=!0}getPipHtml(){return"true"===this.attrs.tooltipDisablePip?"":'<span class="enhanced-tooltip-pip"></span>'}getPipPadding(){return"true"===this.attrs.tooltipDisablePip?0:13}getTriggerElement(){return this.element}getTooltip(){if(!this.tooltip){const e=this.$body.find(`#${this.controlId}`);this.tooltip=e.length>0?e:null}return this.tooltip}updateTooltip(){if(this.tooltipCreated){const e=this.getTooltipPip()||"";this.getTooltip().html("").append(e).append(document.createTextNode(this.content))}}getTooltipPip(){return this.pip||(this.pip=this.getTooltip().find(".enhanced-tooltip-pip")),this.pip}positionTooltip(){this.getTooltipPip().removeClass(this.adjustedTooltipPosition);const e=this.getTriggerElement().offset().left,t=e+this.getTriggerElement().outerWidth()/2;switch(this.checkPositionInBoundary(t),this.adjustedTooltipPosition){case"top-center":this.applyPosition(this.getTooltip(),this.getTriggerElement().offset().top-this.getTooltip().outerHeight()-this.getPipPadding(),t-this.getTooltip().outerWidth()/2);break;case"top-left":this.applyPosition(this.getTooltip(),this.getTriggerElement().offset().top-this.getTooltip().outerHeight()-this.getPipPadding(),t-this.getTooltip().outerWidth()+20);break;case"top-right":this.applyPosition(this.getTooltip(),this.getTriggerElement().offset().top-this.getTooltip().outerHeight()-this.getPipPadding(),t-20);break;case"bottom-center":this.applyPosition(this.getTooltip(),this.getTriggerElement().offset().top+this.getTriggerElement().outerHeight()+this.getPipPadding(),t-this.getTooltip().outerWidth()/2);break;case"bottom-left":this.applyPosition(this.getTooltip(),this.getTriggerElement().offset().top+this.getTriggerElement().outerHeight()+this.getPipPadding(),t-this.getTooltip().outerWidth()+h.TOOLTIP_PIP_PADDING);break;case"bottom-right":this.applyPosition(this.getTooltip(),this.getTriggerElement().offset().top+this.getTriggerElement().outerHeight()+this.getPipPadding(),t-h.TOOLTIP_PIP_PADDING);break;case"right-center":this.applyPosition(this.getTooltip(),this.getTriggerElement().offset().top+this.getTriggerElement().outerHeight()/2-this.getTooltip().outerHeight()/2,e+this.getTriggerElement().outerWidth()+this.getPipPadding());break;case"right-top":this.applyPosition(this.getTooltip(),this.getTriggerElement().offset().top+this.getTriggerElement().outerHeight()/2-this.getTooltip().outerHeight()+h.TOOLTIP_PIP_PADDING,e+this.getTriggerElement().outerWidth()+this.getPipPadding());break;case"right-bottom":this.applyPosition(this.getTooltip(),this.getTriggerElement().offset().top+this.getTriggerElement().outerHeight()/2-h.TOOLTIP_PIP_PADDING,e+this.getTriggerElement().outerWidth()+this.getPipPadding());break;case"left-center":this.applyPosition(this.getTooltip(),this.getTriggerElement().offset().top+this.getTriggerElement().outerHeight()/2-this.getTooltip().outerHeight()/2,e-this.getTooltip().outerWidth()-this.getPipPadding());break;case"left-top":this.applyPosition(this.getTooltip(),this.getTriggerElement().offset().top+this.getTriggerElement().outerHeight()/2-this.getTooltip().outerHeight()+h.TOOLTIP_PIP_PADDING,e-this.getTooltip().outerWidth()-this.getPipPadding());break;case"left-bottom":this.applyPosition(this.getTooltip(),this.getTriggerElement().offset().top+this.getTriggerElement().outerHeight()/2-h.TOOLTIP_PIP_PADDING,e-this.getTooltip().outerWidth()-this.getPipPadding())}this.getTooltipPip().addClass(this.adjustedTooltipPosition)}applyPosition(e,t,n){const a=this.adjustLeftPercentage(n),i=this.ensureTopInBounds(t);e.css({top:i||"auto",left:a||"auto"})}ensureTopInBounds(e){const t=e+this.getTooltip().outerHeight();if(this.getWindowHeight()-t<h.TOOLTIP_VIEWPORT_EDGE_PADDING?e=this.getWindowHeight()-this.getTooltip().outerHeight()-h.TOOLTIP_VIEWPORT_EDGE_PADDING:e<h.TOOLTIP_VIEWPORT_EDGE_PADDING&&(e=h.TOOLTIP_VIEWPORT_EDGE_PADDING),s.isDefined(this.attrs.tooltipTopAdjustPercent)){e+=this.getTriggerElement().outerHeight()/100*parseInt(this.attrs.tooltipTopAdjustPercent,10)}return e}adjustLeftPercentage(e){let t=e;if(s.isDefined(this.attrs.tooltipLeftAdjustPercent)){t+=this.getTriggerElement().outerWidth()/100*parseInt(this.attrs.tooltipLeftAdjustPercent,10)}return t}checkPositionInBoundary(e){const t=this.tooltipPosition.split("-");"bottom"!==t[0]&&"top"!==t[0]||(this.getTriggerElement().offset().top+this.getTriggerElement().outerHeight()+this.getTooltip().outerHeight()+this.getPipPadding()>this.getWindowHeight()?t[0]="top":this.getTriggerElement().offset().top-this.getTooltip().outerHeight()-this.getPipPadding()<0&&(t[0]="bottom"),e+this.getTooltip().outerWidth()/2>this.getWindowWidth()?t[1]="left":e-this.getTooltip().outerWidth()/2<0?t[1]="right":t[1]=t[1]?t[1]:"center"),this.adjustedTooltipPosition=t.join("-")}getWindowWidth(){return r(window).width()}getWindowHeight(){return r(window).height()}addTooltipClose(e){const t=e.find(".close-icon");t.length>0&&t.on("click",(()=>{this.hideTooltip()}))}addTooltipStyles(e){}addTooltipContent(e){this.content=this.getTriggerElement().attr("title"),e.append(document.createTextNode(this.content))}addTooltipEvents(e){}postShowTooltip(){}}h.$inject=["scope","element","attrs",o.serviceName,l.b,c.b],h.TOOLTIP_PIP_PADDING=20,h.TOOLTIP_VIEWPORT_EDGE_PADDING=20,h.initEnhancedTooltipEvents=i.once((()=>{const e=i.throttle((()=>{r("body").find(".enhanced-tooltip").attr("aria-hidden","true")}),500);document.addEventListener("scroll",e,!0),r(window).resize(e),r("body").click(e)}));class g{constructor(e){this.$injector=e,this.restrict="A",this.scope={},this.link=(e,t,n)=>{d.a(n.enhancedTooltip)?e.tooltip=this.$injector.instantiate(h,{scope:e,element:t,attrs:n}):(g.instanceCount++,g.ensureEvents(),t.one("mouseover",(e=>{const t=r(e.currentTarget);null==t.attr("data-tooltip")&&(t.attr("data-tooltip",""),t.parent().foundation({tooltip:{disable_for_touch:!0}}))})),e.$on("$destroy",(()=>{g.instanceCount--,0===g.instanceCount&&g.unregisterEvents(),t.foundation("tooltip","off")})))}}static ensureEvents(){function e(){s.element("span.tooltip:visible").hide(),s.element(".button-with-active-tooltip").removeClass("open")}g.eventHandlers||(g.eventHandlers={click:e,blur:e,keyup:function(t){r.Event(t).keyCode===u.g&&e()}},Object.keys(g.eventHandlers).forEach((e=>{document.addEventListener(e,g.eventHandlers[e],!0)})))}static unregisterEvents(){Object.keys(g.eventHandlers).forEach((e=>{document.removeEventListener(e,g.eventHandlers[e],!0)})),g.eventHandlers=null}}g.instanceCount=0,g.eventHandlers=null,g.$inject=["$injector"],s.module(p,[o.moduleName,l.a,c.a]).directive("bbTooltip",["$injector",e=>e.instantiate(g)])},fYJU:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d}));var a=n("D57K"),i=n("Llzl"),r=n("pjml"),s=n("qhd3"),o=n("eQBN"),l=n("aHpC");const c="ultra.service.context.user",d="contextUser";let u=class{constructor(e,t,n){this.$window=e,this.UserModel=t,this.studentPreview=n}get userId(){return this.studentPreview.isInIframeOfPreviewMode()?this.studentPreview.previewStatus.user.id:this._userId||null}get userModel(){return this.studentPreview.isInIframeOfPreviewMode()?this.studentPreview.previewStatus.user:(this._userModel||(this._userModel=this.getInitialUserModel(),this._userId=this._userModel.id),this._userModel)}getMemberships(){return this._userModel||(this._userModel=this.getInitialUserModel()),this._userModel.memberships.$fetch({limit:1e4,expand:"course.effectiveAvailability,course.permissions,courseRole"}).$asPromise()}getRoles(){return this.UserModel.$find("me",{expand:"systemRoles,insRoles"}).$asPromise()}update(){return this.UserModel.$find("me",{expand:"systemRoles"}).$then((e=>this._setUserModel(e)))}getInitialUserModel(){return this.$window.__initialContext?this.UserModel.$buildRaw(this.$window.__initialContext.user):this.UserModel.$find("me",{expand:"systemRoles"})}_setUserId(e){return this._userId=e,this._userId}_setUserModel(e){return this._userModel=e,this._userId=e?e.id:null,this._userModel}};u=Object(a.a)([Object(a.c)(0,Object(l.b)("$window")),Object(a.c)(1,Object(l.b)(s.serviceName)),Object(a.c)(2,Object(l.b)(o.e))],u);i.module(c,[r.N,o.b]).service(d,u)},fm95:function(e,t,n){"use strict";n.r(t);n("QLzv");var a=n("nsO7"),i=n("Llzl"),r=n("wgY5"),s=n("nbDY"),o=n.n(s),l=n("5MwF"),c=n("IbyE"),d=n("zGdY"),u=n("VAMW"),m=n("4nF1"),p=n("ohO4"),h=n("pjml"),g=n("yCC5"),b=n("nkTj"),f=n("Rjd/"),v=n("eUpQ"),y=n("Sa5G"),S=n("94iD"),C=n("6vR2"),E=n("DU7P"),I=n("Htol"),k=n("6fZB");class w{constructor(){this.key=u.d.CreateContentCourseModelOperations}async createContent(e){const t=e.$save().$then((e=>{e.ui.isUploading=!1,e.isAvailable=!1})).$asPromise();await Object(k.a)(t)}}class T{constructor(e,t,n){this.$q=e,this.$rootScope=t,this.CourseModel=n,this.key=u.d.DeleteContentCourseModelOperations,this.$q=e,this.$rootScope=t,this.CourseModel=n}deleteContentHelper(e){this.broadcastChildrenContentForDelete(e).then((()=>{e.hasCourseLinks()?e.getSoftLinks().$asPromise().then((t=>{t.length?this.$q.all(t.map((t=>this.CourseModel.$new(e.courseId).contents.$new(t.courseContent).$fetch().$asPromise().then((e=>{this.$rootScope.$broadcast("deleteContent",e,!1)}))))).then((()=>{this.$rootScope.$broadcast("deleteContent",e)})):this.$rootScope.$broadcast("deleteContent",e)})):this.$rootScope.$broadcast("deleteContent",e)}))}broadcastChildrenContentForDelete(e){return e.isFolder()||e.isLearningModule()?e.getChildren({recursive:!0}).$then((e=>e.filter((e=>!e.isCourseLink())).forEach((e=>this.$rootScope.$broadcast("deleteContent",e,!1))))).$asPromise():this.$q.when()}deleteContent(e){h.p.ContentHandler.CourseLink.isEqualTo(e.contentHandler)?e.getLinkContentSource().$then((t=>{var n;const a=null===(n=null==t?void 0:t.contentHandler)||void 0===n?void 0:n.toString();d.t.Discussion===a?this.deleteContentHelper(t):this.deleteContentHelper(e)})):this.deleteContentHelper(e)}}class O{constructor(){this.key=u.d.CourseContentModelOperations}hasCourseLinks(e){const t=e;return Object(k.a)(t.hasCourseLinks())}}class A{constructor(){this.key=u.d.ConditionalReleaseCourseModelOperations}conditionalReleaseAsync(e,t,n,a,i){const r=e.conditionalReleaseAsync(t,n,a,i),s="function"==typeof r.$asPromise?r.$asPromise():r;return Object(k.a)(s)}async save(e,t,n=[]){const a=e,i={fields:"id",...n.length>0&&{expand:n.join(",")}},r=a.withParams(i).$save(t).$asPromise();await Object(k.a)(r)}}var P=n("tBL6");class x{constructor(e){this.scope=e,this.key=u.d.ContentFolderRefresher}refresh(e,t){this.scope.$applyAsync((()=>{this.scope.$broadcast(I.a,e,t)}))}}class ${constructor(){this.key=u.d.CanEnableForcedSequenceService}canForcedSequenceBeEnabled(e){const t=e.canForcedSequenceBeEnabled();return Object(k.a)(t)}}n.d(t,"CREATE_CONTENT_ID",(function(){return N})),n.d(t,"FolderContentHandlerIcon",(function(){return D})),n.d(t,"getProctoredAssessmentSettings",(function(){return L})),n.d(t,"ForumAttacherAction",(function(){return j})),n.d(t,"ScormScoringMethod",(function(){return M})),n.d(t,"ScormLearningStandard",(function(){return G})),n.d(t,"parseScormScoringMethod",(function(){return R})),n.d(t,"serviceName",(function(){return B})),n.d(t,"ContentHandler",(function(){return c.i})),n.d(t,"ContentRootNode",(function(){return y.h}));const N="create";class D extends o.a{constructor(e){super(e),this.iconClass=e}}D.OpenFolder=new D("img-icon-folder-open"),D.ClosedFolder=new D("img-icon-folder");const L=e=>{if(i.isUndefined(e)||null==e)return null;const t=e.contentHandler.toString();if(h.p.ContentHandler.TestLink.isEqualTo(e.contentHandler)&&e.contentDetail&&e.contentDetail[t]&&e.contentDetail[t].test&&e.contentDetail[t].test.deploymentSettings){const n=e.contentDetail[t].test&&e.contentDetail[t].test.deploymentSettings;return{proctoringDownloadUrl:n.proctoringDownloadUrl,proctoringServiceHandle:n.proctoringServiceHandle,proctoringServiceVendor:n.proctoringServiceVendor,isSecureBrowserRequiredToTake:n.isSecureBrowserRequiredToTake,isSecureBrowserRequiredToReview:n.isSecureBrowserRequiredToReview,isWebcamRequired:n.isWebcamRequired}}return null};var j,M,G;function R(e){if(e)return Object.values(M).find((t=>t.toLowerCase()===e.toLowerCase()))}!function(e){e.Add="ADD",e.Delete="DELETE"}(j||(j={})),function(e){e.Score="SCORE",e.Completion="COMPLETION",e.Satisfaction="SATISFACTION"}(M||(M={})),function(e){e.AICC="AICC",e.CMI5="CMI5",e.Scorm11="SCORM_11",e.Scorm12="SCORM_12",e.Scorm2004SecondEdition="SCORM_2004_2ND_EDITION",e.Scorm2004ThirdEdition="SCORM_2004_3RD_EDITION",e.Scorm2004Fourth="SCORM_2004_4TH_EDITION",e.TINCAN="TINCAN"}(G||(G={}));const B=g.A,F=g.t;f.a.factory(B,["restmod",b.c,"$q","$rootScope","$ngRedux",F,p.b,(e,t,n,i,s,o,p)=>{Object(u.f)(new A),Object(u.f)(new w),Object(u.f)(new T(n,i,o)),Object(u.f)(new $);let g=!1;p.createWaiter("feature.course.content.inline-render").then((e=>g=e)),Object(u.f)(new P.b(n,p)),Object(u.f)(new x(i)),Object(u.f)(new O);const b=e.model().mix({depth:{mask:!0},children:{mask:!0},softLinks:{mask:!0},"adaptiveReleaseRules.startDate":{serialize:"date"},"adaptiveReleaseRules.endDate":{serialize:"date"},position:{mask:"CU"},selfEnrollmentGroups:{mask:"CU"},positionBefore:{mask:"R"},positionAfter:{mask:"R"},hasMoreChildren:{mask:!0},launchInNewWindow:{init:!0},ui:{mask:!0,init:()=>({hasData:!1,isDeleted:!1,isOpen:!1})},$extend:{Record:{getDeployedAssessment(){var e;if(!this.contentDetail)return;const t=Object(d.Uc)(null===(e=this.contentHandler)||void 0===e?void 0:e.toString());if(t){const e=this.contentDetail[this.contentHandler.toString()];return e.gradingColumn?e:e[t]}},getAssociatedGradingColumn(e){const t=this.contentDetail&&this.contentDetail[this.contentHandler.toString()];if(t&&t.gradingColumn)return t.gradingColumn;if(t){const e=this.getDeployedAssessment();if(e)return e.gradingColumn}},getDueDate(){return this.genericReadOnlyData&&this.genericReadOnlyData.dueDate},getContentHandlerByIconUrl(){const e=this.iconUrl.match("^/.*/(.*)_.*..*$");let t=c.i.Unknown;if(e)switch(e[1]){case"assignment":t=c.i.UltraAssignment;break;case"discussion":t=c.i.Discussion;break;case"file":t=c.i.File;break;case"folder":t=c.i.Folder;break;case"link":t=c.i.ExternalLink;break;case"test":t=c.i.TestLink}return t},setupAssessmentContentDetail(e,t){const n=this.contentHandler.toString(),a=Object(d.Sc)(n),i=Object(d.Uc)(n);if(a&&i){this.contentDetail={},this.contentDetail[n]={};const s=r(v.a.getServerTime()).startOf("day").add({days:1}).toDate();this.contentDetail[n][i]={deployedAssessmentType:i,assessment:{title:this.title,type:a},deploymentSettings:{feedbackSettings:{[d.e.AfterSubmission]:{options:[d.f.InstructorFeedback,d.f.UserAnswers,d.f.AllAnswers]},[d.e.AfterAttemptGraded]:{options:[d.f.Score]}}},gradingColumn:{columnName:this.title,possible:0,visible:!1,gradebookCategoryId:t?t.id:null,gradebookCategory:t,gradingSchemaId:e,courseId:this.courseId,dueDate:s},permissions:{modify:!0}}}},createScormSettings(e){const t={method:"POST",url:this.$url()+"/scormSettings",data:e},a=n.defer();return this.$scope.$collection().$send(t,(e=>{a.resolve(e.data)}),(e=>{a.reject(e)})),a.promise},conditionalReleaseAsync(e,t,n,a){let i=n?"/rules/"+n+"/conditions":"";a&&(i+=`/${a}`);const r={method:e,url:this.$url()+"/adaptiveReleaseRules"+i};if(t&&"DELETE"!==e&&(r.data=t),"GET"===e)return this.$scope.$collection().$send(r).$then((e=>e.$unwrap(e.$response.data)));if("DELETE"===e){const e=c.i.CourseLink.isEqualTo(this.contentHandler)?this.contentDetail[c.i.CourseLink.toString()].linkSourceId:this.id;if(t&&t.type)s.dispatch(c.V.content.deleteAdaptiveReleaseRuleInStore(e,t.type));else{if(this.isForcedSequenceItem())return this.removeNonForcedSequenceReleaseCriteria();s.dispatch(c.V.content.deleteAdaptiveReleaseRulesInStore(e))}}return this.$scope.$collection().$send(r)},removeNonForcedSequenceReleaseCriteria(){const e=this.adaptiveReleaseRules.rules[0],t=c.i.CourseLink.isEqualTo(this.contentHandler)?this.contentDetail[c.i.CourseLink.toString()].linkSourceId:this.id,a=`/rules/${e.id}/conditions/`,i={method:"DELETE"},r=[];return e.criteria.filter((e=>e.type!==c.d.ForcedSequence.toString())).forEach((e=>{s.dispatch(c.V.content.deleteAdaptiveReleaseRuleInStore(t,e.type)),i.url=this.$url()+"/adaptiveReleaseRules"+a+e.id,r.push(this.$scope.$collection().$send(i).$asPromise())})),n.all(r).then((()=>{}))},getChildren(e){e=e||{};const n=this,a=[];return this.$scope.$collection().$send({method:"GET",url:this.$url()+"/children",params:{offset:e.offset,limit:e.limit,contentHandler:e.contentHandler,recursive:e.recursive,onlyUltraConvertableContents:e.onlyUltraConvertableContents,contentSearchMode:e.contentSearchMode,title:e.title,"courseLinkPickerParam.contentHandlerGroups":e.courseLinkPickerParamContentHandlerGroups,expand:"assignedGroups,selfEnrollmentGroups.group",sort:e.sort,"@view":"Summary"}}).$then((n=>{if(e.resolveLinks&&n.$response.data.results&&n.$response.data.results.length){const e=t.getDataMixin(n.findMany.bind(n),"linkSourceId","linkSource");if(n.$response.data.results.forEach((e=>{c.i.CourseLink.isEqualTo(e.contentHandler)&&e.contentDetail&&a.push({linkId:e.id,linkSourceId:e.contentDetail[c.i.CourseLink.toString()].linkSourceId})})),a.length)return e(a,{}).then((()=>n))}})).$then((e=>{e.$unwrap(e.$response.data);const t={};a.forEach((e=>{t[e.linkId]=e.linkSource})),e.forEach((e=>{e.depth=n.depth+1,t[e.id]&&(e.ui.linkSource=t[e.id])}))}))},getClassicContent(){return this.$scope.$collection().$send({method:"GET",url:this.$scope.$url(),params:{onlyUltraConvertableContents:"true"}}).$then((e=>{e.$unwrap(e.$response.data)}))},getLinkContentSource(e){if(e=e||{},c.i.CourseLink.isEqualTo(this.contentHandler)&&this.contentDetail){if(this.ui.linkSource&&this.ui.linkSource.$pk&&!e.fromServer)return this.ui.linkSource;const t=this.ui.linkSource;if(this.ui.linkSource=this.$scope.$new(this.contentDetail[c.i.CourseLink.toString()].linkSourceId),this.contentDetail[c.i.CourseLink.toString()].linkSourceId){const e=this.ui.linkSource.$fetch({expand:"assignedGroups,selfEnrollmentGroups.group"});return t&&(e.contentHandler=t.contentHandler,e.contentDetail=t.contentDetail),e}return this.ui.linkSource}},getChildrenCount(){return this.$scope.$build().$send({method:"GET",url:this.$url()+"/children/count"}).$asPromise().then((e=>e.$response.data.count))},hasGradedContentItems(){return this.$scope.$build().$send({method:"GET",url:this.$url()+"/hasGrades"}).$asPromise().then((e=>e.$response.data.result))},canForcedSequenceBeEnabled(){return this.$scope.$build().$send({method:"GET",url:this.$url()+"/canForcedSequenceBeEnabled"}).$asPromise().then((e=>e.$response.data.result))},hasCourseLinks(){return this.$scope.$build().$send({method:"GET",url:this.$url()+"/hasCourseLinks"}).$asPromise().then((e=>e.$response.data.result))},isCurrentUserEligibleToAlignGoals(){return this.permissions&&!0===this.permissions.createLearningStandardsAlignment&&this.permissions.edit},getContentIdForGoalAlignment(){return"blackboard.data.content.Content;"+this.id},getContentTitleForGoalAlignment(){return this.title},getSibling(e,t){return this.$scope.$build().$send({method:"GET",url:this.$url()+"/"+e,params:{lessonContentId:t}}).$asPromise().then((e=>e.$response.data.id?this.$scope.$buildRaw(e.$response.data):null))},getAttemptCount(){const e=this.getAssociatedGradingColumn();return this.$scope.$collection().$send({method:"GET",url:e["@id"]+"/attempts/count"}).$suppressErrorDialog().$asPromise().then((e=>e.$response.data.count))},getTimeLimit(){return this.getDeployedAssessment()&&this.getDeployedAssessment().exceptions&&this.getDeployedAssessment().exceptions.length>0?this.getDeployedAssessment().exceptions[0].timeLimit:this.getDeployedAssessment()&&this.getDeployedAssessment().deploymentSettings?this.getDeployedAssessment().deploymentSettings.timeLimit:void 0},getExtraTime(){const e=this.getDeployedAssessment()&&this.getDeployedAssessment().deploymentSettings;if(e&&e.softTimeLimit)return e.timeLimit-e.softTimeLimit},getTimedTestDetail(){const e=this.contentDetail&&this.getDeployedAssessment()&&this.getDeployedAssessment().deploymentSettings;let t=null,n=null,a=null;const i=e?this.getDeployedAssessment().deploymentSettings.softTimeLimit:null;e&&(n=this.getDeployedAssessment().deploymentSettings.timeLimit,t=this.getDeployedAssessment().deploymentSettings.timerCompletion,a=this.getDeployedAssessment().deploymentSettings.isDueDateEnforced?new Date(this.getAssociatedGradingColumn().dueDate):null);const r={timerCompletion:t,timeLimitSec:n?60*n:null,softLimitSec:i?60*i:null,dueDate:a};return new S.a(r)},getSoftLinks(e){e=e||{};const t=this;return this.$scope.$collection().$send({method:"GET",url:this.$url()+"/softLinks",params:{offset:e.offset,limit:e.limit,label:e.label}},(function(e){this.$unwrap(e.data),t.softLinks=this}))},update(){const e=this.$scope.$build();for(const t of Object.keys(this))e[t]=this[t];return this.$scope.$build().$send({method:"POST",url:this.$scope.$url()+"/"+this.id,data:e})},canEdit(){return c.j.canEdit(this)},canEditPartial(){let e=this.canEdit();if(this.contentDetail){const t=this.getDeployedAssessment();if(t){const n=t.permissions;n&&(e=e||n.modifyDueDate||n.view)}}return!!e},canEditAvailability(){return c.j.canEditAvailability(this)},canViewAsInstructor(){return this.canEdit()||this.permissions&&this.permissions.viewDesigner},canDelete(){return this.permissions&&this.permissions.delete},canUpdateReviewState(){var e;return null===(e=this.permissions)||void 0===e?void 0:e.canUpdateReviewState},hasConversation(){return!!this.attachedForumLink},hasDueDateException(){return null!=this.dueDateExceptionType&&this.dueDateExceptionType!==d.D.Normal},hasGradingColumn(){return!!this.getAssociatedGradingColumn()},hasDueDate(){return this.genericReadOnlyData&&this.genericReadOnlyData.hasGradeColumn},hasOnlyForcedSequenceConditionalReleaseCriteria(){return!!this.isForcedSequenceItem()&&1===this.adaptiveReleaseRules.rules[0].criteria.length},isVisible(){return this.visibility&&d.w.Visible===this.visibility},isRestricted(){return this.visibility&&d.w.Restricted===this.visibility},isStarted(){return this.state===d.u.Started},isCompleted(){return this.state===d.u.Completed},isHidden(){return this.visibility&&d.w.Hidden===this.visibility},isVisibleToStudents(){return c.j.isVisibleToStudents(this)},isHiddenFromStudents(){return c.j.isHiddenFromStudents(this)},isConditionalRelease(){return c.h.isConditionalRelease(this)},isForcedSequenceModule(){return this.isLearningModule()&&this.contentDetail[h.p.ContentHandler.LearningModule.toString()].isSequential},isInForcedSequenceModule(){return this.inSequence},isForcedSequenceItem(){return this.adaptiveReleaseRules&&this.adaptiveReleaseRules.rules&&this.adaptiveReleaseRules.rules[0]&&!!a.find(this.adaptiveReleaseRules.rules[0].criteria,{type:"Pre_Content"})},isActiveForcedSequenceModule(){return this.isForcedSequenceModule()&&this.hasProgressed},applyForcedSequence(e){this.contentDetail[h.p.ContentHandler.LearningModule.toString()].isSequential=e,this.children&&(this.children.forEach((t=>{t.inSequence=e,t.children&&t.children.forEach((t=>t.inSequence=e))})),this.children.forEach((t=>{t.isPartiallyVisible=e,e?a.has(t,"adaptiveReleaseRules.rules[0].criteria[0]")?t.adaptiveReleaseRules.rules[0].criteria.push({type:"Pre_Content"}):a.set(t,"adaptiveReleaseRules.rules[0].criteria[0]",{type:"Pre_Content"}):t.adaptiveReleaseRules&&t.adaptiveReleaseRules.rules&&t.adaptiveReleaseRules.rules[0].criteria.length&&(a.remove(t.adaptiveReleaseRules.rules[0].criteria,{type:"Pre_Content"}),t.adaptiveReleaseRules.rules[0].criteria.length&&(t.isAvailable=!0)),i.$broadcast("refresh-conditional-release-rules",t)})))},isConditionalReleaseWithVisibleButNotAccessible(){return this.isConditionalRelease()&&this.isPartiallyVisible},isConditionalReleaseWithHiddenFromStudent(){return this.isConditionalRelease()&&!this.isPartiallyVisible&&!this.hasOnlyForcedSequenceConditionalReleaseCriteria()},isConditionalReleaseLocked(){const e=this.adaptiveReleaseRules&&this.adaptiveReleaseRules.rules;return e&&e.length>0&&this.isRestricted()},isConditionalReleaseUnlocked(){const e=this.adaptiveReleaseRules&&this.adaptiveReleaseRules.rules;return e&&e.length>0&&this.isVisible()},containsCriteriaWithGradeColumnId(e){var t,n;return null===(n=null===(t=this.adaptiveReleaseRules)||void 0===t?void 0:t.rules)||void 0===n?void 0:n.some((t=>{var n;return null===(n=t.criteria)||void 0===n?void 0:n.some((t=>t.type===c.d.Grade.toString()&&t.gradeColumnId===e))}))},getVisibilityAsStudent(){return this.isVisibleToStudents()?d.w.Visible:this.isConditionalRelease()?d.w.Restricted:d.w.Hidden},getContentDisplay(){return m.a.create(this,{supportsInlineRender:g})},saveAlignedGoals(e){return e&&(this.alignedGoals=e.map((e=>({goalId:e.id,isVisibleToStudent:!0,goal:e})))),this.$send({method:"PATCH",url:this.$url(),data:{alignedGoals:this.alignedGoals}}).$then((()=>{this.$getPreviousVersion()&&(this.$getPreviousVersion().alignedGoals=this.alignedGoals)}))},saveAssignedGroups(e=!1){const t=this.getDeployedAssessment(),n=this.contentHandler.toString(),a=Object(d.Uc)(n),i={assignedGroups:this.assignedGroups,isGroupContent:this.isGroupContent},r=!e&&t&&t.deploymentSettings&&t.deploymentSettings.id&&1===t.deploymentSettings.attemptCount;if(r){const e={id:t.deploymentSettings.id,attemptCount:t.deploymentSettings.attemptCount,feedbackSettings:t.deploymentSettings.feedbackSettings};i.contentDetail={[n]:{[a]:{deployedAssessmentType:a,deploymentSettings:e}}}}return this.withParams({expand:"assignedGroups,selfEnrollmentGroups.group"}).$send({method:"PATCH",url:this.$url(),data:i},(function(e){this.isGroupContent=e.data.isGroupContent,this.assignedGroups=e.data.assignedGroups,this.selfEnrollmentGroups=e.data.selfEnrollmentGroups,r&&(t.gradingColumn.multipleAttempts=e.data.contentDetail[n][a].gradingColumn.multipleAttempts)})).$then((()=>{const e=this.$getPreviousVersion();if(e&&(e.isGroupContent=this.isGroupContent,e.assignedGroups=this.assignedGroups,e.selfEnrollmentGroups=this.selfEnrollmentGroups,r)){const i=e.contentDetail[n][a];i.deploymentSettings.attemptCount=t.deploymentSettings.attemptCount,i.gradingColumn.multipleAttempts=t.gradingColumn.multipleAttempts}}))},removeTimeLimit(e){const t=this.contentHandler.toString(),n=Object(d.Uc)(t);if(e&&n)return this.$send({method:"PATCH",url:this.$url(),data:{contentDetail:{[t]:{[n]:{deployedAssessmentType:this.getDeployedAssessment().deployedAssessmentType,deploymentSettings:{attemptCount:e.attemptCount?e.attemptCount:1,timerCompletion:e.timerCompletion?e.timerCompletion:d.ac.Continual,timeLimit:null,softTimeLimit:null}}}}}},(function(e){delete this.getDeployedAssessment().deploymentSettings.timeLimit,delete this.getDeployedAssessment().deploymentSettings.softTimeLimit,this.contentDetail[t].test.deploymentSettings.timerCompletion=e.data.contentDetail[t].test.deploymentSettings.timerCompletion})).$then((()=>{this.$getPreviousVersion()&&(delete this.$getPreviousVersion().contentDetail[t].test.deploymentSettings.timeLimit,delete this.$getPreviousVersion().contentDetail[t].test.deploymentSettings.softTimeLimit,this.$getPreviousVersion().contentDetail[t].test.deploymentSettings.timerCompletion=this.contentDetail[t].test.deploymentSettings.timerCompletion)}))},patchProctoringService(e){const t=this.contentHandler.toString(),a=Object(d.Uc)(t),i=n.defer();return this.$send({method:"PATCH",url:this.$url(),data:{contentDetail:{[t]:{[a]:{deployedAssessmentType:this.getDeployedAssessment().deployedAssessmentType,deploymentSettings:{proctoringServiceHandle:e}}}}}},(e=>i.resolve(e.data)),(()=>i.reject("Failed to change proctoring service."))),i.promise},updateProctoringSettings(e){const t=n.defer(),a=e=>{if(L(this)&&L(e)){const t=e.contentHandler.toString(),n=e.contentDetail[t].test.deploymentSettings,a=this.contentDetail[t].test.deploymentSettings;if(a.proctoringServiceHandle=n.proctoringServiceHandle,a.proctoringServiceVendor=n.proctoringServiceVendor,a.proctoringDownloadUrl=n.proctoringDownloadUrl,a.isSecureBrowserRequiredToTake=n.isSecureBrowserRequiredToTake,a.isSecureBrowserRequiredToReview=n.isSecureBrowserRequiredToReview,a.isWebcamRequired=n.isWebcamRequired,this.$getPreviousVersion()){const e=this.$getPreviousVersion().contentDetail[t].test.deploymentSettings;e.proctoringServiceHandle=n.proctoringServiceHandle,e.proctoringServiceVendor=n.proctoringServiceVendor,e.proctoringDownloadUrl=n.proctoringDownloadUrl,e.isSecureBrowserRequiredToTake=n.isSecureBrowserRequiredToTake,e.isSecureBrowserRequiredToReview=n.isSecureBrowserRequiredToReview,e.isWebcamRequired=n.isWebcamRequired}}};return e?(a(e),t.resolve(this)):this.withParams({fields:"contentHandler,contentDetail"}).$send({method:"GET",url:this.$url()},(e=>{a(e.data),t.resolve(this)}),(()=>{t.reject("Failed to fetch latest when updating proctoring settings.")})),t.promise},updateProctoringAssociation(e){return this.patchProctoringService(e).then((e=>this.updateProctoringSettings(e)))},getProctoringLaunchLink(e){const t=n.defer();let a=l.a.apiBasePath+"/v1/courses/"+this.courseId+"/contents/"+this.id;return e.attemptId&&(a+="/attempts/"+e.attemptId),a+="/proctoring/launchLink",e.password&&(a+=`?password=${encodeURIComponent(e.password)}`),this.$send({method:"GET",url:a},(e=>{e?t.resolve(e.data.launchLink):t.reject("Failed to fetch assessment launch link.")})).$allow([d.S.Unauthorized,d.S.TooManyRequests]).$asPromise().then((e=>{t.reject(e.$response)})),t.promise},getProctoringServiceVendor(){const e=L(this);return null==e?null:e.proctoringServiceVendor||null},getProctoringServiceHandle(){const e=L(this);return null==e?null:e.proctoringServiceHandle||null},isSecureBrowserRequiredToTake(){const e=L(this);return null!=e&&!(e.proctoringServiceHandle!==E.b||!e.isSecureBrowserRequiredToTake)},isSecureBrowserRequiredToReview(){const e=L(this);return null!=e&&!(e.proctoringServiceHandle!==E.b||!e.isSecureBrowserRequiredToReview)},isWebcamRequired(){const e=L(this);return null!=e&&!(e.proctoringServiceHandle!==E.b||!e.isWebcamRequired)},getProctoringDownloadUrl(){const e=L(this);return null==e?null:e.proctoringDownloadUrl||null},userNeedsToSelfEnrollInGroup(){return this.isGroupContent&&this.assignedGroups&&0===this.assignedGroups.length&&this.selfEnrollmentGroups&&this.selfEnrollmentGroups.length>0},setVisibility(e,t=!0){switch(this.adaptiveReleaseRules={startDate:null,endDate:null},e){case d.w.Visible:this.isAvailable=!0,this.isPartiallyVisible=!1;break;case d.w.Hidden:this.isAvailable=!1,this.isPartiallyVisible=!1;break;case d.w.Restricted:this.isAvailable=!0,this.isPartiallyVisible=t}},setTitle(e){this.title=e;const t=this.getAssociatedGradingColumn();t&&(t.columnName=e);try{this.getDeployedAssessment().assessment.title=e}catch(e){}},isUiFolder(){return c.i.Folder.isEqualTo(this.contentHandler)&&!this.isBbPage()},isFolder(){return!!c.i.Folder.isEqualTo(this.contentHandler)||!!c.i.Unknown.isEqualTo(this.contentHandler)&&void 0},isBbPage(){if(this.contentDetail){const e=this.contentDetail[c.i.Folder.toString()];if(c.i.Folder.isEqualTo(this.contentHandler)&&e&&e.isBbPage)return!0;if(c.i.Unknown.isEqualTo(this.contentHandler))return;return!1}return!1},isRoot(){return y.h.ROOT.isEqualTo(this.$pk)||y.h.INTERACTIVE.isEqualTo(this.$pk)},isAssignment(){return c.i.UltraAssignment.isEqualTo(this.contentHandler)},isDocument(){return c.i.Folder.isEqualTo(this.contentHandler)&&this.isBbPage()},isFile(){return c.i.File.isEqualTo(this.contentHandler)},isJournal(){return c.i.Journal.isEqualTo(this.contentHandler)},isLink(){return c.i.ExternalLink.isEqualTo(this.contentHandler)},isCourseLink(){return c.i.CourseLink.isEqualTo(this.contentHandler)},isLtiLink(){return c.i.LtiLink.isEqualTo(this.contentHandler)},isLtiPlacement(){return c.i.LtiPlacement.startsWith(this.contentHandler)},isPartnerCloud(){return c.i.PartnerCloud.isEqualTo(this.contentHandler)},isPlaceHolderContent(){return this.isLink()||this.isLtiLink()||this.isLtiPlacement()||this.isPartnerCloud()},isTest(){return c.i.TestLink.isEqualTo(this.contentHandler)},isScorm(){return c.i.RusticiScorm.isEqualTo(this.contentHandler)},isGradedScorm(){return this.isScorm()&&!!this.getAssociatedGradingColumn()},isDiscussion(){return!!c.i.Discussion.isEqualTo(this.contentHandler)||c.i.CourseLink.isEqualTo(this.contentHandler)&&this.isDiscussionInOutline()},isLearningModule(){return!!c.i.LearningModule.isEqualTo(this.contentHandler)||!!c.i.Unknown.isEqualTo(this.contentHandler)&&void 0},isDiscussionInOutline(){return this.getContentHandlerByIconUrl().isEqualTo(c.i.Discussion)},getSafeAssignAttrs(){return this.contentDetail[this.contentHandler.toString()].safeAssignOptions},isSafeAssignOn(){return!!this.contentDetail&&!!this.contentDetail[this.contentHandler.toString()].safeAssignOptions},isSafeAssignEnabled(){return this.isSafeAssignOn()&&this.getSafeAssignAttrs().checkAttempts},canStudentViewReports(){return this.isSafeAssignOn()&&this.getSafeAssignAttrs().canStudentViewReports},canSubmitToGlobalReferenceDatabase(){return this.isSafeAssignOn()&&!this.getSafeAssignAttrs().excludeSubmissions&&this.getSafeAssignAttrs().globalSearch},canHaveAttempts(){return c.i.UltraAssignment.isEqualTo(this.contentHandler)||c.i.TestLink.isEqualTo(this.contentHandler)||c.i.LtiLink.isEqualTo(this.contentHandler)||c.i.LtiPlacement.startsWith(this.contentHandler)||c.i.PartnerCloud.isEqualTo(this.contentHandler)||c.i.Discussion.isEqualTo(this.contentHandler)||c.i.CourseLink.isEqualTo(this.contentHandler)||c.i.Journal.isEqualTo(this.contentHandler)||this.isScorm()},canHaveSharedGradingColumn(){return c.i.PartnerCloud.isEqualTo(this.contentHandler)},applyAvailabilitySettings(e){this.adaptiveReleaseRules=e.adaptiveReleaseRules,this.isAvailable=e.isAvailable,this.isPartiallyVisible=e.isPartiallyVisible},applyGroupSettings(e){this.isGroupContent=e.isGroupContent,this.assignedGroups=e.assignedGroups,this.selfEnrollmentGroups=e.selfEnrollmentGroups},addAndRevealAtIndex(e){this.$moveTo(e),this.$reveal()},findInTreeById(e,t){return this.findLoadedNodeByIdAndCache(e,t)},findLoadedNodeByIdAndCache(e,t,n=3){return null!=t&&t.id===e||(t=this.findLoadedNodeById(e,n)),t},findLoadedNodeById(e,t){if(t<0)return null;if(null==e&&null==this.id||e===this.id)return this;if(this.children){t--;for(let n=0;n<this.children.length;n++){const a=this.children[n].findLoadedNodeById(e,t);if(a)return a}}},moveTo(e,t,n){if(this.id===t||this.id===n)return;this.$scope.$remove(this),this.$scope.fixPositions(),null!=t&&(n=void 0);const a=e.children.getInsertionIndex(t,n,!1,e.hasMoreChildren);null!=t&&0===a&&(t="start"),null==n||a!==e.children.length||e.hasMoreChildren||(n="end"),e.children.$add(this,a),this.$scope=e.children,this.$scope.fixPositions(),this.positionBefore=t,this.positionAfter=n,this.parentId=e.id,this.depth=null!=e.depth?e.depth+1:void 0},shouldRestrict(){return!this.canEdit()&&this.isRestricted()},isQuestionAnalysisAvailable(){return this.isAssignment()||this.isTest()},updateState(e,t=!1){var a;let r=n.when(this);return(null===(a=this.permissions)||void 0===a?void 0:a.canHaveReviewState)?(this.state=e,t&&(r=this.$send({method:"PATCH",url:`${this.$url()}/states/me`,data:{state:e}}).$asPromise()),r.then((()=>(i.$broadcast(I.b,this,e),s.dispatch(c.V.contentReviewState.getContentReviewState(this.courseId,this.id,!0)),this)))):r}},Collection:{indexOfItemById(e){return this.$indexOf((t=>(t.id===e||null==t.id&&null==e)&&!t.ui.importPlaceholder))},buildAndRevealAtPosition(e,t){const n=this.getInsertionIndex(e.positionBefore,e.positionAfter);if(n>-1){const a=this.$build(t);return a.addAndRevealAtIndex(n),null!=e.positionBefore&&(a.positionBefore=e.positionBefore),null!=e.positionAfter&&null==e.positionBefore&&(a.positionAfter=e.positionAfter),a}},getInsertionIndex(e,t,n,a){const i=null==n||n;let r=-1;return null!=e&&(r="start"===e.toLowerCase()?0:this.indexOfItemById(e),!i&&r<0&&(r=0)),r<0&&null!=t&&("end"===t.toLowerCase()?null==a||a||(r=this.length):(r=this.indexOfItemById(t),r>=0&&r++),!i&&r<0&&(r=this.length)),r},fixPositions(){for(let e=0;e<this.length;e++)this[e].position=e}}},$hooks:{"after-request":function(e){var t;if(200===e.status&&!(e.config.params&&e.config.params.fields||(e.data.adaptiveReleaseRules||(this.adaptiveReleaseRules=null),"GET"!==e.config.method&&"JSONP"!==e.config.method))){if(null===(t=e.data)||void 0===t?void 0:t.results)return void e.data.results.forEach((e=>{const t=Object(C.a)(e);s.dispatch(c.V.content.setContents(t))}));if(e.data){const t=e,n=Object(C.a)(t.data);s.dispatch(c.V.content.setContents(n))}}},"before-request":function(e){if(!["/ROOT","/count","/softLinks"].some((t=>a.endsWith(e.url,t)))&&"DELETE"!==e.method){const t="gradebookCategory";e.params&&e.params.expand?a.includes(e.params.expand,t)||(e.params.expand+=`,${t}`):e.params={expand:t,...e.params}}"PATCH"!==e.method&&"PUT"!==e.method||e.data&&e.data.title&&this.safeAssignOptions&&(e.data.safeAssignOptions=this.safeAssignOptions)},"before-render":function(e){const t=this;if(e.contentDetail){const n=t.getDeployedAssessment.call(e);if(n){const e=n.gradingColumn;e&&!e.peerGrading&&n&&n.peerSettings&&delete n.peerSettings}}},"after-save":e=>{const t=Object(C.a)(e.data);s.dispatch(c.V.content.persistContentSync(t))}}});return b.$extendRecord((function(e,t){if(t.contentHandler&&c.i.CourseLink.isEqualTo(t.contentHandler))return{getDueDate(){return this.getLinkContentSource()&&this.getLinkContentSource().getDueDate()},hasDueDate(){return this.getLinkContentSource()&&this.getLinkContentSource().hasDueDate()},hasReport:()=>!1}})),b.$extendRecord((function(e,t){if(t.contentHandler&&c.i.LtiLink.isEqualTo(t.contentHandler))return{getDueDate(){return this.getAssociatedGradingColumn()&&this.getAssociatedGradingColumn().dueDate},hasDueDate(){return this.hasGradingColumn()}}})),b.$extendRecord(((e,t)=>{if(t.contentHandler&&c.i.RusticiScorm.isEqualTo(t.contentHandler))return{getAssociatedGradingColumn(e){const t=this.getScormGradebookItems();let n=null;return n=e?t.find((t=>t.columnId===e)):t.find((e=>e.root))||t[0],n&&n.gradingColumn},getDueDate(){const e=this.getAssociatedGradingColumn();return e&&e.dueDate},hasDueDate(){return this.hasGradingColumn()},getScormGradebookItems(){const e=this.contentDetail&&this.contentDetail[this.contentHandler.toString()];return e&&e.gradebookItems||[]},getScormLearningStandard(){const e=this.contentDetail&&this.contentDetail[this.contentHandler.toString()];return e&&e.learningStandard||"UNKNOWN"},getScormAdvancedSettings(){const e=this.contentDetail&&this.contentDetail[this.contentHandler.toString()];return e&&e.advancedSettings||{}},getScormReport(){const e={method:"GET",url:this.$url()+"/scormReport"},t=n.defer();return this.$scope.$collection().$send(e,(e=>{t.resolve(e.data)}),(e=>{t.reject(e)})),t.promise},isTinCan(){const e=this.contentDetail&&this.contentDetail[this.contentHandler.toString()];return!(!e||G.TINCAN!==e.learningStandard)},hasReport(){return!this.isTinCan()&&!!this.getScormGradebookItems().length},setTitle(e){this.title=e;const t=this.getScormGradebookItems().find((e=>e.root));t&&(t.title=e,t.gradingColumn.columnName=e)}}})),b}])},fmWv:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n("In+A"),i=n("caKH");class r{constructor(e){this.modalStackedMap=e,this.hasAngularModal=!1,this.hasReactModal=!1,this._started=!0,this.onReactModalChanged=e=>{this.hasReactModal=e,this.updateGuidanceState()},this.onAngularModalChanged=e=>{this.hasAngularModal=!!e,this.updateGuidanceState()},a.e.addWatcher(this)}get started(){return this._started}set started(e){this._started=e,this.startedCallback&&this.startedCallback(e)}start(){i.b.getInstance().addOnModalDisplayingChanged(this.onReactModalChanged),this.modalStackedMap.addTopListener(this.onAngularModalChanged)}onStateChanged(e){this.startedCallback=e}updateGuidanceState(){this.started=!this.hasReactModal&&!this.hasAngularModal}}},fzj8:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var a=n("Llzl"),i=n("0JpG"),r=n("Qbdf"),s=n("UD9g"),o=n("Cxi4"),l=n("pjml"),c=n("TnpK"),d=n("g7Mf"),u=n("w9Zy"),m=n("nmzr"),p=n("36CG");const h="ultra.course.engagement.router";a.module(h,[i.moduleName,c.b,o.a,s.b,d.b,r.b,p.d]).config([c.c,r.c,p.e,(e,t,a)=>{e.peekState(m.r.DISCUSSION,{abstract:!0,url:"/discussion",resolve:{translations:["$q",i.serviceName,(e,t)=>{const n=[];return n.push(t.loadBundle("features/course/engagement/course-engagement")),n.push(t.loadBundle("features/course/content/course-content")),n.push(t.loadBundle("features/course/goal-alignment/goal")),e.all(n)}],[r.d]:t.resolve,canCreateAllContent:[o.b,c.d,(e,t)=>e.canCreateAllContent(t.nextParams.courseId)],hasEditAvailabilityPermission:[o.b,c.d,(e,t)=>e.hasEditAvailabilityPermission(t.nextParams.courseId)]}}).peekState(m.r.DISCUSSION_VIEW,{abstract:!0,url:"/{contentId:_[0-9]+_1|create}?courseId&parentId&position&positionBefore&positionAfter",panelClass:"full",pageTitle:"course.content.discussion",require:()=>Promise.all([n.e(3),n.e(13),n.e(31),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(22),n.e(20),n.e(52),n.e(65),n.e(150),n.e(177),n.e(712)]).then(n.bind(null,"uypo")),resolve:{translations:["$q",i.serviceName,(e,t)=>{const n=[];return n.push(t.loadBundle("components/directives/grade/grade-input")),n.push(t.loadBundle("components/directives/grade/display-grade")),e.all(n)}],currentCourseMemberships:"^courseMembershipsLoader",discussionInit:[d.c,"currentCourseMemberships",(e,t)=>e.init(t)]},onExit:[d.c,e=>{e.destroy()}]}).peekState(m.r.DISCUSSION_VIEW_WITH_GRADING,{url:"?view&disGroupId&gradingStatus&studentStatus",panelClass:"full",views:{"engagement-edit@":{require:()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(20),n.e(52),n.e(65),n.e(75),n.e(91),n.e(725)]).then(n.bind(null,"m3My"))},"engagement-grade@":{require:()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(34),n.e(60),n.e(165)]).then(n.bind(null,"4Rme"))}},onEnter:[c.d,u.e,(e,t)=>{e.isPeekPanelOpen()&&t.expandTopPanel()}],onExit:["$rootScope",e=>{e.$broadcast("deadline-refresh")}],peekStates:[m.k.CONDITIONAL_RELEASE_PEEK_PANEL,m.i.CONTENT_MARKET,"course-group","discussion-details","discussion-participants","discussion-settings",s.a,m.C.LTI,m.n.COURSE_MESSAGE,"rubric","rubric-evaluation","rubric-view","submission-list","view-exceptions","discussion-feedback","discussions-settings","per-gradable-item-settings"],peekViewName:"discussion-peek@",pageTitle:"course.content.discussion",resolve:{[p.f]:a.resolve,currentColumn:[c.d,r.d,(e,t)=>{const n=e.nextParams.columnId;if(n&&n!==l.C.CREATE_COLUMN_ID)return t.gradebook.columns.$find(n).$asPromise()}]}}).peekState(m.r.SUBMISSION_LIST,{url:"/grading/:columnId/detail?participantId&contentId&disGroupId",panelClass:"full",require:()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(22),n.e(52),n.e(75),n.e(591)]).then(n.bind(null,"nbFo")),resolve:{translations:["$q",i.serviceName,(e,t)=>{const n=[];return n.push(t.loadBundle("features/course/engagement/course-engagement")),n.push(t.loadBundle("components/directives/grade/submission-list")),n.push(t.loadBundle("components/directives/grade/grade-input")),n.push(t.loadBundle("components/directives/grade/display-grade")),n.push(t.loadBundle("components/directives/discussion")),e.all(n)}],[r.d]:t.resolve,currentColumn:[c.d,r.d,(e,t)=>{const n=e.nextParams.columnId;if(n&&n!==l.C.CREATE_COLUMN_ID)return t.gradebook.columns.$find(n,{expand:"associatedRubrics"}).$asPromise()}],[p.f]:a.resolve,memberships:[r.d,e=>(e.memberships.$clear(),e.memberships.$fetch({expand:"user",roleBucket:"taking"}).$asPromise())]},pageTitle:"course.engagement.submissionTitle",peekStates:[m.n.COURSE_MESSAGE,"discussion-feedback","rubric-evaluation"],peekViewName:"engagement-submissions-peek@"}).peekState(m.r.DISCUSSION_SETTINGS,{url:"/settings?contentId&focusEleId",require:()=>Promise.all([n.e(0),n.e(20),n.e(52),n.e(65),n.e(177),n.e(575)]).then(n.bind(null,"W67U")),resolve:{translations:["$q",i.serviceName,(e,t)=>e.all([t.loadBundle("features/course/goal-alignment/goal"),t.loadBundle("features/course/engagement/discussion-settings")])],currentCourseMemberships:"^courseMembershipsLoader",discussionInit:[d.c,"currentCourseMemberships",(e,t)=>e.init(t)]},onExit:[d.c,e=>{e.destroy()}],pageTitle:"course.engagement.discussionSettingsTitle",peekViewName:"discussion-group",allowChildPeekStates:!0,peekStates:["course-group","goal-picker-legacy","rubric","rubric-view"]}).peekState(m.r.DISCUSSION_PARTICIPANTS,{url:"/participants",require:()=>n.e(678).then(n.bind(null,"IrK9")),pageTitle:"course.engagement.participantsTitle"}).peekState("discussion-details",{url:"/details",require:()=>Promise.all([n.e(0),n.e(599)]).then(n.bind(null,"DTfl")),pageTitle:"course.engagement.discussionDetailsTitle",peekStates:["discussion-feedback"]}).peekState("discussion-feedback",{url:"/feedback?forumId&isReadOnlyPanel&columnId",require:[()=>n.e(652).then(n.bind(null,"pq88")),()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(34),n.e(60),n.e(165)]).then(n.bind(null,"4Rme"))],resolve:{translations:[i.serviceName,e=>e.loadBundle("features/course/feedback-authoring/feedback-authoring")],offCanvasArgs:["offCanvasArgs",e=>(e.overlay=!1,e.disableFocusHandling=!0,e)],currentCourseMemberships:"^courseMembershipsLoader",discussionInit:[d.c,"currentCourseMemberships",(e,t)=>e.init(t)]},onExit:[d.c,e=>{e.destroy()}],pageTitle:"course.engagement.grade.feedback.viewFeedbackTitle"}).peekState("discussions-settings",{url:"/discussions-settings",require:()=>n.e(711).then(n.bind(null,"ouab"))})}])},g66W:function(e,t,n){"use strict";function a(e,t,n){return n=n||"...",(e=e.trim()).length>t&&(e=e.slice(0,t)+n),e}function i(e,t,n){e=e.trim(),n=n||"...";const a=new RegExp(`^(.{0,${t}})\\b.*$`),i=e.trim().replace(a,"$1");return e.length>t?i+n:i}function r(e,t,n){return n=n||"",e?e.replace(t,n):""}function s(e,t){return e&&t&&e.substring(e.length-t.length,e.length)===t||!1}function o(e,t){return 0===(e||"").indexOf(t)}n.d(t,"e",(function(){return a})),n.d(t,"f",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return s})),n.d(t,"i",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return d})),n.d(t,"g",(function(){return u})),n.d(t,"h",(function(){return m}));const l=document.createElement("textarea");function c(e){return l.innerHTML=e,l.value}function d(e){return null==e?e:e.replace(/&gt;/g,">").replace(/&lt;/g,"<")}function u(e){return null!=e.match(/[\u3000-\u303f\u3040-\u309f\u30a0-\u30ff\uff00-\uff9f\u4e00-\u9faf\u3400-\u4dbf\uac00-\ud7af]/)}function m(e){return null!=e.match(/[\-\s]/)}},g7Mf:function(e,t,n){"use strict";n.d(t,"b",(function(){return I})),n.d(t,"c",(function(){return k})),n.d(t,"a",(function(){return w}));var a=n("D57K"),i=n("nsO7"),r=n("Llzl"),s=n("Sa5G"),o=n("pjml"),l=n("0JpG"),c=n("oVrE"),d=n("5MwF"),u=n("nYZ0"),m=n("Fvsw"),p=n("Qbdf"),h=n("X455"),g=n("fYJU"),b=n("TnpK"),f=n("jhBu"),v=n("Cxi4"),y=(n("SeO5"),n("aHpC")),S=n("ZQFV"),C=n("zGdY"),E=n("RPob");const I="ultra.service.discussion",k="discussionService",w="default";let T=class{constructor(e,t,n,a,i,r,s,o,l,c,d,u,m,p){this.bbLocalize=e,this.$rootScope=t,this.$q=n,this.$modal=a,this.courseModel=i,this.UserModel=r,this.context=s,this.contentService=o,this.ultraState=l,this.entitlementService=c,this.discussionPermission=d,this.contextUser=u,this.courseMembership=m,this.contextCourse=p,this.userCourseRoles={},this.userCourseAvailabilities={},this.canObserveGradebook=!1,this.canViewAssessments=!1,this.canViewGradebook=!1,this.canViewAttempts=!1,this.participantCount="-",this.hasEditPermission=!1,this.hasClassGroup=!1,this.initCount=0,this.$rootScope.$on("discussion-group-content-update",((e,t)=>{this.hardLinkContent&&(this.hardLinkContent.applyGroupSettings(t),this.softLinkContent&&this.softLinkContent.id&&this.softLinkContent.applyGroupSettings(this.hardLinkContent))}))}init(e){const t=this.ultraState.nextParams.contentId;if(this.initCount++,this.initCount>1){if(t===this.currentContentId)return this.$q.when();this.initCount=1,this.destroy(),this.initCount=1}return this.currentContentId=t,this.redirectedFromStream="base.recentActivity"===this.ultraState.getBaseState(),this.reloaded=!this.ultraState.current.name,this.currentCourseId=this.contextCourse.courseId?this.contextCourse.courseId:this.ultraState.nextParams.courseId,this.groupId=this.ultraState.nextParams.disGroupId||"",this.userCourseAvailabilities[c.c()]=!0,this.courseMembershipsFetcher=e||this.courseModel.$new(this.currentCourseId).memberships,this.courseMembershipsFetcher.$resolve({limit:1e4}).$asPromise().then((e=>{e.forEach((e=>{const t=e.role.toString();t in o.w.toBeLocalizedRoleLabels?this.userCourseRoles[e.userId]=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(null),key:o.w.toBeLocalizedRoleLabels[t]}):this.userCourseRoles[e.userId]=t,this.userCourseAvailabilities[e.userId]=e.isAvailable}))})),this.resolveCourse().then((e=>{this.course=e,this.outlineRoot=this.contentService.findRootNode(this.course,o.p.ContentRootNode.ROOT),this.engagementRoot=this.contentService.findRootNode(this.course,o.p.ContentRootNode.INTERACTIVE);const t=this.ultraState.nextParams.columnId;let n;n=t&&t!==o.C.CREATE_COLUMN_ID?this.course.gradebook.columns.$find(t,{expand:"associatedRubrics"}).$asPromise():this.$q.when();let a=this.$q.when();this.ultraState.getBaseState()===d.a.defaultBasePage&&(a=this.courseMembership.load(this.course));const i=this.course.id;return this.$q.all([n,this.entitlementService.hasCourseEntitlement(s.j.ViewAssessment,i),this.discussionPermission.hasEditPermission(i),this.entitlementService.hasCourseEntitlement(S.q.Observe,i),this.entitlementService.hasCourseEntitlement(S.q.ViewGradebookMetaData,i),this.entitlementService.hasCourseEntitlement(S.q.ViewAttempts,i),a])})).then((([e,t,n,a,i,r])=>{e&&(this.column=e),this.canViewAssessments=t,this.hasEditPermission=n,this.canObserveGradebook=a,this.canViewGradebook=i,this.canViewAttempts=r}))}destroy(){this.persistNewDiscussionDefer?this.persistNewDiscussionDefer.promise.then((()=>{this.clearDiscussionOnExit()})):this.clearDiscussionOnExit()}clearDiscussionOnExit(){this.initCount--,this.initCount>0||(this.deleteEmptyDiscussionOnExit(),this.course=void 0,this.userCourseRoles={},this.userCourseAvailabilities={},this.currentContentId=void 0,this.hardLinkContent=void 0,this.softLinkContent=void 0,this.engagementRoot=void 0,this.outlineRoot=void 0,this.canObserveGradebook=void 0,this.canViewAssessments=void 0,this.canViewGradebook=void 0,this.canViewAttempts=void 0,this.currentDiscussion=void 0,this.groupId=void 0,this.currentCourseId=void 0,this.column=void 0,this.assignedGroupsFiltersArray=void 0,this.selectedGroup=void 0,this.participantCount=void 0,this.loadDiscussionP=void 0,this.loadHardContentP=void 0,this.loadSoftContentP=void 0,this.hasEditPermission=void 0,this.hasClassGroup=void 0,this.redirectedFromStream=void 0,this.reloaded=void 0)}loadDiscussion(e,t){return this.loadDiscussionP?this.loadDiscussionP:this.loadDiscussionP=this.loadHardContent().then((()=>this.loadSoftContent())).then((()=>(e&&(i.merge(this.hardLinkContent,e),this.hasGroups()?this.hardLinkContent.assignedGroups.some((e=>this.groupId===e.groupId))||(this.groupId=this.hardLinkContent.assignedGroups[0].groupId):this.groupId=""),this.doLoadDiscussion(t))))}doLoadDiscussion(e=this.forumId){return this.course.forums.$new(e).messages.$fetch().$asPromise().then((e=>{this.currentDiscussion=e.find((e=>!e.groupId))}))}createDiscussion(){const e=this.ultraState.params,t=this.ultraState.includes("**.course.outline.**")?void 0:e.parentId;return this.loadDiscussionP=this.$q.all([this.buildDiscussion(),this.contentService.makeContentInContentTree(this.engagementRoot,this.contextCourse.courseId,t,e.positionBefore,e.positionAfter)]).then((([e,t])=>{this.currentDiscussion=e,this.hardLinkContent=t.content,this.hardLinkContent.contentHandler=o.p.ContentHandler.Discussion,this.hardLinkContent.visibility=this.contentService.determineVisibility(this.hardLinkContent.isAvailable),this.hardLinkContent.isAvailable=this.currentDiscussion.isAvailable}))}newDiscussionPersist(e){const t=[{tag:"table",replacementText:this.bbLocalize.translateSync({key:"course.content.tablePlaceholder",locale:this.bbLocalize.getLocale(this.$rootScope)})},{tag:"math",replacementText:this.bbLocalize.translateSync({key:"course.content.mathPlaceholder",locale:this.bbLocalize.getLocale(this.$rootScope)}),replacementTextPlural:this.bbLocalize.translateSync({key:"course.content.mathPlaceholder.plural",locale:this.bbLocalize.getLocale(this.$rootScope)})}],n=Object(E.l)(this.currentDiscussion.body.rawText,t),a=this.contentService.truncateDescription(n,u.c.MAX_LENGTH_IN_CONTENT_ITEM);return this.currentDiscussion.plaintextDescription=a,this.currentDiscussion.$patch(["body","plaintextDescription"]).$asPromise().then((()=>this.doLoadDiscussion(e))).then((()=>{this.hardLinkContent.description=a,this.softLinkContent&&(this.softLinkContent.description=a)}))}loadHardContent(e=!1){if(this.loadHardContentP)return this.loadHardContentP;const t=(e?"":"alignedGoals,")+"assignedGroups.group,selfEnrollmentGroups.group";return this.loadHardContentP=this.course.contents.$find(this.currentContentId,{expand:t}).$asPromise().then((e=>this.hardLinkContent=e))}loadSoftContent(){return this.hardLinkContent?this.loadSoftContentP?this.softLinkContent?this.$q.when(this.softLinkContent):this.loadSoftContentP:this.loadSoftContentP=this.hardLinkContent.getSoftLinks({label:"ROOT"}).$asPromise().then((e=>{if(e.length)return this.contentService.getOrMakeContentInContentTree(this.outlineRoot,this.course.id,e[0].courseContent).then((e=>this.softLinkContent=e.content))})):this.$q.when()}async persistNew(){try{this.persistNewDiscussionDefer=this.$q.defer(),this.updateHardLinkContent(this.currentDiscussion);const e=await this.hardLinkContent.$save().$asPromise();this.currentContentId=e.id,this.currentDiscussion=this.updateDiscussion(this.forumId),await this.currentDiscussion.$save().$asPromise();if(!await this.discussionPermission.canCreateAllContent(this.currentCourseId))return void await this.ultraState.search("contentId",this.currentContentId);let{parentId:t,positionBefore:n,positionAfter:a}=this.ultraState.params;this.ultraState.includes("**.course.engagement.**")&&(t=this.outlineRoot.id,n=null,a=null);const i=await this.contentService.makeSoftLinkContentInContentTree(this.hardLinkContent,this.outlineRoot,this.contextCourse.courseId,t,n,a);i&&(this.softLinkContent=i,this.softLinkContent.title=this.hardLinkContent.title,await this.softLinkContent.$save().$asPromise()),await this.ultraState.search("contentId",this.currentContentId)}finally{this.persistNewDiscussionDefer.resolve()}}get body(){var e,t;return null===(t=null===(e=this.currentDiscussion)||void 0===e?void 0:e.body)||void 0===t?void 0:t.rawText}get discussion(){var e;return this.currentDiscussion&&this.currentDiscussion.ui?null===(e=this.currentDiscussion.ui)||void 0===e?void 0:e.replies:""}deleteEmptyDiscussionOnExit(){var e,t,n;const a=(null===(e=this.softLinkContent)||void 0===e?void 0:e.title)||(null===(t=this.hardLinkContent)||void 0===t?void 0:t.title),i=!this.body&&(!this.discussion||this.discussion&&0===(null===(n=this.discussion)||void 0===n?void 0:n.length)),r=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.$rootScope),key:"components.directives.header.placeholder.x-bb-forumlink",params:{date:this.context.getServerTime()},noWrap:!0});if(i&&r===a){const e=this.ultraState.includes("**.course.outline.**")||this.ultraState.includes("**.engagement.**");this.deleteEmptyDiscussion(e)}}deleteEmptyDiscussion(e){var t,n;this.softLinkContent&&this.softLinkContent.id&&this.$rootScope.$broadcast("deleteContent",this.softLinkContent,!1),(null===(t=this.currentDiscussion)||void 0===t?void 0:t.gradedColumn)&&(null===(n=this.currentDiscussion)||void 0===n?void 0:n.gradedColumn.id)&&this.$rootScope.$broadcast("bb-delete-column",this.currentDiscussion.gradedColumn),this.$rootScope.$broadcast("deleteContent",this.hardLinkContent,e)}expandUsersInParticipants(e,t=!1){if(i.isEmpty(e))return this.$q.when(e);const n=e[0];if(null==n||null==n.userId)return this.$q.when(e);const a=e.map((e=>e.userId));let r;return r=!t||this.contextCourse.usersCache.hit(a)?this.$q.when():this.courseMembershipsFetcher.$fetchIfNotExpanded({limit:1e4,expand:"user"}).$asPromise(),r.then((()=>this.contextCourse.usersCache.fetchUsers(a,this.UserModel,this.$q).then((t=>(e.forEach((e=>{e.data=t.get(e.userId)})),this.$q.when(e))))))}getParticipantCount(e=null){return this.loadHardContent().then((()=>(e||(e=this.forumId),this.course.forums.$new(e).usercounts.$fetch({limit:1e4,offset:0,roleBucket:"TAKING",groupId:this.groupId}).$then((e=>this.expandUsersInParticipants(e))).$asPromise()))).then((e=>{this.participantCount=e.filter((e=>e.topLevelReplyCount+e.secondLevelReplyCount>0)).length}))}queryParticipants(e,t,n="",a=!1){const i={limit:t,q:n,offset:0,groupId:this.hasGroups()&&this.groupId||""};return this.course.forums.$new(e).usercounts.$fetch(i).$asPromise().then((e=>this.expandUsersInParticipants(e,a)))}async queryParticipant(e,t){const n={userIds:[t],offset:0},a=await this.course.forums.$new(e).usercounts.$fetch(n).$asPromise(),i=a.map((e=>e.userId)),r=await this.contextCourse.usersCache.fetchUsers(i,this.UserModel,this.$q);return a.forEach((e=>{e.data=r.get(e.userId),e.data||(e.data=c.b(this.$rootScope,this.bbLocalize))})),this.$q.when(a[0])}isPostFirstSatisfied(e,t=this.forumId){return this.loadHardContent().then((()=>this.course.forums.$new(t).usercounts.$fetch({limit:1e4,offset:0,roleBucket:"TAKING"}).$then((e=>this.expandUsersInParticipants(e))).$asPromise())).then((t=>{const n=t.find((t=>t.data.id===e));return!(!n||!n.topLevelReplyCount)}))}refreshParticipationGrade(){if(!this.hasNoGroups())return this.resolveColumn().then((e=>{e&&(this.column=e,this.column.summary&&this.column.summary.$fetch&&(this.getParticipantCount(),this.column.summary.$fetch({groupId:this.groupId})))}));this.column=void 0}saveContent(){return this.hardLinkContent.$patch().$then((()=>{this.softLinkContent&&this.softLinkContent.id&&(this.softLinkContent.applyAvailabilitySettings(this.hardLinkContent),this.softLinkContent.$patch().$then((()=>{this.$rootScope.$broadcast("content-update",this.softLinkContent)}))),this.$rootScope.$broadcast("content-update",this.hardLinkContent),this.$rootScope.$broadcast("attempt-base-content-update",this.hardLinkContent,this.course.id)})).$asPromise()}savePost(){this.currentDiscussion.plaintextDescription=this.contentService.truncateDescription(this.currentDiscussion.plaintextDescription,u.c.MAX_LENGTH_IN_CONTENT_ITEM),this.hardLinkContent&&(this.hardLinkContent.description=this.currentDiscussion.plaintextDescription,this.hardLinkContent.title=this.currentDiscussion.subject,this.$rootScope.$broadcast("content-update",this.hardLinkContent)),this.softLinkContent&&(this.softLinkContent.description=this.currentDiscussion.plaintextDescription,this.softLinkContent.title=this.currentDiscussion.subject,this.$rootScope.$broadcast("content-update",this.softLinkContent))}loadGroup(e){if(this.hasClassGroup=e,this.assignedGroupsFiltersArray=null,e){const e={name:this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(null),key:"components.directives.conversation.classConversation"}),index:0,groupId:w,extraClass:""};this.assignedGroupsFiltersArray=new Array(e),this.selectedGroup=e}if(this.hasGroups()){let t=!1,n=e?1:0;const a=this.hardLinkContent.assignedGroups.map((a=>{const i={name:!e||this.hasEditPermission?a.groupTitle:this.bbLocalize.translateSync({locale:"",key:"components.directives.conversation.myGroup"}),index:n++,groupId:a.groupId,isInGroupSet:!(!a.group||!a.group.groupSetId)};return this.redirectedFromStream&&!this.reloaded&&this.redirectToNeedGradingGroup(a.groupId,i),this.groupId&&this.groupId===i.groupId&&(this.selectedGroup=i,t=!0),i}));this.assignedGroupsFiltersArray=this.assignedGroupsFiltersArray?this.assignedGroupsFiltersArray.concat(a):a,!t&&this.assignedGroupsFiltersArray.length&&(this.selectedGroup=this.assignedGroupsFiltersArray[0],this.groupId=this.selectedGroup.groupId,e||this.refreshParticipationGrade())}else this.groupId=""}async redirectToNeedGradingGroup(e,t){this.$q.when((async()=>{await this.resolveColumn();const n=await this.column.summary.$fetch({groupId:e}).$asPromise();(null==n?void 0:n.numStudentsNeedsGrading)>0&&(this.groupId=e,this.selectedGroup=t,this.refreshParticipationGrade(),this.$rootScope.$broadcast("group-change",this.groupId))})())}clearGroups(){this.hardLinkContent&&this.contentService.clearContentGroups(this.hardLinkContent,this.course).then((()=>{this.groupId="",this.$rootScope.$broadcast("discussion-group-content-update",this.hardLinkContent),this.$rootScope.$broadcast("load-participants")}))}isGroupDiscussion(){return!!(this.hardLinkContent&&this.hardLinkContent.isGroupContent&&this.hardLinkContent.assignedGroups)}hasGroups(){return this.isGroupDiscussion()&&!!this.hardLinkContent.assignedGroups.length}hasNoGroups(){return this.isGroupDiscussion()&&!this.hardLinkContent.assignedGroups.length}isOpenFromConversation(){return!!this.ultraState.current.url&&this.ultraState.current.url.indexOf("conversations")>0}get forumId(){return this.contentService.parseForumId(this.hardLinkContent.contentDetailUrl)}get alignedGoalsCount(){return this.hardLinkContent&&this.hardLinkContent.alignedGoals?this.hardLinkContent.alignedGoals.length:0}updateHardLinkContent(e){this.hardLinkContent.title=e.subject,this.hardLinkContent.description=this.contentService.truncateDescription(e.plaintextDescription,u.c.MAX_LENGTH_IN_CONTENT_ITEM),this.hardLinkContent.visibility=this.contentService.determineVisibility(this.hardLinkContent.isAvailable),this.hardLinkContent.contentDetail={"resource/x-bb-forumlink":{title:e.subject}}}buildDiscussion(){return this.engagementRoot.$asPromise().then((()=>{let e=!1;this.contentService.canOnlyCreateDiscussion(this.engagementRoot)&&(e=!0);const t=this.contextUser.userModel;return this.course.forums.$new().messages.$build({courseId:this.contextCourse.courseId,userId:t.id,postedName:t.userName,subject:this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(null),key:"course.content.discussionTitlePlaceholder"}),body:{rawText:"",displayText:""},isDeleted:!1,isAvailable:e})}))}stopActivityAfterDueDate(){var e,t,n,a,i;const r=this.context.getServerTime(),s=this.isGroupDiscussion()&&(null===(e=this.hardLinkContent)||void 0===e?void 0:e.dueDateExceptionType)===C.D.Unlimited,o=!this.isGroupDiscussion()&&this.courseMembership.isDueDateExcepted();return this.courseMembership.isStudentMembership()&&!s&&!o&&(null===(n=null===(t=this.currentDiscussion)||void 0===t?void 0:t.gradedColumn)||void 0===n?void 0:n.enforceDueDate)&&r>(null===(i=null===(a=this.currentDiscussion)||void 0===a?void 0:a.gradedColumn)||void 0===i?void 0:i.dueDate)}updateDiscussion(e){const t=this.context.getServerTime();return this.course.forums.$new(e).messages.$build({subject:this.currentDiscussion.subject,id:null,forumId:e,parentId:"{unset id}",courseId:this.currentDiscussion.courseId,userId:this.currentDiscussion.userId,postedName:this.currentDiscussion.postedName,body:this.currentDiscussion.body,isDeleted:!1,postDate:t,editDate:t,isAvailable:this.currentDiscussion.isAvailable})}resolveCourse(){return this.contextCourse.course?this.contextCourse.course.$asPromise():this.courseModel.$find(this.currentCourseId).$asPromise()}refetchColumn(){return this.column?this.column.$fetch({expand:"associatedRubrics"}).$asPromise():this.resolveColumn()}hasViewGradebookColumnPermission(){return this.canViewGradebook||this.canViewAttempts||this.canViewAssessments||this.canObserveGradebook}resolveColumn(){return this.column?this.column.$asPromise():this.loadDiscussion().then((()=>{if(this.currentDiscussion.gradedColumn)return this.hasViewGradebookColumnPermission()?this.course.gradebook.columns.$new(this.currentDiscussion.gradedColumn.id).$fetch({expand:"associatedRubrics"}).$asPromise():this.$q.when(this.currentDiscussion.gradedColumn)}))}get isGradedDiscussion(){return this.currentDiscussion&&this.currentDiscussion.allowGrading}set groupId(e){const t=this._groupId;r.isArray(e)?this._groupId=e[0]:this._groupId=e,this._groupId&&this._groupId!==t&&(this.hasClassGroup?this.ultraState.search("groupId",this._groupId):this.ultraState.search("disGroupId",this._groupId))}get groupId(){return this._groupId===w?"":this._groupId}};T=Object(a.a)([Object(a.c)(0,Object(y.b)(l.serviceName)),Object(a.c)(1,Object(y.b)("$rootScope")),Object(a.c)(2,Object(y.b)("$q")),Object(a.c)(3,Object(y.b)("$modal")),Object(a.c)(4,Object(y.b)(o.m.serviceName)),Object(a.c)(5,Object(y.b)(o.Jb.serviceName)),Object(a.c)(6,Object(y.b)(m.b)),Object(a.c)(7,Object(y.b)(u.f)),Object(a.c)(8,Object(y.b)(b.d)),Object(a.c)(9,Object(y.b)(f.b)),Object(a.c)(10,Object(y.b)(v.b)),Object(a.c)(11,Object(y.b)(g.b)),Object(a.c)(12,Object(y.b)(h.d)),Object(a.c)(13,Object(y.b)(p.e))],T);r.module(I,[o.N,l.moduleName,m.a,u.d,b.b,f.a,v.a,o.N]).service(k,T)},gCXj:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d}));var a=n("Llzl"),i=n("nsO7"),r=n("5Dl8"),s=n("TnpK"),o=n("w9Zy"),l=n("pjml");const c="ultra.course.coursemembershipmarkups",d="ultra.course.coursemembershipmarkups.service",u="bbCourseMembershipMarkups";a.module(c,[l.N,s.b,o.d]).run([o.e,s.d,l.t.serviceName,"$rootScope",function(e,t,n,a){a.$on(o.c,(()=>{t.params.courseId&&e.getTopElement().then((e=>{e.getElement().addClass("cc"+t.params.courseId)}))})),n.$mixHook("after-fetch-many",(function(){const e=(/courses\/(_\d+_\d+)/.exec(this.$url())||[])[1];e&&a.$broadcast(`course-${e}-memberships-after-fetch`,Array.prototype.slice.apply(this))}))}]).provider(d,class{constructor(){this.fn=[]}onStyleRefresh(e){this.fn.push(e)}$get(){return this}}).directive(u,[d,function(e){return{restrict:"A",scope:!1,link(t,n,s){const o=s[u],l=`css_course_${o}_membership`,c={},d=i.once((()=>{let e=a.element(document).find(`#${l}`);return 0===e.length&&(e=a.element(`<style id="${l}"></style>`).appendTo("head"),t.$on("$destroy",(()=>{e.remove()}))),e}));t.$root.$on(`course-${o}-memberships-after-fetch`,((t,n)=>{t.preventDefault();const a=d();(n=i(n).filter((e=>null!=(e.userId||e.user.id))).map((e=>(e.userId=e.userId||e.user.id,e))).value()).forEach((t=>{const n=new r.a,a=n.selector(`.cc${o}`);e.fn.forEach((e=>{e(a,t)})),c[t.id]=n.build()}));const s=i(c).sortBy().map(((e,t)=>e)).join("\n");s!==a.text()&&a.text(s)})),t.$on(`course-${o}-memberships-before-fetch`,((e,t)=>{e.preventDefault();const n=t.params||{};n.fields&&(n.fields+=",courseId,dueDateExceptionType,timeLimitExceptionType")}))}}}])},gOJg:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));n("JzsJ");var a=n("Llzl"),i=n("0JpG"),r=n("Qbdf"),s=n("TnpK"),o=n("nmzr");const l="ultra.course.contentCreate.routes";a.module(l,[i.moduleName,r.b,s.b]).config([s.c,r.c,(e,t)=>{e.peekState("content-manage.create.document",{panelClass:"full",resolve:{translations:[i.serviceName,e=>e.loadBundle("features/course/content/course-content")],[r.d]:t.resolve},reloadOnSearch:!1,peekViewName:"document-peek@",url:"/document",require:()=>Promise.all([n.e(35),n.e(0),n.e(1),n.e(2),n.e(6),n.e(7),n.e(19),n.e(89),n.e(143)]).then(n.bind(null,"HjlN")),peekStates:[o.k.DOCUMENT,"document-settings","conversations","edit-file-settings",o.n.COURSE_MESSAGE,o.C.LTI,o.i.CONTENT_MARKET,o.h.CONTENT_COLLECTION,o.k.CONDITIONAL_RELEASE_PEEK_PANEL,o.h.CONTENT_COLLECTION_PICKER],pageTitle:"course.content.document.title"}).peekState(o.k.DOCUMENT,{panelClass:"full",resolve:{translations:[i.serviceName,e=>e.loadBundle("features/course/content/course-content")],[r.d]:t.resolve},peekViewName:"document-peek@",url:"/document/:id?courseId&view",require:()=>Promise.all([n.e(35),n.e(0),n.e(1),n.e(2),n.e(6),n.e(7),n.e(19),n.e(89),n.e(143)]).then(n.bind(null,"HjlN")),peekStates:["document-settings","conversations","edit-file-settings",o.n.COURSE_MESSAGE,o.C.LTI,o.i.CONTENT_MARKET,o.k.CONDITIONAL_RELEASE_PEEK_PANEL,o.h.CONTENT_COLLECTION_PICKER,o.n.COURSE_GRADES_VIEW_INDIVIDUAL_GRADES],pageTitle:"course.content.document.title"}).peekState("document-settings",{resolve:{translations:["$q",i.serviceName,(e,t)=>e.all([t.loadBundle("features/course/content/course-content"),t.loadBundle("features/course/goal-alignment/goal")])]},url:"/document-settings/:id",params:{focusEleId:null},require:()=>Promise.all([n.e(0),n.e(1),n.e(2),n.e(5),n.e(19),n.e(598)]).then(n.bind(null,"Ynio")),peekViewName:"document-settings-peek",allowChildPeekStates:!0,peekStates:[o.v.ADD_GOALS],pageTitle:"course.content.document.settings.header"}),e.peekState("content-manage",{abstract:!0,peekStates:["gradebook-item"]}).peekState(o.k.CREATE_CONTENT_PEEK_PANEL,{url:"/create?parentId&positionBefore&positionAfter&id",resolve:{translations:[i.serviceName,e=>e.loadBundle("features/course/content/course-content")]},peekStates:["discussion","gradebook-item",o.A.JOURNAL],require:[()=>Promise.all([n.e(19),n.e(683)]).then(n.bind(null,"a0Ud")),()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(20),n.e(19),n.e(21),n.e(23),n.e(29),n.e(26),n.e(25),n.e(27),n.e(28),n.e(24),n.e(30)]).then(n.bind(null,"5lIA"))],pageTitle:"course.content.createItem"}).peekState("content-manage.create.folder",{resolve:{translations:[i.serviceName,e=>e.loadBundle("features/course/content/course-content")]},url:"/folder",require:[()=>Promise.all([n.e(19),n.e(176)]).then(n.bind(null,"1wJd")),()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(20),n.e(19),n.e(21),n.e(23),n.e(29),n.e(26),n.e(25),n.e(27),n.e(28),n.e(24),n.e(30)]).then(n.bind(null,"5lIA"))],pageTitle:"course.content.createFolder"}).peekState(o.k.CREATE_LEARNING_MODULE_PEEK_PANEL,{resolve:{translations:[i.serviceName,e=>e.loadBundle("features/course/content/course-content")]},url:"/learning-modules",require:[()=>Promise.all([n.e(19),n.e(172)]).then(n.bind(null,"Yvtv")),()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(20),n.e(19),n.e(21),n.e(23),n.e(29),n.e(26),n.e(25),n.e(27),n.e(28),n.e(24),n.e(30)]).then(n.bind(null,"5lIA"))],pageTitle:"course.content.createLearningModule"}).peekState("content-manage.create.link",{panelClass:"full",resolve:{translations:["$q",i.serviceName,(e,t)=>e.all([t.loadBundle("features/course/content/course-content"),t.loadBundle("features/course/goal-alignment/goal")])]},url:"/link",require:[()=>Promise.all([n.e(19),n.e(25),n.e(100)]).then(n.bind(null,"KYun")),()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(20),n.e(19),n.e(21),n.e(23),n.e(29),n.e(26),n.e(25),n.e(27),n.e(28),n.e(24),n.e(30)]).then(n.bind(null,"5lIA"))],peekViewName:"link-goal-peek",allowChildPeekStates:!0,peekStates:[o.v.ADD_GOALS],pageTitle:"course.content.createLink"}).peekState("content-manage.create.link.legacyVersion",{panelClass:"peek",resolve:{translations:["$q",i.serviceName,(e,t)=>e.all([t.loadBundle("features/course/content/course-content"),t.loadBundle("features/course/goal-alignment/goal")])]},url:"/link",require:[()=>Promise.all([n.e(19),n.e(25),n.e(100)]).then(n.bind(null,"KYun")),()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(20),n.e(19),n.e(21),n.e(23),n.e(29),n.e(26),n.e(25),n.e(27),n.e(28),n.e(24),n.e(30)]).then(n.bind(null,"5lIA"))],peekViewName:"link-goal-peek",allowChildPeekStates:!0,peekStates:[o.v.ADD_GOALS],pageTitle:"course.content.createLink"}).peekState("content-manage.create.lti",{resolve:{translations:["$q",i.serviceName,(e,t)=>e.all([t.loadBundle("features/course/content/course-content"),t.loadBundle("features/course/goal-alignment/goal")])]},url:"/lti",require:[()=>Promise.all([n.e(19),n.e(28),n.e(179)]).then(n.bind(null,"7OXB")),()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(20),n.e(19),n.e(21),n.e(23),n.e(29),n.e(26),n.e(25),n.e(27),n.e(28),n.e(24),n.e(30)]).then(n.bind(null,"5lIA"))],peekViewName:"lti-goal-peek",allowChildPeekStates:!0,peekStates:[o.v.ADD_GOALS],pageTitle:"course.content.createLti"}).peekState("content-manage.create.file",{resolve:{translations:[i.serviceName,e=>e.loadBundle("features/course/content/course-content")]},url:"/file",require:[()=>Promise.all([n.e(19),n.e(24),n.e(99)]).then(n.bind(null,"ebp7")),()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(20),n.e(19),n.e(21),n.e(23),n.e(29),n.e(26),n.e(25),n.e(27),n.e(28),n.e(24),n.e(30)]).then(n.bind(null,"5lIA"))],pageTitle:"course.content.fileTitlePlaceholder"}).peekState("content-manage.edit",{abstract:!0,resolve:{translations:[i.serviceName,e=>e.loadBundle("features/course/goal-alignment/goal")]},url:"/edit"}).peekState("content-manage.edit.folder",{resolve:{translations:[i.serviceName,e=>e.loadBundle("features/course/content/course-content")]},url:"/folder/:id?focusEleId",require:[()=>Promise.all([n.e(19),n.e(176)]).then(n.bind(null,"1wJd")),()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(20),n.e(19),n.e(21),n.e(23),n.e(29),n.e(26),n.e(25),n.e(27),n.e(28),n.e(24),n.e(30)]).then(n.bind(null,"5lIA"))],peekStates:[o.k.CONDITIONAL_RELEASE_PEEK_PANEL],allowChildPeekStates:!0,pageTitle:"course.content.editFolder"}).peekState(o.k.EDIT_LEARNING_MODULE_PEEK_PANEL,{resolve:{translations:[i.serviceName,e=>e.loadBundle("features/course/content/course-content")]},url:"/learning-modules/:id?focusEleId",require:[()=>Promise.all([n.e(19),n.e(172)]).then(n.bind(null,"Yvtv")),()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(20),n.e(19),n.e(21),n.e(23),n.e(29),n.e(26),n.e(25),n.e(27),n.e(28),n.e(24),n.e(30)]).then(n.bind(null,"5lIA"))],peekStates:[o.k.CONDITIONAL_RELEASE_PEEK_PANEL],allowChildPeekStates:!0,pageTitle:"course.content.editLearningModule"}).peekState("content-manage.edit.file",{resolve:{translations:[i.serviceName,e=>e.loadBundle("features/course/content/course-content")]},url:"/file/:id?focusEleId",require:[()=>Promise.all([n.e(19),n.e(24),n.e(99)]).then(n.bind(null,"ebp7")),()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(20),n.e(19),n.e(21),n.e(23),n.e(29),n.e(26),n.e(25),n.e(27),n.e(28),n.e(24),n.e(30)]).then(n.bind(null,"5lIA"))],peekViewName:"file-goal-peek",allowChildPeekStates:!0,peekStates:[o.v.ADD_GOALS,o.k.CONDITIONAL_RELEASE_PEEK_PANEL],pageTitle:"course.content.file"}).peekState("content-manage.edit.link",{resolve:{translations:["$q",i.serviceName,(e,t)=>e.all([t.loadBundle("features/course/content/course-content"),t.loadBundle("features/course/goal-alignment/goal")])]},url:"/link/:id?focusEleId",require:[()=>Promise.all([n.e(19),n.e(25),n.e(100)]).then(n.bind(null,"KYun")),()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(20),n.e(19),n.e(21),n.e(23),n.e(29),n.e(26),n.e(25),n.e(27),n.e(28),n.e(24),n.e(30)]).then(n.bind(null,"5lIA"))],peekViewName:"link-goal-peek",allowChildPeekStates:!0,peekStates:[o.v.ADD_GOALS,o.k.CONDITIONAL_RELEASE_PEEK_PANEL],pageTitle:"course.content.editLink"}).peekState("content-manage.edit.lti",{resolve:{translations:["$q",i.serviceName,(e,t)=>e.all([t.loadBundle("features/course/content/course-content"),t.loadBundle("features/course/goal-alignment/goal")])]},url:"/lti/:id?focusEleId",require:[()=>Promise.all([n.e(19),n.e(28),n.e(179)]).then(n.bind(null,"7OXB")),()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(20),n.e(19),n.e(21),n.e(23),n.e(29),n.e(26),n.e(25),n.e(27),n.e(28),n.e(24),n.e(30)]).then(n.bind(null,"5lIA"))],peekViewName:"lti-goal-peek",allowChildPeekStates:!0,peekStates:[o.v.ADD_GOALS,o.k.CONDITIONAL_RELEASE_PEEK_PANEL],pageTitle:"course.content.editLti"}).peekState("content-manage.edit.placement",{resolve:{translations:["$q",i.serviceName,(e,t)=>e.all([t.loadBundle("features/course/content/course-content"),t.loadBundle("features/course/goal-alignment/goal")])]},url:"/placement/:id",require:[()=>Promise.all([n.e(19),n.e(664)]).then(n.bind(null,"1xSQ")),()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(20),n.e(19),n.e(21),n.e(23),n.e(29),n.e(26),n.e(25),n.e(27),n.e(28),n.e(24),n.e(30)]).then(n.bind(null,"5lIA"))],peekViewName:"placement-goal-peek",peekStates:[o.v.ADD_GOALS,o.k.CONDITIONAL_RELEASE_PEEK_PANEL],allowChildPeekStates:!0,pageTitle:"course.content.editPlacement"}).peekState("content-manage.import",{resolve:{translations:["$q",i.serviceName,(e,t)=>e.all([t.loadBundle("features/course/content/import/content-import"),t.loadBundle("features/course/content/course-content")])]},url:"/import?parentId&targetCourseId&positionBefore&positionAfter",require:[()=>Promise.all([n.e(6),n.e(632)]).then(n.bind(null,"dTsQ")),()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(20),n.e(19),n.e(21),n.e(23),n.e(29),n.e(26),n.e(25),n.e(27),n.e(28),n.e(24),n.e(30)]).then(n.bind(null,"5lIA"))],pageTitle:"course.content.import.title"}).peekState(o.k.COPY_CONTENT_PEEK_PANEL,{resolve:{translations:["$q",i.serviceName,(e,t)=>e.all([t.loadBundle("features/course/content/copy/content-copy"),t.loadBundle("features/course/content/course-content")])]},url:"/copy?parentId&targetCourseId&positionBefore&positionAfter",require:[()=>n.e(29).then(n.bind(null,"9fW2")),()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(20),n.e(19),n.e(21),n.e(23),n.e(29),n.e(26),n.e(25),n.e(27),n.e(28),n.e(24),n.e(30)]).then(n.bind(null,"5lIA"))],pageTitle:"course.content.copy.title",panelClass:"full"}).peekState(o.k.IMPORT_REPORT_PEEK_PANEL,{resolve:{translations:[i.serviceName,e=>e.loadBundle("components/directives/convert-and-import")]},url:"/importReport/:id",require:()=>Promise.all([n.e(71),n.e(721)]).then(n.bind(null,"O9bg")),pageTitle:"ultra.convert.analysis.importDetailsTitle"}).peekState(o.k.COPY_REPORT_PEEK_PANEL,{resolve:{translations:[i.serviceName,e=>e.loadBundle("components/directives/convert-and-import")]},url:"/copyReport/:id",require:()=>Promise.all([n.e(71),n.e(175)]).then(n.bind(null,"EdNC")),pageTitle:"ultra.convert.analysis.copyDetailsTitle"}).peekState(o.k.COPY_DETAILS_PEEK_PANEL,{resolve:{translations:[i.serviceName,e=>e.loadBundle("components/directives/convert-and-import")]},url:"/copyDetails",require:()=>Promise.all([n.e(71),n.e(175)]).then(n.bind(null,"EdNC")),pageTitle:"ultra.convert.analysis.copyDetailsTitle"}).peekState(o.k.GENERIC_STUDENT_PROGRES_PEEK_PANEL,{panelClass:"full",resolve:{translations:[i.serviceName,e=>e.loadBundle("features/course/content/course-content")]},url:"/progress/:id",require:()=>Promise.all([n.e(1),n.e(2),n.e(19),n.e(677)]).then(n.bind(null,"9u8j")),pageTitle:"course.content.progress.pageTitle",peekStates:[o.n.COURSE_MESSAGE,o.n.COURSE_GRADES_VIEW_INDIVIDUAL_GRADES],allowChildPeekStates:!0,peekViewName:"progress-peek@"})}])},gZo5:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var a=n("Llzl");const i="ultra.services.messaging",r="crossWindowMessaging";class s{constructor(e){this.$rootScope=e,this.broadcastChannel=new BroadcastChannel("ultra.crossWindowMessagingService"),this.onMessage=this._onMessage.bind(this),this.broadcastChannel.addEventListener("message",this.onMessage),e.$on("$destroy",(()=>{this.broadcastChannel.close(),this.broadcastChannel.removeEventListener("message",this.onMessage)}))}_onMessage({data:e}){this.$rootScope.$broadcast(e.type,e.message)}postMessage(e,t){this.broadcastChannel.postMessage({type:e,message:t})}}s.$inject=["$rootScope"];a.module(i,[]).service(r,s)},gkef:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return o}));var a=n("Llzl"),i=n("nsO7"),r=n("en1n");const s="ultra.services.windowSize",o="windowSizeService";class l{constructor(t){this.$rootScope=t,this.hasQueuedRefreshWindowSizeEm=!1,this.currentWindowSizeEm=e(window).width()/parseFloat(e("html").css("font-size"));const n=Object(i.throttle)((()=>{const t=window.innerWidth/parseFloat(e("html").css("font-size"));t!==this.currentWindowSizeEm&&this.$rootScope.$apply((()=>{this.currentWindowSizeEm=t,this.$rootScope.$broadcast("window-resize",this.currentWindowSizeEm)}))}),100);window.addEventListener("resize",n)}isSmallBreakpoint(){return this.currentWindowSizeEm<=r.d}isMediumBreakpoint(){return this.currentWindowSizeEm>r.d&&this.currentWindowSizeEm<=r.b}isLargeBreakpoint(){return this.currentWindowSizeEm>r.b}getBreakpointSize(){return this.currentWindowSizeEm<=r.d?"small":this.currentWindowSizeEm<=r.b?"medium":"large"}isWindowSizeAtLeast(e){return this.currentWindowSizeEm>=e}}l.$inject=["$rootScope"];a.module(s,[]).service(o,l)}).call(this,n("71td"))},go4a:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return o}));const a="course-color-",i=(e,t,n)=>{const a=t?"structure":"nature",i=((e=0)=>(void 0===e&&(e=0),e%20+1))(e);return`static/images/default-banners/${a}${i}${n?"_thumb":""}.jpg`},r=e=>{return e.course&&e.course.isClassic()?"course-color-classic":a+(void 0===(t=e.courseCardColorIndex)&&(t=0),t%10+1);var t},s=(e,t)=>i(e,t,!1),o=(e,t)=>i(e,t,!0)},gqzd:function(e,t,n){"use strict";var a=n("ERkP"),i=n.n(a),r=n("7nmT"),s=n("uDfI"),o=n("4JTD"),l=n("nbDY"),c=n.n(l);class d extends c.a{}d.VIEW=new d("view"),d.CREATE=new d("create"),d.EDIT=new d("edit"),d.EXPORT=new d("export"),d.DELETE=new d("delete");var u=n("nsO7"),m=n("x6OE"),p=n.n(m),h=n("SToD"),g=n("myse"),b=n("np6O"),f=n("8jBL"),v=n("0x+l"),y=n("nmzr"),S=n("9OUN"),C=n("fXuP"),E=n("IbyE"),I=n("MC1S"),k=n("WBPx"),w=n("caKH"),T=n("YK4x"),O=n("EZIA"),A=n("M2M2"),P=n("7O4Y");const x=e=>{const{group:t,analyticsId:n}=e,i=Object(y.cb)(Object(y.U)({groupId:t.id})),r=Object(T.a)();return a.createElement("div",{className:"show-members-link"},a.createElement(O.a,{analyticsId:`${n}.group.showMembers.link`,"aria-label":r("course.groupWorkspace.selfEnroll.showMembersLinkAriaLabel",{groupName:t.title}),href:i},r("course.groupWorkspace.selfEnroll.showMembers")))};var $=e=>{const{data:t,ariaLabelledBy:n,expand:i,courseMemberCount:r,isNew:s,analyticsId:o}=e,l=Object(T.a)();if(!t.length)return null;const c=t.map(((e,c)=>{var d,u;const m=null!==(d=e.studentCount)&&void 0!==d?d:0,p=null!==(u=e.maximumEnrollment||r)&&void 0!==u?u:0,h=Object(P.a)("item-row","sub-row",{expand:i},{"last-group":c===t.length-1},{"first-group":0===c},{isNew:s});return a.createElement("tr",{id:Object(A.c)(e.id),role:"row",key:e.id,className:h},a.createElement("td",{role:"gridcell",className:"sub-column first-column header-column group-cell","aria-labelledby":`${n} col-name`,tabIndex:-1},a.createElement("div",{className:"group-workspace-sub-header group-workspace-header group-cell-content"},a.createElement("div",{className:"icon"},a.createElement(f.Groups,{className:"element-image"})),a.createElement("div",{className:"sub-name click-message-detail"},a.createElement("div",{className:"title-detail-row"},a.createElement("span",{id:`span-cell-${e.id}`,className:"list-item-title","aria-describedby":`${n} col-name`},e.title)),m>0&&a.createElement(x,{group:e,analyticsId:o}),a.createElement("div",{className:"group-member-count"},a.createElement("span",{className:"list-item-member-count"},l("course.groupWorkspace.courseGroup.max",{groupCount:m,groupTotal:p})))))),a.createElement("td",{role:"gridcell",className:"sub-column other-column count-column group-cell",tabIndex:-1,"aria-labelledby":"col-count",colSpan:2},a.createElement("div",{className:"group-member-count group-cell-content"},a.createElement("span",{className:"list-item-member-count"},l("course.groupWorkspace.courseGroup.max",{groupCount:m,groupTotal:p})))),a.createElement("td",{role:"gridcell",className:"sub-column other-column controls-column group-cell"}))}));return a.createElement(a.Fragment,null,c)},N=n("D7Uk"),D=n("tN4z"),L=n("GuFu"),j=n("Agfx");const M=Object(j.makeStyles)((e=>Object(j.createStyles)({textField:{[e.breakpoints.up("sm")]:{width:250},[e.breakpoints.down("xs")]:{border:"none"}},selectedLabel:{[e.breakpoints.down("xs")]:{display:"none"}},icon:{display:"inline-flex",verticalAlign:"middle",marginRight:10},customIcon:{},overallContainer:{display:"inline-flex",width:"auto",[e.breakpoints.up("sm")]:{width:250}},inputDisabled:{backgroundColor:e.palette.background.default,color:e.palette.text.hint},selectDisabled:{visibility:"hidden"},disabledInformationButton:{marginTop:"-5px !important",[e.breakpoints.down("xs")]:{marginLeft:"-20px !important"}},alignDropdown:{marginLeft:"-10px"}}))),G=Object(j.makeStyles)((e=>Object(j.createStyles)({textField:{border:"none","&:hover $customIcon":{color:e.palette.action.hover}},selectedLabel:{display:"inline",fontSize:e.typography.fontSizeDefault},icon:{display:"inline-flex",verticalAlign:"middle",marginRight:9,width:14},customIcon:{color:e.palette.background.default},overallContainer:{display:"inline-flex"},disabledInformationButton:{marginLeft:"-20px",marginTop:"-5px"},inputDisabled:{backgroundColor:e.palette.background.default,color:e.palette.text.hint},selectDisabled:{visibility:"hidden"},alignDropdown:{marginLeft:"-10px"}})));var R;!function(e){e.HAS_ASSOCIATED_CONTENT="hasAssociatedContent",e.SELF_ENROLLMENT_ALLOWED="selfEnrollmentAllowed"}(R||(R={}));const B=Object(h.a)((e=>{var t;const{localize:n,groupSetVisibility:i,onVisibilityChanged:r,analyticsId:s,variant:o="large",disabled:l=!1,disabledReason:c,inListItem:d=!1}=e,u=Object(L.h)("course.groupWorkspace","organization.groupWorkspace"),m=Object(a.useCallback)((e=>{r("visible"===e.target.value)}),[r]),p=M(),h=G(),g="small"===o?h:p,b=["visible","hidden"],f={visible:n.translate(u("course.groupWorkspace.groupVisibility.visible")),hidden:n.translate(u("course.groupWorkspace.groupVisibility.hidden"))},y={[R.HAS_ASSOCIATED_CONTENT]:n.translate(u("course.groupWorkspace.groupVisibility.disabledMessage.hasAssociatedContent")),[R.SELF_ENROLLMENT_ALLOWED]:n.translate(u("course.groupWorkspace.groupVisibility.disabledMessage.selfEnrollmentAllowed"))},S=b.map((e=>a.createElement(D.AnalyticsMenuItem,{button:!0,analyticsId:`${s}.${e}`,value:e,key:e},a.createElement("span",{className:g.icon},"visible"===e?a.createElement(v.Visible,null):a.createElement(v.Invisible,null)),a.createElement("span",null,f[e]))));return a.createElement("div",null,a.createElement("div",{className:Object(P.a)(g.overallContainer,{[`${g.alignDropdown}`]:d})},a.createElement(D.AnalyticsTextField,{analyticsId:s,select:!0,fullWidth:!0,disabled:l,value:i?b[0]:b[1],onChange:m,InputProps:{classes:{root:g.textField,disabled:g.inputDisabled}},SelectProps:{renderValue:function(e){return a.createElement(a.Fragment,null,a.createElement("span",{className:g.icon},"visible"===e?a.createElement(v.Visible,null):a.createElement(v.Invisible,null)),a.createElement("span",{className:g.selectedLabel},f[e]))},classes:{icon:Object(P.a)({[`${g.selectDisabled}`]:l},{[`${g.customIcon}`]:!l})}}},S)),l&&a.createElement(D.AnalyticsTooltip,{analyticsId:`${s}.tooltip`,title:null!==(t=y[c])&&void 0!==t?t:""},a.createElement(D.AnalyticsIconButton,{analyticsId:`${s}.informationButton`,"aria-label":n.translate("course.groupWorkspace.groupVisibility.disabledMessage.informationButtonAriaLabel"),className:g.disabledInformationButton},a.createElement(v.Information,null))))}));var F=n("AuQm");const U=Object(h.a)((e=>{var t;const{groupSetId:n,analyticsId:i,localize:r}=e,[o,l]=a.useState(!1),[c,d]=a.useState(void 0),u=Object(s.d)(),m=Object(L.h)("course.groupWorkspace","organization.groupWorkspace"),p=Object(s.e)((e=>E.Yb.app.getRoute(e).params.courseId)),h=Object(s.e)((e=>E.Yb.groupWorkspace.getGroupSetById(e,n))),{enqueueSnackbar:g,dequeueSnackbar:b}=Object(F.mb)(F.S.CourseGroupSetVisibility),f=Object(a.useCallback)((()=>{const e={...h,isAvailable:!1};u(E.V.groupWorkspace.saveGroupSet(p,e)),b()}),[u,h,b,p]),v={snackbarMessage:r.translate(m("course.groupWorkspace.groupVisibility.snackbar.message"))},y={closeButtonAriaLabel:r.translate("course.groupWorkspace.groupVisibility.snackbar.closeButtonAriaLabel"),actionMessage:r.translate("course.groupWorkspace.groupVisibility.snackbar.actionMessage"),onActionClick:f};a.useEffect((()=>{const e=(null==h?void 0:h.hasAssociatedContent)||(null==h?void 0:h.isSelfEnrolledAllowed);l(e),(null==h?void 0:h.hasAssociatedContent)?d(R.HAS_ASSOCIATED_CONTENT):(null==h?void 0:h.isSelfEnrolledAllowed)&&d(R.SELF_ENROLLMENT_ALLOWED)}),[h]);const S=Object(a.useCallback)((e=>{var t;if(h.isAvailable===e||(null===(t=h.api)||void 0===t?void 0:t.isUpdating))return;const n={...h,isAvailable:e};u(E.V.groupWorkspace.saveGroupSet(p,n)),e?g(v,y):b()}),[u,n,p,null==h?void 0:h.isAvailable,null===(t=null==h?void 0:h.api)||void 0===t?void 0:t.isUpdating,g,b]);return a.createElement(B,{groupSetVisibility:null==h?void 0:h.isAvailable,analyticsId:`${i}.groupSetVisibility`,onVisibilityChanged:S,variant:"small",disabled:o,disabledReason:c,inListItem:!0})}));var _=n("TUnR");const z=Object(h.a)((e=>{const{localize:t}=e,n=Object(L.h)("course.groupWorkspace","organization.groupWorkspace");return a.createElement(_.a,{componentKey:"course.groupWorkspace.groupVisibility",announcementTitle:t.translate("course.groupWorkspace.groupVisibility.ftue.title"),content:t.translate(n("course.groupWorkspace.groupVisibility.ftue.content")),buttonAriaLabel:t.translate("course.groupWorkspace.groupVisibility.ftue.buttonAriaLabel"),doneButtonText:t.translate("course.groupWorkspace.groupVisibility.ftue.doneButtonText"),linkHref:t.translate("course.groupWorkspace.groupVisibility.ftue.moreInfoLinkUrl"),linkText:t.translate("course.groupWorkspace.groupVisibility.ftue.moreInfoLinkText"),closeLabel:t.translate("global.close")})}));class q extends a.PureComponent{constructor(e){super(e),this.timerHandler=null,this.getActionOptions=(e,t,n)=>{const i={items:[]};return e&&e.viewGroupMembers&&i.items.push({key:d.EDIT,name:t.translate(e.modify?"course.groupWorkspace.button.edit":"course.groupWorkspace.button.view"),icon:e.modify?a.createElement(v.Edit,null):a.createElement(v.Visible,null),onClick:this.onEditGroupSet}),e&&e.modify&&this.props.rowData.groupCount>0&&i.items.push({key:d.EXPORT,name:t.translate("global.export"),icon:a.createElement(v.Download,null),onClick:this.onExportGroupSet}),e&&e.delete&&i.items.push({key:d.DELETE,name:t.translate("course.groupWorkspace.button.delete"),icon:a.createElement(v.Trash,null),onClick:this.onOpenDeleteConfirmDialog}),i},this.toggleRow=()=>{this.props.onExpand(!this.props.expand)},this.dismissDialog=()=>{const{isMounted:e}=this.state;e&&this.setState({hideDialog:!0})},this.onOpenDeleteConfirmDialog=()=>{this.setState({hideDialog:!1})},this.clickGroupSetTitle=e=>{this.onEditGroupSet(),e.stopPropagation()},this.onEditGroupSet=()=>{const{openGroupSetDetailPanel:e,courseId:t,rowData:n}=this.props;this.actionMenu.focus(),e(t,n.id,d.EDIT)},this.onExportGroupSet=()=>{const{rowData:e}=this.props;y.Z.goPeekState(Object(y.S)({groupSetId:e.id}))},this.onDeleteGroupSet=()=>{const{onDelete:e,courseId:t,rowData:n}=this.props;e(t,n.id).then((()=>{this.dismissDialog()}))},this.renderDialog=e=>{const{localize:t,analyticsId:n}=this.props;return a.createElement(w.c,{analyticsId:`${n}.dialog`,onDismiss:this.dismissDialog,hidden:this.state.hideDialog,modalProps:{isAlert:!0},dialogContentProps:{type:I.DialogType.close,title:t.translate("course.groupWorkspace.dialogText.deleteGroupSet"),subText:t.translate(e?"course.groupWorkspace.dialogText.confirmDeleteEmptyGroupSet":"course.groupWorkspace.dialogText.confirmDeleteGroupSet"),showCloseButton:!1}},a.createElement(I.DialogFooter,null,a.createElement(k.AnalyticsDefaultButton,{analyticsId:`${n}.dialog.cancel.button`,onClick:this.dismissDialog},t.translate("course.groupWorkspace.button.cancel")),a.createElement(k.AnalyticsPrimaryButton,{analyticsId:`${n}.dialog.delete.confirm.button`,onClick:this.onDeleteGroupSet,className:"deleteConfirmBtn"},t.translate("course.groupWorkspace.button.delete"))))},this.registerTimeoutEvent=()=>{const{debounceTime:e,onExpire:t,rowData:n}=this.props;this.timerHandler=setTimeout((()=>{t(n.id)}),e)},this.state={hideDialog:!0,isMounted:!1}}componentDidMount(){this.setState({isMounted:!0}),this.props.isNew&&this.registerTimeoutEvent()}componentDidUpdate(e){this.props.expand&&!this.props.isLoading&&this.props.subRowsCount&&0===this.props.subRowsData.length&&this.props.onLoadSubRowsData(this.props.courseId,this.props.rowData.id,{sort:this.props.sortCriteria}),!e.isNew&&this.props.isNew&&this.registerTimeoutEvent(),e.rowData&&this.props.rowData&&(e.rowData.title===this.props.rowData.title&&e.rowData.studentCount===this.props.rowData.studentCount||this.props.onChangeOffset())}componentWillUnmount(){this.setState({isMounted:!1}),this.setState({hideDialog:!1}),this.timerHandler&&clearTimeout(this.timerHandler)}render(){var e;const{raised:t,expand:n,featuresConfig:i,subRowsData:r,rowData:s,isLoading:o,localize:l,subRowsCount:c,courseMemberCount:d,isOrganization:u,isNew:m,analyticsEventAugmentor:p,analyticsId:h}=this.props,f=null===(e=s.permissions)||void 0===e?void 0:e.viewGroupMembers,y=n?"hide":"show",S=`${this.props.analyticsId}.list.toggleRow.${y}.button`,C=l.translate(`course.groupWorkspace.groupList.${y}`,{groupSet:s.title}),E=Object(P.a)("item-row","expandable",{expand:n},{isNew:m},{raised:t});return a.createElement(a.Fragment,null,a.createElement("tr",{id:`row-${s.id}`,className:E,role:"row"},a.createElement("td",{className:"header-column group-set-cell group-set-first-column",role:"gridcell",tabIndex:-1,"aria-labelledby":"col-name"},a.createElement("div",{className:"group-workspace-header"},a.createElement("div",{className:"icon"},a.createElement(N.a,{color:"primary",className:"element-image"})),a.createElement("div",{className:"click-message-detail"},a.createElement("div",{className:"title-detail"},a.createElement("a",{className:"list-item-title",href:"#",onClick:p(g.AnalyticsEventTypes.CLICK_EVENT,this.clickGroupSetTitle,`${h}.list.itemTitle.link`),"data-analytics-id":`${h}.list.itemTitle.link`,id:`title-${s.id}`},s.title),a.createElement("span",{className:"title-count-separator"},"|"),a.createElement("span",{className:"group-count"},l.translate("course.groupWorkspace.guidance.groupCount.plural",{groupCount:c||0}))),a.createElement("div",{className:"group-set-visibility"},a.createElement(U,{analyticsId:`${h}.itemVisibility`,groupSetId:this.props.groupSet.id}),0===this.props.index&&a.createElement(z,null))))),a.createElement("td",{className:"count-column group-set-cell group-set-other-column",role:"gridcell",tabIndex:-1,"aria-labelledby":"col-count"},a.createElement("div",{className:"member-count"},a.createElement("span",{className:"list-item-student-count"},a.createElement("span",{className:"list-item-member-count"},l.translate("course.groupWorkspace.courseGroup.memberAndStudentCount",{memberCount:d||0,studentCount:s.studentCount||0}))))),a.createElement("td",{className:"controls-column group-set-cell group-set-other-column",role:"grid-cell",tabIndex:-1},a.createElement("div",{className:"menu-and-chevron"},a.createElement(I.ActionMenu,{analyticsId:`${h}.actionMenu`,className:"action-menu",componentRef:e=>{this.actionMenu=e},disabled:!this.state.hideDialog||!f,menuProps:this.getActionOptions(s.permissions,l,i),maintainExpandedProperties:!this.state.hideDialog,ariaLabel:l.translate("course.groupWorkspace.button.title.moreOptionsAx",{rowTitle:s.title})}),this.renderDialog(!c),a.createElement(b.AnalyticsIconButton,{analyticsId:S,"aria-label":C,"aria-expanded":this.props.expand,onClick:this.toggleRow,className:"chevron"},this.props.expand?a.createElement(v.ChevronUp,null):a.createElement(v.ChevronDown,null))))),o?a.createElement("tr",null,a.createElement("td",{colSpan:2,className:"isLoading"},a.createElement(I.Spinner,{size:I.SpinnerSize.large}))):a.createElement($,{data:r,ariaLabelledBy:`title-${s.id}`,expand:this.props.expand,courseMemberCount:d,isNew:m,analyticsId:`${h}.groupContent`}))}}var H=Object(g.withAnalytics)(Object(s.b)(((e,t)=>({index:t.index,courseId:t.courseId,debounceTime:2e3,rowData:t.groupSet,isLoading:E.Yb.groupWorkspace.isLoading(e,t.groupSet.id),isNew:E.Yb.groupWorkspace.isNew(e,t.groupSet.id),subRowsData:E.Yb.group.getGroupsByGroupSetId(e,t.groupSet.id),subRowsCount:E.Yb.groupWorkspace.getGroupsCountByGroupSetId(e,t.groupSet.id),sortCriteria:t.sortCriteria,courseMemberCount:t.courseMemberCount,isOrganization:!!E.Yb.course.getCourseById(e,t.courseId).isOrganization,featuresConfig:t.featuresConfig})),(e=>Object(S.b)({onLoadSubRowsData:E.V.group.loadByGroupSetId,onDelete:E.V.groupWorkspace.removeGroupSet,onExpire:E.V.groupWorkspace.markAsOld},e)))(Object(C.a)(q))),V=n("hQuh"),W=n("zGdY");const K="arrow-up";class Y extends a.PureComponent{constructor(){super(...arguments),this.getArrowDirection=()=>{const{currentSort:e,sortCriteria:t}=this.props;return t&&t.includes(e)?(this.localSort=e,this.isDescendingSort(e)?"arrow-down":K):""},this.updateSortCriteria=()=>{if(!this.props.isLoading){const{sortCriteria:e,onSwitchSortCriteria:t}=this.props;this.localSort?this.localSort=e[0===e.indexOf(this.localSort)?e.length-1:0]:this.localSort=e[0],t(this.localSort)}},this.isDescendingSort=e=>e===W.Vb.STUDENT_COUNT_DESC||e===W.Vb.MODIFIED_DATE_DESC||e===W.Vb.TITLE_DESC}render(){const{t:e,sortCriteria:t,viewText:n,analyticsEventAugmentor:i,analyticsId:r}=this.props,s=`${r}.sortBy.button`;let o="";if(this.getArrowDirection()){o=e(`course.groupWorkspace.sort.${n}.${this.getArrowDirection()===K?"asc":"desc"}`)}return a.createElement(a.Fragment,null,a.createElement("button",{id:`sort-by-${n}-button`,className:"active clear ellipse","aria-describedby":`sort-by-${n}`,onClick:i(g.AnalyticsEventTypes.CLICK_EVENT,this.updateSortCriteria,s),"data-analytics-id":s},e(`course.groupWorkspace.sort.${n}.description`),a.createElement("div",{className:"sort-list-arrows "+this.getArrowDirection(),role:"presentation"},t&&t.length>0&&t.map(((e,t)=>a.createElement("div",{className:this.isDescendingSort(e)?"sort-list-arrow-down":"sort-list-arrow-up",key:t}))))),a.createElement("span",{id:`sort-by-${n}`,className:"sr-only","aria-live":"assertive"},o))}}var J=Object(g.withAnalytics)(Object(V.a)(Y));var Z=e=>{const{imageSrc:t,title:n,caption:i,children:r}=e;return a.createElement("div",{className:"group-empty-state"},a.createElement("img",{src:t,role:"presentation"}),a.createElement("p",{className:"group-empty-state-main"},n),a.createElement("p",{className:"group-empty-state-caption"},i),r)};const Q=e=>{const t=document.activeElement;if("TH"!==t.tagName&&"TD"!==t.tagName)return!0;{const n=document.getElementById("expandGrid").querySelectorAll(".list-item-row.group-set-sort-row, .item-row.expandable, .item-row.sub-row.expand"),a=e.key,i=t.parentElement,r=u.indexOf(n,i),s=u.indexOf(i.cells,t);switch(a){case"ArrowRight":return e.preventDefault(),Object(A.g)(i.cells[s+1]),!1;case"ArrowLeft":return e.preventDefault(),Object(A.g)(i.cells[s-1]),!1;case"ArrowUp":{e.preventDefault();const t=n[r-1];return Object(A.g)(t&&t.cells[s]),!1}case"ArrowDown":{e.preventDefault();const t=n[r+1];return Object(A.g)(t&&t.cells[s]),!1}default:return!0}}};var X=n("50Q+");class ee extends a.PureComponent{constructor(e){super(e),this.offset=0,this.showSuccessBanner=e=>{this.setState({showBanner:"success",bannerMessage:e.message})},this.showErrorBanner=e=>{this.setState({showBanner:"error",bannerMessage:e.message})},this.hideBanner=()=>{var e,t,n,a;"SUCCESS"!==(null===(e=this.props.importGroupSetStatus)||void 0===e?void 0:e.responseStatus)&&"ERROR"!==(null===(t=this.props.importGroupSetStatus)||void 0===t?void 0:t.responseStatus)||this.props.clearImportGroupSetStatus(this.props.courseId),"SUCCESS"!==(null===(n=this.props.exportGroupSetStatus)||void 0===n?void 0:n.responseStatus)&&"ERROR"!==(null===(a=this.props.exportGroupSetStatus)||void 0===a?void 0:a.responseStatus)||this.props.clearExportGroupSetStatus(this.props.courseId),this.setState({showBanner:"none"})},this.openImportGroupSetPanel=()=>{y.Z.goPeekState(Object(y.V)())},this.onCreateGroupSet=()=>{const{courseId:e,openGroupSetDetailPanel:t}=this.props;t(e,void 0,d.CREATE)},this.shouldStartInfiniteScroll=()=>{const{groupSets:e,totalSetCount:t,isLoading:n}=this.props,[,a]=this.list.getVisibleRange();return!n&&a>=e.length-1&&e.length<t},this.loadMore=e=>{const{onLoadGroupSets:t,groupSets:n}=this.props,{sortCriteria:a}=this.state;this.offset=Math.min(this.offset+E.w,n&&n.length||0),t(e,{offset:this.offset,sort:a},!0)},this.onScroll=()=>{this.list&&this.shouldStartInfiniteScroll()&&this.loadMore(this.props.courseId)},this.reduceOffset=()=>{this.offset>-E.w&&this.props.groupSets.length<this.props.totalSetCount&&(this.offset-=1)},this.onSwitchSortCriteria=e=>{this.setState({sortCriteria:e})},this.renderGroupSetListItem=e=>{var t;const{courseId:n,featuresConfig:i,groupSets:r,courseMemberCount:s,openGroupSetDetailPanel:o,analyticsId:l}=this.props,c=r[e],d=null===(t=r[e-1])||void 0===t?void 0:t.id,u=this.state.expandedGroupSetIds.has(d);return c?a.createElement(H,{index:e,key:c.id,courseId:n,groupSet:c,courseMemberCount:s,openGroupSetDetailPanel:o,onChangeOffset:this.reduceOffset,featuresConfig:i,sortCriteria:this.state.sortCriteria,analyticsId:`${l}.groupItem`,expand:this.state.expandedGroupSetIds.has(c.id),raised:u,onExpand:e=>{this.setState((t=>{const n=new Set(t.expandedGroupSetIds);return e?n.add(c.id):n.delete(c.id),{expandedGroupSetIds:n}}))}}):null},this.renderGroupSetListView=e=>{const{courseId:t,isLoading:n,isOrganization:i,localize:r,totalSetCount:s,analyticsId:o}=this.props,{sortCriteria:l}=this.state;return e>0?a.createElement("div",{className:"tabular-list-container"},a.createElement("div",{className:"tabular-list"},a.createElement("table",{id:"expandGrid",className:"table-content sortable-table",role:"grid","aria-readonly":!0,"aria-labelledby":"group-set-table-caption",tabIndex:-1,onKeyDown:Q},a.createElement("caption",{id:"group-set-table-caption",className:"sr-only"},r.translate("course.groupWorkspace.pageTitle")),a.createElement("thead",{className:"list-item-columns group-set-sort-header"},a.createElement("tr",{className:"list-item-row group-set-sort-row",role:"row",id:"table-header-row"},a.createElement("th",{className:"column-title sort",role:"columnheader",id:"col-name",tabIndex:0},a.createElement(J,{courseId:t,currentSort:l,isLoading:n,onSwitchSortCriteria:this.onSwitchSortCriteria,sortCriteria:[W.Vb.TITLE_ASC,W.Vb.TITLE_DESC],viewText:"title",analyticsId:`${o}.sortControl.group`})),a.createElement("th",{className:"column-student-count sort count",role:"columnheader",id:"col-count",tabIndex:-1},a.createElement(J,{courseId:t,currentSort:l,isLoading:n,onSwitchSortCriteria:this.onSwitchSortCriteria,sortCriteria:[W.Vb.STUDENT_COUNT_ASC,W.Vb.STUDENT_COUNT_DESC],viewText:"studentCount",analyticsId:`${o}.sortControl.count`})),a.createElement("th",{className:"column-group-set-controls"}))),a.createElement(p.a,{itemsRenderer:(e,t)=>a.createElement("tbody",{ref:t},e),length:e,itemRenderer:this.renderGroupSetListItem,ref:e=>this.list=e})))):0===s?a.createElement(Z,{imageSrc:"./static/images/ftue/empty-course-group.svg",title:r.translate("course.groupWorkspace.emptyState.title"),caption:r.translate(Object(X.o)("groupWorkspace.emptyState.caption.part1",i))},a.createElement("p",{className:"group-empty-state-caption"},r.translate("course.groupWorkspace.emptyState.caption.part2"))):""},this.state={sortCriteria:W.Vb.TITLE_ASC,expandedGroupSetIds:new Set,showBanner:"none",bannerMessage:""}}componentDidMount(){var e,t,n,a;const{courseId:i,onLoadGroupSets:r,root:s,onGetCourseContext:o}=this.props,{sortCriteria:l}=this.state;r(i,{sort:l}),o(i),(s&&s.querySelector(".panel-wrap")||window).addEventListener("scroll",u.throttle(this.onScroll,100),{capture:!0}),(s&&s.querySelector(".panel-wrap")||window).addEventListener("touchmove",u.throttle(this.onScroll,100),{capture:!0,passive:!0}),"SUCCESS"!==(null===(e=this.props.importGroupSetStatus)||void 0===e?void 0:e.responseStatus)&&"ERROR"!==(null===(t=this.props.importGroupSetStatus)||void 0===t?void 0:t.responseStatus)||this.props.clearImportGroupSetStatus(this.props.courseId),"SUCCESS"!==(null===(n=this.props.exportGroupSetStatus)||void 0===n?void 0:n.responseStatus)&&"ERROR"!==(null===(a=this.props.exportGroupSetStatus)||void 0===a?void 0:a.responseStatus)||this.props.clearExportGroupSetStatus(this.props.courseId)}componentDidUpdate(e,t){var n,a,i,r,s,o,l,c,d,u,m,p,h,g,b,f;if(t.sortCriteria!==this.state.sortCriteria){const e=this.props.groupSets&&this.props.groupSets.length||0,t=Math.max(e,E.w);this.props.onLoadGroupSets(this.props.courseId,{sort:this.state.sortCriteria,limit:t})}if(e.totalSetCount>this.props.totalSetCount&&this.list&&this.shouldStartInfiniteScroll()&&this.loadMore(this.props.courseId),(null===(n=e.importGroupSetStatus)||void 0===n?void 0:n.responseStatus)!==(null===(a=this.props.importGroupSetStatus)||void 0===a?void 0:a.responseStatus)&&"SUCCESS"===(null===(i=this.props.importGroupSetStatus)||void 0===i?void 0:i.responseStatus)&&this.showSuccessBanner({message:this.props.localize.translate("course.groupWorkspace.importGroupSet.fileImportSuccess")}),(null===(r=e.importGroupSetStatus)||void 0===r?void 0:r.responseStatus)!==(null===(s=this.props.importGroupSetStatus)||void 0===s?void 0:s.responseStatus)&&"ERROR"===(null===(o=this.props.importGroupSetStatus)||void 0===o?void 0:o.responseStatus)){const e=this.getImportGroupSetErrorMessage(this.props.importGroupSetStatus.responseCode);this.showErrorBanner({message:e})}(null===(l=e.exportGroupSetStatus)||void 0===l?void 0:l.responseStatus)!==(null===(c=this.props.exportGroupSetStatus)||void 0===c?void 0:c.responseStatus)&&"SUCCESS"===(null===(d=this.props.exportGroupSetStatus)||void 0===d?void 0:d.responseStatus)&&"GROUPS_LIST_VIEW"===(null===(m=null===(u=this.props.exportGroupSetStatus)||void 0===u?void 0:u.ui)||void 0===m?void 0:m.source)&&this.showSuccessBanner({message:this.props.localize.translate("course.groupWorkspace.exportGroupSet.fileExportSuccess")}),(null===(p=e.exportGroupSetStatus)||void 0===p?void 0:p.responseStatus)!==(null===(h=this.props.exportGroupSetStatus)||void 0===h?void 0:h.responseStatus)&&"ERROR"===(null===(g=this.props.exportGroupSetStatus)||void 0===g?void 0:g.responseStatus)&&"GROUPS_LIST_VIEW"===(null===(f=null===(b=this.props.exportGroupSetStatus)||void 0===b?void 0:b.ui)||void 0===f?void 0:f.source)&&this.showErrorBanner({message:this.props.localize.translate("course.groupWorkspace.exportGroupSet.fileExportError")})}componentWillUnmount(){const{root:e}=this.props;(e&&e.querySelector(".panel-wrap")||window).removeEventListener("scroll",this.onScroll),(e&&e.querySelector(".panel-wrap")||window).removeEventListener("touchmove",this.onScroll)}getImportGroupSetErrorMessage(e){let t;switch(e){case W.P.InvalidFileFormat:t="course.groupWorkspace.importGroupSet.fileFormatError";break;case W.P.EmptyFile:t="course.groupWorkspace.importGroupSet.fileEmptyError";break;case W.P.FileNotFound:t="course.groupWorkspace.importGroupSet.fileNotUploadedError";break;default:t="course.groupWorkspace.importGroupSet.fileImportError"}return this.props.localize.translate(t)}render(){const{canCreate:e,groupSets:t,totalGroupCount:n,totalSetCount:i,localize:r,analyticsEventAugmentor:s,analyticsId:o,isOrganization:l}=this.props,c=t&&t.length||0;return a.createElement("div",{className:"page-group-set course-group-set-layer"},a.createElement("div",{className:"panel-wrap"},a.createElement("header",{className:"panel-header simple-header"},a.createElement("div",{className:"panel-titles-container"},a.createElement("span",{className:"panel-sub-title"},r.translate("course.groupWorkspace.subTitle")),a.createElement("div",{className:"editable-title-container black-header-contents"},a.createElement(b.AnalyticsIconButton,{"aria-label":r.translate("base.menu"),className:"left-off-canvas-toggle menu-toggle  standard-button dark-background",title:r.translate("base.menu"),analyticsId:`${o}.menuToggle.button`},a.createElement(v.MainMenu,null)),a.createElement("h1",{className:"panel-title",tabIndex:-1},r.translate(Object(X.o)("groupWorkspace.pageTitle",l)))))),a.createElement("div",{className:"guidance-wrapper"},a.createElement("span",{className:"set-group-count"},r.translate("course.groupWorkspace.guidance.groupSetCount.plural",{groupSetCount:i||0})+r.translate("course.groupWorkspace.guidance.groupCount.plural",{groupCount:n||0})),e&&a.createElement(a.Fragment,null,a.createElement("button",{className:"import-group-set",onClick:s(g.AnalyticsEventTypes.CLICK_EVENT,this.openImportGroupSetPanel,`${o}.importGroupSet.button`),"data-analytics-id":`${o}.importGroupSet.button`},a.createElement(v.Upload,null),a.createElement("span",{className:"import-button"},r.translate("course.groupWorkspace.importGroupSet.buttonLabel"))),a.createElement("button",{className:"create-group-set",onClick:s(g.AnalyticsEventTypes.CLICK_EVENT,this.onCreateGroupSet,`${o}.createNewSet.button`),"data-analytics-id":`${o}.createNewSet.button`},a.createElement(f.AddCircle,null),a.createElement("span",{className:"create-button"},r.translate("course.groupWorkspace.guidance.createNewSet"))))),a.createElement("div",{className:"panel-content"},a.createElement("div",{className:"row collapse"},"success"===this.state.showBanner&&a.createElement("div",{className:"message-banner"},a.createElement(F.z,{message:this.state.bannerMessage,onClose:this.hideBanner})),"error"===this.state.showBanner&&a.createElement("div",{className:"message-banner"},a.createElement(F.m,{message:this.state.bannerMessage,onClose:this.hideBanner})),this.renderGroupSetListView(c),this.props.isLoading?a.createElement("div",{className:"spinner bb-secondary-color-2"}):""))))}}var te,ne=Object(g.withAnalytics)(Object(s.b)(((e,t)=>({groupSets:E.ec.groupSet.getRenderedGroupSets(e,t.courseId),isLoading:E.Yb.groupWorkspace.isLoading(e),totalSetCount:E.Yb.groupWorkspace.getTotalGroupSetCount(e),totalGroupCount:E.Yb.groupWorkspace.getTotalGroupCount(e),isOrganization:!!E.Yb.course.getCourseById(e,t.courseId).isOrganization,canCreate:E.Yb.groupWorkspace.canCreate(e),courseMemberCount:E.Yb.course.getCourseStudentCount(e,t.courseId),importGroupSetStatus:E.Yb.groupSetImport.getImportGroupSetStatus(e,t.courseId),exportGroupSetStatus:E.Yb.groupSetExport.getExportGroupSet(e,t.courseId)})),(e=>Object(S.b)({onLoadGroupSets:E.V.groupWorkspace.loadGroupSets,onGetCourseContext:E.V.course.fetchCourseStudentCount,clearImportGroupSetStatus:E.V.groupSetImport.clearImportGroupSetStatus,clearExportGroupSetStatus:E.V.groupSetExport.clearExportGroupSetStatus},e)))(Object(h.a)(ee)));!function(e){e.GroupEnrollmentExpiredErrorCode="enrollmentExpiredError",e.GroupIsFullErrorCode="groupIsFullError",e.SourceGroupSubmittedAttemptErrorCode="hasEnrolledGroupSubmittedAttemptError",e.TargetGroupSubmittedAttemptErrorCode="hasSubmittedGroupAttemptError",e.SourceGroupGradeErrorCode="hasSourceEnrollmentGroupGradesError",e.TargetGroupGradeErrorCode="hasTargetEnrollmentGroupGradesError"}(te||(te={}));var ae=n("ERsv"),ie=n("3/0u"),re=n("uxze");class se extends a.PureComponent{constructor(e){super(e),this.getMaxEnrollment=()=>{const{group:e,courseMemberCount:t}=this.props;return e&&e.maximumEnrollment&&e.maximumEnrollment>0?e.maximumEnrollment:t},this.isUserEnrolledInGroup=()=>{const{group:e,userId:t}=this.props;return!!(e&&e.memberships||[]).find((e=>e.userId===t))},this.getFlexboxActionCell=()=>{const{group:e,canCreateGroups:t,t:n,isAnyGroupMember:i,analyticsId:r,userHasGrade:s,userHasSubmission:o}=this.props,l=this.getSelfEnrollmentDateStateInfo(),c="After"===l.enrollmentDateState,d="Before"===l.enrollmentDateState,u=this.isUserEnrolledInGroup(),m=this.getMaxEnrollment();return e.isSelfEnrolledAllowed?c?a.createElement("div",{className:"join-column read-only enrollment-closed"},n("course.groupWorkspace.selfEnroll.closed")):d?a.createElement("div",{className:"join-column read-only enrollment-pending"},n("course.groupWorkspace.selfEnroll.pending")):u&&!t?a.createElement("div",{className:"join-column read-only enrollment-joined"},a.createElement("div",{className:"join-success-container"},a.createElement(v.Complete,{className:"join-icon"}),a.createElement("span",{className:"join-icon-text"},n("course.groupWorkspace.selfEnroll.joined")))):e&&e.studentCount>=m&&!u&&!c?a.createElement("div",{className:"join-column read-only enrollment-full"},n("course.groupWorkspace.selfEnroll.groupFull")):o||e&&e.hasSubmittedGroupAttempt?a.createElement("div",{className:"join-column read-only attempt-submitted"},n("course.groupWorkspace.selfEnroll.attemptSubmitted")):s||e&&e.hasGrades?a.createElement("div",{className:"join-column read-only enrollment-grade"},n("course.groupWorkspace.selfEnroll.gradeAssigned")):i||t?!i||u||t?void 0:a.createElement("div",{className:"join-column enrollment-move"},a.createElement("div",null,a.createElement(re.Link,{onClick:()=>this.moveToThisGroup(),analyticsId:Object(g.getNewAnalyticsId)(r,`group.${e.id}.move.link`)},n("course.groupWorkspace.selfEnroll.moveToGroup")),this.renderDialog())):a.createElement("div",{className:"join-column enrollment-join"},a.createElement(k.AnalyticsPrimaryButton,{type:"button",className:"join-button",onClick:this.onJoinClick,analyticsId:`${r}group.${e.id}.join.button`},n("course.groupWorkspace.selfEnroll.join"))):a.createElement("div",{className:"join-column read-only enrollment-disabled"})},this.getTableActionCell=()=>{const{group:e,canCreateGroups:t,t:n,isAnyGroupMember:i,analyticsId:r,userHasGrade:s,userHasSubmission:o}=this.props,l=this.getSelfEnrollmentDateStateInfo(),c="After"===l.enrollmentDateState,d="Before"===l.enrollmentDateState,u=this.isUserEnrolledInGroup(),m=this.getMaxEnrollment();return e.isSelfEnrolledAllowed?c?a.createElement("div",{className:"join-column read-only enrollment-closed"},n("course.groupWorkspace.selfEnroll.closed")):d?a.createElement("div",{className:"join-column read-only enrollment-pending"},n("course.groupWorkspace.selfEnroll.pending")):u&&!t?a.createElement("div",{className:"join-column read-only enrollment-joined"},a.createElement(v.Complete,{className:"joined-icon"}),a.createElement("span",{className:"join-icon-text"},n("course.groupWorkspace.selfEnroll.joined"))):e&&e.studentCount>=m&&!u&&!c?a.createElement("div",{className:"join-column read-only enrollment-full"},n("course.groupWorkspace.selfEnroll.groupFull")):o||e&&e.hasSubmittedGroupAttempt?a.createElement("div",{className:"join-column read-only attempt-submitted"},n("course.groupWorkspace.selfEnroll.attemptSubmitted")):s||e&&e.hasGrades?a.createElement("div",{className:"join-column read-only enrollment-grade"},n("course.groupWorkspace.selfEnroll.gradeAssigned")):i||t?!i||u||t?void 0:a.createElement("div",{className:"join-column enrollment-move"},a.createElement(re.Link,{onClick:()=>this.moveToThisGroup(),analyticsId:Object(g.getNewAnalyticsId)(r,`group.${e.id}.move.link`)},n("course.groupWorkspace.selfEnroll.moveToGroup")),this.renderDialog()):a.createElement("div",{className:"join-column enrollment-join"},a.createElement(k.AnalyticsPrimaryButton,{type:"button",className:"join-button",onClick:this.onJoinClick,analyticsId:`${r}group.${e.id}.join.button`},n("course.groupWorkspace.selfEnroll.join"))):a.createElement("div",{className:"join-column read-only enrollment-disabled"})},this.onJoinClick=async()=>{const{group:e,userId:t,courseId:n,enrolledGroupId:a,onJoinGroup:i,onGroupJoined:r}=this.props,s=e.id;try{await i({courseId:n,groupId:s,userId:t,enrolledGroupId:a}),this.dismissDialog(),r&&r()}catch(e){e instanceof E.z&&this.loadGroupsAndDisplayWarning(te.GroupIsFullErrorCode),e instanceof E.y&&this.loadGroupsAndDisplayWarning(te.GroupEnrollmentExpiredErrorCode),e instanceof E.S&&this.loadGroupsAndDisplayWarning(te.TargetGroupSubmittedAttemptErrorCode),e instanceof E.Q&&this.loadGroupsAndDisplayWarning(te.SourceGroupSubmittedAttemptErrorCode),e instanceof E.P&&this.loadGroupsAndDisplayWarning(te.SourceGroupGradeErrorCode),e instanceof E.R&&this.loadGroupsAndDisplayWarning(te.TargetGroupGradeErrorCode)}},this.loadGroupsAndDisplayWarning=e=>{const{group:t,courseId:n,onLoadGroups:a,hideOrDisplayWarning:i}=this.props,r=t.contentId;r?a({courseId:n,contentId:r,expand:A.b},!0).then((()=>{this.dismissDialog(),i(e,!1)})):(this.dismissDialog(),i(e,!1))},this.isShowGroupMembers=()=>{const e=this.getSignUpSheet();return!(!e||!e.isShowGroupMembers)},this.renderHasMembers=()=>{const{t:e}=this.props;if(this.isNonSelfEnrollmentGroupOrInstructorHidMembers())return a.createElement("div",{className:"group-members-disabled"},e("course.groupWorkspace.membersHidden"))},this.renderMemberList=()=>{const{group:e,analyticsId:t,t:n}=this.props;return a.createElement("div",{className:"show-members-link"},a.createElement(O.a,{onClick:()=>this.onShowGroupMembersList(e.id),analyticsId:`${t}.group.showMembers.link`,"aria-label":n("course.groupWorkspace.selfEnroll.showMembersLinkAriaLabel",{groupName:e.title}),href:"#"},n("course.groupWorkspace.selfEnroll.showMembers")))},this.moveToThisGroup=()=>{this.setState({hideDialog:!1})},this.dismissDialog=()=>{this.setState({hideDialog:!0})},this.onMoveToGroup=()=>{this.onJoinClick()},this.renderDialog=()=>{const{t:e,analyticsId:t}=this.props;return a.createElement(w.c,{onDismiss:this.dismissDialog,analyticsId:Object(g.getNewAnalyticsId)(t,"dialog.enroll"),hidden:this.state.hideDialog,modalProps:{isAlert:!0,className:"self-enroll-dialog"},dialogContentProps:{type:ie.DialogType.close,title:e("course.groupWorkspace.selfEnroll.dialog.titleCanMove"),subText:e("course.groupWorkspace.selfEnroll.dialog.canMove"),showCloseButton:!0}},a.createElement(ie.DialogFooter,null,a.createElement(k.AnalyticsDefaultButton,{onClick:this.dismissDialog,analyticsId:Object(g.getNewAnalyticsId)(t,"dialog.enroll.defaultButton")},e("course.groupWorkspace.button.cancel")),a.createElement(k.AnalyticsPrimaryButton,{onClick:this.onMoveToGroup,analyticsId:Object(g.getNewAnalyticsId)(t,"dialog.enroll.primaryButton"),className:"moveConfirmBtn"},e("course.groupWorkspace.button.move"))))},this.state={hideDialog:!0}}getSelfEnrollmentDateStateInfo(){const{groupSet:e,group:t}=this.props;return e?Object(A.e)([e]):Object(A.e)([t])}isNonSelfEnrollmentGroupOrInstructorHidMembers(){const e=this.getSignUpSheet();return!e||!e.isShowGroupMembers}onShowGroupMembersList(e){y.Z.goPeekState(Object(y.U)({groupId:e}))}getSignUpSheet(){const{groupSet:e}=this.props;return e&&e.signUpSheet?e.signUpSheet:this.props.group.signUpSheet}shouldShowGroupMemberships(){const{group:e}=this.props,t=this.getSignUpSheet();return e.memberships&&e.memberships.length>0&&(t&&t.isShowGroupMembers||this.isNotSelfEnrollmentGroup())}isNotSelfEnrollmentGroup(){return void 0===this.getSignUpSheet()}renderFlexboxContents(){var e;const{group:t,ariaLabelledBy:n,className:i,t:r}=this.props;return a.createElement("li",{id:Object(A.c)(t.id),key:t.id,className:`flexbox-group-row ${i||""}`},a.createElement("div",{className:"description-column"},a.createElement("div",{className:"groups-icon"},a.createElement(f.Groups,{className:"element-image"})),a.createElement("div",{className:"description-data"},a.createElement("div",{className:"group-data"},a.createElement("div",{id:`span-cell-${t.id}`,className:"group-title","aria-describedby":`${n} student-groups-group-sets`},t.title),this.shouldShowGroupMemberships()?this.renderMemberList():this.renderHasMembers(),a.createElement("span",{className:"list-item-member-count"},r("course.groupWorkspace.selfEnroll.max",{groupCount:null!==(e=t.studentCount)&&void 0!==e?e:0,groupTotal:this.getMaxEnrollment()})),t.description&&""!==t.description.displayText?a.createElement("div",{className:"group-description"},a.createElement(ae.BbEditor,{isToolbarHidden:!0,isDisabled:!0,isReadOnly:!0,bbml:t.description.rawText,ariaRequired:!1})):""),a.createElement("div",{className:"flexbox-action-cell"},this.getFlexboxActionCell()))))}renderTableContents(){var e;const{rowId:t,className:n,group:i,ariaLabelledBy:r,t:s}=this.props;return a.createElement("tr",{id:t||Object(A.c)(i.id),key:i.id,className:`self-enroll-group-row table-group-row ${n||""}`},a.createElement("td",{className:"groups-icon-column","aria-labelledby":`${r} col-name`,tabIndex:-1},a.createElement("div",{className:"title-column-data-wrapper"},a.createElement("div",{className:"icon-wrapper"},a.createElement("div",{className:"icon groups-icon"},a.createElement(f.Groups,{className:"element-image"}))),a.createElement("div",{className:"title-description-wrapper"},a.createElement("div",{id:`span-cell-${i.id}`,className:"group-title","aria-describedby":`${r} col-name`},i.title),this.shouldShowGroupMemberships()?this.renderMemberList():this.renderHasMembers(),i.description&&""!==i.description.displayText?a.createElement("div",{className:"group-description"},a.createElement(ae.BbEditor,{isToolbarHidden:!0,isDisabled:!0,isReadOnly:!0,bbml:i.description.displayText,ariaRequired:!1})):""))),a.createElement("td",{className:"count-column",tabIndex:-1,"aria-labelledby":"col-count"},a.createElement("div",{className:"count-column-data-wrapper"},a.createElement("div",{className:"member-count-and-menu"},a.createElement("span",{className:"list-item-member-count"},s("course.groupWorkspace.selfEnroll.max",{groupCount:null!==(e=i.studentCount)&&void 0!==e?e:0,groupTotal:this.getMaxEnrollment()}))),this.getTableActionCell())))}render(){const{useFlexbox:e}=this.props;return e?this.renderFlexboxContents():this.renderTableContents()}}var oe=Object(s.b)(((e,t)=>{const n=t.group.memberships?t.group.memberships.map((e=>e.userId)):[],a=E.Yb.user.getUsersByIds(e,n);return{group:t.group,groupUsers:a,canCreateGroups:!!E.Yb.groupWorkspace.canCreate(e)&&E.Yb.groupWorkspace.canCreate(e),isAnyGroupMember:E.Yb.group.hasJoined(e,{contentId:t.group.contentId,groupSetId:t.group.groupSetId,userId:t.userId})}}),(e=>Object(S.b)({onLoadGroups:E.V.group.loadByContentId,onJoinGroup:E.V.group.addGroupMembership},e)))(Object(V.a)(se));class le extends a.PureComponent{componentDidUpdate(e){e.group&&this.props.group&&(e.group.title===this.props.group.title&&e.group.studentCount===this.props.group.studentCount||this.props.onChangeOffset())}render(){const{group:e,userId:t,courseId:n,enrolledGroupId:i,isLoading:r,courseMemberCount:s,hideOrDisplayWarning:o,analyticsId:l,groupSet:c,userHasGrade:d,userHasSubmission:u,useFlexbox:m}=this.props;return r?a.createElement("tr",null,a.createElement("td",{colSpan:2,className:"isLoading"},a.createElement(I.Spinner,{size:I.SpinnerSize.large}))):a.createElement(oe,{group:e,userId:t,enrolledGroupId:i,courseId:n,userHasGrade:d,userHasSubmission:u,ariaLabelledBy:`title-${e.id}`,courseMemberCount:s,hideOrDisplayWarning:o,onGroupJoined:this.props.onGroupJoined,analyticsId:`${l}.groupContent`,groupSet:c,useFlexbox:m})}}var ce=Object(s.b)(((e,t)=>({debounceTime:2e3,userId:t.userId,courseId:t.courseId,userHasGrade:t.userHasGrade,userHasSubmission:t.userHasSubmission,group:t.group,isLoading:E.Yb.groupWorkspace.isLoading(e,t.group.id),courseMemberCount:t.courseMemberCount,hideOrDisplayWarning:t.hideOrDisplayWarning,groupSet:t.groupSet,useFlexbox:t.useFlexbox})))(le),de=n("E1pj");class ue extends a.PureComponent{constructor(e){super(e),this.hideOrDisplayWarning=(e,t)=>{let n={};switch(e){case te.GroupIsFullErrorCode:n={groupFull:t};break;case te.GroupEnrollmentExpiredErrorCode:n={enrollmentExpired:t};break;case te.TargetGroupSubmittedAttemptErrorCode:n={hasSubmittedGroupAttempt:t};break;case te.SourceGroupSubmittedAttemptErrorCode:n={hasEnrolledGroupSubmittedAttempt:t};break;case te.SourceGroupGradeErrorCode:n={hasSourceEnrollmentGroupGrades:t};break;case te.TargetGroupGradeErrorCode:n={hasTargetEnrollmentGroupGrades:t}}this.setState(n)},this.renderGroupSelfEnrollItem=(e,t)=>{const{groups:n,userId:i,courseId:r,analyticsId:s,isLoading:o,groupSetById:l}=this.props,c=n[e],d=Object(A.d)(n),u=o?null:l(d);return a.createElement(ce,{debounceTime:2e3,isLoading:this.props.isLoading,key:c.id,group:c,groupSet:u,enrolledGroupId:this.getEnrolledGroupId(),userId:i,courseId:r,userHasGrade:this.isUserInGroupWithGrade(),userHasSubmission:this.isUserInGroupWithSubmission(),onChangeOffset:()=>{},courseMemberCount:this.props.courseMemberCount,hideOrDisplayWarning:this.hideOrDisplayWarning,onGroupJoined:this.props.onGroupJoined,analyticsId:`${s}.groupItem`,useFlexbox:t})},this.renderWarnings=()=>[{code:te.GroupEnrollmentExpiredErrorCode,state:this.state.enrollmentExpired,isDifferentInOrg:!0},{code:te.GroupIsFullErrorCode,state:this.state.groupFull},{code:te.SourceGroupSubmittedAttemptErrorCode,state:this.state.hasEnrolledGroupSubmittedAttempt},{code:te.TargetGroupSubmittedAttemptErrorCode,state:this.state.hasSubmittedGroupAttempt},{code:te.SourceGroupGradeErrorCode,state:this.state.hasSourceEnrollmentGroupGrades},{code:te.TargetGroupGradeErrorCode,state:this.state.hasTargetEnrollmentGroupGrades}].map((e=>this.renderWarning(e))),this.renderWarning=e=>{const{isOrganization:t,localize:n,analyticsId:i}=this.props;return a.createElement("div",{key:e.code},!e.state&&a.createElement(I.Notification,{type:I.NotificationType.Failure,message:n.translate(Object(X.o)(`groupWorkspace.selfEnroll.${e.code}`,e.isDifferentInOrg&&t)),analyticsId:`${i}.${e.code}.warning.close.button`,onClose:()=>this.hideOrDisplayWarning(e.code,!0),disableAutoDismiss:!0}))},this.renderGroupSelfEnrollListView=e=>{const{UltraWindowSize:t}=this.props;return t.isSmallBreakpoint()?this.renderFlexboxGroupSelfEnrollListView(e):this.renderTableGroupSelfEnrollListView(e)},this.renderFlexboxGroupSelfEnrollListView=e=>{const{localize:t}=this.props;return a.createElement("ul",{id:"expandGrid",className:"flex-content",tabIndex:-1},a.createElement("li",{id:"table-header-row"},a.createElement("div",{className:"description-header column-title"},t.translate("course.groupWorkspace.selfEnroll.groups"))),this.renderSubItems())},this.renderTableGroupSelfEnrollListView=e=>{const{isOrganization:t,localize:n}=this.props;return a.createElement("div",{className:"tabular-list-container"},a.createElement("div",{className:"tabular-list"},a.createElement("table",{id:"expandGrid",className:"table-content","aria-label":n.translate("course.groupWorkspace.pageTitle"),tabIndex:-1},a.createElement("thead",{className:"list-item-column-header"},a.createElement("tr",{id:"table-header-row"},a.createElement("th",{className:"column-title",id:"col-name"},n.translate("course.groupWorkspace.selfEnroll.groups")),a.createElement("th",{className:"column-student-count count",id:"col-count",tabIndex:-1},n.translate(Object(X.o)("groupWorkspace.selfEnroll.numberOfStudents",t))))),a.createElement(p.a,{itemsRenderer:(e,t)=>a.createElement("tbody",{ref:t},e),length:e,itemRenderer:e=>this.renderGroupSelfEnrollItem(e,!1),ref:e=>this.list=e}))))},this.renderContentTitle=()=>{const{contentName:e}=this.props;return a.createElement("span",{className:"panel-sub-title"},e)},this.renderContentGroupTitle=()=>{const{localize:e,contentName:t,analyticsId:n}=this.props;return a.createElement("div",{className:"black-header-contents"},a.createElement(b.AnalyticsIconButton,{"aria-label":e.translate("base.menu"),className:"left-off-canvas-toggle menu-toggle  standard-button dark-background",title:e.translate("base.menu"),analyticsId:`${n}.toggle.menu.button`},a.createElement(v.MainMenu,null)),a.createElement("h1",{className:"panel-title"},e.translate("course.groupWorkspace.selfEnroll.groupTitle",{contentName:t})))},this.renderEnrollmentWarning=()=>{const{localize:e}=this.props,{isEnrollmentDateImportant:t,relativeDate:n,enrollmentDateState:i}=this.state;let r=null;switch(i){case"Before":r=a.createElement("div",null,e.translate("course.groupWorkspace.selfEnroll.enrollment-starts",{time:n}));break;case"Open":n&&(r=a.createElement("div",{className:t?"enrollment-warning":null},e.translate("course.groupWorkspace.selfEnroll.enrollment-closes",{time:n})));break;case"After":r=a.createElement("div",null,e.translate("course.groupWorkspace.selfEnroll.enrollment-closed"))}return r},this.state={groupFull:!0,enrollmentExpired:!0,hasSubmittedGroupAttempt:!0,hasEnrolledGroupSubmittedAttempt:!0,hasSourceEnrollmentGroupGrades:!0,hasTargetEnrollmentGroupGrades:!0}}componentDidMount(){const{courseId:e,contentId:t,onLoadGroups:n,onGetCourseContext:a}=this.props;n({courseId:e,contentId:t,expand:A.b},!0),a(e)}componentDidUpdate(e,t){this.onLoadSelfEnrollmentGroupInfo(t)}onLoadSelfEnrollmentGroupInfo(e){const{groups:t,locale:n,babelfishFormatInstance:a}=this.props;Object(A.f)(t,n,a).then((t=>{const{relativeDate:n,isEnrollmentDateImportant:a,enrollmentDateState:i}=t;e.relativeDate===n&&e.isEnrollmentDateImportant===a&&e.enrollmentDateState===i||this.updateSelfEnrollmentGroupInfo(t)}))}getEnrolledGroup(){const{groups:e,userId:t}=this.props;return u.find(e,(e=>u.some(e.memberships,(e=>e.userId===t))))}getEnrolledGroupId(){const{groups:e,userId:t}=this.props,n=u.find(e,(e=>u.some(e.memberships,(e=>e.userId===t))));return n?n.id:void 0}isUserInGroupWithSubmission(){const e=this.getEnrolledGroup();return e&&e.hasSubmittedGroupAttempt}isUserInGroupWithGrade(){const e=this.getEnrolledGroup();return e&&e.hasGrades}updateSelfEnrollmentGroupInfo(e){const{relativeDate:t,isEnrollmentDateImportant:n,enrollmentDateState:a}=e;this.setState({relativeDate:t,isEnrollmentDateImportant:n,enrollmentDateState:a})}renderSubItems(){const{analyticsId:e,courseId:t,courseMemberCount:n,groups:i,userId:r}=this.props;return i?i.map((i=>a.createElement(oe,{key:i.id,group:i,userId:r,enrolledGroupId:this.getEnrolledGroupId(),courseId:t,hideOrDisplayWarning:this.hideOrDisplayWarning,ariaLabelledBy:`title-${i.id}`,courseMemberCount:n,userHasGrade:this.isUserInGroupWithGrade(),userHasSubmission:this.isUserInGroupWithSubmission(),onGroupJoined:this.props.onGroupJoined,analyticsId:`${e}.groupContent`,useFlexbox:!0}))):null}render(){const{groups:e,localize:t}=this.props,n=e&&e.length||0,i=this.renderEnrollmentWarning();return a.createElement("div",{className:"page-group-set content-group-self-enroll-layer"},a.createElement("div",{className:"panel-wrap"},a.createElement("header",{className:"panel-header simple-header"},a.createElement("div",{className:"panel-titles-container"},this.renderContentTitle(),this.renderContentGroupTitle())),a.createElement("div",{className:"guidance-wrapper"},a.createElement("div",{className:"guidance-title"},t.translate("course.groupWorkspace.selfEnroll.groupDetails")),i),a.createElement("div",{className:null!==i?"panel-content enrollment-expires":"panel-content"},a.createElement("div",{className:"row collapse"},this.renderWarnings(),this.renderGroupSelfEnrollListView(n),this.props.isLoading?a.createElement("div",{className:"spinner bb-secondary-color-2"}):""))))}}var me=Object(s.b)(((e,t)=>({groups:Object(A.h)(E.Yb.group.getGroupsByContentId(e,t.contentId)),isLoading:E.Yb.group.isLoading(e)||E.Yb.groupWorkspace.isLoading(e),isOrganization:!!E.Yb.course.getCourseById(e,t.courseId).isOrganization,courseMemberCount:E.Yb.course.getCourseStudentCount(e,t.courseId),groupSetById:t=>E.Yb.groupWorkspace.getGroupSetById(e,t)})),(e=>Object(S.b)({onLoadGroups:E.V.group.loadByContentId,onGetCourseContext:E.V.course.fetchCourseStudentCount},e)))(Object(de.windowResizingResponsiveComponentWrapper)(Object(h.a)(ue))),pe=n("wgY5"),he=n.n(pe);function ge(e){return e.signUpSheet.enrollmentEndDate}function be(e){if(!e.isSelfEnrolledAllowed||!function(e){return e&&e.signUpSheet}(e))return!1;const t=ge(e);return void 0===t||he()(t).isSameOrAfter(he()())}function fe(e,t){return e.isSameOrAfter(function(e){return e.signUpSheet.enrollmentStartDate}(t))}function ve(e,t){if(be(e)&&be(t)){const n=ge(e),a=ge(t);return n&&!a?-1:a&&!n?1:function(e,t){return he()(ge(e)).diff(he()(ge(t)))}(e,t)}return 0}const ye=/^_([0-9]+)_([0-9]+)$/;function Se(e){const[,t,n]=e.match(ye);return[parseInt(t,10),parseInt(n,10)]}function Ce(e){return Array.from(e).sort(((e,t)=>function(e,t){const n=be(e),a=be(t);return n&&!a?-1:a&&!n?1:0}(e,t)||function(e,t){if(be(e)&&be(t)){const n=he()(),a=fe(n,e),i=fe(n,t);return a&&!i?-1:i&&!a?1:0}return 0}(e,t)||ve(e,t)||function(e,t){const[n]=Se(e.id),[a]=Se(t.id);return a-n}(e,t)))}class Ee extends a.PureComponent{constructor(e){super(e),this.toggleRow=()=>{this.setState((e=>({expand:!e.expand})))},this.renderEnrollmentWarning=()=>{const{localize:e}=this.props,{isEnrollmentDateImportant:t,relativeDate:n,enrollmentDateState:i}=this.state;let r=null;switch(i){case"Before":r=a.createElement("div",null,e.translate("course.groupWorkspace.selfEnroll.enrollment-starts",{time:n}));break;case"Open":n&&(r=a.createElement("div",{className:t?"enrollment-warning":null},e.translate("course.groupWorkspace.selfEnroll.enrollment-closes",{time:n})));break;case"After":r=a.createElement("div",null,e.translate("course.groupWorkspace.selfEnroll.enrollment-closed"))}return r},this.state={expand:be(e.groupSet)}}componentDidUpdate(e,t){this.onLoadSelfEnrollmentGroupInfo(t)}componentDidMount(){this.onLoadSelfEnrollmentGroupInfo(this.state)}onLoadSelfEnrollmentGroupInfo(e){const{groupSet:t,currentLocale:n,babelfishFormatInstance:a}=this.props;t.isSelfEnrolledAllowed&&Object(A.f)([t],n,a).then((t=>{const{relativeDate:n,isEnrollmentDateImportant:a,enrollmentDateState:i}=t;e.relativeDate===n&&e.isEnrollmentDateImportant===a&&e.enrollmentDateState===i||this.updateSelfEnrollmentGroupInfo(t)}))}getEnrolledGroup(){const{groups:e,userId:t}=this.props;return u.find(e,(e=>u.some(e.memberships,(e=>e.userId===t))))}getEnrolledGroupId(){const{groups:e,userId:t}=this.props,n=u.find(e,(e=>u.some(e.memberships,(e=>e.userId===t))));return n?n.id:void 0}isUserInGroupWithSubmission(){const e=this.getEnrolledGroup();return e&&e.hasSubmittedGroupAttempt}isUserInGroupWithGrade(){const e=this.getEnrolledGroup();return e&&e.hasGrades}updateSelfEnrollmentGroupInfo(e){const{relativeDate:t,isEnrollmentDateImportant:n,enrollmentDateState:a}=e;this.setState({relativeDate:t,isEnrollmentDateImportant:n,enrollmentDateState:a})}renderSubItems(){const{analyticsId:e,courseId:t,courseMemberCount:n,groups:i,groupSet:r,hideOrDisplayWarning:s,userId:o}=this.props,{expand:l}=this.state;return i?i.map(((c,d)=>{const u=`${l?"expand":""} ${d===i.length-1?"last-child":""}`,m=Object(A.c)(c.id);return a.createElement(oe,{rowId:m,className:u,key:c.id,group:c,groupSet:r,enrolledGroupId:this.getEnrolledGroupId(),userId:o,courseId:t,ariaLabelledBy:`title-${c.id}`,userHasGrade:this.isUserInGroupWithGrade(),userHasSubmission:this.isUserInGroupWithSubmission(),useFlexbox:!0,courseMemberCount:n,hideOrDisplayWarning:s,onGroupJoined:this.props.onGroupJoined,analyticsId:`${e}.groupItem`})})):null}renderIcon(){return a.createElement("div",{className:"group-set-icon-container"},a.createElement("div",{className:"group-set-icon"},a.createElement(N.a,{color:"primary",className:"element-image"})))}render(){const{groups:e,groupSet:t,isLoading:n,analyticsId:i}=this.props,{expand:r}=this.state,s=!(!t.description||!t.description.rawText),o=`${e&&e.map((e=>Object(A.c)(e.id))).join(" ")}`;return a.createElement(a.Fragment,null,a.createElement("li",{key:t.id,id:`row-${t.id}`,className:"group-set-row expandable "+(r?"expand":""),"aria-expanded":r},this.renderIcon(),a.createElement("div",{className:"group-set-row-data"},a.createElement("div",{className:"group-set-header description-column"},a.createElement("div",{className:"group-set-title"},t.title),this.renderEnrollmentWarning(),s&&a.createElement("div",{className:"group-set-description-text"},a.createElement(ae.BbEditor,{isToolbarHidden:!0,isDisabled:!0,isReadOnly:!0,bbml:t.description.rawText,ariaRequired:!1})))),a.createElement("div",{className:"item-expand"},a.createElement(b.AnalyticsIconButton,{analyticsId:i,onClick:this.toggleRow,"aria-controls":o},r?a.createElement(v.ArrowUp,null):a.createElement(v.ArrowDown,null)))),n?a.createElement("li",{className:"isLoading"},a.createElement(I.Spinner,{size:I.SpinnerSize.large})):this.renderSubItems())}}var Ie=Object(s.b)(((e,t)=>({groups:Object(A.h)(E.Yb.group.getGroupsByGroupSetId(e,t.groupSet.id)),isLoading:E.Yb.group.isLoading(e)||E.Yb.groupWorkspace.isLoading(e,t.groupSet.id),courseMemberCount:E.Yb.course.getCourseStudentCount(e,t.courseId)})),(e=>Object(S.b)({},e)))(Object(h.a)(Ee));class ke extends a.PureComponent{constructor(){super(...arguments),this.renderGroupSetList=(e,t)=>{const{localize:n}=this.props;return a.createElement("div",{className:"group-set-list-container",ref:t},a.createElement("div",{className:"list-header"},a.createElement("div",{className:"description-header column-title",id:"student-groups-group-sets"},n.translate("course.groupWorkspace.selfEnroll.groupSets"))),a.createElement("ul",{className:"group-set-list"},e))},this.renderGroupSetListItem=(e,t)=>{const{groupSetList:n,userId:i,courseId:r,analyticsId:s,onGroupJoined:o}=this.props,l=n[e];return a.createElement(Ie,{courseId:r,groupSet:l,userId:i,onGroupJoined:o,hideOrDisplayWarning:this.props.hideOrDisplayWarning,analyticsId:`${s}.groupItem`,key:t})}}getGroupSetCount(){return(this.props.groupSetList||[]).length}render(){return a.createElement(p.a,{itemsRenderer:this.renderGroupSetList,length:this.getGroupSetCount(),itemRenderer:this.renderGroupSetListItem,ref:e=>this.list=e})}}var we=Object(h.a)(ke);class Te extends a.PureComponent{constructor(e){super(e),this.toggleRow=()=>{this.setState((e=>({expand:!e.expand})))},this.renderEnrollmentWarning=()=>{const{localize:{translate:e}}=this.props,{isEnrollmentDateImportant:t,relativeDate:n,enrollmentDateState:i}=this.state;let r=null;switch(i){case A.a.BEFORE:r=a.createElement("div",null,e("course.groupWorkspace.selfEnroll.enrollment-starts",{time:n}));break;case A.a.OPEN:n&&(r=a.createElement("div",{className:t?"enrollment-warning":null},e("course.groupWorkspace.selfEnroll.enrollment-closes",{time:n})));break;case A.a.AFTER:r=a.createElement("div",null,e("course.groupWorkspace.selfEnroll.enrollment-closed"))}return r},this.state={expand:be(e.groupSet)}}componentDidUpdate(e,t){this.onLoadSelfEnrollmentGroupInfo(t)}componentDidMount(){this.onLoadSelfEnrollmentGroupInfo(this.state)}onLoadSelfEnrollmentGroupInfo(e){const{groupSet:t,localize:{locale:n,babelfishFormat:a}}=this.props;t.isSelfEnrolledAllowed&&Object(A.f)([t],n,a).then((t=>{const{relativeDate:n,isEnrollmentDateImportant:a,enrollmentDateState:i}=t;e.relativeDate===n&&e.isEnrollmentDateImportant===a&&e.enrollmentDateState===i||this.updateSelfEnrollmentGroupInfo(t)}))}getEnrolledGroupId(){const{groups:e,userId:t}=this.props,n=u.find(e,(e=>u.some(e.memberships,(e=>e.userId===t))));return n?n.id:void 0}getEnrolledGroup(){const{groups:e,userId:t}=this.props;return u.find(e,(e=>u.some(e.memberships,(e=>e.userId===t))))}isUserInGroupWithSubmission(){const e=this.getEnrolledGroup();return e&&e.hasSubmittedGroupAttempt}isUserInGroupWithGrade(){const e=this.getEnrolledGroup();return e&&e.hasGrades}updateSelfEnrollmentGroupInfo(e){const{relativeDate:t,isEnrollmentDateImportant:n,enrollmentDateState:a}=e;this.setState({relativeDate:t,isEnrollmentDateImportant:n,enrollmentDateState:a})}renderSubItems(){const{analyticsId:e,courseId:t,courseMemberCount:n,groups:i,groupSet:r,hideOrDisplayWarning:s,userId:o}=this.props,{expand:l}=this.state;return i?i.map(((c,d)=>{const u=Object(P.a)({expand:l},{"last-group":d===i.length-1},{"first-group":0===d}),m=Object(A.c)(c.id);return a.createElement(oe,{key:c.id,rowId:m,className:u,group:c,userId:o,enrolledGroupId:this.getEnrolledGroupId(),courseId:t,ariaLabelledBy:`title-${c.id}`,courseMemberCount:n,userHasGrade:this.isUserInGroupWithGrade(),userHasSubmission:this.isUserInGroupWithSubmission(),hideOrDisplayWarning:s,onGroupJoined:this.props.onGroupJoined,analyticsId:`${e}.groupContent`,groupSet:r,useFlexbox:!1})})):null}render(){const{groups:e,groupSet:t,isLoading:n,courseMemberCount:i,analyticsId:r}=this.props,{expand:s}=this.state,o=!(!t.description||!t.description.rawText),l=`${e&&e.map((e=>Object(A.c)(e.id))).join(" ")}`;return a.createElement(a.Fragment,null,a.createElement("tr",{key:t.id,id:`row-${t.id}`,className:"group-set-item item-row expandable "+(s?"expand":""),"aria-expanded":s},a.createElement("td",{className:"header-column",tabIndex:-1},a.createElement("div",{className:"group-workspace-header"},a.createElement("div",{className:"icon"},a.createElement(N.a,{color:"primary",className:"element-image"})),a.createElement("div",{className:"group-set-header description-column"},a.createElement("div",{className:"group-set-title"},t.title),this.renderEnrollmentWarning(),o&&a.createElement("div",{className:"group-set-description-text"},a.createElement(ae.BbEditor,{isToolbarHidden:!0,isReadOnly:!0,bbml:t.description.rawText,ariaRequired:!1}))))),a.createElement("td",{className:"count-column",tabIndex:-1,"aria-labelledby":"col-count"},a.createElement("div",{className:"count-column-data-wrapper"},a.createElement("div",{className:"member-count"},a.createElement("span",{className:"list-item-member-count"},a.createElement("span",{className:"list-item-member-count-current"},`${t.studentCount||0}`),` / ${i||0}`)),a.createElement("div",{className:"item-expand"},a.createElement(b.AnalyticsIconButton,{analyticsId:r,onClick:this.toggleRow,"aria-controls":l},s?a.createElement(v.ChevronUp,null):a.createElement(v.ChevronDown,null)))))),n?a.createElement("tr",null,a.createElement("td",{colSpan:2,className:"isLoading"},a.createElement(I.Spinner,{size:I.SpinnerSize.large}))):this.renderSubItems())}}var Oe=Object(s.b)(((e,t)=>({groups:Object(A.h)(E.Yb.group.getGroupsByGroupSetId(e,t.groupSet.id)),isLoading:E.Yb.group.isLoading(e)||E.Yb.groupWorkspace.isLoading(e,t.groupSet.id),courseMemberCount:E.Yb.course.getCourseStudentCount(e,t.courseId)})),(e=>Object(S.b)({},e)))(Object(C.a)(Te));class Ae extends a.PureComponent{constructor(){super(...arguments),this.renderGroupSetListItem=(e,t)=>{const{groupSetList:n,userId:i,courseId:r,analyticsId:s,onGroupJoined:o}=this.props,l=n[e];return a.createElement(Oe,{courseId:r,groupSet:l,userId:i,onGroupJoined:o,hideOrDisplayWarning:this.props.hideOrDisplayWarning,analyticsId:`${s}.groupItem`,key:t})}}getGroupSetCount(){return(this.props.groupSetList||[]).length}render(){const{isOrganization:e,localize:t}=this.props;return a.createElement("div",{className:"tabular-list-container"},a.createElement("div",{className:"tabular-list"},a.createElement("table",{className:"course-group-set-table","aria-label":t.translate("course.groupWorkspace.pageTitle"),tabIndex:-1},a.createElement("thead",{className:"group-set-sort-header"},a.createElement("tr",{className:"group-set-sort-row",id:"table-header-row"},a.createElement("th",{className:"column-title",id:"col-name"},t.translate("course.groupWorkspace.selfEnroll.groupSets")),a.createElement("th",{className:"column-student-count count",id:"col-count",tabIndex:-1},t.translate(Object(X.o)("groupWorkspace.selfEnroll.numberOfStudents",e))))),a.createElement(p.a,{itemsRenderer:(e,t)=>a.createElement("tbody",{ref:t},e),length:this.getGroupSetCount(),itemRenderer:this.renderGroupSetListItem,ref:e=>this.list=e}))))}}var Pe=Object(h.a)(Ae);class xe extends a.PureComponent{constructor(e){super(e),this.renderContentTitle=()=>{const{contentName:e}=this.props;return a.createElement("span",{className:"panel-sub-title"},e)},this.renderContentGroupTitle=()=>{const{localize:e,contentName:t,analyticsId:n}=this.props;return a.createElement("div",{className:"black-header-contents"},a.createElement(b.AnalyticsIconButton,{"aria-label":e.translate("base.menu"),className:"left-off-canvas-toggle menu-toggle  standard-button dark-background",analyticsId:`${n}.toggle.menu.button`},a.createElement(v.MainMenu,null)),a.createElement("h1",{className:"panel-title"},e.translate("course.groupWorkspace.selfEnroll.groupTitle",{contentName:t})))},this.hideOrDisplayWarning=(e,t)=>{let n={};switch(e){case te.GroupIsFullErrorCode:n={groupFull:t};break;case te.GroupEnrollmentExpiredErrorCode:n={enrollmentExpired:t};break;case te.TargetGroupSubmittedAttemptErrorCode:n={hasSubmittedGroupAttempt:t};break;case te.SourceGroupSubmittedAttemptErrorCode:n={hasEnrolledGroupSubmittedAttempt:t};break;case te.SourceGroupGradeErrorCode:n={hasSourceEnrollmentGroupGrades:t};break;case te.TargetGroupGradeErrorCode:n={hasTargetEnrollmentGroupGrades:t}}this.setState(n)},this.renderWarning=e=>{const{isOrganization:t,localize:n,analyticsId:i}=this.props;return a.createElement("div",{key:e.code},!e.state&&a.createElement(I.Notification,{type:I.NotificationType.Failure,message:n.translate(Object(X.o)(`groupWorkspace.selfEnroll.${e.code}`,e.isDifferentInOrg&&t)),analyticsId:`${i}.${e.code}.warning.close.button`,onClose:()=>this.hideOrDisplayWarning(e.code,!0),disableAutoDismiss:!0}))},this.renderWarnings=()=>[{code:te.GroupEnrollmentExpiredErrorCode,state:this.state.enrollmentExpired,isDifferentInOrg:!0},{code:te.GroupIsFullErrorCode,state:this.state.groupFull},{code:te.SourceGroupSubmittedAttemptErrorCode,state:this.state.hasEnrolledGroupSubmittedAttempt},{code:te.TargetGroupSubmittedAttemptErrorCode,state:this.state.hasSubmittedGroupAttempt},{code:te.SourceGroupGradeErrorCode,state:this.state.hasSourceEnrollmentGroupGrades},{code:te.TargetGroupGradeErrorCode,state:this.state.hasTargetEnrollmentGroupGrades}].map((e=>this.renderWarning(e))),this.state={groupFull:!0,enrollmentExpired:!0,hasSubmittedGroupAttempt:!0,hasEnrolledGroupSubmittedAttempt:!0,hasSourceEnrollmentGroupGrades:!0,hasTargetEnrollmentGroupGrades:!0}}componentDidMount(){const{courseId:e,onLoadGroupSets:t,onLoadGroups:n,onGetCourseContext:a}=this.props;t(e),n(e),a(e)}getGroupSetCount(){return this.getGroupSetsToRender().length}getGroupsCount(){return(this.props.groupSets||[]).reduce(((e,{assignedGroups:t=[]})=>e+t.length),0)}renderLoadingIndicator(){return a.createElement("div",{className:"spinner-container"},a.createElement(I.Spinner,{size:I.SpinnerSize.xLarge}))}renderGroupSets(){const{analyticsId:e,userId:t,localize:n,onGroupJoined:i,courseId:r,UltraWindowSize:s,isOrganization:o}=this.props;return 0===this.getGroupSetCount()?a.createElement(Z,{imageSrc:"./static/images/ftue/empty-course-group.svg",title:n.translate(Object(X.o)("groupWorkspace.selfEnroll.emptyState.title",o)),caption:n.translate(Object(X.o)("groupWorkspace.selfEnroll.emptyState.caption",o))}):s.isSmallBreakpoint()?a.createElement(we,{groupSetList:this.getGroupSetsToRender(),analyticsId:e,userId:t,courseId:r,onGroupJoined:i,hideOrDisplayWarning:this.hideOrDisplayWarning}):a.createElement(Pe,{groupSetList:this.getGroupSetsToRender(),analyticsId:e,userId:t,courseId:r,onGroupJoined:i,hideOrDisplayWarning:this.hideOrDisplayWarning,isOrganization:o})}getNonEmptyGroupSets(){return(this.props.groupSets||[]).filter((({groupCount:e,assignedGroups:t})=>e&&t&&t.length))}getGroupSetsToRender(){return Ce(this.getNonEmptyGroupSets())}render(){const{localize:e,isLoading:t}=this.props;return a.createElement("div",{className:"page-group-set course-group-self-enroll-layer"},a.createElement("div",{className:"panel-wrap"},a.createElement("header",{className:"panel-header simple-header"},a.createElement("div",{className:"panel-titles-container"},this.renderContentTitle(),this.renderContentGroupTitle())),a.createElement("div",{className:"guidance-wrapper"},a.createElement("span",{className:"set-group-count"},e.translate("course.groupWorkspace.guidance.groupAndGroupSetCount.plural",{groupSetCount:this.getGroupSetCount(),groupCount:this.getGroupsCount()}))),a.createElement("div",{className:"panel-content"},a.createElement("div",{className:"row collapse"},this.renderWarnings(),t?this.renderLoadingIndicator():this.renderGroupSets()))))}}var $e=Object(s.b)(((e,t)=>({groupSets:E.ec.groupSet.getRenderedGroupSets(e,t.courseId),isLoading:E.Yb.groupWorkspace.isLoading(e)||E.Yb.group.isLoading(e),courseMemberCount:E.Yb.course.getCourseStudentCount(e,t.courseId),isOrganization:!!E.Yb.course.getCourseById(e,t.courseId).isOrganization})),(e=>Object(S.b)({onLoadGroupSets:E.V.groupWorkspace.loadGroupSets,onLoadGroups:E.V.group.loadGroupsByCourse,onGetCourseContext:E.V.course.fetchCourseStudentCount},e)))(Object(I.windowResizingResponsiveComponentWrapper)(Object(h.a)(xe))),Ne=n("zTL+"),De=n("IVC4");const Le=Object(j.makeStyles)((e=>Object(j.createStyles)({banner:{padding:"12px 30px"}})));var je=Object(h.a)((({localize:e})=>{const[t,n]=a.useState(!0),i=Le();return t?(()=>{const t=a.createElement(De.a,null),r=e.translate("course.groupWorkspace.movingMembersBanner.closeText"),s=e.translate("course.groupWorkspace.movingMembersBanner.bannerMessage");return a.createElement(Ne.a,{severity:"warning",icon:t,onClose:()=>n(!1),closeText:r,className:i.banner},a.createElement("span",{className:"js-banner-contents"},s))})():null}));const Me=Object(j.makeStyles)((e=>({peekPanel:{position:"absolute",top:0,left:0,right:0,bottom:0,overflowY:"auto"},peekPanelHeader:{"& .ms-Panel-subTitle, .ms-Panel-headerText":{paddingLeft:"16px",[e.breakpoints.up("xl")]:{paddingLeft:"30px"}}},hideHeader:{display:"none"},peekPanelBody:{padding:"30px",position:"relative",marginBottom:"48px"},peekPanelTabsContainer:{padding:"0 30px",position:"relative",marginBottom:"48px"},importPeekPanelTabsContainer:{padding:"0 30px",position:"relative",marginBottom:"68px"},peekPanelFooter:{position:"absolute",bottom:0,left:0,right:0,"& .ms-Panel-footer":{justifyContent:"center"}},peekPanelTabs:{borderBottom:`1px solid ${e.palette.border.main}`},tabButton:{minWidth:"50%"},tabPanelBody:{marginTop:"24px"}}))),Ge=Object(j.makeStyles)((e=>({helpContainer:{display:"flex"},uploadFileText:{flex:1,fontWeight:e.typography.fontWeightSemiBold},fileIcon:{marginRight:"5px"},fileListContainer:{display:"flex",flexDirection:"row",marginTop:"15px",height:"50px",alignItems:"center",backgroundColor:e.palette.background.b2,padding:"5px"},trashIcon:{marginLeft:"5px"},fileName:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",width:"auto",flex:1}}))),Re=e=>{const{description:t,analyticsId:n,helpLink:i,templateLink:r,templateText:s,validFileFormats:o}=e,{file:l,onFileUpload:c,onRemoveFile:d,onFileUploadError:u}=e,m=Object(T.a)(),p=Ge();return a.createElement(a.Fragment,null,a.createElement("p",null,t),a.createElement("div",{className:p.helpContainer},a.createElement("span",{className:p.uploadFileText},m("course.groupWorkspace.importGroupSet.uploadFile")),a.createElement(D.AnalyticsLink,{analyticsId:`${n}.help.link`,href:i,target:"_blank"},m("global.help"))),a.createElement(F.p,{analyticsId:`${n}.file-upload`,validFormats:o,onFileUpload:c,onFileUploadError:u}),a.createElement("div",null,a.createElement(D.AnalyticsLink,{analyticsId:`${n}.template.link`,href:r},s)),l&&a.createElement("div",{className:Object(P.a)("js-file-container",p.fileListContainer)},a.createElement(f.Reports,{className:p.fileIcon}),a.createElement("span",{className:p.fileName},l.fileName),a.createElement(D.AnalyticsIconButton,{analyticsId:`${n}.trash.icon`,onClick:d,className:p.trashIcon,"aria-label":m("global.delete")},a.createElement(f.Trash,null))))},Be=(e,t,n=W.xb.Groups)=>{const i=Object(s.d)(),[r,o]=Object(a.useState)(!0),[l,c]=Object(a.useState)(),d=Object(a.useCallback)((()=>{y.Z.leavePeekState()}),[]),u=Object(a.useCallback)((()=>{if(o(!0),(null==l?void 0:l.fileName)&&(null==l?void 0:l.fileLocation)){const a={fileName:l.fileName,fileLocation:l.fileLocation,scope:n};i(t?E.V.groupSetImport.importGroupSet(e,a):E.V.groupMembersImport.importGroupMembers(e,a))}d()}),[e,l,n,t,d,i]);return{isPrimaryButtonDisabled:r,file:l,dismissPanel:d,onImportClick:u,onFileUpload:e=>{c(e),o(!1)},onFileUploadError:n=>{console.error(n.message),i(t?E.V.groupSetImport.setFileUploadGroupSetError(e,n):E.V.groupMembersImport.setFileUploadGroupMembersError(e,n)),d()},onRemoveFile:()=>{c(void 0),o(!0)}}};var Fe=n("Y+9S");const Ue=[".csv"],_e="course.groups.import-group-set",ze=e=>{const{courseId:t,courseName:n}=e,r=Object(T.a)(),s=Me(),o=Object(L.h)("course.","organization."),{isPrimaryButtonDisabled:l,file:c,dismissPanel:d,onImportClick:u,onFileUpload:m,onFileUploadError:p,onRemoveFile:h}=Be(t,!0);return Object(a.useEffect)((()=>{const e={type:Fe.c.ImportGroupSetPanelOpened,status:Fe.b.Success,pageTitle:r("course.groupWorkspace.importGroupSet.pageTitle")};Object(Fe.r)(e)}),[r]),i.a.createElement("div",{id:"import-group-set-panel"},i.a.createElement("div",{className:s.peekPanel},i.a.createElement("header",{className:Object(P.a)(s.peekPanelHeader,Object(Fe.m)()&&s.hideHeader)},i.a.createElement(I.BbPanelHeader,{smallHeaderTitle:n,type:I.BbPanelType.peek,analyticsId:`${_e}.header`,title:r("course.groupWorkspace.importGroupSet.pageTitle"),navMenuAriaLabel:r("global.navigationMenu")})),i.a.createElement("div",{className:s.peekPanelBody},i.a.createElement(Re,{analyticsId:_e,description:r(o("course.groupWorkspace.importGroupSet.description")),helpLink:r("course.groupWorkspace.importGroupSet.helpLink"),templateLink:Object(E.eb)("/webapps/bb-group-mgmt-LEARN/help/ultra/sample_groups.csv"),templateText:r("course.groupWorkspace.importGroupSet.downloadGroupSetsTemplate"),onFileUpload:m,onRemoveFile:h,onFileUploadError:p,validFileFormats:Ue,file:c}))),i.a.createElement("footer",{className:s.peekPanelFooter},i.a.createElement(I.BbPanelFooter,{primaryButtonProps:{onClick:u,disabled:l,text:r("global.import"),id:"js-button-import"},secondaryButtonProps:{onClick:d,text:r("global.cancel")},analyticsId:`${_e}.footer`})))};var qe=n("jYYR");const He=[".csv"],Ve=e=>{const{courseId:t,courseName:n}=e,r=Me(),s=Object(T.a)(),[o,l]=Object(a.useState)("create"),c=Object(L.h)("course.","organization."),{isPrimaryButtonDisabled:d,file:u,dismissPanel:m,onImportClick:p,onFileUpload:h,onFileUploadError:g,onRemoveFile:b}=Be(t,!1,"create"===o?W.xb.Groups:W.xb.Members),f="create"===o?"/webapps/bb-group-mgmt-LEARN/help/ultra/sample_groups.csv":"/webapps/bb-group-mgmt-LEARN/help/ultra/sample_groupmembers.csv";Object(a.useEffect)((()=>{const e={type:Fe.c.ImportGroupMembersPanelOpened,status:Fe.b.Success,pageTitle:s("course.content.courseGroup.importGroups")};Object(Fe.r)(e)}),[s]);return i.a.createElement("div",{id:"import-group-members-panel"},i.a.createElement("div",{className:r.peekPanel},i.a.createElement("header",{className:Object(P.a)(r.peekPanelHeader,Object(Fe.m)()&&r.hideHeader)},i.a.createElement(I.BbPanelHeader,{smallHeaderTitle:n,type:I.BbPanelType.peek,analyticsId:"course.groups.import-group-members.header",title:s("course.content.courseGroup.importGroups"),navMenuAriaLabel:s("global.navigationMenu")})),i.a.createElement("div",{className:r.importPeekPanelTabsContainer},i.a.createElement(D.AnalyticsTabs,{value:o,className:r.peekPanelTabs,analyticsId:"course.groups.import-group-members.tabs",onChange:()=>{u&&b()}},i.a.createElement(D.AnalyticsTab,{label:s("course.groupWorkspace.importGroupMembers.createGroupsTab"),value:"create",className:r.tabButton,analyticsId:"course.groups.import-group-members.tabs.create",onClick:()=>l("create"),id:"id-create-groups-tab","aria-controls":"id-create-groups-tab-panel"}),i.a.createElement(D.AnalyticsTab,{label:s("course.groupWorkspace.importGroupMembers.assignMembersTab"),value:"assign",className:r.tabButton,analyticsId:"course.groups.import-group-members.tabs.assign",onClick:()=>l("assign"),id:"id-assign-members-tab","aria-controls":"id-assign-members-tab-panel"})),i.a.createElement(qe.a,{panelId:"create"===o?"id-create-groups-tab-panel":"id-assign-members-tab-panel",ariaLabelledby:"create"===o?"id-create-groups-tab":"id-assign-members-tab"},i.a.createElement("div",{className:r.tabPanelBody},"create"===o?i.a.createElement(Re,{analyticsId:"course.groups.import-group-members.createTab",description:s(c("course.groupWorkspace.importGroupSet.description")),helpLink:s("course.groupWorkspace.importGroupSet.helpLink"),templateLink:Object(E.eb)(f),templateText:s("course.groupWorkspace.importGroupMembers.downloadGroupsTemplate"),onFileUpload:h,onRemoveFile:b,onFileUploadError:g,validFileFormats:He,file:u}):i.a.createElement(Re,{analyticsId:"course.groups.import-group-members.assignTab",description:s(c("course.groupWorkspace.importGroupMembers.assignDescription")),helpLink:s("course.groupWorkspace.importGroupSet.helpLink"),templateLink:Object(E.eb)(f),templateText:s("course.groupWorkspace.importGroupMembers.downloadMembersTemplate"),onFileUpload:h,onRemoveFile:b,onFileUploadError:g,validFileFormats:He,file:u}))))),i.a.createElement("div",{className:r.peekPanelFooter},i.a.createElement(I.BbPanelFooter,{primaryButtonProps:{onClick:p,disabled:d,text:s("global.import"),id:"js-button-import"},secondaryButtonProps:{onClick:m,text:s("global.cancel")},analyticsId:"course.groups.import-group-members.footer"})))},We=Object(j.makeStyles)((e=>({radioGroup:{padding:"24px 0",borderBottom:`1px solid ${e.palette.border.main}`},fileContainer:{padding:"24px 0",borderBottom:`1px solid ${e.palette.border.main}`,"& svg":{cursor:"pointer",marginRight:"10px"}},trashIconButton:{alignItems:"start"},fileLink:{display:"flex",flex:1,color:e.palette.text.primary,textDecoration:"none","&:hover,&:focus":{color:e.palette.text.primary,textDecoration:"none"}},fileDetail:{display:"flex","& span":{width:"200px",overflow:"hidden",textOverflow:"ellipsis",textAlign:"left",[e.breakpoints.up("sm")]:{width:"250px"}},"& p":{textAlign:"left"}},noFileText:{padding:"24px 0",textAlign:"center"},pagination:{margin:"12px 0"},paginationFooter:{position:"absolute",bottom:0,left:0,right:0,backgroundColor:`${e.palette.background.default}`}}))),Ke=e=>{const{analyticsId:t,setSelectedFieldsToInclude:n,setIsPrimaryButtonDisabled:r}=e,s=Object(T.a)(),o=We(),[l,c]=Object(a.useState)({groupSetOnly:!1,membersOnly:!1});Object(a.useEffect)((()=>{l.groupSetOnly&&l.membersOnly?(r(!1),n(W.xb.GroupsAndMembers)):l.groupSetOnly?(r(!1),n(W.xb.Groups)):l.membersOnly?(r(!1),n(W.xb.Members)):r(!0)}),[l]);return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:o.radioGroup},i.a.createElement(j.CheckboxGroup,{id:"id_fields_to_include",legendVariant:"h2",legendText:s("course.groupWorkspace.exportGroupSet.fieldsToInclude"),name:"Fields_To_Include"},i.a.createElement(D.AnalyticsFormControlLabel,{analyticsId:`${t}.label.group-only`,htmlFor:"group_set_only_id",value:W.xb.Groups,control:i.a.createElement(D.AnalyticsCheckbox,{analyticsId:`${t}.checkbox.group-only`,onChange:(e,t)=>{c((e=>({...e,groupSetOnly:t})))},id:"group_set_only_id",name:"groupSetOnly"}),label:s("course.groupWorkspace.exportGroupSet.groupSetOnly")}),i.a.createElement(D.AnalyticsFormControlLabel,{analyticsId:`${t}.label.members-only`,htmlFor:"members_only_id",value:W.xb.Members,control:i.a.createElement(D.AnalyticsCheckbox,{analyticsId:`${t}.checkbox.members-only`,onChange:(e,t)=>{c((e=>({...e,membersOnly:t})))},id:"members_only_id",name:"membersOnly"}),label:s("course.groupWorkspace.exportGroupSet.membersOnly")}))),i.a.createElement("div",{className:o.radioGroup},i.a.createElement(D.AnalyticsRadioGroup,{analyticsId:t,id:"id_file_type",legendVariant:"h2",legendText:s("course.groupWorkspace.exportGroupSet.fileType"),name:"File_Type",value:"CSV"},i.a.createElement(D.AnalyticsFormControlLabel,{analyticsId:`${t}.label.csv`,htmlFor:"csv_id",value:"csv",control:i.a.createElement(D.AnalyticsRadio,{analyticsId:`${t}.radio.csv`,checked:!0,id:"csv_id",readOnly:!0}),label:s("course.groupWorkspace.exportGroupSet.csv")}))))};var Ye=n("n7/H"),Je=n("6Wru"),Ze=n("Gvux");const Qe=e=>{const{analyticsId:t,file:n,files:i,courseId:r,groupSetId:o,page:l,setPage:c,refreshFileList:d}=e,u=We(),{translate:m,formatDate:p}=Object(Je.a)(),h=Object(s.d)();return a.createElement(a.Fragment,null,a.createElement(j.ListItem,{key:n.fileName,className:u.fileContainer},a.createElement(D.AnalyticsLink,{analyticsId:`${t}.download-file`,href:n.downloadUrl,className:u.fileLink},a.createElement(Ze.DownloadFile,null),a.createElement("span",{className:u.fileDetail},a.createElement(j.ListItemText,{primary:n.fileName,secondary:m("course.groupWorkspace.exportGroupSet.createdDate",{date:p(n.dateCreated,Ye.ILocaleDateFormat.Short)})}))),a.createElement(D.AnalyticsIconButton,{analyticsId:`${t}.delete.icon`,onClick:()=>{try{h(E.V.groupSetExport.deleteFile(r,o,{fileName:n.fileName})).then((()=>{1===i.length&&0!==l?c((e=>e-1)):d()}))}catch(e){console.error(e)}},className:u.trashIconButton,"aria-label":m("components.directives.file-viewer.aria.deleteFile",{fileName:n.fileName})},a.createElement(v.Trash,null))))},Xe=[{field:"fileName",direction:W.Wb.Descending}],et=e=>{var t;const{analyticsId:n,courseId:r,groupSetId:o,page:l,setPage:c,pageSize:d}=e,u=We(),m=Object(T.a)(),p=Object(s.d)(),h=Object(s.e)((e=>E.Yb.groupSetExport.getExportGroupSet(e,r))),g=null===(t=null==h?void 0:h.byGroupSetId[o])||void 0===t?void 0:t.files,b=()=>{const e={paging:{limit:d,offset:l*d},sort:Xe};p(E.V.groupSetExport.getExportedFiles(r,o,e))};return Object(a.useEffect)((()=>{b()}),[l,r,o,Xe]),i.a.createElement(i.a.Fragment,null,(null==g?void 0:g.length)>0?i.a.createElement(j.List,null,g.map((e=>i.a.createElement(Qe,{key:e.fileName,file:e,analyticsId:n,files:g,courseId:r,groupSetId:o,page:l,setPage:c,refreshFileList:b})))):i.a.createElement("div",{className:u.noFileText},i.a.createElement("span",null,m("course.groupWorkspace.exportGroupSet.noFilesText"))))},tt=e=>{var t,n,r,o;const{courseId:l,groupSetId:c,courseName:d,isGroupSetDetailView:u}=e,m=Object(T.a)(),p=Me(),h=We(),g=Object(s.d)(),[b,f]=Object(a.useState)(!0),[v,S]=Object(a.useState)("create"),[C,k]=Object(a.useState)(W.xb.GroupsAndMembers),[w,O]=Object(a.useState)(0),A=m("create"===v?"course.groupWorkspace.exportGroupSet.exportFromGroups":"course.groupWorkspace.exportGroupSet.exportFile"),x=Object(s.e)((e=>E.Yb.groupSetExport.getExportGroupSet(e,l))),$=!!(null===(n=null===(t=null==x?void 0:x.byGroupSetId[c])||void 0===t?void 0:t.paging)||void 0===n?void 0:n.count)&&x.byGroupSetId[c].paging.count>7,N=(null===(o=null===(r=null==x?void 0:x.byGroupSetId[c])||void 0===r?void 0:r.paging)||void 0===o?void 0:o.count)?x.byGroupSetId[c].paging.count/7:1;Object(a.useEffect)((()=>{const e={type:Fe.c.ExportGroupSetPanelOpened,status:Fe.b.Success,pageTitle:A};Object(Fe.r)(e)}),[A]);const L=Object(a.useCallback)((()=>{y.Z.leavePeekState()}),[]),j=Object(a.useCallback)((()=>{f(!0),g(E.V.groupSetExport.exportGroupSet(l,c,{scope:C},u?"GROUP_SET_DETAIL_VIEW":"GROUPS_LIST_VIEW")),L()}),[C,l,c,u,L,g]);return i.a.createElement("div",{id:"export-group-set-panel"},i.a.createElement("div",{className:p.peekPanel},i.a.createElement("header",{className:Object(P.a)(p.peekPanelHeader,Object(Fe.m)()&&p.hideHeader)},i.a.createElement(I.BbPanelHeader,{smallHeaderTitle:d,type:I.BbPanelType.peek,analyticsId:"course.groups.export-group-set.header",title:A,navMenuAriaLabel:m("global.navigationMenu")})),i.a.createElement("div",{className:p.peekPanelTabsContainer},i.a.createElement(D.AnalyticsTabs,{value:v,className:p.peekPanelTabs,analyticsId:"course.groups.export-group-set.tabs"},i.a.createElement(D.AnalyticsTab,{label:m("course.groupWorkspace.exportGroupSet.createTab"),value:"create",className:p.tabButton,analyticsId:"course.groups.export-group-set.tabs.create",onClick:()=>S("create"),"aria-controls":"id-create-tab-panel",id:"id-create-tab"}),i.a.createElement(D.AnalyticsTab,{label:m("global.export"),value:"export",className:p.tabButton,analyticsId:"course.groups.export-group-set.tabs.export",onClick:()=>S("export"),"aria-controls":"id-export-tab-panel",id:"id-export-tab"})),i.a.createElement(qe.a,{panelId:"create"===v?"id-create-tab-panel":"id-export-tab-panel",ariaLabelledby:"create"===v?"id-create-tab":"id-export-tab"},"create"===v?i.a.createElement(Ke,{analyticsId:"course.groups.export-group-set.createTab",setSelectedFieldsToInclude:k,setIsPrimaryButtonDisabled:f}):i.a.createElement(et,{analyticsId:"course.groups.export-group-set.fileList",courseId:l,groupSetId:c,page:w,setPage:O,pageSize:7})))),"create"===v&&i.a.createElement("footer",{className:p.peekPanelFooter},i.a.createElement(I.BbPanelFooter,{primaryButtonProps:{onClick:j,disabled:b,text:m("course.groupWorkspace.exportGroupSet.exportFile"),id:"js-button-export"},secondaryButtonProps:{onClick:L,text:m("global.cancel")},analyticsId:"course.groups.export-group-set.footer"})),"export"===v&&$&&i.a.createElement("footer",{className:h.paginationFooter},i.a.createElement(F.I,{className:h.pagination,analyticsId:"course.groups.export-group-set.fileList",page:w,numberOfPages:N,onPageChange:e=>{O(e)}})))},nt=Object(j.makeStyles)((e=>Object(j.createStyles)({groupMembersListPanel:{position:"absolute",top:0,left:0,right:0,bottom:0},panel:{display:"flex",flexDirection:"column",alignItems:"stretch",height:"100vh"},header:{flex:"0 1 auto","& .ms-Panel-titles-container":{[e.breakpoints.up("sm")]:{position:"relative",left:e.spacing(3)}}},content:{flex:"1 1 auto",overflowY:"auto",padding:e.spacing(2),[e.breakpoints.up("sm")]:{padding:e.spacing(3)}},footer:{backgroundColor:`${e.palette.background.default}`},groupMemberListItem:{borderBottom:`1px solid ${e.palette.border.main}`,borderRight:"0px",borderLeft:"0px",borderTop:"0px"},spinnerContainer:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%"},pagination:{margin:"12px 0"},userNameStyles:{fontWeight:e.typography.fontWeightBold},membersSearchBoxContainer:{borderBottom:`1px solid ${e.palette.border.main}`,padding:"12px 0"},membersSearchBox:{[e.breakpoints.up("sm")]:{margin:0,width:"100%"}},noResultsMessage:{marginTop:"5px"}}))),at=e=>{const{memberships:t,users:n,courseId:a}=e,r=Object(T.a)(),o=nt(),l=Object(L.h)("global.course","global.organization"),c=Object(s.e)((e=>E.Yb.courseMembership.getMembershipPermissions(e,a))),d=t.map((e=>{var t;const{role:a,userId:s}=e;if(!s)return null;const d=n[s],u=E.a.hasAccommodations(e,c);return i.a.createElement(j.ListItem,{key:s,className:o.groupMemberListItem},i.a.createElement(j.ListItemAvatar,null,i.a.createElement(D.AnalyticsAvatar,{size:"medium",src:null===(t=d.avatar)||void 0===t?void 0:t.permanentUrl,alt:r("courseCore.components.courseInstructors.avatarAltText",{user:d})})),i.a.createElement(j.ListItemText,{primary:i.a.createElement(X.e,{ariaHidden:!0,format:Ye.ILocaleUsernameFormat.Short,user:d,subtext:r(l(`global.course.role.${a}`)),showPronunciation:!0,showPronouns:!0,showAccommodation:u,userNameStyles:o.userNameStyles})}))}));return i.a.createElement(j.List,null,d)};var it=n("9EWH");const rt=(e,t)=>Object(it.b)(e,(e=>{switch(e.paging||(e.paging={}),t.type){case"change.page":e.paging.offset=t.offset;break;case"search.text":e.filter={...e.filter,searchString:t.searchString},e.paging.offset=0}}));const st=e=>{var t;const{viewPaging:n,page:a,onPageChange:r,analyticsId:s,pageSize:o}=e,l=n?(c=null!==(t=n.count)&&void 0!==t?t:1,d=o,Math.max(1,Math.ceil(c/d))):1;var c,d;const u=Object(j.useMediaQuery)((e=>e.breakpoints.down("xs"))),m=nt();return i.a.createElement("div",{className:m.footer},i.a.createElement(F.I,{className:m.pagination,analyticsId:s,page:a,numberOfPages:l,onPageChange:r,compact:u}))},ot=e=>{const{onSearchBoxTextChange:t,analyticsId:n,membershipsCount:r,isLoading:s}=e,o=Object(T.a)(),l=nt(),[c,d]=Object(a.useState)(),u=e=>{d(e),t(e)};return i.a.createElement("div",{className:l.membersSearchBoxContainer},i.a.createElement(F.M,{"aria-describedby":"noResultsMessage",inputId:"group-members-list-search-input",analyticsId:n,className:l.membersSearchBox,label:o("course.groupWorkspace.groupMembers.search"),onChange:u,onClear:()=>{u("")},value:c}),0===r&&!s&&i.a.createElement(j.Typography,{variant:"body1",id:"noResultsMessage",role:"alert",className:l.noResultsMessage},o("course.groupWorkspace.groupMembers.noSearchResult")),!!r&&!s&&i.a.createElement(D.AnalyticsOffScreenAnnouncement,{type:"polite",role:"status",changeTrigger:1,message:s?null:0===(null==c?void 0:c.length)?o("course.groupWorkspace.groupMembers.searchCleared",{oldResultsCount:r}):0===r?o("course.groupWorkspace.groupMembers.noSearchResult"):r&&r>0?o("course.groupWorkspace.groupMembers.resultsFound",{resultsCount:r}):null,analyticsId:n}))};var lt=n("kNOQ"),ct=n("Ajje");const dt="course.groups.group-members-list",ut=e=>{var t,n,r;const{courseId:o}=e,l=Object(s.e)((e=>E.Yb.app.getLocation(e).queryParams.groupId)),c=Object(s.e)((e=>E.Yb.app.getLocation(e).queryParams.contentId)),d=!!c,{group:u,groupSet:m,loadingStatus:p}=Object(L.q)(o,l,d);if((d&&!(null==u?void 0:u.id)||!d&&!(null==u?void 0:u.groupSetId))&&p===ct.a.Loaded)throw y.Z.leavePeekState(),new Error(`Group ${l} not found.`);const h=null===(t=Object(s.e)((e=>E.Yb.content.getContentById(e,c))))||void 0===t?void 0:t.title,g=d?h:null==m?void 0:m.title,b={courseId:o,filter:{searchString:"",roleBucket:[W.y.Taking],groupId:[l]},paging:{limit:20,offset:0},sort:[{field:W.gb.GivenName,direction:W.Wb.Ascending},{field:W.gb.FamilyName,direction:W.Wb.Ascending}]},[f,v]=Object(a.useReducer)(rt,b),{memberships:S,users:C,view:k}=Object(L.g)(f),w=nt(),O=Object(T.a)(),A=Object(lt.a)((e=>{v({type:"search.text",searchString:e})}),500);return i.a.createElement("div",{className:w.groupMembersListPanel},i.a.createElement("div",{className:w.panel},i.a.createElement("header",{className:w.header},i.a.createElement(I.BbPanelHeader,{smallHeaderTitle:g,type:I.BbPanelType.peek,analyticsId:"course.groups.group-members-list.header",title:null==u?void 0:u.title,navMenuAriaLabel:O("global.navigationMenu")})),i.a.createElement("div",{className:w.content},i.a.createElement(ot,{onSearchBoxTextChange:A,analyticsId:dt,membershipsCount:S.length,isLoading:!k||k.isLoading}),(!k||k.isLoading)&&i.a.createElement("div",{className:w.spinnerContainer},i.a.createElement(D.AnalyticsCircularProgress,{ariaLabel:O("global.loading"),size:"medium"})),i.a.createElement(at,{memberships:S,users:C,courseId:o})),i.a.createElement(st,{viewPaging:null==k?void 0:k.paging,page:(null!==(r=null===(n=f.paging)||void 0===n?void 0:n.offset)&&void 0!==r?r:0)/20,onPageChange:e=>{v({type:"change.page",offset:20*e})},analyticsId:dt,pageSize:20})))},mt=e=>{const{tooltipTitle:t,tooltipAnalyticsId:n}=e;return a.createElement(D.AnalyticsTooltip,{placement:"top",title:t,"aria-label":t,analyticsId:n},a.createElement(v.Upload,null))},pt=e=>{const{tooltipTitle:t,tooltipAnalyticsId:n}=e;return a.createElement(D.AnalyticsTooltip,{placement:"top",title:t,"aria-label":t,analyticsId:n},a.createElement(v.Download,null))};n.d(t,"o",(function(){return gt})),n.d(t,"p",(function(){return bt})),n.d(t,"m",(function(){return ft})),n.d(t,"f",(function(){return B})),n.d(t,"a",(function(){return R})),n.d(t,"i",(function(){return je})),n.d(t,"n",(function(){return A.f})),n.d(t,"c",(function(){return A.a})),n.d(t,"h",(function(){return ze})),n.d(t,"g",(function(){return Ve})),n.d(t,"d",(function(){return tt})),n.d(t,"e",(function(){return ut})),n.d(t,"k",(function(){return mt})),n.d(t,"b",(function(){return pt})),n.d(t,"j",(function(){return d}));const ht=(e,t,n,i,s,l)=>{let c=n;null==n&&"undefined"!=typeof window&&window.location.search.match("setLang=")&&(c=window.location.search.match(/setLang=([^$&]+)/)[1]),r.render(a.createElement(D.AnalyticsJssThemeProvider,{isRtl:l},a.createElement(o.a,{locale:c,babelfishInstance:i,babelfishFormatInstance:s,bundlesToLoad:["group-workspace/locales/[locale]/group-workspace.json"],isRtl:l},a.createElement("div",null,e))),t)},gt=(e,t,n)=>{ht(a.createElement(s.a,{store:t},a.createElement(me,{courseId:n.courseId,contentId:n.contentId,contentName:n.contentName,userId:n.userId,root:e,onGroupJoined:n.onGroupJoined,babelfishFormatInstance:n.babelfishFormatInstance,locale:n.locale,analyticsId:"selfEnrollList"})),e,n.locale,n.babelfishInstance,n.babelfishFormatInstance,n.isRtl)},bt=(e,t,n)=>{ht(a.createElement(s.a,{store:t},a.createElement($e,{courseId:n.courseId,contentName:n.contentName,userId:n.userId,root:e,onGroupJoined:n.onGroupJoined,babelfishFormatInstance:n.babelfishFormatInstance,locale:n.locale,analyticsId:"selfEnrollList"})),e,n.locale,n.babelfishInstance,n.babelfishFormatInstance,n.isRtl)},ft=e=>{r.unmountComponentAtNode(e)},vt={renderGroupSetListPanelComponent:(e,t,n,i,r,o,l,c,d)=>{ht(a.createElement(s.a,{store:t},a.createElement(ne,{courseId:l,root:e,openGroupSetDetailPanel:d,featuresConfig:c,analyticsId:"groupSetList"})),e,n,i,r,o)},renderContentGroupSelfEnrollmentPanelComponent:gt,renderCourseGroupSelfEnrollmentPanelComponent:bt,destroyComponent:ft};t.l=vt},hWgD:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n("Llzl"),i=n("0JpG"),r=n("TnpK");const s="ultra.course.partner-tool.router";a.module(s,[i.moduleName,r.b]).config([r.c,e=>{e.peekState("partner-tool",{abstract:!0,url:"/partners/:partnerId"}).peekState("partner-tool.tool",{url:"/tools/:toolType?partnerParentId&mode",resolve:{translations:[i.serviceName,e=>e.loadBundle("features/course/content-market/content-market")]},params:{partnerTitle:"",toolHref:"",returnState:null},panelClass:"full",require:()=>Promise.all([n.e(31),n.e(161),n.e(670)]).then(n.bind(null,"HgnN")),pageTitle:"course.partnerTool.partnerTool"})}])},hkqm:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return u}));var a=n("Llzl"),i=n("H8CZ"),r=n("0JpG"),s=n("3FFP"),o=n("GbAM"),l=n("n1KZ"),c=n("lBPC");const d="ultra.services.toast",u="toast";class m{constructor(e,t,n,a,i){this.$compile=e,this.$q=t,this.$rootScope=n,this.$timeout=a,this.localize=i,this.toastQueue=[]}show(e){if(!e)throw new Error("args is required");if(!e.messageKey)throw new Error("messageKey is required");this.setUpToast({bundlePromise:e.bundle?this.localize.loadBundle(e.bundle):this.$q.when(),createScope:()=>{const t=this.$rootScope.$new(!0);return t.message=this.localize.translateSync({locale:e.locale||this.localize.getLocale(t),key:e.messageKey,params:e.translationParams,noWrap:!0,noEscape:!0}),t.shortMessage=e.shortMessageKey&&this.localize.translateSync({locale:e.locale||this.localize.getLocale(t),key:e.shortMessageKey,params:e.translationParams,noWrap:!0,noEscape:!0}),t.icon=e.icon||"icon-alert-triangle",t.toastClass=e.toastClass,t.toastStatus=e.toastStatus,t},triggerToastClose:(t,n,a,i)=>{n.$root.$broadcast(o.b,n.message);const r=()=>{if(n.isActive){let n=e.durationMS||m.DEFAULT_DISPLAY_MS;this.toastQueue.length>1&&(n=Math.min(m.RUSH_DISPLAY_MS,n)),(new Date).getTime()-t.startTime>=n?i():this.$timeout(r,1e3,!1)}};r(),this.$timeout((()=>{a.addClass("is-active")}),0,!1)},onCloseToast:this.closeToast,template:l})}showLoading(e){if(!e)throw new Error("args is required");if(!e.trayId)throw new Error("messageKey is required");e.promise.then((()=>e.promise.done=!0));return this.setUpToast({bundlePromise:this.$q.when(),createScope:()=>{const t=this.$rootScope.$new(!0);return t.trayId=e.trayId,t.trayLocalizationKeysPrefix=e.trayLocalizationKeysPrefix,t},triggerToastClose:(t,n,a,i,r)=>{e.promise.then((()=>{i()}),(()=>{r()})),n.$root.$broadcast(s.a.LoadMoreResults.eventName,e.trayId,e.promise,null,!0,e.delayTime)},template:c,footerCss:e.footerCss,promise:e.promise})}setUpToast(e){const t=this.$q.defer(),n=this.toastQueue[this.toastQueue.length-1]||this.$q.when();let i;return this.toastQueue.push(t.promise),this.$q.all([n,e.bundlePromise]).then((()=>{if(t.startTime=(new Date).getTime(),e.promise&&e.promise.done)return void t.resolve();const n=e.createScope();let r;const s=()=>{e.onCloseToast&&e.onCloseToast(n,r),this.cleanUpToast(t,n,r)};return i=()=>{this.cancelToast(t,n,r)},n.isActive=!0,n.toastClicked=()=>{s()},r=this.$compile(e.template)(n),a.element(document.body).append(r),r.addClass(e.footerCss),e.triggerToastClose(t,n,r,s,i),t.promise})).then((()=>{this.toastQueue.shift()})),()=>i&&i()}closeToast(e,t){e.isActive&&t.removeClass("is-active")}cleanUpToast(e,t,n){t.isActive&&(t.isActive=!1,i.b(n,(()=>{this.cancelToast(e,t,n)})))}cancelToast(e,t,n){e.resolve(),n.remove(),t.$destroy()}}m.DEFAULT_DISPLAY_MS=6e3,m.RUSH_DISPLAY_MS=3e3,m.$inject=["$compile","$q","$rootScope","$timeout",r.serviceName],a.module(d,[r.moduleName,s.b]).service(u,m)},hlSw:function(e,t,n){"use strict";var a=n("nsO7"),i=n("Llzl"),r=n("nYZ0"),s=n("Qbdf"),o=n("36CG"),l=n("oi1r"),c=n("P2dS"),d=n("0JpG"),u=n("pjml"),m=n("TnpK"),p=n("zGdY"),h=n("ZQFV"),g=n("nmzr");class b{}b.currentColumn=[m.d,s.d,"currentContent",(e,t,n)=>{if(n){const a=e.params.columnId||e.nextParams.columnId;return t.gradebook.columns.$buildRaw(n.getAssociatedGradingColumn(a)).$asPromise().then((e=>null==e.rubricAssociations?e.$fetch({expand:"associatedRubrics,externalGrade"}).$asPromise().then((e=>e.$asPromise())):e.$asPromise()))}const a=e.nextParams.columnId;if(a&&a!==u.C.CREATE_COLUMN_ID)return t.gradebook.columns.$find(a,{expand:"associatedRubrics,externalGrade"}).$asPromise()}],b.assignmentContent=[s.d,m.d,o.g,(e,t,n)=>{const a=t.nextParams.contentId?t.nextParams.contentId:t.nextParams.id;if(a){const t="alignedGoals,assignedGroups,isGroupContent,permissions",i=e.contents.$find(a,{expand:t});return n.setCurrentContent(i),i.$asPromise()}}],b.assessmentContent=[s.d,"$q",d.serviceName,r.f,m.d,l.b,c.c,o.g,(e,t,n,r,s,o,l,c)=>{if(s.nextParams.contentId!==u.p.CREATE_CONTENT_ID)return r.getContentInContentTree(r.findRootNode(e,u.p.ContentRootNode.ROOT),e.id,s.nextParams.contentId).then((e=>(c.setCurrentContent(e.content),e.content.$asPromise())));const d=t.defer();return o.loadSchemas(e).then((t=>{r.getOrMakeContentInContentTree(r.findRootNode(e,u.p.ContentRootNode.ROOT),e.id,void 0,s.nextParams.parentId,s.nextParams.positionBefore,s.nextParams.positionAfter).then((r=>{const o=r.content;c.setCurrentContent(o);const m=a.find(t,(e=>e.scaleType===p.Ub.Score)),g=s.nextParams.gradebookCategoryId;let b=null;l.getOrLoadCategoriesForCourse(e.id).then((e=>{b=a.find(e,(e=>e.id===g))})).then((()=>{let t;o.courseId=e.id,o.contentHandler=u.p.ContentHandler.TestLink,o.body={},t=b?b.isUserDefined?"custom":b.title:"test";const a="course.grades.gradebook-item.title.default."+t,r=b&&b.isUserDefined?{today:new Date,title:b.title}:{today:new Date};o.title=n.translateSync({locale:e&&e.locale,key:a,params:r,noWrap:!0}),o.setupAssessmentContentDetail(m.id,b),o.setVisibility(p.w.Hidden),o.getAssociatedGradingColumn().visible=!1,o.getAssociatedGradingColumn().possible=h.O.GRADE_DEFAULT_POINTS,t!==p.W.Test&&"true"!==s.nextParams.autoPostGrades||(o.getAssociatedGradingColumn().autoPostGrades=!0),o.ui.hasConversationAttached=!1,o.permissions={edit:!0},o.$save().$asPromise().then((()=>{d.reject(),s.go(s.next.name,i.extend(s.nextParams,{contentId:o.id,gradeitemView:"details",isCreateState:!0,parentId:void 0,positionBefore:void 0,positionAfter:void 0}))}))}))}))})),d.promise}],b.currentContent=[s.d,"$injector",m.d,"translations",(e,t,n)=>-1===n.next.name.indexOf(g.w.GRADEBOOK_ITEM_ASSESSMENT)&&-1===n.next.name.indexOf("gradebook-item.scorm-submissions")?t.invoke(b.assignmentContent,null,{currentCourse:e}):t.invoke(b.assessmentContent,null,{currentCourse:e})],b.nullContent=[()=>null],t.a=b},hlUp:function(e,t){e.exports='<div id="aria-live-polite-region-1" class="sr-only" role="status" aria-live="polite"></div>\n<div id="aria-live-polite-region-2" class="sr-only" role="status" aria-live="polite"></div>\n<div id="aria-live-assertive-region-1" class="sr-only" role="alert" aria-live="assertive" aria-atomic="true"></div>\n<div id="aria-live-assertive-region-2" class="sr-only" role="alert" aria-live="assertive" aria-atomic="true"></div>'},hqh6:function(e,t,n){"use strict";n("t3ZG"),n("xjJw");var a=n("nsO7"),i=n("71td"),r=n("Llzl"),s=n("0JpG"),o=n("WShm"),l=n("oQrK"),c=n("XGja"),d=n("+4Px"),u=n("wgY5"),m=n("V6ed");n.d(t,"a",(function(){return p}));const p="ultra.components.directives.datepicker";class h{constructor(e,t,n,a,i,r,s,o){this.scope=e,this.element=t,this.attrs=n,this.model=a,this.$transclude=i,this.bbLocalize=r,this.bbValidateDate=s,this.$compile=o,this.attrs.firstDayOfWeek?this.scope.$watch(`${this.attrs.firstDayOfWeek}`,(e=>{void 0!==e&&(this.weekStart=e,this.initialize())})):this.initialize()}initialize(){const e=this.bbLocalize.getLocale(this.scope);if(this.localeString=null,null==this.attrs.bbValidateDate){this.attrs.bbValidateDate="short";this.bbValidateDate[0].compile(this.element,this.attrs,void 0)(this.scope,this.element,this.attrs,this.model,this.$transclude)}if(!l.a.detect().desktop()&&window.Modernizr.inputtypes.date){if(this.setupNativeDatePicker(),this.attrs.$set("type","date"),this.element.removeAttr("placeholder"),this.attrs.bbTranslateAttrs){const e=this.scope.$eval(this.attrs.bbTranslateAttrs);e.placeholder&&(delete e.placeholder,this.attrs.bbTranslateAttrs=JSON.stringify(e))}}else{this.bbLocalize.loadBundle("components/directives/datepicker").then((()=>{if(null==this.attrs.placeholder&&this.attrs.$set("placeholder",this.bbLocalize.translateSync({locale:e,key:"components.directives.datepicker.dateFormatPlaceholder"})),this.model.$modelValue){const e=this.bbLocalize.formatDateSync(this.model.$modelValue,s.ILocaleDateFormat.Short,this.scope);this.element.val(e)}const t=this.bbLocalize.translateSync({locale:e,key:"components.directives.datepicker.ariaLabel.datepickerButton"});this.widgetButton=this.$compile(`<button class="open-datepicker super-clear js-datepicker-toggle-btn" aria-label="${t}" type="button"><bb-svg-icon size="small" icon="calendar"></bb-svg-icon></button>`)(this.scope),this.updateReadOnlyState(),this.widgetButton.on("focus",(()=>{const e=document.querySelector('[name="due-date"]');(null==e?void 0:e.hasAttribute("disabled"))&&(null==e?void 0:e.getAttribute("disabled"))&&this.widgetButton.blur()})),this.attrs.$observe("disabled",(e=>{this.updateReadOnlyState()})),this.attrs.$observe("readonly",(e=>{this.updateReadOnlyState()}))})),this.localeString=this.bbLocalize.preProcessFormatterLocale(e).replace(/_/g,"-"),3===this.localeString.split("-").length&&(this.localeString=this.localeString.split("-").filter(((e,t)=>t<2)).join("-")),["zh-TW","zh-CN","rs-latin","pt-BR","nl-BE"].indexOf(this.localeString)<0&&("en-SC"===this.localeString?this.localeString="ar":"ko-KR"===this.localeString?this.localeString="kr":"nb-NO"===this.localeString||"nn-NO"===this.localeString?this.localeString="no":this.localeString=this.localeString.substring(2,0)),this.attrs.$set("type","text");const t=this.bbLocalize.isRTL(this.scope);if(this.attrs.container){const e=i(this.attrs.container);e.length&&(this.container=e)}this.attrs.orientation&&(this.orientation=this.attrs.orientation);const a={todayHighlight:!0,beforeShowDay:e=>({content:this.bbLocalize.formatNumberSync(e.getDate(),this.scope)}),autoclose:!0,forceParse:!1,container:this.container,keyboardNavigation:!1,language:this.localeString,orientation:this.orientation,weekStart:this.weekStart,rtl:t,showOnFocus:!1,startDate:new Date("1900-01-01"),templates:{leftArrow:'<div class="icon-arrow-left"></div>',rightArrow:'<div class="icon-arrow-right"></div>'}};"en"===this.localeString?this.setupBootstrapDatePicker(a):(this.localeString="bootstrap-datepicker."+this.localeString,n.e(567).then((()=>{n("OfSV")("./"+this.localeString).then((()=>{this.setupBootstrapDatePicker(a)}))}).bind(null,n)).catch((()=>{}))),this.scope.$on("$destroy",(()=>{this.element.datepicker("destroy")}))}}setupNativeDatePicker(){this.scope.$watch((()=>this.model.$modelValue),(e=>{e&&(this.element.val(u(e).format("YYYY-MM-DD")),this.element.triggerHandler("change"),this.model.$render())}))}setupBootstrapDatePicker(e){this.element.datepicker(e).data("datepicker");this.scope.$watch((()=>this.model.$modelValue),(()=>{this.updateDatepicker()})),this.element.on("changeDate",(e=>{if(e.date){const t=this.bbLocalize.formatDateSync(e.date,s.ILocaleDateFormat.Short,this.scope);this.element.val(t),this.element.triggerHandler("change"),this.model.$render()}}));const t=this.element.data("datepicker");t.isInput=!1,this.element.unbind("keyup",t._events[0][1].keyup),this.element.on("show changeMonth changeYear",(e=>{this.datepickerDropdownElement=i(".datepicker-dropdown"),this.iconArrowLeft=this.datepickerDropdownElement.find(".icon-arrow-left"),this.iconArrowRight=this.datepickerDropdownElement.find(".icon-arrow-right"),this.openDatepickerButton=this.element.siblings("button.open-datepicker");const t=[];this.datepickerDropdownElement.find("td.day").not(".old").not(".new").each((function(){t.push(i(this))})),this.currentMonthDays=t,this.datepickerDropdownElement.on("keydown",(e=>{e.keyCode===d.g&&(this.openDatepickerButton.focus(),this.element.datepicker("hide"))})),this.iconArrowLeft.add(this.iconArrowRight).on("blur",(()=>{this.datepickerDropdownElement.find(".datepicker-switch").attr("aria-hidden","true")})),this.iconArrowLeft.off("keydown").on("keydown",(e=>{e.preventDefault(),e.keyCode!==d.g&&e.stopPropagation(),e.keyCode===d.t||e.keyCode===d.f?(this.datepickerDropdownElement.find(".datepicker-switch").attr("aria-hidden","false"),this.goToPreviousMonth()):e.keyCode===d.u&&(e.shiftKey?(this.openDatepickerButton.focus(),this.element.datepicker("hide")):this.focusElement(this.iconArrowRight))})),this.iconArrowRight.off("keydown").on("keydown",(e=>{e.preventDefault(),e.keyCode!==d.g&&e.stopPropagation(),e.keyCode===d.t||e.keyCode===d.f?(this.datepickerDropdownElement.find(".datepicker-switch").attr("aria-hidden","false"),this.goToNextMonth()):e.keyCode===d.u&&(e.shiftKey?this.focusElement(this.iconArrowLeft):this.focusDefaultDay())})),this.updateAriaRolesAndStates(this.getViewDate(),e.date),this.setUpKeyboardNavigation(),"show"===e.type&&(this.datepickerDropdownElement.find("tfoot").remove(),this.datepickerDropdownElement.find(".datepicker-switch").attr("aria-hidden","true"),this.datepickerDropdownElement.on("keyup",(e=>{e.stopPropagation()})),this.focusDefaultDay())}))}updateDatepicker(){const e=this.model.$modelValue,t=this.element.data("datepicker");if(r.isDate(e)&&t){const n=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())),a=t.getUTCDate();a&&a.getTime()===n.getTime()||(t.dates.replace([n]),t.viewDate=n,t.fill())}}updateReadOnlyState(){this.element.hasClass("show-calendar-icon")||!this.element.prop("disabled")&&!this.element.prop("readonly")?this.element.next()!==this.widgetButton&&(this.widgetButton.click((e=>{this.element.datepicker("show")})),this.element.after(this.widgetButton)):this.widgetButton.remove()}focusDefaultDay(){const e=a.find(this.currentMonthDays,(e=>e.hasClass("active"))),t=null!=e?e:this.currentMonthDays[0];this.focusElement(t)}focusPreviousDay(){const e=this.getActiveElementIndex();0===e?(this.goToPreviousMonth(),this.focusLastDayOfMonth()):this.focusElement(this.currentMonthDays[e-1])}focusNextDay(){const e=this.getActiveElementIndex();e<this.currentMonthDays.length-1?this.focusElement(this.currentMonthDays[e+1]):(this.goToNextMonth(),this.focusElement(this.currentMonthDays[0]))}focusSameWeekdayOfPreviousWeek(){const e=this.getActiveElementIndex();if(e-7>=0)this.focusElement(this.currentMonthDays[e-7]);else{const t=7-e;this.goToPreviousMonth(),this.focusElement(this.currentMonthDays[this.currentMonthDays.length-t])}}focusSameWeekdayOfNextWeek(){const e=this.getActiveElementIndex();if(e+7<this.currentMonthDays.length)this.focusElement(this.currentMonthDays[e+7]);else{const t=e+7-this.currentMonthDays.length;this.goToNextMonth(),this.focusElement(this.currentMonthDays[t])}}focusSameDayOfPreviousMonth(){this.focusSameDayOfAdjacentMonth(-1)}focusSameDayOfNextMonth(){this.focusSameDayOfAdjacentMonth(1)}focusSameDayOfAdjacentMonth(e){const t=this.getActiveElementIndex();e>0?this.goToNextMonth():this.goToPreviousMonth(),null!=this.currentMonthDays[t]?this.focusElement(this.currentMonthDays[t]):this.focusLastDayOfMonth()}focusSameDayOfPreviousYear(){this.focusSameDayOfAdjacentYear(-1)}focusSameDayOfNextYear(){this.focusSameDayOfAdjacentYear(1)}focusSameDayOfAdjacentYear(e){const t=this.getActiveElementIndex();e>0?this.goToNextYear():this.goToPreviousYear(),null!=this.currentMonthDays[t]?this.focusElement(this.currentMonthDays[t]):this.focusLastDayOfMonth()}focusFirstDayOfMonth(){this.focusElement(this.currentMonthDays[0])}focusLastDayOfMonth(){this.focusElement(this.currentMonthDays[this.currentMonthDays.length-1])}focusElement(e){e.attr("tabindex","-1").focus()}getViewDate(){return this.element.data("datepicker").viewDate}setViewDate(e){this.element.data("datepicker").viewDate=e}getActiveElementIndex(){return a.findIndex(this.currentMonthDays,(e=>e.attr("id")===i(document.activeElement).attr("id")))}goToPreviousMonth(){this.moveMonth(-1)}goToNextMonth(){this.moveMonth(1)}goToPreviousYear(){this.moveYear(-1)}goToNextYear(){this.moveYear(1)}moveMonth(e){const t=this.getViewDate();this.setViewDate(this.element.datepicker("moveMonth",t,e)),this.element.datepicker("fill"),this.element.trigger("changeMonth")}moveYear(e){const t=this.getViewDate();this.setViewDate(this.element.datepicker("moveYear",t,e)),this.element.datepicker("fill"),this.element.trigger("changeYear")}getAdjustedDate(e){const t=new Date(parseInt(e,10));return new Date(t.getTime()+60*t.getTimezoneOffset()*1e3)}updateAriaRolesAndStates(e,t){const n=this.bbLocalize.getLocale(this.scope),a=this.bbLocalize.translateSync({locale:n,key:"components.directives.datepicker.ariaLabel.container"});this.datepickerDropdownElement.attr("role","application").attr("aria-label",a),this.datepickerDropdownElement.find("table").attr("role","grid").attr("aria-label",a);const r=this.bbLocalize.translateSync({locale:n,key:"components.directives.datepicker.ariaLabel.previousMonthButton"});this.datepickerDropdownElement.find(".icon-arrow-left").attr("aria-label",r).attr("role","button");const s=this.bbLocalize.translateSync({locale:n,key:"components.directives.datepicker.ariaLabel.nextMonthButton"});this.datepickerDropdownElement.find(".icon-arrow-right").attr("aria-label",s).attr("role","button"),this.datepickerDropdownElement.find(".datepicker-switch").attr("aria-live","assertive").attr("aria-atomic","true"),this.datepickerDropdownElement.find("thead th").attr("role","gridcell"),this.datepickerDropdownElement.find("table").removeAttr("aria-activedescendant");const o=u(e),l=u(o).subtract({months:1}),c=u(o).add({months:1});this.datepickerDropdownElement.find("td").each(((e,t)=>{const n=i(t);n.attr("role","gridcell");const a=t.getAttribute("data-date");let r,s;s=n.hasClass("old")?l.toDate():n.hasClass("new")?c.toDate():o.toDate(),r=a?this.getAdjustedDate(a):new Date(s.getFullYear(),s.getMonth(),+n.text());const d=u(r);if(Number.isNaN(d.date()))return;n.attr("aria-label",this.bbLocalize.formatDateSync(d.toDate()));const m="datepicker-td-"+d.unix();n.attr("id",m),n.hasClass("active")&&(n.attr("aria-selected","true"),this.datepickerDropdownElement.find("table").attr("aria-activedescendant",m))}))}setUpKeyboardNavigation(){this.currentMonthDays.forEach((e=>{e.off("keydown").on("keydown",(e=>{switch(e.preventDefault(),e.keyCode!==d.f&&e.keyCode!==d.g&&e.stopPropagation(),m.a.enableFocusOutline(),e.keyCode){case d.j:this.bbLocalize.isRTL()?this.focusNextDay():this.focusPreviousDay();break;case d.s:this.bbLocalize.isRTL()?this.focusPreviousDay():this.focusNextDay();break;case d.v:this.focusSameWeekdayOfPreviousWeek();break;case d.d:this.focusSameWeekdayOfNextWeek();break;case d.q:e.ctrlKey||e.altKey?this.focusSameDayOfPreviousYear():this.focusSameDayOfPreviousMonth();break;case d.p:e.ctrlKey||e.altKey?this.focusSameDayOfNextYear():this.focusSameDayOfNextMonth();break;case d.i:this.focusFirstDayOfMonth();break;case d.e:this.focusLastDayOfMonth();break;case d.u:e.shiftKey?this.focusElement(this.iconArrowRight):(c.b(null,this.openDatepickerButton),this.element.datepicker("hide"));break;case d.f:case d.t:this.currentMonthDays[this.getActiveElementIndex()].click(),this.openDatepickerButton.focus()}}))}))}}h.$inject=["scope","element","attrs","model","$transclude",s.serviceName,o.a+"Directive","$compile"];class g{constructor(e){this.$injector=e,this.priority=1,this.restrict="A",this.require="ngModel",this.link=(e,t,n,a,i)=>{e.datepicker=this.$injector.instantiate(h,{scope:e,element:t,attrs:n,model:a,$transclude:i})}}}g.$inject=["$injector"],r.module(p,[s.moduleName,o.b]).directive("bbDatePicker",["$injector",e=>e.instantiate(g)])},i8dz:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return r}));n("KCTV");var a=n("Llzl"),i=n("+4Px");const r="ultra.directives.bbFoundationDropdownClose",s="bbFoundationDropdownClose";class o{constructor(){this.restrict="A",this.link=(t,n,a)=>{const r="keyup."+s;n.on("click",(t=>{const a=e(t.target);if(a.closest("[data-dropdown]").length<=0&&(a.closest(".f-dropdown").length<=0||a.closest(".f-dropdown a").length>0)){const t=n.find(".f-open-dropdown");if(t.length&&t.foundation("dropdown","close",t),window.top!==window){const t=e(window.parent.document).find(".f-open-dropdown");t.foundation("dropdown","close",t)}}})),n.on("scroll",(t=>{const n=e(t.target);n.hasClass("f-dropdown")||0!==n.parents(".f-dropdown").length||e(".f-open-dropdown").each((function(){e(this).foundation("dropdown","close",e(this))}))})),e("body").on(r,(t=>{if(t.keyCode===i.u){const t=n.find(".f-open-dropdown"),a=e(document.activeElement).is(".f-open-dropdown"),i=e(document.activeElement).parents(".f-open-dropdown").length>0;a||i||t.foundation("dropdown","close",t)}})),t.$on("$destroy",(()=>{n.off(),e("body").off(r)}))}}}a.module(r,[]).directive(s,["$injector",e=>e.instantiate(o)])}).call(this,n("71td"))},iAaI:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n("Llzl"),i=n("Sa5G"),r=n("0JpG"),s=n("TnpK");const o="ultra.base.admin.theme.routes";a.module(o,[r.moduleName,s.b]).config([s.c,e=>{e.peekState("colorSelection",{systemEntitlement:i.s.ViewAdmin,url:"/theme/:themeId/colorSelection",require:()=>n.e(642).then(n.bind(null,"xCEN")),pageTitle:"base.admin.theme.colorSelection.title",panelClass:"full"})}])},iVgd:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return r}));var a=n("Llzl"),i=n("+4Px");const r="ultra.directives.accessibility.keyboardClick";class s{constructor(){this.restrict="A",this.link=(t,n,a)=>{n.on("keyup",(t=>{const n=e(t.target),a=n.closest(".react-container").length>0,r="LI"===n.prop("tagName")&&"option"===n.attr("role")&&"listbox"===n.closest("UL").attr("role");(t.keyCode!==i.f||a||"file"===n.attr("type")||"INPUT"===n.prop("tagName")&&("INPUT"!==n.prop("tagName")||"checkbox"!==n.prop("type"))||"BUTTON"===n.prop("tagName")||"BODY"===n.prop("tagName")||"A"===n.prop("tagName")&&n.attr("href")||r)&&(t.keyCode!==i.t||a||"A"!==n.prop("tagName")&&("DIV"!==n.prop("tagName")||"button"!==n.attr("role")))||n.trigger("click")}))}}}a.module(r,[]).directive("bbKeyboardClick",["$injector",e=>e.instantiate(s)])}).call(this,n("71td"))},imME:function(e,t,n){},"iwI+":function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n("Llzl"),i=n("0JpG"),r=n("w9Zy"),s=n("TnpK"),o=n("0wat");const l="ultra.base.tools.routes";a.module(l,[s.b]).config([s.c,e=>{e.state("base.tools.legacy",{url:"/:toolName",resolve:{translations:[i.serviceName,e=>e.loadBundle("features/base/tools/base-tools")],offCanvasArgs:[s.d,e=>({panelClass:"full",template:o,close:()=>{e.goCurrentBasePage()},stateName:"base.tools.legacy"})]},require:()=>Promise.resolve().then(n.bind(null,"yA26")),onExit:[r.e,e=>{e.close("base.tools.legacy")}],pageTitle:"base.tools.pageTitle"})}])},j2IR:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n("Llzl"),i=n("0JpG"),r=n("w9Zy"),s=n("go4a"),o=n("pjml"),l=n("TnpK"),c=n("Qbdf"),d=n("fYJU"),u=n("nmzr");const m="ultra.telemetry.routes";function p(e,t,n,a){const i=e.defer(),r=t.courseId;return r?n.$new(r).users.$find(a.userId).$then((e=>{i.resolve(s.a(e))})):i.resolve(null),i.promise}a.module(m,[i.moduleName,r.d,o.N,l.b,c.b]).config([l.c,c.c,(e,t)=>{e.peekState("telemetry-settings",{url:"/telemetry-settings",require:()=>Promise.all([n.e(0),n.e(11),n.e(607)]).then(n.bind(null,"W9KP")),resolve:{currentCourseColor:["$q","$stateParams",o.m.serviceName,d.b,(e,t,n,a)=>p(e,t,n,a)]}}).peekState(u.K.INSTRUCTOR_CLASS,{url:"/telemetry/activityVsGrade/:courseId?notificationId",require:()=>Promise.all([n.e(38),n.e(50),n.e(41),n.e(48),n.e(57),n.e(64),n.e(148),n.e(647)]).then(n.bind(null,"7FjY")),panelClass:"full",resolve:{translations:["$q",i.serviceName,(e,t)=>e.all([t.loadBundle("components/directives/telemetry/telemetry"),t.loadBundle("components/services/telemetry-chart")])],[c.d]:t.resolve},peekStates:[u.n.COURSE_MESSAGE,"event-create","telemetry-settings",u.K.INSTRUCTOR_DETAILS],peekViewName:"telemetry-instructor-class-base@",pageTitle:"components.directives.telemetry.panel.titleInstructor"}).peekState(u.K.INSTRUCTOR_DETAILS,{url:"/telemetry/timeSeries/:courseId?userId",require:()=>Promise.all([n.e(38),n.e(50),n.e(41),n.e(48),n.e(57),n.e(587)]).then(n.bind(null,"AxRA")),panelClass:"full",resolve:{translations:["$q",i.serviceName,(e,t)=>e.all([t.loadBundle("components/directives/telemetry/telemetry"),t.loadBundle("components/services/telemetry-chart")])],[c.d]:t.resolve},peekStates:[u.n.COURSE_MESSAGE,"event-create","telemetry-settings"],peekViewName:"telemetry-instructor-details-base@",pageTitle:"components.directives.telemetry.panel.titleStudent"}).peekState(u.K.STUDENT_HIGH_PERFORMANCE,{url:"/telemetry/student/high-performance/:courseId",require:()=>Promise.all([n.e(38),n.e(50),n.e(41),n.e(48),n.e(57),n.e(64),n.e(602)]).then(n.bind(null,"5a0X")),panelClass:"peek",resolve:{translations:["$q",i.serviceName,(e,t)=>e.all([t.loadBundle("components/directives/telemetry/telemetry"),t.loadBundle("components/services/telemetry-chart")])],[c.d]:t.resolve,currentCourseColor:["$q","$stateParams",o.m.serviceName,d.b,(e,t,n,a)=>p(e,t,n,a)]},pageTitle:"components.directives.telemetry.panel.titleStudent"}).peekState(u.K.STUDENT_LOW_ACTIVITY,{url:"/telemetry/student/low-performance/activity/:courseId",require:()=>Promise.all([n.e(38),n.e(50),n.e(41),n.e(48),n.e(57),n.e(64),n.e(154),n.e(740)]).then(n.bind(null,"ADyW")),panelClass:"peek",resolve:{translations:["$q",i.serviceName,(e,t)=>e.all([t.loadBundle("components/directives/telemetry/telemetry"),t.loadBundle("components/services/telemetry-chart")])],[c.d]:t.resolve,currentCourseColor:["$q","$stateParams",o.m.serviceName,d.b,(e,t,n,a)=>p(e,t,n,a)]},pageTitle:"components.directives.telemetry.panel.titleStudent"}).peekState(u.K.STUDENT_LOW_GRADES,{url:"/telemetry/student/low-performance/grades/:courseId",require:()=>Promise.all([n.e(38),n.e(50),n.e(41),n.e(48),n.e(57),n.e(64),n.e(154),n.e(741)]).then(n.bind(null,"vOTS")),panelClass:"peek",resolve:{translations:["$q",i.serviceName,(e,t)=>e.all([t.loadBundle("components/directives/telemetry/telemetry"),t.loadBundle("components/services/telemetry-chart")])],[c.d]:t.resolve,currentCourseColor:["$q","$stateParams",o.m.serviceName,d.b,(e,t,n,a)=>p(e,t,n,a)]},pageTitle:"components.directives.telemetry.panel.titleStudent"}).peekState(u.K.STUDENT_PROGRESS,{url:"/telemetry/student/progress/:courseId",require:()=>Promise.all([n.e(38),n.e(50),n.e(41),n.e(48),n.e(57),n.e(597)]).then(n.bind(null,"09dT")),panelClass:"peek",resolve:{translations:["$q",i.serviceName,(e,t)=>e.all([t.loadBundle("components/directives/telemetry/telemetry"),t.loadBundle("components/services/telemetry-chart")])],[c.d]:t.resolve,currentCourseColor:["$q","$stateParams",o.m.serviceName,d.b,(e,t,n,a)=>p(e,t,n,a)]},pageTitle:"components.directives.telemetry.panel.titleStudent"}).peekState(u.K.STUDENT_FIND_A_STUDY_PARTNER,{url:"/telemetry/student/request-study-help/:courseId",require:()=>n.e(600).then(n.bind(null,"cU3T")),panelClass:"peek",resolve:{translations:["$q",i.serviceName,(e,t)=>e.all([t.loadBundle("components/directives/telemetry/telemetry")])],[c.d]:t.resolve,currentCourseColor:["$q","$stateParams",o.m.serviceName,d.b,(e,t,n,a)=>p(e,t,n,a)]},pageTitle:"components.directives.telemetry.panel.titleStudent"}).peekState(u.K.CONTENT_ACTIVITY_IN_DETAIL,{url:"/telemetry/instructor/activity-in-detail/:contentId",require:()=>Promise.all([n.e(38),n.e(0),n.e(4),n.e(41),n.e(57),n.e(576)]).then(n.bind(null,"AeD7")),panelClass:"full",resolve:{translations:[i.serviceName,e=>e.loadBundle("components/directives/telemetry/telemetry")],currentContent:["$stateParams",c.d,(e,t)=>{const n=e.contentId;return t.contents.$find(n).$asPromise()}]},pageTitle:"components.directives.telemetry.panel.titleStudentActivityDetails",peekStates:[u.n.COURSE_MESSAGE,"event-create",u.K.INSTRUCTOR_DETAILS],peekViewName:"telemetry-content-activity-in-detail-base@"}).peekState(u.K.DISCUSSION_FORUM_INSIGHTS,{url:"/telemetry/instructor/discussion-insights/:contentId/:forumContentId",require:()=>Promise.all([n.e(9),n.e(699)]).then(n.bind(null,"zl9+")),panelClass:"full",params:{groupId:null},resolve:{translations:[i.serviceName,e=>e.loadBundle("components/directives/discussion")],currentContent:["$stateParams",c.d,(e,t)=>{const n=e.contentId;return t.contents.$find(n).$asPromise()}]},pageTitle:"components.directives.discussion.insights.pageTitle",peekStates:["content-manage","submission-list",u.n.COURSE_MESSAGE],peekViewName:"telemetry-discussion-forum-insights-base@"})}])},jT78:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n("zYa8"),i=n("TE6g");const r="ultra.components.directives.bbUiIcon.large.Zip";Object(a.a)(i.a,r,"bbUiIconLargeZip")},jhBu:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return u}));var a=n("Llzl"),i=n("5MwF"),r=n("x+T+"),s=n("Qbdf"),o=n("VAMW"),l=n("6fZB"),c=n("/5AG");const d="ultra.service.entitlement",u="entitlement";class m{constructor(e){this.service=e,this.key=o.d.Entitlement}hasSystemEntitlement(e){return Object(l.a)(this.service.hasSystemEntitlement(e))}}class p{constructor(e,t){this.entitlementCache=e,this.currentCourse=t,this.isUserEntitledToRetrieveCourseProgressConfiguration=e=>this.isEntitled(c.m.ViewConfiguration)||e,Object(o.f)(new m(this))}isEntitled(e,t=this.currentCourse.courseId){if(!t)return i.a.production||console.error(new Error("There is no course in context. Check the configuration.")),!1;if(!i.a.production&&!this.entitlementCache.hasCachedCourseEntitlements(t))throw new Error(`Cached entitlements should exist for course with ID, ${t}, but none were found.\n        Make sure the entitlement resolver is configured for this route,\n        or use async hasCourseEntitlement methods that guarantee the cache initializes.`);return this.entitlementCache.hasCachedCourseEntitlements(t)&&this.entitlementCache.getCachedCourseEntitlements(t).has(e.toString())}areAllEntitled(e,t=this.currentCourse.courseId){return e.every((e=>this.isEntitled(e,t)))}areAnyEntitled(e,t=this.currentCourse.courseId){return e.some((e=>this.isEntitled(e,t)))}hasCourseEntitlement(e,t=this.currentCourse.courseId){return this.entitlementCache.loadCourseEntitlements(t).then((()=>this.isEntitled(e,t)))}hasAllCourseEntitlements(e,t=this.currentCourse.courseId){return this.entitlementCache.loadCourseEntitlements(t).then((()=>this.areAllEntitled(e,t)))}hasAnyCourseEntitlement(e,t=this.currentCourse.courseId){return this.entitlementCache.loadCourseEntitlements(t).then((()=>this.areAnyEntitled(e,t)))}hasSystemEntitlement(e){return this.entitlementCache.loadCourseEntitlements(r.a).then((()=>this.isEntitled(e,r.a)))}hasAnySystemEntitlements(e){return this.entitlementCache.loadCourseEntitlements(r.a).then((()=>this.areAnyEntitled(e,r.a)))}}p.$inject=[r.c,s.e];a.module(d,[r.b,s.b]).service(u,p)},jj6p:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));n("JzsJ");var a=n("71td"),i=n("Llzl"),r=n("5MwF"),s=n("Sa5G"),o=n("0JpG"),l=n("wQOJ"),c=n("pjml"),d=n("MOka"),u=n("TnpK"),m=n("Q/M7"),p=n("nmzr");const h="ultra.base.routes";i.module(h,[o.moduleName,c.N]).config([u.c,e=>{e.baseState("base.calendar",{url:"^/calendar",resolve:{translations:[o.serviceName,e=>e.loadBundle("features/base/calendar/base-calendar")],"?courseMembershipsLoader":i.noop},peekStates:[p.G.Calendar.CALENDAR_SETTINGS,p.G.Calendar.CREATE_EVENT,p.G.Calendar.EDIT_EVENT,p.G.Calendar.VIEW_EVENT,p.G.Calendar.COURSE_SCHEDULE,p.G.Calendar.OFFICE_HOURS,"content-manage","assignment","assessment","course",p.G.Lti.LTI,"scorm-launch-frame","scorm-settings","gradebook-item.scorm-submissions","scorm-overview"],require:()=>Promise.all([n.e(102),n.e(36),n.e(55),n.e(83),n.e(162)]).then(n.bind(null,"q2ny")),pageTitle:"base.nav.calendar"}).baseState("base.deadline",{url:"^/deadline",resolve:{translations:[o.serviceName,e=>e.loadBundle("features/base/calendar/base-calendar")],"?courseMembershipsLoader":i.noop},peekStates:[p.G.Calendar.CALENDAR_SETTINGS,p.G.Calendar.CREATE_EVENT,p.G.Calendar.EDIT_EVENT,p.G.Calendar.VIEW_EVENT,p.G.Calendar.COURSE_SCHEDULE,p.G.Calendar.OFFICE_HOURS,p.G.Lti.LTI,p.G.Lti.LTI_LAUNCH_PEEK,"content-manage","assignment","course","assessment","scorm-overview"],require:()=>Promise.all([n.e(102),n.e(36),n.e(55),n.e(83),n.e(162)]).then(n.bind(null,"q2ny")),pageTitle:"base.nav.calendar"}).baseState("base.courses",{url:"^/course?enrollmentMessage",resolve:{translations:[o.serviceName,e=>e.loadBundle("features/base/courses/base-courses")]},peekStates:["course","external",p.G.Calendar.COURSE_SCHEDULE,p.G.Course.EDIT_BANNER],peekViewName:"courses-base",require:()=>Promise.all([n.e(31),n.e(0),n.e(61),n.e(93),n.e(140)]).then(n.bind(null,"EQ9X")),pageTitle:"base.nav.courses"}).baseState("base.grades",{url:"^/grades",resolve:{translations:[o.serviceName,e=>e.loadBundle("features/base/grades/base-grades")],"?courseMembershipsLoader":[i.noop]},require:()=>Promise.all([n.e(31),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(10),n.e(16),n.e(36),n.e(579)]).then(n.bind(null,"Bfy5")),peekStates:["assessment","assignment",p.G.Grade.GRADE_AND_FEEDBACK,"gradebook-item","telemetry","course","discussion",p.G.Lti.LTI,"scorm-settings","gradebook-item.scorm-submissions","scorm-launch-frame","scorm-overview",p.G.Journal.JOURNAL,p.G.Telemetry.INSTRUCTOR_CLASS,p.G.Telemetry.INSTRUCTOR_DETAILS,p.G.Telemetry.STUDENT_PROGRESS,"overall-grade-student","attendance","attendance-student-view"],pageTitle:"base.nav.grades"}).baseState("base.messages",{url:"^/messages",resolve:{translations:[o.serviceName,e=>e.loadBundle("features/base/messages/base-messages")]},require:()=>Promise.all([n.e(31),n.e(0),n.e(22),n.e(49),n.e(146),n.e(644)]).then(n.bind(null,"ZQ8w")),peekStates:["create-message","edit-message",p.G.Course.COURSE_MESSAGE,"course"],pageTitle:"base.nav.messages"}).baseState("base.organizations",{url:"^/organization?enrollmentMessage",resolve:{translations:[o.serviceName,e=>e.loadBundle("features/base/courses/base-courses")]},peekStates:["course","external",p.G.Calendar.COURSE_SCHEDULE,p.G.Course.EDIT_BANNER],peekViewName:"courses-base",require:()=>Promise.all([n.e(31),n.e(0),n.e(61),n.e(93),n.e(140)]).then(n.bind(null,"EQ9X")),pageTitle:"base.nav.organizations"}).baseState(p.G.Profile.PROFILE_BASE,{url:"^/profile",resolve:{userConfiguration:[c.Jb.serviceName,e=>e.getUserConfiguration()],translations:[o.serviceName,e=>e.loadBundle("features/base/profile/base-profile")],isMobileDistributorActive:["$q",c.Q.serviceName,(e,t)=>t.$build().courseSettings.$new(s.q.Mobile).$fetch().$allow([400]).$then((e=>!!e.settings))],memberships:[d.b,e=>e.reloadStreamMemberships()]},require:()=>Promise.all([n.e(43),n.e(78),n.e(97),n.e(151),n.e(612)]).then(n.bind(null,"cFSu")),peekStates:["notification-settings",p.G.Profile.UPDATE_AVATAR_PEEK,p.G.Profile.UPDATE_PROFILE_PEEK,p.G.Profile.UPDATE_LANGUAGE_PEEK,p.G.Profile.UPDATE_PASSWORD_PEEK,"privacy"],pageTitle:"base.nav.profile",onEnter:["$location",e=>{e.search("noCache",null)}]}).baseState("base.recentActivity",{resolve:{translations:[o.serviceName,e=>e.loadBundle("features/base/stream/base-stream")],memberships:[d.b,e=>e.reloadStreamMemberships()],"?courseMembershipsLoader":i.noop},peekStates:["announcement",p.G.Announcement.ANNOUNCEMENT_DETAIL,"assignment","assessment","content-manage","content-group","course","discussions",p.G.Calendar.EDIT_EVENT,p.G.Calendar.VIEW_EVENT,"gradebook-item","stream-message","telemetry",p.G.Lti.LTI,"content-group-enroll","notification-create","notification-settings","scorm-overview","scorm-launch-frame","scorm",p.G.Telemetry.INSTRUCTOR_CLASS,p.G.Telemetry.INSTRUCTOR_DETAILS,p.G.Telemetry.STUDENT_HIGH_PERFORMANCE,p.G.Telemetry.STUDENT_LOW_ACTIVITY,p.G.Telemetry.STUDENT_LOW_GRADES,p.G.Telemetry.STUDENT_PROGRESS,p.G.Telemetry.STUDENT_FIND_A_STUDY_PARTNER],peekViewName:"base-recentActivity-base",url:"^/stream",require:()=>Promise.all([n.e(4),n.e(8),n.e(40),n.e(46),n.e(580)]).then(n.bind(null,"UFXJ")),pageTitle:"base.nav.recentActivity"}).baseState("base.tools",{url:"^/tools",resolve:{translations:[o.serviceName,e=>e.loadBundle("features/base/tools/base-tools")]},peekStates:[p.G.Lti.LTI],require:()=>n.e(608).then(n.bind(null,"2yHp")),pageTitle:"base.nav.tools"}).baseState("base.admin",{resolve:{translations:[o.serviceName,e=>e.loadBundle("features/base/admin/base-admin")]},systemEntitlement:s.s.ViewAdmin,onEnter:()=>{a("body").addClass("base-admin-open")},onExit:()=>{a("body").removeClass("base-admin-open")},url:"^/admin",require:()=>n.e(656).then(n.bind(null,"9D0M")),peekStates:["course","localization","brands","notification-admin",p.G.Admin.ULTRA_SETTINGS_PEEK,p.G.Admin.ULTRA_EDIT_APPROVED_PRONOUNS_PEEK],pageTitle:"base.nav.admin"}).peekState("localization",{url:"/localization?launchUrl",require:()=>n.e(685).then(n.bind(null,"Arco")),pageTitle:"base.nav.localization",panelClass:"full",resolve:{translations:[o.serviceName,e=>e.loadBundle("features/base/admin/localization")],enterCheck:[u.d,"$stateParams",(e,t)=>{if(!t.launchUrl)return e.goToRoute("base.admin")}]}}).peekState(p.G.Admin.ULTRA_SETTINGS_PEEK,{url:"/ultra-settings",require:()=>Promise.all([n.e(3),n.e(35),n.e(62),n.e(37),n.e(63),n.e(756)]).then(n.bind(null,"jjx5")),pageTitle:"base.nav.ultra-settings-admin",panelClass:"full"}).peekState("notification-admin",{url:"/notification",require:()=>n.e(755).then(n.bind(null,"Vf+W")),pageTitle:"base.nav.notification-admin",panelClass:"full"}).peekState(p.G.Admin.ULTRA_EDIT_APPROVED_PRONOUNS_PEEK,{url:"/edit-pronouns",require:()=>Promise.all([n.e(3),n.e(35),n.e(62),n.e(37),n.e(63),n.e(754)]).then(n.bind(null,"5l+L")),pageTitle:"base.nav.edit-pronouns-admin",panelClass:"peek"}).baseState("base.redirect",{url:"^/redirect?userId&contentId&courseId&eventType&sourceType&sourceId&redirectType&legacyUrl&parentId&screen",require:()=>n.e(772).then(n.bind(null,"kds7"))}).baseState("base.institution-page",{url:"^/institution-page",require:()=>Promise.all([n.e(3),n.e(35),n.e(37),n.e(173)]).then(n.bind(null,"dRT/")),peekStates:["allLinks",p.G.Lti.LTI],pageTitle:"base.nav.institutionPage",resolve:{ipVariantId:[l.b,u.d,(e,t)=>e.getEffectiveVariantIdWithPermissions().then((({variantId:e,canView:n})=>{if(n)return e;t.goToRoute("base.recentActivity")}),(()=>t.goToRoute("base.recentActivity")))]}}).baseState("base.institution-page-admin",{url:"^/institution-page/admin/:variantId",require:()=>Promise.all([n.e(3),n.e(35),n.e(37),n.e(173)]).then(n.bind(null,"dRT/")),peekStates:["allLinks","editModule","editPageImage","createModule",p.G.Lti.LTI,"brand-detail"],pageTitle:"base.nav.institutionPage",params:{variantId:"default"},resolve:{ipVariantId:[l.b,u.d,"$stateParams",(e,t,n)=>e.getUserCanEdit("default").then((e=>(e||t.goToRoute("base.recentActivity"),n.variantId)),(()=>t.goToRoute("base.recentActivity")))],testResolver:["ipVariantId",e=>e]}}).state("institution",{onEnter:()=>{window.location.href=m.c("/institution")}}).baseState("base.course-catalog",{url:"^/catalog",require:()=>n.e(167).then(n.bind(null,"Kz46")),pageTitle:"base.nav.catalog",peekStates:["course"],resolve:{translations:[o.serviceName,e=>e.loadBundle("features/course/course-catalog")]}}).baseState("base.organization-catalog",{url:"^/organization-catalog",require:()=>n.e(167).then(n.bind(null,"Kz46")),pageTitle:"base.nav.orgCatalog",peekStates:["course"],resolve:{translations:[o.serviceName,e=>e.loadBundle("features/course/course-catalog")]}}).baseState(p.G.Integration.INTEGRATION_BASE,{url:"^/integration/:routeName?params",require:()=>n.e(748).then(n.bind(null,"xYk/"))}),r.a.features.componentDemos&&e.baseState("base.demo",{url:"^/demo",require:()=>Promise.all([n.e(103),n.e(0),n.e(43),n.e(95),n.e(572)]).then(n.bind(null,"KTgJ")),peekStates:["demoComponent"],pageTitle:"base.nav.demo"})}])},jnoB:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n("Llzl"),i=n("Sa5G"),r=n("Qbdf"),s=n("0JpG"),o=n("TnpK"),l=n("nmzr");const c="ultra.course.groups.router";a.module(c,[r.b,s.moduleName,o.b]).config([r.c,o.c,(e,t)=>{t.peekState("group-set-list",{url:"/group-set-list",courseEntitlement:i.o.ViewGroupsAsAdmin,require:()=>n.e(770).then(n.bind(null,"Mkxh")),pageTitle:"course.outline.groupWorkspace.title",peekStates:["group-set-detail",l.x.IMPORT_GROUP_SET,l.x.EXPORT_GROUP_SET,l.x.GROUP_MEMBERS_LIST],panelClass:"full"}).peekState(l.x.IMPORT_GROUP_SET,{url:"/import-group-set",courseEntitlement:i.o.ViewGroupsAsAdmin,require:()=>n.e(732).then(n.bind(null,"J9mj")),pageTitle:"course.content.courseGroup.importGroupSetTitle",panelClass:"peek"}).peekState(l.x.IMPORT_GROUP_MEMBERS,{url:"/import-groups-members",courseEntitlement:i.o.ViewGroupsAsAdmin,require:()=>n.e(731).then(n.bind(null,"MNjM")),pageTitle:"course.content.courseGroup.importGroups",panelClass:"peek"}).peekState(l.x.EXPORT_GROUP_SET,{url:"/export-group-set?groupSetId",courseEntitlement:i.o.ViewGroupsAsAdmin,require:()=>n.e(730).then(n.bind(null,"1YGW")),pageTitle:"course.content.courseGroup.exportGroupSetTitle",panelClass:"peek"}).peekState(l.x.GROUP_MEMBERS_LIST,{url:"/group-members-list?groupId",require:()=>n.e(733).then(n.bind(null,"xrMj")),pageTitle:"course.content.courseGroup.groupMembersTitle",panelClass:"peek"}).peekState("group-set-detail",{panelClass:"full",url:"/groupSet?courseId&groupSetId&mode",courseEntitlement:i.o.ViewGroupsAsAdmin,resolve:{translations:[s.serviceName,e=>e.loadBundle("features/course/content/group/course-group")]},require:()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(22),n.e(141),n.e(769)]).then(n.bind(null,"ymtw")),pageTitle:"course.content.courseGroup.groupSetTitle",peekStates:[l.n.COURSE_MESSAGE,l.x.EXPORT_GROUP_SET,l.x.IMPORT_GROUP_MEMBERS],peekViewName:"group-message-peek"}).peekState("content-group-enroll",{url:"/group-enroll?courseId&contentId&fromView",panelClass:"full",resolve:{[r.d]:e.resolve,translations:[s.serviceName,e=>e.loadBundle("features/course/content/group/course-group")]},require:()=>n.e(762).then(n.bind(null,"sBQA")),pageTitle:"course.content.courseGroup.selfEnroll",peekStates:[l.x.GROUP_MEMBERS_LIST]}).peekState("course-group-enroll",{url:"/course-group-enroll?courseId&fromView",pageTitle:"course.content.courseGroup.selfEnroll",peekStates:[l.x.GROUP_MEMBERS_LIST],panelClass:"full",require:()=>n.e(771).then(n.bind(null,"B5Yh"))})}])},jx5I:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return c}));var a=n("D57K"),i=n("Llzl"),r=n("IbyE"),s=n("aHpC"),o=n("9OUN");const l="ultra.service.upload.settings",c="uploadSettings";let d=class{constructor(e,t){this.$q=e,this.$ngRedux=t,this.subscribeToRedux()}fetchFileUploadSettings(){return this.$q.when(this.getFileUploadSettings())}subscribeToRedux(){this.$ngRedux.connect((e=>({fileUploadSettings:r.Yb.fileUploadSettings.getFileUploadSettings(e)})),(e=>Object(o.b)({getFileUploadSettings:r.V.fileUploadSettings.loadFileUploadSettings},e)))(this)}getSettings(){return this.fileUploadSettings}};d=Object(a.a)([Object(a.c)(0,Object(s.b)("$q")),Object(a.c)(1,Object(s.b)("$ngRedux"))],d);i.module(l,[]).service(c,d)},k9iv:function(e,t,n){"use strict";var a=n("nsO7"),i=n("Llzl"),r=n("5MwF"),s=n("0JpG"),o=n("12mu"),l=n("zGdY"),c=n("ERkP"),d=n.n(c),u=n("SToD"),m=n("qiBf"),p=n("zDAW"),h=n.n(p),g=n("/n7R"),b=n("np6O"),f=n("EZIA"),v=n("ECG1");const y=Object(u.a)((e=>{const{sessionDebug:t,localize:n}=e,{translate:a}=n,[i,r]=d.a.useState(!1);return i?d.a.createElement(d.a.Fragment,null,d.a.createElement(h.a,null,a("supportPanel.sessionDebug.submissionButtonLabel"),d.a.createElement(g.AnalyticsTooltip,{analyticsId:"errorModal.sessionDebug.information.tooltip",title:a("supportPanel.sessionDebug.modalInformationText"),PopperProps:{style:{zIndex:1000100}}},d.a.createElement(b.AnalyticsIconButton,{analyticsId:"errorModal.sessionDebug.information.tooltip"},d.a.createElement(v.a,null)))),d.a.createElement(m.a,{sessionDebug:t})):d.a.createElement(f.a,{tabIndex:0,analyticsId:"erroModal.sessionDebug.showInput.link",onClick:()=>r(!0)},a("supportPanel.sessionDebug.submissionButtonLabel"))}));var S=n("1ZbL"),C=n("ReOc");const E="ultra.components.directives.sessionDebugModalButton",I={Class:e=>{const[t,n]=c.useState("");return c.useEffect((()=>{C.a.getDebugInfoFriendly().then((e=>n(e.join("\r\n"))))}),[]),c.createElement(y,{sessionDebug:t})},renderLocalized:!0,withProvider:!0,withErrorModalBoundary:!1};i.module(E,[s.moduleName]).component("bbSessionDebugModalButton",Object(S.a)(I));var k=n("W/rt"),w=n("zlFc"),T=n("9ZjI"),O=n("TFjq"),A=n("PqsU"),P=n("sqUP"),x=n("nL6A"),$=n("9p8+"),N=n("cGmE"),D=n("q4pc"),L=n("krSA");n.d(t,"b",(function(){return j})),n.d(t,"c",(function(){return M})),n.d(t,"a",(function(){return w}));const j="ultra.components.services.errorModal",M="errorModal";class G{constructor(){this.isModalClosed=!0,this.handlers=[],this.$get=[o.b,"$rootScope","$q","$window","$injector",function(e,t,n,a,i){return this.$modal=e,this.$rootScope=t,this.$q=n,this.$injector=i,this.$window=a,window.addEventListener("show-debug-error-modal",(()=>{this.showDefaultErrorModal()})),this}]}onErrorResponse(e){this.handlers.push(e)}handleApiError(e,t){var n,i,r,s,o,c;if(!e||null==e.status)return;if(this.$window.document.getElementsByClassName("ms-Panel").length)return;const d={response:e,errorHandler:t};if(e.status===l.S.Forbidden)"Question could not be created with existing attempt(s)"===(null===(n=e.data)||void 0===n?void 0:n.message)?d.template=k:d.template=w;else if(e.status===l.S.NotFound)a.includes(null===(i=e.data)||void 0===i?void 0:i.message,"No course content found for content id")?d.template=T:d.template=O;else if(e.status===l.S.Conflict)d.template=A;else if(507===e.status)d.template=P;else if(e.status>=400&&e.status<=599)if(e.status===l.S.BadRequest&&(null===(r=e.data)||void 0===r?void 0:r.code)===G.COURSE_IS_CLOSED_CODE)d.template=x;else if(e.status!==l.S.BadRequest||!a.includes(null===(s=e.data)||void 0===s?void 0:s.message,"The input was too large")&&(null===(o=e.data)||void 0===o?void 0:o.code)!==l.T)if((null===(c=e.data)||void 0===c?void 0:c.code)===l.A)d.template=$;else{let t;this.handlers.some((n=>(t=this.$injector.invoke(n,void 0,{response:e}),t&&void 0!==t.tpl))),d.template=t&&t.tpl||N,d.scope=t&&t.scope}else d.template=D;d.template&&this.openModal(d)}showDefaultErrorModal(){const e={template:O};this.openModal(e)}handleError(e,t){if(!e)return;const n={errorString:e,template:L,errorHandler:t};this.openModal(n)}getReactErrorBoundary(){return this.reactErrorBoundary}openModal(e){if(this.isModalClosed){if(!e||!e.template)throw new Error("Modal configuration template was not supplied");let t=e.scope||this.$rootScope;r.a.errorDetails&&(t=this.$rootScope.$new(),t.response=e.response),t.errorString=e.errorString;const n={template:e.template,scope:t,resolve:{translations:[s.serviceName,e=>e.loadBundle("components/services/error-modal")]}};this.isModalClosed=!1,this.modalInstance=this.$modal.open(n),this.modalInstance.result.then((()=>{}),(()=>{this.isModalClosed=!0,e.errorHandler&&e.errorHandler()}))}}}G.COURSE_IS_CLOSED_CODE="bb-rest-course-is-closed";i.module(j,[s.moduleName,o.a,E]).provider(M,G)},kH1j:function(e,t,n){var a=n("ziER"),i=n("5JeM"),r=new a({id:"icon-medium-programs",use:"icon-medium-programs-usage",viewBox:"0 0 24 24",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-medium-programs"><path stroke-width="2" stroke-linecap="round" stroke-linejoin="round" d="M17 3h6v20h-6zM9 7h8v16H9zM1 1h8v22H1zM1 19h8M1 5h8M12 11h2M12 19h2M17 19h6M20 7v3" /></symbol>'});i.add(r);e.exports=r},kcGO:function(e,t,n){"use strict";const a="ui.course.content.opened";function i(e){return{type:a,content:e}}function r(e){return{type:"ui.course.content.closed",content:e}}var s=n("IbyE"),o=n("zGdY");function l(e,t){var n;const a=null!=t?t:o.u.None;return(null===(n=e.permissions)||void 0===n?void 0:n.canHaveReviewState)&&a===o.u.None?e.inSequence?function(e){var t;const n=null===(t=null==e?void 0:e.contentHandler)||void 0===t?void 0:t.toString();switch(n?s.i.parse(n):void 0){case null:case void 0:case s.i.Unknown:return null;case s.i.Folder:return s.j.isBbPage(e)?o.u.Started:o.u.Completed;case s.i.ClassicAssignment:case s.i.Discussion:case s.i.Journal:case s.i.LtiLink:case s.i.RusticiScorm:case s.i.TestLink:case s.i.UltraAssignment:return o.u.Started;default:return o.u.Completed}}(e):function(e){switch(null==e?void 0:e.contentHandler){case void 0:case s.i.Unknown:return null;default:return o.u.Started}}(e):null}function c(e){var t,n;const a=null!==(t=e.state)&&void 0!==t?t:o.u.None;if(!(null===(n=e.permissions)||void 0===n?void 0:n.canHaveReviewState))return null;if(e.inSequence){if(a!==o.u.Completed)return o.u.Completed}else if(a!==o.u.Started&&a!==o.u.Completed)return o.u.Started;return null}var d=n("OrNH");function*u(e){var t;const n=e.content,a=null==n?void 0:n.id,i=null==n?void 0:n.courseId;if(!(n&&a&&i&&(null===(t=n.permissions)||void 0===t?void 0:t.canHaveReviewState)))return;const r=l(n,yield Object(d.e)((e=>s.Yb.contentReviewState.getContentReviewStateForContextUser(e,a))));if(r){if(yield Object(d.e)((e=>s.Yb.contentReviewState.getLoadingStatusForContentReviewStateForContextUser(e,a))))return;yield Object(d.d)(s.V.contentReviewState.persistContentReviewState(i,a,r))}}var m={autoContentReviewStateSaga:function*(){yield Object(d.h)(a,u)}};function p(e){switch(e){case o.u.Started:return o.u.Completed;case o.u.Completed:return o.u.Started;default:return null}}var h=n("ERkP"),g=n.n(h),b=n("tN4z"),f=n("YK4x"),v=n("7O4Y"),y=n("Agfx");const S=Object(y.makeStyles)((e=>Object(y.createStyles)({root:{backgroundColor:e.palette.background.paper,padding:"28px 32px",borderBottom:`1px solid ${e.palette.border.main}`,margin:"0 -30px"},chart:{height:"25px",display:"grid",margin:"0 -2px 3px"},chartLine:{border:"2px solid #FFF",height:"19px",borderRadius:"10px",gridColumn:1,gridRow:1},chartLineUnopened:{backgroundColor:e.palette.secondary.main,width:"100%"},chartLineStarted:{backgroundColor:e.palette.primary.main},chartLineCompleted:{backgroundColor:e.palette.brand.main},legend:{display:"flex",justifyContent:"space-between"},legendLabels:{display:"flex",listStyle:"none",flexDirection:"column",margin:0,[e.breakpoints.up("sm")]:{flexDirection:"row"}},legendLabel:{margin:"2px 0",display:"inline-flex",alignItems:"center",[e.breakpoints.up("sm")]:{margin:0,padding:"0 10px",borderRight:`1px solid ${e.palette.border.main}`,"&:first-child":{paddingLeft:0},"&:last-child":{borderRight:0}}},legendBubble:{width:"12px",height:"12px",display:"inline-block",borderRadius:"6px",marginRight:"6px"},legendBubbleUnopened:{backgroundColor:e.palette.secondary.main},legendBubbleStarted:{backgroundColor:e.palette.primary.main},legendBubbleCompleted:{backgroundColor:e.palette.brand.main}})));var C=n("uDfI");var E=n("GuFu");const I=e=>{const{analyticsId:t,courseId:n,contentId:a,requiresManualMarking:i}=e,r=S(e),l=Object(f.a)(),c=(e=>{const t=Object(C.e)((t=>s.Yb.contentReviewState.getContentReviewStateUsersReportStates(t,e.contentId))),n=Object(C.d)();return Object(h.useEffect)((()=>{(null==t?void 0:t.isLoading)||(null==t?void 0:t.states)||n(s.V.contentReviewState.fetchContentReviewStateUsersReportStates(e))}),[n,null==t?void 0:t.isLoading,null==t?void 0:t.states]),(null==t?void 0:t.states)?null==t?void 0:t.states:{[o.u.None]:0,[o.u.Unlocked]:0,[o.u.Started]:0,[o.u.Completed]:0}})({courseId:n,contentId:a}),d=Object(E.h)("courseContent","courseContent.organization"),{completedStyle:u,startedStyle:m,unopenedCount:p,startedCount:y,completedCount:I,totalCount:k}=g.a.useMemo((()=>{const e=c.Completed,t=c.Started,n=c.Unlocked+c.None,a=e+t+n,i=100*e/a;return{completedStyle:{width:`${i}%`},startedStyle:{width:`${i+100*t/a}%`},unopenedCount:n,startedCount:t,completedCount:e,totalCount:a}}),[c]),w=i?"courseContent.contentProgress.breakdown.markedComplete":"courseContent.contentProgress.breakdown.completed";return g.a.createElement("div",{className:r.root},g.a.createElement("h2",null,l("courseContent.contentProgress.breakdown.progressSummary")),g.a.createElement("div",{className:r.chart,"aria-hidden":"true"},g.a.createElement(b.AnalyticsTooltip,{analyticsId:`${t}.unopened`,title:l("courseContent.contentProgress.breakdown.unopened",{count:p}),placement:"bottom-end"},g.a.createElement("div",{className:Object(v.a)(r.chartLine,r.chartLineUnopened),"data-testid":"content-progress-breakdown-unopened"})),y>0?g.a.createElement(b.AnalyticsTooltip,{analyticsId:`${t}.unopened`,title:l("courseContent.contentProgress.breakdown.started",{count:y}),placement:"bottom-end"},g.a.createElement("div",{className:Object(v.a)(r.chartLine,r.chartLineStarted),style:m,"data-testid":"content-progress-breakdown-started"})):void 0,I>0?g.a.createElement(b.AnalyticsTooltip,{analyticsId:`${t}.unopened`,title:l(w,{count:I}),placement:"bottom-end"},g.a.createElement("div",{className:Object(v.a)(r.chartLine,r.chartLineCompleted),style:u,"data-testid":"content-progress-breakdown-completed"})):void 0),g.a.createElement("div",{className:r.legend},g.a.createElement("ul",{className:r.legendLabels},g.a.createElement("li",{className:r.legendLabel},g.a.createElement("span",{className:Object(v.a)([r.legendBubble,r.legendBubbleCompleted]),"aria-hidden":"true"}),l(w,{count:I})),g.a.createElement("li",{className:r.legendLabel},g.a.createElement("span",{className:Object(v.a)([r.legendBubble,r.legendBubbleStarted]),"aria-hidden":"true"}),l("courseContent.contentProgress.breakdown.started",{count:y})),g.a.createElement("li",{className:r.legendLabel},g.a.createElement("span",{className:Object(v.a)([r.legendBubble,r.legendBubbleUnopened]),"aria-hidden":"true"}),l("courseContent.contentProgress.breakdown.unopened",{count:p}))),g.a.createElement("span",null,l(d("courseContent.contentProgress.breakdown.total"),{count:k}))))},k=Object(y.makeStyles)((e=>Object(y.createStyles)({tableHead:{"& th":{backgroundColor:"unset",borderTop:"0"}},tableHeadAllStudents:{width:"48px"},tableHeadStudentName:{fontWeight:e.typography.fontWeightBold,margin:"0 10px"},tableEmptyRow:{borderBottom:"0"},username:{display:"flex",alignContent:"center","& div:nth-child(2)":{justifyContent:"center"}},usernameAvatar:{margin:"0 10px"}})));var w=n("6Wru"),T=n("n7/H"),O=n("c3rw");const A=Object(y.makeStyles)((e=>Object(y.createStyles)({row:{"&:hover":{backgroundColor:e.palette.background.paper,cursor:"pointer"}},checkboxCell:{verticalAlign:"top",[e.breakpoints.up("sm")]:{verticalAlign:"middle"}},usernameCell:{display:"flex",flexDirection:"column"},username:{display:"inline-flex",alignItems:"center"},usernameAvatar:{marginInlineEnd:"10px"},usernameTextContainer:{display:"flex",flexDirection:"column",color:"inherit",textDecoration:"inherit","&:hover, &:focus, &:active":{color:"inherit",textDecoration:"inherit"},[e.breakpoints.down("md")]:{maxWidth:"calc(100% - 50px)"}},usernameText:e.typography.subtitle2,pronounsText:{fontSize:e.typography.overline.fontSize,fontWeight:e.typography.overline.fontWeight,color:e.palette.text.secondary},inlineStatus:{display:"flex",flexDirection:"column",marginInlineStart:"50px"}})));var P=n("50Q+");var x=n("nmzr");const $=e=>{var t,n,a,i,r,o;const{analyticsId:l,onSelection:c,row:d,selectedItems:u,requiresManualMarking:m}=e,p=Object(f.a)(),{formatDatetime:h}=Object(w.a)(),v=Object(y.useTheme)(),S=Object(y.useMediaQuery)(v.breakpoints.down("xs")),I=A(),k=Object(E.c)(null===(t=d.status)||void 0===t?void 0:t.state,m),$=(e=>{const t=Object(C.e)((t=>s.Yb.contentReviewState.getContentReviewStateUsersPermissions(t,e)));return null!=t?t:{viewDueDateException:!1,viewTimeLimitException:!1}})(d.contentId),N=s.a.hasAccommodations(d.courseMembership,$),D=u.isUserSelected(d.courseMembership.userId),L=null!==(a=null===(n=d.status)||void 0===n?void 0:n.reviewedDate)&&void 0!==a?a:null===(i=d.status)||void 0===i?void 0:i.startedDate;return g.a.createElement(b.AnalyticsTableRow,{analyticsId:`${l}.row`,key:`progress-student-${d.courseMembership.userId}`,onClick:()=>c({type:"user",userId:d.courseMembership.userId},!D),className:I.row},g.a.createElement(b.AnalyticsTableCell,{analyticsId:`${l}.cell.name`,className:I.checkboxCell},g.a.createElement(b.AnalyticsCheckbox,{analyticsId:`${l}.row.checkbox`,checked:D,inputProps:{"aria-labelledby":`row-${d.courseMembership.userId}`}})),g.a.createElement(b.AnalyticsTableCell,{analyticsId:`${l}.cell.name`,className:I.usernameCell},g.a.createElement("span",{className:I.username,id:`row-${d.courseMembership.userId}`},g.a.createElement(O.b,{size:"small",imgProps:{alt:"",src:null===(o=null===(r=d.courseMembership.user)||void 0===r?void 0:r.avatar)||void 0===o?void 0:o.permanentUrl},className:I.usernameAvatar}),g.a.createElement("a",{className:I.usernameTextContainer,href:"#",onClick:e=>{x.Z.goPeekState(Object(x.hb)({userId:d.courseMembership.userId,membershipId:d.courseMembership.id,studentTabId:"progress"})),e.stopPropagation()}},g.a.createElement(P.e,{user:d.courseMembership.user,format:T.ILocaleUsernameFormat.Short,ariaHidden:!1,showPronouns:!0,showPronunciation:!0,showAccommodation:N,userNameStyles:I.usernameText,pronounsStyles:I.pronounsText}))),S&&g.a.createElement("span",{className:I.inlineStatus},g.a.createElement("span",{dangerouslySetInnerHTML:{__html:p("courseContent.contentProgress.progressStatusValue",{statusLabel:k})}}),L&&g.a.createElement("span",null,p("courseContent.contentProgress.onDatetime",{datetime:L})))),!S&&g.a.createElement(b.AnalyticsTableCell,{analyticsId:`${l}.cell.name`},g.a.createElement(b.AnalyticsTypography,null,k),L?g.a.createElement(b.AnalyticsTypography,{variant:"body2"},h(L,T.ILocaleDatetimeFormat.Short)):void 0))};var N=n("AuQm"),D=n("/0oN"),L=n.n(D);const j=e=>{const{analyticsId:t,onSelection:n,onSortChanged:a,selectedItems:i,data:r,requiresManualMarking:s}=e,o=k(),l=Object(f.a)(),c=Object(E.h)("courseContent","courseContent.organization"),d=Object(y.useTheme)(),u=Object(y.useMediaQuery)(d.breakpoints.down("xs")),m=i.hasFilterSelection&&!i.hasUserOverrides;return g.a.createElement(b.AnalyticsSortableTable,{analyticsId:`${t}.table`,getAriaSortMessage:(e,t)=>{const n=l(`courseContent.contentProgress.table.columns.${e}`);return l(`courseContent.contentProgress.table.ariaSortMessage.${t}`,{columnName:n})},id:"content-progress-table",initialSortColumnId:"studentName",initialSortDirection:"asc",onSortChanged:a},g.a.createElement(b.AnalyticsTableHead,{analyticsId:`${t}.table.head`,className:o.tableHead},g.a.createElement(b.AnalyticsTableRow,{analyticsId:`${t}.table.row`},g.a.createElement(b.AnalyticsTableCell,{analyticsId:`${t}.table.cell.status`,id:"content-progress-table-header-checkbox",className:o.tableHeadAllStudents},g.a.createElement(b.AnalyticsTooltip,{analyticsId:`${t}.tooltip`,title:l(m?"courseContent.contentProgress.deselectAll":"courseContent.contentProgress.selectAll")},g.a.createElement(b.AnalyticsCheckbox,{analyticsId:`${t}.header.checkbox`,disabled:!r||0===r.length,checked:m,indeterminate:i.hasUserOverrides,onClick:()=>n({type:"header"},!m),inputProps:{"aria-label":l(m?"courseContent.contentProgress.deselectAll":"courseContent.contentProgress.selectAll")},"data-analytics-id":`${t}.header.checkbox`}))),g.a.createElement(y.SortableTableHeaderCell,{id:"content-progress-table-header-name",columnId:"studentName"},g.a.createElement("span",{className:o.tableHeadStudentName},l(c("courseContent.contentProgress.studentName")))),!u&&g.a.createElement(y.SortableTableHeaderCell,{id:"content-progress-table-header-progress",columnId:"progress"},l("courseContent.contentProgress.progressStatus")))),g.a.createElement(b.AnalyticsTableBody,{analyticsId:`${t}.body`},null==r?void 0:r.map((e=>{var a;return g.a.createElement($,{row:e,analyticsId:`${t}.row`,key:null===(a=e.courseMembership.user)||void 0===a?void 0:a.id,selectedItems:i,onSelection:n,requiresManualMarking:s})})),null!==r&&0===r.length?g.a.createElement(b.AnalyticsTableRow,{analyticsId:`${t}.emptyRow`},g.a.createElement(b.AnalyticsTableCell,{colSpan:3,analyticsId:`${t}.emptyCell`,className:o.tableEmptyRow},g.a.createElement(N.A,{illustration:L.a,prominentText:l("courseContent.contentProgress.table.noResults.noResultsFound"),subText:l("courseContent.contentProgress.table.noResults.tryAgain")}))):void 0))};var M=n("nsO7");const G=e=>{const t=Object(C.d)(),n=(e=>Object(C.e)((t=>s.Yb.contentReviewState.getContentReviewStateUsersStatusByQuery(t,e))))(e);Object(h.useEffect)((()=>{(null==n?void 0:n.isValid)||(null==n?void 0:n.isLoading)||t(s.V.contentReviewState.fetchContentReviewUserStatesByQuery(e))}),[t,null==n?void 0:n.isValid,null==n?void 0:n.isLoading]);const a=(e=>Object(C.e)((t=>s.Yb.contentReviewState.getContentReviewStateUsersByQuery(t,e))))(e);return n&&n.isValid&&!n.isLoading&&n.paging?{results:a,paging:n.paging}:null},R=Object(y.makeStyles)((e=>Object(y.createStyles)({listView:{margin:"0 -30px"},viewFilter:{display:"flex",flexDirection:"column",padding:"15px 30px",[e.breakpoints.up("sm")]:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"}},viewFilterOptions:{display:"flex",flexDirection:"column",alignItems:"stretch",[e.breakpoints.up("sm")]:{flexDirection:"row",alignItems:"center"}},sendMessageButton:{width:"100%",[e.breakpoints.up("sm")]:{width:"unset"}},searchTextControl:{[e.breakpoints.up("sm")]:{width:"275px"}},stateFilter:{margin:"10px 0",[e.breakpoints.up("sm")]:{margin:"0 10px"}},selectedStudents:{fontWeight:e.typography.fontWeightBold},selectedStudentsContainer:{backgroundColor:e.palette.background.paper,borderBottom:`1px solid ${e.palette.background.b5}`,borderTop:`1px solid ${e.palette.background.b5}`,padding:"8px 0",textAlign:"center"},listContainer:{padding:"0 30px",[e.breakpoints.down("md")]:{"& table":{tableLayout:"fixed"}}},pagingBottom:{display:"flex",justifyContent:"center",margin:"10px 0",[e.breakpoints.up("md")]:{justifyContent:"flex-end"}}})));var B;!function(e){e.All="All",e.Unopened="Unopened",e.Started="Started",e.Completed="Completed"}(B||(B={}));const F=g.a.memo((e=>{const{analyticsId:t,className:n,onChange:a,selectedState:i,requiresManualMarking:r}=e,s=Object(f.a)(),l=Object(E.c)(o.u.None,r),c=Object(E.c)(o.u.Started,r),d=Object(E.c)(o.u.Completed,r),u=[{value:B.All,label:s("courseContent.contentProgress.status.all")},{value:B.Unopened,label:l},{value:B.Started,label:c},{value:B.Completed,label:d}];return g.a.createElement(b.AnalyticsTextField,{floatingLabel:!0,style:{minWidth:"160px"},select:!0,className:n,id:"content-progress-view-status-filter",label:s("courseContent.contentProgress.progressStatus"),value:i,onChange:e=>a(e.target.value),analyticsId:`${t}.text`},u.map((e=>g.a.createElement(b.AnalyticsMenuItem,{button:!0,key:e.value,value:e.value,analyticsId:`${t}.option.${e.value}`,"data-analytics-id":`${t}.option.${e.value}`},e.label))))}));class U{constructor(e,t={}){this.selectedFilter=e,this.overrides=t}static none(){return new U}get hasFilterSelection(){return void 0!==this.selectedFilter}get filterSelection(){return this.selectedFilter}get hasUserOverrides(){return this.numberOfUserOverrides>0}get selectedUserOverrides(){return Object.keys(this.overrides).filter((e=>this.overrides[e]))}get numberOfUserOverrides(){return Object.keys(this.overrides).length}isUserSelected(e){return this.hasFilterSelection&&!this.hasUserOverrides||this.hasFilterSelection&&!1!==this.overrides[e]||!this.hasFilterSelection&&!0===this.overrides[e]}withUserSelection(e,t){const n={...this.overrides};return this.hasFilterSelection?t?delete n[e]:n[e]=!1:t?n[e]=!0:delete n[e],new U(this.selectedFilter,n)}withFilterSelection(e){return new U(e,{})}hasAnySelectedUsers(e){return this.numberOfSelectedUsers(e)>0}numberOfSelectedUsers(e){return this.hasFilterSelection?e-this.numberOfUserOverrides:this.numberOfUserOverrides}}function _(e){switch(e){case B.All:return[];case B.Unopened:return[o.u.None,o.u.Unlocked];case B.Started:return[o.u.Started];case B.Completed:return[o.u.Completed]}}const z=e=>{var t,n;const{analyticsId:a,courseId:i,contentId:r,requiresManualMarking:l=!0}=e,c=R(),d=Object(f.a)(),u=Object(E.h)("courseContent","courseContent.organization"),{messageContentProgress:m}=(()=>{const e=Object(C.d)();return{messageContentProgress:Object(h.useCallback)(((t,n,a,i)=>{if(!a.hasAnySelectedUsers(i))return Promise.resolve({recipientIds:[]});const r=a.filterSelection;if(!r)return Promise.resolve({recipientIds:a.selectedUserOverrides});const o=[];for(let a=0;a<i;a+=5e3)o.push(e(s.V.contentReviewState.fetchContentReviewUserStatesByQuery({courseId:t,contentId:n,filter:r,paging:{offset:a,limit:5e3},fields:["courseMembership.userId"]})));return Promise.all(o).then((e=>{const t=[];return e.forEach((e=>{e.data.results.forEach((e=>{a.isUserSelected(e.courseMembership.userId)&&t.push(e.courseMembership.userId)}))})),{recipientIds:t}}))}),[e])}})(),[p,v]=g.a.useState(""),[y,S]=g.a.useState(B.All),[k,w]=g.a.useState(0),[T,O]=g.a.useState(U.none()),[A,P]=g.a.useState([{field:s.A.FamilyName,direction:o.Wb.Ascending}]),$={courseId:i,contentId:r,sort:A,paging:{offset:25*k,limit:25},filter:{searchString:p,state:_(y)}},D=G($),L=void 0!==(null==D?void 0:D.paging.count)?Math.ceil(D.paging.count/25):void 0,z=null!==(t=null==D?void 0:D.paging.count)&&void 0!==t?t:0,q=g.a.useCallback(Object(M.debounce)((e=>{w(0),v(e),O(U.none())}),250),[]),H=g.a.useCallback((e=>{w(0),S(e),O(U.none())}),[]),V=e=>{O(e?T.withFilterSelection($.filter):U.none())},W=(e,t)=>{O(T.withUserSelection(e.userId,t))},K=g.a.useCallback(((e,t)=>{"header"===e.type?V(t):W(e,t)}),[T,V,W,O]),Y=g.a.useCallback((e=>e.sortDirection?(P([{direction:"desc"===e.sortDirection?o.Wb.Descending:o.Wb.Ascending,field:"studentName"===e.sortColumnId?s.A.FamilyName:s.A.LastStateChange}]),!0):(P([{direction:o.Wb.Ascending,field:s.A.FamilyName}]),{columnId:"studentName",sortDirection:o.Wb.Ascending})),[P]),J=g.a.useMemo((()=>({fullWidth:!1,className:c.searchTextControl})),[c]);return g.a.createElement(g.a.Fragment,null,g.a.createElement(I,{analyticsId:`${a}.breakdown`,courseId:i,contentId:r,requiresManualMarking:l}),g.a.createElement("div",{className:c.listView},g.a.createElement("div",{className:c.viewFilter},g.a.createElement("div",{className:c.viewFilterOptions},g.a.createElement(N.M,{inputId:"content-progress-view-name-filter",analyticsId:`${a}.filter.name`,label:d(u("courseContent.contentProgress.searchLabel")),TextFieldProps:J,onChange:q}),g.a.createElement(F,{onChange:H,selectedState:y,className:c.stateFilter,requiresManualMarking:l,analyticsId:`${a}.filter.state`})),g.a.createElement("div",null,g.a.createElement(b.AnalyticsOutlineButton,{analyticsId:`${a}.message`,"aria-label":d("courseContent.contentProgress.message"),className:c.sendMessageButton,onClick:()=>{var e;null===(e=m(i,r,T,z))||void 0===e||e.then((({recipientIds:e})=>{x.Z.goPeekState(Object(x.ab)({courseId:i,recipientIds:e.join(","),conversationPerRecipient:!0}))}))}},d("courseContent.contentProgress.message")))),T.hasAnySelectedUsers(z)?g.a.createElement("div",{className:c.selectedStudentsContainer,dangerouslySetInnerHTML:{__html:d(u("courseContent.contentProgress.selected.count"),{count:T.numberOfSelectedUsers(z)})}}):void 0,g.a.createElement("div",{className:c.listContainer},g.a.createElement(j,{analyticsId:`${a}.table`,data:null!==(n=null==D?void 0:D.results)&&void 0!==n?n:null,selectedItems:T,onSelection:K,onSortChanged:Y,requiresManualMarking:l}),g.a.createElement("div",{className:c.pagingBottom},L?g.a.createElement(N.I,{page:k,compact:!0,numberOfPages:L,onPageChange:w,analyticsId:a}):void 0))))},q=Object(y.makeStyles)((()=>Object(y.createStyles)({loading:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"}}))),H=e=>{const{courseId:t,contentId:n}=e,a=Object(f.a)(),i=q(),r=Object(E.a)(t,n),o=r&&s.j.requiresManualMarking(r),l=Object(E.o)({courseId:t}),c=l.gradebookColumns.find((e=>e.contentId===n)),d=!0===(null==c?void 0:c.anonymousGrading);return!r||null===l.view||l.view.isLoading?g.a.createElement("div",{className:i.loading},g.a.createElement(b.AnalyticsCircularProgress,{ariaLabel:a("global.loading"),size:"large"})):d?g.a.createElement(N.A,{illustration:L.a,prominentText:a("courseContent.contentProgress.progressAvailableAfterPostingGrades")}):g.a.createElement(z,{requiresManualMarking:o,...e})},V=Object(y.makeStyles)((e=>Object(y.createStyles)({contentTabs:{borderBottom:`1px solid ${e.palette.border.main}`,margin:"0 -30px",padding:"0 30px"}})));var W;!function(e){e.Content="content",e.Progress="progress"}(W||(W={}));const K=e=>{const{onChange:t,value:n,analyticsId:a}=e,i=V(),r=Object(f.a)(),s=Object(E.h)("courseContent","courseContent.organization"),o=[{id:W.Content,ariaControls:`content-tab-panel-${W.Content}`,displayKey:"courseContent.contentTabs.content"},{id:W.Progress,ariaControls:`content-tab-panel-${W.Progress}`,displayKey:s("courseContent.contentTabs.progress")}];return g.a.createElement("div",{className:i.contentTabs},g.a.createElement(b.AnalyticsTabs,{onChange:(e,n)=>t(n),value:null!=n?n:o[0].id,analyticsId:`${a}.content.contentTabs`},o.map((e=>g.a.createElement(b.AnalyticsTab,{analyticsId:`${a}.content.contentTabs.${e.id}`,className:`js-content-tab-${e.id}`,key:e.id,value:e.id,id:`content-tab-${e.id}`,label:r(e.displayKey),"aria-controls":e.ariaControls})))))};n.d(t,"e",(function(){return i})),n.d(t,"d",(function(){return r})),n.d(t,"h",(function(){return m})),n.d(t,"f",(function(){return c})),n.d(t,"g",(function(){return p})),n.d(t,"a",(function(){return H})),n.d(t,"b",(function(){return W})),n.d(t,"c",(function(){return K}))},kirn:function(e,t){e.exports='<bb-modal class="notification"\n  modal-title-key="course.content.assessment.settings.dueDate.isLateAttemptCreationDisallowed.label"\n  analytics-id-tag-prefix="course.content.assessment.settings.dueDate.isLateAttemptCreationDisallowed">\n  <div name="modal-contents">\n    <p bb-translate>course.content.assessment.settings.dueDate.isLateAttemptCreationDisallowed.restriction.description\n    </p>\n  </div>\n  <button name="modal-footer-button-primary" ng-click="$parent.$close(); assessmentOverview.navigateAttemptReview();"\n    class="button confirm-ok js-primary-button ng-scope" bb-translate\n    analytics-id="course.content.groupAttempt.edit.alreadySubmitted.dismiss">\n    course.content.groupAttempt.edit.alreadySubmitted.dismiss\n  </button>\n</bb-modal>\n'},klG7:function(e,t){e.exports='<bb-modal id="notification-modal-api-error"\n          class="notification"\n          modal-translate-options="translateOpts"\n          analytics-id-tag-prefix="components.services.error-modal.error-external-questions">\n  <div name="modal-contents">\n    <p bb-translate>{{descriptionKey}}</p>\n  </div>\n  <button name="modal-footer-button-primary"\n          ng-click="$parent.$dismiss()"\n          class="button js-primary-button"\n          bb-translate\n          analytics-id="components.services.error-modal.dismiss">components.services.error-modal.dismiss</button>\n</bb-modal>\n'},krSA:function(e,t){e.exports='<bb-modal id="notification-modal-api-error"\n          class="notification"\n          modal-title-key="components.services.error-modal.error.title"\n          analytics-id-tag-prefix="components.services.error-modal">\n  <div name="modal-contents">\n    <p>{{ errorString }}</p>\n    <bb-session-debug-modal-button></bb-session-debug-modal-button>\n  </div>\n  <button name="modal-footer-button-primary"\n          ng-click="$parent.$dismiss()"\n          class="button js-primary-button"\n          analytics-id="components.services.error-modal.dismiss"\n          bb-translate>components.services.error-modal.dismiss</button>\n</bb-modal>\n'},kwLz:function(e,t,n){"use strict";var a=n("ERkP"),i=n.n(a),r=n("7O4Y"),s=n("YK4x"),o=n("6Wru"),l=n("np6O"),c=n("+c/t"),d=n("/n7R"),u=n("n7/H"),m=n("ERsv"),p=n("Agfx");var h=Object(p.makeStyles)((()=>Object(p.createStyles)({editor:()=>({"& .bb-editor":{padding:0}}),actions:{display:"flex",flexDirection:"row",justifyContent:"flex-end",paddingTop:"5px"},placeholder:{fontStyle:"italic"}})));const g=i.a.forwardRef(((e,t)=>{const{ariaLabelledBy:n,isReadOnly:a,placeholder:s,pluginsConfig:o,rawTextFeedback:l,onChange:c}=e,{getEmbedSrc:d,openCloudStorageIntegrationModal:u}=o,p=h(e),g=[Object(m.link)(),Object(m.image)(),Object(m.video)(),Object(m.math)({...o}),Object(m.insertLocalFile)({...o}),Object(m.videoEverywhere)({...o}),Object(m.insertYoutubeVideo)({getEmbedSrc:d,...o})];return u&&g.push(Object(m.insertCloudStorageIntegrationFile)({openCloudStorageIntegrationModal:u,...o})),i.a.createElement("div",{ref:t,className:Object(r.a)({[p.editor]:e.isReadOnly},e.className)},a&&!l?i.a.createElement("div",{className:p.placeholder,id:"feedback-placeholder"},s):i.a.createElement(m.BbEditor,{bbml:l,isReadOnly:a,placeholder:s,ariaLabelledBy:n,plugins:g,onChange:c}))}));var b=g,f=n("tN4z");var v=Object(p.makeStyles)((()=>Object(p.createStyles)({collapsed:{overflow:"hidden",height:"136px",whiteSpace:"nowrap"},link:{padding:"10px 0px",display:"inline-block"},lineHeight:{lineHeight:1.6}})));const y=e=>{const[t,n]=i.a.useState(!0),[a,o]=i.a.useState(!1),l=i.a.createRef(),c=e.isFeedbackEditable&&!e.isReadOnly,d=v(),u=Object(s.a)();i.a.useEffect((()=>{var e;o(!c&&(null===(e=null==l?void 0:l.current)||void 0===e?void 0:e.clientHeight)>136)}),[e.isFeedbackEditable,e.isReadOnly,e.rawTextFeedback]);const m={showLessContentText:u("feedbackAuthoring.body.content.graderFeedback.showLessContent"),showMoreContentText:u("feedbackAuthoring.body.content.graderFeedback.showMoreContent")},p=i.a.useCallback((()=>n(!t)),[t]),h=t?`${e.analyticsId}.showMoreContent`:`${e.analyticsId}.showLessContent`;return i.a.createElement(i.a.Fragment,null,i.a.createElement(g,{className:Object(r.a)({[d.collapsed]:a&&t},d.lineHeight),ref:l,...e}),a&&i.a.createElement(f.AnalyticsLink,{className:d.link,onClick:p,analyticsId:h},t?m.showMoreContentText:m.showLessContentText))};var S=e=>{const{collapsible:t,...n}=e;return t?i.a.createElement(y,{...n}):i.a.createElement(b,{...n})};var C=Object(p.makeStyles)((()=>Object(p.createStyles)({actions:{display:"flex",flexDirection:"row",justifyContent:"flex-end",paddingTop:"5px"},action:{margin:"3px"}})));const E=e=>{const t=C(),{primary:n,className:i,...s}=e;return n?a.createElement(f.AnalyticsPrimaryButton,{className:Object(r.a)("primary-action-button",t.action,i),...s}):a.createElement(f.AnalyticsDefaultButton,{className:Object(r.a)("default-action-button",t.action,i),...s})},I=e=>{const t=C();return e.children?a.createElement("div",{className:Object(r.a)("feedback-editor-action-buttons",t.actions,e.className)},e.children):null},k=e=>{const{analyticsId:t,onChange:n,peerReviewer:a,...r}=e,{rawTextFeedback:o,pluginsConfig:{onClickCancel:l,onClickSave:c}}=e,d=Object(s.a)(),u=!e.isReadOnly&&e.isFeedbackEditable;let m;const p=i.a.useCallback((()=>{!a&&m&&m(o),l()}),[l]),h=i.a.useCallback((()=>{c()}),[c]),g=i.a.useCallback((e=>{m=e.setPristine,n(e)}),[n]),b=`${t}.feedbackEditor`,f={defaultButton:a?`${b}.saveDraft`:`${b}.cancel`,primaryButton:a?`${b}.submit`:`${b}.save`},v="feedbackAuthoring.body.content.graderFeedback.feedbackEditor",y={defaultButton:d(a?`${v}.draftLabel`:`${v}.cancelLabel`),primaryButton:d(a?`${v}.submitLabel`:`${v}.saveLabel`)};return i.a.createElement(i.a.Fragment,null,i.a.createElement(S,{analyticsId:b,...r,onChange:g}),u&&i.a.createElement(I,null,i.a.createElement(E,{analyticsId:f.defaultButton,onClick:p},y.defaultButton),i.a.createElement(E,{analyticsId:f.primaryButton,onClick:h,primary:!0},y.primaryButton)))};var w=n("0x+l");const T=Object(p.makeStyles)((e=>Object(p.createStyles)({graderDetails:{display:"flex",flexDirection:"row",marginBottom:"20px"},avatarWrapper:{marginRight:"10px"},nameAndDate:{width:"100%",display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"center",overflow:"hidden"},graderAttrs:{display:"flex",flexDirection:"column"},personalizationAndDate:{width:"100%",display:"flex",flexWrap:"wrap",justifyContent:"space-between"},pronunciation:{display:"inline-flex",alignItems:"center",margin:"0 -5px","& > span":{padding:"0 5px",fontWeight:e.typography.fontWeightRegular},"& $pronunciationAudio":{"& > button":{minWidth:0,minHeight:0,padding:"2px 5px 0"}}},pronunciationAudio:{},name:{color:e.palette.text.primary,fontWeight:e.typography.fontWeightSemiBold},date:{color:e.palette.text.hint,"&$dateLate":{color:e.palette.error.main}},dateLate:{},dateWrapper:{display:"flex",justifyContent:"flex-end"},fromCurrentStudentNameAndDate:{[e.breakpoints.up("sm")]:{flexDirection:"row",justifyContent:"flex-start",alignItems:"center"}},visibilityIcons:{height:"16px",width:"16px"}})));var O=n("MC1S");const A=Object(p.makeStyles)((e=>Object(p.createStyles)({fromCurrentStudentName:{minWidth:"fit-content",[e.breakpoints.up("sm")]:{flex:1}}})));var P=n("nmzr");const x=e=>{const{attemptId:t,isAnonymous:n,reviewee:o,reviewer:l}=e,c=Object(s.a)(),d=(e=>{const[t,n]=Object(a.useState)("#");return Object(a.useEffect)((()=>{P.Z.getPeekHref(Object(P.ib)(e)).then((e=>{n(e)}))}),[e]),t})({deepLinkAttemptId:t,...n?{peerIndex:o}:null}),u=i.a.createElement(O.Link,{className:Object(r.a)("js-submission-deep-link",{"js-anonymous-deep-link":n}),href:d,analyticsId:"course.grades.submissions-deep-link"},c(n?"feedbackAuthoring.body.content.graderFeedback.anonymousRevieweesSubmission":"feedbackAuthoring.body.content.graderFeedback.revieweesSubmission",{reviewee:o})),m=A();return i.a.createElement("span",{className:Object(r.a)(m.fromCurrentStudentName,"js-grader-title")},c("feedbackAuthoring.body.content.graderFeedback.reviewerReviewedRevieweeDeepLink",{reviewer:l,revieweesSubmission:u}))},$=Object(p.makeStyles)((e=>Object(p.createStyles)({editIcon:{color:e.palette.text.secondary,minHeight:"16px",minWidth:"16px","&:hover":{color:e.palette.text.primary}}})));const N=({analyticsId:e,editFeedbackCallback:t})=>{const n=Object(s.a)()("feedbackAuthoring.body.content.editAriaLabel"),a=$();return i.a.createElement(l.AnalyticsIconButton,{analyticsId:`${e}.content.edit`,className:Object(r.a)("js-edit-feedback-icon",a.editIcon),onClick:t,"aria-label":n},i.a.createElement(w.Edit,null))};var D=n("AuQm");const L=e=>{var t;const{attemptId:n,analyticsId:a,grader:s,userBeingGraded:m,ariaLabelledBy:p,rawTextFeedback:h,editorIsReadOnly:g,editorPlaceholder:b,attemptLastGradedDate:f,late:v,isFeedbackEditable:y,editorConfigProps:S,onFeedbackChange:C,isFeedbackFromCurrentStudent:E,showFeedbackVisibilityToggle:I,isFeedbackVisible:O,onClickChangeVisibility:A,onClickEdit:P,listIndex:$,isPeerGrading:L,showAnonymousWhenNoUserData:j,currentUserHasEnterFeedbackEntitlement:M}=e,G=T(),{formatUsername:R,formatDatetime:B,translate:F}=Object(o.a)(),U=h&&""!==h,_=f&&U,z=(s||m||j)&&U&&g,q=z&&!E&&(null==s?void 0:s.pronouns),H=z&&!E&&(null==s?void 0:s.pronunciation),V=y&&g&&S.peerReviewer,W=i.a.useMemo((()=>F(O?"feedbackAuthoring.body.content.graderFeedback.feedbackVisibleToStudent":"feedbackAuthoring.body.content.graderFeedback.feedbackHiddenFromStudent")),[O,F]),K=i.a.useMemo((()=>{if(!s)return"";const e=R(s,u.ILocaleUsernameFormat.Short);return F("feedbackAuthoring.body.content.graderFeedback.hideFeedbackFromStudentWithName",{grader:e})}),[s,R,F]),Y=(e,t,a=!1)=>i.a.createElement(x,{attemptId:n,isAnonymous:a,reviewee:t,reviewer:e});return i.a.createElement("div",{className:"js-grader-feedback"},i.a.createElement("div",{className:G.graderDetails},z&&i.a.createElement("div",{className:G.avatarWrapper},((e,t)=>{const n=E?t:e;return(null==n?void 0:n.avatarUrl)?i.a.createElement(c.a,{size:"medium",src:n.avatarUrl,"aria-hidden":!0,className:"non-anonymous-avatar"}):i.a.createElement(c.a,{size:"medium","aria-hidden":!0,className:"anonymous-avatar"})})(s,m)),(z||_)&&i.a.createElement("div",{className:E?Object(r.a)(G.nameAndDate,G.fromCurrentStudentNameAndDate):G.nameAndDate},z&&(()=>{if(L){if(E){const e=F("feedbackAuthoring.body.content.graderFeedback.droppedStudent"),t=M&&!s?e:R(s,u.ILocaleUsernameFormat.Short);if(M){const n=m?R(m,u.ILocaleUsernameFormat.Short):e;return Y(t,n)}return Y(t,$,!0)}if(!s)return M?i.a.createElement("div",{className:Object(r.a)(G.name,"js-grader-title","js-dropped-student-peer-number")},F("feedbackAuthoring.body.content.graderFeedback.droppedStudentWithNumber",{number:$})):i.a.createElement("div",{className:Object(r.a)(G.name,"js-grader-title","js-name-peer-number")},F("feedbackAuthoring.body.content.graderFeedback.peerReviewWithNumber",{number:$}))}return i.a.createElement("div",{className:Object(r.a)(G.name,"js-grader-title")},R(s,u.ILocaleUsernameFormat.Short))})(),i.a.createElement("div",{className:G.personalizationAndDate},i.a.createElement("div",{className:Object(r.a)(G.graderAttrs)},H&&i.a.createElement("span",{className:G.pronunciation},i.a.createElement("span",null,s.pronunciation),(null===(t=s.pronunciationAudio)||void 0===t?void 0:t.permanentUrl)&&i.a.createElement(D.D,{className:G.pronunciationAudio,src:s.pronunciationAudio.permanentUrl,analyticsId:"graderFeedback.pronunciation"})),q&&i.a.createElement("span",null,s.pronouns)),_&&(()=>{let e=B(new Date(f),u.ILocaleDatetimeFormat.Short);return v&&(e=F("feedbackAuthoring.body.content.graderFeedback.lastGradedLate",{dateGraded:e})),i.a.createElement("div",{className:G.dateWrapper},i.a.createElement("div",{className:Object(r.a)(G.date,{[G.dateLate]:v})},e))})())),V&&i.a.createElement(N,{editFeedbackCallback:P,analyticsId:a}),I&&i.a.createElement(d.AnalyticsTooltip,{title:W,className:"js-visibility-tooltip",analyticsId:`${a}.graderFeedback.visibilityTooltip`,placement:"top-end"},i.a.createElement(l.AnalyticsIconButton,{analyticsId:`${a}.graderFeedback.visibilityIcon`,"aria-pressed":!O,"aria-label":K,className:Object(r.a)(G.visibilityIcons,O?"visible-icon":"invisible-icon"),onClick:()=>null==A?void 0:A()},O?i.a.createElement(w.Visible,null):i.a.createElement(w.Invisible,null)))),i.a.createElement(k,{analyticsId:`${a}.graderFeedback`,rawTextFeedback:h,ariaLabelledBy:p,isReadOnly:g,placeholder:b,onChange:C,pluginsConfig:S,isFeedbackEditable:y,peerReviewer:S.peerReviewer,collapsible:!0}))};var j=n("eqO1");const M=Object(j.l)((e=>Object(j.e)({list:{listStyle:"none",margin:0},listItem:{paddingBottom:"12px",borderBottom:`1px solid ${e.palette.border.main}`,marginBottom:"12px"}}))),G=e=>{const{analyticsId:t,configProps:n,secondaryGradersFeedback:a,showFeedbackVisibilityToggle:r}=e,s=M(),{isPeerGrading:o,currentUserHasEnterFeedbackEntitlement:l,editorConfigProps:c}=n,d=a.map((e=>i.a.createElement("li",{className:s.listItem,key:e.id},i.a.createElement(L,{analyticsId:t,...e,editorIsReadOnly:!0,ariaLabelledBy:"secondary-feedback-title",editorConfigProps:c,showFeedbackVisibilityToggle:r,isPeerGrading:o,currentUserHasEnterFeedbackEntitlement:l}))));return i.a.createElement("ul",{className:s.list},d)},R=Object(p.makeStyles)((e=>Object(p.createStyles)({container:{marginTop:"28px"},primaryContainer:{display:"flex",justifyContent:"space-between",marginBottom:"14px"},primaryTitle:{fontFamily:e.typography.fontFamily,fontWeight:e.typography.fontWeightSemiBold,margin:0},secondaryContainer:{marginTop:"37px"},secondaryTitle:{fontFamily:e.typography.fontFamily,fontWeight:e.typography.fontWeightSemiBold}})));const B=e=>{const{analyticsId:t,feedbackContentType:n,primaryGraderFeedback:a,secondaryGradersFeedback:o,configProps:{isPeerGrading:l,currentUserHasEnterFeedbackEntitlement:c,primaryFeedbackConfigProps:d,isOrganization:u,editorConfigProps:m,showFeedbackVisibilityToggle:p}}=e,h=Object(s.a)(),g=R(),{editorPlaceholder:b,onClickEdit:f,editorIsReadOnly:v,showPeerReviewerSpecificText:y}=d,S=null==a?void 0:a.isFeedbackEditable,C=o&&o.length>0,E=u?"organization":"course",I=S?"feedbackEditable":"feedbackNotEditable",k=l?"feedbackAuthoring.body.content.peerGraders.secondaryGradersTitle":"feedbackAuthoring.body.content.secondaryGradersTitle",w="organization"===E?`${E}`:`${E}.${n}`,T=m.peerReviewer,O=C&&!T,A=!C&&l&&!T,P=S&&v&&!T,x=h("feedbackAuthoring.body.content.noReviewsByOthers"),$=h("feedbackAuthoring.body.content.primaryGraderTitle.course.peerReviewerSubtitle"),D=h(k);let j,M;a&&(j=h(y&&!T?"feedbackAuthoring.body.content.primaryGraderTitle.student":`feedbackAuthoring.body.content.primaryGraderTitle.${w}`),M=b||h(y&&T?"feedbackAuthoring.body.content.editorPlaceholder.reviewer":`feedbackAuthoring.body.content.editorPlaceholder.${I}.${E}`));const B={isOrganization:u,isPeerGrading:l,currentUserHasEnterFeedbackEntitlement:c,editorConfigProps:m,secondaryFeedbackConfigProps:{title:D}};return i.a.createElement("div",{className:Object(r.a)("js-feedback-content-container",g.container)},a&&i.a.createElement("div",{className:Object(r.a)("js-feedback-content-primary-container",g.primaryContainer)},i.a.createElement("h3",{id:"primary-feedback-title",className:g.primaryTitle},j),P&&i.a.createElement(N,{editFeedbackCallback:f,analyticsId:t})),T&&i.a.createElement("p",{className:"js-peer-reviewer-subtitle"},$),a&&i.a.createElement(L,{...a,...d,analyticsId:`${t}.content.primaryFeedback`,ariaLabelledBy:"primary-feedback-title",editorPlaceholder:M,editorConfigProps:m,isPeerGrading:l}),O&&i.a.createElement("div",{className:g.secondaryContainer},i.a.createElement("h3",{className:g.secondaryTitle},D),i.a.createElement(G,{analyticsId:`${t}.content.secondaryFeedback`,secondaryGradersFeedback:o,configProps:B,showFeedbackVisibilityToggle:p})),A&&i.a.createElement("div",{className:Object(r.a)("js-empty-secondary-feedback-section",g.secondaryContainer)},i.a.createElement("h3",{className:g.secondaryTitle},D),x))};var F=n("jYYR");const U=Object(p.makeStyles)((e=>Object(p.createStyles)({feedbackBody:{paddingLeft:"16px",paddingRight:"16px",paddingBottom:"0 !important",paddingTop:0,[e.breakpoints.up("sm")]:{paddingLeft:0,paddingRight:0}},feedbackTabs:{margin:"0 -30px",display:"flex",backgroundColor:e.palette.background.b2,borderBottom:`1px solid ${e.palette.border.main}`,"& $tabButton":{flex:1,margin:0,padding:0,height:"45px",transition:"background-color 200ms ease-out","&:before":{borderBottom:"none"},"&:hover":{backgroundColor:e.palette.background.b3},'&[aria-selected="true"]':{backgroundColor:e.palette.background.default,"&:before":{left:0,right:0,borderBottom:`4px solid ${e.palette.brand.main}`}},"&:first-child":{borderRight:`1px solid ${e.palette.border.main}`},"&:only-child":{borderRight:"0"}}},tabButton:{}})));var _;!function(e){e.General="GENERAL",e.Individual="INDIVIDUAL"}(_||(_={}));const z=e=>{const{analyticsId:t,configProps:{initialSelectedTabKey:n,isFeedbackForGroupSubmission:a,...o},...l}=e,c=Object(s.a)(),d=U(),u=n||_.General,m=i.a.createElement(B,{analyticsId:`${t}.feedbackBody`,configProps:{...o},feedbackContentType:n===_.General?"group":"individual",...l}),p=t=>{const{configProps:{onGroupTabChange:n}}=e;n&&n(t)};return i.a.createElement("div",{className:d.feedbackBody},a?i.a.createElement(i.a.Fragment,null,i.a.createElement(f.AnalyticsTabs,{value:u,className:Object(r.a)("js-feedback-tabs",d.feedbackTabs),analyticsId:`${t}.feedbackBody.tabs`},i.a.createElement(f.AnalyticsTab,{label:c("feedbackAuthoring.body.groupTab"),value:_.General,className:d.tabButton,analyticsId:`${t}.feedbackBody.group`,onClick:()=>p(_.General)}),i.a.createElement(f.AnalyticsTab,{label:c("feedbackAuthoring.body.individualTab"),value:_.Individual,className:d.tabButton,analyticsId:`${t}.feedbackBody.individual`,onClick:()=>p(_.Individual)})),i.a.createElement(F.a,{panelId:u,ariaLabelledby:u},m)):m)};var q=n("A4Z1");const H=e=>{const{analyticsId:t,configProps:n,secondaryGradersFeedback:a}=e,r={noReviewsForStudent:Object(s.a)()("feedbackAuthoring.body.content.noReviewsForStudent")};return i.a.createElement(q.a,{theme:"light"},a.length>0&&i.a.createElement(G,{configProps:n,secondaryGradersFeedback:a,analyticsId:`${t}.feedbackList.secondaryFeedback`}),0===a.length&&n.isPeerGrading&&i.a.createElement("div",{className:"js-feedback-list-no-reviews-for-student"},r.noReviewsForStudent))};var V=n("8jBL");const W=e=>{const{analyticsId:t,onNavigateToNextFeedback:n,onNavigateToPreviousFeedback:a}=e,r=Object(s.a)();return i.a.createElement(i.a.Fragment,null,i.a.createElement(l.AnalyticsIconButton,{onClick:a,disabled:!a,"aria-label":r("feedbackAuthoring.header.previous"),analyticsId:`${t}.navigator.previous`},i.a.createElement(V.ArrowLeft,null)),i.a.createElement(l.AnalyticsIconButton,{onClick:n,disabled:!n,"aria-label":r("feedbackAuthoring.header.next"),analyticsId:`${t}.navigator.next`},i.a.createElement(V.ArrowRight,null)))},K=Object(j.l)((e=>Object(j.e)({inlineNavigation:{height:"40px",marginTop:"28px",display:"flex",alignItems:"center",justifyContent:"space-between",paddingBottom:"15px",borderBottom:`1px solid ${e.palette.secondary.light}`,marginLeft:"-16px",marginRight:"-16px",[e.breakpoints.up("sm")]:{marginLeft:"-30px",marginRight:"-30px"}},inlineNavigationTitle:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",fontWeight:e.typography.fontWeightSemiBold,fontSize:e.typography.fontSizeMedium,marginLeft:"18px"},inlineNavigationArrows:{whiteSpace:"nowrap",marginRight:"18px"}}))),Y=e=>{const t=K(),{analyticsId:n,inlineConfigProps:a,primaryGraderFeedback:r,secondaryGradersFeedback:s}=e,o=`${n}.feedbackAuthoring.components`;return i.a.createElement("div",null,a.showNavigator&&i.a.createElement("div",{className:t.inlineNavigation},i.a.createElement("div",{className:t.inlineNavigationTitle,id:"inline-feedback-navigation-title"},a.navigationTitle),i.a.createElement("div",{className:t.inlineNavigationArrows},i.a.createElement(W,{onNavigateToNextFeedback:a.onNavigateToNextFeedback,onNavigateToPreviousFeedback:a.onNavigateToPreviousFeedback,analyticsId:o}))),i.a.createElement(z,{analyticsId:o,configProps:a,primaryGraderFeedback:r,secondaryGradersFeedback:s}))};var J=n("Zwiy");const Z=()=>Object(p.createStyles)({overflowEllipsis:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}}),Q=Object(p.makeStyles)((e=>Object(p.createStyles)({feedbackHeader:t=>({"& .ms-Panel-header":{boxShadow:"none",[e.breakpoints.up("sm")]:{alignItems:"flex-end",minHeight:0,".header-actions":{margin:0,flex:0}},".ms-Panel-titles-container":{maxWidth:"100%",[e.breakpoints.up("sm")]:{position:"static"},".ms-Panel-subTitle":{...Z().overflowEllipsis},".ms-Panel-headerText":{...Z().overflowEllipsis,textAlign:"center",[e.breakpoints.up("sm")]:{textAlign:"start",fontSize:e.typography.fontSizeXXLarge,fontFamily:e.typography.fontFamilySerif,color:e.palette.primary.main}},".ms-Panel-content-right":{".is-disabled":{color:e.palette.secondary.light}}}},[e.breakpoints.up("sm")]:{"& .ms-Panel-commands":{backgroundColor:e.palette.background.default}}}),navigator:{"& .ms-Panel-header":{"& .ms-Panel-content-right":{"& .ms-Button":{color:e.palette.secondary.light,[e.breakpoints.up("sm")]:{color:"inherit"}},"& .is-disabled":{color:e.palette.text.disabled,[e.breakpoints.up("sm")]:{color:"inherit"}}},"& .ms-Panel-titles-container":{[e.breakpoints.only("xs")]:{position:"static",left:"90px",minWidth:"calc(100% - 180px)"},[e.breakpoints.up("sm")]:{maxWidth:"calc(100% - 76px)"}}}}})));const X=e=>{const t=Q(e),n=Object(s.a)(),{configProps:{onNavigateToNextFeedback:a,onNavigateToPreviousFeedback:o,showNavigator:l},analyticsId:c,headerSubtitle:d,headerTitle:u}=e,m=`${c}.feedbackHeader`,p={title:u,smallHeaderTitle:d||n("feedbackAuthoring.header.smallTitle"),type:J.BbPanelType.full,analyticsId:m,navMenuAriaLabel:n("global.navigationMenu")};return l&&(p.panelContentRight=i.a.createElement(W,{onNavigateToNextFeedback:a,onNavigateToPreviousFeedback:o,analyticsId:m})),i.a.createElement("header",{className:Object(r.a)("panel-header","simple-header",t.feedbackHeader,{[t.navigator]:l})},i.a.createElement(J.BbPanelHeader,{...p}))};var ee=Object(p.makeStyles)((e=>Object(p.createStyles)({container:{"&:before":{content:"",display:"block",height:"5px",left:"-1px",position:"absolute",right:"-1px",top:"-1px"}}})));const te=e=>{const t=ee(),{analyticsId:n,panelConfigProps:a,primaryGraderFeedback:s,secondaryGradersFeedback:o,panelSubtitle:l,panelTitle:c}=e,d={showNavigator:a.showNavigator,onNavigateToNextFeedback:a.onNavigateToNextFeedback,onNavigateToPreviousFeedback:a.onNavigateToPreviousFeedback},u={isOrganization:a.isOrganization,initialSelectedTabKey:a.initialSelectedTabKey,isFeedbackForGroupSubmission:a.isFeedbackForGroupSubmission,primaryFeedbackConfigProps:a.primaryFeedbackConfigProps,onGroupTabChange:a.onGroupTabChange,editorConfigProps:a.editorConfigProps},m=`${n}.feedbackAuthoring.components`;return i.a.createElement("div",{className:Object(r.a)("panel-wrap","course-color","js-feedback-panel-container",t.container,a.courseColorClass)},i.a.createElement(X,{analyticsId:m,configProps:d,headerTitle:c,headerSubtitle:l}),i.a.createElement(z,{analyticsId:m,configProps:u,primaryGraderFeedback:s,secondaryGradersFeedback:o}))},ne=e=>{const{isInlineMode:t,configProps:n,...a}=e,{allowMultipleFeedbackNavigation:r,...s}=n,o={showNavigator:r,...s};return t&&(o.navigationTitle=a.panelTitle),i.a.createElement(i.a.Fragment,null,t?i.a.createElement(Y,{...a,inlineConfigProps:o}):i.a.createElement(te,{...a,panelConfigProps:o}))};n.d(t,"c",(function(){return _})),n.d(t,"b",(function(){return H})),n.d(t,"a",(function(){return ne}))},lBPC:function(e,t){e.exports='\n<footer class="panel-footer notification toast-container">\n  <bb-save-tray tray-type="LoadMoreResults"\n                tray-id="{{::trayId}}"\n                tray-localization-keys-prefix="{{::trayLocalizationKeysPrefix}}">\n  </bb-save-tray>\n</footer>'},lCpV:function(e,t,n){"use strict";var a=n("nbDY"),i=n.n(a);class r extends i.a{}r.Discussions=new r("discussions"),r.Participants=new r("participants"),t.a=r},lDJ8:function(e,t,n){"use strict";n("abLi"),n("6BRP");var a=n("nsO7"),i=n("71td"),r=n("Llzl"),s=n("0JpG"),o=n("nPfc"),l=n("lEL+"),c=n("GbAM");n.d(t,"a",(function(){return d}));const d="ultra.directives.validationMessages";class u{constructor(e,t,n,a,i,r){this.$rootScope=e,this.scope=t,this.element=n,this.attrs=a,this.form=i,this.timeout=r,this.error=!1,this.immediateUpdate=!1,this.elements=[],u._$rootScope=e,t.labels=[],u.onDirectiveAdded(),t.$on("$destroy",(()=>{u.onDirectiveRemoved()}));const s=a.for;if(!s)throw new Error("`for` attribute is required.");s.split(",").forEach((e=>{const t=i[e];null==t.$warning&&(t.$warning={}),null==t.$errorImmediate&&(t.$errorImmediate={}),this.elements.push(t)})),t.$watch(this.updateMessages.bind(this)),t.$watch((()=>document.activeElement),((e,t)=>{e!==t&&this.updateMessages()})),t.$watch((()=>t.showErrors)),this.elements&&this.elements.length&&t.$watch((()=>this.elements[0].$invalid),((e,t)=>{e&&e!==t?(this.immediateUpdate=!0,this.updateMessages()):this.immediateUpdate=!1}))}updateMessages(){this.scope.showOnsubmitErrors=!1,this.scope.showErrors=!1,this.scope.showImmediateErrors=!1,this.scope.showWarnings=!1,this.scope.labels.length=0;let e=[];if(this.form.$submitted){const t=a.filter(this.elements,(e=>Object.keys(e.$error).length>0));e=a.map(t,"$label");const n=a.merge.apply(null,a.map(t,"$error"))||{},i=Object.keys(n);i.length>0&&(this.scope.showOnsubmitErrors=!0,this.scope.onsubmitErrors={},i.forEach((e=>{this.scope.onsubmitErrors[e+"Onsubmit"]=n[e]})),this.readAriaLiveMessage(this.element.find(".form-element-onsubmit-errors").text(),"alert"))}else{const t=document.activeElement,n=a.find(this.elements,{$name:t.name});if(n&&n.$errorImmediate&&Object.keys(n.$errorImmediate).length>0)return this.scope.showImmediateErrors=!0,this.scope.immediateErrors=n.$errorImmediate,this.readAriaLiveMessage(this.element.find(".form-element-immediate-errors").text(),"alert"),!0;if(!u.mouseIsDown||this.error||this.immediateUpdate){const n=this.immediateUpdate?this.elements:a.filter(this.elements,(e=>(e.$touched||e.$dirty||this.scope.checkWhenInit&&this.scope.checkWhenInit())&&(!(t.name===e.$name)||this.scope.immediate&&this.scope.immediate()))),i=a.filter(n,(e=>Object.keys(e.$error).length>0)),r=a.merge.apply(null,a.map(i,"$error"))||{};r&&Object.keys(r).length>0?(this.error=this.scope.showErrors=!0,this.scope.errors=r,e.push.apply(e,a.map(i,"$label")),this.readAriaLiveMessage(this.element.find(".form-element-errors").text(),"alert")):this.error=!1}if(!this.scope.showOnsubmitErrors&&!this.scope.showErrors){const e=a.filter(this.elements,(e=>Object.keys(e.$warning).length>0)),t=a.merge.apply(null,a.map(e,"$warning"))||{};t&&Object.keys(t).length>0&&(this.scope.showWarnings=!0,this.scope.warnings=t,this.readAriaLiveMessage(this.element.find(".form-element-warnings").text(),"status"))}}return this.scope.labels.push.apply(this.scope.labels,a.compact(e)),!0}readAriaLiveMessage(e,t){this.timeout((()=>{"alert"===t?this.scope.$root.$broadcast(c.a,e.trim()):this.scope.$root.$broadcast(c.b,e.trim())}),this.scope,0,!1)}}u.mouseIsDown=!1,u._directiveCount=0,u.onDirectiveAdded=()=>{const e=0===u._directiveCount;u._directiveCount++,e&&(u.mouseDownHandler||(u.mouseDownHandler=e=>{const t=i(e.target);(t.parents("ng-form").length||t.parents("form").length)&&u._$rootScope.$apply((()=>{t.is("[type=submit]")||(u.mouseIsDown=!0)}))}),u.mouseUpHandler||(u.mouseUpHandler=e=>{const t=i(e.target);(t.parents("ng-form").length||t.parents("form").length)&&u._$rootScope.$apply((()=>{u.mouseIsDown=!1}))}),i(document).on("mousedown",u.mouseDownHandler),i(document).on("mouseup",u.mouseUpHandler))},u.onDirectiveRemoved=()=>{const e=u._directiveCount<=1;u._directiveCount--,e&&(i(document).off("mousedown",u.mouseDownHandler),i(document).off("mouseup",u.mouseUpHandler))};class m{constructor(e,t,n){this.bbLocalize=e,this.$rootScope=t,this.timeout=n,this.scope={immediate:"&?",checkWhenInit:"&?"},this.require="^form",this.restrict="A",this.transclude=!0,this.link=(e,t,n,a)=>(this.bbLocalize.loadBundle("components/directives/validation-messages"),new u(this.$rootScope,e,t,n,a,this.timeout)),this.template=o}}r.module(d,["ngMessages",s.moduleName]).directive("bbValidationMessages",[s.serviceName,"$rootScope",l.b,(e,t,n)=>new m(e,t,n)]).directive("ngModel",(()=>({restrict:"A",require:"ngModel",priority:-9999,link:(e,t,n,a)=>{const i=t[0],r=t.parents().last();if(i.hasAttribute("aria-label"))e.$watch((()=>i.getAttribute("aria-label")),(e=>a.$label=e));else if(i.hasAttribute("aria-labelledby")){const t=i.getAttribute("aria-labelledby").split(" ")[0],n=r.find("#"+t)[0];n&&e.$watch((()=>n.textContent),(e=>a.$label=e))}else{const t=r.find('label[for="'+i.id+'"]')[0];t&&e.$watch((()=>t.textContent),(e=>a.$label=e))}}})))},"lEL+":function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var a=n("Llzl");const i="ultra.services.timeout",r="timeout";a.module(i,[]).factory(r,["$timeout",e=>{const t=(t,n,a,i)=>{const r=e((function(...e){return r.__bb_unregister_scope_destroy__&&(r.__bb_unregister_scope_destroy__(),r.__bb_unregister_scope_destroy__=null),t.apply(this,e)}),a,i);return r.__bb_unregister_scope_destroy__=n.$on("$destroy",(()=>{e.cancel(r)})),r};return t.cancel=t=>(t&&t.__bb_unregister_scope_destroy__&&(t.__bb_unregister_scope_destroy__(),t.__bb_unregister_scope_destroy__=null),e.cancel(t)),t}])},"lUN/":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n("71td");function i(){return a.extend(a.expr[":"],{tabbable(e){const t=a.attr(e,"tabindex"),n=null!=t;return(!n||t>=0)&&function(e,t){let n,i,r,s,o;const l=e.nodeName.toLowerCase();if("area"===l)return n=e.parentNode,i=n.name,!(!e.href||!i||"map"!==n.nodeName.toLowerCase())&&(r=a("img[usemap='#"+i+"']"),r.length>0&&r.is(":visible"));/^(input|select|textarea|button|object)$/.test(l)?(s=!e.disabled,s&&(o=a(e).closest("fieldset")[0],o&&(s=!o.disabled))):s="a"===l&&e.href||t;return s&&a(e).is(":visible")}(e,n)}})}},lVRt:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"d",(function(){return s}));const a="currentCourse",i="membership",r="currentContent",s="studentPreviewStatus"},lmMM:function(e,t,n){"use strict";(function(e){n.d(t,"d",(function(){return p})),n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return v}));var a=n("nsO7"),i=n("Llzl"),r=n("nbDY"),s=n.n(r),o=n("Fvsw"),l=n("0JpG"),c=n("12mu"),d=n("pjml"),u=n("abE0"),m=n("Y+9S");const p="ultra.directives.confirmationNeeded",h="components.directives.confirmation-needed.",g="dont-ask-again",b="show-confirmation";class f extends s.a{}function v(e,t){return h+t+"-"+e}f.Always=new f("always"),f.Once=new f("once"),f.UserChoice=new f("userChoice");class y{constructor(e,t,n,a,i,r){this.scope=e,this.attrs=n,this.$q=a,this.bbContext=i,this.$modal=r,this.clickHandling=!1,this.scope.confirmationNeeded=this,this.scope.modalAriaType=this.attrs.modalAriaType,this.scope.nextSelector=this.attrs.nextSelector,e.$on(b,((e,t,n)=>{t===this.attrs.modalName&&this.handleButtonClick(n)})),t.on("click",(e=>{this.handleButtonClick(e)})),e.$on("$destroy",(()=>{t.off()})),e.$on("dismiss-confirmation",(()=>{this.modalInstance&&this.modalInstance.dismiss()}))}handleButtonClick(e){if(this.clickHandling)return;let t;if(this.clickHandling=!0,this.attrs.getConfirmationKeyAndShowType)t=this.$q.when(this.scope.$eval(this.attrs.getConfirmationKeyAndShowType));else{if(!this.attrs.bbConfirmationNeeded)return void(this.clickHandling=!1);t=this.$q.when({confirmationKey:this.attrs.bbConfirmationNeeded,showType:this.attrs.showType})}e&&(e.stopImmediatePropagation&&e.stopImmediatePropagation(),e.preventDefault()),t.then((t=>{if(t.confirmationKey)switch(this.resourceType=t.confirmationKey.replace("resource/",""),this.choices=[],f.parse(t.showType)){case f.Always:this.confirmAction(e);break;case f.Once:this.showConfirmationActionOnlyOnce(e);break;default:this.showConfirmationActionByUserChoice(e)}else this.invokeClickAction(e)}))}showConfirmationActionOnlyOnce(e){this.bbContext.getPreference(this.createPreferenceKey(g),"false").then((t=>{"true"===t.value?this.invokeClickAction(e):this.confirmAction(e)}))}createResourceKey(e){return h+e+"-"+this.resourceType}createPreferenceKey(e){return"{{context}}.confirmation".replace("{{context}}",this.resourceType+"-"+e).replace(/\-/g,".")}addToChoices(e,t,n){let a;a=this.attrs.modalContext&&"predict"===this.attrs.modalContext?{key:e,value:!!t,localizedKey:e,preferenceKey:this.createPreferenceKey(e),isDisable:!!n}:{key:e,value:!!t,localizedKey:this.createResourceKey(e),preferenceKey:this.createPreferenceKey(e),isDisable:!!n};this.choices.some((t=>t.key===e))||this.choices.push(a)}parseChoicesFromAttr(e){if(e&&e.length)for(let t=0;t<e.length;t++)this.addToChoices(e[t].key,e[t].value,e[t].isDisable)}showConfirmationActionByUserChoice(e){this.bbContext.getPreference(this.createPreferenceKey(g),"false").then((t=>{if("true"===t.value)if(this.attrs.choices){const t=JSON.parse(this.attrs.choices),n=[];t.forEach((e=>{n.push(this.bbContext.getPreference(this.createPreferenceKey(e.key),"false").then((t=>{const n="true"===t.value;this.scope.$emit(e.key,n)})))})),this.$q.all(n).then((()=>{this.invokeClickAction(e)}))}else this.invokeClickAction(e);else this.addToChoices(g),this.confirmAction(e)}),(()=>{this.addToChoices(g),this.confirmAction(e)}))}confirmAction(e){let t;this.scope.titleKey=this.createResourceKey("title"),this.scope.instructionsKey=this.createResourceKey("instructions"),this.scope.cancelKey=this.createResourceKey("cancel"),this.scope.okKey=this.createResourceKey("ok"),this.attrs.choices&&this.attrs.choices.length>0&&this.parseChoicesFromAttr(JSON.parse(this.attrs.choices)),t=this.attrs.customClass?u.replace(/class="notification"/,'class="notification '+this.attrs.customClass+'"'):u;const n=this;this.modalInstance=this.$modal.open({template:t,scope:n.scope,resolve:{translations:[l.serviceName,e=>e.loadBundle("components/directives/confirmation-needed")]},controller:["$scope",l.serviceName,function(e,t){e.okAction=()=>{e.$close(),n.okClicked=!0},e.cancelAction=()=>{n.attrs.otherChoiceAction?(e.$close(),n.okClicked=!1):e.$dismiss(),Object(m.o)(m.c.CancelClicked)};let i={};n.attrs.modalTranslateOptions&&(i=e.$eval(n.attrs.modalTranslateOptions)),e.modalTranslateOptions={},e.modalStrings={title:null,instructions:null,cancel:null,ok:null},Object.keys(e.modalStrings).forEach((n=>{e.modalTranslateOptions[n]=a.merge({key:e[n+"Key"]},i[n]),e.modalStrings[n]=t.translateSync(e.modalTranslateOptions[n])}))}]}),this.modalInstance.result.then((()=>{this.okClicked?(this.persistResult(),this.invokeClickAction(e)):(this.scope.$eval(this.attrs.otherChoiceAction),this.clickHandling=!1)}),(()=>{this.attrs.dismissCallback&&this.scope.$eval(this.attrs.dismissCallback),this.clickHandling=!1}))}persistResult(){switch(f.parse(this.attrs.showType)){case f.Always:this.choices.forEach((e=>{this.scope.$emit(e.key,e.value)}));break;case f.Once:this.bbContext.setPreference(this.createPreferenceKey(g),"true");break;default:this.choices.forEach((e=>{e.value&&(this.scope.$emit(e.key,e.value),this.bbContext.setPreference(e.preferenceKey,e.value.toString()))}))}}invokeClickAction(t){this.scope.$eval(this.attrs.fngClick||this.attrs.ngClick,{$event:t}),this.clickHandling=!1,this.scope.nextSelector&&e(this.scope.nextSelector).focus()}}class S{constructor(e,t,n){this.$q=e,this.bbContext=t,this.$modal=n,this.priority=100,this.restrict="A",this.scope=!0,this.compile=(e,t)=>({pre:(e,t,n)=>new y(e,t,n,this.$q,this.bbContext,this.$modal)})}}S.$inject=["$q",o.b,c.b,d.m.serviceName],i.module(p,["ngSanitize",o.a,c.a]).directive("bbConfirmationNeeded",["$injector",e=>e.instantiate(S)])}).call(this,n("71td"))},lr7J:function(e,t,n){"use strict";n("FNJT");var a=n("nsO7"),i=n("Llzl"),r=n("5MwF"),s=n("XGja"),o=n("hkqm"),l=n("lEL+"),c=n("PIPc");n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return u}));const d="ultra.components.directives.infiniteScroll",u="bbInfiniteScroll";class m{constructor(e,t,n,i,r,o,l){this.scope=e,this.element=t,this.attrs=n,this.$compile=i,this.$q=r,this.timeout=o,this.toast=l,this.isManualLoad=!1,this.promises=[];const d=n.$observe("infiniteScrollTrayId",(e=>{this.trayId=e,d()}));if(n.infiniteScrollLocalizationKeysPrefix){const e=n.$observe("infiniteScrollLocalizationKeysPrefix",(t=>{this.localizationKeysPrefix=t,this.trayLocalizationKeysPrefix=t+".saveTray",e()}))}else this.localizationKeysPrefix="components.directives.infinite-scroll",this.trayLocalizationKeysPrefix="";n.infiniteScrollLocalizationValues&&(this.localizationValues=e.$eval(n.infiniteScrollLocalizationValues)),e.$watchGroup([n.infiniteScrollTotalCount,n.infiniteScrollCurrentCount],(e=>{if(null!=e[0]&&null!=e[1]){if(this.totalCount=e[0],this.currentCount=e[1],this.remainingCount=this.totalCount-this.currentCount,this.remainingCount<0)throw new Error(`The remainingCount of ${this.remainingCount} should never be a negative number!`);this.setLoadCount()}})),e.$watch(n.infiniteScrollDisabled,(e=>{this.disabled=e}));const m=e.$watch(n.infiniteScrollLoadLimit,(e=>{null!=e&&(this.loadLimit=e,this.setLoadCount(),m())}));let p;i(t)(e),this.timeout((()=>{p=i(c)(e).insertAfter(t)}),this.scope,0,!1),this.scope.$on(u,((e,t,i)=>{if(this.trayId!==t)return;const r=this.$q.defer();if(i.then((()=>{r.resolve()})).catch((()=>r.resolve())),this.promises.push(r),r.promise.then((()=>a.remove(this.promises,(e=>i===e)))),this.cancelLoading=this.toast.showLoading({trayId:t,trayLocalizationKeysPrefix:this.trayLocalizationKeysPrefix,promise:r.promise}),this.attrs.infiniteScrollFocusableChildrenSelector&&this.isManualLoad){this.isManualLoad=!1;const e=this.loadCount;i.then((()=>{this.timeout((()=>{const t=this.element.find(this.attrs.infiniteScrollFocusableChildrenSelector);s.a(t.eq(t.length-e),null,n.infiniteScrollForceShowAncestorSelector)}),this.scope,0,!1)}))}})),this.scope.$on("$destroy",(()=>{p&&p.remove(),this.breakPromises(),this.cancelLoading&&this.cancelLoading()}))}breakPromises(){a.forEach(this.promises,(e=>{e.resolve()}))}loadMoreItems(){this.remainingCount>0&&(this.isManualLoad=!0,this.scope.$eval(this.attrs.bbInfiniteScroll))}get loadMoreLocalizationValues(){return i.extend({},this.localizationValues,{loadCount:this.loadCount})}setLoadCount(){null!=this.loadLimit&&null!=this.remainingCount&&(this.loadCount=Math.min(this.loadLimit,this.remainingCount))}}m.$inject=["scope","element","attrs","$compile","$q",l.b,o.b];class p{constructor(e){this.$injector=e,this.terminal=!0,this.compile=(e,t)=>(e,t,n)=>{const a=e.$eval(n.infiniteScrollCurrentCount),i=e.$eval(n.infiniteScrollTotalCount);null!=a&&null!=i&&a>=i||t.attr("infinite-scroll",n.bbInfiniteScroll),t.removeAttr("bb-infinite-scroll"),e.infiniteScroll=this.$injector.instantiate(m,{scope:e,element:t,attrs:n})}}}p.$inject=["$injector"],i.module(d,["infinite-scroll",l.a,o.a]).value("THROTTLE_MILLISECONDS",r.a.infiniteScrollThrottleMS).directive("bbInfiniteScroll",["$injector",e=>e.instantiate(p)])},m2oH:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=e=>{if(!e||""===e)return!1;const t=e.toLowerCase().replace("_","-");return t.startsWith("ar")||t.startsWith("he")||"en-sc"===t||"en-sa"===t}},mhLG:function(e,t){e.exports='<bb-modal id="folder-drop-depth-limit-modal" class="notification js-folder-drop-limit"\n          modal-title-key="{{isChrome || hasFiles ? \'components.directives.fileUpload.folderDropDepthLimitTitle\' : \'components.directives.fileUpload.folderDropDepthLimitNotChromeTitle\'}}"\n          analytics-id-tag-prefix="components.directives.fileUpload">\n  <div name="modal-contents">\n    <ng-switch on="isChrome">\n      <div ng-switch-when="true">\n        <p>\n          <bb-translate>components.directives.fileUpload.folderDropDepthLimitFull</bb-translate>\n        </p>\n      </div>\n      <div ng-switch-default>\n        <ng-switch on="hasFiles">\n          <div ng-switch-when="true">\n            <p>\n              <bb-translate>components.directives.fileUpload.folderDropDepthLimitFullNotChromeAdditionalFiles</bb-translate>\n            </p>\n          </div>\n          <div ng-switch-default>\n            <p>\n              <bb-translate>components.directives.fileUpload.folderDropDepthLimitFulNotChromeNoMoreFiles</bb-translate>\n            </p>\n          </div>\n        </ng-switch>\n      </div>\n    </ng-switch>\n  </div>\n\n  <div name="modal-footer" class="reveal-modal__footer-content reveal-modal__footer-content--gray" ng-switch on="isChrome || hasFiles">\n    <div class="reveal-modal__footer-buttons">\n      <span class="reveal-modal__footer-button-container" ng-switch-when="true">\n        <button class="button button--secondary js-secondary-button" ng-click="fileUpload.modalCancelUpload()" analytics-id="components.directives.fileUpload.no">\n          <bb-translate>components.directives.fileUpload.no</bb-translate>\n        </button>\n      </span>\n      <span class="reveal-modal__footer-button-container" ng-switch-when="true">\n        <button class="button js-primary-button" ng-click="fileUpload.closeModal()" analytics-id="components.directives.fileUpload.yes">\n          <bb-translate>components.directives.fileUpload.yes</bb-translate>\n        </button>\n      </span>\n      <span class="reveal-modal__footer-button-container" ng-switch-when="false">\n        <button class="button js-primary-button" ng-click="fileUpload.modalCancelUpload()" analytics-id="components.directives.fileUpload.cancelUploadText">\n          <bb-translate>components.directives.fileUpload.cancelUploadText</bb-translate>\n        </button>\n      </span>\n    </div>\n  </div>\n</bb-modal>\n'},mkvA:function(e,t){e.exports='<div class="reveal-modal fade open" ng-class="{ in: $parent.animate }" role="{{::modal.ariaType}}" tabindex="-1" data-reveal\n     ng-multi-transclude-controller ng-attr-aria-label="{{::modal.titleString}}" ng-keydown="modal.handleKeyDown($event)">\n  <div class="reveal-modal__header">\n    <h1 class="reveal-modal__title" aria-describedby="modal-contents" bb-focus>\n      {{::modal.titleString}}\n    </h1>\n    <button class="close-reveal-modal standard-button light-background" \n            ng-click="modal.dismiss()" \n            bb-translate-attrs="{ \'aria-label\': \'global.close\' }"\n            analytics-id="{{modal.analyticsIdTagPrefix}}.modal.close.button">\n      <bb-svg-icon size="small" icon="close"></bb-svg-icon>\n    </button>\n  </div>\n  <div id="modal-contents" class="reveal-modal__contents" ng-multi-transclude="modal-contents"></div>\n  <footer ng-multi-transclude="modal-footer" class="reveal-modal__footer">\n    <div class="reveal-modal__footer-content reveal-modal__footer-content--gray">\n      <div ng-multi-transclude="modal-footer-help-link" class="reveal-modal__footer-help-link-container"></div>\n      <div class="reveal-modal__footer-buttons">\n        <span ng-multi-transclude="modal-footer-button-secondary" class="reveal-modal__footer-button-container"></span>\n        <span ng-multi-transclude="modal-footer-button-primary" class="reveal-modal__footer-button-container"></span>\n      </div>\n    </div>\n  </footer>\n  <div class="reveal-modal__dismiss" ng-class="{ \'hide\' : !modal.dismissString }">\n    <span class="reveal-modal__divider"></span>\n    <button class="button button--text dismiss-message expand" ng-click="modal.dismiss()" analytics-id="{{modal.analyticsIdTagPrefix}}..modal.dismiss.button">\n      <span>{{::modal.dismissString}}</span>\n    </button>\n  </div>\n</div>\n'},n1KZ:function(e,t){e.exports='<footer class="panel-footer notification row collapse" ng-click="toastClicked()"\n        analytics-id="components.services.toast.clicked">\n  <bb-save-tray toast-message="::message" toast-short-message="::shortMessage" toast-icon="::icon" toast-class="::toastClass" toast-status="::toastStatus"></bb-save-tray>\n</footer>\n'},nL6A:function(e,t){e.exports='<bb-modal class="notification"\n          modal-title-key="components.services.error-modal.error-course-is-closed.title"\n          analytics-id-tag-prefix="components.services.error-modal.error-course-is-closed">\n  <div name="modal-contents">\n    <p bb-translate>components.services.error-modal.error-course-is-closed.description</p>\n    <bb-session-debug-modal-button></bb-session-debug-modal-button>\n  </div>\n  <button name="modal-footer-button-primary"\n          ng-click="$parent.$dismiss()"\n          class="button large reload-page-button js-primary-button"\n          analytics-id="components.services.error-modal.error-course-is-closed.alt"\n          bb-translate>components.services.error-modal.error-course-is-closed.alt</button>\n</bb-modal>\n'},nPfc:function(e,t){e.exports='\x3c!-- Onsubmit Errors first --\x3e\n<script type="text/ng-template" id="default-onsubmit-error-messages">\n  <span ng-message="bbmlMarkup"><span bb-translate>components.directives.validation.messages.errors.invalid_bbml_markups</span></span>\n  <span ng-message="numberInvalidOnsubmit"><span bb-translate>components.directives.validation.messages.onsubmitErrors.number_invalid</span></span>\n  <span ng-message="numberLargeOnsubmit"><span bb-translate translate-values="{ value: onsubmitErrors.numberLargeOnsubmit.max }">components.directives.validation.messages.onsubmitErrors.number_large</span></span>\n  <span ng-message="numberSmallOnsubmit"><span bb-translate translate-values="{ value: onsubmitErrors.numberSmallOnsubmit.min }">components.directives.validation.messages.onsubmitErrors.number_small</span></span>\n  <span ng-message="maxlengthOnsubmit"><span bb-translate>components.directives.validation.messages.onsubmitErrors.maxlength</span></span>\n  <span ng-message="urlOnsubmit"><span bb-translate>components.directives.validation.messages.errors.url</span></span>\n  <span ng-message="requiredOnsubmit"><span bb-translate>components.directives.validation.messages.errors.required</span></span>\n  <span ng-message="emailOnsubmit"><span bb-translate>components.directives.validation.messages.errors.email</span></span>\n  <span ng-message="timeOnsubmit"><span bb-translate>components.directives.validation.messages.errors.time</span></span>\n  <span ng-message="dateOnsubmit"><span bb-translate>components.directives.validation.messages.errors.date</span></span>\n<\/script>\n\n\x3c!-- Errors --\x3e\n<script type="text/ng-template" id="default-error-messages">\n  <span ng-message="bbmlMarkup"><span bb-translate>components.directives.validation.messages.errors.invalid_bbml_markups</span></span>\n  <span ng-message="rangeInvalid"><span bb-translate translate-values="{ value: errors.rangeInvalidArgs.min }">components.directives.validation.messages.errors.range_invalid</span></span>\n  <span ng-message="numberInvalid"><span bb-translate>components.directives.validation.messages.errors.number_invalid</span></span>\n  <span ng-message="numberLarge"><span bb-translate translate-values="{ value: errors.numberLarge.max }">components.directives.validation.messages.errors.number_large</span></span>\n  <span ng-message="numberSmall"><span bb-translate translate-values="{ value: errors.numberSmall.min }">components.directives.validation.messages.errors.number_small</span></span>\n  <span ng-message="maxlength"><span role="status" aria-live="polite" bb-translate translate-values="{ diff: errors.maxlength.diff }">components.directives.validation.messages.errors.maxlength.plural</span></span>\n  <span ng-message="url"><span bb-translate>components.directives.validation.messages.errors.url</span></span>\n  <span ng-message="required"><span bb-translate>components.directives.validation.messages.errors.required</span></span>\n  <span ng-message="email"><span bb-translate>components.directives.validation.messages.errors.email</span></span>\n  <span ng-message="phoneNumber"><span bb-translate>components.directives.validation.messages.errors.phone_number_noSymbolsOrSpaces</span></span>\n  <span ng-message="time"><span bb-translate>components.directives.validation.messages.errors.time</span></span>\n  <span ng-message="date"><span class="js-error-date" bb-translate>components.directives.validation.messages.errors.date</span></span>\n  <span ng-message="maxDate"><span bb-translate translate-values="{ value: errors.maxDate.dateMax }">components.directives.validation.messages.errors.max_date</span></span>\n  <span ng-message="minDate"><span bb-translate translate-values="{ value: errors.minDate.dateMin }">components.directives.validation.messages.errors.min_date</span></span>\n  <span ng-message="schemaSymbolString"><span bb-translate>components.directives.validation.messages.errors.schema_symbol_string</span></span>\n<\/script>\n\n\x3c!-- Immediate Errors --\x3e\n<script type="text/ng-template" id="default-immediate-error-messages">\n  <span ng-message="maxlengthImmediate"><span role="status" aria-live="polite" bb-translate translate-values="{ diff: immediateErrors.maxlengthImmediate.diff }">components.directives.validation.messages.errors.maxlength.plural</span></span>\n<\/script>\n\n\x3c!-- Warnings --\x3e\n<script type="text/ng-template" id="default-warning-messages">\n  <span ng-message="bbmlMarkup"><span bb-translate>components.directives.validation.messages.warnings.invalid_bbml_markups_cleanup</span></span>\n  <span ng-message="maxlengthWarning"><span role="status" aria-live="polite" bb-translate translate-values="{ left: warnings.maxlengthWarning.left }">components.directives.validation.messages.warnings.maxlength.plural</span></span>\n<\/script>\n\n<div class="bb-validation-messages form-element-onsubmit-errors" ng-class="{\'sr-only\': !showOnsubmitErrors}">\n  <div ng-repeat="label in labels track by label" class="sr-only">\n    <div bb-translate translate-values="{ label: label }">components.directives.validation.messages.onsubmitFieldHasError</div>\n  </div>\n\n  <bb-svg-icon size="small" icon="attention"></bb-svg-icon>\n  <div ng-messages="onsubmitErrors">\n    <ng-transclude></ng-transclude>\n    <div ng-messages-include="default-onsubmit-error-messages"></div>\n  </div>\n</div>\n\n<div class="bb-validation-messages form-element-errors" ng-class="{\'sr-only\': !showErrors}">\n  <div ng-repeat="label in labels track by label" class="sr-only">\n    <div bb-translate translate-values="{ label: label }">components.directives.validation.messages.fieldHasError</div>\n  </div>\n  <bb-svg-icon size="small" icon="attention"></bb-svg-icon>\n  <div ng-messages="errors">\n    <ng-transclude class="js-error-message"></ng-transclude>\n    <div ng-messages-include="default-error-messages"></div>\n  </div>\n</div>\n\n<div class="bb-validation-messages form-element-errors" ng-class="{\'sr-only\': !showImmediateErrors}">\n  <bb-svg-icon size="small" icon="attention"></bb-svg-icon>\n  <div ng-messages="immediateErrors">\n    <ng-transclude></ng-transclude>\n    <div ng-messages-include="default-immediate-error-messages"></div>\n  </div>\n</div>\n\n<div class="bb-validation-messages form-element-warnings" ng-class="{\'sr-only\': !showWarnings}">\n  <bb-svg-icon size="small" icon="attention"></bb-svg-icon>\n  <div ng-messages="warnings">\n    <ng-transclude></ng-transclude>\n    <div ng-messages-include="default-warning-messages"></div>\n  </div>\n</div>\n'},nYZ0:function(e,t,n){"use strict";n.d(t,"b",(function(){return y})),n.d(t,"d",(function(){return S})),n.d(t,"f",(function(){return C})),n.d(t,"a",(function(){return E})),n.d(t,"e",(function(){return k})),n.d(t,"c",(function(){return O}));var a=n("Llzl"),i=n("nsO7"),r=n("+O05"),s=n("lmMM"),o=n("k9iv"),l=n("pjml"),c=n("e6jQ"),d=n("Q/M7"),u=n("adx1"),m=n("IbyE"),p=n("Sa5G"),h=n("yC9S"),g=n("zGdY"),b=n("AuQm"),f=n("VAMW"),v=n("6fZB");const y=9e5,S="ultra.services.content",C="contentService",E="content-update";class I extends u.a{constructor(){if(I._instance)throw new Error("Error: Instantiation failed: Use IndicatorCacheService.getInstance() instead of new.");super(),I._instance=this}static getInstance(){return I._instance}classConversationIndicatorRemoved(e,t,n,a){this.$emitEvent(I.CLASS_CONVERSATION_INDICATOR_REMOVED,e,t,n,a)}groupConversationIndicatorRemoved(e,t,n,a){this.$emitEvent(I.GROUP_CONVERSATION_INDICATOR_REMOVED,e,t,n,a)}$onClassConversationIndicatorRemoved(e){return super.$onEvent(I.CLASS_CONVERSATION_INDICATOR_REMOVED,e)}$onGroupConversationIndicatorRemoved(e){return super.$onEvent(I.GROUP_CONVERSATION_INDICATOR_REMOVED,e)}}function k(e,t){return e.$on("rootNodeElementFetched",t)}I._instance=new I,I.CLASS_CONVERSATION_INDICATOR_REMOVED="class-conversation-indicator-removed",I.GROUP_CONVERSATION_INDICATOR_REMOVED="group-conversation-indicator-removed";class w{constructor(e){this.service=e,this.key=f.d.Content}generateDeleteConfirmationKey(e,t,n){const a=this.service.generateDeleteConfirmationKey(e,t,n);return Object(v.a)(a)}updateCourseLinks(e,t=!1){return Object(v.a)(this.service.updateVisibility(e,t))}}class T{constructor(e,t,n,a,i,r,s,o){this.$q=e,this.DSCacheFactory=t,this.CourseModel=n,this.PartnerContentIdModel=a,this.errorModal=i,this.assessment=r,this.$rootScope=s,this.$ngRedux=o,this.rootNodeCache=t.createCache("rootNodes"),this.settingsCache=t.createCache("contentSettings"),this.indicatorsCache=t.createCache("indicators",{maxAge:y,deleteOnExpire:"aggressive"}),this.fetchIndicatorsPromiseCache={},this.indicatorCacheService=I.getInstance(),h.b.OnRootScope(s,"content-update",((e,t)=>this.refreshContentInCache(t))),this.subscribeToRedux(o),Object(f.f)(new w(this))}subscribeToRedux(e){e.connect((e=>({})),(e=>({deleteContentInStore:t=>e(m.V.content.deleteContentInStore(t))})))(this)}truncateDescription(e,t){if(t=t||T.MAX_LENGTH,!e||e.length<=t)return e;const n=" ...";t-=n.length;let a=e.lastIndexOf(" ",t);return a<=0&&(a=t),e.substr(0,a)+n}findRootNode(e,t){const n=this.getCacheKey(t,e.$pk);let a=this.rootNodeCache.get(n);var i,r,s;return a||(a=e.contents.$find(t.toString()),this.rootNodeCache.put(n,a),i=this.$rootScope,r=e.$pk,s=t,i.$broadcast("rootNodeElementFetched",r,s)),a}getCacheKey(e,t){return e.toString()+t}getSettings(e){return this.settingsCache.get(e)}putSettings(e,t){return this.settingsCache.put(e,t)}removeSettings(e){return this.settingsCache.remove(e)}getCourseIndicators(e){return this.indicatorsCache.get(`courseId_${e}`)}putCourseIndicators(e,t){return this.indicatorsCache.put(`courseId_${e}`,t)}removeCourseIndicators(e){return this.indicatorsCache.remove(`courseId_${e}`)}refreshContentInCache(e){if(!e)return;const t=e.courseId,n=p.h.getValues();for(let a=0;a<n.length;a++){const i=n[a],r=this.getCacheKey(i,t),s=this.rootNodeCache.get(r);if(s){if(this.updateCachedContent(s,e))return void this.rootNodeCache.put(r,s)}}}updateCachedContent(e,t){if(e.id===t.id)return null!=t.isAvailable&&(e.isAvailable=t.isAvailable),null!=t.visibility&&(e.visibility=t.visibility),null!=t.isPartiallyVisible&&(e.isPartiallyVisible=t.isPartiallyVisible),null!=t.isGroupContent&&(e.isGroupContent=t.isGroupContent),null!=t.assignedGroups&&(e.assignedGroups=t.assignedGroups),t.adaptiveReleaseRules&&(e.adaptiveReleaseRules=t.adaptiveReleaseRules),e.title=t.title,e.attachedForumLink=t.attachedForumLink,e.ui&&(void 0===e.ui.hasConversationAttached||e.isScorm())&&(e.ui.hasConversationAttached=!!t.attachedForumLink),e.updateProctoringSettings(t),!0;if(e.children)for(let n=0;n<e.children.length;n++){const a=e.children[n];if(this.updateCachedContent(a,t))return!0}return!1}getOrMakeContentInContentTree(e,t,n,a,i,r){return n?this.getContentInContentTree(e,t,n):this.makeContentInContentTree(e,t,a,i,r)}getContentInContentTree(e,t,n){let a,i;return e.$asPromise().then((e=>(e.children=e.children||e.getChildren({limit:0,recursive:!0}),e.children.$asPromise()))).then((()=>{if(n){if(a=e.findInTreeById(n),a)a.isSafeAssignOn()||!a.isTest()&&!a.isAssignment()||a.$fetch({fields:"safeAssignOptions"});else{const e="alignedGoals,assignedGroups,selfEnrollmentGroups.group";a=this.CourseModel.$new(t).contents.$find(n,{expand:e}).$allow([403])}return a.$asPromise()}})).then((()=>{if(a&&a.parentId)return i=e.findInTreeById(a.parentId),i||(i=this.CourseModel.$new(t).contents.$find(a.parentId)),i.$asPromise()})).then((()=>({content:a,parentFolder:i})))}makeContentInContentTree(e,t,n,a,i,r){let s,o;return e.$asPromise().then((e=>(e.children=e.children||e.getChildren({limit:0}),e.children.$asPromise()))).then((()=>(o=this.getParentFolder(n,t,e),o.$asPromise()))).then((()=>(o.children=o.children||o.getChildren({limit:0}),o.children.$asPromise()))).then((()=>{let e=o.children.indexOfItemById(void 0);return!r&&e>=0&&o.children[e].positionBefore===a&&o.children[e].positionAfter===i?s=o.children[e]:(s=o.children.$build(),e=o.children.getInsertionIndex(a,i,!0,o.hasMoreChildren),e>=0&&s.addAndRevealAtIndex(e),o.children.paging&&o.children.paging.count++),null!=a&&(s.positionBefore=a),null!=i&&null==a&&(s.positionAfter=i),s.parentId=n||o&&o.id,s.depth=o&&null!=o.depth?o.depth+1:void 0,s.courseId=t,{content:s,parentFolder:o}}))}getParentFolder(e,t,n){let a;return e?(a=n.findInTreeById(e),a||(a=this.CourseModel.$new(t).contents.$find(e).$allow([g.S.Forbidden]))):a=n,a}makeSoftLinkContentInContentTree(e,t,n,a,i,r){return this.makeContentInContentTree(t,n,a,i,r).then((t=>{const n=t.content;return e&&e.$pk&&(n.contentHandler=l.p.ContentHandler.CourseLink,n.ui.linkSource=e),n.id=null,n.description=e.description,n.title=e.title,n.courseId=e.courseId,n.isAvailable=e.isAvailable,n.visibility=e.visibility,n.contentDetail={"resource/x-bb-courselink":{linkSourceId:e.id,linkSourceTable:"CONTENT"}},n}))}isEmpty(e){return!e||0===e.trim().length}parseForumId(e){const t=e.split("/");return t[t.length-1]}determineVisibility(e,t){return e?g.w.Visible:g.w.Hidden}generateDeleteConfirmationKey(e,t,n){const a=this.$q.defer();return e.ui.modalShowType=s.b.UserChoice.toString(),!e.isFolder()&&!e.isLearningModule()||e.isRoot()?e.canHaveSharedGradingColumn()&&e.hasGradingColumn()&&p.g.PartnerCloud.isEqualTo(e.contentHandler)?this.PartnerContentIdModel.getContentIds(e.courseId,e.linkRef).then((t=>{t.contentIds.length>1?(e.ui.modalShowType=s.b.Always.toString(),e.ui.deleteConfirmationKey=e.getContentDisplay().deleteKey()+"-shared-grade-column",a.resolve(e)):this.checkForAttempts(e,a,n)})).catch((t=>{this.errorModal.handleApiError(t.$response),a.reject(e)})):this.checkForAttempts(e,a,n):e.isBbPage()?(e.ui.deleteConfirmationKey=p.g.Page.toString(),e.hasCourseLinks().then((t=>{t&&(e.ui.deleteConfirmationKey=e.ui.deleteConfirmationKey+this.getHasCourseLinkSuffix(n),e.ui.modalShowType=s.b.Always.toString())})).catch((()=>{})).finally((()=>{a.resolve(e)}))):e.getChildren().$then((n=>{if(n&&n.length>0){e.ui.modalShowType=s.b.Always.toString();const i=n.filter((e=>e&&e.isDiscussion())).length;e.hasGradedContentItems().then((r=>{r?e.ui.deleteConfirmationKey=e.contentHandler+"-contains-graded-items":i===n.length?e.ui.deleteConfirmationKey=e.contentHandler+"-all-discussions-"+t:e.ui.deleteConfirmationKey=i>0?e.contentHandler+"-contains-discussions":e.contentHandler+"-no-discussions",a.resolve(e)}))}else e.ui.deleteConfirmationKey=e.contentHandler+"-empty",a.resolve(e)})),a.promise}getHasCourseLinkSuffix(e){return e?"-has-org-links":"-has-course-links"}getCourseLinkSuffix(e){return e?"-org-link":"-course-link"}checkForAttempts(e,t,n){e.ui.deleteConfirmationKey=e.getContentDisplay().deleteKey(),e.hasCourseLinks().then((t=>{t&&(e.ui.deleteConfirmationKey=e.ui.deleteConfirmationKey+this.getHasCourseLinkSuffix(n),e.ui.modalShowType=s.b.Always.toString())})).catch((()=>{})).finally((()=>{var a;if(e.canHaveAttempts()&&e.hasGradingColumn())e.ui.modalShowType=s.b.Always.toString(),e.getAttemptCount().then((n=>{n>0&&(e.ui.deleteConfirmationKey=e.ui.deleteConfirmationKey+"-data"),t.resolve(e)})).catch((n=>{403===n.$response.status?(e.ui.modalShowType=s.b.Always.toString(),e.ui.deleteConfirmationKey=e.ui.deleteConfirmationKey+"-unknown",t.resolve(e)):(this.errorModal.handleApiError(n.$response),t.reject(e))}));else if(p.g.Discussion.isEqualTo(e.contentHandler))e.ui.deleteConfirmationKey=e.getContentDisplay().deleteKey(),e.$fetch().$then((n=>{const a=n.contentDetail[p.g.Discussion.toString()];a&&a.properties.allowForumGrading&&(e.ui.modalShowType=s.b.Always.toString(),e.ui.deleteConfirmationKey=e.getContentDisplay().deleteKey()+"-graded"),t.resolve(e)}));else if(e.isJournal())e.$fetch().$then((n=>{const a=n.contentDetail[p.g.Journal.toString()].blog;a&&a.gradingAllowed&&(e.ui.modalShowType=s.b.Always.toString(),e.ui.deleteConfirmationKey=e.ui.deleteConfirmationKey+"-graded"),t.resolve(e)}));else if(p.g.CourseLink.isEqualTo(e.contentHandler)){const i=e.getLinkContentSource();if(p.g.Discussion.isEqualTo(null==i?void 0:i.contentHandler)){e.ui.deleteConfirmationKey=e.getContentDisplay().deleteKey();const t=i.contentDetail[p.g.Discussion.toString()];t&&t.properties.allowForumGrading&&(e.ui.modalShowType=s.b.Always.toString(),e.ui.deleteConfirmationKey=e.getContentDisplay().deleteKey()+"-graded")}else{const t=this.getCourseLinkSuffix(n),r=(null==i?void 0:i.isBbPage())?e.ui.deleteConfirmationKey=p.g.Page.toString():null===(a=null==i?void 0:i.getContentDisplay())||void 0===a?void 0:a.deleteKey();e.ui.deleteConfirmationKey=r?r+t:e.getContentDisplay().deleteKey()+t}e.ui.modalShowType=s.b.Always.toString(),t.resolve(e)}else t.resolve(e)}))}deleteContent(e){if(e.id){e.ui.isDeleted=!0;const t={};return(e.isGroupContent||e.isFolder())&&(t.deleteGroups=!0),(e.canHaveAttempts()||e.isDiscussion()||e.isFolder())&&(t.deleteGrades=!0),e.withParams(t).$destroy().$suppressErrorDialog().$asPromise().then((t=>(this.deleteContentInStore&&this.deleteContentInStore(e.id),t))).catch((t=>{e.ui.isDeleted=!1;const n=t.$response;return this.assessment.isExternallyRefQuestionsAPIError(n.data)?this.assessment.openHasExternallyRefQuestionsModal(this.getExternallyRefQuestionsModalType(e.contentHandler)):this.errorModal.handleApiError(n),this.$q.reject(n)}))}return this.$q.when()}getExternallyRefQuestionsModalType(e){return p.g.Folder.isEqualTo(e)?r.b.FOLDER:r.b.ASSESSMENT}canOnlyCreateDiscussion(e){return e&&e.children&&e.children.permissions&&!e.children.permissions.create&&e.children.permissions.contentHandlerPermissionMap&&e.children.permissions.contentHandlerPermissionMap.createDiscussion}canCreateAllContent(e){return e&&e.children&&e.children.permissions&&e.children.permissions.create}convertBbMLToAttemptFileContentBlocks(e){const t=[];return this.convertBbMLToContentBlocks(e).forEach((e=>{"attemptFileBlock"in e&&t.push(e.attemptFileBlock)})),t}convertAttemptFileContentBlocksToBbML(e){const t=[];e.forEach((e=>{t.push({attemptFileBlock:e})}));return this.convertContentBlocksToBbML(t,"question1 ")}convertBbMLToContentBlocks(e){const t=[],n=document.createElement("div");n.innerHTML=e;for(let e=0;e<n.children.length;e++){const a=n.children[e];if("A"===a.tagName)t.push(this.convertBbMLToFileBlock(a));else if("DIV"===a.tagName){const e=this.getBlockIdFromBbML(a);t.push({textBlock:a.innerHTML.trim(),id:e})}}return t}convertBbMLToFileBlock(e){const t={file:{}};if(e.dataset&&e.dataset.bbfile)try{const n=JSON.parse(e.dataset.bbfile);t.alternativeText=n.alternativeText,t.ui={isRenderedInline:Object(b.ib)(n.render)},t.linkName=n.linkName,t.currentMimeType=n.mimeType}catch(e){}else if(e.dataset&&e.dataset.bbmedia)try{const n=JSON.parse(e.dataset.bbmedia);t.alternativeText=n.alternativeText,t.ui={isRenderedInline:Object(b.ib)(n.render)}}catch(e){}t.linkName||(t.linkName=e.innerHTML.substr(0,e.innerHTML.lastIndexOf("?"))),t.currentMimeType||(t.currentMimeType=e.innerHTML.substr(e.innerHTML.lastIndexOf("?")+1));let n=e.href;0===n.indexOf("http://localhost")&&(n=d.c(n.substr("http://localhost".length))),t.downloadUrl=n;const a=n.match(/xid-(\d+_\d+)/);a&&(t.id=a[1]);return{attemptFileBlock:t,id:this.getBlockIdFromBbML(e)}}convertContentBlocksToBbML(e,t){const n=document.createElement("div");return e.forEach((e=>{if("attemptFileBlock"in e){const t=document.createElement("a");if(t.href=e.attemptFileBlock.downloadUrl,e.attemptFileBlock.ui){const n={};e.attemptFileBlock.ui.isRenderedInline?n.render=m.s.Inline:n.render=m.s.Attachment,e.attemptFileBlock.alternativeText&&(n.alternativeText=e.attemptFileBlock.alternativeText),e.attemptFileBlock.linkName&&(n.linkName=e.attemptFileBlock.linkName),e.attemptFileBlock.currentMimeType&&(n.mimeType=e.attemptFileBlock.currentMimeType),t.dataset.bbfile=JSON.stringify(n)}e.id&&(t.id=e.id),t.innerHTML=e.attemptFileBlock.linkName+"?"+e.attemptFileBlock.currentMimeType,n.appendChild(t)}else if("textBlock"in e){const t=document.createElement("div");e.id&&(t.id=e.id),t.innerHTML=e.textBlock,n.appendChild(t)}e.isNewToBbML&&delete e.isNewToBbML})),(t||"")+n.innerHTML}getBlockIdFromBbML(e){let t=null;return t=e.id?e.id:this.generateBlockId(),t}generateBlockId(){return"bbml-editor-id_"+c.b()}fetchIndicatorsPerRequest(e){let t=this.fetchIndicatorsPromiseCache[e];return t||(t=this.CourseModel.$new(e).indicators.$fetch().$asPromise().then((t=>(this.putCourseIndicators(e,t),t)),(e=>{401!==e.$response.status&&(e.$response.status=null),console.error("Fetch indicators error!")})).finally((()=>{delete this.fetchIndicatorsPromiseCache[e]})),this.fetchIndicatorsPromiseCache[e]=t,t)}fetchIndicators(e,t){if(t)return this.fetchIndicatorsPerRequest(e);const n=this.getCourseIndicators(e);return n?this.$q.when(n):this.fetchIndicatorsPerRequest(e)}getCourseContentCache(e,t){const n=this.getCourseIndicators(e);return n?n.filter((e=>e.contentId===t))[0]:null}setClassConversationHasIndicatorToFalseInCache(e,t,n){let a=this.getCourseIndicators(e);if(a){const r=i.find(a,(e=>e.contentId===t));r&&(r.classConversationHasIndicator=!1,r.groupIds||(a=i.filter(a,(e=>e.contentId!==t))),this.putCourseIndicators(e,a),this.indicatorCacheService.classConversationIndicatorRemoved(e,t,!!r.groupIds,n))}}removeGroupIdFromIndicatorCache(e,t,n,a){if(!n)return null;let r=this.getCourseIndicators(e);if(r){const s=i.find(r,(e=>e.contentId===t));if(s){if(s.groupIds=i.filter(s.groupIds,(e=>n!==e)),s.groupIds&&0===s.groupIds.length)return delete s.groupIds,s.classConversationHasIndicator||(r=i.filter(r,(e=>e.contentId!==t))),this.putCourseIndicators(e,r),void this.indicatorCacheService.groupConversationIndicatorRemoved(e,t,s.classConversationHasIndicator,a);this.putCourseIndicators(e,r)}}}clearContentGroups(e,t){const n=this.$q.defer();if(e.assignedGroups){if(e.assignedGroups.some((e=>!e.group)))throw new Error("Expected group to be expanded on content group assignments when clearing groups.");const a=e.assignedGroups.filter((e=>!e.group.groupSetId)).map((e=>({method:"DELETE",relativeUrl:e.groupId})));a.length>0&&t.groups.batchUpdate(a),e.isGroupContent=!1,e.assignedGroups=[],e.saveAssignedGroups(!0).$asPromise().then((()=>{this.$rootScope.$broadcast(E,e),n.resolve(e)}))}else n.resolve(e);return n.promise}canForcedSequenceBeEnabled(e){return e.canForcedSequenceBeEnabled()}updateVisibility(e,t=!1){return t&&this.$rootScope.$broadcast("content-update",e),this.$q.when((async()=>{if(!await e.hasCourseLinks())return;const t=await e.getSoftLinks().$asPromise(),n=this.CourseModel.$new(e.courseId),a=this.findRootNode(n,l.p.ContentRootNode.ROOT);return Promise.all((null!=t?t:[]).map((async({courseContent:e})=>{let t=a.findInTreeById(e);t||(t=n.contents.$new(e));const i=await t.$fetch().$asPromise();return i.getLinkContentSource().$then((()=>{this.$rootScope.$broadcast("content-update",i,!1)})),i})))})())}}T.MAX_LENGTH=60,T.MAX_LENGTH_IN_CONTENT_ITEM=750,T.$inject=["$q","DSCacheFactory",l.m.serviceName,l.S.serviceName,o.c,r.h,"$rootScope","$ngRedux"];class O extends T{}a.module(S,["angular-data.DSCacheFactory",l.N,o.b,r.g]).service(C,T)},nawZ:function(e,t,n){"use strict";var a;!function(e){e.ModifyException="course.assessment.exceptions.MODIFY",e.ViewException="course.assessment.exceptions.VIEW"}(a||(a={})),t.a=a},neh4:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));n("JzsJ");var a=n("5MwF"),i=n("Llzl"),r=n("0JpG"),s=n("w9Zy"),o=n("Qbdf"),l=n("X455"),c=n("bF8R"),d=n("vdfi"),u=n("jhBu"),m=n("o5Lu"),p=n("TnpK"),h=n("pjml"),g=n("nmzr");const b="ultra.course.content.assignment.routes";i.module(b,[r.moduleName,c.a,u.a,m.m,p.b,o.b]).config([p.c,o.c,l.b,(e,t,i)=>{e.peekState("assignment",{abstract:!0,url:"/assignment/:assignmentId?courseId",resolve:{[o.d]:t.resolve,[l.c]:i.resolve,contentData:[o.d,c.b,p.d,(e,t,n)=>t.loadContentAndGrades({course:e,contentId:n.nextParams.assignmentId,contentHandler:h.p.ContentHandler.UltraAssignment})],currentContent:["contentData",e=>e.courseContent],currentColumn:["contentData",e=>null!=e.gradingColumn.rubricAssociations?e.gradingColumn.$asPromise():e.gradingColumn.$fetch({expand:"associatedRubrics"}).$asPromise()]},peekStates:["conversations",g.n.COURSE_MESSAGE],peekViewName:"assignment-conversation@"}).peekState("assignment.router",{url:"/route",routingFunction:[h.m.serviceName,u.b,p.d,(e,t,n)=>{const a=n.nextParams.courseId?n.nextParams.courseId:n.prevParams.courseId;e.$new(a).contents.$find(n.nextParams.assignmentId).$then((e=>{e.canViewAsInstructor()?n.go(n.prev.name,n.prevParams).then((()=>{n.goPeekState("gradebook-item.assignment",{courseId:e.courseId,contentId:e.id,gradeitemView:"details"})})):n.go(n.prev.name,n.prevParams).then((()=>{n.goPeekState("assignment.view",{courseId:e.courseId,assignmentId:e.id})}))}))}]}).peekState("assignment.view",{url:"/view",resolve:{translations:["$q",r.serviceName,(e,t)=>e.all([t.loadBundle("features/course/content/assignment/assignment"),t.loadBundle("features/course/content/course-content"),t.loadBundle("features/course/goal-alignment/goal")])],prefetch:["$q",h.m.serviceName,p.d,(e,t,n)=>{const i=n.nextParams.courseId?n.nextParams.courseId:n.prevParams.courseId;a.a.features.httpEase&&t.$new(i).contents.$find(n.nextParams.assignmentId,{expand:"assignedGroups,associatedRubrics,alignedGoals"}).$then((e=>{t.$new(i).gradebook.columns.$find(e.getDeployedAssessment().gradingColumn.id,{expand:"associatedRubrics,rubricAssociations.rubricDefinition.alignedGoals,rubricAssociations.rubricDefinition.rows.alignedGoals"})}))}]},require:[()=>Promise.all([n.e(0),n.e(1),n.e(2),n.e(4),n.e(32),n.e(84)]).then(n.bind(null,"pA7Z"))],pageTitle:"course.content.assignmentAttempt",peekStates:["conversations",g.n.COURSE_MESSAGE],peekViewName:"assignment-conversation@"}).peekState("assignment.view.attempt",{abstract:!0,url:"/attempt"}).peekState("assignment.view.attempt.edit",{url:"/{attemptId:_[0-9]+_1}",onEnter:[s.e,p.d,(e,t)=>{t.isPeekPanelOpen()&&e.expandTopPanel()}],panelClass:"full",resolve:{translations:["$q",r.serviceName,(e,t)=>e.all([t.loadBundle("features/course/content/assignment/assignment"),t.loadBundle("features/course/goal-alignment/goal")])]},require:[()=>Promise.all([n.e(0),n.e(1),n.e(2),n.e(4),n.e(6),n.e(7),n.e(32),n.e(23),n.e(601)]).then(n.bind(null,"OXIQ"))],pageTitle:"course.content.assignmentAttempt",peekStates:["conversations",g.n.COURSE_MESSAGE,"rubric-evaluation","rubric-view",d.b],peekViewName:"assignment-conversation@"}).peekState("assignment.view.attempt.finished",{url:"/view",onEnter:[s.e,p.d,e=>{e.shrinkTopPanel()}],params:{gradeDetail:null},resolve:{translations:[r.serviceName,e=>e.loadBundle("features/course/content/assignment/assignment")]},require:()=>Promise.all([n.e(0),n.e(1),n.e(2),n.e(4),n.e(32),n.e(84)]).then(n.bind(null,"pA7Z")),pageTitle:"course.content.assignmentAttempt"}).peekState("assignment.grade",{url:"/grade",resolve:{translations:[r.serviceName,e=>e.loadBundle("features/course/content/assignment/assignment")]},require:()=>Promise.all([n.e(0),n.e(1),n.e(2),n.e(4),n.e(32),n.e(84)]).then(n.bind(null,"pA7Z")),pageTitle:"course.content.assignmentGrading"})}])},"nh++":function(e,t,n){},nkTj:function(e,t,n){"use strict";n.d(t,"e",(function(){return m})),n.d(t,"d",(function(){return p})),n.d(t,"c",(function(){return h})),n.d(t,"b",(function(){return g})),n.d(t,"f",(function(){return b})),n.d(t,"a",(function(){return f}));n("QLzv"),n("BnCD"),n("/fvP");var a=n("71td"),i=n("Llzl"),r=n("nsO7"),s=n("VdDF"),o=n("HDxW"),l=n("k9iv"),c=n("z6Q5"),d=n("Qbdf"),u=n("Q/M7");const m=e=>e,p="ultra.model.utilities",h="ultra.model.utilities.Utilities";function g(e,t){return null!=e?e:t}function b(e,t){if(e.$isCollection){return"PUT"===e.$response.config.method&&Array.isArray(t)?t.map((e=>e.statusCode>=200&&e.statusCode<300?i.fromJson(e.body):e.body)):(e.paging=t&&t.paging,e.permissions=t&&t.permissions,t&&t.results)}return t}class f{static isValid(e){return!r.isEmpty(e)&&/^_\d+_\d+$/.test(e)}}let v;i.module(p,["restmod",l.b,c.a,o.a]).factory(h,["$http","$q",(e,t)=>({getDataMixin:(e,n,a)=>(i,r)=>{const s=(r=r||{}).path||"",o=r.overrideIdKey,l=r.params;return t.when(i).then((i=>{const c=t.defer();if(null==i||0===i.length)return c.resolve(i),c.promise;const d={};i.forEach((e=>{const t=function(e,t){return t.split(".").reduce(((e,t)=>t?e&&e[t]:e),e)}(e,s+"."+(o||n));if(t){(d[t]=d[t]||[]).push(e)}}));const u=Object.keys(d);return e(u,l).$asPromise().then((e=>{e.forEach(((e,t)=>{d[u[t]].forEach((t=>{!function(e,t,n){const a=t.split(".");for(let t=0;t<a.length-1;t++)a[t]&&(e=e&&e[a[t]]);e&&(e[a[a.length-1]]=n)}(t,s+"."+(r.overrideResultKey||a),e)}))})),c.resolve(i)})),c.promise}))},createHooksToFetchParent:function(){function n(n,a){n.cache={get:()=>t.all([e(r.omit(n,"cache")),a.$resolve().$asPromise()]).then((([e])=>e))}}const a={"before-fetch-many":function(e){n(e,this.$scope.$scope)},"before-fetch":function(e){n(e,this.$scope.$scope.$scope)}};return function(e){return{"after-fetch-many":function(){this.forEach((t=>t[e]=this.$scope.$scope))},"after-fetch":function(){this[e]=this.$scope.$scope.$scope},...a}}}()})]).factory("DateSerializer",(()=>({encode:e=>s.a.parseDateToISOString(e),decode:e=>s.a.parseStringToDate(e)}))).filter("localDate",(()=>e=>s.a.convertToLocalDate(e))).factory("BbRestmodFindMany",["restmod","$q",c.b,"restmod.Preload",(e,t,n)=>e.mixin({$extend:{"Scope.canCreate":function(){return this.permissions&&this.permissions.create},"Scope.canEdit":function(){return this.permissions&&this.permissions.edit},"Scope.canDelete":function(){return this.permissions&&this.permissions.delete},Scope:{findMany(e,a,r){const s=this.$collection();return s.$always((()=>n.performBatch((n=>t.all(e.map((e=>{const t=this.$new(e).$fetch(i.extend({[c.c]:n},a));return(r||[]).length>0?t.$allow(r).$asPromise():t.$asPromise()}))))).then((e=>{e.forEach((e=>s.push(e)))}))))}}},$hooks:{"before-find-many":function(e){e.method="PUT",e.data=(e.params&&e.params.ids||[]).map((t=>{const n=i.copy(e.params);delete n.ids;return{method:"GET",relativeUrl:t+(n&&"?"+a.param(n)||"")}})),e.params&&delete e.params.ids}}})]).factory("BbApiStyle",["restmod",e=>e.mixin((function(){this.setProperty("style","BB").setProperty("primaryKey","id")}))]).factory("BbEncodeUrl",["restmod","inflector",(e,t)=>e.mixin({$extend:{Model:{encodeUrlName:e=>t.camelize(e)}}})]).factory("BbUi",["restmod",e=>e.mixin({ui:{mask:!0,init:()=>({})}})]).factory("BbWithParams",["restmod",e=>e.mixin({$extend:{Record:{withParams(e,t){const n=function(a){a.params||(a.params={}),Object.keys(e).forEach((n=>{a.params[n]=t?t(a.params[n],e[n],n):e[n]})),this.$off("before-request",n)};return this.$on("before-request",n),this}}}})]).factory("BbApiErrorHandlerInjector",["restmod","$injector","$window","$rootScope",l.c,o.b,(e,t,n,a,i,r)=>e.mixin({$hooks:{"after-request-error":function(){this.__bb_suppressErrorDialog||setTimeout((()=>{this.$then((()=>{}),r.handle)}))}}})]).factory("BbCheckStatusCode",["restmod",e=>e.mixin({$extend:{Resource:{isStatusCode(e){return this.$response&&this.$response.status&&this.$response.status===e}}}})]).factory("BbPermissions",["restmod","restmod.Preload",e=>e.mixin({$extend:{Record:{canCreate(){return this.permissions&&this.permissions.create},canEdit(){return this.permissions&&this.permissions.edit},canDelete(){return this.permissions&&this.permissions.delete}}}})]).factory("BbPermissionsMask",["restmod",e=>e.mixin({permissions:{mask:"CU"}})]).factory("$ExtendRecord",["RMUtils",function(e){const t=Symbol("$extendRecord");return{$extend:{"Model.$extendRecord":function(e){return this[t]=this[t]||[],this[t].push(e),this},"Record.$decode":function(n,a){const i=this.$super.apply(this,arguments);if(void 0===this.$type)throw new Error("NOT_FOUND_$MODEL");return(this.$type[t]||[]).some((t=>{const a=t(i,n);return!!a&&(e.extendOverriden(i,a),!0)})),i}}}}]).factory("BbExpandParams",["restmod",e=>{const t=function(e){return!!r.isString(e)&&""!==e.trim()},n=function(e){let n;return n=Array.isArray(e)?e.filter(t):r.isString(e)?e.split(",").filter(t):[],n},a=Symbol("$expand_params"),i=function(e){return function(e,t=new Set){const a=n(e);return a.length<=0||a.every((e=>t.has(e)))}(e&&e.expand||"",this[a])?this.$resolve():this.$fetch(e)};return e.mixin({$hooks:{"after-request":function(e){this[a]=function(e){const t=e.config&&e.config.params&&e.config.params.expand,a=n(t);return new Set(a)}(e)}},$extend:{"Record.$fetchIfNotExpanded":i,"Collection.$fetchIfNotExpanded":i}})}]).factory("BbExcludeCourseActivity",["restmod","$injector",(e,t)=>e.mixin({$hooks:{"before-request":function(e){const n=t.get(d.e),a=e.url,i="GET"===e.method,r=!!n.courseId,s=/\/courses\/_\d+_1(\/gradebook\/(schemas|grades|columns|categories|summaries|attempts)|\/memberships|\/messageFolders|\/attendanceRecords|\/conversations|\/contents\/_\d)/.test(a);!r&&i&&s&&(e.url=Object(u.a)(a,"isExcludedFromCourseUserActivity","true"))}}})]).config(["restmodProvider",e=>{function t(e){e=e||[];const t=this.$promise=this.$promise||v.when(this),n=v.defer();return this.$promise=n.promise,t.then((e=>{n.resolve(e)}),(t=>{e.some((e=>{const n=[0];if("number"==typeof e)n[0]=e;else if("string"==typeof e){const t=e.split("-");n[0]=parseInt(t[0],10),n[1]=parseInt(t[1]||t[0],10)}return n[1]=n[1]||n[0],t&&t.$response.status>=n[0]&&t.$response.status<=n[1]}))?n.resolve(t):n.reject(t)})),this}function n(){if(this.__bb_suppressErrorDialog=!0,!this.$promise)throw new Error("suppressErrorDialog must be called after performing an action, such as $fetch or $resolve");return this.$finally((()=>{this.__bb_suppressErrorDialog=!1}))}function a(e,t){const n=Object.create(null);return Object.keys(e).forEach((a=>{if("$"===a[0])return;const r=e[a];i.equals(r,t[a])||(n[a]=t[a])})),Object.keys(t).forEach((a=>{if("$"===a[0])return;if(n[a])return;const r=t[a];i.equals(r,e[a])||(n[a]=r)})),s(n,"")}function s(e,t){const n=Object.keys(e);let a,r=[];for(let o=0;o<n.length;o++)a=t?t+"."+n[o]:n[o],r.push(a),"$"!==n[o].charAt(0)&&e[n[o]]&&"object"==typeof e[n[o]]&&!i.isArray(e[n[o]])&&(r=r.concat(s(e[n[o]],a)));return r}e.rebase("BbRestmodFindMany"),e.rebase("BbPermissions"),e.rebase("BbPermissionsMask"),e.rebase("BbApiStyle"),e.rebase("BbApiErrorHandlerInjector"),e.rebase("BbEncodeUrl"),e.rebase("BbWithParams"),e.rebase("BbCheckStatusCode"),e.rebase("BbUi"),e.rebase("restmod.Preload"),e.rebase("restmod.FindMany"),e.rebase("$ExtendRecord"),e.rebase("BbExpandParams"),e.rebase("BbExcludeCourseActivity"),e.rebase({$extend:{"Model.$mixHook":function(e,t,n){const a=this,i="$mixHook_"+e,s=i+"_hook";a[i]=a[i]||[],a[i].push(t),a[s]=a[s]||Object(r.once)((function(){a.mix({$hooks:{[e](...e){(a[i]||[]).forEach((t=>t&&t.apply(this,e)))}}})})),a[s]();const o=Object(r.once)((()=>{Object(r.remove)(a[i],(e=>e===t))}));return n&&n.$on("$destroy",o),o}}}),e.rebase({"Model.unpack":b,"Record.$allow":t,"Collection.$allow":t,"Record.$suppressErrorDialog":n,"Collection.$suppressErrorDialog":n,"Record.$revert":function(e){const t=e||this.$_ultra_previous_version,n=a(t,this.$encode("U")),i=this.constructor.$buildRaw(t);return n.forEach((e=>{this[e]=i[e]})),this},"Record.$snapshot":function(){return this.$_ultra_previous_version=this.$encode("U"),this.$_ultra_previous_version},"Record.$getChangedKeys":function(){return a(this.$_ultra_previous_version||{},this.$encode("U"))},"Record.$getPreviousVersion":function(){return this.$_ultra_previous_version},"Record.$patch":function(e){const t=a(this.$_ultra_previous_version||{},this.$encode("U"));if(e&&e.length>0&&e.forEach((e=>{-1===t.indexOf(e)&&t.push(e)})),t.length>0){this.$_ultra_patchHolder={data:this.$wrap("U"),changedKeys:t};const e=function(t){const n=this.$_ultra_patchHolder.changedKeys,a=this.$_ultra_patchHolder.data;n.forEach((e=>{t.data[e]=a[e]})),this.$off("before-update",e)};this.$on("before-update",e),this.$save(t)}else{const e={method:"PATCH",url:this.$url("update"),data:{}};this.$dispatch("before-request",[e])}return this},$hooks:{"after-feed":function(){this.$snapshot()}}}),e.rebase({$extend:{Collection:["slice","filter","concat"].reduce(((e,t)=>(e["$"+t]=function(...e){const n=this.$collection();return n.push.apply(n,this[t].apply(this,e)),n},e)),{})}})}]).run(["$q",e=>{v=e}])},nsX6:function(e,t,n){"use strict";var a=n("Llzl"),i=n("5MwF"),r=n("71td"),s=n("ohO4");n.d(t,"a",(function(){return o}));const o="ultra.components.directives.featureToggle";class l{constructor(e,t){this.$parse=e,this.flagService=t,this.restrict="A",this.priority=1e3,this.transclude="element",this.terminal=!0,this.link=(e,t,n,a,s)=>{let o=!1;const l=n.bbFeatureToggle.startsWith("!"),c=l?n.bbFeatureToggle.substring(1):n.bbFeatureToggle,d=r(document.createComment(`end bbFeatureToggle: ${n.bbFeatureToggle}`)).insertAfter(t),u="false"!==n.delayInitialLoad;let m=!1;const p=()=>{var e,a;m=!0;const r=l?!o:o,c="true"===(null===(e=null==n?void 0:n.prototypeContent)||void 0===e?void 0:e.toLowerCase());if(i.a.showFeaturePrototypes||!c){"true"===(null===(a=null==n?void 0:n.removeFromDom)||void 0===a?void 0:a.toLowerCase())?(g(t.parent(),t,d),r&&s((e=>{h(e,t.parent(),t)}))):s((e=>{r||e.addClass("bb-feature-toggle-hide"),g(t.parent(),t,d),h(e,t.parent(),t)}))}},h=(e,t,n)=>{0!==n.parent().length?n.after(e):t.prepend(e)},g=(e,t,n)=>{const a=e.contents(),i=a.index(t)+1,r=a.index(n);i<r&&a.slice(i,r).remove()};e.$on("feature-flag-values-updated",((e,t)=>{const n=null==t?void 0:t[c],a=this.flagService.isFlagValueTrueStrict(n);n&&void 0!==a&&(u&&!m||a!==o)&&(o=i.a.features[c]||a,p())}));const b=i.a.features[c]||this.flagService.isFeatureEnabledStrict(c);void 0===b&&u||(o=null!=b&&b,p())}}}l.$inject=["$parse",s.b],a.module(o,[s.a]).directive("bbFeatureToggle",["$injector",e=>e.instantiate(l)])},o2qC:function(e,t){e.exports='<table class="fs-table bb-table">\n  <caption role="alert" class="sr-only">{{ ::config().title }}</caption>\n  <thead>\n    <tr class="table-headings">\n      <th class="table-heading"\n          scope="col"\n          ng-style="{ \'width\': column.widthPercentage, \'min-width\': column.widthPercentage }"\n          ng-repeat="column in config().columns"\n          ng-if="column.visible"\n          data-heading-index="{{ ::$index }}"\n          ng-class="{\n            \'sortable-header\': column.sort,\n            \'ascending\': $index === config().currentSortColumnIndex && config().currentSortDirection === \'asc\',\n            \'descending\': $index === config().currentSortColumnIndex && config().currentSortDirection === \'desc\'}"\n          ng-attr-aria-sort="{{ $index === config().currentSortColumnIndex && config().currentSortDirection === \'asc\' ? \'ascending\' :\n          $index === config().currentSortColumnIndex && config().currentSortDirection === \'desc\' ? \'descending\' : undefined }}">\n        <button class="button-anchor" ng-if="column.sort" analytics-id="components.directives.table.sort.button">\n          <span class="table-heading-contents" ng-class="{ \'sr-only\': column.srHeading }">{{ column.heading }}</span>\n          <i class="sort-control">\n            <i class="arrow up" ></i>\n            <i class="arrow down"></i>\n          </i>\n        </button>\n        <span ng-if="!column.sort" class="table-heading-contents" ng-class="{ \'sr-only\': column.srHeading }">{{ column.heading }}</span>\n      </th>\n    </tr>\n  </thead>\n  <tbody ng-if="table.initialDataLoaded || config().showRowsDuringRefresh">\n    <tr ng-repeat="item in tableData()"\n        class="table-row"\n        ng-class="{\'clickable\': config().rowClickFn }"\n        ng-click="config().rowClickFn ? config().rowClickFn(item): null"\n        ng-transclude\n        analytics-id="components.directives.table.rowClick"></tr>\n  </tbody>\n</table>\n<div ng-if="config().pageSize && table.initialDataLoaded">\n  <div bb-infinite-scroll="table.showMore()"\n       infinite-scroll-immediate-check="false"\n       infinite-scroll-total-count="config().totalCount"\n       infinite-scroll-current-count="tableData().length"\n       infinite-scroll-load-limit="config().pageSize"\n       infinite-scroll-container="config().infiniteScrollContainerSelector()"\n       infinite-scroll-tray-id="{{::config().instanceId}}-scroll-tray"></div>\n</div>\n<div class="spinner bb-secondary-color-2" ng-show="!table.initialDataLoaded"></div>'},o5Lu:function(e,t,n){"use strict";(function(e){n.d(t,"m",(function(){return P})),n.d(t,"n",(function(){return x})),n.d(t,"c",(function(){return $})),n.d(t,"b",(function(){return N})),n.d(t,"d",(function(){return D})),n.d(t,"a",(function(){return L})),n.d(t,"f",(function(){return j})),n.d(t,"g",(function(){return M})),n.d(t,"e",(function(){return B})),n.d(t,"j",(function(){return F})),n.d(t,"i",(function(){return U})),n.d(t,"k",(function(){return q})),n.d(t,"l",(function(){return H})),n.d(t,"h",(function(){return V}));var a=n("D57K"),i=n("nsO7"),r=n("Llzl"),s=n("rEZX"),o=n("IbyE"),l=n("z6Q5"),c=n("0JpG"),d=n("d8yC"),u=n("Fvsw"),m=n("Qbdf"),p=n("fYJU"),h=n("jhBu"),g=n("Bu0u"),b=n("oi1r"),f=n("X/qj"),v=n("pjml"),y=n("wgY5"),S=n("Mc6f"),C=n("5uPl"),E=n("e6jQ"),I=n("TnpK"),k=n("aHpC"),w=n("ZQFV"),T=n("zGdY"),O=n("Htol"),A=n("Kpdw");const P="ultra.services.grade",x="grade",$="course.grades.gradebook-item.submission.grade-status-change",N="course.grades.gradebook-item.submission.grade-exempt-change",D="bb-update-column",L="bb-update-attendance-column",j="bb-update-attendance-as-grade",M="placeholder";var G,R;!function(e){e.Delete="delete",e.ResetToNG="resetToNG"}(G||(G={})),function(e){e.Possible="possible",e.Text="text"}(R||(R={}));let B=class t{constructor(e,t,n,a,i,r,s,o,l,c,d,u,m,p,h,g,b,f,v,y,S,C,E,I){this.$q=e,this.$rootScope=t,this.$injector=n,this.cacheFactory=a,this.$ngRedux=i,this.CourseModel=r,this.GradeAttemptModel=s,this.GradebookSettingsModel=o,this.GradeGroupAttemptModel=l,this.GradeModel=c,this.ColumnModel=d,this.UserModel=u,this.GradeBulkViewModel=m,this.context=p,this.bbLocalize=h,this.ultraState=g,this.batchService=b,this.entitlement=f,this.notation=v,this.schemaService=y,this.gradebookPermissionService=S,this.originalityReportService=C,this.contextUser=E,this.contextCourse=I,this.GRADEBOOK_ITEM_CONFIRMATION_HANDLE_BASE="resource/x-bb-grade",this.loadColorPreference=()=>{},this.colorSettings={isColorEnabled:!0,colorPreference:""},this.gbSettingsCache=a.createCache("gbSettings"),this.subscribeToRedux(),this.loadColorPreference()}subscribeToRedux(){const e=this.$ngRedux.connect((e=>{const t=o.Yb.systemPreference.getSystemPreferenceByKey(e,"gradepill.color.preference.settings");return t&&t.value&&t.value!==this.colorSettings.colorPreference?{colorSettings:{colorPreference:t.value,...JSON.parse(t.value)}}:{}}),(e=>({loadColorPreference:()=>e(o.V.systemPreference.loadSystemPreference({key:"gradepill.color.preference.settings"}))})))(this);this.$rootScope.$on("$destroy",e)}loadColumnsAndGrades(e){const t=this.CourseModel.$new(e.courseId),n="associatedRubrics,collectExternalSubmissions"+(e.includeIsLateAttemptCreationDisallowed?",isLateAttemptCreationDisallowed":""),a=this.loadColumns(t,e.includeExternal,{expand:n,includeInvisible:!!e.includeInvisible}).then((t=>e&&e.attachContentsByScoreProviderHandle?t.attachRelatedContentsByScoreProviderHandle(e.attachContentsByScoreProviderHandle):t)),r=this.loadGrades(t,e.userId,e.gradeQueryParams);return this.$q.all([a,r]).then((n=>{const a=n[0]||[],r=n[1]||[],s=[],o=i.keyBy(r,(e=>e.columnId));return a.forEach((e=>{let t=o[e.id];t?t.column=e:t=this.GradeModel.$build({column:e}),s.push(t)})),this._loadAttempts(s,t,e.attemptQueryParams).then((e=>e))}))}loadGrade(e,t){const n=this.CourseModel.$new(e.courseId);let a,r;if(e.column)r=e.column&&e.column.$asPromise&&e.column.$asPromise()||this.$q.when(e.column);else{if(!e.columnId)throw new g.a({message:"Column or columnId must be provided."});r=n.gradebook.columns.$find(e.columnId).$asPromise()}return r.then((r=>(i.merge(e.gradeQueryParams,{userId:e.userId}),r.grades.$search(e.gradeQueryParams).$allow([404]).$asPromise().then((i=>(a=i[0],a?(a.column=r,t?this.loadAttempt(a,n,e.attemptQueryParams,e.content):this.$q.when(a)):this.$q.when(null)))))))}loadCurrentColumnsAndGrades(e,t,n,a,i){const r=e||this.contextCourse.courseId,s=i||this.contextUser.userId;return this.loadColumnsAndGrades({courseId:r,userId:s,includeExternal:!0,includeInvisible:!!t,includeIsLateAttemptCreationDisallowed:!!n,gradeQueryParams:{expand:"attemptsLeft"},attemptQueryParams:{overrideAggregationModel:v.C.AttemptAggregationModel.Last},attachContentsByScoreProviderHandle:a})}loadColumns(e,t,n){e instanceof this.CourseModel||(e=this.CourseModel.$new(e));const a=e=>t?e:e.filter((e=>!e.externalGrade)),i=e.gradebook.columns;return(i?i.length:0)>(n&&"offset"in n?n.offset:0)?i.$refresh(n).$asPromise().then(a):i.$fetch(n).$asPromise().then(a)}loadGrades(e,t,n){e instanceof this.CourseModel||(e=this.CourseModel.$new(e));const a=i.merge({userId:t},n);return a.limit=100,e.gradebook.grades.$fetch(a).$asPromise().then((n=>n.paging.nextPage?(a.offset=n.paging.offset+n.paging.limit,this.loadGrades(e,t,a)):e.gradebook.grades))}loadColumnGrades(e,t){return e instanceof this.ColumnModel||(e=t.gradebook.columns.$new(e)),e.grades.$refresh().$asPromise()}loadColumn(e,t,n){return t instanceof this.CourseModel||(t=this.CourseModel.$new(t)),t.gradebook.columns.$find(e,{expand:"associatedRubrics"}).$allow(n?[T.S.NotFound]:[]).$asPromise().then((e=>{var t;return(null===(t=null==e?void 0:e.$response)||void 0===t?void 0:t.status)===T.S.NotFound&&n?null:e}))}loadOverallGradeColumn(e){return this.loadColumn("finalGrade",e,!0)}loadRubricAssociation(e,t){return this.loadColumn(e,t).then((e=>e&&e.hasRubricAssociation()?t.rubrics.$find(e.getAssociatedRubricId()).$asPromise():null))}loadBulkViewRows(e,t,n,a,r){const s=[],o=[];e.forEach((e=>{o.push(e.id);const n=this.$injector.instantiate(z,{column:t});n.user=e.user,n.membership=e,n.dueDate=t.dueDate,n.hasDueDateException=e.isDueDateExcepted(),s.push(n)}));const l=i.keyBy(s,(e=>e.user.id));let c={courseId:t.courseId,membershipIds:o,columnIds:[t.id]};return a&&(c=i.merge(c,a)),this.fetchBulkView(c).then((e=>this.processBulkViewRows(e,l,t,n,r)))}loadAnonymousBulkViewRows(e,t,n,a,r){const s=[],o=[];e.forEach((e=>{o.push(e.id);const n=this.$injector.instantiate(z,{column:t});n.user=this.UserModel.getAnonymousStudent(e.id),n.grade=e,n.dueDate=t.dueDate,s.push(n)}));const l=i.keyBy(s,(e=>e.grade.id));let c={courseId:t.courseId,gradeIds:o,columnIds:[t.id]};return a&&(c=i.merge(c,a)),this.fetchBulkView(c).then((e=>this.processBulkViewRows(e,l,t,n,r)))}fetchBulkView(e){return this.CourseModel.$new(e.courseId).gradebook.bulkView.$fetch(e).$asPromise()}processBulkViewRows(e,t,n,a,r){e.bulkViewUsers.forEach((e=>{const i=n.anonymousGrading?e.gradeId:e.studentId,s=t[i];r&&!r(s)?delete t[i]:U(s,e,a)}));const s=i.values(t);return this.originalityReportService.setOriginalityAverageScore(s,n.id),s}loadCustomizedBulkViewRows(e,t,n,a,r,s){if(o.O.Discussion.isEqualTo(t.scoreProviderHandle)){const r=this.$q.defer();return this.loadBulkViewRows(e,t,null,{expand:"grade.instructorFeedback,attempts"}).then((s=>{const o=i.merge(i.clone(a),{limit:e.length}),l=i.merge(i.clone(o),{dateBefore:t.dueDate}),c=(e,t)=>{if(e&&e.length){const n={};e.forEach((e=>{const a=e.data.id;n[a]=t?{totalComment:e.topLevelReplyCount,totalReply:e.secondLevelReplyCount}:{comment:e.topLevelReplyCount,reply:e.secondLevelReplyCount}})),s.forEach((e=>{if(n&&n[e.user.id]){e.participation||(e.participation={comment:0,reply:0,totalComment:0,totalReply:0});const a=n[e.user.id];t?(e.participation.totalComment=a.totalComment,e.participation.totalReply=a.totalReply):(e.participation.comment=a.comment,e.participation.reply=a.reply)}}))}};this.$q.all([this.CourseModel.$find(t.courseId).forums.$new(n).usercounts.$fetch(l).$allow([400]).$then((e=>{c(e)})).$asPromise(),this.CourseModel.$find(t.courseId).forums.$new(n).usercounts.$fetch(o).$allow([400]).$then((e=>{c(e,!0)})).$asPromise()]).then((()=>r.resolve(s))).catch(r.reject)})).catch(r.reject),r.promise}let l="attempts";r&&(l+=",submissionResults");const c=!!s;return this.loadBulkViewRows(e,t,null,{expand:l,includeInProgress:c})}loadAnonymousStudentRows(e){return this.retrieveAnonymousStudentRows(e,null)}loadAnonymousStudentRowsNeedsGrading(e){return this.retrieveAnonymousStudentRows(e,{status:"NEEDS_GRADING",readyToPost:!1})}retrieveAnonymousStudentRows(e,t){const n={expand:"toolAttemptDetail,viewUrl",...t};return e.getGradeIdToAttempt(n).then((e=>e.lookup)).then((t=>{const n=[];return Object.keys(t).forEach((a=>{const r=t[a];if(i.remove(r,(e=>e.isInProgress())),r.length>0){const t=this.createAnonymousStudentRow(e,r,a);n.push(t)}})),n}))}createBlankSubmissionListRow(e){const t=this.$injector.instantiate(z,{column:e});return t.user=this.UserModel.getAnonymousStudent(""),t.id=M,t}generatePeerRow(e,t,n){const a=this.createAnonymousStudentRowWithoutId(t,e,n);return e.length>0&&(a.delegatedGraderOrder=e[0].delegatedGraderOrder),a}createAnonymousStudentRow(e,t,n){return this.createAnonymousStudentRowImpl(e,t,n,n)}createAnonymousStudentRowWithoutId(e,t,n){return this.createAnonymousStudentRowImpl(e,t,n,"")}createAnonymousStudentRowImpl(e,t,n,a){const i=this.$injector.instantiate(z,{column:e}),r=t[t.length-1],s=t.reverse().find((e=>e.displayGrade&&null!=e.displayGrade.score));return i.user=this.UserModel.getAnonymousStudent(a),i.dueDate=e.dueDate,i.attemptCount=t.length,i.lastAttemptDate=r.attemptDate,i.grade=this.GradeModel.$build({id:n,user:i.user,attempts:t,displayGrade:s&&s.displayGrade||{},manualStatus:s&&s.status||T.Bb.NoOverride}),i}loadAnonymousStudentGrade(e,t){const n=e.grades.$new(t).attempts,a=this.UserModel.getAnonymousStudent(t);return n.$fetch().$asPromise().then((n=>this.GradeModel.$build({pointsPossible:e.possible,id:t,user:a,attempts:n})))}loadGroupRows(e,t,n,a,r,s){const o={};let l=[];const c=i.keyBy(n,(e=>e.user.id));let d;return d=a.ui&&a.ui.content&&a.ui.content.assignedGroups&&a.ui.content.assignedGroups.some((e=>!!e.groupAssociationId))?this.$q.when(a.ui.content):e.contents.$find(a.contentId,{expand:"assignedGroups"}).$asPromise(),d.then((n=>{const d={};return n&&n.assignedGroups&&n.assignedGroups.forEach((e=>{d[e.groupId]=e.groupAssociationId,!t&&s&&s===e.groupId&&(t=[e])})),l=t.map((t=>(o[t.groupId]={},e.groups.$find(t.groupId,{expand:"memberships"}).$then((e=>{const t=this.$injector.instantiate(z,{column:a});t.group=e,t.groupDetailsShown=!1,t.dueDate=a.dueDate,t.group.ui||(t.group.ui={}),t.group.ui.groupAssociationId=d[e.id],t.group.memberships&&(t.group.memberships=t.group.memberships.filter((e=>!!c[e.userId]&&(e.ui||(e.ui={}),e.ui.user=c[e.userId].user,e.ui.hasDueDateException=c[e.userId].isDueDateExcepted(),e.ui.courseRole=c[e.userId].courseRole,!0)))),t.hasDueDateException=t.group.memberships.some((e=>c[e.userId].isDueDateExcepted())),o[e.id]=t})).$asPromise()))),this.$q.all(l).then((()=>{let e="attempts,toolAttemptDetail,lastFeedbackAuthor,attempts.lastFeedbackAuthor";return r&&(e+=",submissionResults"),a.getContentGroupIdToGroupAttempt({expand:e}).then((e=>{const t={};i.values(e.lookup).forEach((e=>{t[e[0].groupId]=e}));let n,r=[];return this.batchService.performBatch((()=>{n=i.values(o),r=n.map((e=>{var n;const i=(null===(n=t[e.group.id])||void 0===n?void 0:n.length)>0?t[e.group.id].length-1:0;return this.updateOneGroupRow(e,a,{expand:!0,groupAttempts:t[e.group.id],currentAttemptIndex:i})}))})),this.$q.all(r).then((()=>this.originalityReportService.setOriginalityAverageScore(n,a.id))),this.$q.all(r).then((()=>this.sortGroupMembers(n)))}))}))}))}getOverallGradeJson(t){const n=e(e.parseHTML(t));let a={};if("math"===n.prop("nodeName")){const t=n.children();if(t&&t.length>0){const n=e(t[0]);if("mi"===n.prop("nodeName")){let e=n.text();e=e.replace("@X@BBCalColElem(",""),e=e.replace(")@X@","");const t=e.indexOf(":")+1,i=e.substring(t);a=JSON.parse(i)}}}return a}sortGroupMembers(e){const t=[];return e.forEach((e=>{const n=[];e.group.memberships&&(e.group.memberships.forEach((e=>{n.push(this.bbLocalize.formatUsername(e.ui.user,c.ILocaleUsernameFormat.Short,this.$rootScope).then((t=>{e.ui.formatUserName=t})))})),t.push(this.$q.all(n).then((()=>{e.group.memberships.sort(((e,t)=>e.ui.formatUserName.localeCompare(t.ui.formatUserName))),e.group.ui.users=[],e.group.memberships.forEach((t=>{e.group.ui.users.push(t.ui.user)}))}))))})),this.$q.all(t).then((()=>e))}updateOneGroupRow(e,t,n={expand:!0}){return t.getGroupGrade(e.group.ui.groupAssociationId,n.expand).then((t=>{var a,i;const r=n.currentAttemptIndex||0,s=n.groupAttempts&&n.groupAttempts[r]||(null===(a=e.grade)||void 0===a?void 0:a.ui.groupAttempt);if(e.grade=t,(null===(i=null==n?void 0:n.groupAttempts)||void 0===i?void 0:i.length)>0){let t=0,a=0;n.groupAttempts.forEach((e=>{var n,i,r;(null===(r=null===(i=null===(n=e.originality)||void 0===n?void 0:n.results)||void 0===i?void 0:i[T.od])||void 0===r?void 0:r.originalityProcessed)&&(t+=e.originality.results[T.od].originalityScore,a+=1)})),a>0&&(e.originalityScore=t/a,e.originalityProcessed=!0)}else s&&(e.originalityScore=s.originalityScore,e.originalityProcessed=s.originalityProcessed);return this.setGroupAttemptsOnRow(e,n.groupAttempts||[s],n.grade,n.grades||t.groupMembersGrades,n.attempt,r),e}))}setGroupAttemptsOnRow(e,t,n,a,r,s){let o={rawText:"",displayText:""};n&&n.instructorFeedback?o=n.instructorFeedback:a&&a.length&&a[0].instructorFeedback&&(o=a[0].instructorFeedback);let l,c=0;(null==t?void 0:t[s])?(t.forEach((t=>{e.grade.groupAttempts.push(t),T.l.NeedsGrading!==t.status&&T.l.NeedsMoreGrading!==t.status&&T.l.Completed!==t.status||(c+=1)})),l=t[s]):(l=this.GradeGroupAttemptModel.$buildRaw({}),e.grade.groupAttempts.push(l)),e.attemptCount=c,e.lastAttemptDate=l.attemptDate,e.grade.instructorFeedback=o,e.grade.ui={groupAttempt:l,currentAttemptIndex:s},e.isGroupGradeInProgress=e.grade.isInProgress(),e.grade.ui.isGroupGradeMultiple=e.grade.isMultipleGradesInGroup;const d=i.keyBy(e.group.memberships,(e=>e.userId));if(a)a.forEach((e=>{const t=d[e.user.$pk];t&&(t.ui.gradeDetail=e)}));else if(r){const t=l.attempts.map(((e,t)=>{let n;return e.id===r.id?(n=r,n.userId=e.userId,d[n.userId].ui.gradeDetail.displayGrade=n.displayGrade,d[n.userId].ui.gradeDetail.ui.attempt=n):n=e,n}));e.grade.isInProgress()&&(e.grade.ui.groupAttempt.status=T.l.NeedsGrading),e.grade.ui.groupAttempt.attempts=t}else n?e.group.memberships=e.group.memberships.map((e=>{const t=e.userId===n.user.$pk?n:e.ui.gradeDetail;return e.ui.gradeDetail=t,e})):l.attempts&&l.attempts.forEach((t=>{d[t.userId].ui.gradeDetail.displayGrade=t.displayGrade,d[t.userId].ui.gradeDetail.ui.attempt=t,d[t.userId].ui.gradeDetail.manualStatus=e.grade.manualStatus}));e.group.memberships=i.values(d)}_loadAttempts(e,t,n){const a=[];return e.forEach((e=>{a.push(this.loadAttempt(e,t,n))})),this.$q.all(a)}loadAttempt(e,n,a={},r){let s;const o=i.clone(a);if(o&&o.attemptId)s=o.attemptId,delete o.attemptId;else{let n=v.C.parseAttemptAggregationModel(e.column&&e.column.aggregationModel);o&&o.overrideAggregationModel&&(n=o.overrideAggregationModel,delete o.overrideAggregationModel),s=t.getDefaultAttemptIdToLoad(n,e)}if(e.column&&T.p.NonCalculated===e.column.calculationType){let t;const a=n.gradebook.attempts,i=r&&r.isGroupContent,l=r&&r.assignedGroups&&r.assignedGroups.length&&r.assignedGroups[0].groupAssociationId;if(i&&!r.isDiscussion()){if(!l)return this.$q.when(e);t=e.column.getGroupAttemptByGroupAssociationId(l,!1,s)}else{if(!s)return this.$q.when(e);t=a.$find(s,o).$asPromise()}return t.then((t=>{if(i){if(t&&t.id){const n=t;e.ui.groupAttempt=n,e.ui.attempt=n&&n.attempts&&n.attempts.length&&n.attempts[0]}}else e.ui.attempt=t;return e}))}return this.$q.when(e)}loadColumnAttempts(e,t={},n){return e.getGradeIdToAttempt(t,n)}loadUsersFinalGradeForCourse(e,t){return e.gradebook.grades.$search({userId:t,expand:"column",externalGrade:!0}).$asPromise().then((e=>e[0]))}loadColumnSummary(e,t){return e.gradebook.columns.$find(t).summary.$fetch().$asPromise()}loadGradebookSettings(e){const t=this.gbSettingsCache.get(e);if(!t){const t=this.CourseModel.$new(e).gradebook.settings.$fetch().$asPromise();return this.gbSettingsCache.put(e,{promise:t}),t}return this.$q.when(t.promise)}loadDefaultGradebookSettings(){return this.GradebookSettingsModel.$build({afterDecimal:t.DEFAULT_GRADEBOOK_SETTINGS_AFTER_DECIMAL,beforeDecimal:t.DEFAULT_GRADEBOOK_SETTINGS_BEFORE_DECIMAL})}formatPoints(e,t,n,a){null==n&&(n=R.Text);const i=n;return this.bbLocalize.loadBundle("components/services/grade").then((()=>this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(t),key:"components.services.grade.points_"+i,params:{points:a,possible:e},noWrap:!0})))}parseGrade(e,t,n){if(!e)return"";if((null==t?void 0:t.scaleType)===T.Ub.Text)return e;const a=this.bbLocalize.parseNumberSync(e,n);return Number.isNaN(a)?e:a.toString()}getGradeToDisplay(e,n,a){if(!e)return null;if(e.grade)return e.grade;if(e.perfCode)return e.perfCode.code;if(null!=e.score){let i=this.bbLocalize.formatNumberSync(e.score,n,{round:"truncate",maximumFractionDigits:t.DEFAULT_GRADEBOOK_SETTINGS_AFTER_DECIMAL});return a&&a===T.Ub.Percent&&(i=this.bbLocalize.formatPercentageSync(e.score/100,n,t.DEFAULT_GRADEBOOK_SETTINGS_AFTER_DECIMAL)),i}}getHighestPossibleScore(e,t,n){const a=this.$q.defer();switch(e.scaleType){case T.Ub.Tabular:return a.resolve(e.symbols[0].symbol),a.promise;case T.Ub.Percent:return this.bbLocalize.formatPercentage(1,n);case T.Ub.Score:{const e=t.possible;return this.formatPoints(e,n,R.Text)}default:return a.resolve("N/A"),a.promise}}validateGrade(e,t,n){const a=this.loadDefaultGradebookSettings(),i=this.bbLocalize.loadBundle("components/services/grade"),r=this.notation.getGradeNotationsMap(e.courseId,!0);return this.$q.all([i,r]).then((i=>{const r=e.gradeValue.getGrade();let s=!1;const o=i[1];return r?(s=this.isValidNumericGrade(r,a,t),!s&&e.column&&e.column.externalGrade&&(s=this.notation.isValidPerformanceCodeGrade(o,r))):s=!(n&&n.notAllowEmptyString),s}))}clearGroupGrade(e,n,a){const i=this.CourseModel.$new(e.id).gradebook.columns.$new(n.id);return this.batchService.performBatch((()=>this.$q.all(a.map((e=>{const n=i.grades.$new(e.ui.gradeDetail.id);return n.manualGrade=t.CLEAR_GRADE_CHARACTER,n.$patch(["manualGrade"]).$asPromise()}))))).then((()=>i.grades))}saveGrade(e,t,n,a){if(!e.courseId||!e.column||!e.gradeValue)throw new Error("A valid courseId, column, and grade value are required.");if(e.column.seemsAttemptBased()){const i=[],r=[];a&&a.group&&a.group.memberships&&a.group.memberships.forEach((t=>{t.ui&&t.ui.gradeDetail&&(i.push(t.ui.gradeDetail.id),(t.ui.gradeDetail.displayGrade&&t.ui.gradeDetail.displayGrade.isOverride||e.setGradeToEmpty)&&r.push(t.ui.gradeDetail.id))})),(null==n||null==n.id)&&t||n&&n.isInProgress()?(a.group?e.gradeIds=i:e.gradeId=t.id,!e.userId&&a.userId&&(e.userId=a.userId),e.clearGrade&&(e.setGradeToEmpty=!0)):n&&n.id&&t?(e.clearGrade&&(a.group||(e.gradeId=t.id),e.setAttemptToEmpty=!0,e.setGradeToEmpty=!0),n instanceof this.GradeAttemptModel?(e.attemptId=n.id,n.groupAttemptId&&(e.override=!0),(t.displayGrade&&t.displayGrade.isOverride||e.setGradeToEmpty)&&(e.gradeId=t.id,e.setGradeToEmpty=!0)):(e.groupAttemptId=n.id,r.length&&(e.gradeIdsNeedClear=r))):a&&a.userId?e.userId=a.userId:a&&a.group&&a.group.id&&!(null==e?void 0:e.groupAttemptId)&&(e.gradeIds=i)}else e.column.externalGrade?t&&t.id?e.gradeId=t.id:e.userId=a.userId:null==t?e.userId=a.userId:(e.userId||(e.userId=a.userId),e.gradeId=t.id);return this._save(e)}save(e){return this._save(e)}_save(e){if(e.column.externalGrade)return e.gradeId?this.updateGrade(e):this.createGradeForUserAndSave(e);if(!this.canSaveGradeDetail(e))return this.updateAttempt(e);if(e.gradeId)return e.attemptId?(e.setGradeToEmpty=!0,this.updateGrade(e).then((()=>this.updateAttempt(e)))):this.updateGrade(e);if(e.gradeIds)return this.createAndUpdateGradesForGroupMembers(e);if(e.gradeIdsNeedClear)return this.createAndUpdateGradesForGroupMembers(e).then((()=>this.updateGroupAttempt(e)));if(e.attemptId)return this.updateAttempt(e);if(e.groupAttemptId)return this.updateGroupAttempt(e);if(e.userId)return this.createGradeForUserAndSave(e);throw new Error("A valid userId must be specified when creating a new grade.")}canSaveGradeDetail(e){return!e.column.anonymousGrading&&(!e.column.delegatedGrading||this.isDelegatedAndEntitledReconciler(e))}createAndUpdateGradesForGroupMembers(e){const t=this.CourseModel.$new(e.courseId).gradebook.columns.$new(e.column.id).grades;return e.gradeIdsNeedClear||e.gradeIds?this.batchService.performBatch((()=>this.$q.all((e.gradeIdsNeedClear||e.gradeIds).map((n=>{const a=t.$buildRaw({id:n});return t.$add(a),this.setGradeValueOnGrade(e,a,!!e.gradeIdsNeedClear||e.setGradeToEmpty),a.withParams({clearCommentsIfRevertOverrides:!1}).$patch().$asPromise()}))))).then((()=>t.$asPromise())):t.$asPromise()}createGradeSubmission(e,t,n){return new s.a(e,t,n)}wasGradeCleared(e,t){const n=e&&e.length,a=t&&t.length;return n>0&&!a}updateAttempt(e){if(!e.attemptId)throw new Error("Attempt id is not set");const t=this.CourseModel.$new(e.courseId).gradebook.attempts.$new(e.attemptId);return this.setGradeOnAttempt(e,t),t.$patch().$asPromise()}updateGroupAttempt(e){if(!e.groupAttemptId)throw new Error("Group attempt id is not set");const t=this.CourseModel.$new(e.courseId).gradebook.groupAttempts.$new(e.groupAttemptId);return this.setGradeOnAttempt(e,t),t.withParams({expand:"attempts"}).$patch().$asPromise()}isReadyToPost(e){return!e.delegatedGrading||e.isUserReconciler(this.contextUser.userId)}setGradeOnAttempt(e,n){e.setAttemptToEmpty?(n.score=null,n.status=T.l.NeedsGrading,n.grade=t.CLEAR_GRADE_CHARACTER,n.rubricEvaluation=null):(e.gradeValue.isNumeric?n.score=parseFloat(e.gradeValue.getGrade()):n.grade=e.gradeValue.getGrade(),e.rubricEvaluation&&(n.rubricEvaluation=e.rubricEvaluation),n.readyToPost=this.isReadyToPost(e.column),n.readyToPost||(n.status=T.l.Completed)),e.override&&(n.override=!0),this.isDelegatedAndEntitledReconciler(e)&&!e.setAttemptToEmpty&&(n.reconciliationMode=T.Rb.Custom)}isDelegatedAndEntitledReconciler(e){return e.column.delegatedGrading&&e.column.isUserReconciler(this.contextUser.userId)}createGradeForUserAndSave(e){const t=this.CourseModel.$new(e.courseId).gradebook.columns.$new(e.column.id).grades.$new();return this.setGradeValueOnGrade(e,t,e.setGradeToEmpty),t.user=this.UserModel.$new(e.userId),t.withParams({userId:e.userId,clearCommentsIfRevertOverrides:!1}).$save().$asPromise()}updateGrade(e){const t=this.CourseModel.$new(e.courseId).gradebook.columns.$new(e.column.id).grades.$new(e.gradeId);return this.setGradeValueOnGrade(e,t,e.setGradeToEmpty),e.setGradeToEmpty?t.withParams({clearCommentsIfRevertOverrides:!1,includeUnpostedGrade:!0,cascadeAttempts:G.ResetToNG}).$patch().$asPromise():t.withParams({clearCommentsIfRevertOverrides:!1,includeUnpostedGrade:!0}).$patch().$asPromise()}setGradeValueOnGrade(e,n,a){if(a)n.manualGrade=t.CLEAR_GRADE_CHARACTER;else if(e.column.externalGrade&&e.perfCodeId)n.perfCodeId=e.perfCodeId;else{const t=e.gradeValue;t.isNumeric?(n.pointsPossible=e.pointsPossible,n.manualScore=parseFloat(t.getGrade())):n.manualGrade=t.getGrade()}}isValidNumericGrade(e,t,n){const a=this.bbLocalize.parseNumberSync(e,n);let i;if(Number.isNaN(a))return!1;if(t&&null!=t.beforeDecimal&&(i=Math.floor(a).toString(),i.length>t.beforeDecimal))return!1;if(t&&null!=t.afterDecimal&&null!=i){if(a.toString().substring(i.length+1).length>t.afterDecimal)return!1}return!0}static isValidFormat(e,t){const n=e.indexOf(".");let a=0,i=e.length;return n>-1&&(a=i-n-1,i=0),i<=t.beforeDecimal&&n<=t.beforeDecimal&&a<=t.afterDecimal}static mapSchemaSymbols(e){if(e.scaleType===T.Ub.Tabular)return e.symbols.map((e=>e.symbol.toLocaleLowerCase()))}static getDefaultAttemptIdToLoad(e,t){switch(e){case v.C.AttemptAggregationModel.Average:return t.lastAttemptId;case v.C.AttemptAggregationModel.First:return t.firstAttemptId;case v.C.AttemptAggregationModel.Highest:return t.highestAttemptId;case v.C.AttemptAggregationModel.Last:return t.lastAttemptId;case v.C.AttemptAggregationModel.Lowest:return t.lowestAttemptId;default:return t.lastAttemptId}}findOverallGrade(e){return i.find(e,(e=>e.externalGrade))}needsToSetupOverall(e,t){const n=this.findOverallGrade(e);return this.$q.when(!n)}fetchNeedsToSetupOverallGrade(e){const t=e instanceof this.CourseModel?e.id:e;return this.loadOverallGradeColumn(e).then((e=>this.needsToSetupOverall(e?[e]:[],t)))}setDeleteConfirmationHandle(e){e.isOffline()?e.ui.deleteConfirmationHandle=this.GRADEBOOK_ITEM_CONFIRMATION_HANDLE_BASE+"-column":e.isCalculated()&&(e.ui.deleteConfirmationHandle=this.GRADEBOOK_ITEM_CONFIRMATION_HANDLE_BASE+"-calculation")}calculateRankingsMap(e,t){const n={},a=e.length;let i,r,s;for(let o=0;o<a;o++)r=o/a,i=t?10*Math.floor(10*r):Math.floor(100*r),s=e[o].displayGrade.score,n[s]=i;return n}getPercentileColor(e){return w.O.getPercentileColor(e,this.colorSettings.isColorEnabled)}isRubricGradeOverridden(e,t,n,a){let i=e&&e.displayGrade&&e.displayGrade.isOverride;a&&a.memberships&&a.memberships.forEach((e=>{e.ui&&e.ui.gradeDetail&&e.ui.gradeDetail.displayGrade&&e.ui.gradeDetail.displayGrade.isOverride&&(i=!0)}));const r=null!=n.rubricAssociations&&n.rubricAssociations.length>0&&n.rubricAssociations[0],s=t&&t.rubricEvaluation,l=!(!t||!t.groupAttemptId);return!(!t||l||null==t.score||!t.readyToPost||!r||s&&s.rubricAssociationId===r.id&&t.score===s.totalScore)||i&&(r||!o.O.UltraAssignment.isEqualTo(n.scoreProviderHandle)&&!o.O.Discussion.isEqualTo(n.scoreProviderHandle))}canGrade(e){return this.gradebookPermissionService.canEnterGrades()&&this.gradebookPermissionService.canOverrideGrades()}canUserReconcile(e,t){return!e.isClosed&&t.isUserReconciler(this.contextUser.userId)}hasItemsToReconcile(e){return e.summary.numSubmissionsNeedsReconciling>0}canPostGrades(e,t){if(!this.gradebookPermissionService.canPostGrades(e.id,t))return!1;const n=!e.isComplete()&&t.summary.hasGradesToPost();return t.anonymousGrading?n&&this.gradebookPermissionService.canDeanonymizeGrades(e.id):n}getPostAllGradeConfirmationNeededStringsKey(e){if(e.anonymousGrading){if(e.summary.numNeedsGrading)return"x-bb-grade-anonymous-submissions-not-graded";if(!e.isLate()){if(e.getNumMissing()>0)return"x-bb-grade-anonymous-missing-submissions";if(e.isMultipleAttempts())return"x-bb-grade-anonymous-multiple-attempts"}return"x-bb-grade-anonymous-generic"}return"x-bb-grade-column-post-grades"}pointToPercentage(e,t){return 100*e/t}percentageToPoint(e,t){return e*t/100}gradeDetailToPercentage(e){if(!e)return e;const t=i.assignInWith({},e);if(e.displayGrade&&void 0!==e.manualScore){const n=this.pointToPercentage(e.manualScore,e.pointsPossible);t.manualScore=d.b(n,2),t.displayGrade.score=t.manualScore}return t.pointsPossible=100,t}percentageToGradeDetail(e,t){if(!e)return e;let n=e.manualScore;e.manualScore&&(n=this.percentageToPoint(e.manualScore,t));const a=i.assignInWith({},e);return a.manualScore=n,a.displayGrade.score=n,a.pointsPossible=t,a}truncateGradeDetail(e){const t=i.assignInWith({},e);return e.displayGrade&&void 0!==e.manualScore&&(t.manualScore=d.b(e.manualScore,2),t.displayGrade.score=t.manualScore),t}toFixedGradeDetail(e){const t=i.assignInWith({},e);return e.displayGrade&&void 0!==e.manualScore&&(t.manualScore=parseFloat(e.manualScore.toFixed(2)),t.displayGrade.score=t.manualScore),t}refreshCourseContents(e){this.loadGrade({courseId:e.courseId,columnId:e.getAssociatedGradingColumn().id,userId:this.contextUser.userId,includeExternal:!0},!0).then((e=>{e.isGraded()&&this.$rootScope.$broadcast(O.a)}))}};function F(e,t,n){return Object(T.Mc)(o.Zb,{courseId:e,columnId:t,groupId:n})}function U(e,t,n){const{peerReviewsCountsPerColumn:a,grades:[i]}=t;e.originalityProcessed=i.originalityProcessed,e.originalityScore=i.originalityScore,e.grade=i.grade,e.grade.user=e.user,e.attemptCount=i.attemptCount,e.lastAttemptDate=i.lastAttemptDate,e.attemptsReadyToPost=i.attemptsReadyToPost,(null==a?void 0:a[e.Column.id])&&(e.peerReviewCounts=null==a?void 0:a[e.Column.id]),(null==n?void 0:n.lookup[i.grade.id])&&(e.grade.attempts=n.lookup[i.grade.id])}var _;B.TEXT_SCHEMA_CHARACTER_LENGTH=32,B.CLEAR_GRADE_CHARACTER="-",B.DEFAULT_GRADEBOOK_SETTINGS_BEFORE_DECIMAL=5,B.DEFAULT_GRADEBOOK_SETTINGS_AFTER_DECIMAL=2,B=Object(a.a)([Object(a.c)(0,Object(k.b)("$q")),Object(a.c)(1,Object(k.b)("$rootScope")),Object(a.c)(2,Object(k.b)("$injector")),Object(a.c)(3,Object(k.b)("DSCacheFactory")),Object(a.c)(4,Object(k.b)("$ngRedux")),Object(a.c)(5,Object(k.b)(v.m.serviceName)),Object(a.c)(6,Object(k.b)(v.A.serviceName)),Object(a.c)(7,Object(k.b)(v.G.serviceName)),Object(a.c)(8,Object(k.b)(v.E.serviceName)),Object(a.c)(9,Object(k.b)(v.D.serviceName)),Object(a.c)(10,Object(k.b)(v.C.serviceName)),Object(a.c)(11,Object(k.b)(v.Jb.serviceName)),Object(a.c)(12,Object(k.b)(v.B.serviceName)),Object(a.c)(13,Object(k.b)(u.b)),Object(a.c)(14,Object(k.b)(c.serviceName)),Object(a.c)(15,Object(k.b)(I.d)),Object(a.c)(16,Object(k.b)(l.b)),Object(a.c)(17,Object(k.b)(h.b)),Object(a.c)(18,Object(k.b)(S.b)),Object(a.c)(19,Object(k.b)(b.b)),Object(a.c)(20,Object(k.b)(f.b)),Object(a.c)(21,Object(k.b)(C.b)),Object(a.c)(22,Object(k.b)(p.b)),Object(a.c)(23,Object(k.b)(m.e))],B),function(e){e[e.Graded=1]="Graded",e[e.MultiStatus=2]="MultiStatus",e[e.NeedGrade=3]="NeedGrade",e[e.Opened=4]="Opened",e[e.Unopend=5]="Unopend",e[e.Posted=6]="Posted",e[e.Completed=7]="Completed"}(_||(_={}));let z=class{constructor(e,t,n){this.column=e,this.context=t,this.contextUser=n,this.isCommentBoxShown=!1,this.hasBeenViewed=!1,this.id=E.a(),this.hasDueDateException=!1}get numOfPeerReviewsCompleted(){var e,t;return null!==(t=null===(e=this.peerReviewCounts)||void 0===e?void 0:e.completed)&&void 0!==t?t:0}get numOfPeerReviewsCompletedLate(){var e,t;return null!==(t=null===(e=this.peerReviewCounts)||void 0===e?void 0:e.completedLate)&&void 0!==t?t:0}get numOfPeerReviewsStarted(){var e,t;return null!==(t=null===(e=this.peerReviewCounts)||void 0===e?void 0:e.started)&&void 0!==t?t:0}get Column(){return this.column}isCurrentUserReconciler(){return this.column&&this.column.isUserReconciler(this.contextUser.userId)}isDiscussion(){return this.column.isDiscussion()}isOverdue(){return this.column&&this.column.dueDate&&this.column.dueDate.getTime()-this.context.getServerTime().getTime()<0}getLateSubmissionCount(){var e,t;return r.isDefined(this.lateSubmissionCount)||(this.group?this.lateSubmissionCount=null===(e=this.grade)||void 0===e?void 0:e.groupAttempts.getNumAttemptsSubmittedLate(this.dueDate):this.lateSubmissionCount=null===(t=this.grade)||void 0===t?void 0:t.attempts.getNumAttemptsSubmittedLate(this.dueDate)),this.lateSubmissionCount}isStatusComplete(){var e;return this.isDiscussion()||this.grade&&!this.grade.attempts?this.isCompleted():this.checkIfStatusComplete(null===(e=this.grade)||void 0===e?void 0:e.attempts)}isGroupStatusComplete(e){var t;return e?this.isCompleted():this.checkIfStatusComplete(null===(t=this.grade)||void 0===t?void 0:t.groupAttempts)}checkIfStatusComplete(e){if(this.column.anonymousGrading)return!1;if(q(this.column.aggregationModel))return this.isFirstOrLastAttemptWithAGradeAndCompleted();if(H(this.column.aggregationModel))return this.isLastAttemptWithAGradeAndCompleted();const t=this.assessmentException?this.assessmentException.attempts:this.column.multipleAttempts;return!(!this.grade||!e)&&((e.isAllGradedAndPosted()||this.grade.isPosted())&&e.getNumOfGradedAttempts()===t)}shouldShowNothingToGradeStatus(){var e;if((q(this.column.aggregationModel)||H(this.column.aggregationModel))&&!this.column.anonymousGrading){const t=null===(e=this.grade)||void 0===e?void 0:e.attempts;return!(t&&t.length&&t.find((e=>e.isCompleted())))}return!0}isFirstAttemptGradedAndPosted(){var e,t;const n=this.group?null===(e=this.grade)||void 0===e?void 0:e.groupAttempts:null===(t=this.grade)||void 0===t?void 0:t.attempts;return null==n?void 0:n.isFirstAttemptPosted()}isFirstAttemptGradedAndGradeObjectPosted(){var e,t,n,a;const i=this.group?null===(e=this.grade)||void 0===e?void 0:e.groupAttempts:null===(t=this.grade)||void 0===t?void 0:t.attempts;return(null===(n=null==i?void 0:i.getFirstAttempt())||void 0===n?void 0:n.isGraded())&&(null===(a=this.grade)||void 0===a?void 0:a.isPosted())}isLastAttemptGradedAndPosted(){var e,t;const n=this.group?null===(e=this.grade)||void 0===e?void 0:e.groupAttempts:null===(t=this.grade)||void 0===t?void 0:t.attempts;return null==n?void 0:n.isLastSubmittedAttemptPosted()}isLastAttemptGradedAndGradeObjectPosted(){var e,t,n,a;const i=this.group?null===(e=this.grade)||void 0===e?void 0:e.groupAttempts:null===(t=this.grade)||void 0===t?void 0:t.attempts;return(null===(n=null==i?void 0:i.getLastSubmittedAttempt())||void 0===n?void 0:n.isGraded())&&(null===(a=this.grade)||void 0===a?void 0:a.isPosted())}isStatusNothingToGrade(){return this.isDiscussion()?this.hasNoTotalParticipation():this.grade&&!this.grade.attempts.getNumAttemptsToGrade()}isGroupStatusNothingToGrade(){return this.grade&&!this.grade.groupAttempts.getNumAttemptsToGrade()}isFirstAttemptWithAGradeAndCompleted(){return q(this.column.aggregationModel)&&(this.isFirstAttemptGradedAndPosted()||this.isFirstAttemptGradedAndGradeObjectPosted())}isLastAttemptWithAGradeAndCompleted(){return H(this.column.aggregationModel)&&(this.isLastAttemptGradedAndPosted()||this.isLastAttemptGradedAndGradeObjectPosted())}isFirstOrLastAttemptWithAGradeAndCompleted(){return this.isFirstAttemptWithAGradeAndCompleted()||this.isLastAttemptWithAGradeAndCompleted()}isStatusAttemptsToReconcile(){if(!this.isDiscussion()&&this.isCurrentUserReconciler())return!(!this.column.anonymousGrading&&this.isFirstOrLastAttemptWithAGradeAndCompleted())&&(this.grade&&this.grade.attempts.getNumAttemptsToReconcile()>0)}isStatusAttemptsToGrade(e){return this.isDiscussion()?(!this.hasNoParticipation()||this.hasLateParticipation())&&(!this.grade||this.grade&&!this.grade.isGraded()):e?!this.grade||this.grade.attempts.getNumAttemptsToGrade()>=0:this.isCurrentUserReconciler()?void 0:!(!this.column.anonymousGrading&&this.isFirstOrLastAttemptWithAGradeAndCompleted())&&(this.grade&&this.grade.attempts.getNumAttemptsToGrade()>0)}isGroupStatusAttemptsToGrade(e){return e?this.grade&&this.grade.groupAttempts.getNumAttemptsToGrade()>=0:!(!this.column.anonymousGrading&&this.isFirstOrLastAttemptWithAGradeAndCompleted())&&(this.grade&&this.grade.groupAttempts.getNumAttemptsToGrade()>0)}hasGroupUsersForGrading(){var e,t;if(!(null===(t=null===(e=this.group)||void 0===e?void 0:e.memberships)||void 0===t?void 0:t.length))return!1;const n=this.group.memberships.some((e=>{var t,n;return!(null===(n=null===(t=e.ui)||void 0===t?void 0:t.gradeDetail)||void 0===n?void 0:n.isGraded())}));return n}isStatusToPost(){return this.isDiscussion()?this.needsPosting():!this.column.anonymousGrading&&this.grade&&this.grade.isReadyToPost()&&!this.grade.isOverrideGrade()}isGroupStatusToPost(){return this.grade&&this.grade.isReadyToPost()&&!this.grade.isOverrideGrade()}overrideToPost(){return this.grade&&(this.grade.isOverrideGrade()||this.grade.displayGrade&&"MULTIPLE"===this.grade.displayGrade.grade)&&this.grade.isReadyToPost()}isMultipleStatus(){return this.group?this.isGroupStatusAttemptsToGrade()&&(this.isGroupStatusToPost()||this.overrideToPost()&&!this.isGroupStatusComplete()):(this.isStatusAttemptsToGrade()||this.isStatusAttemptsToReconcile())&&(this.isStatusToPost()||this.overrideToPost()&&!this.isStatusComplete())}hasGroupAttempts(){return this.grade&&this.grade.groupAttempts.length&&i.every(this.grade.groupAttempts,(e=>!!e.id))}get RowStatus(){if(this.grade&&this.group){if(this.needsPosting())return 1;if(this.isGroupStatusAttemptsToGrade())return 3;if(this.inProgress()&&!this.grade.hasGradeBeenPosted)return 4;if(!this.grade.groupAttempts[0].status&&!this.grade.hasGradeBeenPosted)return 5;if(this.grade.isPosted()&&!this.isGroupStatusComplete())return 6;if(this.isGroupStatusComplete())return 7}else{if(this.membership&&this.membership.isPreviewStudent)return 0;if(this.grade&&0===this.grade.attempts.getNumAttemptsToGrade()&&this.grade.isReadyToPost())return 1;if(this.grade&&this.grade.isGraded()&&this.grade.attempts.getNumAttemptsToGrade()>0&&this.grade.isReadyToPost())return 2;if(this.grade&&this.grade.attempts.getNumAttemptsToGrade()>0&&0===this.grade.attempts.getNumAttemptsToPost()&&!this.grade.isPosted())return 3;if(this.hasNoSubmissions()&&this.inProgress()&&!this.grade.hasGradeBeenPosted)return 4;if(!this.grade||!this.grade.hasGradeBeenPosted)return 5;if(this.grade&&this.grade.hasGradeBeenPosted&&!this.isStatusComplete())return 6;if(this.isStatusComplete())return 7}return 8}hasNoSubmissions(){return!this.attemptCount||0===this.attemptCount}hasNoParticipation(){return!this.participation||0===this.participation.comment&&0===this.participation.reply}hasNoTotalParticipation(){return!this.participation||0===this.participation.comment&&0===this.participation.reply&&0===this.participation.totalComment&&0===this.participation.totalReply}hasLateParticipation(){return!this.grade.isExempt&&this.participation&&0===this.participation.comment&&0===this.participation.reply&&this.participation.totalComment+this.participation.totalReply!==0}inProgress(){return this.group?this.grade&&this.grade.ui&&this.grade.ui.groupAttempt&&T.l.InProgress===this.grade.ui.groupAttempt.status:this.grade&&this.grade.ui&&this.grade.ui.attempt&&T.l.InProgress===this.grade.ui.attempt.status}isLate(e){if(!this.hasDueDateException){const t=y(this.context.getServerTime()),n=null!=e?e:this.dueDate;return this.hasNoSubmissions()&&t.isAfter(n)||y(this.lastAttemptDate).isAfter(n)}return!1}isSubmittedLate(e){if(!this.hasDueDateException){const t=null!=e?e:this.dueDate;return!this.hasNoSubmissions()&&y(this.lastAttemptDate).isAfter(t)&&!this.inProgress()}return!1}isCompleted(){return!(this.group||!this.grade||!this.grade.isGraded()||!this.grade.isPosted())||!!(this.group&&this.group.memberships&&this.group.memberships.length>0)&&this.group.memberships.every((e=>e.ui&&e.ui.gradeDetail&&e.ui.gradeDetail.isPosted()))}needsPosting(){if(!this.group)return!this.isCompleted()&&this.grade&&this.grade.isReadyToPost();if(this.group&&this.group.memberships){let e=0,t=0;if(this.group.memberships.forEach((n=>{n.ui&&n.ui.gradeDetail&&(n.ui.gradeDetail.isReadyToPost()?t++:n.ui.gradeDetail.isPosted()&&e++)})),t>0&&e+t===this.group.memberships.length)return!0}return!1}needsGrading(){return this.grade.groupAttempts&&this.grade.groupAttempts.length?this.grade.groupAttempts[0].isNeedsGrading()&&!this.grade.groupAttempts[0].isPostable():this.attemptCount>0&&this.grade.isSubmitted()}deleteAllAttempts(){this.grade.attempts.$fetch().$then((e=>{e.forEach((e=>{e.$destroy()})),this.attemptCount=0,this.lastAttemptDate=null}))}getLastAttempt(){var e,t;if(null===(t=null===(e=this.grade)||void 0===e?void 0:e.attempts)||void 0===t?void 0:t.length)return this.grade.attempts[this.grade.attempts.length-1]}getLastGroupAttempt(){var e,t;if(null===(t=null===(e=this.grade)||void 0===e?void 0:e.groupAttempts)||void 0===t?void 0:t.length)return this.grade.groupAttempts[this.grade.groupAttempts.length-1]}};function q(e){return Object(A.parseAttemptAggregationModel)(e)===A.AttemptAggregationModel.First}function H(e){return Object(A.parseAttemptAggregationModel)(e)===A.AttemptAggregationModel.Last}z=Object(a.a)([Object(a.c)(0,Object(k.b)("column")),Object(a.c)(1,Object(k.b)(u.b)),Object(a.c)(2,Object(k.b)(p.b))],z);class V extends B{}r.module(P,["angular-data.DSCacheFactory",v.N,u.a,I.b,S.a,b.a,f.a,C.a]).service(x,B)}).call(this,n("71td"))},oB9e:function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return g}));n("SeO5");var a=n("Llzl"),i=n("IbyE"),r=n("0JpG"),s=n("nYZ0"),o=n("Fvsw"),l=n("jhBu"),c=n("Y3OE"),d=n("X/qj"),u=n("pjml"),m=n("TnpK"),p=n("RPob");const h="ultra.service.blog",g="blogService";class b{constructor(e,t,n,a,i,r,s,o,l,c,d,u){this.bbLocalize=e,this.$rootScope=t,this.$q=n,this.$ngRedux=a,this.$modal=i,this.courseModel=r,this.UserModel=s,this.context=o,this.contentService=l,this.ultraState=c,this.gradebookPermissionService=d,this.entitlementService=u,this.subscribeToRedux()}subscribeToRedux(){this.$ngRedux.connect(null,(e=>({loadBlog:t=>e(i.V.blog.blogs.loadBlog(t)),persistContent:(t,n)=>e(i.V.content.persistContent(t,n)),loadGradebookColumn:(t,n)=>e(i.V.gradebookColumn.loadGradebookColumn({courseId:t,columnId:n.gradeColumnId})),persistGradebookColumn:(t,n)=>e(i.V.gradebookColumn.persistGradebookColumn(t,n)),loadGradebookGrade:(t,n,a,r={})=>e(i.V.gradebookGrade.loadBulkView(t,[n],[a],r))})))(this)}createContent(e){const{courseId:t,parentId:n,positionBefore:a,positionAfter:i,root:r}=e;return this.contentService.makeContentInContentTree(r,t,n,a,i)}updateContent(e,t,n){return e.$patch(n).$then((()=>{this.$rootScope.$broadcast("content-update",e),this.$rootScope.$broadcast("attempt-base-content-update",e,t)})).$asPromise()}fetchContent(e,t){return t.contents.$find(e,{expand:"alignedGoals,assignedGroups"}).$asPromise()}fetchBlog(e,t,n=!1){const a={courseId:e,blogId:t,expandHasEntries:n};return this.$q.resolve(this.loadBlog(a)).then((e=>e.blog))}patchBlogContent(e,t,n,a){const i={id:t,courseId:e,contentDetail:{[c.a.Journal.toString()]:{blog:n}}},r={id:t,courseId:e,contentDetail:{[c.a.Journal.toString()]:{blog:a}}};return this.$q.resolve(this.persistContent(i,r)).then((e=>e.contents))}patchGradebookColumn(e,t){return this.$q.resolve(this.persistGradebookColumn(e,t)).then((e=>e.gradebookColumn))}patchBlogGrading(e,t,n,a,i,r){const s=!n.gradingAllowed&&!a.gradingAllowed,o=n.gradingAllowed&&!a.gradingAllowed,l=!n.gradingAllowed&&a.gradingAllowed,d=n.entryModificationAllowed!==a.entryModificationAllowed,u=n.commentModificationAllowed!==a.commentModificationAllowed;return!s||d||u?o||d||u?this.patchBlogContent(e,t,n,a).then((e=>null)):l?this.patchBlogContent(e,t,n,a).then((n=>{const a=n[t].contentDetail[c.a.Journal.toString()];return r.id=a.blog.gradeColumnId,r.courseId=e,this.patchGradebookColumn({},r)})):this.patchGradebookColumn(i,r):this.$q.resolve(null)}loadBlogGradebookColumn(e,t){return t&&t.gradeColumnId?this.$q.resolve(this.loadGradebookColumn(e,t).then((e=>e.gradebookColumn))):this.$q.resolve(null)}savePrompt(e,t){const n=e.description,a=[{tag:"table",replacementText:this.bbLocalize.translateSync({key:"course.content.tablePlaceholder",locale:this.bbLocalize.getLocale(this.$rootScope)})},{tag:"math",replacementText:this.bbLocalize.translateSync({key:"course.content.mathPlaceholder",locale:this.bbLocalize.getLocale(this.$rootScope)}),replacementTextPlural:this.bbLocalize.translateSync({key:"course.content.mathPlaceholder.plural",locale:this.bbLocalize.getLocale(this.$rootScope)})}],i=Object(p.l)(t,a);return e.description=this.contentService.truncateDescription(i,s.c.MAX_LENGTH_IN_CONTENT_ITEM),e.$patch(["contentDetail"]).$asPromise().then((()=>{this.$rootScope.$broadcast("content-update",e)})).catch((()=>{e.description=n}))}loadBlogGradebookGrade(e,t,n,a={}){return this.$q.resolve(this.loadGradebookGrade(e,t,n,a))}}b.$inject=[r.serviceName,"$rootScope","$q","$ngRedux","$modal",u.m.serviceName,u.Jb.serviceName,o.b,s.f,m.d,d.b,l.b];a.module(h,[u.N,r.moduleName,o.a,s.d,m.b,d.a,l.a,u.N]).service(g,b)},oNH7:function(e,t){e.exports='<div ng-if="conversionStatusBarController.showStatusBar && !conversionStatusBarController.inPreview"\n     class="conversion-status-bar import-learn-bar" ng-class="{\'below\': conversionStatusBarController.hideStatusBar()}"\n     bb-load-bundle="components/directives/conversion-status-bar" role="banner">\n  <div class="conversion-prompt-container">\n    <div class="conversion-prompt-title" bb-translate="course.conversion.statusBar.useUltraPromptTitle" course-org-token-resolver>\n    </div>\n    <div class="conversion-prompt-details" bb-translate="course.conversion.statusBar.useUltraPromptDetails" course-org-token-resolver>\n    </div>\n    <a class="hide-for-medium-only hide-for-small-only"\n        bb-translate="course.conversion.statusBar.moreInfoLink" bb-translate-attrs="{ \'href\': \'course.conversion.statusBar.moreInfoLinkUrl\' }"\n        target="_blank" rel="noopener noreferrer"\n        analytics-id="course.conversion.statusBar.moreInfoLink"></a>\n  </div>\n  <div class="conversion-button-container">\n    <a href="javascript:void(0);" class="js-back-to-classic conversion-button conversion-return-classic show-for-large-up"\n        ng-click="conversionStatusBarController.backToClassic()" component-key="conversionBackToClassic"\n        analytics-id="course.conversion.statusBar.backToClassic">\n      <bb-translate course-org-token-resolver>course.conversion.statusBar.backToClassic</bb-translate>\n    </a>\n    <button class="js-back-to-classic conversion-button conversion-return-button button button--secondary"\n        ng-click="conversionStatusBarController.backToClassic()" component-key="conversionBackToClassic"\n        analytics-id="course.conversion.statusBar.backToClassic.button">\n      <span bb-translate="course.conversion.statusBar.backToClassic" course-org-token-resolver></span>\n    </button>\n    <button class="js-use-new-ux conversion-button button default" ng-click="conversionStatusBarController.useTheNewExperience()"\n            bb-confirmation-needed="resource/x-bb-course-conversion" show-type="always"  confirmation-course-org-token-resolver\n            analytics-id="course.conversion.statusBar.useUltra.button">\n      <span bb-translate="course.conversion.statusBar.useUltra" course-org-token-resolver></span>\n    </button>\n  </div>\n</div>\n'},oPIA:function(e,t,n){"use strict";var a;!function(e){e.Failure="failure",e.Success="success"}(a||(a={}));var i,r;!function(e){e.Auxiliary="auxiliary",e.Primary="primary"}(i||(i={})),function(e){e.Small="small",e.Medium="medium",e.Large="large"}(r||(r={}));const s=new Set(Object.values(r));var o,l,c,d,u;!function(e){e.Modal="Modal",e.ModalHeader="ModalHeader",e.ModalBody="ModalBody",e.ModalFooter="ModalFooter"}(o||(o={})),function(e){e[e.ModalAlreadyOpenError=1]="ModalAlreadyOpenError",e[e.FailedComponentValidationError=2]="FailedComponentValidationError",e[e.InvalidRequestTypeError=3]="InvalidRequestTypeError",e[e.InvalidIdError=4]="InvalidIdError",e[e.MissingContentsError=5]="MissingContentsError",e[e.WrongOwnerError=6]="WrongOwnerError",e[e.ModalNotFoundError=7]="ModalNotFoundError"}(l||(l={})),function(e){e.ModalNew="portal:modal",e.ModalResponse="portal:modal:response",e.ModalClose="portal:modal:close",e.ModalCloseResponse="portal:modal:close:response"}(c||(c={})),function(e){e[e.InvalidSelectorError=1]="InvalidSelectorError",e[e.InvalidTargetError=2]="InvalidTargetError",e[e.NotificationNotFoundError=3]="NotificationNotFoundError",e[e.NoOwnershipError=4]="NoOwnershipError",e[e.FailedComponentValidationError=5]="FailedComponentValidationError"}(d||(d={})),function(e){e.Dark="dark",e.Light="light"}(u||(u={}));const m=new Set(Object.values(u));var p,h;!function(e){e[e.Small=12]="Small",e[e.Medium=20]="Medium",e[e.Large=30]="Large"}(p||(p={})),function(e){e.BottomLeft="bottom:left",e.BottomRight="bottom:right",e.TopLeft="top:left",e.TopRight="top:right"}(h||(h={}));const g=new Set(Object.values(h));var b;!function(e){e.AnalyticsId="notification:analytics:selector",e.Region="notification:region:selector"}(b||(b={}));const f=new Set(Object.values(b));var v,y,S;!function(e){e.Notification="Notification"}(v||(v={})),function(e){e.NotificationNew="portal:notification",e.NotificationResponse="portal:notification:response",e.NotificationStatus="portal:notification:status",e.NotificationClose="portal:notification:close",e.NotificationCloseResponse="portal:notification:close:response"}(y||(y={})),function(e){e.Queued="queued",e.Visible="visible",e.Failed="failed",e.Removed="removed"}(S||(S={}));var C,E,I;!function(e){e.Full="full",e.Small="small"}(C||(C={})),function(e){e.PanelNew="portal:panel",e.PanelResponse="portal:panel:response",e.PanelClose="portal:panel:close",e.PanelCallback="portal:callback"}(E||(E={})),function(e){e.onClose="onClose",e.onBlur="onBlur",e.onScroll="onScroll",e.onClick="onClick"}(I||(I={}));const k=window.location.origin,w=new RegExp(`(^[\\u0000-\\u001F ]*j[\\r\\n\\t]*a[\\r\\n\\t]*v[\\r\\n\\t]*a[\\r\\n\\t]*s[\\r\\n\\t]*c[\\r\\n\\t]*r[\\r\\n\\t]*i[\\r\\n\\t]*p[\\r\\n\\t]*t[\\r\\n\\t]*:)|(^${k})/|(^[\\u0000-\\u001F ]*d[\\r\\n\\t]*a[\\r\\n\\t]*t[\\r\\n\\t]*a[\\r\\n\\t]*:)`,"i"),T=e=>!e||w.test(e)?"":e,O=["role","tabindex","id","aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-dropeffect","aria-errormessage","aria-expanded","aria-flowto","aria-grabbed","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext"];var A;!function(e){e.Small="small",e.Medium="medium",e.Large="large"}(A||(A={}));const P=new Set(Object.values(A));var x;!function(e){e.onFocus="onFocus",e.onBlur="onBlur",e.onClick="onClick"}(x||(x={}));var $;!function(e){e.NewPortal="new",e.RemovedPortal="removed",e.CallbackPortal="callback",e.FailedValidationPortal="failedValidation"}($||($={}));const N=["className","style","dir",...Object.keys(x),...O],D=new Map([["src",T],["href",T]]),L=new Map;["div","span","h1","h2","h3","h4","p","ul","ol","li"].forEach((e=>L.set(e,{attributes:N}))),L.set("button",{attributes:[...N,"disabled"],classNameMappings:new Map(Object.entries({"uef--button":"button button--primary","uef--button--secondary":"button button--secondary"})),classNameDefault:"uef--button--classless"}),L.set("iframe",{attributes:[...N,"src"],transformers:D}),L.set("img",{attributes:[...N,"src","alt","height","width"],transformers:D}),L.set("bdi",{attributes:N}),L.set("bdo",{attributes:N}),L.set("a",{attributes:[...N,"href"],transformers:D});const j=L;var M,G,R;!function(e){e.PortalClose="portal:close"}(M||(M={})),function(e){e[e.Authorization=1]="Authorization",e[e.InvalidContents=2]="InvalidContents"}(G||(G={})),function(e){e.PortalCallback="portal:callback"}(R||(R={}));var B,F;!function(e){e[e.ExistingRegistration=0]="ExistingRegistration",e[e.MissingPlacementHandle=1]="MissingPlacementHandle"}(B||(B={})),function(e){e.Click="click",e.Hover="hover",e.PortalNew="portal:new",e.PortalRemove="portal:remove",e.Route="route",e.RouteChanging="route:changing"}(F||(F={}));var U,_,z;!function(e){e[e.InvalidRouteName=1]="InvalidRouteName",e[e.ExistingRouteName=2]="ExistingRouteName"}(U||(U={})),function(e){e.Link="Link",e.ButtonLink="ButtonLink"}(_||(_={})),function(e){e.LtiLaunch="LtiLaunch",e.SvgIcon="SvgIcon",e.ActionMenu="ActionMenu"}(z||(z={}));var q,H;!function(e){e.Failure="failure",e.Success="success"}(q||(q={})),function(e){e[e.ExistingRegistration=0]="ExistingRegistration"}(H||(H={})),n.d(t,"o",(function(){return"integration:hello"})),n.d(t,"c",(function(){return"authorization:authorize"})),n.d(t,"cb",(function(){return"authorization:unauthorize"})),n.d(t,"p",(function(){return a})),n.d(t,"b",(function(){return"ultra:analytics-event"})),n.d(t,"k",(function(){return"ultra:help"})),n.d(t,"C",(function(){return"ultra:portal"})),n.d(t,"ab",(function(){return"ultra:route-event"})),n.d(t,"D",(function(){return"ultra:modal"})),n.d(t,"E",(function(){return"ultra:notification"})),n.d(t,"a",(function(){return"*"})),n.d(t,"H",(function(){return"bb.premium.uef"})),n.d(t,"l",(function(){return"help:register"})),n.d(t,"m",(function(){return"help:request"})),n.d(t,"n",(function(){return i})),n.d(t,"N",(function(){return r})),n.d(t,"O",(function(){return s})),n.d(t,"r",(function(){return o})),n.d(t,"s",(function(){return l})),n.d(t,"M",(function(){return c})),n.d(t,"v",(function(){return d})),n.d(t,"y",(function(){return u})),n.d(t,"z",(function(){return m})),n.d(t,"w",(function(){return p})),n.d(t,"Q",(function(){return h})),n.d(t,"R",(function(){return g})),n.d(t,"S",(function(){return b})),n.d(t,"T",(function(){return f})),n.d(t,"u",(function(){return v})),n.d(t,"P",(function(){return y})),n.d(t,"x",(function(){return S})),n.d(t,"A",(function(){return"submission-tool:register"})),n.d(t,"B",(function(){return"submission-tool:settings-saved"})),n.d(t,"W",(function(){return C})),n.d(t,"V",(function(){return E})),n.d(t,"U",(function(){return I})),n.d(t,"X",(function(){return A})),n.d(t,"Y",(function(){return P})),n.d(t,"L",(function(){return x})),n.d(t,"G",(function(){return"portal:render"})),n.d(t,"F",(function(){return"portal:render:response"})),n.d(t,"eb",(function(){return $})),n.d(t,"hb",(function(){return N})),n.d(t,"gb",(function(){return j})),n.d(t,"K",(function(){return G})),n.d(t,"f",(function(){return R})),n.d(t,"I",(function(){return"proctoring-service:register"})),n.d(t,"J",(function(){return"proctoring-service:settings-saved"})),n.d(t,"Z",(function(){return B})),n.d(t,"fb",(function(){return F})),n.d(t,"bb",(function(){return"event:subscribe"})),n.d(t,"db",(function(){return"event:unsubscribe"})),n.d(t,"i",(function(){return"event:event"})),n.d(t,"d",(function(){return"basenav:register"})),n.d(t,"t",(function(){return U})),n.d(t,"q",(function(){return _})),n.d(t,"j",(function(){return z})),n.d(t,"e",(function(){return"course:detail:register"})),n.d(t,"h",(function(){return q})),n.d(t,"g",(function(){return H}))},oQrK:function(e,t,n){"use strict";t.a=class{static detect(){const e={},t=window.navigator.userAgent.toLowerCase(),n=function(e){return-1!==t.indexOf(e)};return e.ios=function(){return e.iphone()||e.ipod()||e.ipad()},e.iphone=function(){return!e.windows()&&n("iphone")},e.ipod=function(){return n("ipod")},e.ipad=function(){return n("ipad")},e.android=function(){return!e.windows()&&n("android")},e.androidPhone=function(){return e.android()&&n("mobile")},e.androidTablet=function(){return e.android()&&!n("mobile")},e.blackberry=function(){return n("blackberry")||n("bb10")||n("rim")},e.blackberryPhone=function(){return e.blackberry()&&!n("tablet")},e.blackberryTablet=function(){return e.blackberry()&&n("tablet")},e.windows=function(){return n("windows")},e.windowsPhone=function(){return e.windows()&&n("phone")},e.windowsTablet=function(){return e.windows()&&n("touch")&&!e.windowsPhone()},e.fxos=function(){return(n("(mobile;")||n("(tablet;"))&&n("; rv:")},e.fxosPhone=function(){return e.fxos()&&n("mobile")},e.fxosTablet=function(){return e.fxos()&&n("tablet")},e.meego=function(){return n("meego")},e.mobile=function(){return e.androidPhone()||e.iphone()||e.ipod()||e.windowsPhone()||e.blackberryPhone()||e.fxosPhone()||e.meego()},e.tablet=function(){return e.ipad()||e.androidTablet()||e.blackberryTablet()||e.windowsTablet()||e.fxosTablet()},e.desktop=function(){return!e.tablet()&&!e.mobile()},e.portrait=function(){return window.innerHeight/window.innerWidth>1},e.landscape=function(){return window.innerHeight/window.innerWidth<1},e}}},oVrE:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return o}));const a="anonymousId";function i(){return a}function r(e,t){const n=t.translateSync({locale:t.getLocale(e),key:"components.directives.avatar.anonymous",noWrap:!0,noEscape:!0});return{id:i(),givenName:n,familyName:"",userName:void 0}}function s(e){return(null==e?void 0:e.id)===a}function o(e){var t;const n=null==e?void 0:e.givenName,a=null==e?void 0:e.familyName;return e&&(a||n)?{avatarUrl:null===(t=e.avatar)||void 0===t?void 0:t.permanentUrl,givenName:n,familyName:a,otherName:e.otherName,preferredDisplayName:e.preferredDisplayName,pronouns:e.pronouns,pronunciation:e.pronunciation,pronunciationAudio:e.pronunciationAudio}:null}},ofgY:function(e,t){e.exports='<div class="file-upload-container">\n  <div ngf-drop\n       id="{{fileUploadDivId}}"\n       ng-model="files" class="file-upload"\n       ngf-multiple="fileUpload.allowMultiple"\n       ngf-drop-disabled="disableDrag && disableDrag()"\n       ngf-change="fileUpload.onFileSelect($files, $file, $newFiles, $duplicateFiles, $invalidFiles, $event)"\n       ngf-stop-propagation="!(disableDrag && disableDrag())"\n       ngf-drag-over-class="dragClass"\n       tabindex="-1">\n    <div class="fileUploadTransclude" ng-transclude ng-show="fileUpload.transcludeVisible"></div>\n    <div class="js-file-upload-complete" ng-attr-ready="{{!fileUpload.uploadInProgress}}"></div>\n    <div ng-show="fileUpload.fileReviewVisible" class="file-upload-review">\n      <section class="file-upload-panel" ng-if="fileUpload.progressVisible">\n        <bb-progress primary-key="primaryKey && primaryKey()" display-results="fileUpload.useDefaultSuccessMethod"></bb-progress>\n      </section>\n    </div>\n  </div>\n  <input ngf-select\n         ng-if="fileUpload.allowMultiple"\n         type="file"\n         ngf-change="fileUpload.onFileSelect($files)"\n         multiple class="hide fileUploadInput"\n         analytics-id="components.directives.fileUpload.multipleFiles.input.file"/>\n  <input ngf-select\n         ng-if="!fileUpload.allowMultiple"\n         type="file"\n         ngf-change="fileUpload.onFileSelect($files)"\n         class="hide fileUploadInput"\n         analytics-id="components.directives.fileUpload.input.file"/>\n</div>'},ohO4:function(e,t,n){"use strict";var a=n("D57K"),i=n("aHpC"),r=n("IbyE");class s{constructor(e,t,n,a){this.flagKey=e,this.scope=a,this.$q=n,this.service=t}wait(){if(!this.defered){const e=this.service.isFeatureEnabledStrict(this.flagKey);if(void 0!==e)return this.$q.resolve(e);this.deregister=this.scope.$on("feature-flag-values-updated",this.featureFlagsUpdated.bind(this)),this.service.loadFeatureFlagValue(this.flagKey),this.defered=this.$q.defer()}return this.defered.promise}featureFlagsUpdated(){var e,t;const n=this.service.isFeatureEnabledStrict(this.flagKey);void 0!==n&&(null===(e=this.deregister)||void 0===e||e.call(this),this.deregister=void 0,null===(t=this.defered)||void 0===t||t.resolve(n))}}n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return l}));const o="ultra.service.feature.flags",l="featureFlags";let c=class{constructor(e,t,n){this.$rootScope=e,this.$q=t,this.$ngRedux=n,this.subscribeToRedux();const a=e.$watch((()=>this.flagValues),(e=>this.$rootScope.$broadcast("feature-flag-values-updated",e)));this.$rootScope.$on("$destroy",(()=>a()))}subscribeToRedux(){const e=this.$ngRedux.connect((e=>({flagValues:r.Yb.featureFlags.getFeatureFlagValues(e)})),(e=>({loadFeatureFlagValueByKey:t=>e(r.V.featureFlags.loadFeatureFlagValueByKey({flagKey:t}))})))(this);this.$rootScope.$on("$destroy",e)}loadFeatureFlagValue(e){return this.loadFeatureFlagValueByKey(e)}isFeatureEnabled(e){var t;return(null===(t=this.flagValues)||void 0===t?void 0:t[e])?this.isFlagValueTrue(this.flagValues[e].flagValue):(this.loadFeatureFlagValue(e),!1)}isFeatureEnabledStrict(e){var t;if(null===(t=this.flagValues)||void 0===t?void 0:t[e])return this.isFlagValueTrueStrict(this.flagValues[e]);this.loadFeatureFlagValue(e)}isFlagValueTrue(e){return"true"===e}isFlagValueTrueStrict(e){if(e&&(void 0!==e.flagValue||!e.isLoading))return this.isFlagValueTrue(e.flagValue)}createWaiter(e){return new s(e,this,this.$q,this.$rootScope).wait()}};c=Object(a.a)([Object(a.c)(0,Object(i.b)("$rootScope")),Object(a.c)(1,Object(i.b)("$q")),Object(a.c)(2,Object(i.b)("$ngRedux"))],c);angular.module(o,[]).service(l,c)},oi1r:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d}));var a=n("nsO7"),i=n("Llzl"),r=n("0JpG"),s=n("Bu0u"),o=n("pjml"),l=n("zGdY");const c="ultra.components.services.grade.gradeSchema.Service",d="gradeSchemaService";class u{constructor(e,t,n,a){this.$q=e,this.CourseModel=n,this.bbLocalize=a,this.gbSchemasCache=t.createCache("gbSchemas")}loadSchemas(e,t,n){e instanceof this.CourseModel||(e=this.CourseModel.$new(e));const i=e.$pk||e.id;if(!i)throw new s.a({message:"A primary key or id must be set on the course model"});let r=null;const o=this.gbSchemasCache.get(i);if(o)r=this.$q.when(o.promise);else{const t=e.gradebook.schemas.$fetch().$asPromise(),s=this.bbLocalize.loadBundle("components/services/grade"),o=this.$q.defer();this.$q.all({gradeSchemas:t,bundle:s}).then((e=>{const t=a.filter(e.gradeSchemas,(e=>!(e.scaleType===l.Ub.Text)||n));t.forEach((e=>{if(e.localizableTitle){const t=e.localizableTitle.languageKey.replace(/[\W_]+/g,"_").toLowerCase();e.ui.displayTitleKey="components.services.grade.schema."+t}else e.ui.displayTitle=e.title})),o.resolve(t)})),this.gbSchemasCache.put(i,{promise:o.promise}),r=o.promise}return r.then((e=>t&&t.length?e.filter((e=>t.some((t=>t===e.scaleType)))):e))}loadSchemaForColumn(e){return this.loadSchemas(e.courseId).then((t=>a.find(t,(t=>t.id===e.gradingSchemaId))))}loadGradeSchema(e){const t=e.courseId;if(t){let n;const i=this.gbSchemasCache.get(t);return n=i?this.$q.when(i.promise):this.loadSchemas(t,[],!0),this.$q.when(n).then((t=>a.find(t,(t=>t.id===e.gradingSchemaId))))}throw new s.a({message:"Valid grade column object not provided."})}}u.$inject=["$q","DSCacheFactory",o.m.serviceName,r.serviceName];i.module(c,["angular-data.DSCacheFactory"]).service(d,u)},okL3:function(e,t){e.exports='<div>\n  <div class="upload-list">\n    <div ng-repeat="file in inProgressFiles" ng-attr-id="{{::progress.getProgressIdAttr(file)}}" bb-translate-attrs="{\'aria-label\':\'components.directives.fileUpload.document\'}" class="file-container file-container-progress">\n      <div class="file-meta-container">\n        <div class="file-meta">\n          <ng-switch on="file.currentMimeType">\n            <bb-ui-icon-large-zip ng-switch-when="application/zip" color="primary" class-name="element-image"></bb-ui-icon-large-zip>\n          </ng-switch>\n          <div ng-hide="file.isProcessing" class="progress-circle">\n            <svg class="progress-circle-svg" viewBox="-10 -10 220 220">\n              <path class="back" ng-attr-d="{{\'M0,100 a100,100 0 1 0 200,0 a100,100 0 1 0 -200,0\'}}" fill="transparent" />\n              <path class="bar" ng-attr-d="{{\'m100,0a100,100 0 0 1 0,200a100,100 0 0 1 0,-200\'}}" fill="transparent" stroke-dasharray="629" stroke-dashoffset="629"/>\n            </svg>\n            <i class="progress-icon file-error-icon icon-exclamation" ng-if="state === \'error\'"></i>\n            <span class="progress-value" bb-translate translate-values="{percentage: file.currentProgress}">global.percent</span>\n          </div>\n          <span ng-show="file.isProcessing" class="processing-spinner">\n            <div class="canvas success-state"></div>\n          </span>\n          <p class="progress-status">\n            <span class="ellipse" bb-translate="components.directives.fileUpload.uploadingFile" translate-values="{fileName: file.fileName}"></span>\n          </p>\n        </div>\n        <div class="content-item-controls file-container-controls">\n          <button ng-hide="file.isProcessing"\n                  class="button super-clear js-cancel-upload"\n                  bb-translate-attrs="{\'aria-label\':\'components.directives.fileUpload.cancelUploadText\'}"\n                  ng-click="progress.cancelUpload($event, file.id, file.identifier)"\n                  analytics-id="components.directives.fileUpload.cancelUploadText.button">\n            <bb-svg-icon size="small" icon="close"></bb-svg-icon>\n          </button>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n'},"p2I/":function(e,t){e.exports='<svg fill="none" style="overflow:visible;width:100%" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#a)"><path d="M284.4 173.1c-8.3 2.9-12.3 12.2-8.8 20.3l46.1 103.2s11.1 23.7 27.4 15.7c16.6-8 4.6-30.1 4.6-30.1l-51-102.2c-3.6-6.5-11.3-9.4-18.3-6.9Z" fill="#D7B08F"/><path d="m305.7 189.7 20 108.8s3.9 16.6 18.4 14.7c19.5-2.4 16.3-21.2 16.3-21.2l-27.6-105-27.1 2.7Z" fill="#D7B08F"/><path d="m306.4 130.4-7.7 20.9c-2.1 5.8-2.2 12.2-.1 18.1l7.1 20.3 15.8 15.3 11.3-18-7-24 11.1-26.8c1.3-3.1 1.3-6.6.1-9.7l-2-5.1c-2.3-5.7-7.9-9.3-14.1-9-6.6.4-12 5.1-13.3 11.6l-1.2 6.4Z" fill="#D7B08F"/><path d="m329.7 282.1-30-109.5s-3.7-12.2-1-21.4m32.7-18-13.3 19.9s-5.6 5.3-1.9 14.8" stroke="#000" stroke-width="2" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/><path d="M264.9 183.5c-18.2-7.4-38.8-6.6-56.4 2.3-1.6.8-3.2 1.6-4.7 2.4-9.8 5-9.2 23.5-10.2 34.4-5 54.7-19.6 174.9-19.6 174.9s-5.763 42.515 66.5 47c72.5 4.5 65.5-37 65.5-37l-10-58.9 17-64.2s8.2-17.7 5.2-29.2L301 206.4c-2.1-6.1-6.8-11-12.8-13.4l-23.3-9.5Z" fill="#F0E7D9"/><path d="M308.6 227.9c.6 1.7 11.3 32.3 11.3 32.3l-30.1 112.2m-25.7-164.8c.6 1.7 14.3 65 14.3 65l-24.2 125.7" stroke="#000" stroke-width="2" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/><path d="m269.227 143-1.498 53.5s-2.097 3.6-4.395 8.5c-1.098-5.7-25.168-17.7-25.168-17.7l.499-57.7c-.099 0 18.078 11.5 30.562 13.4Z" fill="#D7B08F"/><path d="M238.066 187.3s27.466 11.2 26.866 24.8c0 0-2.496-11.9 2.697-15.6" fill="#D7B08F"/><path d="M238.066 187.3s27.466 11.2 26.866 24.8c0 0-2.496-11.9 2.697-15.6" stroke="#000" stroke-width="2" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/><path d="M243.459 72.9c22.273-12.6 56.03 2.1 51.835 42 4.395 22.9-11.785 53.9-19.475 55.3-10.487 1.8-25.568-6-32.36-16.5-3.395-5.3-6.491-24-6.491-24s-17.978-42.9 6.491-56.8Z" fill="#D7B08F"/><path d="M290.964 109.977c-.646-.8-1.568-1.387-2.536-1.44-.968-.053-1.982.48-2.397 1.44m-15.35 0c-.645-.8-1.567-1.387-2.535-1.44-.968-.053-1.982.48-2.397 1.44" stroke="#000" stroke-width="2" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/><path d="M288.889 123.844c-1.145 0-2.074-1.529-2.074-3.414 0-1.885.929-3.413 2.074-3.413 1.146 0 2.075 1.528 2.075 3.413 0 1.885-.929 3.414-2.075 3.414Zm-21.204 0c-1.146 0-2.074-1.529-2.074-3.414 0-1.885.928-3.413 2.074-3.413s2.074 1.528 2.074 3.413c0 1.885-.928 3.414-2.074 3.414Z" fill="#000"/><path d="M280.499 121c.162.318 7.068 15.736 4.793 16.531-2.193.795-4.712-3.815-4.712-3.815m4.281 9.858s-2.338 3.959-10.813 0" stroke="#000" stroke-width="2" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/><path d="M234.271 114c-4.195.5-13.283 6-1.998 17.7 11.286 11.7 15.181-4.3 12.884-10.1-2.297-5.8-7.69-7.9-10.886-7.6Z" fill="#D7B08F"/><path d="M243.559 158.5c15.181 12 30.262 11.1 30.262 11.1m-43.246-48.4s5.094-3.4 4.395 8.1c0 0-2.097-4.6-2.497-3.1" stroke="#000" stroke-width="2" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/><path d="M296.692 147.7c9.189-21.6 24.57-73.1-18.077-75.2 0 0 7.691-8.4 4.195-19.1-3.496-10.7-28.964-7.2-31.76 4.7-2.697 11.9-2.098 12.3-2.098 12.3s-19.675 5.6-27.365 26.9c-6.792 18.9-11.186 44.7-4.994 60.3 6.192 15.6 3.196 18.4 3.196 18.4 47.64 18.4 25.568-27.7 18.876-40.1-1.797-.3-3.895-1.5-6.492-4.1-11.285-11.7-2.197-17.3 1.998-17.7 1.598-.2 3.695.3 5.693 1.5 13.283-13 25.767-35.3 25.767-35.3s4.195 21.8 29.264 21.4c0 0 1.098 6.8.299 13.4.799 28.6-11.585 51.6-18.177 54.8.1 5 3.096 15.5 26.866 5.8.1-.2-16.279-6.4-7.191-28Z" fill="#84CCAA"/><path d="M235.969 136.8s31.46 48.1-3.496 43.6m69.313-46.8s-18.776 30.4 2.197 41.9M267.429 74.6s-3.795 36.3 43.945 22" stroke="#000" stroke-width="2" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/><path d="M303.085 92.9s5.593-23.3-19.875-20.7c-25.468 2.6-32.659 4.3-32.859-10" stroke="#000" stroke-width="2" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/><path d="M257.042 64.6s-8.988-9.6 0-15.2c8.989-5.6 33.858 2.6 27.765 12.8-6.092 10.3-23.27-3.8-23.27-3.8m-44.644 62.3s-11.286-9.3 1.797-14.5c13.084-5.2 38.153-9.2 45.144-25.7" stroke="#000" stroke-width="2" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/><path d="m297 112.7 37.6-4.5c8.9-1.4 16.8 5.8 16.1 14.8-.5 7.4-6.8 13.1-14.3 12.9-9.1-.3-30.9-1.2-38.2-1.4-3.6-.1-6.3-3.2-6-6.8l-.5-9.3c.4-2.9 2.5-5.3 5.3-5.7Z" fill="#524CA0"/><path d="M338.8 133.2c5.965 0 10.8-5.194 10.8-11.6 0-6.407-4.835-11.6-10.8-11.6-5.965 0-10.8 5.193-10.8 11.6 0 6.406 4.835 11.6 10.8 11.6Z" fill="#F0F0F0"/><path d="m263.2 114.7 37.6-4.5c8.9-1.4 16.8 5.8 16.1 14.8-.5 7.4-6.8 13.1-14.3 12.9-9.1-.3-30.9-1.2-38.2-1.4-3.6-.1-6.3-3.2-6-6.8l-.4-9.4c.2-2.9 2.4-5.2 5.2-5.6Z" fill="#524CA0"/><path d="M305 135.2c5.965 0 10.8-5.194 10.8-11.6 0-6.407-4.835-11.6-10.8-11.6-5.965 0-10.8 5.193-10.8 11.6 0 6.406 4.835 11.6 10.8 11.6Z" fill="#F0F0F0"/><path d="M202 188.9c-6.9 5.4-7.7 15.5-1.9 22l103.6 116.7s18.1 18.9 31 6.2c13.1-12.9-5.2-30-5.2-30l-108-114.2c-5.4-4.9-13.7-5.2-19.5-.7Z" fill="#D7B08F"/><path d="m263.9 176.4 42.6 147.3s4.8 16.3 19.1 13.8c19.3-3.5 15.2-22 15.2-22l-50-143.1-26.9 4Z" fill="#D7B08F"/><path d="M297.4 138.1c-.6-.8-1.5-1.4-2.4-1.7 1.1-1.6 1.2-3.8 0-5.4-.8-1-1.9-1.7-3.1-1.8.6-1.4.5-3.1-.5-4.5-1.3-1.7-3.6-2.4-5.6-1.5l-.3.1c.2-1.2-.1-2.4-.8-3.4-1.3-1.7-3.6-2.4-5.6-1.5l-1.7.8c-10.8 5.7-17.3 20.4-18.1 23.5-1 3.7 4.7 33.7 4.7 33.7l18 16.6 9-19.4-2.9-16.1 9.6-14.1-.1-.1c1-1.5 1-3.6-.2-5.2Zm-10.1-7.2-.1.1-.1-.2.2.1Z" fill="#D7B08F"/><path d="m291.8 287.2 4.7 2.2-31.6-105.9c-5.4-18.8-5.4-32.5-5.4-32.5m31.5 2.2-2.9 4.3 2.9 16.1" stroke="#000" stroke-width="2" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/><g clip-path="url(#b)"><path d="M231.5 373.3c11.8-10.1 21.4-22.7 28.1-36.6 4.1-8.6 7.1-17.8 11.7-26.2 18.5-33.7 58.6-48.7 85-76.6 20.2-21.3 31.9-50.5 32.1-79.9 14.8 25.3 19.8 55.1 32.4 81.6 7.2 15.1 17.1 30.1 16.4 46.7-.3 7.3-2.7 14.4-5.4 21.2-5.9 15.2-13.3 29.8-22.1 43.6-10.4 16.4-22.7 31.6-30.8 49.3-5.1 11.1-8.5 23.3-16.1 32.8-2.9 3.7-6.6 6.9-11.1 8.3-7.6 2.3-15.6-1.2-22.7-4.6-24.3-11.7-48.6-23.3-72.9-35-10.5-5-22-11.2-25.6-22.3" fill="#087F5E"/><path d="M208 442.8c1.9.7 3.2 2.6 3.3 4.6-51.7-27.3-86.1-80.5-102.4-136.7-2.3-7.9-4.3-15.9-5.1-24.1-2-21.6 4.5-43 8.3-64.4 3.8-21.4 4.7-45-7.3-63.2 17.3 9 28.4 26.4 43.3 39.1 14.6 12.5 32.7 20 49.6 29.2 23.5 12.8 46 29.7 58.1 53.6 8.4 16.6 11.3 35.4 13.3 53.9a698 698 0 0 1 4.2 79.2c0 1.2 0 2.4-.7 3.4-1 1.5-2.9 1.8-4.7 2.1-23 3.3-45.4 10.9-65.6 22.3" fill="#009A8F"/><path d="M218.2 440.3c18.2-30 31.5-64.2 58.2-86.9 21.1-17.9 48.8-26.8 76.5-28.4 10.6-.6 21.3-.2 31.9-1.3 34.1-3.6 66.9-25.2 79.2-57.2l7.2 23.7c7 22.9 14.1 46.2 13.8 70.1-.2 23.9-9 49-28.2 63.3-16 11.9-36.7 14.8-55.7 20.8-22.8 7.2-44.2 19.5-60.1 37.4-2.3 2.6-4.6 5.4-7.9 6.4-2.6.8-5.4.4-8 0-41.1-6.8-80.5-23.3-114-48" fill="#009A8F"/><path d="M277.7 454.2c-8.1 9.5-31.9 14-33.2 13.8-27.5-4.6-50.2-23.6-69.6-43.7-19.3-20.1-37.3-42.3-61.2-56.5-18.9-11.2-40.6-16.9-60.5-26.2-8.7-4.1-17.4-9.1-23.2-16.8-4-5.3-6.5-11.5-9-17.7-5.3-13.5-10.7-26.9-16-40.4 13.2.3 24.7 8.5 36.4 14.8 36.4 19.4 79.5 20 119.6 29.6 12.2 2.9 24.3 6.8 34.7 13.7 9.2 6.1 16.7 14.5 23.6 23 22.7 27.9 40.9 59.5 53.7 93l4.7 13.4Z" fill="#087F5E"/><path d="M393.1 174.4c-8.4 24.3-1.4 51.2-5.4 76.6-1 6.2-2.7 12.5-6.3 17.7-5.3 7.7-14.1 12.1-22.4 16.3" stroke="#087F5E" stroke-width="2" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/><path d="M132.5 199.9c1.8 9.2 5 18 8.9 26.5 4.6 10.1 10 19.7 16.3 28.8 9.9 14.5 21.8 27.5 32.5 41.4 10.7 13.9 20.5 29 25.3 45.9m-44.8-88.1c1.5-9.2 2.9-18.3 4.4-27.5m-58.2 23.5c11.1 3.4 22.2 6.8 33.3 10.1" stroke="#009A8F" stroke-width="2" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/><path d="M276.6 416.8c6.3-3.5 12.6-6.9 18.9-10.3 4.8-2.6 9.6-5.1 14.8-6.7 4.9-1.5 10-2 15.1-2.6 27.5-3.2 55.1-6.9 81.5-15.4 6.5-2.1 12.8-4.4 18.8-7.6 11.5-6 21.3-14.7 30.7-23.6 3.9-3.7 8.1-7.9 8.6-13.3" stroke="#087F5E" stroke-width="2" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/><path d="M428.5 333.3c-3 9.8-5.1 20-6.1 30.2M376 342.3c-1.7 9.5-2.7 19.1-2.9 28.8m-60.2-16.2c1.2 9.3 4 18.4 8.3 26.7m25.3 31.3c15.7 7.1 31.3 14.2 47 21.3m-3.2-35.8c15.9 7 31.7 14.1 47.6 21.1m-6.6-35.7c13.4 3.7 26.5 8.3 39.3 13.8m-223.3 29.5c-6.8-5.1-10.6-13.2-15.6-20.1-6.3-8.8-14.8-15.9-23.1-22.9-16.2-13.5-32.5-27.1-51.4-36.4-23.7-11.7-50.2-16.1-74.5-26.5-5.4-2.3-11-5.2-13.9-10.3" stroke="#087F5E" stroke-width="2" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/><path d="M271.5 435.1c-13.6-25.2-28.9-49.5-45.7-72.7-7.1-9.8-14.6-19.5-23.7-27.5-23.2-20.3-54.7-27.8-85.2-32m131.9 78.7c4.4-8.3 27.3-34.3 55.7-48.8 27.9-14.3 49.7-9.2 68-11.5 21-2.6 44.6-6.8 62.4-18.3m-163.7 48c0-15.1-1.5-62.3-25.3-84.5m25.3 44c9-21.2 37.3-43.7 37.3-43.7" stroke="#000" stroke-width="2" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/></g></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h500v500H0z"/></clipPath><clipPath id="b"><path fill="#fff" transform="translate(5 81)" d="M0 0h480v480H0z"/></clipPath></defs></svg>'},p7NW:function(e,t,n){"use strict";n.d(t,"f",(function(){return I})),n.d(t,"g",(function(){return k})),n.d(t,"e",(function(){return w})),n.d(t,"c",(function(){return T})),n.d(t,"b",(function(){return O})),n.d(t,"d",(function(){return A})),n.d(t,"a",(function(){return P}));var a=n("D57K"),i=n("nsO7"),r=n("Llzl"),s=n("0JpG"),o=n("Fvsw"),l=n("Qbdf"),c=n("X455"),d=n("fYJU"),u=n("bMxM"),m=n("o5Lu"),p=n("pjml"),h=n("TnpK"),g=n("jhBu"),b=n("rEZX"),f=n("+O05"),v=n("ZQFV"),y=n("aHpC"),S=n("e6jQ"),C=n("zGdY"),E=n("nkTj");const I="ultra.services.rubric",k="rubric",w="rubric-eval-save",T="remove-peek-override",O="remove-inline-override",A="rubric-grade-update",P=255,x=[{max:100,min:85},{max:84,min:75},{max:74,min:60},{max:60,min:0}];let $=class e{constructor(e,t,n,a,i,r,s,o,l,c,d,u,m){this.$rootScope=e,this.$q=t,this.context=n,this.bbLocalize=a,this.CourseModel=i,this.RubricModel=r,this.grade=s,this.currentCourse=o,this.membership=l,this.ultraState=c,this.contextUser=d,this.entitlement=u,this.contentIcon=m,this.getPercentileColor=e=>this.grade.getPercentileColor(e),this.bbLocalize.loadBundle("components/services/rubric"),this.updateIsStudentView()}loadRubricEvaluationData(){this.updateIsStudentView();const e=this.getParamsFromUrl();if(!e)return this.$q.resolve(void 0);const t=this.currentCourse.course.contents.$find(e.contentId,{expand:"assignedGroups"}).$asPromise(),n=this.currentCourse.course.gradebook.columns.$find(e.columnId,{expand:"associatedRubrics"}).$asPromise();return this.$q.all([t,n]).then((([t,n])=>(this.isGroupContent=!!e.groupIdParam,this.content=t,this.isExternalSubmission=f.a.isExternalSubmissionsAssessment(t),this.gradingColumn=n,this.currentUserId=this.isStudentView?this.contextUser.userId:e.userId,this.rubricAssociation=this.gradingColumn.getRubricAssociation(),this.gradebookSettings=this.grade.loadDefaultGradebookSettings(),this.course=this.currentCourse.course,this.$q.all([this.loadRowException(),this.gradingColumn.hasRubricAssociation()?this.loadRubricData():[]]))))}loadRowException(){if(!this.gradingColumn.isDiscussion()&&!this.gradingColumn.isJournal()&&!this.isStudentView){let e,t;return this.isGroupContent?(t=this.ultraState.params.groupId,e=C.d.Group):(t=this.ultraState.params.userId,e=C.d.User),this.$q.when(f.a.getSubmissionRowException(this.course,this.content,e,t)).then((e=>{this.exceptionAttempts=!!e.attempts}))}}loadRubricViewData(){this.updateIsStudentView();const e=this.getParamsFromUrl();if(!e)return this.$q.resolve(void 0);const t=this.currentCourse.course.contents.$find(e.contentId).$asPromise(),n=this.currentCourse.course.gradebook.columns.$find(e.columnId,{expand:"associatedRubrics"}).$asPromise();return this.$q.all([t,n]).then((([e,t])=>{this.content=e,this.gradingColumn=t}))}getParamsFromUrl(){const{userId:e,columnId:t,assignmentId:n,groupId:a,disGroupId:i}=this.ultraState.params,r=!a&&(e||this.isStudentView);let{contentId:s}=this.ultraState.params;if(s=s||n,r&&t&&s)return{userId:e,columnId:t,contentId:s};if(!r&&(a||i)&&s){return{groupIdParam:a||i,contentId:s,columnId:t}}return null}shouldRenderRubricEvaluation(){if(!this.isStudentView)return!0;if(this.gradingColumn&&this.gradingColumn.hasRubricAssociation()){return this.gradingColumn.getRubricAssociation().isWithEvaluations&&(this.attempt&&this.attempt.isCompleted()||this.gradingColumn.isDiscussion()||this.gradingColumn.isJournal())}return!1}loadRubricData(){if(this.currentUserId&&(!this.isGroupContent||this.isStudentView)){if(this.group=null,this.gradingColumn.anonymousGrading){if(!this.shouldRenderRubricEvaluation())return;return this.grade.loadAnonymousStudentGrade(this.gradingColumn,this.currentUserId).then((e=>this.loadGradeData([e])))}return this.gradingColumn.grades.$refresh({userId:this.currentUserId}).$asPromise().then((e=>this.loadGradeData(e)))}if(this.isGroupContent)return this.course.contents.$find(this.gradingColumn.contentId,{expand:"assignedGroups"}).$asPromise().then((e=>this.course.memberships.$fetch({expand:"user",roleBucket:"taking"}).$asPromise().then((t=>this.grade.loadGroupRows(this.course,e.assignedGroups,t,this.gradingColumn,e.isSafeAssignEnabled()).then((e=>{var t;if(this.groupSubmission=i.find(e,(e=>"grade"in e&&e.attemptCount>0&&(e.group.id===this.ultraState.params.groupId||e.group.id===this.ultraState.params.disGroupId))),this.groupSubmission){this.group=this.groupSubmission.group,this.gradeDetail=this.groupSubmission.grade,this.isGradingInProgress=C.Bb.GradingInProgress===this.gradeDetail.manualStatus;const e=this.gradeDetail.groupAttempts.getAttemptById(null===(t=this.ultraState.params)||void 0===t?void 0:t.attemptId);if(e)return this.loadAttemptData(e)}}))))))}loadGradeData(e){if(e.length<=0&&(null!=this.ultraState.params.gradeId||e[0].id!==this.ultraState.params.gradeId))return;this.gradeDetail=e[0],this.isGradingInProgress=C.Bb.GradingInProgress===this.gradeDetail.manualStatus,this.gradeDetail.column=this.gradingColumn;const t=this.ultraState.params.attemptId&&!this.isGroupContent?{attemptId:this.ultraState.params.attemptId}:{expand:"attempts"};return this.grade.loadAttempt(this.gradeDetail,this.course,t,this.content).then((e=>{const t=e.ui.groupAttempt||e.ui.attempt;if(t)return this.loadAttemptData(t)}))}loadAttemptData(e){this.attempt=e,this.attempt.rubricEvaluation&&this.attempt.rubricEvaluation.rubricAssociationId===this.rubricAssociation.id||(this.attempt.rubricEvaluation=this.createRubricEvaluation(this.rubricAssociation.id,this.gradeDetail.userId,this.gradingColumn.possible)),this.rubricEvaluation={...this.attempt.rubricEvaluation,maxScore:this.gradeDetail.pointsPossible}}getBaseRubricEvaluationPayload(){return{maxScore:this.rubricEvaluation.maxScore,isEditable:this.isEditable(),isStudent:this.isStudentView,isOverrideAvailable:this.isOverrideAvailable(),grade:this.getGrade(),shouldUpdateCriterionFeedback:!1,isMultipleAttempts:this.isMultipleAttempts(),isGroupGradeMultiple:this.gradeDetail.ui.isGroupGradeMultiple,isGradingInProgress:this.isGradingInProgress,isExternalSubmission:this.isExternalSubmission,isGradeOverridden:this.isGradeOverridden(),isAnonymousGrading:this.gradingColumn.anonymousGrading,criteria:this.getCriteriaPayload(this.gradingColumn,this.rubricEvaluation),getGradingPillColor:this.getPercentileColor,contentIconName:this.getIconName(),smallTitle:this.content.title,shouldUndoOverride:!1,shouldEmptyRubric:!1,okConfirmationClicked:!1,isSavingRubric:!1,decimalsLength:m.e.DEFAULT_GRADEBOOK_SETTINGS_AFTER_DECIMAL,rubricType:this.gradingColumn.getAssociatedRubric().rubricType}}getBaseRubricViewPayload(){return{maxScore:this.gradingColumn.possible,criteria:this.getCriteriaPayload(this.gradingColumn),contentIconName:this.getIconName(),smallTitle:this.content.title,decimalsLength:m.e.DEFAULT_GRADEBOOK_SETTINGS_AFTER_DECIMAL,rubricType:this.gradingColumn.getAssociatedRubric().rubricType}}getIconName(){const e=this.contentIcon.getColumnIconClassAsString(this.gradingColumn);return this.contentIcon.getIconName(e)}isEditable(){return!(this.gradingColumn.delegatedGrading&&this.attempt.isReconciled()&&!this.isDelegatedAndEntitledReconciler(this.gradingColumn))&&(!this.isStudentView&&this.entitlement.isEntitled(v.q.AllGrading,this.course.id)&&!this.course.isComplete())}isOverrideAvailable(){return!(this.gradingColumn.delegatedGrading&&!this.isDelegatedAndEntitledReconciler(this.gradingColumn))&&(this.isEditable()&&this.entitlement.isEntitled(v.q.OverrideGrade,this.course.id))}getGrade(){var e,t,n,a,i;if(this.isMultipleAttempts()||this.gradingColumn.anonymousGrading&&!this.isGradeOverridden())return(null===(e=this.attempt.displayGrade.score)||void 0===e?void 0:e.toString())?this.rubricEvaluation.totalScore.toString():"";if(this.isGradeOverridden()&&!(null===(t=this.gradeDetail.ui)||void 0===t?void 0:t.groupAttempt)&&!this.isGradingInProgress)return this.gradingColumn.anonymousGrading?this.gradeDetail.ui.attempt.grade.toString():this.gradeDetail.manualScore.toString();if(this.isGradeOverridden()&&(null===(n=this.gradeDetail.ui)||void 0===n?void 0:n.groupAttempt)&&!this.isGradingInProgress){const e=[...new Set(this.gradeDetail.groupMembersGrades.map((e=>e.manualScore)))];return 1===e.length?e[0].toString():this.gradeDetail.displayGrade.score.toString()}return(null===(i=null===(a=this.rubricEvaluation)||void 0===a?void 0:a.cells)||void 0===i?void 0:i.length)>0&&this.rubricEvaluation.totalScore?this.rubricEvaluation.totalScore.toString():""}isMultipleAttempts(){return(this.gradingColumn.isMultipleAttempts()||this.exceptionAttempts)&&!this.gradingColumn.isDiscussion()&&!this.gradingColumn.isJournal()}isGradeOverridden(){return this.grade.isRubricGradeOverridden(this.gradeDetail,this.attempt,this.gradingColumn)}createRubricCopy(e){const t=this.CourseModel.$new(e.courseId),n={courseId:e.courseId,title:this.incrementTitle(e.title,t.locale),columnHeaders:this.cloneHeaders(e.columnHeaders),rows:this.cloneRows(e.rows),permissions:i.clone(e.permissions),rubricType:e.rubricType};return t.rubrics.$build(n)}cloneRows(e){return i.map(e,(e=>({cells:this.cloneCells(e.cells),header:e.header,percentage:e.percentage,position:e.position,rowPoints:e.rowPoints})))}cloneCells(e){return i.map(e,(e=>({position:e.position,description:e.description,percentage:e.percentage,percentageMin:e.percentageMin,percentageMax:e.percentageMax,startPointRange:e.startPointRange,endPointRange:e.endPointRange,numericPoints:e.numericPoints})))}cloneHeaders(e){return i.map(e,(e=>({position:e.position,header:e.header})))}incrementTitle(e,t){return this.bbLocalize.translateSync({locale:t,key:"components.services.rubric.newCopyTitle",params:{rubricTitle:e,date:this.bbLocalize.formatDateSync(new Date,s.ILocaleDateFormat.Short)},noWrap:!0,noEscape:!0}).substring(0,P)}processColumnHeader(t,n){for(let a=0;a<e.templateColumnCount;a++)t.push({position:a,header:this.bbLocalize.translateSync({locale:n,key:"components.services.rubric.template.column"+(a+1)})})}processRow(t,n,a){for(let i=0;i<e.templateRowCount;i++){const r=new Array;this.processCell(a,r),t.push({position:i,header:this.bbLocalize.translateSync({locale:null!=n?n:this.bbLocalize.getAppLocale(),key:"components.services.rubric.template.criteria",params:{idx:i+1},noWrap:!0}),percentage:Math.floor(100/e.templateRowCount),cells:r})}}updateRubricRows(e,t){const n=this.cloneRows(e);for(let e=0;e<n.length;e++)switch(t){case C.Tb.PERCENTAGE:n[e].percentage=this.generateCriterionPercentage(n.length,e),n[e].cells=this.processPercentageCells(n[e].cells);break;case C.Tb.PERCENTAGE_RANGE:n[e].percentage=this.generateCriterionPercentage(n.length,e),n[e].cells=this.processPercentageRangeCells(n[e].cells);break;case C.Tb.POINTS:n[e].rowPoints=0,n[e].cells=this.processPointsCells(n[e].cells);break;case C.Tb.POINTS_RANGE:n[e].rowPoints=0,n[e].cells=this.processPointsRangeCells(n[e].cells);break;default:this.unrecognizedRubric()}return n}processPercentage(e,t){return Math.floor(100-100/e*t)}generateCriterionPercentage(e,t){return t+1===e?Math.floor(100/e)+100%e:Math.floor(100-100/e*(e-1))}processPercentageRangeCells(e){const t=this.cloneCells(e),n=e.length;for(let e=0;e<n;e++)t[e]={position:e,description:t[e].description,percentageMin:this.processPercentage(n,e+1),percentageMax:this.processPercentage(n,e)};return t}processPercentageCells(e){const t=this.cloneCells(e),n=e.length;for(let e=0;e<n;e++)t[e]={position:e,description:t[e].description,percentage:this.processPercentage(n,e)};return t}processPointsCells(e){const t=this.cloneCells(e),n=e.length;for(let e=0;e<n;e++)t[e]={position:e,description:t[e].description,numericPoints:0};return t}processPointsRangeCells(e){const t=this.cloneCells(e),n=e.length;for(let e=0;e<n;e++)t[e]={position:e,description:t[e].description,startPointRange:0,endPointRange:0};return t}processCell(t,n){switch(t){case C.Tb.PERCENTAGE:for(let t=0;t<e.templateColumnCount;t++)n.push({position:t,description:"",percentage:this.processPercentage(e.templateColumnCount,t)});break;case C.Tb.PERCENTAGE_RANGE:x.forEach(((e,t)=>{n.push({position:t,description:"",percentageMin:e.min,percentageMax:e.max})}));break;default:this.unrecognizedRubric()}}generateDefaultRubric(e){if(null!=this.rubricTemplate&&this.rubricTemplate.courseId===e.id){const t=i.cloneDeep(this.rubricTemplate);return e.rubrics.$build(t).$asPromise()}return this.bbLocalize.loadBundle("components/services/rubric").then((()=>{this.rubricTemplate={courseId:e.id,title:"",rows:new Array,columnHeaders:new Array,permissions:{edit:!0,delete:!0},rubricType:C.Tb.PERCENTAGE},this.processColumnHeader(this.rubricTemplate.columnHeaders,e.locale),this.processRow(this.rubricTemplate.rows,e.locale,this.rubricTemplate.rubricType);const t=i.cloneDeep(this.rubricTemplate);return e.rubrics.$build(t).$asPromise()}))}getCriteriaPayload(e,t){const n=e.getAssociatedRubric(),a=this.isPointsOrPointsRangeRubric(n)?n.rows.filter((e=>i.isFinite(e.rowPoints))).reduce(((e,t)=>e+t.rowPoints),0):100;return n.rows.map((i=>{var r;let s,o=0;o=this.isPointsOrPointsRangeRubric(n)?0===a?0:e.possible*i.rowPoints/a:e.possible*i.percentage/a,(null==t?void 0:t.cells)&&(s=t.cells.find((e=>e.rubricRowId===i.id)));const l=this.getAchievementsPayload(i.cells,n,o,a,s,e),c=this.isPointsOrPointsRangeRubric(n)?o:i.percentage;return{id:i.id,title:i.header,value:c,feedback:null===(r=null==s?void 0:s.feedback)||void 0===r?void 0:r.rawText,achievements:l}}))}getAchievementsPayload(e,t,n,a,i,r){return e.map(((e,s)=>{const o=(null==i?void 0:i.rubricCellId)===e.id,l={id:e.id,title:t.columnHeaders[s].header,description:e.description,isSelected:o};switch(t.rubricType){case C.Tb.PERCENTAGE:l.value=e.percentage,l.score=n*e.percentage/a;break;case C.Tb.POINTS:l.value=e.numericPoints,l.score=0===a?0:r.possible*e.numericPoints/a;break;case C.Tb.PERCENTAGE_RANGE:l.rangeScore={minValue:e.percentageMin,maxValue:e.percentageMax},l.rangeScoreValue=o?i.selectedPercent:null;break;case C.Tb.POINTS_RANGE:l.rangeScore={minValue:0===a?0:r.possible*e.startPointRange/a,maxValue:0===a?0:r.possible*e.endPointRange/a},l.rangeScoreValue=o?n*i.selectedPercent:null;break;default:this.unrecognizedRubric()}return l}))}isPointsOrPointsRangeRubric(e){return e.rubricType===C.Tb.POINTS||e.rubricType===C.Tb.POINTS_RANGE}isPercentageOrPercentageRangeRubric(e){return e.rubricType===C.Tb.PERCENTAGE||e.rubricType===C.Tb.PERCENTAGE_RANGE}changeRubricType(e,t){e.rows=this.updateRubricRows(e.rows,e.rubricType)}insertNewCriteriaAt(e,t){if(e.rows.length>=15)throw new Error("Cannot add more than 15 criteria rows");const n=this.generateNewRow(e.rubricType,e.rows[0].cells);return e.rows.splice(t,0,n),e.rows.forEach(((e,t)=>{e.position=t})),e}deleteCriteriaAt(e,t){if(1===e.rows.length)throw new Error("Cannot delete last criteria row");return e.rows.splice(t,1),e.rows.forEach(((e,t)=>{e.position=t})),e}balanceCriteriaPercentages(e){e.rows.forEach((t=>{t.percentage=Math.floor(100/e.rows.length)})),i.last(e.rows).percentage+=100-e.rows.reduce(((e,t)=>e+t.percentage),0)}insertNewColumnAt(e,t){if(e.columnHeaders.length>=15)throw new Error("Cannot add more than 15 columns");return e.columnHeaders.splice(t,0,{position:t,header:""}),e.rows.forEach((n=>{switch(e.rubricType){case C.Tb.PERCENTAGE:this.insertNewPercentRubricColumn(n,t);break;case C.Tb.PERCENTAGE_RANGE:this.insertNewPercentRangeRubricColumn(n,t);break;case C.Tb.POINTS:this.insertNewPointsRubricColumn(n,t);break;case C.Tb.POINTS_RANGE:this.insertNewPointsRangeRubricColumn(n,t);break;default:this.unrecognizedRubric()}})),e}deleteColumnAt(e,t){if(1===e.columnHeaders.length)throw new Error("Cannot remove last column");return e.columnHeaders.splice(t,1),e.rows.forEach((n=>{if(n.cells.splice(t,1),e.rubricType!==C.Tb.PERCENTAGE)return e;0===t&&(n.cells[0].percentage=100)})),e}createRubricEvaluation(e,t,n){return{rubricAssociationId:e,userId:t,maxScore:n,totalScore:0,cells:[]}}initiateUiState(e,t){e.ui.editingCells=!1,e.ui.canEdit=t,e.ui.editingCriteria=!1,e.ui.invalidCriteriaPercentageSum=!1,e.ui.criteriaLimit=15,e.ui.columnLimit=15}mapRubricToGrid(e){null==e.ui.columnHeaders&&(e.ui.columnHeaders=new Array),e.columnHeaders.forEach(((t,n)=>{e.ui.columnHeaders[n]?e.ui.columnHeaders[n].uuid||(e.ui.columnHeaders[n].uuid=Object(S.b)()):e.ui.columnHeaders[n]={uuid:Object(S.b)()}})),null==e.ui.rows&&(e.ui.rows=new Array),e.rows.forEach(((t,n)=>{e.ui.rows[n]?e.ui.rows[n].uuid||(e.ui.rows[n].uuid=Object(S.b)()):e.ui.rows[n]={uuid:Object(S.b)()}}));return{rows:e.rows.map(((t,n)=>({id:e.ui.rows[n].uuid,data:t}))),columns:e.columnHeaders.map(((t,n)=>({id:e.ui.columnHeaders[n].uuid,data:t})))}}insertNewPercentRubricColumn(e,t){const n=t<e.cells.length?e.cells[t].percentage:e.cells[t-1].percentage;if(e.cells.splice(t,0,{position:0,description:"",percentage:n}),e.cells.forEach(((e,t)=>{e.position=t})),0===t)return;const a=e.cells[t+1]?e.cells[t+1].percentage:0,i=Math.floor((e.cells[t-1].percentage-a)/2);e.cells[t].percentage=e.cells[t-1].percentage-i}insertNewPercentRangeRubricColumn(e,t){const n=t<e.cells.length?e.cells[t].percentageMin:e.cells[t-1].percentageMin,a=t<e.cells.length?e.cells[t].percentageMax:e.cells[t-1].percentageMax;if(e.cells.splice(t,0,{position:t,description:"",percentageMin:n,percentageMax:a}),e.cells.forEach(((e,t)=>{e.position=t})),0===t)return;const i=e.cells[t+1]?e.cells[t+1].percentageMin:0,r=e.cells[t+1]?e.cells[t+1].percentageMax:0;e.cells[t].percentageMin=e.cells[t-1].percentageMin-Math.floor((e.cells[t-1].percentageMin-i)/2),e.cells[t].percentageMax=e.cells[t-1].percentageMax-Math.floor((e.cells[t-1].percentageMax-r)/2)}insertNewPointsRubricColumn(e,t){const n=t<e.cells.length?e.cells[t].numericPoints:e.cells[t-1].numericPoints;if(e.cells.splice(t,0,{position:0,description:"",numericPoints:n}),e.cells.forEach(((e,t)=>{e.position=t})),0===t)return;const a=e.cells[t+1]?e.cells[t+1].numericPoints:0;e.cells[t].numericPoints=Math.round(50*(e.cells[t-1].numericPoints+a))/100}insertNewPointsRangeRubricColumn(e,t){e.cells.splice(t,0,{position:t,description:"",startPointRange:0,endPointRange:0}),e.cells.forEach(((e,t)=>{e.position=t}))}generateNewRow(e,t){switch(e){case C.Tb.PERCENTAGE:return this.generateNewPercentageRow(t);case C.Tb.PERCENTAGE_RANGE:return this.generateNewPercentageRangeRow(t);case C.Tb.POINTS:case C.Tb.POINTS_RANGE:return this.generateNewPointsTypeRow(t);default:this.unrecognizedRubric()}}generateNewPercentageRangeRow(e){const t={header:"",percentage:0,cells:new Array};return e.forEach(((e,n)=>{t.cells.push({position:n,description:"",percentageMin:e.percentageMin,percentageMax:e.percentageMax})})),t}generateNewPercentageRow(e){const t={header:"",percentage:0,cells:new Array};return e.forEach(((e,n)=>{t.cells.push({position:n,description:"",percentage:e.percentage})})),t}generateNewPointsTypeRow(e){const t={header:"",rowPoints:0,cells:new Array};return e.forEach(((e,n)=>{t.cells.push({position:n,description:"",numericPoints:e.numericPoints,startPointRange:e.startPointRange,endPointRange:e.endPointRange})})),t}unrecognizedRubric(){throw new Error("Invalid rubric type, please go check RubricType for more detail")}persistRubricEvaluation(e){return this.$q((t=>this.performPersistRubricEvaluation(e).then((e=>{const n={gradingColumn:this.gradingColumn,attemptInfo:e};t(n)}))))}rubricFeedbackIsInvalidForSave(e){return e.some((e=>"number"!=typeof e.scoreValue&&e.hasUnsavedFeedback&&""!==e.feedback&&null!=e.feedback))}rubricHasUnsavedFeedback(e){return e.some((e=>"number"==typeof e.scoreValue&&e.hasUnsavedFeedback))}performPersistRubricEvaluation(e){if("grade"in e&&""===e.grade)return this.attempt.score=null,this.persistCleared(e);const t="isGradeOverridden"in e;if(t&&e.isGradeOverridden&&!this.gradingColumn.anonymousGrading)return this.persistOverriden(e);const n="grade"in e&&"criteria"in e,a="criterionFeedbackWasUpdated"in e&&n;return t&&!e.isGradeOverridden&&n||n||a||this.gradingColumn.anonymousGrading?(this.attempt.score=e.grade,this.persistRubricEvaluationData(e)):this.$q.resolve(void 0)}persistCleared(e){const t=this.rubricEvaluation;t.cells=this.getCells(e);const n=new b.a(this.gradingColumn,null);return n.clearGrade=!0,n.setGradeToEmpty=!0,n.rubricEvaluation=t,this.grade.saveGrade(n,this.gradeDetail,this.attempt,{userId:this.currentUserId,group:this.group})}persistOverriden(e){const t=!this.gradingColumn.anonymousGrading&&this.gradeDetail.displayGrade.isOverride,n=this.group?this.CourseModel.$new(this.course.id).gradebook.groupAttempts.$new(this.attempt.id):this.CourseModel.$new(this.course.id).gradebook.attempts.$new(this.attempt.id),a=Object(E.e)(n);a.rubricEvaluation=this.rubricEvaluation;const i=new b.a(this.gradingColumn,String(e.grade));return this.isDelegatedAndEntitledReconciler(i.column)?this.saveOverridenGrade(i):this.gradingColumn.isDiscussion&&t?a.$asPromise().then((()=>this.saveOverridenGrade(i))):a.$patch().$asPromise().then((()=>this.saveOverridenGrade(i)))}isDelegatedAndEntitledReconciler(e){return e.delegatedGrading&&e.isUserReconciler(this.contextUser.userId)}persistRubricEvaluationData(e){const t=this.rubricEvaluation;t.totalScore=e.rubricGrade,t.cells=this.getCells(e),t.overrideScore=-1;const n=new b.a(this.gradingColumn,String(this.attempt.score));return n.rubricEvaluation=t,this.isSingleAttempt()?n.setGradeToEmpty=!0:(n.setGradeToEmpty=!1,this.isGroupContent||(n.attemptId=this.attempt.id)),null==this.attempt.score&&(n.clearGrade=!0),this.isSingleAttempt()?this.grade.saveGrade(n,this.gradeDetail,this.attempt,{userId:this.currentUserId,group:this.group}):this.grade.saveGrade(n,this.gradeDetail,this.attempt)}getCells(e){const t=[];return e.criteria.forEach((n=>{n.achievements.forEach((a=>{var i;if(a.isSelected){let r=null!==(i=a.rangeScoreValue)&&void 0!==i?i:a.value;e.rubricType===C.Tb.POINTS_RANGE&&(r=0===n.value?0:a.rangeScoreValue/n.value),t.push({rubricCellId:a.id,rubricRowId:n.id,selectedPercent:r,feedback:{rawText:n.feedback}})}}))})),t}updateIsStudentView(){var e;this.isStudentView=null!==(e=this.isStudentView)&&void 0!==e?e:this.membership.isStudentMembership()}isSingleAttempt(){return this.gradingColumn&&(this.gradingColumn.isSingleAttempt()&&!this.exceptionAttempts||this.gradingColumn.isDiscussion()||this.gradingColumn.isJournal())}saveOverridenGrade(e){return this.gradingColumn.anonymousGrading?this.$q.resolve(void 0):this.grade.saveGrade(e,this.gradeDetail,void 0,{userId:this.currentUserId,group:this.group}).then((()=>{if((this.gradingColumn.isAssignment()||this.gradingColumn.isDiscussion())&&this.gradeDetail.isPosted&&this.gradeDetail.isPosted()&&this.attempt.readyToPost)return this.group?this.gradingColumn.postReadyGroupAttempts({groupAssociationId:this.attempt.groupAssociationId}):this.gradeDetail.postReadyGrades()}))}};$.templateRowCount=4,$.templateColumnCount=4,$=Object(a.a)([Object(a.c)(0,Object(y.b)("$rootScope")),Object(a.c)(1,Object(y.b)("$q")),Object(a.c)(2,Object(y.b)(o.b)),Object(a.c)(3,Object(y.b)(s.serviceName)),Object(a.c)(4,Object(y.b)(p.m.serviceName)),Object(a.c)(5,Object(y.b)(p.mb.serviceName)),Object(a.c)(6,Object(y.b)(m.n)),Object(a.c)(7,Object(y.b)(l.e)),Object(a.c)(8,Object(y.b)(c.d)),Object(a.c)(9,Object(y.b)(h.d)),Object(a.c)(10,Object(y.b)(d.b)),Object(a.c)(11,Object(y.b)(g.b)),Object(a.c)(12,Object(y.b)(u.b))],$);r.module(I,[o.a,s.moduleName,p.N,m.m,u.a]).service(k,$)},pGZF:function(e,t,n){},pIXs:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n("Llzl"),i=n("0JpG"),r=n("6jv3"),s=n("AuQm");const o="ultra.directives.saveButtons";class l{constructor(e,t){this.scope=e,this.bbLocalize=t,this.isSaving=!1,this.isSavedOnceOrMore=!1,this.savedToBrowserCount=0,this.bbLocalize.loadBundle("components/directives/save-buttons").then((()=>{this.notSavedStr=e.saveType||this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.save-buttons.notSaved"}),this.savedStr=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.save-buttons.saved"}),this.savingStr=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.save-buttons.saving"}),this.cancelStr=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.save-buttons.cancel"}),this.deleteStr=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.save-buttons.delete"}),this.savedSuccessfullyStr=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.save-buttons.notification.savedSuccessfully"}),this.canceledSuccessfullyStr=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.save-buttons.notification.canceledSuccessfully"}),this.deleteButtonStatus=this.deleteStr,e.displaySavedAfterSaving&&e.displaySavedAfterSaving()&&this.isSavedOnceOrMore?this.saveButtonStatus=this.savedStr:this.saveButtonStatus=this.notSavedStr,e.displayDeleteAfterSaving&&e.displayDeleteAfterSaving()&&this.isSavedOnceOrMore?this.cancelButtonStatus=this.deleteStr:this.cancelButtonStatus=this.cancelStr})),e.$on("bb-save-button",((t,n,a)=>{let i=!1;switch(n){case s.d.Change:this.isSaving=!1,this.saveButtonStatus=this.notSavedStr;break;case s.d.Saving:this.isSaving=!0,this.saveButtonStatus=this.savingStr,i=!0;break;case s.d.Saved:i=!0,this.isSavedOnceOrMore=!0,this.isSaving=!1,this.informScreenReaderToRead(this.savedSuccessfullyStr),e.displaySavedAfterSaving&&e.displaySavedAfterSaving()?this.saveButtonStatus=this.savedStr:this.saveButtonStatus=this.notSavedStr,e.displayDeleteAfterSaving&&e.displayDeleteAfterSaving()?this.cancelButtonStatus=this.deleteStr:this.cancelButtonStatus=this.cancelStr;break;case s.d.SaveFailure:case s.d.ValidationFailure:i=!0}this.form.$bbSaveAttempt=i})),e.$parent.$on("bb-autosave-form-to-browser",((e,t,n)=>{s.d.Saved===t&&this.element.attr("saved-to-browser",this.savedToBrowserCount+=1)}))}isValid(){return(this.scope.ignoreFormValidation&&this.scope.ignoreFormValidation()||this.form.$valid)&&this.scope.validateSave()}isCancelNowADelete(){return this.scope.displayDeleteAfterSaving&&this.scope.displayDeleteAfterSaving()&&this.isSavedOnceOrMore}isCancelDisabled(){return this.isSaving||this.isCancelNowADelete()&&!this.scope.canDelete()}isDeleteDisabled(){return this.isSaving||!this.scope.canDelete()}isSaveDisabled(){return this.isSaving||!this.isValid()}cancelAction(){return this.form.$setPristine(),this.informScreenReaderToRead(this.canceledSuccessfullyStr),this.isCancelNowADelete()?this.scope.deleteAction():this.scope.cancelAction()}deleteAction(){return this.form.$setPristine(),this.scope.deleteAction()}saveAction(){return this.form.$setSubmitted(),this.informScreenReaderToRead(this.savedSuccessfullyStr),this.scope.saveAction()}mousedownAction(){if(this.scope.mousedownAction)return this.scope.mousedownAction()}informScreenReaderToRead(e){this.scope.disableScreenreaderAnnouncements&&this.scope.disableScreenreaderAnnouncements()||this.scope.$emit("read-info-directive",e)}}l.$inject=["scope",i.serviceName];class c{constructor(e,t){this.$injector=e,this.bbLocalize=t,this.require="^form",this.replace=!0,this.restrict="E",this.scope={canDelete:"&",cancelAction:"&",choices:"=?",deleteAction:"&",deleteConfirmationResourceType:"@?",disableScreenreaderAnnouncements:"&?",displayDeleteAfterSaving:"&?",displaySavedAfterSaving:"&?",hideSave:"&?",hideCancel:"&?",hideDelete:"&?",isInline:"&?",mousedownAction:"&?",mustShowDeleteConfirmation:"&?",mustShowSaveConfirmation:"&?",saveAction:"&",saveConfirmationResourceType:"@?",validateSave:"&",ignoreFormValidation:"&",saveType:"@?",analyticsIdTagPrefix:"@"},this.link=(e,t,n,a)=>{e.saveButtons=this.$injector.instantiate(l,{scope:e}),e.saveButtons.form=a,e.saveButtons.element=t},this.compile=(e,t)=>("true"===t.isInline&&(e.prepend(e.find("footer").children()),e.find("footer").remove()),{pre:this.link}),this.template=r}}c.$inject=["$injector",i.serviceName],a.module(o,[i.moduleName]).directive("bbSaveButtons",["$injector",e=>e.instantiate(c)])},"pUR+":function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var a=n("Llzl"),i=n("0JpG"),r=n("Qbdf"),s=n("36CG"),o=n("X455"),l=n("UD9g"),c=n("pjml"),d=n("TnpK"),u=n("oB9e"),m=n("nmzr");const p="ultra.course.journal.router";a.module(p,[i.moduleName,d.b,l.b,u.a,r.b,o.a,s.d]).config([d.c,r.c,o.b,s.e,(e,t,a,u)=>{e.peekState(m.A.JOURNAL,{abstract:!0,url:"/journal",resolve:{[r.d]:t.resolve,translations:["$q",i.serviceName,(e,t)=>{const n=[];return n.push(t.loadBundle("features/course/content/journal/journal")),n.push(t.loadBundle("features/course/content/course-content")),n.push(t.loadBundle("features/course/goal-alignment/goal")),e.all(n)}]}}).peekState(m.A.JOURNAL_VIEW,{abstract:!0,url:"/{contentId:_[0-9]+_1|create}?courseId&parentId&position&positionBefore&positionAfter?journalId",panelClass:"full",pageTitle:"course.content.journalItem",require:()=>Promise.all([n.e(31),n.e(0),n.e(1),n.e(2),n.e(22),n.e(20),n.e(92),n.e(150),n.e(622)]).then(n.bind(null,"hucp")),resolve:{translations:["$q",i.serviceName,(e,t)=>{const n=[];return n.push(t.loadBundle("components/directives/grade/grade-input")),n.push(t.loadBundle("components/directives/grade/display-grade")),e.all(n)}]}}).peekState(m.A.JOURNAL_VIEW_WITH_PARTICIPATION,{url:"?view&limit&page&name&submissionStatus&entryLimit&entryPage",panelClass:"full",reloadOnSearch:!1,views:{"journal-content@":{require:()=>Promise.all([n.e(0),n.e(20),n.e(92),n.e(592)]).then(n.bind(null,"6omJ"))},"journal-participation@":{require:()=>n.e(763).then(n.bind(null,"uPz6"))}},onExit:["$rootScope",e=>{e.$broadcast("deadline-refresh")}],peekStates:[m.k.CONDITIONAL_RELEASE_PEEK_PANEL,m.i.CONTENT_MARKET,"course-group",m.A.JOURNAL_DETAILS,m.A.JOURNAL_PARTICIPATION_DETAIL,m.A.JOURNAL_SETTINGS,l.a,m.A.JOURNAL_SUBMISSION_FEEDBACK,m.C.LTI,m.n.COURSE_MESSAGE,"rubric","rubric-evaluation","rubric-view","view-exceptions"],peekViewName:"journal-peek@",pageTitle:"course.content.journalItem",allowChildPeekStates:!0,resolve:{[r.d]:t.resolve,[o.c]:a.resolve,currentCourseId:["$state",e=>e.nextParams.courseId],[s.f]:u.resolve,currentColumn:[d.d,r.d,(e,t)=>{const n=e.nextParams.columnId;if(n&&n!==c.C.CREATE_COLUMN_ID)return t.gradebook.columns.$find(n).$asPromise()}]}}).peekState(m.A.JOURNAL_PARTICIPATION_DETAIL,{url:"/journal-participation-detail?offset&columnId&contentId&singleUserId&singleMembershipId&participantId&entryLimit&entryPage",panelClass:"full",require:()=>Promise.all([n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(15),n.e(16),n.e(17),n.e(22),n.e(663)]).then(n.bind(null,"Zo+2")),pageTitle:"course.content.journalItem",peekViewName:"journal-submissions-peek",allowChildPeekStates:!0,resolve:{translations:["$q",i.serviceName,(e,t)=>t.loadBundle("features/course/content/journal/journal")]},peekStates:[m.A.JOURNAL_SUBMISSION_FEEDBACK,m.i.CONTENT_MARKET,m.C.LTI,"rubric-evaluation"]}).peekState(m.A.JOURNAL_DETAILS,{panelClass:"peek",url:"/details",require:()=>n.e(709).then(n.bind(null,"sC0C")),pageTitle:"course.content.journalDetails",peekViewName:"journal-details-peek"}).peekState(m.A.JOURNAL_SETTINGS,{panelClass:"peek",url:"/settings?focusEleId",require:()=>Promise.all([n.e(0),n.e(1),n.e(2),n.e(20),n.e(92),n.e(617)]).then(n.bind(null,"SxKk")),pageTitle:"course.content.journalSettings",peekViewName:"journal-settings-peek",allowChildPeekStates:!0,peekStates:["goal-picker-legacy","rubric"]}).peekState(m.A.JOURNAL_SUBMISSION_FEEDBACK,{panelClass:"peek",url:"/feedback?userId?columnId",require:()=>n.e(722).then(n.bind(null,"p01W")),pageTitle:"course.content.journalFeedback",peekViewName:"journal-feedback-peek"})}])},pjml:function(e,t,n){"use strict";var a={};n.r(a),n.d(a,"serviceName",(function(){return Oe}));var i={};n.r(i),n.d(i,"serviceName",(function(){return xe}));var r={};n.r(r),n.d(r,"serviceName",(function(){return Ne}));var s={};n.r(s),n.d(s,"serviceName",(function(){return _e}));var o={};n.r(o),n.d(o,"serviceName",(function(){return He}));var l={};n.r(l),n.d(l,"serviceName",(function(){return Je}));var c={};n.r(c),n.d(c,"serviceName",(function(){return Xe})),n.d(c,"CollabSessionType",(function(){return et})),n.d(c,"CollabAccessType",(function(){return tt}));var d={};n.r(d),n.d(d,"serviceName",(function(){return rt}));var u={};n.r(u),n.d(u,"serviceName",(function(){return st}));var m={};n.r(m),n.d(m,"serviceName",(function(){return bt}));var p={};n.r(p),n.d(p,"CourseMessageType",(function(){return ft})),n.d(p,"serviceName",(function(){return vt}));var h={};n.r(h),n.d(h,"sortInstructorsMembership",(function(){return It})),n.d(h,"serviceName",(function(){return wt}));var g={};n.r(g),n.d(g,"serviceName",(function(){return Tt}));var b={};n.r(b),n.d(b,"serviceName",(function(){return Mt}));var f={};n.r(f),n.d(f,"serviceName",(function(){return Ut}));var v={};n.r(v),n.d(v,"serviceName",(function(){return _t}));var y={};n.r(y),n.d(y,"serviceName",(function(){return zt}));var S={};n.r(S),n.d(S,"serviceName",(function(){return qt}));var C={};n.r(C),n.d(C,"moduleName",(function(){return Yt})),n.d(C,"serviceName",(function(){return Jt})),n.d(C,"START_ATTEMPT_ID",(function(){return Zt}));var E={};n.r(E),n.d(E,"ColumnSummaryStatus",(function(){return tn.a})),n.d(E,"serviceName",(function(){return nn}));var I={};n.r(I),n.d(I,"moduleName",(function(){return rn})),n.d(I,"serviceName",(function(){return sn}));var k={};n.r(k),n.d(k,"serviceName",(function(){return ln}));var w={};n.r(w),n.d(w,"serviceName",(function(){return pn}));var T={};n.r(T),n.d(T,"serviceName",(function(){return fn}));var O={};n.r(O),n.d(O,"serviceName",(function(){return vn}));var A={};n.r(A),n.d(A,"serviceName",(function(){return yn}));var P={};n.r(P),n.d(P,"serviceName",(function(){return Sn})),n.d(P,"LTIStatusType",(function(){return Cn})),n.d(P,"LTISendUserDataType",(function(){return En}));var x={};n.r(x),n.d(x,"serviceName",(function(){return In}));var $={};n.r($),n.d($,"serviceName",(function(){return kn}));var N={};n.r(N),n.d(N,"serviceName",(function(){return wn}));var D={};n.r(D),n.d(D,"serviceName",(function(){return Pn}));var L={};n.r(L),n.d(L,"serviceName",(function(){return Nn}));var j={};n.r(j),n.d(j,"serviceName",(function(){return Dn}));var M={};n.r(M),n.d(M,"serviceName",(function(){return Ln}));var G={};n.r(G),n.d(G,"serviceName",(function(){return Mn}));var R={};n.r(R),n.d(R,"serviceName",(function(){return Gn}));var B={};n.r(B),n.d(B,"serviceName",(function(){return Un})),n.d(B,"adjustEngagement",(function(){return _n}));var F={};n.r(F),n.d(F,"serviceName",(function(){return qn}));var U={};n.r(U),n.d(U,"serviceName",(function(){return Hn}));var _={};n.r(_),n.d(_,"serviceName",(function(){return Vn}));var z={};n.r(z),n.d(z,"serviceName",(function(){return Wn}));var q={};n.r(q),n.d(q,"serviceName",(function(){return Kn}));var H={};n.r(H),n.d(H,"serviceName",(function(){return Yn})),n.d(H,"adjustProbabilities",(function(){return Jn})),n.d(H,"learnUser",(function(){return Zn}));var V={};n.r(V),n.d(V,"serviceName",(function(){return Qn}));var W={};n.r(W),n.d(W,"serviceName",(function(){return Xn}));var K={};n.r(K),n.d(K,"serviceName",(function(){return ea}));var Y={};n.r(Y),n.d(Y,"serviceName",(function(){return ta}));var J={};n.r(J),n.d(J,"serviceName",(function(){return na}));var Z={};n.r(Z),n.d(Z,"serviceName",(function(){return aa}));var Q={};n.r(Q),n.d(Q,"serviceName",(function(){return ia}));var X={};n.r(X),n.d(X,"serviceName",(function(){return ra})),n.d(X,"VENDOR_RESPONDUS",(function(){return sa}));var ee={};n.r(ee),n.d(ee,"serviceName",(function(){return oa}));var te={};n.r(te),n.d(te,"serviceName",(function(){return ca}));var ne={};n.r(ne),n.d(ne,"NotificationRecipientType",(function(){return da})),n.d(ne,"GradeIconType",(function(){return ua})),n.d(ne,"serviceName",(function(){return ma}));var ae={};n.r(ae),n.d(ae,"serviceName",(function(){return pa}));var ie={};n.r(ie),n.d(ie,"serviceName",(function(){return ha}));var re={};n.r(re),n.d(re,"serviceName",(function(){return ga})),n.d(re,"transformActivityTime",(function(){return ba}));var se={};n.r(se),n.d(se,"serviceName",(function(){return fa}));var oe={};n.r(oe),n.d(oe,"serviceName",(function(){return ya}));var le={};n.r(le),n.d(le,"serviceName",(function(){return Sa}));var ce={};n.r(ce),n.d(ce,"serviceName",(function(){return Ca}));var de={};n.r(de),n.d(de,"serviceName",(function(){return Ea}));var ue={};n.r(ue),n.d(ue,"serviceName",(function(){return Ia}));var me={};n.r(me),n.d(me,"serviceName",(function(){return ka}));var pe={};n.r(pe),n.d(pe,"serviceName",(function(){return wa}));var he={};n.r(he),n.d(he,"serviceName",(function(){return Ta}));var ge={};n.r(ge),n.d(ge,"serviceName",(function(){return Oa}));var be={};n.r(be),n.d(be,"serviceName",(function(){return Aa}));var fe={};n.r(fe),n.d(fe,"serviceName",(function(){return Pa}));var ve={};n.r(ve),n.d(ve,"serviceName",(function(){return xa}));var ye={};n.r(ye),n.d(ye,"TermDuration",(function(){return Na.a})),n.d(ye,"ConstantTermId",(function(){return $a})),n.d(ye,"serviceName",(function(){return Da}));var Se={};n.r(Se),n.d(Se,"serviceName",(function(){return ja})),n.d(Se,"ultraSettingsPrefix",(function(){return Ma}));var Ce={};n.r(Ce),n.d(Ce,"serviceName",(function(){return Ba}));var Ee={};n.r(Ee),n.d(Ee,"serviceName",(function(){return Ua}));var Ie=n("Rjd/"),ke=(n("QLzv"),n("5MwF")),we=n("yCC5"),Te=n("nkTj");const Oe=we.a,Ae=ke.a.apiBasePath+"/v1";Ie.a.factory(Oe,["restmod",Te.c,(e,t)=>e.model(Ae).mix({$extend:{Model:{getAllyConfig(){return this.single(Ae+"/ally/config").$fetch().$allow(["400-599"]).$asPromise().then((e=>e.isStatusCode(200)?e:{serviceAvailable:!1}))},getAllyToken(e,t){const n=Ae+`/courses/${e}`+(t?`/ally/content/${t}/token`:"/ally/token");return this.single(n).$fetch().$asPromise()}}}})]);var Pe=n("Llzl");const xe=we.b;Ie.a.factory(xe,(()=>{const e=ke.a.telemetryApiBasePath+"/v1/browser/interactions";return{$create(t){Pe.element.ajax({type:"POST",url:e,data:JSON.stringify(t),contentType:"application/json; charset=utf-8",dataType:"json",timeout:ke.a.telemetryApiTimeoutMS})}}}));const $e=we.c;Ie.a.factory($e,["restmod",e=>e.model().mix({lastRun:{serialize:"date"},getRedirectUrl(){return this.$scope.$build().$send({method:"GET",url:this.$scope.$url()+"/"+this.id+"/redirectUrl"},(function(e){this.$unwrap(e.data)})).$asPromise()}})]);const Ne=we.d;Ie.a.factory(Ne,["restmod",e=>{const t=ke.a.apiBasePath+"/v1";return e.model(t).mix({$extend:{Model:{downloadWithAnnotations(e,t,n){return this.$build().$send({method:"GET",url:this.$url()+`/courses/${n}/assignments/attempts/files/${e}/downloadInfo?is_group=${t}`},(function(e){return this.$unwrap(e.data)}))}}}})}]);const De=we.e;Ie.a.factory(De,["restmod",Te.c,(e,t)=>e.model()]);const Le=we.f;Ie.a.factory(Le,["restmod",Te.c,(e,t)=>e.model().mix({lastModifiedDate:{serialize:"date"},answers:{hasMany:we.Vb},gradedQuestionAttempts:{hasMany:we.bb,path:"answers/grades"},questions:{hasMany:we.Ub},ui:{mask:!0,init:()=>({})},exceptions:{hasMany:we.g,hooks:{"before-request":function(e){e.url=e.url.replace(ke.a.apiBasePath,ke.a.apiBasePath+"/public")}}},userExceptions:{hasMany:we.g,path:"exceptions/users"},groupExceptions:{hasMany:we.g,path:"exceptions/groups"}})]);const je=we.g;Ie.a.factory(je,["restmod","$q",Te.c,(e,t,n)=>e.model().mix({$url(e){if(this.$scope.$url(e))return this.$scope.$url(e).replace(ke.a.apiBasePath,ke.a.apiBasePath+"/public")+"/"+encodeURIComponent(this.$pk)},$extend:{Record:{saveException(e){return this.$send({method:"POST",url:this.$url(),data:e}).$allow([404]).$asPromise()},deleteException(){return this.$send({method:"DELETE",url:this.$url()}).$allow([404]).$asPromise()}}}})]);n("+IM5");var Me=n("nbDY"),Ge=n.n(Me);class Re extends Ge.a{}Re.Student=new Re("STUDENT"),Re.InstructorComments=new Re("INSTRUCTOR_COMMENTS"),Re.InstructorNotes=new Re("INSTRUCTOR_NOTES");const Be=we.Vb;Ie.a.factory(Be,["restmod",Te.c,e=>e.model().mix({grade:{hasOne:we.bb,path:"grades"}})]);var Fe=n("FHk9");const Ue=we.h;Ie.a.factory(Ue,["restmod",Te.c,(e,t)=>e.model().mix({$hooks:{"after-request":function(e){null===e.data.results&&(e.data.results=[])}}})]);const _e=we.i;Ie.a.factory(_e,["restmod",e=>{const t=ke.a.apiBasePath+"/v1/brands";return e.model(t).mix({$extend:{Model:{getCurrent(){return this.single(t+"/current").$fetch()}}}})}]);var ze=n("Q/M7"),qe=n("zGdY");const He=we.j;Ie.a.factory(He,["restmod","$q",(e,t)=>{const n=ke.a.apiBasePath+"/v1/calendars";return e.model(n).mix({ui:{mask:!0,init:()=>({})},$extend:{Collection:{sortCalendars(){return this.$action((function(){this.sort((function(e,t){return e.labelLocalizable.languageKey&&t.labelLocalizable.languageKey||e.labelLocalizable.languageKey&&!t.labelLocalizable.languageKey?e.id===qe.U.Institution?1:-1:t.labelLocalizable.languageKey&&!e.labelLocalizable.languageKey?t.id===qe.U.Institution?-1:1:e.labelLocalizable.rawValue<t.labelLocalizable.rawValue?-1:1}))}))}},Model:{getOrRegenerateExportCalendarFeed(e){const n=t.defer();return this.$build().$send({method:e?"POST":"GET",url:ze.c("/webapps/calendar/calendarFeed/url"),transformResponse:e=>e},(function(e){n.resolve(e&&e.data)})),n.promise}}}})}]);var Ve=n("V0gA"),We=n("zoPb");const Ke=we.u;Ie.a.factory(Ke,["restmod",e=>e.model().mix({calendarItems:{hasMany:we.v},dueDateCalendarItems:{hasMany:we.D}})]);const Ye=we.v;Ie.a.factory(Ye,["restmod",e=>e.model().mix(Ve.serviceName,{})]);const Je=we.U;Ie.a.factory(Je,["restmod",e=>{const t=ke.a.apiBasePath+"/v1/calendars/dueDateCalendarItems";return e.model(t).mix(Ve.serviceName)}]);const Ze=we.D;Ie.a.factory(Ze,["restmod",e=>e.model().mix(Je,{})]);var Qe=n("vYaK");const Xe=we.x;var et,tt;!function(e){e.CourseRoom="COURSE_ROOM",e.UserRoom="USER_ROOM"}(et||(et={})),function(e){e.Apollo="APOLLO",e.Gemini="GEMINI"}(tt||(tt={})),Ie.a.factory(Xe,["restmod",Te.c,(e,t)=>e.model().mix({$extend:{Record:{getLaunchUrl(){return this.$send({method:"POST",url:this.$url()+"/launch",data:{}}).$asPromise().then((e=>ke.a.features.collab?e.$response.data.url:e.$response.data.launchUrl))}}}})]);const nt=we.w;Ie.a.factory(nt,["restmod",Te.c,(e,t)=>e.model().mix({sessions:{hasMany:we.x},$extend:{Record:{getVirtualClassroomSession(){return this.sessions.$search({sessionType:et.CourseRoom}).$asPromise().then((e=>e[0]||null))}}}})]);const at=we.y;Ie.a.factory(at,["restmod",Te.c,(e,t)=>e.model().mix({sessions:{hasMany:we.x},$extend:{Record:{getAllCollabSessions(){return this.sessions.$search({expand:"sessionInstances",startTime:(new Date).toISOString()}).$asPromise()},getCourseCollabInfo(){return this.sessions.$search({sessionCategory:"course",expand:"sessionInstances",startTime:(new Date).toISOString()}).$asPromise()},enableCourseRoom(e){return this.$send({method:"POST",url:this.sessions.$new(e).$url(),data:{courseRoomEnabled:!0}},(e=>this.$unwrap(e.data))).$asPromise()},disableCourseRoom(e){return this.$send({method:"POST",url:this.sessions.$new(e).$url(),data:{courseRoomEnabled:!1}},(e=>this.$unwrap(e.data))).$asPromise()},launchDiscussionSession(e,t){return this.$send({method:"POST",url:this.$url()+"/sessions/forums/"+e+"/launch"+(t?"?groupId="+t:"")},(e=>this.$unwrap(e.data))).$asPromise()}}}})]);var it=n("fm95");const rt=we.z;Ie.a.factory(rt,["restmod",Te.c,(e,t)=>e.model().mix({})]);const st=we.E;Ie.a.factory(st,["restmod",Te.c,(e,t)=>e.model().mix({data:{belongsTo:we.zc},ui:{mask:!0,init:()=>({})},$hooks:{"before-fetch-many":function(e){e.params=e.params||{},e.params.fields?e.params.fields+=",-data":e.params.fields="-data"},"after-request":function({data:e}){e.results.forEach((e=>{const t={id:e.userId,isPlaceHolder:!0};e.data=t}))}}})]);const ot=we.I;Ie.a.factory(ot,["restmod",Te.c,(e,t)=>e.model().mix({counts:{hasOne:we.J},messages:{hasMany:we.P},usercounts:{hasMany:we.E},$extend:{Record:{save(){return this.$scope.$build().$send({method:"POST",url:this.$scope.$url(),data:{"resource/x-bb-forumlink":{title:this.title}}},(function(e){this.$unwrap(e.data["resource/x-bb-forumlink"])}))}}}})]);const lt=we.J;Ie.a.factory(lt,["restmod",Te.c,(e,t)=>e.model()]);const ct=we.H;Ie.a.factory(ct,["restmod",Te.c,(e,t)=>e.model().mix({$config:{primaryKey:"cxFileId"},createDate:{serialize:"date"},expiryDate:{serialize:"date"}})]);var dt=n("PSJS");const ut=we.Q;Ie.a.factory(ut,["restmod",Te.c,(e,t)=>e.model().mix({contents:{hasMany:we.P}})]);const mt=we.F;Ie.a.factory(mt,["restmod",Te.c,(e,t)=>e.model()]);var pt=n("nsO7"),ht=n("oVrE"),gt=n("qhd3");const bt=we.B;var ft;Ie.a.factory(bt,["restmod",gt.serviceName,"$http","$q",(e,t,n,a)=>{const i=e.model().mix({courseId:{mask:"CU"},latestMessages:{mask:"U",map:"messages"},messages:{mask:"U",hasMany:we.C},participants:{mask:!0,hasMany:we.zc},totalCount:{mask:"CU"},unreadCount:{mask:"CU"},createdDate:{mask:"CU",serialize:"date"},updatedDate:{mask:"CU",serialize:"date"},canBeRepliedTo:{mask:"U"},includesAllMembers:{mask:"U"},newParticipantIds:{mask:"R"},participantsWithoutSender:{mask:!0},participantsWithoutLatestSender:{mask:!0},creatorId:{mask:"CUD"},ui:{mask:!0,init:()=>({})},createConversation(e){return this.$decorate({"before-request":t=>{t.params={sendEmailToParticipants:e}}},(function(){return this.$save()}))},isCategoryIncluded(e){var t;return!!(null===(t=this.recipientCategory)||void 0===t?void 0:t.some((t=>t===e)))},$hooks:{"before-request":function(e){if("GET"===e.method&&/conversations\/_\d+_\d+$/.exec(e.url)){e.params=e.params||{},e.params.fields=(e.params.fields||"")+",-participantIds";const t=a.all([n(pt.pick(e,"method","params","url")),this.participants.$fetch().$asPromise()]).then((e=>{const t=e[0];return delete t.data.participantIds,t}));e.cache={get:()=>t},Object.defineProperty(this,"participantIds",{get(){return this.participants.map((e=>e.$pk))},set:pt.noop})}}}});return i.$extendRecord((function(e,n){if(!Object.prototype.hasOwnProperty.call(e,"latestSender")){let n=null;Object.defineProperty(e,"latestSender",{get(){const e=this.latestMessages[0].senderId;if(null!==n&&n.$pk===e)return n;const a=[()=>this.latestMessages[0].sender,()=>{if(this.participants.$resolved)return this.participants.find((e=>e.id===this.latestMessages[0].senderId))},()=>{if(Te.a.isValid(this.latestMessages[0].senderId)){const e=t.$new(this.latestMessages[0].senderId);return e.$resolve(),e}const e=ht.c();return this.latestMessages[0].senderId=e,t.$buildRaw({id:e})}];for(let e=0;e<a.length;e++){const t=a[e]();if(void 0!==t)return n=t,t}}})}return{}})),i}]),function(e){e.Normal="NORMAL",e.System="SYSTEM"}(ft||(ft={}));const vt=we.C;Ie.a.factory(vt,["restmod",Te.c,(e,t)=>e.model().mix({conversationId:{mask:"CU"},courseId:{mask:"CU"},senderId:{mask:"CU"},isRead:{mask:"C",init:!1},postDate:{mask:"CU",serialize:"date"},type:{mask:"CU"},participants:{hasMany:we.zc},ui:{mask:!0,init:()=>({})},isSystemMessage(){return ft.System===this.type},createReply(e){return this.$decorate({"before-request":t=>{t.params={sendEmailToParticipants:e}}},(function(){return this.$save()}))}})]);var yt=n("go4a"),St=n("IbyE"),Ct=n("6vR2"),Et=n("f8ya");function It(e){e.sort(((e,t)=>e.displayOrder&&t.displayOrder?e.displayOrder-t.displayOrder:e.displayOrder&&!t.displayOrder?-1:!e.displayOrder&&t.displayOrder?1:e.displayOrder||t.displayOrder?0:gt.sortCompareUsers(e.user,t.user)))}const kt=/courses\/(_\d+_\d+)/,wt=we.N;Ie.a.factory(wt,["restmod","$q",Te.c,"$rootScope","$injector",(e,t,n,a,i)=>{let r;function s(){return r||(r=i.get("$ngRedux")),r}const o=e.model().mix({course:{belongsTo:we.t,key:"courseId"},user:{belongsTo:we.zc,key:"userId"},officeHours:{hasMany:we.vb},enrollmentDate:{serialize:"date"},isAvailable:{init:!0},lastAccessDate:{serialize:"date"},permissions:{init:{}},availabilityHasBeenBypassed(){return!!this.bypassCourseAvailabilityUntil},courseIsOpen(){return!this.courseIsPrivate()&&!1===this.course.isClosed},courseIsPrivate(){return"effectiveAvailability"in this.course?!this.course.effectiveAvailability:!this.course.isAvailable},courseIsComplete(){return!this.courseIsPrivate()&&!0===this.course.isClosed},isGuestMembership(){return this.role===qe.V.Guest},isStudentMembership(){const e=this.role===qe.V.Student;return!(!this.isInStudentPreview||!this.isInStudentPreview())||e},isStudentOrGuestMembership(){return this.isStudentMembership()||this.isGuestMembership()},isActAsInstructorMembership(){const e=this.courseRole&&this.courseRole.isActAsInstructor||this.role===qe.V.Instructor;return(!this.isInStudentPreview||!this.isInStudentPreview())&&e},isTeachingAssistantMembership(){return this.role===qe.V.TeachingAssistant},isInRoleBucket(e){return this.courseRole&&this.courseRole.roleBucket===e},isDueDateExcepted(){return this.accommodation().dueDate.hasAccommodation},accommodation(){return Et.a.fromTypes(this.dueDateExceptionType,this.timeLimitExceptionType)},setAccommodation(e){e.dueDate.equals(this.dueDateExceptionType)||(this.dueDateExceptionType=e.dueDate.type),e.timeLimit.equals(this.timeLimitExceptionType)||(this.timeLimitExceptionType=this.toLearnTimeAccommodationType(e.timeLimit))},toLearnTimeAccommodationType(e){var t;return e.type===qe.Zb.Custom?null!==(t=e.value)&&void 0!==t?t:qe.Zb.NoAccommodation:e.type},getCourseColorClass(){return yt.a(this)},$extend:{Collection:{getMembershipCount(e){return this.getCounts(e).then((e=>e.count))},getCounts(e,n="/count"){const a=t.defer();return this.$collection().$send({method:"GET",url:this.$url()+n,params:e},(e=>{a.resolve(e.data)}),(e=>{a.reject(e)})),a.promise},getDetailsCount(){return this.getCounts({membershipAvailable:"true"})},getRoleBucketCount(){return this.getCounts({groupBy:"roleBucket"},"/counts")},getAccommodatedMemberCount(){return this.getCounts({membershipAvailable:"true"}).then((e=>e.withAccommodationCount))},batchGetCollections(e){const n=t.defer();return this.$collection().$send({method:"PUT",url:this.$url(),data:e},(e=>{n.resolve(e.data)}),(e=>{n.reject(e)})),n.promise}}},$hooks:{"before-fetch-many":function(e){const t=(kt.exec(this.$url())||[])[1];t&&a.$broadcast(`course-${t}-memberships-before-fetch`,e)},"after-fetch-many":function(){var e;this.forEach((e=>{1===e.displayOrder&&(e.ui||(e.ui={}),e.ui.isLeader=!0),e.user&&null==e.user.isAvailable&&(e.user.isAvailable=!0),e.course&&e.course.instructorsMembership&&e.course.instructorsMembership.length&&It(e.course.instructorsMembership)}));const t=s(),n=Object(Ct.a)(this.$response.data),a=null!==(e=this.$response.config.params)&&void 0!==e?e:{},i=Object.keys(a).filter((e=>void 0!==a[e]&&null!==a[e])).map((e=>`${e}=${a[e]}`)).join("&"),r=`${this.$url()}?${i}`,o=Object(St.Lb)(r);if(o)return void t.dispatch(St.V.courseMembership.setCourseMembershipsInStore(o,n));const l=Object(St.Nb)(r);l&&t.dispatch(St.V.courseMembership.setUserMembershipsInStore(l,n))},"after-fetch":function(){1===this.displayOrder&&(this.ui||(this.ui={}),this.ui.isLeader=!0)},"after-feed":function(){var e;const t=this;if(t.userId=t.userId||(t.user||{$pk:void 0}).$pk,null===(e=this.$response)||void 0===e?void 0:e.data){const e=s(),t=Object(Ct.a)(this.$response.data);e.dispatch(St.V.courseMembership.setMembershipInStore(t))}}}});return o}]);const Tt=we.O;Ie.a.factory(Tt,["restmod",Te.c,(e,t)=>e.model().mix({$extend:{Record:{getEmailPreviewContent(){return this.$send({method:"GET",url:this.$scope.$url()+"/preview"},(e=>this.$unwrap({emailBody:e.data.emailBody}))).$asPromise()},getCourseInviteUrl(){return this.$send({method:"GET",url:this.$scope.$url()+"/inviteUrl"},(e=>this.$unwrap({inviteUrl:e.data.inviteUrl}))).$asPromise()}}}})]);const Ot=we.R;Ie.a.factory(Ot,["restmod","DSCacheFactory",Te.c,(e,t,n)=>e.model().mix({$config:{primaryKey:"key"},$extend:{Collection:{getPreference(e){return new At(t,this).getPreference(e)},setPreference(e){return new At(t,this).setPreference(e)},deletePreference(e){return new At(t,this).deletePreference(e)}}}})]);class At{constructor(e,t){this.DSCacheFactory=e,this.preferences=t,this.courseId=t.$scope.$scope.id||t.$scope.$scope.$pk}setPreference(e){return this._setCachePreference({key:e.key,value:e.value.toString(),visibleToStudents:e.visibleToStudents}).$asPromise().then((t=>{const n={key:t.key,value:t.value,visibleToStudents:t.visibleToStudents};switch(typeof e.value){case"boolean":n.value="true"===t.value;break;case"number":n.value=Number(t.value)}return n}))}_setCachePreference(e){const t=this._getPreferenceCacheForCourse(),n=this._setPreferenceOnBackend(e);return t.put(e.key,n),n}_setPreferenceOnBackend(e){if(e.key.length>247)throw new Error("Preference key is too long!");if(e.value.length>255)throw new Error("Preference value is too long!");const t=this.preferences.$new(e.key);return t.key=e.key,t.value=e.value,t.visibleToStudents=e.visibleToStudents,t.$save()}getPreference(e){let t;return"defaultValue"in e&&(t={value:e.defaultValue.toString(),visibleToStudents:!0}),this._getPreferenceWithDefaultAndCache({key:e.key,defaultPreference:t}).$asPromise().then((t=>{const n={key:t.key,value:t.value,visibleToStudents:t.visibleToStudents};switch(typeof e.defaultValue){case"boolean":n.value="true"===t.value;break;case"number":n.value=Number(t.value)}return n}))}_getPreferenceWithDefaultAndCache(e){let t=this._getPreferenceCacheForCourse().get(e.key);return null==t&&(t=this._getPreferenceFromBackend(e),this._getPreferenceCacheForCourse().put(e.key,t)),t}_getPreferenceFromBackend(e){if(e.key.length>247)throw new Error("Preference key is too long!");if(e.defaultPreference&&e.defaultPreference.value.length>255)throw new Error("Default preference value is too long!");return this.preferences.$find(e.key).$allow([404]).$then((t=>{t.$response&&404===t.$response.status&&e.defaultPreference&&null!=e.defaultPreference.value&&null!=e.defaultPreference.visibleToStudents&&(t.value=e.defaultPreference.value,t.visibleToStudents=e.defaultPreference.visibleToStudents)}))}_getPreferenceCacheForCourse(){if(!this.courseId)throw new Error("No courseId has been provided");const e="course.preference.";let t=this.DSCacheFactory.get(e+this.courseId);return null==t&&(t=this.DSCacheFactory.createCache(e+this.courseId,{capacity:100})),t}deletePreference(e){return this._deleteCachePreference(e).$asPromise().then((e=>({key:e.key,value:e.value,visibleToStudents:e.visibleToStudents})))}_deleteCachePreference(e){const t=this._getPreferenceCacheForCourse();if(t.get(e)){t.remove(e);return this.preferences.$new(e).$destroy().$allow([404])}return this.preferences.$new(e)}}var Pt=n("tPPx");const xt=we.T;Ie.a.factory(xt,["restmod",Te.c,(e,t)=>e.model().mix(Ve.serviceName,{})]);const $t=(e,t)=>{let n="/learn/api/v1/courses/"+e+"/groupsets";return t&&(n+="/"+t),n},Nt=we.K;Ie.a.factory(Nt,["restmod","$q",Te.c,(e,t,n)=>e.model().mix({course:{belongsTo:we.t,key:"courseId"},modifiedDate:{serialize:"date"},isAvailable:{init:!1},batchUid:{mask:!0},collabSession:{hasMany:we.x,path:"collabultra/sessions"},$extend:{Record:{canDelete(){return!this.permissions||this.permissions.delete},canEdit(){return!this.permissions||this.permissions.modify}},Collection:{batchGetCollection(e,t){return this.findMany(e,t).$asPromise()},batchUpdate(e){return this.$collection().$send({method:"PUT",url:this.$url()+"/batchUpdate",data:e},(function(e){const t=e.data.map((e=>e.statusCode>=200&&e.statusCode<300?Pe.fromJson(e.body):e.body));return this.$unwrap({results:t})})).$asPromise()},getGroupsInGroupSet(e,t,n){const{expand:a,limit:i=1e3}=n;return this.$collection().$send({method:"GET",url:$t(e,t)+"/groups",params:{expand:a,limit:i}},(function(e){let t=[];return e.data&&e.data.results&&(t=e.data.results),this.$unwrap({results:t})})).$asPromise()}}}})]);const Dt=we.L;Ie.a.factory(Dt,["restmod",Qe.serviceName,(e,t)=>e.model().mix({groupAttempts:{hasMany:we.hb,hooks:{"after-fetch-many":function(){const e=(/courses\/(_\d+_\d+)/.exec(this.$url())||[])[1];for(let n=0;n<this.length;n++)this[n]=t.$new(e).gradebook.groupAttempts.$buildRaw(this[n]),this[n].attempts&&this[n].attempts.length&&(this[n].attempts=t.$new(e).gradebook.attempts.$decode(this[n].attempts))}}}})]);const Lt=we.M;Ie.a.factory(Lt,["restmod",e=>e.model().mix({$hooks:{"before-request":e=>{e.headers={"Suppress-Session-Timestamp-Update":!0}}}})]);const jt=we.G;Ie.a.factory(jt,["restmod",Te.c,(e,t)=>e.model().mix({$config:{primaryKey:"uid"},$extend:{Record:{hasEntitlement(){return!!this.uid}}}})]);const Mt=we.l;Ie.a.factory(Mt,["restmod",Te.c,(e,t)=>e.model(ke.a.apiBasePath+"/v1/cloudstorages").mix({contents:{hasMany:we.m},me:{hasOne:we.o},$config:{primaryKey:"name"}})]);const Gt=we.o;Ie.a.factory(Gt,["restmod",Te.c,(e,t)=>e.model()]);const Rt=we.m;Ie.a.factory(Rt,["restmod",Te.c,(e,t)=>e.model().mix({download:{hasOne:we.n,mask:!0},createdTime:{serialize:"date"},updatedTime:{serialize:"date"},ui:{mask:!0,init:()=>({})},$url(e){return this.$scope.$url(e)+"/"+encodeURIComponent(this.$pk)},$extend:{Record:{getChildren(e){return null==e&&(e={}),this.$scope.$collection().$send({method:"GET",url:this.$url()+"/children",params:e},(function(e){this.$unwrap(e.data)}),(function(e){}))}}}})]);const Bt=we.n,Ft={};Ie.a.factory(Bt,["restmod",Te.c,(e,t)=>e.model().mix(Ft)]);const Ut=we.p;Ie.a.factory(Ut,["restmod",Te.c,(e,t)=>e.model(ke.a.apiBasePath+"/v1/cloudstorages/tasks").mix(Ft)]);const _t=we.q;Ie.a.factory(_t,["restmod",Te.c,(e,t)=>e.model(ke.a.apiBasePath+"/v1/collabultra/ping").mix({$extend:{Record:{getCollabUltraInfo(){return this.$send({method:"GET",url:this.$scope.$url()},(function(e){this.$unwrap(e.data)})).$allow([403,404]).$asPromise()}}}})]);const zt=we.V;Ie.a.factory(zt,["restmod",Te.c,(e,t)=>{const n=ke.a.apiBasePath+"/v1/utilities/entitlements";return e.model(n).mix({$config:{primaryKey:"uid"},$extend:{Record:{hasEntitlement(){return!!this.uid}}}})}]);const qt=we.W;Ie.a.factory(qt,["restmod",e=>e.model(ke.a.apiBasePath+"/v1/externalCourses").mix({schedule:{hasMany:we.T},startDate:{serialize:"date"},endDate:{serialize:"date"},$extend:{Collection:{}},$hooks:{"before-request":function(e){ke.a.features.externalCourse||"GET"===e.method&&e.url===`${ke.a.apiBasePath}/v1/externalCourses`&&(e.cache={get:()=>({paging:{nextPage:"",previousPage:"",count:0,limit:1e5,offset:0},permissions:null,results:[]})})}}})]);const Ht=we.X;Ie.a.factory(Ht,["restmod",Te.c,(e,t)=>e.model().mix({ui:{mask:!0,init:()=>({})}})]);var Vt=n("t6LE"),Wt=n("JrDC"),Kt=n("wgY5");const Yt="ultra.components.services.models.grade.gradeGroupAttempt",Jt=we.hb,Zt="start";Ie.a.factory(Jt,["restmod",Qe.serviceName,Te.c,(e,t,n)=>e.model().mix(Vt.serviceName,{attempts:{ignore:"CU"},members:{ignore:"CU"},$extend:{Scope:{$destroyUrlFor:e=>ke.a.apiBasePath+"/v1/courses/"+Wt.a(t,e.$scope)+"/gradebook/groupAttempts/"+e.id},Record:{getFeedbackToUser(){return this.feedbackToUser},getLastFeedbackAuthor(){return this.lastFeedbackAuthor||this.attempts[0]&&this.attempts[0].lastFeedbackAuthor},getGradeAttempt(){return this.attempts&&this.attempts.length?1===this.attempts.length?this.attempts[0]:this.submittedBy?pt.find(this.attempts,(e=>e.userId===this.submittedBy)):pt.sortBy(this.attempts,["creationDate"])[0]:null},isPrePostGrade(){return!this.isCompleted()||!this.readyToPost},isDisplayablePostedGrade(){return this.isCompleted()&&this.readyToPost}},Collection:{getNumAttemptsSubmittedLate(e){return this.filter((t=>t.isSubmitted()&&Kt(t.attemptDate).isAfter(e))).length},getNumAttemptsToGrade(){return this.filter((e=>e.isNeedsGrading()&&!e.isPostable())).length},getNumAttemptsToPost(){return this.filter((e=>e.isPostable())).length},getNumOfGradedAttempts(){return this.filter((e=>e.isGraded())).length},isAllGradedAndPosted(){return this.length>0&&this.every((e=>e.isCompleted()))},isFirstAttemptPosted(){var e;return null===(e=this.getFirstAttempt())||void 0===e?void 0:e.isCompleted()},isLastSubmittedAttemptPosted(){var e;return null===(e=this.getLastSubmittedAttempt())||void 0===e?void 0:e.isCompleted()},getAttemptIndexById(e){return this.findIndex((t=>t.id===e))},getAttemptById(e){return pt.find(this,(t=>t.id===e))},getFirstAttempt(){return this.length?this[0]:void 0},getLastSubmittedAttempt(){return this.length?this[this.length-1]:void 0}}},$hooks:{"after-update":function(e){this.attempts&&this.attempts.length&&e.config.params&&(this.attempts=t.$new(e.config.params.courseId).gradebook.attempts.$decode(this.attempts))},"after-fetch":function(e){this.attempts&&this.attempts.length&&e.config.params&&(this.attempts=t.$new(e.config.params.courseId).gradebook.attempts.$decode(this.attempts))},"after-feed":function(e){this.permissions&&(this.permissions.deleteAttempt=this.permissions.delete,this.permissions.editAttempt=this.permissions.editGrade);!function(e){const t=e.toolAttemptDetail,n=e.attempts;if(!t||!n)return;const a=Object.keys(t)[0];a&&n.forEach((e=>{if(e.toolAttemptDetail)return;const n=e.id,i=pt.cloneDeep(t);if(!i[a])return;e.toolAttemptDetail=i;const r=e.toolAttemptDetail[a].questionAttempts;r&&r.forEach((e=>{e.attemptId=n}))}))}(this)}}})]);const Qt=we.eb;Ie.a.factory(Qt,["restmod",Te.c,(e,t)=>e.model().mix({ui:{mask:!0,init:()=>({})},$hooks:{"after-feed":function(e){this.localizableTitle||(this.localizableTitle={bundle:"gradebook_type",languageKey:this.title,serviceLevel:null})}}})]);var Xt=n("Kpdw"),en=n("e6jQ"),tn=n("7CA4");const nn=we.r;Ie.a.factory(nn,["restmod",Te.c,Qe.serviceName,(e,t,n)=>e.model().mix({$hooks:{ui:{mask:!0,init:()=>({updateTimestamp:0})},"after-feed":function(){this.calculateDerivedSummaries()}},$extend:{Record:{calculateDerivedSummaries(){this.numNeedsGrading=Te.b(this.numGroupsNeedsGrading,this.numStudentsNeedsGrading),this.numPosted=Te.b(this.numGroupsPosted,this.numStudentsPosted),this.numEligibleToBeGraded=null!=this.numGroupsPosted?this.numGroupsEligibleToBeGraded:this.numStudentsEligibleToBeGraded,this.numSubmissionGradedNeedsPosting=Te.b(this.numGroupsSubmissionGradedNeedsPosting,this.numStudentsSubmissionGradedNeedsPosting),this.numStudentsEligibleToBeGradedExternalSubmission=this.numStudentsEligibleToBeGraded-this.numStudentsGradedNeedsPosting-this.numStudentsPosted-this.numberOfOverriddenGradesToPost,this.numGroupsEligibleToBeGradedExternalSubmission=this.numGroupsEligibleToBeGraded-this.numGroupsGradedNeedsPosting-this.numGroupsPosted,null!=this.numGroupsGradedNeedsPosting?(this.numGradedNeedsPosting=this.numGroupsGradedNeedsPosting,this.numberOfStudentsOverriddenGradesToPost=this.numberOfOverriddenGradesToPost,this.numberOfOverriddenGradesToPost=0):this.numGradedNeedsPosting=this.numStudentsGradedNeedsPosting},isRestricted(){return this.restricted},getStatus(){return this.isRestricted()?tn.a.Restricted:this.numNeedsGrading>0?tn.a.NeedsGrading:this.totalNumberOfGradesToPost()>0?tn.a.NeedsPosting:this.numPosted===this.numEligibleToBeGraded&&this.numPosted>0?tn.a.AllPosted:0===this.numSubmissionsTotal?tn.a.NothingToGrade:0===this.numNeedsGrading?tn.a.AllGraded:void 0},isAllGradedAndPosted(){return this.numPosted===this.numEligibleToBeGraded&&this.numPosted>0},numStudentsGraded(){return this.numGradedNeedsPosting+this.numPosted+this.numberOfOverriddenGradesToPost},numStudentSubmissions(){return this.participantIds?this.participantIds.length:this.numGroupsSubmitted||this.numStudentsSubmitted},hasGradesToPost(){return null!=this.numGroupsGradedNeedsPosting?this.numGroupsGradedNeedsPosting>0:this.numGradedNeedsPosting>0||this.numberOfOverriddenGradesToPost>0},totalNumberOfGradesToPost(){return this.numGradedNeedsPosting+this.numberOfOverriddenGradesToPost}},Model:{inferKey:()=>en.a(),unpack:(e,t)=>(pt.forOwn(e,((e,t,n)=>{pt.startsWith(t,"$")||"ui"===t||(n[t]=null)})),Te.f(e,t))},Collection:{expandingColumns(e,t){let n={};return this.$collection().$on("after-fetch-many",(a=>{const i=a.data.results;n=i.reduce(((e,t)=>(e[t.columnId]=t,e)),n),e.forEach((e=>{e.id in n?e.summary.$unwrap(n[e.id]):t&&e.summary.$unwrap(t)}))}))}}}})]);var an=n("KrjC");const rn="ultra.components.models.grade.gradeSchema",sn=we.jb;Ie.a.factory(sn,["restmod",Te.c,(e,t)=>e.model().mix({ui:{mask:!0,init:()=>({})},$extend:{Record:{getPossiblePoints(){if(this.scaleType===qe.Ub.Score)throw new Error("Possible points must be entered by the user for schemas with a scale type of Score");return 100}}}})]);var on=n("3PCF");const ln=we.db;Ie.a.factory(ln,["restmod",Te.c,"$injector","$ngRedux",(e,t,n,a)=>e.model().mix({$hooks:{"before-fetch":function(e){e.method="POST",pt.isString(e.params.membershipIds)&&(e.params.membershipIds=e.params.membershipIds.split(",")),pt.isString(e.params.gradeIds)&&(e.params.gradeIds=e.params.gradeIds.split(",")),pt.isString(e.params.columnIds)&&(e.params.columnIds=e.params.columnIds.split(",")),e.data={membershipIds:e.params.membershipIds,gradeIds:e.params.gradeIds,columnIds:e.params.columnIds},delete e.params.membershipIds,delete e.params.gradeIds,delete e.params.columnIds},"after-fetch":function(e){const t=n.get(Qe.serviceName),i=e.config.params.courseId;this.bulkViewUsers.forEach((e=>{const n=e.grades.map((e=>{var t;const n=null===(t=e.attempts)||void 0===t?void 0:t.find((t=>new Date(t.attemptDate).getTime()===new Date(e.lastAttemptDate).getTime()));return{...e.grade,lastAttemptId:null==n?void 0:n.id}}));a.dispatch(St.V.gradebookGrade.setGradesInStore(n)),e.grades.forEach((e=>{const n=e.grade;e.grade=t.$new(i).gradebook.columns.$new(e.columnId).grades.$buildRaw(n),e.lastAttemptDate&&(e.lastAttemptDate=new Date(e.lastAttemptDate)),e.attempts&&e.attempts.length>0&&(e.attempts.forEach((a=>{const r=t.$new(i).gradebook.columns.$new(e.columnId).grades.$new(n.id).attempts.$buildRaw(a);e.grade.attempts.$add(r)})),e.grade.ui.attempt=e.grade.attempts[0]),e.grade.permissions=this.permissions,e.submissionResults&&e.submissionResults.results[on.b]&&(e.originalityProcessed=e.submissionResults.results[on.b].originalityProcessed,e.originalityScore=e.submissionResults.results[on.b].originalityScore)}))}))}}})]);var cn=n("Bu0u");const dn=we.Y;class un{static fromValue(e){return un[e]}}un.ALL={resetShowComments:()=>!0,getValue:()=>"ALL",validate:e=>!0},un.BYCOLUMNS={resetShowComments:()=>!1,getValue:()=>"BYCOLUMNS",validate:e=>e&&!!e.length},un.HISTORYLOG={resetShowComments:()=>!0,getValue:()=>"HISTORYLOG",validate:e=>!0};class mn{static fromValue(e){return mn[e]}}mn.MYDEVICE={resetContentCollection:()=>!0,getValue:()=>"MYDEVICE",validate:e=>!0,openUrl:e=>{const t=ze.j();window.location.href=t+e}},mn.CONTENTCOLLECTION={resetContentCollection:()=>!1,getValue:()=>"CONTENTCOLLECTION",validate:e=>!!e,openUrl:e=>()=>{}},Ie.a.factory(dn,["restmod",Te.c,(e,t)=>e.model().mix({grades:{hasMany:we.gb},columns:{hasMany:we.fb},attempts:{hasMany:we.cb},categories:{hasMany:we.eb},performancecodes:{hasMany:we.ib},schemas:{hasMany:we.jb},bulkView:{hasOne:we.db,path:"grades/bulkView"},settings:{hasOne:we.Z},groupAttempts:{hasMany:we.hb},summaries:{hasMany:we.r},$extend:{Record:{getDownloadUrl(e){if(!e||!e.dataScopeType||!e.delimiterType)throw new cn.a({message:"dataScoreType and delimiterType must be set"});return this.$send({method:"POST",url:this.$url()+"/prepareDownload",data:{...e,dataScopeType:e.dataScopeType.getValue(),downloadTo:e.downloadTo.getValue()}},(function(e){this.$unwrap(e.data)})).$asPromise()},validateCalculatedFormula(e){if(!e)throw new cn.a({message:"formula data must be set"});return this.$send({method:"POST",url:this.$url()+"/validateCalculatedFormula",data:e}).$allow([400]).$asPromise().then((e=>200===e.$response.status))},parseUploadedGradebook(e){return this.$send({method:"GET",url:this.$url()+"/parseUploadedGradebook",params:e},(function(e){this.$unwrap(e.data)})).$allow([400,403,404]).$asPromise()},importGradebook(e){return this.$send({method:"POST",url:this.$url()+"/importGradebook",data:e},(function(e){this.$unwrap(e.data)})).$allow([400,403,404]).$asPromise()}}}})]);const pn=we.Z;Ie.a.factory(pn,["restmod",Te.c,(e,t)=>e.model()]);const hn=we.bb;Ie.a.factory(hn,["restmod",e=>e.model().mix({$hooks:{"after-save":function(e){this.points=null,this.$unwrap(e.data),this.questionAttempt.visibleQuestionNumber=this.questionNumber},"before-save":function(e){e.url=e.url.substr(0,e.url.indexOf("/answers"))+"/answers/"+this.questionAttempt.id+"/grades",pt.merge(e.data,{questionType:this.questionAttempt.questionType}),this.questionNumber=this.questionAttempt.visibleQuestionNumber},"after-fetch-many":function(){this.forEach((e=>{e.permissions=this.permissions}))}},$extend:{Collection:{setPostStatusAndGroupAttemptId(e){this.forEach((t=>{t.ui.isPosted=e.isCompleted(),e.groupAttemptId&&(t.ui.groupAttemptId=e.groupAttemptId)}))}}},questionAttempt:{ignore:"CU"},ui:{init:()=>({}),mask:!0}})]);const gn=we.ib;Ie.a.factory(gn,["restmod","$q",Te.c,(e,t,n)=>e.model().mix({})]);const bn=we.ab;Ie.a.factory(bn,["restmod",Te.c,e=>e.model().mix({$extend:{hasAttachments(){return!pt.isUndefined(this.overallOriginalityProcessed)&&(this.attemptOriginality&&this.attemptOriginality.attachments.length||this.answerOriginalities.length&&this.answerOriginalities.some((e=>e.attachments.length)))},canShowReportPanel(){return this.overallOriginalityProcessed&&this.hasAttachments()}},$hooks:{"after-request":function(e){e.data.results&&(e.data=e.data.results[on.b])}}})]);const fn=we.kb;Ie.a.factory(fn,["restmod",e=>{const t=ke.a.apiBasePath+"/v1/calendars/institution/calendarItems";return e.model(t).mix(Ve.serviceName)}]);const vn=we.lb;Ie.a.factory(vn,["restmod",Te.c,(e,t)=>{const n=ke.a.apiBasePath+"/v1/roles/institutionRoles";return e.model(n)}]);const yn=we.mb;Ie.a.factory(yn,["restmod",Te.c,(e,t)=>{const n=ke.a.apiBasePath+"/v1/languages";return e.model(n).mix({})}]);const Sn=we.nb;var Cn,En;!function(e){e.Approved="Approved",e.Excluded="Excluded",e.NeedsApproval="NeedsApproval"}(Cn||(Cn={})),function(e){e.Never="Never",e.SSLOnly="SSLOnly",e.Always="Always"}(En||(En={})),Ie.a.factory(Sn,["restmod",e=>{const t=ke.a.apiBasePath+"/v1/lti/domainConfigs";return e.model(t).mix({$extend:{Model:{findByDomain(e){return this.$build().$send({method:"GET",url:this.$url()+"?domain="+e},(function(e){return this.$unwrap(e.data)})).$allow([404]).$asPromise()}}}})}]);const In=we.pb;Ie.a.factory(In,["restmod",Te.c,e=>{const t=ke.a.apiBasePath+"/v1/lti/settings";return e.model(t).mix({$extend:{Model:{getSettings(){return this.$build().$send({method:"GET",url:this.$url()},(function(e){return this.$unwrap(e.data)})).$asPromise()}}}})}]);const kn=we.ob;Ie.a.factory(kn,["restmod",e=>{const t=ke.a.apiBasePath+"/public/v1/lti/placements";return e.model(t).mix({isAvailable(){return qe.Jb.Yes===this.availability.available},$hooks:{"after-feed":function(e){this.iconUrl=ze.c(this.iconUrl)}}})}]);const wn=we.qb;Ie.a.factory(wn,["restmod",Te.c,(e,t)=>{const n=ke.a.apiBasePath+"/v1/users/me/preferences";return e.model(n).mix({$config:{primaryKey:"key"}})}]);const Tn=we.rb;Ie.a.factory(Tn,["restmod",Te.c,e=>e.model()]);var On=n("1/43");const An=we.tb;Ie.a.factory(An,["restmod",Te.c,e=>e.model()]);const Pn=we.ub;Ie.a.factory(Pn,["restmod",Te.c,e=>e.model().mix({courseSettings:{hasMany:we.tb},organizationSettings:{hasMany:we.tb},$url:()=>ke.a.apiBasePath+"/v1/notification/settings"})]);const xn=we.vb;Ie.a.factory(xn,["restmod",e=>e.model().mix(Ve.serviceName,{})]);var $n=n("FBBZ");const Nn=we.wb;Ie.a.factory(Nn,["restmod",e=>{const t=ke.a.partnerCloudBasePath+"/v1";return e.model(t).mix({$extend:{Model:{getPartnersByType(e){return this.$build().$send({method:"GET",url:this.$url()+"/providerContent?course_id="+e},(function(e){return this.$unwrap(e.data)})).$allow(["400-599"]).$asPromise()}}},$hooks:{"after-feed":function(e){const t=e=>{Pe.isDefined(e.internalPovider)&&Pe.isUndefined(e.internalProvider)&&(e.internalProvider=e.internalPovider)};pt.forEach(this.premierList,t),pt.forEach(this.signatureList,t),pt.forEach(this.otherList,t);const n=e=>!e.internalProvider||$n.o(e);this.premierList=pt.filter(this.premierList,n),this.signatureList=pt.filter(this.signatureList,n),this.otherList=pt.filter(this.otherList,n)}}})}]);const Dn=we.Cb;Ie.a.factory(Dn,["restmod",e=>{const t=ke.a.partnerCloudBasePath+"/v1/status";return e.model(t).mix({$extend:{Model:{getStatus(e){return this.$build().$send({method:"GET",url:this.$url()+"?course_id="+e},(function(e){return this.$unwrap(e.data)}),(function(){return this.$unwrap({enabled:!1,userCloudProvisioned:!1})})).$allow(["400-599"]).$asPromise()}}}})}]);const Ln=we.yb;Ie.a.factory(Ln,["restmod",Te.c,(e,t)=>{const n=ke.a.partnerCloudBasePath+"/v1/courses";return e.model(n).mix({partnerLinkedCourses:{hasMany:we.Ab,path:"providerBindings"},$extend:{Record:{updateProvisioning(e){return this.$scope.$build().$send({method:"POST",url:this.$scope.$url()+"/"+this.$pk+"/updateProvisioning/"+e},(function(e){this.$unwrap(e.data)})).$allow(["400-599"]).$asPromise()}}}})}]);const jn=we.Ab;Ie.a.factory(jn,["restmod",Te.c,e=>e.model().mix({tools:{hasOne:we.Db,path:"tools"},id:{map:"@id"},$extend:{Model:{unpack:(e,t)=>t&&t.bindings}}})]);const Mn=we.xb;Ie.a.factory(Mn,["restmod",e=>{const t=ke.a.partnerCloudBasePath+"/v1/courses";return e.model(t).mix({$extend:{Model:{getContentIds(e,t){return this.$build().$send({method:"GET",url:this.$url()+"/"+e+"/linkRefId/"+t+"/content/ids"},(function(e){return this.$unwrap(e.data)})).$asPromise()}}}})}]);n("3uIF");const Gn=we.Bb;Ie.a.factory(Gn,["restmod",e=>{const t=ke.a.partnerCloudBasePath+"/v1";return e.model(t).mix({$extend:{Model:{getSettingsById(e){return this.$build().$send({method:"GET",url:this.$url()+"/providers/"+e+"/settings"},(function(e){return this.$unwrap(e.data)})).$allow(["400-599"]).$asPromise()}}}})}]);const Rn=we.Db;Ie.a.factory(Rn,["restmod",Te.c,(e,t)=>e.model().mix({})]);const Bn=we.Eb;Ie.a.factory(Bn,["restmod",e=>e.model().mix(Ve.serviceName,{})]);var Fn=n("0JpG");const Un=we.Fb;function _n(e,t){e.activityDaily&&e.activityDaily.forEach((e=>{e.inCourseDuration=zn(e.inCourseDuration),e.ui={display:t.formatComposedDurationSync(e.inCourseDuration,Fn.ILocaleComposedDurationFormat.HoursMinutes)}})),e.activityWeekly&&e.activityWeekly.forEach((e=>{e.inCourseDuration=zn(e.inCourseDuration),e.ui={display:t.formatComposedDurationSync(e.inCourseDuration,Fn.ILocaleComposedDurationFormat.HoursMinutes)}}))}function zn(e){return 15*Math.round(e/15)*60}Ie.a.factory(Un,["restmod",Fn.serviceName,(e,t)=>{const n=ke.a.telemetryApiBasePath+"/v1/predict/courses";return e.model(n).mix({"activityDaily[].activityDate":{decode:"localDate"},"activityWeekly[].activityWeek":{decode:"localDate"},"assignments[].dueDate":{serialize:"date"},"assignmentGrades[].gradedDate":{serialize:"date"},"assignmentGrades[].submissionDate":{serialize:"date"},startDate:{serialize:"date"},endDate:{serialize:"date"},lastActivityDate:{serialize:"date"},"weeks[].weekOf":{decode:"localDate"},$hooks:{"after-fetch":function(){_n(this,t),this.instructors&&this.instructors.forEach((e=>{e.learnUser=H.learnUser}))}}})}]);const qn=we.Gb;Ie.a.factory(qn,["restmod",e=>e.model().mix({$extend:{Model:{$for(e,t){return this.$collection(t,{$urlFor:()=>ke.a.telemetryApiBasePath+"/v1/predict/"+e})}},Collection:{$decode(e){return this.push(...e),this}}}})]);const Hn=we.Jb;Ie.a.factory(Hn,["restmod",e=>{const t=ke.a.telemetryApiBasePath+"/v1/predict/favorites";return e.model(t).mix({$extend:{Model:{marketSnapshot(e,t){return this.$build().$send({method:"GET",params:t,url:this.$url()+"/"+e+"/marketSnapshot"},(function(e){return this.$unwrap(e.data)})).$asPromise()}}}})}]);const Vn=we.Pb;Ie.a.factory(Vn,["restmod",Te.c,(e,t)=>{const n=ke.a.telemetryApiBasePath+"/v1/predict/settings";return e.model(n).mix({$extend:{Model:{get(){return this.single(n).$fetch().$allow([403]).$asPromise()}}},$hooks:{"after-fetch":function(){Pe.isUndefined(this.advisorEmailEnabled)&&(this.advisorEmailEnabled=!0),Pe.isUndefined(this.instructorEmailEnabled)&&(this.instructorEmailEnabled=!0);const e=pt.indexOf(this.fields,"probability");-1!==e&&(this.fields[e]="goodProbability")}}})}]);const Wn=we.Rb;Ie.a.factory(Wn,["restmod",Te.c,e=>{const t=ke.a.apiBasePath+"/v1/telemetry/predict/systemSettings";return e.model(t).mix({$extend:{Model:{get(){return this.single(t).$fetch().$allow([404]).$asPromise()}}}})}]);const Kn=we.Ib;Ie.a.factory(Kn,["restmod",e=>e.model().mix({$extend:{Model:{$for(e,t){return this.$collection(t,{$urlFor:()=>ke.a.telemetryApiBasePath+"/v1/predict/"+e})}},Collection:{$unwrap(e){return e.results||e.data?(e.data&&this.push(...e.data),e.results&&this.push(...e.results)):this.push(...e),this}}}})]);const Yn=we.Qb;function Jn(e){Pe.isDefined(e.goodProbability)&&(e.goodProbability=Math.round(100*e.goodProbability)),Pe.forEach(e.courses,(e=>{e.prediction&&(e.prediction.goodProbability=Math.round(100*e.prediction.goodProbability)),e.previousPrediction&&(e.previousPrediction.goodProbability=Math.round(100*e.previousPrediction.goodProbability)),Pe.forEach(e.weeks,(e=>{e.goodProbability=Math.round(100*e.goodProbability)}))}))}function Zn(){return Pe.isUndefined(this.ui)&&(this.ui={}),Pe.isUndefined(this.ui.learnUser)&&(this.ui.learnUser={givenName:this.firstName,familyName:this.lastName}),this.ui.learnUser}Ie.a.factory(Yn,["restmod","$q",Fn.serviceName,(e,t,n)=>{const a=ke.a.telemetryApiBasePath+"/v1/predict/students",i=ke.a.telemetryApiBasePath+"/v1/predict/courses/",r=ke.a.telemetryApiBasePath+"/v1/predict/studentSearch",s=ke.a.telemetryApiBasePath+"/v1/predict/message";ke.a.telemetryApiBasePath;return e.model(a).mix({academicHoldDate:{serialize:"date"},birthDate:{serialize:"date"},financialHoldDate:{serialize:"date"},lastActivityDate:{serialize:"date"},"plannerInterests[].chosenDate":{serialize:"date"},plannerLocationChosenDate:{serialize:"date"},"courses[].activityDaily[].activityDate":{decode:"localDate"},"courses[].activityWeekly[].activityWeek":{decode:"localDate"},"courses[].assignments[].dueDate":{serialize:"date"},"courses[].assignmentGrades[].gradedDate":{serialize:"date"},"courses[].assignmentGrades[].submissionDate":{serialize:"date"},"courses[].startDate":{serialize:"date"},"courses[].endDate":{serialize:"date"},"courses[].lastActivityDate":{serialize:"date"},"courses[].weeks[].weekOf":{decode:"localDate"},$extend:{Model:{getCourseStudent(e,t,n){return this.single(i+t+"/students/"+e).$fetch(n).$allow([403]).$asPromise()},getCourseStudents(e,t){return this.$collection(t,{$urlFor:()=>i+e+"/students"}).$fetch(t).$allow([403]).$asPromise()},getStudent(e,n){const i=t.defer();return this.$collection({studentId:e},{$urlFor:()=>a}).$fetch(n).$asPromise().then((e=>{i.resolve(e[0])})).catch((()=>{i.reject()})),i.promise},postInstructorMessage(e,t,n){return this.$build().$send({method:"POST",url:i+n+"/students/"+t+"/message/advisor",data:e}).$asPromise()},postAdvisorMessage(e,t){return this.$build().$send({method:"POST",url:a+"/"+t+"/message/student",data:e}).$asPromise()},postMessage(e){return this.$build().$send({method:"POST",url:`${s}`,data:e}).$asPromise()},postMessageToStudents(e){return this.$build().$send({method:"POST",url:`${a}/message`,data:e}).$asPromise()},postMessageToStudentsByFilter(e,t){return this.$build().$send({method:"POST",url:`${a}/messageByFilter`,data:e,params:t}).$asPromise()},typeaheadSearch(e,n="",a=6,s=!1){const o=t.defer();let l=r+"?query="+encodeURIComponent(e);return n&&(l=`${i}${n}/studentSearch?query=${encodeURIComponent(e)}`),this.$build().$send({method:"GET",url:l,params:{emailRequired:!0===s?"true":"false",limit:a}},(function(e){e&&e.data&&e.data.results?o.resolve(e.data.results.map((e=>({firstName:e.firstName,lastName:e.lastName,studentDisplayId:e.studentDisplayId,lmsId:e.lmsId,avatar:{permanentUrl:e.avatarUrl},learnUser:Zn,email:e.email,advisors:e.advisors})))):o.resolve([])})).$allow([403]),o.promise}},Record:{learnUser:Zn}},$hooks:{"after-fetch":function(){Jn(this),this.courses.forEach((e=>{B.adjustEngagement(e,n)})),this.advisors&&this.advisors.forEach((e=>{e.learnUser=Zn}))},"after-fetch-many":function(){this.forEach((e=>{Jn(e),e.courses.forEach((e=>{B.adjustEngagement(e,n)})),e.advisors&&e.advisors.forEach((e=>{e.learnUser=Zn}))}))}}})}]);const Qn=we.Nb;Ie.a.factory(Qn,["restmod",Te.c,(e,t)=>{const n=ke.a.telemetryApiBasePath+"/v1/predict/permissions";return e.model(n).mix({$extend:{Model:{get(){return this.single(n).$fetch().$allow([403]).$asPromise()}}}})}]);const Xn=we.Kb;Ie.a.factory(Xn,["restmod","$q",(e,t)=>{const n=ke.a.telemetryApiBasePath+"/v1/predict/ftue",a=ke.a.telemetryApiBasePath+"/v1/predict/ftues";return e.model(n).mix({$extend:{Model:{setFtue(e){return this.$build().$send({method:"POST",url:this.$url()+"/"+e}).$asPromise()},delFtue(e){return this.$build().$send({method:"DELETE",url:this.$url()+"/"+e}).$asPromise()},delFtues(){return this.$build().$send({method:"DELETE",url:this.$url()}).$asPromise()},getFtue(e){const n=t.defer();return this.$build().$send({method:"GET",url:a,params:{timestamp:(new Date).getTime()}},(function(t){if(t&&t.data&&t.data.length){const a=t.data.filter((t=>t.componentKey===e));a&&a.length?n.resolve({key:a[0].componentKey,value:""}):n.resolve(null)}else n.resolve(null)})),n.promise},getFtues(){const e=t.defer();return this.$build().$send({method:"GET",url:a,params:{timestamp:(new Date).getTime()}},(function(t){if(t&&t.data&&t.data.length){const n=[];t.data.forEach((e=>{n.push({key:e.componentKey,value:""})})),n&&n.length?e.resolve(n):e.resolve(null)}else e.resolve(null)})),e.promise}}}})}]);const ea=we.Mb;Ie.a.factory(ea,["restmod","$q",Te.c,(e,t,n)=>{const a=ke.a.telemetryApiBasePath+"/v1/predict/notes";return e.model(a).mix({dateCreated:{serialize:"date"},dateModified:{serialize:"date"},isEdited:{mask:!0},isUndoing:{mask:!0},isAdding:{mask:!0},$extend:{Model:{getNotes(e,t){return(t=t||{}).timestamp=(new Date).getTime(),this.$collection(t,{$urlFor:()=>a+"/students/"+e}).$fetch(t).$allow([403]).$asPromise()},postNote(e,t){return this.$build().$send({method:"POST",url:a,data:{note:e,recipient:{recipientId:t.recipientId,email:t.email}}},(function(e){this.$unwrap(e.data)})).$asPromise()},updateNote(e,t){return this.$build().$send({method:"PUT",url:a,data:{noteId:e,note:t}},(function(e){return this.$unwrap(e.data)})).$asPromise()},deleteNote(e){return this.$build().$send({method:"DELETE",url:a+"/"+e},(function(e){this.$unwrap(e.data)})).$asPromise()},undoDeleteNote(e){return this.$build().$send({method:"PUT",url:`${a}/${e}`},(function(e){return e})).$asPromise()}}},$hooks:{"after-fetch-many":function(){this.forEach((e=>{Pe.isDefined(e.dateModified)?e.isEdited=e.dateCreated.getTime()<e.dateModified.getTime():e.isEdited=!1;const t=Object(pt.cloneDeep)(e.dateCreated);e.ui.dateCreated=t}))}}})}]);const ta=we.Ob;Ie.a.factory(ta,["restmod","$q",(e,t)=>{const n=ke.a.telemetryApiBasePath+"/v1/predict/preferences";return e.model(n).mix({$extend:{Model:{setPreference(e,t){const n={componentKey:e,preference:t};return this.$build().$send({method:"POST",url:this.$url(),data:n}).$allow([403]).$asPromise()},delPreference(e){return this.$build().$send({method:"DELETE",url:this.$url()+"/"+e}).$asPromise()},delPreferences(){return this.$build().$send({method:"DELETE",url:this.$url()}).$asPromise()},getPreference(e){const a=t.defer();return this.$build().$send({method:"GET",url:`${n}/${e}`,params:{timestamp:(new Date).getTime()}},(function(t){if(t&&t.data&&t.data.length){const n=t.data.filter((t=>t.componentKey===e));n&&n.length?a.resolve({componentKey:n[0].componentKey,value:n[0].value}):a.resolve(null)}else a.resolve(null)})).$allow([403]),a.promise},getPreferences(){const e=t.defer();return this.$build().$send({method:"GET",url:n,params:{timestamp:(new Date).getTime()}},(function(t){if(t&&t.data&&t.data.length){const n=[];t.data.forEach((e=>{n.push({componentKey:e.componentKey,preference:e.preference})})),n&&n.length?e.resolve(n):e.resolve([])}else e.resolve([])})).$allow([403]),e.promise}}}})}]);const na=we.Lb;Ie.a.factory(na,["restmod","$q",(e,t)=>{const n=ke.a.telemetryApiBasePath+"/v1/predict/preferences/config";return e.model(n).mix({$extend:{Model:{getInstitutionPreference(e){const a=t.defer();return this.$build().$send({method:"GET",url:`${n}/${e}`},(function(t){if(t&&t.data){const n=t.data;n.name===e?a.resolve(n):a.resolve(null)}else a.resolve(null)})).$allow([403]),a.promise}}}})}]);const aa=we.Hb;Ie.a.factory(aa,["restmod","$q",(e,t)=>{const n=ke.a.telemetryApiBasePath+"/v1/predict/customFieldSettings";return e.model(n).mix({$extend:{Model:{getCustomFieldSettings(){const e=t.defer();return this.$build().$send({method:"GET",url:n},(function(t){t&&t.data?e.resolve(t.data):e.resolve([])})),e.promise}}}})}]);const ia=we.Sb;Ie.a.factory(ia,["restmod",Te.c,e=>{const t=ke.a.apiBasePath+"/public/v1/system/policies/privacy";return e.model(t).mix({$extend:{Model:{getPrivacyPolicy(){return this.$build().$send({method:"GET",url:this.$url()},(function(e){return this.$unwrap(e.data)})).$asPromise()}}}})}]);const ra=we.Tb,sa="Respondus";Ie.a.factory(ra,["restmod","$ngRedux",(e,t)=>{const n=ke.a.apiBasePath+"/public/v1/proctoring/services";return e.model(n).mix({$hooks:{"after-fetch-many":function(e){const n=e.data.results;t.dispatch(St.V.proctoringServices.setProctoringServicesInStore(n))}}})}]);const oa=we.Wb;Ie.a.factory(oa,["restmod","$q",(e,t)=>{const n=ke.a.telemetryApiBasePath+"/v1/predict/courses/";return e.model(n).mix({$extend:{Model:{getRiskBucketDistribution(e){const a=t.defer();return this.$build().$send({method:"GET",url:`${n}${e}/riskBuckets`},(function(e){if(e&&e.data){const t=e.data;a.resolve(t)}else a.resolve(null)})).$allow([403]),a.promise}}}})}]);var la=n("XfOu");const ca=we.Yb;var da,ua;Ie.a.factory(ca,["restmod",Te.c,(e,t)=>e.model(ke.a.apiBasePath+"/v1/scheduledTasks").mix({$config:{primaryKey:"taskId"},startDate:{serialize:"date"},endDate:{serialize:"date"},isWaiting(){return qe.Ob.Waiting===this.taskStatus}})]),function(e){e.Sender="SENDER",e.Receiver="RECEIVER"}(da||(da={})),function(e){e.Completed="completed",e.InProgress="in_progress",e.Exempt="exempt",e.NeedsGrading="needs_grading"}(ua||(ua={}));const ma=we.ac;Ie.a.factory(ma,["restmod",Te.c,(e,t)=>{const n=ke.a.apiBasePath+"/v1/streams";return e.model(n).mix({$extend:{Collection:{$fetch:()=>{throw new Error("fetch StreamContent collection not supported")},$refresh:()=>{throw new Error("refresh StreamContent collection not supported")},$create:()=>{throw new Error("create StreamContent collection not supported")}},Record:{$fetch(e){return this.$decorate({"before-request":function(t){t.method="POST",t.data=e}},(function(){return this.$super()}))},$resolve:()=>{throw new Error("resolve StreamContent not supported")},$save:()=>{throw new Error("save StreamContent not supported")},$destroy:()=>{throw new Error("destroy StreamContent not supported")}}},$hooks:{"before-request":e=>{e.timeout=3e4,e.headers={"Suppress-Session-Timestamp-Update":!0}}}})}]);const pa=we.cc;Ie.a.factory(pa,["restmod",Te.c,(e,t)=>e.model().mix({now:{serialize:"date"},$url:()=>ke.a.apiBasePath+"/v1/utilities/systemInfo",$extend:{Record:{getLegacyToolUrl(e){if(e in this.classicUrls)return ze.c(this.classicUrls[e]);throw new Error("Key "+e+" is not found in systemInfo.classicUrls")}}}})]);const ha=we.dc;Ie.a.factory(ha,["restmod",Te.c,(e,t)=>{const n=ke.a.apiBasePath+"/v1/systemPreferences";return e.model(n).mix({$config:{primaryKey:"key"}})}]);n("DH9M");const ga=we.fc;function ba(e){return e/60}Ie.a.factory(ga,["restmod",e=>e.model().mix({$config:{primaryKey:"courseId"},$url(){return ke.a.apiBasePath+"/v1/courses/"+this.$pk+"/telemetry/reports/activityVsGrade"},$hooks:{"after-fetch":function(){this.data.forEach((e=>e.activity=ba(e.activity)))}}})]);const fa=we.gc;Ie.a.factory(fa,["restmod",e=>{const t=ke.a.apiBasePath+"/v1";return e.model(t).mix({$config:{primaryKey:"contentId"},available:{serialize:"date"},firstOpened:{serialize:"date"},firstSave:{serialize:"date"},lastSave:{serialize:"date"},startedTime:{serialize:"date"},"submissions[].date":{serialize:"date"},$extend:{Collection:{getContentActivityInDetail(e,t){return this.$collection().$send({method:"GET",url:this.$url()+"/courses/"+e+"/contents/"+t+"/telemetry/reports/studentContentActivityInDetail"},(function(e){this.$unwrap(e.data)}))}},Record:{containsInvalidData(){return this.ui&&this.ui.containsInvalidData||!1}}}})}]);const va=e=>{const t=new Date(e);return new Date(t.getTime()+60*t.getTimezoneOffset()*1e3)},ya=we.hc;Ie.a.factory(ya,["restmod",e=>e.model().mix({$config:{primaryKey:"courseId"},$url(){return ke.a.apiBasePath+"/v1/courses/"+this.$pk+"/telemetry/reports/courseActivity"},$hooks:{"after-fetch":function(){this.courseActivity.forEach((e=>{e.date=va(e.date),e.activity=ba(e.activity),e.minScore=ba(e.minScore),e.maxScore=ba(e.maxScore),e.stdDev=ba(e.stdDev)}))}}})]);const Sa=we.jc;Ie.a.factory(Sa,["restmod",e=>e.model().mix({$config:{primaryKey:"courseId"},"currentStudent[].created":{serialize:"date"},"currentStudent[].dismissed":{serialize:"date"},$url(){return ke.a.apiBasePath+"/v1/courses/"+this.$pk+"/telemetry/notifications"}})]);const Ca=we.ic;Ie.a.factory(Ca,["restmod",e=>e.model().mix({$config:{primaryKey:"courseId"},$url(){return ke.a.apiBasePath+"/v1/courses/"+this.$pk+"/telemetry/reports/courseGrades"},$hooks:{"after-fetch":function(){this.courseGrades.forEach((e=>{e.date=va(e.date)}))}}})]);const Ea=we.kc;Ie.a.factory(Ea,["restmod",e=>{const t=ke.a.apiBasePath+"/v1";return e.model(t).mix({$extend:{Model:{getDiscussionActivityReport(e,t,n){const a=n?this.$url()+"/courses/"+e+"/contents/"+t+"/telemetry/reports/discussionActivity?groupId="+n:this.$url()+"/courses/"+e+"/contents/"+t+"/telemetry/reports/discussionActivity";return this.$build().$send({method:"GET",url:a},(function(e){this.$unwrap(e.data)}))}}}})}]);const Ia=we.lc;Ie.a.factory(Ia,["restmod",e=>{const t=ke.a.apiBasePath+"/v1";return e.model(t).mix({$extend:{Model:{getDiscussionXrayReport(e,t,n){return this.$build().$send({method:"GET",url:this.$url()+"/courses/"+e+"/contents/"+t+"/telemetry/reports/discussionActivityScore/"+n},(function(e){this.$unwrap(e.data)}))}}},modifyDate:{serialize:"date"}})}]);const ka=we.mc;Ie.a.factory(ka,["restmod",e=>{const t=ke.a.apiBasePath+"/v1";return e.model(t).mix({lastOpened:{serialize:"date"},$extend:{Collection:{getMultimediaActivityInDetail(e,t){return this.$collection().$send({method:"GET",url:this.$url()+"/courses/"+e+"/contents/"+t+"/telemetry/reports/studentMultimediaActivityInDetail"},(function(e){this.$unwrap(e.data)}))}}}})}]);const wa=we.nc;Ie.a.factory(wa,["restmod",e=>{const t=ke.a.apiBasePath+"/v1";return e.model(t).mix({$extend:{Model:{getMultimediaStatistics(e,t){return this.$build().$send({method:"GET",url:this.$url()+"/courses/"+e+"/contents/"+t+"/telemetry/reports/studentMultimediaStatistics"},(function(e){this.$unwrap(e.data)}))}}}})}]);const Ta=we.oc;Ie.a.factory(Ta,["restmod",Te.c,e=>e.model(ke.a.apiBasePath+"/v1/telemetry/notifications")]);const Oa=we.pc;Ie.a.factory(Oa,["restmod",Te.c,e=>e.model().mix({$config:{primaryKey:"notificationId"},$url(){return ke.a.apiBasePath+"/v1/telemetry/notifications/"+this.$pk+"/users"}})]);const Aa=we.qc;Ie.a.factory(Aa,["restmod",e=>e.model().mix({$config:{primaryKey:"courseId"},$url(){return ke.a.apiBasePath+"/v1/courses/"+this.$pk+"/telemetry/reports/studentActivity"},$hooks:{"after-fetch":function(){this.studentActivity.forEach((e=>{e.date=va(e.date),e.activity=ba(e.activity)}))}}})]);const Pa=we.rc;Ie.a.factory(Pa,["restmod",e=>e.model().mix({$config:{primaryKey:"courseId"},$url(){return ke.a.apiBasePath+"/v1/courses/"+this.$pk+"/telemetry/reports/studentGrades"},$hooks:{"after-fetch":function(){this.studentGrades.forEach((e=>{e.date=va(e.date)}))}}})]);const xa=we.sc;Ie.a.factory(xa,["restmod",Te.c,e=>e.model().mix({$url:()=>ke.a.apiBasePath+"/v1/telemetry/courses?filter=sufficientData"})]);var $a,Na=n("KiLF");!function(e){e.CurrentTerm="current",e.UpcomingTerm="upcoming"}($a||($a={}));const Da=we.tc;Ie.a.factory(Da,["restmod",Te.c,(e,t)=>e.model(ke.a.apiBasePath+"/v1/terms").mix({startDate:{serialize:"date"},endDate:{serialize:"date"}})]);var La=n("/J7e");const ja=we.uc,Ma="UltraUI.";Ie.a.factory(ja,["restmod",Te.c,(e,t)=>{const n=ke.a.apiBasePath+"/v1/themes";return e.model(n).mix({ui:{mask:!0},getUsePrimaryColorOnAllBaseNav(){return La.a(this.ui.usePrimaryColorOnAllBaseNav)},setUsePrimaryColorOnAllBaseNav(e){this.ui.usePrimaryColorOnAllBaseNav=La.a(e)?"true":"false"},getUsePrimaryColorOnLogoBackground(){return La.a(this.ui.usePrimaryColorOnLogoBackground)},setUsePrimaryColorOnLogoBackground(e){this.ui.usePrimaryColorOnLogoBackground=La.a(e)?"true":"false"},$config:{primaryKey:"themeId"},$extend:{Record:{$fetch(){return this.$decorate({"before-request":function(e){e.url=n+`/${this.$pk.themeId}/settings`}},(function(){return this.$super()}))},$save(){return this.$decorate({"before-request":function(e){this.settings=[],Object.keys(this.ui).forEach((e=>{this.settings.push({key:Ma+e,value:this.ui[e]})})),e.url=n+`/${this.$pk.themeId}/settings`,e.data.settings=this.settings}},(function(){return this.$super()}))}},Model:{getDefault(){return this.$new({themeId:"default"}).$fetch()}}},$hooks:{"after-feed":function(){this.settings.forEach((e=>{if(e&&e.key){const t=e.key.replace(Ma,"");this.ui[t]=e.value}}))}}})}]);const Ga=we.wc;Ie.a.factory(Ga,["restmod",e=>e.model().mix({$extend:{Collection:{getToolById(e){return pt.find(this,["identifier",e])},isToolAvailable(e){return this.$build().$send({method:"GET",url:`${this.$url()}/${e}`}).$allow([403]).$asPromise().then((e=>{var t;return!(!e.$response.data||!(null===(t=e.$response.data.toolEnabledSetting)||void 0===t?void 0:t.isAvailable))}))}}}})]);const Ra=we.Zb;Ie.a.factory(Ra,["restmod",e=>e.model().mix({isTinCan(){return!(!this.learningStandard||it.ScormLearningStandard.TINCAN!==this.learningStandard)}})]);const Ba=we.vc;Ie.a.factory(Ba,["restmod",Te.c,(e,t)=>e.model(ke.a.apiBasePath+"/v1/tools")]);const Fa=we.bc;Ie.a.factory(Fa,["restmod",Te.c,(e,t)=>e.model().mix({$hooks:{"after-destroy":function(){this.previewing=!1,this.user=null}}})]);const Ua=we.xc;Ie.a.factory(Ua,["restmod",Te.c,(e,t)=>{const n=ke.a.apiBasePath+"/v1/trial/supportTickets";return e.model(n)}]);const _a=we.yc;Ie.a.factory(_a,["restmod",Te.c,(e,t)=>e.model().mix({})]),n.d(t,"N",(function(){return za})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return Fe})),n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return o})),n.d(t,"g",(function(){return Ve})),n.d(t,"l",(function(){return We})),n.d(t,"x",(function(){return l})),n.d(t,"m",(function(){return Qe})),n.d(t,"n",(function(){return c})),n.d(t,"p",(function(){return it})),n.d(t,"o",(function(){return d})),n.d(t,"s",(function(){return u})),n.d(t,"v",(function(){return dt})),n.d(t,"q",(function(){return m})),n.d(t,"r",(function(){return p})),n.d(t,"t",(function(){return h})),n.d(t,"u",(function(){return g})),n.d(t,"w",(function(){return Pt})),n.d(t,"h",(function(){return b})),n.d(t,"i",(function(){return f})),n.d(t,"j",(function(){return v})),n.d(t,"y",(function(){return y})),n.d(t,"z",(function(){return S})),n.d(t,"A",(function(){return Vt})),n.d(t,"E",(function(){return C})),n.d(t,"C",(function(){return Xt})),n.d(t,"k",(function(){return E})),n.d(t,"D",(function(){return an})),n.d(t,"F",(function(){return I})),n.d(t,"B",(function(){return k})),n.d(t,"G",(function(){return w})),n.d(t,"H",(function(){return T})),n.d(t,"I",(function(){return O})),n.d(t,"J",(function(){return A})),n.d(t,"K",(function(){return P})),n.d(t,"M",(function(){return x})),n.d(t,"L",(function(){return $})),n.d(t,"O",(function(){return N})),n.d(t,"P",(function(){return On})),n.d(t,"Q",(function(){return D})),n.d(t,"R",(function(){return L})),n.d(t,"V",(function(){return j})),n.d(t,"T",(function(){return M})),n.d(t,"S",(function(){return G})),n.d(t,"U",(function(){return R})),n.d(t,"W",(function(){return B})),n.d(t,"X",(function(){return F})),n.d(t,"ab",(function(){return U})),n.d(t,"gb",(function(){return _})),n.d(t,"ib",(function(){return z})),n.d(t,"Z",(function(){return q})),n.d(t,"hb",(function(){return H})),n.d(t,"eb",(function(){return V})),n.d(t,"bb",(function(){return W})),n.d(t,"db",(function(){return K})),n.d(t,"fb",(function(){return Y})),n.d(t,"cb",(function(){return J})),n.d(t,"Y",(function(){return Z})),n.d(t,"jb",(function(){return Q})),n.d(t,"kb",(function(){return X})),n.d(t,"lb",(function(){return ee})),n.d(t,"mb",(function(){return la})),n.d(t,"nb",(function(){return te})),n.d(t,"ob",(function(){return ne})),n.d(t,"pb",(function(){return ae})),n.d(t,"qb",(function(){return ie})),n.d(t,"sb",(function(){return re})),n.d(t,"tb",(function(){return se})),n.d(t,"ub",(function(){return oe})),n.d(t,"wb",(function(){return le})),n.d(t,"vb",(function(){return ce})),n.d(t,"xb",(function(){return de})),n.d(t,"yb",(function(){return ue})),n.d(t,"zb",(function(){return me})),n.d(t,"Ab",(function(){return pe})),n.d(t,"Bb",(function(){return he})),n.d(t,"Cb",(function(){return ge})),n.d(t,"Db",(function(){return be})),n.d(t,"Eb",(function(){return fe})),n.d(t,"Fb",(function(){return ve})),n.d(t,"Gb",(function(){return ye})),n.d(t,"Hb",(function(){return Se})),n.d(t,"rb",(function(){return Ce})),n.d(t,"Ib",(function(){return Ee})),n.d(t,"Jb",(function(){return gt}));const za=Ie.a.name},pqmn:function(e,t,n){"use strict";var a=n("nbDY"),i=n.n(a);class r extends i.a{}r.ROOT=new r("ROOT"),r.INTERACTIVE=new r("INTERACTIVE"),r.INDIRECT=new r("INDIRECT"),t.a=r},"q/wk":function(e,t,n){"use strict";var a=n("td+C"),i=n("adx1"),r=n("oPIA"),s=n("v6Sp"),o=n("x9Ok"),l=n("TWlR");class c extends i.a{constructor(e,t,n){super(),this.integrationService=e,this.routeListenerService=t,this.createMessenger=n,this.updateRoute=e=>{this.currentRoute=e},this.registerAsHelpProvider=(e,t)=>{const n=s.c.getHelpProvider(e.id);if(!e.id||n)return n?console.warn(`Cannot register provider: Provider already exists with an id of ${e.id}`):console.warn("Cannot register provider: no id was specified"),void this.integrationService.sendMessage({type:r.l,id:e.id,status:r.p.Failure},t);const a={iconUrl:e.iconUrl,providerId:e.id,providerType:e.providerType,integrationId:t.id,displayName:e.displayName};s.c.addHelpProvider(a),this.integrationService.sendMessage({type:r.l,id:e.id,status:r.p.Success,iconUrl:e.iconUrl},t);const i=s.c.getProviderByType(r.n.Auxiliary),o=s.c.getProviderByType(r.n.Primary);this.$emitEvent(this.helpChangedEvent,{auxiliaryProviders:i,primaryProviders:o})},this.helpChangedEvent="helpChanged",this.routeListenerService.subscribe(this.updateRoute)}init(){this.integrationService.addIntegrationMessageType(r.l,this.registerAsHelpProvider),this.helpRequestMessenger=this.createMessenger(r.m,{includeProcessingEvent:!1})}async sendHelp(e,t){await this.helpRequestMessenger.sendMessage({type:r.i,eventType:r.m,helpUrl:t,currentRouteName:this.currentRoute},e)}}t.a=new c(a.a,o.b,l.a)},q4pc:function(e,t){e.exports='<bb-modal id="notification-modal-api-error"\n          class="notification"\n          modal-title-key="components.services.error-modal.error-too-long.title"\n          analytics-id-tag-prefix="components.services.error-modal.error-too-long">\n  <div name="modal-contents">\n    <p bb-translate>components.services.error-modal.error-too-long.description</p>\n    <bb-session-debug-modal-button></bb-session-debug-modal-button>\n  </div>\n  <button name="modal-footer-button-primary"\n          ng-click="$parent.$dismiss()"\n          class="button js-primary-button"\n          analytics-id="components.services.error-modal.dismiss"\n          bb-translate>components.services.error-modal.dismiss</button>\n</bb-modal>\n'},qOsI:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));n("PCGa");var a=n("Llzl"),i=n("0JpG"),r=n("TnpK"),s=n("nmzr");const o="ultra.base.calendar.routes";a.module(o,[i.moduleName,r.b]).config([r.c,e=>{e.peekState(s.f.CALENDAR_SETTINGS,{url:"/settings",resolve:{translations:[i.serviceName,e=>e.loadBundle("features/base/calendar/base-calendar")]},require:()=>n.e(686).then(n.bind(null,"OHPy")),pageTitle:"base.calendar.settings.title"}).peekState(s.f.CREATE_EVENT,{url:"/event/create?selectedDate?calendarId",resolve:{translations:["$q",i.serviceName,(e,t)=>e.all([t.loadBundle("features/base/calendar/base-calendar"),t.loadBundle("components/directives/panel-header"),t.loadBundle("components/directives/close-without-saving-modal")])]},onExit:["$rootScope",e=>{e.$broadcast("calendar-refresh")}],require:()=>Promise.all([n.e(1),n.e(2),n.e(40),n.e(36),n.e(46),n.e(55),n.e(88)]).then(n.bind(null,"V4Gf")),pageTitle:"base.calendar.create.addEvent"}).peekState(s.f.EDIT_EVENT,{url:"/event/edit/:calendarId/:itemSourceType/:itemSourceId?updateSeries&repeatRuleType&repeatRuleCourseId&repeatRuleUserId",resolve:{translations:["$q",i.serviceName,(e,t)=>e.all([t.loadBundle("features/base/calendar/base-calendar"),t.loadBundle("components/directives/panel-header"),t.loadBundle("components/directives/close-without-saving-modal")])]},onExit:["$rootScope",e=>{e.$broadcast("calendar-refresh")}],require:()=>Promise.all([n.e(1),n.e(2),n.e(40),n.e(36),n.e(46),n.e(55),n.e(88)]).then(n.bind(null,"V4Gf")),pageTitle:"base.calendar.create.editEvent"}).peekState(s.f.VIEW_EVENT,{url:"/event/view/:calendarId/:itemSourceType/:itemSourceId?repeatRuleType&repeatRuleCourseId&repeatRuleUserId",resolve:{translations:[i.serviceName,e=>e.loadBundle("features/base/calendar/base-calendar")]},require:()=>Promise.all([n.e(1),n.e(2),n.e(36),n.e(641)]).then(n.bind(null,"dWqS")),pageTitle:"base.calendar.create.viewEvent"}).peekState(s.f.COURSE_SCHEDULE,{url:"/class-schedule?selectedDate&courseId",resolve:{translations:[i.serviceName,e=>e.loadBundle("features/base/calendar/base-calendar")]},onExit:["$rootScope",e=>{e.$broadcast("calendar-refresh")}],require:()=>Promise.all([n.e(0),n.e(36),n.e(55),n.e(648)]).then(n.bind(null,"TayV")),pageTitle:"base.calendar.schedule.classSchedule"}).peekState(s.f.OFFICE_HOURS,{url:"/office-hours?selectedDate?calendarId",resolve:{translations:["$q",i.serviceName,(e,t)=>e.all([t.loadBundle("features/base/calendar/base-calendar"),t.loadBundle("components/directives/panel-header"),t.loadBundle("components/directives/close-without-saving-modal")])]},onExit:["$rootScope",e=>{e.$broadcast("calendar-refresh")}],require:()=>Promise.all([n.e(1),n.e(2),n.e(40),n.e(36),n.e(46),n.e(55),n.e(88)]).then(n.bind(null,"V4Gf")),pageTitle:"base.calendar.addOfficeHours"})}])},qZC8:function(e,t){e.exports='<bb-modal class="notification"\n          modal-title-key="course.placements.inlineGradableModalTitle"\n          analytics-id-tag-prefix="course.placements.basePlacement">\n  <div name="modal-contents">\n    <p bb-translate>course.placements.inlineGradableSupport</p>\n  </div>\n  \x3c!-- htmlhint:analytics-id:disable --\x3e\n  <button name="modal-footer-button-primary"\n          ng-click="dismissCallback()"\n          class="button js-primary-button"\n          bb-translate\n          analytics-id="course.placements.basePlacement.ok.button">\n    global.ok\n  </button>\n  \x3c!-- htmlhint:analytics-id:enable --\x3e\n</bb-modal>'},qhd3:function(e,t,n){"use strict";n.r(t),n.d(t,"sortCompareUsers",(function(){return m})),n.d(t,"serviceName",(function(){return p})),n.d(t,"USER_API_PATH",(function(){return h}));n("QLzv");var a=n("nsO7"),i=n("Llzl"),r=n("5MwF"),s=n("Rjd/"),o=n("yCC5"),l=n("nkTj"),c=n("g66W"),d=n("cYWG"),u=n("zGdY");function m(e,t){if(!e&&!t)return 0;if(e&&!t)return-1;if(!e&&t)return 1;if(e&&t){if(e.familyName&&!t.familyName)return-1;if(!e.familyName&&t.familyName)return 1;if((e.familyName||t.familyName)&&e.familyName!==t.familyName)return e.familyName&&t.familyName?e.familyName.localeCompare(t.familyName):0;if(!e.givenName&&!t.givenName)return 0;if(e.givenName&&!t.givenName)return-1;if(!e.givenName&&t.givenName)return 1;if(!e.givenName&&!t.givenName||e.givenName===t.givenName){if(e.userName&&!t.userName)return-1;if(!e.userName&&t.userName)return 1;if(!e.userName&&!t.userName)return 0;if(e.userName&&t.userName)return e.userName.localeCompare(t.userName)}else if(e.givenName&&t.givenName)return e.givenName.localeCompare(t.givenName)}return 0}const p=o.zc,h=r.a.apiBasePath+"/v1/users";s.a.factory(p,["$http","restmod","$q",l.c,(e,t,n,r)=>{const s=t.model(h).mix({calendarItems:{hasMany:o.Eb},memberships:{hasMany:o.N,hooks:{"before-fetch-many":function(t){t.params=t.params||{},a.isUndefined(t.params.includeCount)&&(t.params.includeCount=!0);const n=t.params.limit,r=t.params.offset,s=(t,a,o)=>e.get(t,{params:a}).then((e=>{if(!(e&&200===e.status&&e.data&&e.data.results&&e.data.paging))return e;o=o||[];const a=e.data.results,l=e.data.paging;if(!((o=o.concat(a)).length>=n||a.length<l.limit)){const a=i.extend(i.copy(e.config.params),{offset:(r||0)+o.length});return o.length<n&&(a.limit=n-o.length),delete a.includeCount,s(t,a,o)}return e.data.results=o,e.data.paging.limit=n,e.data.paging.offset=r,e}));t.cache={get:()=>s(t.url,t.params)}}}},blocks:{hasMany:o.h},birthDate:{encode:e=>new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0)),decode:e=>{const t=new Date(e);return new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),0,0,0,0)}},isGuest(){return Array.isArray(this.systemRoles)&&this.systemRoles[0]===u.X.Guest},isAnonymousStudent(){return this.ui&&this.ui.anonymousStudent},isInstructor(){return this.memberships.some((e=>e.isActAsInstructorMembership()))},isStudent(){return this.memberships.some((e=>e.isStudentMembership()))},getInitials(){if(this.givenName&&this.familyName&&!c.g(this.givenName)&&!c.g(this.familyName)&&!c.h(this.givenName)&&!c.h(this.familyName))return(""+this.givenName.charAt(0)+this.familyName.charAt(0)).toLowerCase()},$extend:{Collection:{batchGetCollection(e){const t=n.defer();return this.$collection().$send({method:"PUT",url:this.$url(),data:e},(e=>{t.resolve(e.data)}),(e=>{t.reject(e)})),t.promise}}}});return s.getUserConfiguration=function(){const e=n.defer();return this.$collection().$send({method:"GET",url:this.$url()+"/fieldsConfiguration",params:{visibleOnly:!0,[d.a]:Number.MAX_VALUE}},(t=>{e.resolve(t.data)}),(t=>{e.reject(t)})),e.promise},s.mixinUsers=r.getDataMixin(((e,t)=>s.findMany(e,t,[404])),"userId","user"),s.getAnonymousStudent=e=>s.$build({id:e,familyName:"",givenName:"",ui:{anonymousStudent:!0,anonymousStudentId:e}}),s}])},qiBf:function(e,t,n){"use strict";var a=n("ERkP"),i=n.n(a),r=n("SToD"),s=n("Oa+x"),o=n("np6O"),l=n("4vxQ"),c=n("/n7R"),d=n("Agfx");const u=Object(d.makeStyles)((e=>Object(d.createStyles)({sessionDebugButton:{width:"100%","& input":{borderWidth:"0px",marginBottom:"0px"},"& .copyButton":{minWidth:"0px",paddingLeft:"10px"}},errorText:{color:e.palette.error.main,fontSize:e.typography.fontSizeSmall,textAlign:"left"}})));var m=n("uDfI"),p=n("IbyE");var h=n("GIU+");var g=n("mMhX"),b=n("w8C8");const f=Object(d.makeStyles)((e=>Object(d.createStyles)({checkmark:{color:e.palette.success.main}}))),v=e=>{const{isTextCopied:t}=e,n=f().checkmark;return t?a.createElement(g.Check,{className:n}):a.createElement(b.a,null)};var y=n("7O4Y"),S=n("zGdY");n.d(t,"a",(function(){return C}));const C=Object(r.a)((e=>{const{ariaDescribedby:t,sessionDebug:n,localize:r}=e,{translate:d}=r,{sessionDebugButton:g,errorText:b}=u(),{submitSessionDebug:f,isUpdating:C,logCode:E,submissionErrorCode:I}=(()=>{const e=Object(m.d)();Object(a.useEffect)((()=>{e(p.V.sessionDebug.resetSessionDebugState())}),[e]);const t=Object(m.e)(p.Yb.sessionDebug.isUpdating),n=Object(m.e)(p.Yb.sessionDebug.getLogCode),i=Object(m.e)(p.Yb.sessionDebug.getSubmissionErrorCode);return{submitSessionDebug:Object(a.useCallback)((t=>{e(p.V.sessionDebug.submitSessionDebug(t))}),[e]),isUpdating:t,logCode:n,submissionErrorCode:i}})(),[k,w]=(()=>{const[e,t]=Object(a.useState)(!1);return[e,Object(a.useCallback)((e=>{Object(h.a)(e),t(!0)}),[]),Object(a.useCallback)((()=>{t(!1)}),[])]})();const T=i.a.createElement(c.AnalyticsTooltip,{analyticsId:"supportPanel.sessionDebug.codeCopied.tooltip",title:d("supportPanel.sessionDebug.codeCopiedTooltipText"),placement:"top-end",PopperProps:{style:{zIndex:1000100},open:k}},i.a.createElement(o.AnalyticsIconButton,{className:"copyButton",analyticsId:"supportPanel.sessionDebug.copyLogCode.button",onClick:()=>w(E),"aria-label":d(k?"supportPanel.sessionDebug.codeCopiedButtonAriaLabel":"supportPanel.sessionDebug.copyCodeButtonAriaLabel",{logCode:E})},i.a.createElement(v,{isTextCopied:k})));return E?i.a.createElement(l.a,{className:g,analyticsId:"supportPanel.sessionDebug.logCode.textDisplay",disabled:!0,InputProps:{endAdornment:T},value:E}):i.a.createElement(i.a.Fragment,null,i.a.createElement(s.a,{"aria-describedby":t,className:g,analyticsId:"supportPanel.sessionDebug.submit.button",onClick:()=>f(n),disabled:C||I>0},d("supportPanel.sessionDebug.submissionButtonText")),I>0&&i.a.createElement("p",{className:Object(y.a)(b,"js-error-text")},d(I===S.S.TooManyRequests?"supportPanel.sessionDebug.submissionQuotaText":"supportPanel.sessionDebug.submissionErrorText")))}))},qtHE:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n("Llzl"),i=n("Sa5G"),r=n("wQOJ"),s=n("TnpK");const o="ultra.base.institution-page.routes";a.module(o,[s.b]).config([s.c,e=>{e.peekState("allLinks",{url:"/all?moduleId",require:()=>Promise.all([n.e(3),n.e(35),n.e(37),n.e(757)]).then(n.bind(null,"Dovs")),pageTitle:"base.nav.institutionPage",resolve:{IP:[r.b,s.d,(e,t)=>{const n=t.nextParams;return e.getModuleIsVisible(n.moduleId).then((e=>{if(!e)return t.goToRoute("base.institution-page")}))}]}}).peekState("editPageImage",{systemEntitlement:i.t.ModifyPortalOptionsModuleManagement,url:"/editPage?type",require:()=>Promise.all([n.e(3),n.e(35),n.e(37),n.e(657)]).then(n.bind(null,"JKPj")),pageTitle:"base.nav.institutionPage",peekStates:["contentCollection","browserSettings"],allowChildPeekStates:!0,peekViewName:"edit-page-image-peek"}).peekState("editModule",{systemEntitlement:i.t.ModifyPortalOptionsModuleManagement,url:"/edit?moduleId&expandRoles",panelClass:"full",require:()=>Promise.all([n.e(3),n.e(35),n.e(37),n.e(747)]).then(n.bind(null,"axDv")),peekStates:["linkImage","system-content-market"],pageTitle:"base.nav.institutionPage"}).peekState("createModule",{systemEntitlement:i.t.CreatePortalOptionsModuleManagement,url:"/create?type&sequence",panelClass:"full",require:()=>Promise.all([n.e(3),n.e(35),n.e(37),n.e(746)]).then(n.bind(null,"57Mq")),peekStates:["linkImage","system-content-market"],pageTitle:"base.nav.institutionPage"}).peekState("linkImage",{systemEntitlement:i.t.ModifyPortalOptionsModuleManagement,url:"/linkImage?linkId",require:()=>Promise.all([n.e(3),n.e(35),n.e(37),n.e(658)]).then(n.bind(null,"kHrt")),pageTitle:"base.nav.institutionPage",peekStates:["contentCollection","browserSettings"],allowChildPeekStates:!0,peekViewName:"edit-link-image-peek"}).peekState("contentCollection",{systemEntitlement:i.t.ModifyPortalOptionsModuleManagement,url:"/contentCollection",require:()=>n.e(649).then(n.bind(null,"HgOS")),pageTitle:"base.nav.institutionPage",panelClass:"full",peekViewName:"ip-content-collection-peek"}).peekState("browserSettings",{systemEntitlement:i.t.ModifyPortalOptionsModuleManagement,url:"/browserSettings",require:()=>n.e(704).then(n.bind(null,"usdo")),pageTitle:"base.nav.institutionPage",panelClass:"peek"})}])},rEGj:function(e,t,n){"use strict";n.r(t)},rEZX:function(e,t,n){"use strict";var a=n("zGdY");var i=class{constructor(e,t){(null==t?void 0:t.scaleType)===a.Ub.Text?this.isNumeric=!1:this.isNumeric=!Number.isNaN(parseFloat(e)),this.grade=e}getGrade(){return this.grade}};t.a=class{constructor(e,t,n){this.column=e,this.courseId=e.courseId,this.gradeValue=new i(t,n)}}},rmtn:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n("Llzl"),i=n("Sa5G"),r=n("0JpG"),s=n("TnpK");const o="ultra.base.admin.brand.routes";a.module(o,[r.moduleName,s.b]).config([s.c,e=>{e.peekState("brands",{panelClass:"full",allowChildPeekStates:!0,url:"/brands",systemEntitlement:i.s.ViewBrands,require:()=>Promise.all([n.e(3),n.e(35),n.e(62),n.e(37),n.e(63),n.e(753)]).then(n.bind(null,"olMq")),pageTitle:"base.admin.branding.brandList.title",peekStates:["create-brand","brand-detail","modify-custom-css"]}).peekState("modify-custom-css",{panelClass:"full",allowChildPeekStates:!0,url:"/custom-css/modify",systemEntitlement:i.s.ModifyCustomCss,require:()=>n.e(702).then(n.bind(null,"uGYO")),pageTitle:"base.admin.branding.addCustomCSS.title"}).peekState("create-brand",{panelClass:"full",allowChildPeekStates:!0,url:"/create",systemEntitlement:i.s.CreateBrand,require:()=>Promise.all([n.e(3),n.e(35),n.e(62),n.e(37),n.e(63),n.e(182)]).then(n.bind(null,"3ay5")),pageTitle:"base.admin.branding.createBrand.title",peekStates:["colorSelection"]}).peekState("brand-detail",{panelClass:"full",allowChildPeekStates:!0,url:"/brand/:brandId",systemEntitlement:i.s.ViewBrands,require:()=>Promise.all([n.e(3),n.e(35),n.e(62),n.e(37),n.e(63),n.e(182)]).then(n.bind(null,"3ay5")),pageTitle:"base.admin.branding.brandDetails.title",peekStates:["colorSelection"]})}])},rxY8:function(e,t,n){"use strict";var a=n("71td"),i=n("nsO7");class r{constructor(e,t){this.element=e,this.settings=t,this.nextFrame=i.throttle((()=>{window.requestAnimationFrame((()=>{e.setAttribute("keyframe",this.state+"-"+("00"+(this.frame=Math.min(this.frame+1,20))).substr(-2)),this.frame<20?this.nextFrame():(this[this.state+"Callback"]||this.settings[this.state+"Callback"]||a.noop)()}))}),50),this.settings=a.extend({successCallback:a.noop,errorCallback:a.noop,canvasSize:54},t),a(e).width(this.settings.canvasSize).height(this.settings.canvasSize)}start(){this.state="start",this.frame=1,this.startCallback=a.noop,this.nextFrame()}loadComplete(){this.afterWaiting((()=>{this.state="success",this.frame=1,this.nextFrame()}))}loadError(){this.afterWaiting((()=>{this.state="error",this.frame=1,this.nextFrame()}))}reset(){this.state="reset",this.frame=20,this.nextFrame()}afterWaiting(e){"start"===this.state&&20===this.frame||"reset"===this.state?e():this.startCallback=()=>{e(),this.startCallback=null}}}a.fn.inlineLoader=function(e){return this.addClass("xloader2").each((function(){this.InlineLoader=new r(this,e)})),this};var s=n("Llzl");n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return l}));const o="ultra.components.services.spinner",l="spinner";class c{constructor(e){this.$rootScope=e}initInlineLoader(e,t){return e.inlineLoader(t),new d(e,this.$rootScope)}}c.$inject=["$rootScope"];class d{constructor(e,t){this.element=e,this.$rootScope=t}start(){this.element[0].InlineLoader.start()}complete(){this.element[0].InlineLoader.loadComplete()}error(){this.element[0].InlineLoader.loadError()}reset(){this.element[0].InlineLoader.reset()}animate(e){this.start(),e.then((()=>{this.complete()}),(()=>{this.error()}))}}s.module(o,[]).service(l,c)},sNuB:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));n("JzsJ");var a=n("Llzl"),i=n("0JpG"),r=n("TnpK");const s="ultra.course.goal-alignment.router";a.module(s,[r.b]).config([r.c,e=>{e.peekState("goal-picker-legacy",{panelClass:"full",url:"/goalPickerLegacy",resolve:{translations:[i.serviceName,e=>e.loadBundle("features/course/goal-alignment/goal")]},require:()=>n.e(653).then(n.bind(null,"8MxD")),pageTitle:"course.goal-alignment.goal.header",params:{goalAlignableContent:null}})}])},"sb+l":function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n("Llzl"),i=n("Sa5G"),r=n("0JpG"),s=n("w9Zy"),o=n("jhBu"),l=n("pjml"),c=n("TnpK");const d="ultra.base.stream.routes";a.module(d,[r.moduleName,s.d,o.a,l.N,c.b]).config([c.c,e=>{e.peekState("announcement",{url:"/announcement/:streamEntryId",require:()=>Promise.all([n.e(40),n.e(46),n.e(613)]).then(n.bind(null,"/Lzo")),pageTitle:"base.stream.entryTitle.announcement"}).peekState("stream-message",{url:"/message/:courseId/:conversationId",require:()=>Promise.all([n.e(49),n.e(51),n.e(605)]).then(n.bind(null,"yVjE")),pageTitle:"base.stream.entryTitle.message"}).peekState("content-group",{url:"/content/:streamEntryId",require:()=>Promise.all([n.e(8),n.e(40),n.e(46),n.e(674)]).then(n.bind(null,"G506")),resolve:{translations:[r.serviceName,e=>e.loadBundle("features/base/stream/content/content")]},pageTitle:"base.stream.content.pageTitle"}).peekState("notification-create",{abstract:!0,url:"/notification",resolve:{translations:[r.serviceName,e=>e.loadBundle("features/base/stream/notification")],isAdmin:[o.b,e=>e.hasSystemEntitlement(i.s.ViewAdminTop).then((e=>e))]},panelClass:"full",require:()=>n.e(620).then(n.bind(null,"s7sT")),pageTitle:"base.stream.notification.create.pageTitle"}).peekState("notification-create.steps",{url:"/create",panelClass:"full",pageTitle:"base.stream.notification.create.pageTitle",views:{"notification-step1@":{require:()=>n.e(152).then(n.bind(null,"At0Z"))},"notification-step2@":{require:()=>n.e(168).then(n.bind(null,"SPbX"))}}}).peekState("notification-edit",{abstract:!0,url:"/notification",resolve:{translations:[r.serviceName,e=>e.loadBundle("features/base/stream/notification")]},panelClass:"full",require:()=>n.e(624).then(n.bind(null,"OhPa")),pageTitle:"base.stream.notification.edit.pageTitle"}).peekState("notification-edit.steps",{url:"/edit",panelClass:"full",pageTitle:"base.stream.notification.edit.pageTitle",views:{"notification-step1@":{require:()=>n.e(152).then(n.bind(null,"At0Z"))},"notification-step2@":{require:()=>n.e(168).then(n.bind(null,"SPbX"))}}})}])},sgjL:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return l}));var a=n("nsO7"),i=n("Llzl"),r=n("e6jQ"),s=n("Q/M7");const o="ultraUi.components.services.postMessageDispatcher",l="postMessageDispatcher";class c{constructor(e){this.$window=e,this.eventHandlers={},this.eventListenerBound=!1,this.superEventHandler=e=>{e.origin===s.j()&&e.data&&e.data.messageId&&a.forOwn(this.eventHandlers,(t=>{t.messageId===e.data.messageId&&t.eventHandler(e.data,e.source)}))}}callEventHandler(e,t){a.forOwn(this.eventHandlers,(n=>{n.messageId===e&&n.eventHandler(t,window)}))}registerEventHandler(e,t,n,i=!1){if(i){const t=[];a.forOwn(this.eventHandlers,((n,a)=>{n.messageId===e&&t.push(a)})),t.forEach((e=>{this.removeEventHandler(e)}))}const s=r.a();this.eventHandlers[s]={eventHandler:t,messageId:e},this.handleEventListener(),n.$on("$destroy",(()=>{this.removeEventHandler(s),this.handleEventListener()}))}removeEventHandler(e){this.eventHandlers[e]&&delete this.eventHandlers[e]}getDispatcherStatus(){return{count:Object.keys(this.eventHandlers).length,bound:this.eventListenerBound}}testDispatcherEventHandler(e){this.superEventHandler(e)}handleEventListener(){Object.keys(this.eventHandlers).length>0?this.eventListenerBound||this.addEventListener():this.removeEventListener()}addEventListener(){this.$window.addEventListener("message",this.superEventHandler,!1),this.eventListenerBound=!0}removeEventListener(){this.$window.removeEventListener("message",this.superEventHandler),this.eventListenerBound=!1}}c.$inject=["$window"];i.module(o,[]).service(l,c)},sqUP:function(e,t){e.exports='<bb-modal id="notification-modal-api-error"\n          class="notification"\n          modal-title-key="components.services.error-modal.error-insufficient-storage.title"\n          analytics-id-tag-prefix="components.services.error-modal.error-insufficient-storage">\n  <div name="modal-contents">\n    <div>\n      <p bb-translate>components.services.error-modal.error-insufficient-storage.information</p>\n    </div>\n    <div>\n      <p bb-translate>components.services.error-modal.error-insufficient-storage.description</p>\n    </div>\n    <bb-session-debug-modal-button></bb-session-debug-modal-button>\n  </div>\n  <button name="modal-footer-button-primary"\n          ng-click="$parent.$dismiss()"\n          class="button js-primary-button"\n          analytics-id="components.services.error-modal.dismiss"\n          bb-translate>components.services.error-modal.dismiss</button>\n</bb-modal>\n'},"t04/":function(e,t,n){var a=n("ziER"),i=n("5JeM"),r=new a({id:"icon-small-course_catalog_default",use:"icon-small-course_catalog_default-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-course_catalog_default"><path d="M5 14.5c-2 1.0446-4 0-4 0v-13c2-1 4 0 4 0v13zM15 14.5c-2 1.125-4 0-4 0v-13s2-1 4 0v13zM8 11v1m0-7v1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><path d="M11 14.5357c-3 1.0447-6 0-6 0V1.5s3-1 6 0v13.0357z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(r);e.exports=r},t3AZ:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n("Llzl"),i=n("0JpG");const r="ultra.components.directives.translateAttrsDirective",s="bbTranslateAttrs";class o{constructor(e,t,n,a,i,r){this.$q=e,this.bbLocalize=t,this.scope=n,this.element=a,this.attrs=i,this.origAttrs=r,this.currentAttrs={},this.currentValues={},this.getOrigAttrsString=()=>this.origAttrs[s],this.getOrigValuesString=()=>this.origAttrs.translateAttrsValues,this.getAttrsString=()=>this.attrs[s],this.getValuesString=()=>this.attrs.translateAttrsValues,this.updateValues=()=>Object.assign(this.currentValues,this.scope.$eval(this.getValuesString()));let o=!0;this.isOnetimeBind(this.getOrigAttrsString())?this.updateAttrs():(this.scope.$watch(this.updateAttrs.bind(this),this.translate.bind(this),!0),o=!1),this.isValuesStringDefined()&&!this.isOnetimeBind(this.getOrigValuesString())&&(this.scope.$watch(this.updateValues.bind(this),this.translate.bind(this),!0),o=!1);const l=n.$root.$on("$translateChangeSuccess",this.translate.bind(this));n.$on("$destroy",l),o&&this.translate()}updateAttrs(){return Object.assign(this.currentAttrs,this.scope.$eval(this.getAttrsString()))}isValuesStringDefined(){return null!=this.getOrigValuesString()}isOnetimeBind(e){return 0===e.indexOf("::")}translate(){const e={},t=this.bbLocalize.getLocale(this.scope);a.forEach(this.currentAttrs,((n,a)=>{e[a]=this.bbLocalize.translate({locale:t,key:n,params:this.currentValues,noWrap:!0,noEscape:!0})})),this.$q.all(e).then((e=>{Object.keys(e).forEach((t=>{this.attrs.$set(t,e[t],!0,t)}))}))}}class l{constructor(e,t){this.$q=e,this.bbLocalize=t,this.restrict="A",this.scope=!1,this.compile=(e,t)=>{t[s];return(e,n,a)=>new o(this.$q,this.bbLocalize,e,n,a,t)}}}l.$inject=["$q",i.serviceName],a.module(r,[i.moduleName]).directive(s,["$injector",e=>e.instantiate(l)])},t6LE:function(e,t,n){"use strict";n.r(t),n.d(t,"moduleName",(function(){return g})),n.d(t,"serviceName",(function(){return b})),n.d(t,"ToolAttemptDetailItemEx",(function(){return f})),n.d(t,"isGroupAttempt",(function(){return S}));n("QLzv");var a=n("nsO7"),i=n("5MwF"),r=n("vYaK"),s=n("yCC5"),o=n("Rjd/"),l=n("JrDC"),c=n("wgY5"),d=n("IbyE"),u=n("nkTj"),m=n("94iD"),p=n("6vR2"),h=n("zGdY");const g="ultra.components.services.models.grade.gradeAttempt",b=s.cb;class f{constructor(e,t){this.gradeAttempt=e,this.toolAttemptDetailItem=t,this._softTimeLimitDate=c(this.gradeAttempt.creationDate).add(this.softTimeLimitSecond,"seconds").toDate(),this._graceTimeLimitSecond=this.softTimeLimitSecond+f.GRACE_PERIOD_SECOND,this._graceDate=c(this.gradeAttempt.creationDate).add(this._graceTimeLimitSecond,"seconds").toDate(),this._isSubmittedInGracePeriod=c(this.gradeAttempt.attemptDate).isBetween(c(this.gradeAttempt.creationDate),c(this._graceDate)),this._hasAnswerIsModifiedInGracePeriod=a.filter(this.toolAttemptDetailItem.questionAttempts,(e=>!a.isEmpty(e.saveTimes)&&c(this.getLastModifyTime(e)).isBetween(this._softTimeLimitDate,this._graceDate))).length>0}get elapsedDuration(){return c.duration(c(this.gradeAttempt.attemptDate).diff(c(this.gradeAttempt.creationDate)))}get elapsedSec(){return Math.ceil(this.elapsedDuration.asSeconds())}get softTimeLimitSecond(){return this.isTimerCompletionH()?this.toolAttemptDetailItem.softTimeLimitSeconds:this.toolAttemptDetailItem.timeLimitSeconds}needAttention(){return!a.isUndefined(this.toolAttemptDetailItem.timeLimitSeconds)&&(this.elapsedSec>this._graceTimeLimitSecond||this._isSubmittedInGracePeriod&&this._hasAnswerIsModifiedInGracePeriod)}getExceedTime(){return Math.floor(c.duration(this.elapsedSec-this.softTimeLimitSecond,"seconds").asMinutes())}isCompleted(){return this.gradeAttempt.isCompleted()}isTimerCompletionH(){return this.toolAttemptDetailItem.timerCompletion===h.ac.HardStop}isTimerCompletionC(){return this.toolAttemptDetailItem.timerCompletion===h.ac.Continual}getLastModifyTime(e){return a.maxBy(e.saveTimes,(e=>e.date)).date}isAnsweredAfterSoftTimeLimit(e){return!a.isEmpty(e.saveTimes)&&c(this.getLastModifyTime(e)).isAfter(this._softTimeLimitDate)}getQuestionsAnsweredAfterSoftTimeLimit(){return a.filter(this.toolAttemptDetailItem.questionAttempts,(e=>this.isAnsweredAfterSoftTimeLimit(e)))}}f.GRACE_PERIOD_SECOND=60;const v=function(e){a.forEach(e,((e,t)=>{e.timeLimitSec=e.timeLimitSec||e.timeLimitSeconds}))},y=(e,t)=>{t.length>0&&e.dispatch(d.V.questionAttempt.setQuestionAttemptsInStore(t))};function S(e){return void 0!==e.attempts}const C=e=>{var t,n,a;const i=null!==(t=(e.toolAttemptDetail?Object.keys(e.toolAttemptDetail):[])[0])&&void 0!==t?t:d.O.Test.toString(),r=null===(n=e.toolAttemptDetail)||void 0===n?void 0:n[i];let s=null!==(a=null==r?void 0:r.questionAttempts)&&void 0!==a?a:[];return S(e)&&e.attempts.forEach((e=>{s=s.map((t=>({...t,groupAttemptId:t.attemptId,attemptId:e.id})))})),s};o.a.factory(b,["restmod",u.c,r.serviceName,"$ngRedux",(e,t,n,r)=>e.model().mix({creationDate:{serialize:"date"},modifiedDate:{serialize:"date"},attemptDate:{serialize:"date"},attemptFirstGradedDate:{serialize:"date"},attemptLastGradedDate:{serialize:"date"},"attemptReceipt.submissionDate":{serialize:"date"},originality:{hasOne:s.ab,path:"submissionResults"},assessment:{hasOne:s.f,path:"assessment"},stagedAttemptGrades:{init:()=>[]},$hooks:{"after-fetch":function(){y(r,C(this)),v(this.toolAttemptDetail)},"after-fetch-many":function(){let e=[];a.forEach(this,(t=>{e=e.concat(C(t)),v(t.toolAttemptDetail)})),y(r,e)},"after-save":e=>{const t=Object(p.a)(e.data);r.dispatch(d.V.gradebookAttempt.setGradeAttemptInStore(t))}},$extend:{Scope:{$destroyUrlFor:e=>i.a.apiBasePath+"/v1/courses/"+l.a(n,e.$scope)+"/gradebook/attempts/"+e.id},Record:{isPostable(){return this.readyToPost&&(h.l.NeedsGrading===this.status||h.l.NeedsMoreGrading===this.status)},isCompleted(){return h.l.Completed===this.status},isGraded(){return this.displayGrade&&(null!=this.displayGrade.score||null!=this.displayGrade.grade)||this.readyToPost},isGradable(e){const t=this.getToolAttemptDetailItem(e);return t&&t.assessment&&!t.assessment.hasAnswerableQuestions},isInProgress(){return h.l.InProgress===this.status||h.l.InMoreProgress===this.status},isSubmitted(){return!this.isInProgress()},isNeedsGrading(){return h.l.NeedsGrading===this.status||h.l.NeedsMoreGrading===this.status},isReconciled(){return null!=this.reconciliationMode},getToolAttemptDetailItem(e){return this.toolAttemptDetail?this.toolAttemptDetail[e.toString()]:null},getToolAttemptDetailItemEx(e){const t=this.getToolAttemptDetailItem(e);return null!=t?new f(this,t):null},getTimedTestAttemptDetail(){const e=this.getTimedTestApiData();return e?new m.a(e):null},getTimedTestAttemptDetailWithDueDate(e){return new m.a({...this.getTimedTestApiData(),dueDate:e})},getTimedTestApiData(){const e=this.getToolAttemptDetailItem(d.O.Test);return null==e?null:{elapsedSec:e.elapsedSeconds,timeLimitSec:e.timeLimitSeconds,softLimitSec:e.softTimeLimitSeconds,timerCompletion:e.timerCompletion}},getFeedbackToUser(){return this.feedbackToUser},getGroupIndividualFeedbackToUser(){return this.groupAttemptId&&this.overrideStatus===h.j.FeedbackOverride?this.feedbackToUser:null},getLastFeedbackAuthor(){return this.lastFeedbackAuthor},isPrePostGrade(){return!this.isCompleted()||!this.readyToPost||!this.userId},isDisplayablePostedGrade(){return this.isCompleted()&&this.readyToPost&&null!=this.userId}},Collection:{getNumAttemptsToGrade(){return this.filter((e=>e.isNeedsGrading()&&!e.isPostable())).length},getNumAttemptsToReconcile(){return this.getNumAttemptsToGrade()},getNumAttemptsToPost(){return this.filter((e=>e.isPostable())).length},getNumAttemptsSubmittedLate(e){return this.filter((t=>t.isSubmitted()&&c(t.attemptDate).isAfter(e))).length},getNumAttemptsSubmitted(){return this.filter((e=>e.isSubmitted())).length},getNumOfGradedAttempts(){return this.filter((e=>e.isGraded())).length},isAllGradedAndPosted(){return this.length>0&&this.every((e=>e.isCompleted()))},isAtLeastOneGradedAndPosted(){return this.length>0&&this.some((e=>e.isCompleted()))},isFirstAttemptPosted(){var e;return null===(e=this.getFirstAttempt())||void 0===e?void 0:e.isCompleted()},isLastSubmittedAttemptPosted(){var e;return null===(e=this.getLastSubmittedAttempt())||void 0===e?void 0:e.isCompleted()},getAttemptIndexById(e){return a.findIndex(this,(t=>{var n;return(null!==(n=t.groupAttemptId)&&void 0!==n?n:t.id)===e}))},getFirstAttempt(){return this.length?this[0]:void 0},getLastSubmittedAttempt(){return this.length?this[this.length-1]:void 0}}}})])},t6zR:function(e,t,n){"use strict";var a=n("wDWF");let i,r;class s{static getBasePageStorageKey(){return i||(i="ultra.ui.basepage."+a.a(s.userId)),i}static getPeekPageStorageKey(){return r||(r="ultra.ui.peekpage."+a.a(s.userId)),r}}t.a=s},tBL6:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return o}));var a=n("VAMW"),i=n("6fZB"),r=n("zGdY");class s{constructor(e,t){this.$q=e,this.featureFlagService=t}isParentInLearningModule(e,t){var n;return!!(null===(n=t.children)||void 0===n?void 0:n.some((t=>e.parentId===t.id)))}isInLearningModule(e,t){return e.parentId===t.id||this.isParentInLearningModule(e,t)}getParentFolderInLearningModule(e,t){var n;return null===(n=t.children)||void 0===n?void 0:n.find((t=>e.parentId===t.id))}updateCourseLinksForContents(e,t){e.forEach((e=>{var n,a,i;(null===(n=e.children)||void 0===n?void 0:n.length)?this.updateCourseLinksForContents(e.children,t):t.includes(null===(i=null===(a=e.ui)||void 0===a?void 0:a.linkSource)||void 0===i?void 0:i.id)&&e.visibility!==r.w.Visible&&e.$fetch().$asPromise().then((()=>{e.getLinkContentSource({fromServer:!0})}))}))}refreshCourseLinksVisibility(e,t,n=[]){return e.forEach((e=>{var a,i,s;if(null===(a=e.children)||void 0===a?void 0:a.length)return this.refreshCourseLinksVisibility(e.children,t,n);e.isCourseLink()&&e.visibility!==r.w.Visible&&t===(null===(s=null===(i=e.ui)||void 0===i?void 0:i.linkSource)||void 0===s?void 0:s.id)&&n.push(e.$fetch().$asPromise().then((()=>{e.getLinkContentSource({fromServer:!0})})))})),this.$q.all(n).then((()=>this.$q.resolve()))}refreshCourseLinksWhichTargetIsInLearningModule(e,t,n){var a,i;return n&&(null==e?void 0:e.isInForcedSequenceModule())?this.refreshCourseLinksVisibility(t.$scope,null===(i=null===(a=t.ui)||void 0===a?void 0:a.linkSource)||void 0===i?void 0:i.id):this.$q.resolve()}refreshChildren(e,t,n){var a,i,r;if(!e||!t)return this.$q.resolve();const s=this.getParentFolderInLearningModule(e,t);if(e&&t.isForcedSequenceModule()&&n&&this.isInLearningModule(e,t)){const n=[t.$fetch().$asPromise(),null===(i=t.getChildren({limit:(null===(a=t.children)||void 0===a?void 0:a.length)+1}))||void 0===i?void 0:i.$asPromise()];return(null==s?void 0:s.children)&&n.push(null===(r=s.getChildren({limit:s.children.length+1}))||void 0===r?void 0:r.$asPromise()),this.$q.all(n).then((([,n,a])=>{if(n.forEach(((e,a)=>{var i,r;const s=null===(i=t.children)||void 0===i?void 0:i.findIndex((t=>t.id===e.id));s>=0&&(n[a].ui=null===(r=t.children[s])||void 0===r?void 0:r.ui,n[a]=Object.assign(t.children[s],n[a]))})),s&&a&&a.forEach(((e,t)=>{const n=s.children.findIndex((t=>t.id===e.id));-1!==n&&(s.children[n]=Object.assign(s.children[n],a[t]))})),this.featureFlagService.isFeatureEnabled("feature.course.content.outline.react")){const n=[e.id],a=t.children.findIndex((t=>t.id===e.id));-1!==a&&t.children[a+1]&&n.push(t.children[a+1].id),this.updateCourseLinksForContents(t.$scope,n.filter(Boolean))}}))}return this.$q.resolve()}}class o{constructor(e,t){this.$q=e,this.featureFlagService=t,this.key=a.d.LearningModuleRefreshChildrenOperations,this.angularRefresher=new s(this.$q,this.featureFlagService)}refreshChildren(e,t,n){const a=this.angularRefresher.refreshChildren(e,t,n);return Object(i.a)(a)}refreshCourseLinksWhichTargetIsInLearningModule(e,t,n){const a=this.angularRefresher.refreshCourseLinksWhichTargetIsInLearningModule(n,e,t);return Object(i.a)(a)}}},tMbR:function(e,t,n){"use strict";var a=n("ERkP"),i=n("ubfy"),r=n("np6O"),s=n("dIht"),o=n("7O4Y"),l=n("In+A"),c=n("Hj9i"),d=n("Afl9");let u=1;const m=()=>{const e=u;return u+=1,e};n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return b}));const p="guidance.featureAnnouncement",h="guidance-react_feature-announcement_",g=e=>{const{announcementTitle:t,content:n,componentKey:u,linkHref:g,linkText:b,buttonAriaLabel:f,doneButtonText:v,onCloseAnnouncement:y,closeLabel:S}=e,[C]=a.useState(m),E=`feature-announcement__icon-button__${C}`,I=Object(d.a)(),[k,w]=a.useState(!1),[T,O]=Object(c.a)(`${p}.${u}`);if(!T&&!k)return null;const A={id:`${h}${u}`,selector:`.${E}`,title:t,content:n};return g&&b&&(A.link=a.createElement(i.b,{analyticsId:`${p}.link`,href:g,target:"_blank"},b)),a.createElement("div",null,a.createElement(r.AnalyticsIconButton,{analyticsId:`${p}.icon-button`,"aria-label":f,className:Object(o.a)(E,!k&&I.animatedIconButton),onClick:()=>((e,t)=>{l.f.stopQueue(),e(!0),t()})(w,O),onFocus:e=>e.stopPropagation()},a.createElement(s.a,{className:I.icon})),a.createElement(i.a,{analyticsId:`${p}.tour`,open:k,steps:[A],onClose:()=>{y&&y(),(e=>{e(!1),l.f.startQueue()})(w)},showHighlight:!1,showBackdrop:!1,strings:{doneSingleText:v,closeLabel:S}}))},b=()=>!!document.querySelector(`*[id^="${h}"]`)},tPPx:function(e,t,n){"use strict";n.r(t),n.d(t,"COURSE_ROLES_LIMIT",(function(){return s})),n.d(t,"toBeLocalizedRoleLabels",(function(){return l})),n.d(t,"toBeLocalizedOrgRoleLabels",(function(){return c})),n.d(t,"serviceName",(function(){return d})),n.d(t,"USER_API_PATH",(function(){return u}));n("QLzv");var a=n("5MwF"),i=n("Rjd/"),r=n("yCC5");const s=1e3,o={S:0,T:1,B:2,G:3,BB_FACILITATOR:4,P:5,U:6},l={S:"global.course.role.S",P:"global.course.role.P",BB_FACILITATOR:"global.course.role.BB_FACILITATOR",T:"global.course.role.T",B:"global.course.role.B",G:"global.course.role.G",U:"global.course.role.U"},c={S:"global.organization.role.S",P:"global.organization.role.P",BB_FACILITATOR:"global.organization.role.BB_FACILITATOR",T:"global.organization.role.T",B:"global.organization.role.B",G:"global.organization.role.G",U:"global.organization.role.U"},d=r.S,u=a.a.apiBasePath+"/v1/roles/courseRoles";i.a.factory(d,["restmod",e=>e.model(u).mix({localizedCourseName:{mask:!0},$extend:{Collection:{loadLocalizedNames(e){return this.forEach((t=>{t.isRemovable?t.localizedRoleName=e?t.orgName.rawValue:t.courseName.rawValue:t.localizedRoleName=e?"global.organization.role."+t.identifier:"global.course.role."+t.identifier})),this},sortByStudentFirst(e){return this.$action((function(){this.sort((function(t,n){const a=t.identifier,i=n.identifier;if(a in o&&i in o)return o[a]-o[i];if(a in o&&!(i in o))return-1;if(!(a in o)&&i in o)return 1;let r,s;return"organization"===e?(r=t.orgName.languageKey,s=n.orgName.languageKey):(r=t.courseName.languageKey,s=n.courseName.languageKey),r>s?1:r<s?-1:0}))}))}}}})])},"tQ/B":function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return p})),n.d(t,"a",(function(){return y}));var a=n("D57K"),i=n("aHpC"),r=n("Qbdf"),s=n("TnpK"),o=n("0JpG");const l="ultra.service.course-context.title-handle",c="coursePageTitleHandling",d=c+"Provider",u={},m={};function p(e,t){m[e]={handlerClass:t}}function h(e){const t=m[e];if(!t)throw new Error(`Handler '${e}' not registered`);return t}function g(e,t,n,a){e&&(n=n||[],Object.keys(e).forEach((i=>{if(a&&i in t||n.some((e=>i===e)))return;const r=e[i];t[i]=r})))}let b=class e{constructor(t){this.injector=t,this.providerName=c,this.$args={},this.$get=["$injector",t=>t.instantiate(e)]}get provides(){return this.$args.provides||"BasePageTitleHandler"}get instance(){return this.$instance?this.$instance:this.getHandler()}get args(){return this.$args}config(e){return new f(this,e||{})}clean(){return this.instance.clean(),Object.keys(this.args).forEach((e=>{delete this.args[e]})),this.$instance=null,this}setDefaultHandler(e){return this.$args.provides=e,this.isInitialized()&&(this.$instance=this.getHandler(this.provides)),this}isInitialized(e){if(this.injector)return!0;if(e)throw new Error("Provider not initialized")}registerHandler(e,t){p(e,t)}getHandlerRegistry(e){return h(e||this.provides)}getHandlerClass(e){return function(e){var t;return null===(t=h(e))||void 0===t?void 0:t.handlerClass}(e||this.provides)}getHandler(e,t){if(this.isInitialized(!0)){const n=e||this.provides;if(n===this.$args.provides&&this.$instance)return this.$instance;const a=this.getHandlerRegistry(n);return a.handler||(a.handler=this.injector.instantiate(a.handlerClass),a.handler.getProviderConfig=()=>this.args,a.handler.args={...this.args}),t&&(this.$args.provides=n,this.$instance=a.handler),a.handler}}};b=Object(a.a)([Object(a.c)(0,Object(i.b)("$injector"))],b);class f{constructor(e,t){this.provider=e,this.args=t}build(e){var t;const n=e.injector||this.provider.injector;if(delete e.injector,!n)throw new Error("No injector to build Handler");const a=n.get(this.provider.providerName);return this.args.provides&&this.args.provides!==a.provides&&(a.instance.stopListeningOnAll(),a.setDefaultHandler(this.args.provides)),(null===(t=this.args.clean)||void 0===t||t)&&a.clean(),g(this.args,a.args,["clean"]),this.instance=a.instance.build(e),this}process(e,...t){return this.isBuilt(!0),this.instance.process(e,...t)}isBuilt(e){if(this.instance)return!0;if(e)throw new Error("Handler not initialized")}}let v=class{constructor(e,t,n,a){this.$injector=e,this.$rootScope=t,this.ultraState=n,this.bbLocalize=a}get pageTitle(){return this.args.pageTitle}set pageTitle(e){this.args.pageTitle=e}get name(){return this.args.name}set name(e){this.args.name=e}build(e){return g(e,this.args),g(this.getProviderConfig(),this.args),this.args.listenOn&&(Array.isArray(this.args.listenOn)?this.args.listenOn.forEach((e=>{this.listenOn(e)})):this.listenOn(this.args.listenOn)),this}clean(){return this.stopListeningOnAll(),Object.keys(this.args).forEach((e=>{delete this.args[e]})),this}getUltraPageName(){const e=this.pageTitle||"base.ultra";return this.bbLocalize.translate({locale:this.$rootScope.index.locale,key:e})}process(e,...t){return this.getUltraPageName().then((e=>{this.$rootScope.index.title=`${e}`}))}listenOn(e,t=!0){this.stopListeningOn(e);let n=null;n=Array.isArray(t)?(e,...n)=>{if(t.some((e=>this.ultraState.current.name===e)))return this.process(e,...n)}:t?(e,...t)=>{if(this.name===this.ultraState.current.name)return this.process(e,...t)}:(e,...t)=>this.process(e,...t);const a=this.$rootScope.$on(e,n);return u[e]=a,a}stopListeningOn(e){if(Object.keys(u).includes(e))return u[e](),delete u[e],!0}stopListeningOnAll(){Object.keys(u).forEach((e=>{u[e](),delete u[e]}))}};v=Object(a.a)([Object(a.c)(0,Object(i.b)("$injector")),Object(a.c)(1,Object(i.b)("$rootScope")),Object(a.c)(2,Object(i.b)(s.d)),Object(a.c)(3,Object(i.b)(o.serviceName))],v);let y=class extends v{constructor(e,t,n,a,i){super(e,t,n,a),this.$injector=e,this.$rootScope=t,this.ultraState=n,this.bbLocalize=a,this.currentCourse=i}process(e,...t){return this.getUltraPageName().then((e=>{this.$rootScope.index.title=`${e} / ${this.currentCourse.course.name}`}))}};y=Object(a.a)([Object(a.c)(0,Object(i.b)("$injector")),Object(a.c)(1,Object(i.b)("$rootScope")),Object(a.c)(2,Object(i.b)(s.d)),Object(a.c)(3,Object(i.b)(o.serviceName)),Object(a.c)(4,Object(i.b)(r.e))],y);p("BasePageTitleHandler",v),p("CoursePageTitleHandler",y);const S=[s.b,o.moduleName];angular.module(l,S).provider(c,class extends b{})},"tb/u":function(e,t){e.exports='<div>\n  <bb-user-avatar ng-repeat="user in displayUsers" user="user"></bb-user-avatar>\n</div>'},tcaZ:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n("D57K"),i=n("Llzl"),r=n("In+A"),s=n("5KgE"),o=n("aHpC");const l="ultra.components.directives.firstTimeContainer";let c=class{constructor(e){this.firstTimeHelper=e,this.manager=r.f}};c=Object(a.a)([Object(a.c)(0,Object(o.b)(s.c))],c);class d{constructor(){this.restrict="AE",this.controller=c,this.link=(e,t,n,a)=>{a.manager.startQueue(),e.$on("hide-ftue-component",((e,t)=>{a.manager.hideComponent(t)}))}}}i.module(l,[s.b]).directive("bbFirstTimeContainer",["$injector",e=>e.instantiate(d)])},"td+C":function(e,t,n){"use strict";(function(e){var a=n("nsO7"),i=n("zGdY"),r=n("IbyE"),s=n("Q/M7"),o=n("6vR2"),l=n("v6Sp"),c=n("oPIA"),d=n("ObAk"),u=n("x9Ok");t.a=new class{constructor(){this.helloMessageListener=e=>{var t,n,a;const i=Array.from(this.integrations.values()).find((t=>t.iframe.contentWindow===e.source));if(!i&&(null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.type)!==c.o)return;if((null===(n=null==e?void 0:e.data)||void 0===n?void 0:n.type)!==c.o)return void console.warn(`Received unexpected postMessage. Expected event type [${c.o}], but got [${null===(a=null==e?void 0:e.data)||void 0===a?void 0:a.type}] instead`,e);if(!i)return void console.warn("Could not find a valid integration for message -- did the event come from an unexpected frame?");const r=Object(s.i)(i.url);if(Object(s.i)(i.url)!==e.origin)return void console.warn(`Message came from origin [${e.origin}], but we were expecting [${r}]. Authorization requests must come from the same origin that was configured in the LTI placement.`);const o=new MessageChannel;i.integrationChannel=o.port1,i.integrationChannel.onmessage=e=>{this.onIntegrationMessage(e.data,i)},i.iframe.contentWindow.postMessage({type:c.o},e.origin,[o.port2])},this.onIntegrationMessage=(e,t)=>{if(!e)return;const n=l.a.authScopes.get(e.type);if(n){if(!n(e,t))return}const a=this.integrationMessageEvents.get(e.type);a?a(e,t):console.warn(`No valid method to call with provided event type ${e.type}.`)},this.sendAuthorizedMessage=async(e,t)=>{if(!e||!e.token)return this.sendAuthorizationError(t,"Received authorized message without token");const n=e.token;try{const e=await Object(r.lb)(n);if(null==e.scope){const e=`Could not authenticate, no auth scopes provided for ${t}`;return this.sendAuthorizationError(t,e)}const a=new Set(e.scope.split(/\s+/));this.checkPremiumAccess(t,a),t.authScopes=a,t.integrationChannel.postMessage({type:c.c})}catch(e){const n=e,a=n.error&&n.error.error,i="invalid_request"===a,r=n.error&&n.error.error_description,s=i?"Expired or invalid token.":`Server side error occurred: ${a}, ${r}`;return this.sendAuthorizationError(t,s)}},this.checkPremiumAccess=(e,t)=>{if(!t.has(c.H)){const t="This integration does not have UEF access enabled.";this.sendAuthorizationError(e,t)}},this.sendAuthorizationError=(e,t)=>{const n={type:c.cb,errorInformation:t};this.sendMessage(n,e),this.removeIframe(e)},this.removeIframe=e=>{this.document.body.querySelector(`#${e.iframe.id}`).remove()},this.sendRouteEvent=e=>{const t=u.b.getCurrentRoute();this.sendMessage({type:c.i,eventType:c.fb.Route,routeName:t.currentRouteName,routeData:t.currentParams},e)},this.integrations=new Map,this.integrationMessageEvents=new Map,this.integrationSubscriptionManager=new d.a}async init(e){if(this.window=e,this.document=e.document,this.isSafeMode())return console.warn("In integration safe mode -- not loading integrations"),null;try{const e=await Object(i.Yc)(r.Zb,{query:{type:i.Hb.UltraUI}});return this.window.addEventListener("message",this.helloMessageListener),this.initIntegrationMessageTypes(),this.initIntegrationSubscriptionCallbacks(),this.loadIntegrations(e),e}catch(e){return null}}loadIntegrations(t){!t||this.integrations&&this.integrations.size>0||t.results.forEach((t=>{if(t.availability.available!==i.Jb.Yes)return;const n=e(`<iframe id="${t.id}" src="${Object(s.c)(t.launchLink)}"></iframe>`).hide();this.document.body.appendChild(n[0]),this.integrations.set(t.id,{id:t.id,hasAuthorized:!1,iframe:n[0],url:t.url,authScopes:new Set})}))}isSafeMode(){return"true"===Object(s.m)("noExtensions",this.window.location.href)}addIntegrationMessageType(e,t){this.integrationMessageEvents.get(e)||this.integrationMessageEvents.set(e,t)}addSubscriptionEventCallback(e,t){return this.integrationSubscriptionManager.onSubscriptionEventCallback(e,t)}addUnsubscriptionEventCallback(e,t){return this.integrationSubscriptionManager.onUnsubscriptionEventCallback(e,t)}initIntegrationMessageTypes(){this.addIntegrationMessageType(c.c,this.sendAuthorizedMessage),this.addIntegrationMessageType(c.bb,this.integrationSubscriptionManager.subscribeToEvents),this.addIntegrationMessageType(c.db,this.integrationSubscriptionManager.unsubscribeFromEvents)}initIntegrationSubscriptionCallbacks(){this.addSubscriptionEventCallback(c.fb.PortalNew,(e=>{l.e.getUnownedPortals().forEach((t=>{e.integrationChannel.postMessage({type:c.i,eventType:c.fb.PortalNew,portalId:t.portalId,selector:t.selector,selectorData:t.selectorData})}))})),this.addSubscriptionEventCallback(c.fb.Route,(e=>{const t=u.b.getCurrentRoute();this.sendMessage({type:c.i,eventType:c.fb.Route,routeName:t.currentRouteName,routeData:t.currentParams},e)}))}sendEventMessage(e,t){const n=this.integrationSubscriptionManager.getSubscribedIntegrations(e.eventType);if(!n)return;(t?[this.findIntegration(t)]:n).forEach((t=>{t&&this.sendMessage(Object(o.b)(e),t)}))}findIntegration(e){return this.integrations.get(e)}sendMessage(e,t){let n;n=Object(a.isString)(t)?this.findIntegration(t):t,n.integrationChannel.postMessage(Object(o.b)(e))}}}).call(this,n("71td"))},uC9d:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return s}));var a=n("nsO7");const i="learnApiCacheMessageService";class r{constructor(){this.listen=a.noop,this.clearCache=a.noop}}class s{constructor(e){this.$rootScope=e,this.init=()=>{this.clearCacheOnLearnScreenClose()},this.clearCacheOnLearnScreenClose=()=>this.$rootScope.$on("$stateChangeStart",((e,t,n,a)=>{-1!==["base.admin","base.courses.peek.course.classic.outline"].indexOf(a.name)&&this.clearCache()})),this.clearCache=e=>this.cacheServiceCallback({type:"clear",pattern:e}),this.listen=e=>{this.cacheServiceCallback=e},this.init()}}s.$inject=["$rootScope"]},uNsL:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n("Llzl"),i=n("nmzr"),r=n("0JpG"),s=n("TnpK");const o="ultra.course.content-collection.router";a.module(o,[r.moduleName,s.b]).config([s.c,e=>{e.peekState(i.h.CONTENT_COLLECTION,{url:"/contentcollection?parentId&positionBefore&positionAfter",require:()=>Promise.all([n.e(0),n.e(584)]).then(n.bind(null,"tsxV")),resolve:{translations:["$q",r.serviceName,(e,t)=>e.all([t.loadBundle("features/course/content-collection/content-collection")])]},panelClass:"full",pageTitle:"course.contentCollection.contentCollection",peekStates:["content-collection-edit","content-collection-picker","content-collection-settings"],peekViewName:"content-collection-child@"}).peekState("content-collection-edit",{url:"/edit",require:()=>n.e(638).then(n.bind(null,"klLK")),panelClass:"peek",pageTitle:"course.contentCollection.itemSettings",peekStates:[],params:{items:null,fileRow:null}}).peekState("content-collection-settings",{url:"/settings",require:()=>n.e(689).then(n.bind(null,"ks8w")),panelClass:"peek",pageTitle:"course.contentCollection.browserSettings",peekStates:[]}).peekState("content-collection-picker",{url:"/picker?pickerType&multi",require:()=>n.e(688).then(n.bind(null,"sSTc")),panelClass:"full",pageTitle:"course.contentCollection.browseContentCollection",peekStates:[],params:{pickerType:"File",multi:"true"}})}])},usTV:function(e,t){e.exports='<div class="square-toggle">\n  <input class="toggle-input input-one"\n         ng-checked="property === oneViewValue"\n         aria-checked="{{property === oneViewValue}}"\n         id="square-toggle-option-one-{{ ::squareToggle.oneControlId }}"\n         name="square-toggle-name-{{ ::squareToggle.radioGroupName }}"\n         type="radio"\n         value="{{ ::oneViewValue }}"\n         aria-controls="{{ ::oneAriaControls }}"\n         ng-click="squareToggle.handleClick($event)"\n         ng-keyup="squareToggle.handleKeyUp($event)"\n         enhanced-tooltip="true"\n         tooltip-template="{{ ::oneTooltipTemplate }}"\n         tooltip-scope="oneTooltipScope()"\n         tooltip-position="bottom"\n         tooltip-disable-on-mouse-over="true"\n         analytics-id="{{analyticsIdTagPrefix}}.option1.input.radio">\n  <label class="toggle-label input label-one js-label-{{oneIconClass}}"\n         for="square-toggle-option-one-{{ ::squareToggle.oneControlId }}">\n    <bb-svg-icon size="custom" icon="{{oneIconClass}}"></bb-svg-icon>\n    <span class="sr-only" bb-translate>{{ ::oneAriaLabel }}</span>\n  </label>\n  <input class="toggle-input input-two"\n         ng-checked="property === twoViewValue"\n         aria-checked="{{property === twoViewValue}}"\n         id="square-toggle-option-two-{{ ::squareToggle.twoControlId }}"\n         name="square-toggle-name-{{ ::squareToggle.radioGroupName }}"\n         type="radio"\n         value="{{ ::twoViewValue }}"\n         aria-controls="{{ ::twoAriaControls }}"\n         ng-click="squareToggle.handleClick($event)"\n         ng-keyup="squareToggle.handleKeyUp($event)"\n         enhanced-tooltip="true"\n         tooltip-template="{{ ::twoTooltipTemplate }}"\n         tooltip-scope="twoTooltipScope()"\n         tooltip-position="bottom"\n         tooltip-disable-on-mouse-over="true"\n         analytics-id="{{analyticsIdTagPrefix}}.option2.input.radio">\n  <label class="toggle-label input label-two js-label-{{twoIconClass}}"\n         for="square-toggle-option-two-{{ ::squareToggle.twoControlId }}">\n    <bb-svg-icon size="custom" icon="{{twoIconClass}}"></bb-svg-icon>\n    <span class="sr-only" bb-translate>{{ ::twoAriaLabel }}</span>\n  </label>\n  <a href="javascript:void(0);" class="button" role="presentation" tabindex="-1"\n     analytics-id="{{analyticsIdTagPrefix}}.presentation.link"></a>\n</div>\n'},v6Sp:function(e,t,n){"use strict";var a=(e,t)=>{if(!e||!t)return;return(e.split(/\s+/)||[]).map((e=>{const n=t.get(e);return n||console.warn(`Invalid class name: ${e}`),n})).filter((e=>!!e)).join(" ")||void 0},i=n("ERkP"),r=n("fN3Q"),s=n("oPIA");const o=new Map,l=new Map,c=new Map,d={addComponentType:(e,t,n)=>{if(o.get(e))return void console.warn(`${e} already exists in the componentManager, nothing was modified.`);const a={existingPortals:new Set,ultraWhiteList:n||new Map,maxNumberRendered:t};o.set(e,a)},addGlobalComponent:(e,t)=>{c.set(e,t)},getComponent:(e,t)=>{if(!o.has(e))return;return o.get(e).ultraWhiteList.get(t)||c.get(t)},getGlobalComponent:e=>c.get(e),getWhitelist:e=>{const t=o.get(e);return t?t.ultraWhiteList:new Map},hasComponent:(e,t)=>{if(!o.has(e))return!1;return o.get(e).ultraWhiteList.has(t)||c.has(t)},hasComponentType:e=>o.has(e)||l.has(e),isValidComponent:e=>{const{componentContext:t,componentName:n,contents:a,integrationId:i}=e,r=t?o.get(t):void 0;if(!r&&t)return console.warn(`${t} has not been registered.`),!1;const s=(null==r?void 0:r.ultraWhiteList.get(n))||c.get(n);if(!s)return console.warn(`The component '${n}' has not been added the '${t}' white list.`),!1;if(!a.tag||a.tag!==n)return console.warn(`Incorrect tag: should be ${n} but received ${a.tag}.`),!1;return!a.props&&s.props?(console.warn(`Props are needed for '${n}', but no value for 'props' was given.`),!1):s.isValid(a,i)},overMaxComponents:e=>{const t=o.get(e),n=t?t.existingPortals.size:0,a=t&&t.maxNumberRendered;return!a||n>=a},removeComponentType:e=>{o.get(e)&&o.delete(e)},removeComponentFromPortal:(e,t)=>{const n=o.get(e);n&&n.existingPortals.delete(t)},removeGlobalComponent:e=>c.delete(e),updateComponentPortalList:(e,t)=>{const n=o.get(e);n?n.existingPortals.add(t):console.warn(`${e} is not a registered component.`)},setCustomWhiteList:(e,t,n)=>{let a=l.get(e);a||(a=new Map),a.set(t,n),l.set(e,a)},getCustomWhiteList:(e,t)=>{const n=l.get(e);return null==n?void 0:n.get(t)},removeCustomWhiteList:e=>{l.delete(e)},hasCustomWhiteList:(e,t)=>{const n=l.get(e);return!!(null==n?void 0:n.has(t))}},u=new Set,m={},p=e=>{u.forEach((t=>{try{t(s.eb.FailedValidationPortal,e)}catch(e){console.error("Failed to call validation listener",e)}}))};function h(e){const{portalType:t,contents:n,child:a,skipCustomValidation:i,integrationId:r}=e;if("string"==typeof n)return{passed:!0};const s=d.getGlobalComponent(n.tag);if(s&&!d.isValidComponent({componentName:n.tag,contents:n,integrationId:r})&&!i)return{passed:!1,message:`Component validation failed for ${n.tag}`};if(!s&&!t)return{passed:!0};const o=t&&d.getComponent(t,n.tag),l=t&&d.hasCustomWhiteList(t,n.tag);if(!(a||o||s||i||l))return{passed:!1,message:`Initial tag is incorrect for a ${t} portal.`};if(o&&!d.isValidComponent({componentContext:t,componentName:n.tag,contents:n,integrationId:r})&&!i)return{passed:!1,message:`Component validation failed for ${n.tag} on ${t}`};if(!n.children||"string"==typeof n.children)return{passed:!0};for(const e of n.children){const n=h({portalType:t,skipCustomValidation:i,contents:e,integrationId:r,child:!0});if(!n.passed)return n}return{passed:!0}}const g={addPortal:e=>{m[e.portalId]=e,e.portalType&&d.updateComponentPortalList(e.portalType,e.portalId),u.forEach((t=>{try{t(s.eb.NewPortal,e)}catch(e){console.error("Failed to call new portal listener",e)}}))},updatePortal:(e,t)=>{const n=t&&t(e.portalId,e.contents);if(n)return p(n),!1;const a=m[e.portalId],i=h({portalType:a.portalType,skipCustomValidation:a.skipCustomValidation,contents:e.contents,integrationId:e.requestingIntegrationId});return i.passed?(a&&a.setPortalContents(e.contents),!!a):(p({portalId:e.portalId,error:s.K.InvalidContents,errorMessage:i.message||"Invalid contents provided on update request",requestingIntegrationId:e.requestingIntegrationId}),!1)},addPortalListener:e=>{u.add(e),Object.values(m).forEach((t=>{e(s.eb.NewPortal,t)}))},removePortal:e=>{if(!e.portalId)return;if(m[e.portalId]){const t=m[e.portalId]&&m[e.portalId].portalType;t&&d.removeComponentFromPortal(t,e.portalId),delete m[e.portalId]}u.forEach((t=>{try{t(s.eb.RemovedPortal,e)}catch(e){console.error("Failed to call remove portal listener",e)}}))},getPortalData:e=>m[e],sendPortalCallback:e=>{u.forEach((t=>{try{t(s.eb.CallbackPortal,e)}catch(e){console.error("Failed to call callback listener",e)}}))},setPortalOwnership:(e,t)=>{const n=m[e];n&&n.setOwningIntegrationId(t)},sendValidationFailure:p,getUnownedPortals:()=>Object.keys(m).filter((e=>!m[e].getOwningIntegrationId())).map((e=>m[e])),validateContents:h},b=(e,t,n,a)=>()=>{const i={type:s.f.PortalCallback,portalId:n,callbackId:e,event:t,owningIntegrationId:a};g.sendPortalCallback(i)},f=(e,t,n,a,i)=>e.reduce(((e,r)=>{var o,l,c;if(r in s.L){if(!(null===(l=null===(o=t.props)||void 0===o?void 0:o[r])||void 0===l?void 0:l.callbackId))return console.warn(`custom onXX handlers for integration components must provide a callback id\n           Expect form similar to "onXX: {callbackId: '1'}": ${r}`),e;e[r]=((e,t,n,a)=>{var i;const r=null===(i=t.props)||void 0===i?void 0:i[e].callbackId;return b(r,e,n,a)})(r,t,n,a)}else{let s=null===(c=null==t?void 0:t.props)||void 0===c?void 0:c[r];if(i){const e=i.transformers&&i.transformers.get(r.toLowerCase());e&&(s=e(s,n,a))}e[r]=s}return e}),{}),v=e=>{const{contentItem:t,portalType:n,portalId:a,owningIntegration:i}=e;if(!t.props)return{};const r=n?d.getComponent(n,t.tag):d.getGlobalComponent(t.tag);if(!r)return{};const s=Object.keys(t.props).filter((e=>r.props&&e in r.props));return f(s,t,a,i,{attributes:Object.keys(r.props||{}),transformers:r.transformers})},y=e=>{const{selector:t,selectorData:n,portalId:a,initialOwningIntegrationId:s,initialContents:o,portalType:l,skipCustomValidation:c,onContentsChanged:u,onRegistered:m}=e;if(l&&!d.hasComponentType(l))return console.error(`Portal Type: ${l} is not listed in the componentManager,\n      either add it to the ComponentManager along with a whitelist or remove the attribute`),null;const[p,h]=Object(i.useState)(o),[b,f]=Object(i.useState)(s),[v]=Object(i.useState)(a||Object(r.v4)());return Object(i.useEffect)((()=>(g.addPortal({portalId:v,selector:t,selectorData:n,setPortalContents:e=>{h(e),setTimeout((()=>u&&u(e)))},setOwningIntegrationId:e=>{f(e)},getOwningIntegrationId:()=>b,portalType:l,skipCustomValidation:!!c}),m&&m(),()=>{g.removePortal({portalId:v,selector:t,selectorData:n})})),[v,t,n,l,b,c,u]),i.createElement(i.Fragment,null,S(p&&[p],b,v,l))},S=(e,t,n,r)=>e?"string"==typeof e?[e]:e.map(((e,o)=>{if(!e)return null;if(r){const a=d.getComponent(r,e.tag);if(a){const i=v({contentItem:e,portalType:r,portalId:n,owningIntegration:t});return a.render(n,{key:o,...i},S(e.children,t,n,r))}}const l=d.getGlobalComponent(e.tag);if(l){const a=v({contentItem:e,portalId:n,owningIntegration:t});return l.render(n,{key:o,...a},S(e.children,t,n))}let c;if(r&&(c=d.getCustomWhiteList(r,e.tag)),c||(c=s.gb.get(e.tag)),c){const l=((e,t,n)=>{if(!e.props)return{};const a=s.gb.get(e.tag);if(!(null==a?void 0:a.attributes))return{};const i=Object.keys(e.props).filter((e=>a.attributes.includes(e)));return f(i,e,t,n,a)})(e,n,t);return""===l.src||""===l.href?null:(l.href&&(l.target="_blank"),l.key=o,l.className=a(l.className,c.classNameMappings)||c.classNameDefault,i.createElement(e.tag,l,S(e.children,t,n,r)))}return null})):null;const C=e=>{const{portals:t,selector:n,portalType:a}=e;return i.createElement(i.Fragment,null,t.map(((e,t)=>{const r=function(e){return{...e.selectorData,registrationId:e.registrationRecord.registrationId,registrationName:e.registrationRecord.registrationName}}(e);return i.createElement(y,{key:t,selector:n,selectorData:r,initialOwningIntegrationId:e.registrationRecord.integrationId,portalType:a})})))},E=new Map;E.set(s.G,s.C),E.set(s.V.PanelNew,s.C),E.set(s.V.PanelClose,s.C),E.set(s.fb.Click,s.b),E.set(s.fb.Hover,s.b),E.set(s.fb.PortalNew,s.C),E.set(s.fb.PortalRemove,s.C),E.set(s.fb.Route,s.ab),E.set(s.fb.RouteChanging,s.ab),E.set(s.l,s.k),E.set(s.M.ModalNew,s.D),E.set(s.M.ModalClose,s.D),E.set(s.P.NotificationNew,s.E),E.set(s.P.NotificationClose,s.E);const I=(e,t)=>{if(!t.authScopes||t.authScopes.size<=0)return console.warn(`Received event without integration (${t&&t.id}) being authenticated.`),!1;const n=E.get(e.type);return!!(t.authScopes.has(s.a)||n&&t.authScopes.has(n))||(console.warn(`Invalid auth scope for ${e.type}, ${n} is required.`),!1)},k=new Map;k.set(s.G,I),k.set(s.bb,((e,t)=>{if(!t.authScopes||t.authScopes.size<=0)return console.warn(`Received event without integration (${t&&t.id}) being authenticated.`),!1;if(t.authScopes.has(s.a))return!0;const n=new Map;e.subscriptions.forEach((e=>{const t=E.get(e);t&&n.set(t,e)}));const a=[];return e.subscriptions.forEach((e=>{const i=E.get(e);i&&t.authScopes.has(i)?n.delete(i):a.push(e)})),a.length===n.size||(n.forEach((t=>{const a=n.get(t);a?console.warn(`Invalid auth scope for ${e.type}, ${t} is required for the ${a} event.`):console.warn(`Unrecognized auth scope ${t}.`)})),!1)})),k.set(s.V.PanelNew,I),k.set(s.V.PanelClose,I),k.set(s.l,I),k.set(s.M.ModalNew,I),k.set(s.M.ModalClose,I),k.set(s.P.NotificationNew,I),k.set(s.P.NotificationClose,I);const w={authScopes:k},T=new Map,O={addHelpProvider:e=>{T.set(e.providerId,e)},removeHelpProvider:e=>{T.delete(e)},getHelpProvider:e=>T.get(e),getProviderByType:e=>Array.from(T.values()).filter((t=>t.providerType===e)),getProviders:()=>Array.from(T.values())};n.d(t,"h",(function(){return a})),n.d(t,"d",(function(){return y})),n.d(t,"f",(function(){return C})),n.d(t,"e",(function(){return g})),n.d(t,"b",(function(){return d})),n.d(t,"g",(function(){return b})),n.d(t,"a",(function(){return w})),n.d(t,"c",(function(){return O}))},vJBG:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n("td+C"),i=n("oPIA"),r=n("IbyE"),s=n("3PCF"),o=n("9OUN"),l=n("TWlR");const c=new class{constructor(e){this.integrationService=e,this.registerOriginalityProvider=(e,t)=>{if(!e.submissionServicesUniqueHandle)return console.warn("Cannot register provider: no submissionServicesUniqueHandle was specified"),void this.integrationService.sendMessage({type:i.A,submissionServicesUniqueHandle:e.submissionServicesUniqueHandle,status:i.p.Failure,errorMessage:"submissionServicesUniqueHandle should be provided"},t);const n={submissionServicesUniqueHandle:e.submissionServicesUniqueHandle,integrationId:t.id};this.addIntegration(n),this.integrationService.sendMessage({type:i.A,submissionServicesUniqueHandle:e.submissionServicesUniqueHandle,status:i.p.Success},t)},this.saveOriginalityConfiguration=async(e,t)=>{var n;const a=this.listeners.get(t.uniqueHandle);if(!a)throw new Error(`No listener registered for ${t.uniqueHandle}`);try{const r=await this.saveSettingsMessenger.sendMessage({type:i.B,contentId:e.id,contentHandle:e.contentHandler.toString(),enabled:t.capabilities.OriginalityReport.enabled},a.integrationId);return r.success&&await this.saveSubmissionService(e.courseId,null===(n=e.getAssociatedGradingColumn())||void 0===n?void 0:n.id,t),r}catch(e){return{success:!1,error:this.localizationService.translateSync({key:"course.content.originalityReport.settings.errorSavingSettings",locale:this.localizationService.getAppLocale(),noWrap:!0,params:{integrationDisplayName:t.displayName}})}}},this.listeners=new Map}init(e,t){this.integrationService.addIntegrationMessageType(i.A,this.registerOriginalityProvider),this.ngRedux=t,this.subscribeToRedux(t),this.localizationService=e,this.integrationService.addIntegrationMessageType(i.A,this.registerOriginalityProvider),this.saveSettingsMessenger=Object(l.a)(i.B,{})}subscribeToRedux(e){e.connect((()=>({})),(e=>Object(o.b)({loadSubmissionServices:r.V.submissionServices.loadSubmissionServices,saveSubmissionService:r.V.submissionServices.saveSubmissionService},e)))(this)}addIntegration(e){this.listeners.set(e.submissionServicesUniqueHandle,e)}removeIntegration(e){this.listeners.delete(e.submissionServicesUniqueHandle)}async fetchDefaultOriginalityReportSubmissionService(e,t){await this.loadSubmissionServices(e,t);const n=r.Yb.submissionServices.getDefaultOriginalityReportSubmissionService(this.ngRedux.getState(),t);if(n&&(n.uniqueHandle===s.b||this.listeners.get(n.uniqueHandle)))return n}getOriginalityIntegrationByUniqueId(e){return this.listeners.get(e)}}(a.a)},vT39:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return s}));var a=n("nsO7"),i=n("0JpG"),r=n("6Ksg");const s="ultra.directives.validate.bbmlmarkup.sanitize",o={style:e=>null,":default":t=>{const n=e("<span></span>");return n.text(t.text()),n}};class l extends r.a{constructor(){super(...arguments),this.validate=t=>{if(null===this.whitelist)return!0;let n=!0;if(1!==t[0].nodeType)return!0;const i=t[0].tagName.toLowerCase();if(Object.prototype.hasOwnProperty.call(this.whitelist,i)){const e=this.whitelist[i];a.each(Array.prototype.slice.apply(t[0].attributes),(a=>{Object.prototype.hasOwnProperty.call(e,a.name.toLowerCase())||(t.removeAttr(a.name),n=!1)}))}else{n=!1;const e=(o[i]||o[":default"])(t);if(null===e)return t.remove(),!1;t.replaceWith(e),t=e}return a.each(t.children(),(t=>{n=this.validate(e(t))&&n})),n},this.getValidator=(t,n,i,r)=>t=>{const i=this.$q.defer();return this.initialWhitelist().then((()=>{let s=!0;const o=e("<span></span>");o.html(t),a.each(o,(t=>{s=this.validate(e(t))&&s})),s||r.$setViewValue(n.html()),i.resolve()})),i.promise}}}angular.module(s,[i.moduleName]).directive("bbSanitizeBbmlMarkup",["$injector",e=>e.instantiate(l)])}).call(this,n("71td"))},vWx0:function(e,t,n){"use strict";n("JzsJ");var a=n("hlSw"),i=n("Llzl"),r=n("w9Zy"),s=n("bF8R"),o=n("vdfi"),l=n("Fvsw"),c=n("Qbdf"),d=n("jhBu"),u=n("nsO7"),m=n("yC9S"),p=n("5MwF"),h=n("Y/dt"),g=n("z6Q5"),b=n("fYJU"),f=n("12mu"),v=n("pjml"),y=n("lEL+"),S=n("0JpG"),C=n("TnpK"),E=n("E01l");const I="ultra.modules.groupattempt.activities",k="ultra.services.groupattempt.activities",w="ultra.services.groupattempt.activities.dialog",T="bbGroupAttemptActivitiesPeek",O=new RegExp("assessment\\.overview\\.attempt("+C.a.replace(/\./g,"\\.")+".+)?$"),A={USER_CANCELLED:"USER_CANCELLED",USER_RELEASE_CONTROL:"USER_RELEASE_CONTROL",USER_REJECT_CONTROL:"USER_REJECT_CONTROL"},P=i.module(I,["ng"]);P.factory(k,["$injector","$q","$log","$http","$rootScope",b.b,y.b,C.d,function(e){const t=e.get("$q"),n=e.get("$http"),a=e.get("$rootScope"),i=e.get(b.b);m.b.OnRootScope(a,"$stateChangeError",(function(t,n,a){O.test(n.name)&&e.get(C.d).go(n.name.replace(/\.attempt$/,""),a)}));return{new:(e,a)=>{const r=(e,t)=>{e.userId=t.userId,e.queue=t.queue,e.groupAttemptId=t.groupAttemptId,e.status=t.status};let s=t.when(null);const o={myId:i.userId,request(){return s=s.then((()=>{const i=t.defer();return n.put(`${p.a.apiBasePath}/v1/courses/${e}/gradebook/groupAttempts/${a}/activities`,{}).then((e=>{r(this,e.data),i.resolve(this)})),i.promise})),s},keepAlive(i){s=s.then((s=>{const l=t.defer();return u.some(this.queue.concat(this.userId),(e=>this.myId===e))?n({method:"PATCH",url:`${p.a.apiBasePath}/v1/courses/${e}/gradebook/groupAttempts/${a}/activities`}).then((e=>(r(this,e.data),t.when(i(this)).then((e=>{if(u.some(this.queue.concat(this.userId),(e=>this.myId===e))&&e){const e=(new Date).getTime(),t=()=>{window.requestAnimationFrame((()=>{(new Date).getTime()-e>=5e3?o.keepAlive(i):t()}))};t()}}))))).finally((()=>{l.resolve(this)})):l.resolve(this),l.promise}))},release(){return s=s.then((()=>{const i=t.defer();return n.delete(`${p.a.apiBasePath}/v1/courses/${e}/gradebook/groupAttempts/${a}/activities`).then((e=>{r(this,e.data),i.resolve(this)})),i.promise})),s},kickout:()=>(s=s.then((()=>n.delete(`${p.a.apiBasePath}/v1/courses/${e}/gradebook/groupAttempts/${a}/activities/waiting`))),s),peek(){return s=s.then((()=>{const i=t.defer();return n.get(`${p.a.apiBasePath}/v1/courses/${e}/gradebook/groupAttempts/${a}/activities`).then((e=>{r(this,e.data),i.resolve(this)})),i.promise})),s}};return o}}}]),P.factory(w,["$injector","$q","$log","$http","$rootScope",S.serviceName,C.d,f.b,g.b,v.Jb.serviceName,function(e){const t=e.get(f.b),n=e.get("$rootScope"),a=e.get(g.b),i=e.get(v.Jb.serviceName),r=e.get(S.serviceName),s="features.course.content.assessment.group-attempt.activities",o=(e,n)=>{const r=t.open({template:E,scope:e,controller:["$scope",function(e){}]});return r.refresh=function(t){a.performBatch((()=>{const n=e.queuedUsers;e.owner&&(n[e.owner.id]=e.owner),e.queuedUsers={},t.userId&&t.userId!==(e.owner||{}).id&&i.$find(t.userId).$then((t=>{e.owner=t})),t.queue.forEach(((t,a)=>{Object.prototype.hasOwnProperty.call(n,t)?e.queuedUsers[t]=n[t]:i.$find(t).$then((n=>{e.queuedUsers[t]=n}))}))}))},r.scope=e,r.refresh(n),r.result.finally((()=>{r.scope.$destroy()})),r};return{openRequest:e=>{const t=n.$new();let a;return u.extend(t,{hideOK:!0,modalTranslateOptions:{title:{key:`${s}.title_group_member_editing`}},modalStrings:{instructions:r.translateSync({locale:null,key:`${s}.msg_taken_by_other_group_member`}),ok:r.translateSync({locale:null,key:`${s}.takecontrol`}),cancel:r.translateSync({locale:null,key:`${s}.cancel`})},queuedUsers:{},additionalClass:"requesting",okAction:()=>{t.$broadcast(A.USER_REQUEST_CONTROL)},cancelAction:()=>{a.dismiss()}}),a=o(t,e),a},openNotify:e=>{const t=n.$new();let a;return u.extend(t,{hideOK:!1,modalTranslateOptions:{title:{key:`${s}.title_group_member_requesting`}},modalStrings:{instructions:r.translateSync({locale:null,key:`${s}.msg_taking_by_other_group_member`}),ok:r.translateSync({locale:null,key:`${s}.leave`}),cancel:r.translateSync({locale:null,key:`${s}.ignore`})},queuedUsers:{},additionalClass:"notifying",okAction:()=>{t.$broadcast(A.USER_RELEASE_CONTROL)},cancelAction:()=>{a.dismiss()}}),a=o(t,e),a},openDeclined:e=>{const t=n.$new();let a;return u.extend(t,{hideCancel:!0,modalTranslateOptions:{title:{key:`${s}.title_group_member_request_decline`}},modalStrings:{instructions:r.translateSync({locale:null,key:`${s}.msg_control_request_declined`}),ok:r.translateSync({locale:null,key:`${s}.ok`})},queuedUsers:{},additionalClass:"declined",okAction:()=>{a.dismiss()}}),a=o(t,e),a}}}]),P.directive(T,[C.d,y.b,k,function(e,t,n){return{restrict:"A",link:(a,i,r)=>{i.addClass("group-attempt-activities-observe");const s=a.$watch(r[T],(r=>{if(r&&s(),r&&r.groupId&&r.isInProgress()){const s=n.new(e.params.courseId,r.id),o=()=>{s.peek().then((e=>{e.status&&(r.status=e.status),u.extend(a,{groupAttemptOwnerId:e.userId});const n="group-attempt-has-owner";e.userId?i.addClass(n):i.removeClass(n),t(o,a,5e3)}))};o()}}))}}}]);class x{constructor(e){let t;this.delegatee=e,this.isResolvingControl=!1,u.forEach(e,((e,t)=>{this[t]=e}));const n=["$injector","$http","$q","$rootScope",y.b,C.d,v.m.serviceName],a=this;a.resolve=a.resolve||{};const r=e=>{const n=e.get("$q"),a=e.get("$rootScope"),i=e.get(y.b),r=e.get(C.d),s=e.get(v.m.serviceName),o=e.get(k),l=e.get(w);if(!this.isRelatedState(r.next.name))return n.when(!0);if(this.isResolvingControl)return n.reject();this.isResolvingControl=!0;const c=n.defer(),d=r.nextParams;return s.$new(d.courseId).contents.$find(d.contentId||d.assignmentId).$then((e=>{if(!e.isGroupContent)return c.resolve(!0),void(t=null);t=o.new(d.courseId,d.attemptId),t.peek().then((e=>{if(e.userId&&e.myId!==e.userId){a.$broadcast("hideInitialLoadingArea");const t=l.openRequest(e);t.result.then((()=>{}),(()=>{e.release(),c.reject()})),e.request().then((()=>{e.keepAlive((()=>e.myId===e.userId?(t.close(),c.resolve(!0),!1):e.queue.some((t=>e.myId===t))?(t.refresh(e),!0):(t.dismiss("ACCESS_CONTROL_TAKEN"),c.reject(),i((()=>{l.openDeclined(e)}),a,200),!1)))}))}else c.resolve(!0)}))})),c.promise.finally((()=>{this.isResolvingControl=!1}))},s=a.resolve;if(s.translateGroupAttemptControl=[S.serviceName,e=>{e.loadBundle("features/course/content/assessment/group-attempt/activities/group-attempt-activities")}],s.attempt){const e=s.attempt;s.attempt=["contentData"].concat(n).concat(((t,a)=>{const i=a.get("$q"),s=a.get(C.d);return i.when(a.invoke(n.concat(r))).then((()=>a.invoke(e,null,{contentData:t}))).then((e=>this.isRelatedState(s.next.name)&&e.isSubmitted()?(a.get(C.d).goPeekState("assessment.overview.attempt.review",{attemptId:e.id}),i.reject()):e))}))}else s.takeControlOnGroupAttempt=n.concat(r);const o=this,l=o.onExit;o.onExit=n.concat((e=>{this.isRelatedState(e.get(C.d).prev.name)&&(l&&e.invoke(l),t&&(t.release(),(o.__childScope||{$destroy:i.noop}).$destroy()))}));const c=o.onEnter;o.onEnter=n.concat((e=>{const n=e.get("$rootScope"),a=e.get(w),i=e.get(C.d);if(!this.isRelatedState(i.next.name))return;if(c&&e.invoke(c),!t)return;let r,s=!1;const l=()=>{s=!0},d=()=>{s=!1},u=n.$new();u.$on(h.b,l),u.$on(h.d,l),u.$on(h.a,d),u.$on(h.c,d),o.__childScope=u,t.request().then((e=>{e.keepAlive((e=>!!s||!!this.isRelatedState(i.current.name)&&(e.userId!==e.myId?(i.leavePeekState(),!1):(e.userId===e.myId&&e.queue.length>0?r?r.refresh(e):(r=a.openNotify(e),r.result.then((()=>{}),(()=>{e.kickout(),r=null})),r.scope.$on(A.USER_RELEASE_CONTROL,(()=>{r.close(),n.$broadcast(h.e);const t=u.$on("$stateChangeAbort",((n,a)=>{"ABORTED_BY_FILE_UPLOAD"===(a||{}).reason&&(t(),e.kickout()),r=null}))}))):r&&(r.close(),r=null),!0))))}))}))}isRelatedState(e){return O.test(e)}}var $=n("JXhc"),N=n("gkef"),D=n("X455"),L=n("36CG"),j=n("+O05"),M=n("nmzr"),G=n("Sa5G"),R=n("zGdY"),B=n("0B2D"),F=n("kirn");n.d(t,"a",(function(){return U}));const U="ultra.course.content.assessment.routes";const _={onEnter:["contentData","attempt",r.e,C.d,"$stateParams",N.b,function(e,t,n,a,i,r){i.skipTransitionEvents||(!i.viewOriginalityReport||i.forceOpenFeedbackPanel?(a.isPeekPanelOpen()&&n.expandTopPanel(),function(e,t,n,a,i){var r;const s=null===(r=null==e?void 0:e.gradingColumn)||void 0===r?void 0:r.peerGrading,o=n.next.name.includes("assessment-submission-feedback"),l=n.next.name.includes("assessment-submission-feedback-tab"),c=n.next.name.includes("rubric"),d=!n.prev.name,u=i.isSmallBreakpoint();if(s||o||l||c||d||u)return!1;const m=j.a.studentCanViewAttemptGradeAndFeedback(t,e.gradeDetail);return a.forceOpenFeedbackPanel&&m}(e,t,a,i,r)&&a.goPeekState(M.c.ASSESSMENT_ATTEMPT_REVIEW_FEEDBACK_TAB,{attemptId:t.id})):a.goPeekState(M.c.ASSESSMENT_ATTEMPT_REVIEW_ORIGINALITY_TAB))}],onExit:["contentData",r.e,C.d,"$q","$stateParams",function(e,t,n,a,i){if(!i.skipTransitionEvents&&e.gradingColumn.isMultipleAttempts()){let i=a.when();n.isPeekPanelOpen()&&(i=t.shrinkTopPanel()),i.then((()=>{n.goPeekState("assessment.overview.multiple-attempt",{contentId:e.courseContent.id,columnId:e.gradingColumn.id,gradeId:e.gradeDetail.id,courseId:e.courseContent.courseId,viewOriginalityReport:this.viewOriginalityReport})}))}}]};i.module(U,[d.a,C.b,o.c,$.c,I,c.b,L.a,j.g]).config([C.c,c.c,D.b,L.b,(e,t,i)=>{e.peekState("assessment",{abstract:!0,url:"/assessment/{contentId:_[0-9]+_1}?courseId",resolve:{[c.d]:t.resolve}}).peekState("assessment.open",{url:"/open",params:{contentId:null,courseId:null,isCollectExternalSubmissions:!1},routingFunction:[v.m.serviceName,d.b,C.d,(e,t,n)=>{const a=n.nextParams.contentId,i=n.nextParams.courseId,r=n.nextParams.isCollectExternalSubmissions;t.hasAnyCourseEntitlement([G.j.ViewAssessment,G.j.ModifyAssessment],i).then((e=>{if(e)n.goPeekState(M.w.GRADEBOOK_ITEM_ASSESSMENT,{courseId:i,contentId:a,gradeitemView:"details",assessmentType:"test"});else{let e=M.c.ASSESSMENT_OVERVIEW;r&&(e=M.c.ASSESSMENT_EXTERNAL_OVERVIEW),n.goPeekState(e,{courseId:i,contentId:a})}}))}]}).peekState("assessment.overview",{url:"/overview",resolve:{contentData:[c.d,s.b,C.d,L.c,(e,t,n,a)=>t.loadContentAndGrades({course:e,contentId:n.nextParams.contentId,contentExtraExpand:"alignedGoals"}).then((e=>(a.setCurrentContent(e.courseContent),e)))],[D.c]:i.resolve,translations:["$q",S.serviceName,(e,t)=>e.all([t.loadBundle("features/course/goal-alignment/goal"),t.loadBundle("features/course/content/assessment/assessment"),t.loadBundle("components/services/proctoring")])],onEnter:["contentData",l.b,(e,t)=>{t.column=e.gradingColumn}],onExit:[l.b,e=>{e.column=null}]},peekViewName:"assessment-overview-peek@",allowChildPeekStates:!0,peekStates:["conversations",M.n.COURSE_MESSAGE,M.c.ASSESSMENT_PEER_GRADING],pageTitle:"course.content.assessment.overview.pageTitle",require:[()=>Promise.all([n.e(39),n.e(54),n.e(147)]).then(n.bind(null,"Xcx3")),()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(20),n.e(32),n.e(33),n.e(39),n.e(21),n.e(54),n.e(59),n.e(74)]).then(n.bind(null,"F2mp"))]}).peekState(M.c.ASSESSMENT_PEER_GRADING,{panelClass:"full",resolve:{translations:["$q",S.serviceName,(e,t)=>e.all([t.loadBundle("features/course/grades/submission-grading"),t.loadBundle("features/course/grades/submissions-grading")])],currentColumn:a.a.currentColumn,currentContent:a.a.currentContent},url:"/peerReview?columnId&gradeId&userId&attemptId&initialPeerIndex",onExit:["currentColumn",r.e,C.d,(e,t,n)=>{n.goPeekState("assessment.overview",{})}],reloadOnSearch:!1,require:[()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(742)]).then(n.bind(null,"MbeC")),()=>Promise.all([n.e(3),n.e(13),n.e(31),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(22),n.e(33),n.e(34),n.e(44),n.e(45),n.e(23),n.e(58),n.e(66),n.e(67),n.e(72)]).then(n.bind(null,"fVgT"))],pageTitle:"course.grades.peer-grading.title",peekViewName:"peer-grading-peek",peekStates:[]}).peekState(`${M.c.ASSESSMENT_PEER_GRADING_SUBMISSION_FEEDBACK_TAB}`,{url:"/inline-feedback?&mode",pageTitle:"course.content.assessment.feedback.title",panelClass:"full",params:{mode:"inline"},resolve:{translations:[S.serviceName,e=>e.loadBundle("features/course/feedback-authoring/feedback-authoring")]},views:{[`${M.c.ASSESSMENT_PEER_GRADING}@`]:{require:()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18)]).then(n.bind(null,"15AK"))}}}).peekState(M.c.ASSESSMENT_EXTERNAL_OVERVIEW,{url:"/external-overview",panelClass:"full",resolve:{contentData:[c.d,s.b,C.d,L.c,(e,t,n,a)=>t.loadContentAndGrades({course:e,contentId:n.nextParams.contentId}).then((e=>(a.setCurrentContent(e.courseContent),e)))],[D.c]:i.resolve,currentContent:["contentData","$q",(e,t)=>t.when(e.courseContent)],currentColumn:["contentData","$q",(e,t)=>t.when(e.gradingColumn)],translations:["$q",S.serviceName,(e,t)=>e.all([t.loadBundle("features/course/goal-alignment/goal"),t.loadBundle("features/course/content/assessment/assessment")])],onEnter:["contentData",l.b,(e,t)=>{t.column=e.gradingColumn}],onExit:[l.b,e=>{e.column=null}]},peekViewName:"assessment-overview-peek",allowChildPeekStates:!0,peekStates:["conversations",M.n.COURSE_MESSAGE,"rubric-view","rubric-evaluation"],require:[()=>Promise.all([n.e(39),n.e(54),n.e(588)]).then(n.bind(null,"2cT1")),()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(32),n.e(33),n.e(39),n.e(54),n.e(585)]).then(n.bind(null,"8sa/"))]}).peekState("assessment.overview.attempt",new x({url:"/attempt/{attemptId:_[0-9]+_1}",onEnter:[r.e,C.d,(e,t)=>{t.isPeekPanelOpen()&&e.expandTopPanel()}],panelClass:"full",resolve:{currentContent:["contentData",L.c,(e,t)=>(t.setCurrentContent(e.courseContent),e.courseContent)],currentColumn:["contentData",e=>e.gradingColumn],attempt:["$q","contentData",v.m.serviceName,C.d,v.A.serviceName,v.E.serviceName,(e,t,n,a)=>{const i=a.nextParams.attemptId,r=t.courseContent.isGroupContent,s=n.$buildRaw({id:t.courseContent.courseId}).gradebook;return r?t.gradingColumn.getGroupAttemptByGroupAssociationId(t.courseContent.assignedGroups[0].groupAssociationId,!1,i).then((e=>{if(0===e.attempts.length&&e.isInProgress()){const t={expand:"attempts,attempts.toolAttemptDetail,toolAttemptDetail"};return e.withParams(t).$patch(["id"]).$asPromise()}return e.$asPromise()})):s.attempts.$find(i,{expand:["toolAttemptDetail","alignedGoals"].join(",")}).$then((e=>{t.attempt=e})).$asPromise()}]},params:{attemptId:null},peekStates:["conversations",M.n.COURSE_MESSAGE,"assessment-details","edit-file-settings","attempt-safe-assign-setting","rubric-evaluation","rubric-view",M.C.LTI,M.i.CONTENT_MARKET,o.b,$.b],peekViewName:"assessment-attempt-peek",pageTitle:"course.content.assessment.details.pageTitle",require:[()=>n.e(626).then(n.bind(null,"mJUP")),()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(20),n.e(32),n.e(33),n.e(39),n.e(21),n.e(54),n.e(59),n.e(74)]).then(n.bind(null,"F2mp"))]})).peekState("assessment.overview.multiple-attempt",{panelClass:"peek",url:"/multiple-attempt?columnId&gradeId",resolve:{currentColumn:["contentData",e=>e.gradingColumn.$fetch({expand:"associatedRubrics"}).$asPromise()]},params:{viewOriginalityReport:!1},pageTitle:"course.content.assessment.overview.multiple-attempt.pageTitle",require:[()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(34),n.e(44),n.e(45),n.e(661)]).then(n.bind(null,"ykN9"))]}).peekState(M.c.ASSESSMENT_ATTEMPT_IMS_PROCTORING,{url:"/proctoring/attempt?contentId&password&returnToProctoringToolOnEndAssessment",peekStates:["conversations",M.n.COURSE_MESSAGE,"edit-file-settings","attempt-safe-assign-setting","rubric-view",o.b,$.b],resolve:{translations:[S.serviceName,e=>e.loadAllBundles(["components/services/proctoring","features/course/content/assessment/assessment"])],[c.d]:t.resolve,contentData:[c.d,s.b,C.d,(e,t,n)=>t.loadContentAndGrades({course:e,contentId:n.nextParams.contentId})],currentContent:["contentData",e=>e.courseContent],currentColumn:["contentData",e=>e.gradingColumn],attempt:["contentData",j.h,C.d,(e,t,n)=>{const{gradingColumn:a,courseContent:i}=e,r=n.nextParams.password,s=i.isGroupContent,o=i.assignedGroups?i.assignedGroups[0].groupId:null;return t.launchAttempt(a,r,s,o)}],onEnter:["contentData","attempt",C.d,f.b,function(e,t,n,a){var i;const{courseContent:r}=e,s=null==t?void 0:t.$response;if((null==s?void 0:s.status)===R.S.Forbidden)switch(null===(i=null==s?void 0:s.data)||void 0===i?void 0:i.code){case R.i.AttemptCompletedOrForceCompletion:n.goPeekState(M.c.ASSESSMENT_OVERVIEW,{contentId:r.id}).then((()=>{a.open({scope:this.$rootScope,template:B})}));break;case R.i.AttemptPastDue:n.goPeekState(M.c.ASSESSMENT_OVERVIEW,{contentId:r.id}).then((()=>{a.open({scope:this.$rootScope,template:F})}))}}]},require:()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(20),n.e(32),n.e(43),n.e(33),n.e(39),n.e(21),n.e(59),n.e(105),n.e(164)]).then(n.bind(null,"RTst")),pageTitle:"components.services.proctoring.delivery.attempt.pageTitle",peekViewName:"proctored-assessment-peek",panelClass:"full"}).peekState("assessment-details",{panelClass:"peek",url:"/details",resolve:{contentData:[c.d,s.b,C.d,L.c,(e,t,n,a)=>t.loadContentAndGrades({course:e,contentId:n.nextParams.contentId}).then((e=>(a.setCurrentContent(e.courseContent),e)))],translations:["$q",S.serviceName,(e,t)=>e.all([t.loadBundle("features/course/content/assessment/assessment")])]},params:{detailsView:!0,submitToGRD:null},require:[()=>Promise.all([n.e(39),n.e(54),n.e(147)]).then(n.bind(null,"Xcx3")),()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(20),n.e(32),n.e(33),n.e(39),n.e(21),n.e(54),n.e(59),n.e(74)]).then(n.bind(null,"F2mp"))],peekStates:["attempt-safe-assign-setting"]}).peekState(M.c.ASSESSMENT_ATTEMPT_REVIEW,{url:"/review?columnId&contentId",panelClass:"full",resolve:{contentData:["contentData",c.d,s.b,C.d,L.c,(e,t,n,a,i)=>e.gradeDetail.ui.groupAttempt?e:n.loadContentAndGrades({course:t,contentId:a.nextParams.contentId}).then((e=>(i.setCurrentContent(e.courseContent),e)))],[D.c]:i.resolve},require:[()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(33),n.e(34),n.e(44),n.e(45),n.e(58),n.e(157)]).then(n.bind(null,"H0q3"))],..._,params:{commentPanelInitiallyOpen:!1,viewOriginalityReport:!1,forceOpenFeedbackPanel:!1,skipTransitionEvents:!1,peekStateToOpen:null},peekViewName:"assessment-attempt-review-peek",peekStates:["assessment-submission-feedback","conversations",M.n.COURSE_MESSAGE,M.w.SUBMISSION_DEEP_LINK,"rubric-view","originality-report",$.b]}).peekState(M.c.ASSESSMENT_ATTEMPT_REVIEW_FEEDBACK_TAB,{url:"/inline-feedback?attemptId&userId&mode",pageTitle:"course.content.assessment.feedback.title",panelClass:"full",params:{mode:"inline"},resolve:{translations:[S.serviceName,e=>e.loadBundle("features/course/feedback-authoring/feedback-authoring")]},views:{[`${M.c.ASSESSMENT_ATTEMPT_REVIEW}@`]:{require:()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18)]).then(n.bind(null,"15AK"))}},peekStates:[M.C.LTI,M.w.SUBMISSION_DEEP_LINK]}).peekState(M.c.ASSESSMENT_ATTEMPT_REVIEW_RUBRICS_TAB,{url:"/inline-rubric",pageTitle:"course.rubricInline.title",panelClass:"full",views:{[`${M.c.ASSESSMENT_ATTEMPT_REVIEW}@`]:{require:()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(32),n.e(104)]).then(n.bind(null,"5N8L"))}},peekStates:[M.C.LTI,M.w.SUBMISSION_DEEP_LINK]}).peekState(M.c.ASSESSMENT_ATTEMPT_REVIEW_ORIGINALITY_TAB,{url:"/originality-report",pageTitle:"course.content.originalityReport.routeDefinition.routeTitle",panelClass:"full",views:{[`${M.c.ASSESSMENT_ATTEMPT_REVIEW}@`]:{require:()=>n.e(90).then(n.bind(null,"djtz"))}},peekStates:[M.C.LTI,M.w.SUBMISSION_DEEP_LINK]}),e.peekState(M.c.ASSESSMENT_SETTINGS,{panelClass:"peek",url:"/assessmentSettings?contentId?focusEleId?subpanelId",require:()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(20),n.e(21),n.e(574)]).then(n.bind(null,"mUfJ")),pageTitle:"course.content.assessment.windowTitle",resolve:{translations:["$q",S.serviceName,(e,t)=>e.all([t.loadBundle("features/course/goal-alignment/goal"),t.loadBundle("features/course/content/assessment/assessment")])]},peekViewName:"assessment-settings-peek",allowChildPeekStates:!0,peekStates:["assign-graders","course-group","goal-picker-legacy","rubric","proctoring-lti-tool","question-analysis"]}),e.peekState("assign-graders",{panelClass:"full",url:"/assignGraders",require:()=>n.e(636).then(n.bind(null,"BTMz")),pageTitle:"course.content.assessment.settings.delegatedGrading.assignGraders.pageTitle",resolve:{translations:[S.serviceName,e=>e.loadBundle("features/course/content/assessment/assessment")]},peekViewName:"assign-graders-peek"}),e.peekState("attempt-safe-assign-setting",{url:"/safeAssignSetting",require:()=>Promise.all([n.e(1),n.e(2),n.e(5),n.e(637)]).then(n.bind(null,"Sg/T")),params:{submitToGRD:null}}).peekState("assessment-submission-feedback",{url:"/feedback?userId",require:[()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18)]).then(n.bind(null,"15AK")),()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(20),n.e(19),n.e(33),n.e(39),n.e(21),n.e(26),n.e(159)]).then(n.bind(null,"EPkw"))],resolve:{translations:[S.serviceName,e=>e.loadBundle("features/course/feedback-authoring/feedback-authoring")],offCanvasArgs:["offCanvasArgs",e=>(e.overlay=!1,e.disableFocusHandling=!0,e)]},pageTitle:"course.content.assessment.feedback.title"}).peekState(M.w.CREATE_OFFLINE_ATTEMPT,{url:"/create-attempt?expandId&userId&groupId&columnId&contentId",require:()=>n.e(627).then(n.bind(null,"IvpR")),resolve:{translations:[S.serviceName,e=>e.loadBundle("features/course/content/assessment/attempt/create/create-attempt")]},pageTitle:"course.content.assessment.attempt.create.createAttempt",panelClass:"peek"}).peekState("proctoring-lti-tool",{panelClass:"full",url:"/proctoringLtiTool?toolHref&toolSubtitle",resolve:{translations:[S.serviceName,e=>e.loadBundle("components/services/proctoring")]},require:()=>n.e(639).then(n.bind(null,"a478")),pageTitle:"components.services.proctoring.ltiTool.pageTitle"}).peekState(M.w.SUBMISSION_DEEP_LINK,{url:"/submission-deep-link?deepLinkAttemptId&peerIndex",panelClass:"full",require:[()=>n.e(178).then(n.bind(null,"c7nl")),()=>n.e(166).then(n.bind(null,"iA/f"))],peekStates:["assessment-submission-feedback"],peekViewName:"submission-deep-link"}).peekState(M.w.SUBMISSION_DEEP_LINK_FEEDBACK_TAB,{url:"/inline-feedback?mode&deepLinkAttemptId",pageTitle:"course.content.assessment.feedback.title",panelClass:"full",params:{mode:"inline"},resolve:{translations:[S.serviceName,e=>e.loadBundle("features/course/feedback-authoring/feedback-authoring")]},views:{[`${M.w.SUBMISSION_DEEP_LINK}@`]:{require:()=>Promise.all([n.e(3),n.e(13),n.e(0),n.e(1),n.e(2),n.e(4),n.e(5),n.e(6),n.e(8),n.e(7),n.e(9),n.e(11),n.e(10),n.e(12),n.e(14),n.e(15),n.e(16),n.e(17),n.e(18),n.e(184)]).then(n.bind(null,"bKLL"))}},peekStates:["per-assessment-settings",M.C.LTI,M.w.SUBMISSION_DEEP_LINK]}).peekState(M.c.ASSESSMENT_ATTEMPT_RESPONDUS_REQUIREMENT,{url:"/respondusRequirement?contentId",resolve:{translations:[S.serviceName,e=>e.loadBundle("components/services/proctoring")]},panelClass:"full",require:[()=>n.e(671).then(n.bind(null,"nHSO"))],pageTitle:"components.services.proctoring.delivery.attempt.pageTitle"})}])},vYaK:function(e,t,n){"use strict";n.r(t),n.d(t,"serviceName",(function(){return u}));n("QLzv");var a=n("nsO7"),i=n("5MwF"),r=n("ZQey"),s=n("yCC5"),o=n("pjml"),l=n("Rjd/"),c=n("nkTj"),d=n("zGdY");const u=s.t;l.a.factory(u,["restmod","$q","$http",c.c,(e,t,n,l)=>{const c=l.createHooksToFetchParent("course"),u=e.model(i.a.apiBasePath+"/v1/courses").mix({announcements:{hasMany:s.e},assessments:{hasMany:s.f},calendarItems:{hasMany:s.v,path:"calendars/calendarItems"},calendars:{hasOne:s.u},collab:{hasOne:s.w},collabUltra:{hasOne:s.y,path:"collabultra"},contents:{hasMany:s.A},conversions:{hasMany:s.s,path:"convertToUltra"},forums:{hasMany:s.I,path:"discussionboards/default/forums"},entitlements:{hasMany:s.G},gradebook:{hasOne:s.Y},instructorsMembership:{mask:"CU",hasMany:s.N,path:"memberships?roleBucket="+d.y.Teaching},exports:{hasMany:s.H},ltiPlacements:{hasMany:s.ob},memberships:{hasMany:s.N,hooks:c},membershipInvites:{hasMany:s.O,path:"membershipInvites"},messageFolders:{hasMany:s.Q},conversations:{hasMany:s.B},notifications:{hasMany:s.rb},preferences:{hasMany:s.R},schedule:{hasMany:s.T},term:{belongsTo:s.tc,key:"termId"},users:{hasMany:s.N,hooks:c},groups:{hasMany:s.K},rubrics:{hasMany:s.Xb,path:"rubrics"},analyticsReports:{hasMany:s.c,path:"analyticsReports"},tools:{hasMany:s.wc,path:"tools"},contentHandlers:{hasMany:s.wc,path:"contentHandlers"},indicators:{mask:!0,hasMany:s.M,path:"contents/indicators"},startDate:{serialize:"date"},endDate:{serialize:"date"},scormReportItems:{hasMany:s.Zb,path:"scormReportContents"},studentPreview:{hasOne:s.bc,path:"spreview"},conversationCounts:{hasOne:s.B,path:"/conversations/counts"},ui:{mask:!0,init:()=>({convertToUltraTaskStatus:"?"})},isUndecided(){return d.z.Undecided===this.ultraStatus},isClassic(){return d.z.Undecided===this.ultraStatus||d.z.Classic===this.ultraStatus},isUltraConfirmed(){return d.z.Ultra===this.ultraStatus},isUltra(){return d.z.Ultra===this.ultraStatus||this.isUltraPreview()},isUltraPreview(){return d.z.UltraPreview===this.ultraStatus},setUltraStatusDecided(){return this.$send({method:"PATCH",url:this.$scope.$url()+"/"+this.id,data:{ultraStatus:d.z.Ultra}},(function(e){this.ultraStatus=e.data.ultraStatus})).$asPromise()},chooseClassicCourseView(){return this.$send({method:"PATCH",url:this.$scope.$url()+"/"+this.id,data:{ultraStatus:d.z.Classic}},(function(e){this.$unwrap(e.data)})).$asPromise()},isOpen(){return!0===this.isAvailable&&!1===this.isClosed},isOpenClassic(){return this.isOpen()&&this.isClassic()},isOpenNonClassic(){return this.isOpen()&&!this.isClassic()},isPrivate(){return!1===this.isAvailable},appearsAsPrivate(){return"effectiveAvailabilityUnprivileged"in this&&!this.effectiveAvailabilityUnprivileged},isComplete(){return!0===this.isAvailable&&!0===this.isClosed},getStatus(){return this.isAvailable?this.isClosed?r.a.Complete:r.a.Open:r.a.Private},setStatus(e,t){r.a.Complete===e?(this.isAvailable=!0,this.isClosed=!0,this.ui.status=r.a.Complete):r.a.Open===e?(this.isAvailable=!0,this.isClosed=!1,this.ui.status=r.a.Open):r.a.Private===e&&(this.isAvailable=!1,this.isClosed=!1,this.ui.status=r.a.Private),t&&(this.effectiveAvailability=t.effectiveAvailability,this.effectiveAvailabilityUnprivileged=t.effectiveAvailabilityUnprivileged)},canAccess(){return this.ui&&this.ui.isExternal?!!this.ui.externalUrl:this.isUndecided()?this.permissions&&this.permissions.chooseUltraStatus:this.effectiveAvailability},canChooseUltraStatus(){return this.permissions.chooseUltraStatus},canExport(){return this.permissions.export&&!this.isUltraPreview()},canArchive(){return this.permissions.archive&&!this.isUltraPreview()},canCopy(){return this.permissions.copy},canImport(){return this.permissions.import},convertToUltraCourse(){return this.ui.convertToUltraTaskId="",this.ui.convertToUltraTaskStatus="",this.$send({method:"POST",url:this.$scope.$url()+"/"+this.id+"/convertToUltra",data:{id:this.id}},(e=>{this.ui.convertToUltraTaskId=e.data.taskId,this.ui.convertToUltraTaskStatus=e.data.taskStatus,this.ui.conversionTaskTitle=e.data.taskTitle,this.ui.showConversionInProgress=!0,this.ui.showConversionComplete=!1})).$asPromise()},undoCourseConversion(){return this.ui.convertToUltraTaskId="",this.ui.convertToUltraTaskStatus="",this.$send({method:"POST",url:this.$scope.$url()+"/"+this.id+"/convertToUltra/undo",data:{id:this.id}},(e=>{this.ui.convertToUltraTaskId=e.data.taskId,this.ui.convertToUltraTaskStatus=e.data.taskStatus,this.ui.conversionTaskTitle=e.data.taskTitle,this.ui.showConversionInProgress=!0,this.ui.showConversionComplete=!1})).$allow([400,404]).$asPromise()},refreshConvertToUltraStatus(){return this.$send({method:"GET",url:this.$scope.$url()+"/"+this.id+"/convertToUltra/conversionStatus"},(e=>{this.ui.convertToUltraTaskId=e.data.taskId,this.ui.convertToUltraTaskStatus=e.data.taskStatus,this.ui.conversionTaskTitle=e.data.taskTitle})).$allow([404,403]).$asPromise()},getInstructors(){return(this.instructorsMembership||[]).map((e=>e.user))},getBaseRoute(){return this.isOrganization?"base.organizations":"base.courses"},importContents(e,t){return this.$scope.$build().$send({method:"POST",url:this.$scope.$url()+"/"+this.id+"/imports?fileName="+encodeURIComponent(e)+"&fileLocation="+t,data:{cxAction:"CX_ACTION_IMPORT",includeItems:["alignments","announcement","availabilityRule","assessment","content","calendar","collabSessions","glossary","gradebookItems","groups","discussionBoard","settings","staffInformation","tasks","blog","journal","rubric","customArea(bb-retention)","customArea(bb-wiki)"]}},(function(e){this.$unwrap(e.data)})).$asPromise()},copyCourse(e,t,n,a,i,r){return this.$scope.$build().$send({method:"POST",url:this.$scope.$url()+"/"+this.id+"/copy",data:{srcCourseId:e,contentItems:t.contentItems,assessmentItems:t.assessmentItems,rubricItems:t.rubricItems,targetContentId:n,positionBefore:a,positionAfter:i,shouldSendNotifyEmail:r}},(function(e){this.$unwrap(e.data)})).$asPromise()},getImportCopyTaskStatus(e){return this.$scope.$build().$send({method:"GET",url:this.$scope.$url()+"/"+this.id+"/convertToUltra/"+e},(function(e){this.$unwrap(e.data)})).$allow([404]).$asPromise()},getGranularCopyTaskStatus(e=[]){return this.$scope.$build().$send({method:"GET",url:this.$scope.$url()+"/"+this.id+"/ultraConversionReports?taskIds="+e.join()},(function(e){this.$unwrap(e.data)})).$allow([404]).$asPromise()},getTaskErrorDetailMessages(e,t){return t=t||this.$scope.$url()+`/${this.id}/ultraConversionReports/${e}/messages`,this.$scope.$build().$send({method:"GET",url:t},(function(e){this.$unwrap(e.data)})).$asPromise()},canConvert(){return this.permissions.convert},hasSchedule(){return!a.isEmpty(this.schedule)},getLocale(){return this.isLocaleEnforced&&this.locale},isToolAvailable(e){return this.tools.isToolAvailable(e)},getAnnouncementsCount(){return this.$scope.$build().$send({method:"GET",url:this.$scope.$url()+"/"+this.id+"/announcements/counts"},(function(e){this.$unwrap(e.data)})).$asPromise()},getCourseGroupSetCount(){return this.$scope.$build().$send({method:"GET",url:this.$scope.$url()+"/"+this.id+"/groupsets/count"},(function(e){this.$unwrap(e.data)})).$asPromise()},getChildrenCourses(){return this.$scope.$build().$send({method:"GET",url:this.$scope.$url().replace(i.a.apiBasePath,i.a.apiBasePath+"/public")+"/"+this.id+"/children?fields=id,childCourse.name"}).$allow([400]).$asPromise().then((e=>e.$response.data.results&&e.$response.data.results))},attendanceRecordsExist(){return this.$scope.$build().$send({method:"GET",url:`${this.$scope.$url()}/${this.$pk}/attendanceRecords`,params:{limit:"1"}}).$suppressErrorDialog().$asPromise().then((e=>e.$response.data.results&&e.$response.data.results.length>0))},$extend:{Model:{findCourseByCourseId(e,t=!1){let n=this.$collection().$send({method:"GET",url:this.$url()+"/find",params:{courseId:e}});return t&&(n=n.$allow([404])),n.$asPromise().then((e=>{if(e&&e.$response&&200===e.$response.status)return e.$response&&e.$response.data}))}}},$hooks:{"after-fetch":function(){o.t.sortInstructorsMembership(this.instructorsMembership)},"after-feed":function(e){e.instructorsMembership&&this.instructorsMembership.$decode(e.instructorsMembership)}}});return u.mixinCourses=l.getDataMixin(u.findMany.bind(u),"courseId","course"),u}])},vdfi:function(e,t,n){"use strict";n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return u})),n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return p}));var a=n("nsO7"),i=n("Llzl"),r=n("0JpG"),s=n("hlSw"),o=n("TnpK"),l=n("3bn4"),c=n("zGdY");const d="ultra.course.content.assessment.content-goal-alignment",u="ultra.course.content.assessment.content-goal-alignment.service",m="content-goal-alignment",p="content-goal-alignment-for-student",h=["course","goal-alignment","goal"],g="refreshCache";class b{constructor(e){this.$q=null,this.defers=null,this.cachedGoalAlignment=null,this.isLoading=!1,this.$q=e}isReady(){return null!==this.cachedGoalAlignment||this.isLoading}updataState(){this.cachedGoalAlignment=null,this.isLoading=!0}getData(){if(null===this.cachedGoalAlignment){this.defers=this.defers||[];const e=this.$q.defer();return this.defers.push(e),e.promise}return this.cachedGoalAlignment}updateData(e){return this.cachedGoalAlignment=e,this.isLoading=!1,(this.defers||[]).forEach((e=>{e.resolve(this.cachedGoalAlignment)})),this.defers=null,this.cachedGoalAlignment}cleanData(){this.cachedGoalAlignment=null,this.isLoading=!1}}class f extends l.a{constructor(){super(...arguments),this.panelClass="peek content-assessment-goal-peek"}getCache(e){return f.cache=f.cache||new b(e)}resolveGoalAlignableContent(){return["$q","currentContent","currentCourse","currentColumn",r.serviceName,"$injector",g,(e,t,n,a,r,o,l=!1)=>{if(t&&!t.id)return e.when([]);const d=this.getCache(e);return!l&&d.isReady()?e.when(d.getData()):(d.updataState(),e.when(null).then((()=>{if(!t)return o.invoke(s.a.currentContent,null,{currentCourse:n,translations:{}}).then((e=>{t=e}))})).then((()=>{if(!a)return o.invoke(s.a.currentColumn,null,{currentCourse:n,currentContent:t}).then((e=>{a=e}))})).then((()=>e.all([n.contents.$find(t.id,{expand:"alignedGoals,permissions"}).$asPromise(),n.assessments.$buildRaw({id:t.getDeployedAssessment().assessment.id}).questions.$fetch({expand:"alignedGoals"}).$asPromise(),n.gradebook.columns.$find(a.id,{expand:["associatedRubrics","rubricAssociations.rubricDefinition.alignedGoals","rubricAssociations.rubricDefinition.permissions","rubricAssociations.rubricDefinition.rows.alignedGoals"].join(",")}).$asPromise(),r.loadBundle(`features/${h.join("/")}`)]).then((([e,t,a])=>{let s=1;const o=t.map((e=>{if(c.Nb.PresentationOnly!==e.questionType){const t=s++;return i.extend(e,{getContentTitleForGoalAlignment:()=>r.translateSync({locale:n.locale,key:"components.directives.assessment-question.question-title",params:{index:t}})})}return e}));return this.groupGoals(n.contents.$buildRaw(e),o,a,r)})))).then((e=>d.updateData(e))))}]}getPeekStateName(){return m}groupGoals(e,t,n,r){const s=n.rubricAssociations&&n.rubricAssociations.length>0?n.rubricAssociations[0].rubricDefinition:{},o=e.isTest()?"goalsAlignedWithTest":"goalsAlignedWithAssignment";return[{getContentTitleForGoalAlignment:()=>r.translateSync({locale:null,key:`${h.join(".")}.${o}`}),getContentIdForGoalAlignment:i.bind(e,e.getContentIdForGoalAlignment),isCurrentUserEligibleToAlignGoals:i.bind(e,e.isCurrentUserEligibleToAlignGoals),alignedGoals:e.alignedGoals?e.alignedGoals.map((t=>(t.content=e,t))):[],coreContent:e},{getContentTitleForGoalAlignment:()=>r.translateSync({locale:null,key:`${h.join(".")}.goalsAlignedWithQuestions`}),getContentIdForGoalAlignment:()=>e.getContentIdForGoalAlignment()+".all.questions",isCurrentUserEligibleToAlignGoals:()=>!1,alignedGoals:a.flatten(t.map((e=>e.alignedGoals?e.alignedGoals.map((t=>(t.content=e,t))):[])))},{getContentTitleForGoalAlignment:()=>r.translateSync({locale:null,key:`${h.join(".")}.goalsAlignedWithRubric`}),getContentIdForGoalAlignment:()=>e.getContentIdForGoalAlignment()+".all.rubricrows",isCurrentUserEligibleToAlignGoals:()=>!1,alignedGoals:a.flatten((s.rows||[]).map((e=>e.alignedGoals.map((t=>(e.getContentTitleForGoalAlignment=()=>e.header,e.getContentIdForGoalAlignment=function(){return"blackboard.plugin.rubric.api.core.data.RubricRow;"+this.id},t.content=e,t))))))}]}getOverrideSubTitle(){return["currentCourse","currentContent",(e,t)=>t.id?e.contents.$find(t.id).$asPromise().then((e=>e.title)):""]}}f.$inject=["$injector","$q"];class v extends f{resolveGoalAlignableContent(e){return["$q","currentCourse","contentData",r.serviceName,(t,n,a,r)=>{let s=t.when(null);return e?s=t.when(e):a.courseContent.isGroupContent&&a.groupAttempt?s=a.gradingColumn.getGroupAttemptByGroupAssociationId(a.courseContent.assignedGroups[0].groupAssociationId):!a.courseContent.isGroupContent&&a.attempt&&(s=n.gradebook.attempts.$find(a.attempt.id,{expand:"toolAttemptDetail,alignedGoals"}).$asPromise()),t.all([a.courseContent.alignedGoals?a.courseContent.$asPromise():n.contents.$find(a.courseContent.id,{expand:"alignedGoals"}).$asPromise(),s,n.gradebook.columns.$find(a.gradingColumn.id,{expand:["associatedRubrics","rubricAssociations.rubricDefinition.alignedGoals","rubricAssociations.rubricDefinition.permissions","rubricAssociations.rubricDefinition.rows.alignedGoals"].join(",")}).$allow([c.S.Forbidden]).$asPromise(),r.loadBundle(`features/${h.join("/")}`),r.loadBundle("components/directives/assessment/assessment-question")]).then((([e,t,s])=>{const o=[];if(t&&t.$pk){const e=t.getToolAttemptDetailItem(a.gradingColumn.scoreProviderHandle);(e&&e.questionAttempts||[]).forEach((e=>{o.push(i.extend(e.question,{getContentTitleForGoalAlignment:()=>r.translateSync({locale:n.locale,key:"components.directives.assessment-question.question-title",params:{index:e.visibleQuestionNumber}}),getContentIdForGoalAlignment(){return`blackboard.data.qti.asi.AsiObject;${this.id}`},isCurrentUserEligibleToAlignGoals:()=>!1}))}))}return this.groupGoals(e,o,s,r)}))}]}getPeekStateName(){return p}getOverrideSubTitle(){return["contentData",e=>e.courseContent&&e.courseContent.title||""]}}i.module(d,[o.b,r.moduleName]).config([o.c,e=>{[new f,new v].forEach((t=>{e.peekState(t.getPeekStateName(),t)}))}]).value(g,!1).service(u,["$injector",r.serviceName,function(e){return{alignedGoalsCount:-1,resolveGoalAlignableContents(t,n,i,r=!1){return e.invoke((new f).resolveGoalAlignableContent(),null,{currentCourse:t,currentContent:n,currentColumn:i,[g]:r}).then((e=>(this.alignedGoalsCount=a.flatten(a.compact(e.map((e=>e.alignedGoals)))).length,[e,this.alignedGoalsCount])))},resolveGoalAlignableContentsForStudent:(t,n,i)=>e.invoke((new v).resolveGoalAlignableContent(i),null,{currentCourse:t,contentData:n}).then((e=>[e,a.flatten(a.compact(e.map((e=>e.alignedGoals)))).length]))}}])},vhkR:function(e,t,n){"use strict";n.d(t,"a",(function(){return A})),n.d(t,"b",(function(){return P}));var a=n("nsO7"),i=n("Llzl"),r=n("pjml"),s=n("VAMW"),o=n("4nF1"),l=n("Qbdf"),c=n("0JpG"),d=n("12mu"),u=n("sgjL"),m=n("TnpK"),p=n("Sa5G"),h=n("Q/M7"),g=n("fYJU"),b=n("yytE"),f=n("qZC8"),v=n("36CG"),y=n("jhBu"),S=n("lEL+"),C=n("e6jQ"),E=n("zGdY"),I=n("CY5M"),k=n("nmzr"),w=n("FBBZ"),T=n("6fZB"),O=n("IbyE");const A="ultra.components.services.lti",P="lti";class x{constructor(e){this.service=e,this.key=s.d.Lti}getDomainConfigStatusType(e){const t=this.service.getDomainConfigStatusType(e);return t?t.toString():null}getPlacements(e,t=!1){return Object(T.a)(this.service.getPlacements(e,t))}async ltiLaunch({courseId:e,contentId:t,content:n,showPreLaunchPanel:a}){return this.service.ltiLaunch({courseId:e,contentId:t,content:n,showPreLaunchPanel:a})}}class ${constructor(e,t,n,a,i,r,o,l,c,d,u,m,p,h,g,b,f,v){this.$q=e,this.$rootScope=t,this.$stateParams=n,this.$window=a,this.cacheFactory=i,this.contextCourse=r,this.bbLocalize=o,this.modalService=l,this.postMessageDispatcherService=c,this.stateService=d,this.CourseModel=u,this.PartnerContentIdModel=m,this.PartnerSettingsModel=p,this.PlacementModel=h,this.contextUser=g,this.currentContent=b,this.entitlement=f,this.timeout=v,this.shortMaxAge=5e3,this.thirtyMinuteMaxAge=18e5,this.placementCache=i.createCache("PlacementCache",{deleteOnExpire:"passive",maxAge:this.thirtyMinuteMaxAge}),this.placementsCache=i.createCache("PlacementsCache",{deleteOnExpire:"passive",maxAge:this.shortMaxAge}),Object(s.f)(new x(this))}configureAndInitInlineLaunch(e,t){var n;const a=this.$q.defer(),i=this.contextCourse.courseId||this.$stateParams.courseId,r=null!==(n=this.$stateParams.contentId)&&void 0!==n?n:this.$stateParams.id,s=Object(I.i)({bbFileData:e,courseId:i,contentId:r});if(s.linkType){if(!p.g.ExternalLink.isEqualTo(s.linkType)&&t&&t.preventDefault(),s.linkRefId)return this.ltiLaunch(s)}else a.reject({errorMessage:"Failed to render the iframe from src"});return a.promise}getPlacements(e,t=!1){if(t)return this.PlacementModel.$search(e).$asPromise();let n=this.placementsCache.get(i.toJson(e||{}));return n||(n={promise:this.PlacementModel.$search(e).$asPromise()},this.placementsCache.put(i.toJson(e||{}),n)),n.promise}getAvailablePlacements(e,t=!1){return this.getPlacements(e,t).then((e=>e.filter((e=>e.isAvailable()))))}ltiLaunch(e){var t;const n=this.$q.defer();let i;return e.gradeDetail&&O.O.PartnerCloud.isEqualTo(e.gradeDetail.column.scoreProviderHandle)?(i=(null===(t=e.gradeDetail.ui)||void 0===t?void 0:t.attempt)?e.gradeDetail.ui.attempt.groupAttemptId?e.gradeDetail.ui.attempt.groupAttemptId:e.gradeDetail.ui.attempt.id:e.gradeDetail.lastAttemptId,this._getMembership(e.courseId).then((t=>{const a=Object(w.d)({gradableItemId:e.gradeDetail.column.id,courseId:e.gradeDetail.column.courseId,attemptId:i,membershipId:t.id,linkId:e.gradeDetail.column.linkId});this.launch(a,!0),n.resolve()}))):this.$q.all([this.entitlement.hasCourseEntitlement(p.s.ViewAdmin,e.courseId),this._getContent(e.courseId,e.content,e.contentId,e.linkType,e.linkRefId)]).then((([t,i])=>{if(!i||!e.showPreLaunchPanel||t)return this._ltiLaunch(a.merge(e,{content:i})).then(n.resolve,n.reject);this._getMembership(e.courseId).then((t=>{if(!this._isGradable(i)||!this._isStudentInCourse(t))return this._ltiLaunch(a.merge(e,{content:i})).then(n.resolve,n.reject);this.stateService.goPeekState(k.C.LTI_LAUNCH,{courseId:i.courseId,contentId:i.id}).then((()=>{e.showPreLaunchPanel||this.markCompleted(i.id,i.courseId,i),n.resolve()})).catch((e=>{n.reject({errorMessage:"Failed to open the gradable lti launch panel",errorResponse:e})}))}))})).catch((e=>{n.reject({errorMessage:"Failed to get entitlement or course content",errorResponse:e})})),n.promise}markCompleted(e,t,n){return(n?this.$q.resolve(n):this._getContent(t,null,e,null,null)).then((e=>{var t;return this.currentContent.setCurrentContent(e),e&&(null===(t=e.permissions)||void 0===t?void 0:t.canHaveReviewState)&&e.state!==E.u.Completed&&e.inSequence?e.updateState(E.u.Completed,!0):e}))}launch(e,t=!1,n,a,i){e=h.c(e),e=h.a(e,"from_ultra","true");const r=h.b(e),s=this.contextCourse.courseId||this.$stateParams.courseId||r.course_id,o=this.$stateParams.contentId||this.$stateParams.id||r.content_id||r.parentId;return t?(this.$window.open(e),this.timeout((()=>this.markCompleted(o,s)),this.$rootScope,3e3),"lti-service: Link was launched in a new window."):n?e:(a?this.stateService.goPeekState(k.C.LTI_LAUNCH_PEEK,{toolHref:e,courseId:s,contentId:o}).then((()=>{i&&this.stateService.goPeekState(k.C.LTI_EDIT_CLOUD_DOCUMENT)})):this.stateService.goPeekState(k.C.LTI_LAUNCH_FRAME,{toolHref:e}),this.timeout((()=>this.markCompleted(o,s)),this.$rootScope,3e3),"lti-service: Link was launched in a peek panel.")}_ltiLaunch(e){let t;if(e.content){t=this.getLaunchLinkFromContent(e.content);const n=this.getDomainConfigStatusType(e.content);if(!t){if(n&&r.K.LTIStatusType.NeedsApproval===n){const t=this.$rootScope.$new();return t.email=this._getSupportEmail(e.content),t.hasEmail=!!t.email,this.modalService.open({scope:t,template:b,resolve:{translations:[c.serviceName,e=>e.loadBundle("features/course/content/course-content")]}}),this.$q.resolve()}return this.$q.reject({errorMessage:"Attempted to launch an LTI link without a valid launchLink."})}if(void 0!==this.placementExists(e.content)&&!this.placementExists(e.content))return this.$q.reject({errorMessage:"The placement of this LTI Link does not exist"})}else t={link:this._getLaunchLinkFromLinkRef(e)};return this._initLaunchTarget(a.merge(e,{launchLink:t}))}_initLaunchTarget(e){const t=Object(I.l)(e.linkRefId);if(e.content)return this._launchFromContent(e.content,e.launchLink,t,e.launchSettings);if(p.g.LtiPlacement.isEqualTo(e.linkType))return this._getPlacementById(e.linkRefId).then((t=>{let n=e.launchLink.link,a=t.launchInNewWindow;return h.n(t.url)||(n=h.a(n,"target_override","window"),a=!0),E.Hb.ContentItemMessage===t.type&&(p.p.Inline.isEqualTo(this.$stateParams.mode)?(n=h.a(n,"inline","true"),this.$stateParams.id&&(n=h.a(n,"content_id",this.$stateParams.id))):(this.$stateParams.position&&(n=h.a(n,"position",this.$stateParams.position)),this.$stateParams.parentId&&(n=h.a(n,"content_id",this.$stateParams.parentId)),n=h.a(n,"inline","false"))),this.launch(n,a)}),(()=>this.launch(e.launchLink.link)));if(p.g.PartnerCloud.isEqualTo(e.linkType))return this.PartnerSettingsModel.getSettingsById(t).then((t=>this.launch(e.launchLink.link,!t.responsive)));if(p.g.LtiLink.isEqualTo(e.linkType)){const t=e.launchLink.link;return!e.launchInNewWindow&&e.url&&h.n(e.url)?this.$q.resolve(this.launch(t,!1,e.renderAsEmbed)):this.$q.resolve(this.launch(t,!0))}}_launchFromContent(e,t,n,a){const i=e.contentHandler;if(p.g.LtiPlacement.startsWith(i)||p.g.LtiLink.isEqualTo(i)){const n=O.D.CloudDocument===e.contentDetail[i.toString()].itemOrigin;return this.$q.resolve(this.launch(t.link,t.launchNewWindow,!1,n,a))}if(p.g.PartnerCloud.isEqualTo(i)){const a=e.contentDetail;return!n&&a&&a[p.g.PartnerCloud.handle]&&(n=a[p.g.PartnerCloud.handle].providerId),this.PartnerSettingsModel.getSettingsById(n).then((e=>this.launch(t.link,!e.responsive)))}}getLaunchLinkFromContent(e){return Object(I.j)(e)}_getPlacementById(e){let t=this.placementCache.get(e);return t||(t={promise:this.PlacementModel.$find(e).$asPromise()},t.promise.then((()=>{this.placementCache.put(e,t)}))),t.promise}_getLaunchLinkFromLinkRef(e){return Object(I.k)(e)}getDomainConfigStatusType(e){var t,n,a;return(null===(a=null===(n=null===(t=e.contentDetail)||void 0===t?void 0:t[e.contentHandler.toString()])||void 0===n?void 0:n.domainConfig)||void 0===a?void 0:a.statusType)?e.contentDetail[e.contentHandler.toString()].domainConfig.statusType:null}ltiToolProviderExists(e){var t,n;return null===(n=null===(t=e.contentDetail)||void 0===t?void 0:t[e.contentHandler.toString()])||void 0===n?void 0:n.existsLTIProvider}placementExists(e){var t,n;return null===(n=null===(t=e.contentDetail)||void 0===t?void 0:t[e.contentHandler.toString()])||void 0===n?void 0:n.existsPlacement}ltiEditColumn(e){this._getContent(e.courseId,e.ui.content,e.contentId,null,null).then((t=>{e.ui.content=t;const n=o.a.create(t).getEditState();this.stateService.goPeekState(n,{id:t.id})}))}isLTILink(e){return null!=e.scoreProviderHandle&&(O.O.PartnerCloud.isEqualTo(e.scoreProviderHandle)||O.O.LTILink.isEqualTo(e.scoreProviderHandle))}populateNewPlacement(e,t){const n=r.p.ContentHandler.LtiPlacement.handle+"-"+t.handle;e.isAvailable=!1,e.isPartiallyVisible=!1,e.visibility=E.w.Hidden,e.contentHandler=new r.p.ContentHandler(n,null),e.permissions={edit:!0},e.contentDetail={},e.contentDetail[n]={},e.title=t.name.trim().substr(0,333),t.description&&t.description.length>0&&(e.description=t.description.trim().substr(0,250))}_isStudentInCourse(e){return e.isStudentMembership()}_isGradable(e){return!!(e&&e.contentDetail&&e.contentDetail[e.contentHandler.toString()]&&e.contentDetail[e.contentHandler.toString()].gradingColumn)&&!!e.contentDetail[e.contentHandler.toString()].gradingColumn}_getContent(e,t,n,a,i){return t?this.$q.when(t):n?this.CourseModel.$new(e).contents.$find(n).$asPromise():i&&p.g.PartnerCloud.isEqualTo(a)?this.PartnerContentIdModel.getContentIds(e,i).then((t=>t.contentIds&&t.contentIds.length>0?this.CourseModel.$new(e).contents.$find(t.contentIds[0]).$asPromise():this.$q.when(null))):this.$q.when(null)}_getMembership(e){return this.CourseModel.$new(e).users.$find(this.contextUser.userId).$asPromise()}_getSupportEmail(e){return e.contentDetail&&e.contentDetail[e.contentHandler.toString()]&&e.contentDetail[e.contentHandler.toString()].supportEmail?e.contentDetail[e.contentHandler.toString()].supportEmail:null}convertInlineLTILinkToBbMLLink(e){return e.map((e=>{var t,n;const r=e.data;p.g.LtiLink.isEqualTo(e.data.linkType)&&("iframe"===(null===(n=null===(t=e.data)||void 0===t?void 0:t.target)||void 0===n?void 0:n.toLowerCase())&&(r.bbtype="embedded-app",e.data.height&&(r.height=e.data.height),e.data.width&&(r.width=e.data.width),delete r.target),r.linkRefUuid||(r.linkRefUuid=Object(C.b)()));const s={type:i.isDefined(r)&&!p.g.ExternalLink.isEqualTo(r.linkType)?"lti":"external",title:e.title,url:"",data:a.escape(i.toJson(i.isDefined(r)?r:{}))};return i.isDefined(r)&&p.g.ExternalLink.isEqualTo(r.linkType)&&(s.url=r.url),s}))}isEmbeddedGradable(e){let t=!1;return e.forEach((e=>{e.data.gradable&&(t=!0)})),t}returnToContentState(){const e=this.stateService.current.name.split(".peek.");let t=1;e.length>2&&(t=e[e.length-2]===k.i.CONTENT_MARKET?2:1);const n=e.splice(0,e.length-t).join(".peek.");this.stateService.goPeekState(n)}_registerEmbedLinkEventHandler(e,t){this.postMessageDispatcherService.registerEventHandler("embedded-links",((t,n)=>{window!==n&&n.close(),this.returnToContentState();const a=t=>{const n=this.convertInlineLTILinkToBbMLLink(t);e(n.map((e=>({data:e.data,type:e.type.includes("lti")?"lti":"external",url:e.url,title:e.title}))))};this.isEmbeddedGradable(t.items)?this.showEmbeddedNotGradableModal(a,t.items):a(t.items)}),t,!0)}getOpenContentMarketConf(e){return t=>{this._registerEmbedLinkEventHandler(t,e),this.stateService.goPeekState(k.i.CONTENT_MARKET,{mode:"inline"})}}getOpenSystemContentMarketConf(e){return t=>{this._registerEmbedLinkEventHandler(t,e),this.stateService.goPeekState("system-content-market",{mode:"inline"})}}getEditorPluginOptions(e){return{getEmbedSrc:this.configureAndInitInlineLaunch.bind(this),openContentMarket:this.getOpenContentMarketConf(e)}}getYoutubeEditorPluginOptions(){return{courseId:this.contextCourse.courseId,getEmbedSrc:this.configureAndInitInlineLaunch.bind(this)}}showEmbeddedNotGradableModal(e,t){const n=this.$rootScope.$new(!0),a=this.modalService.open({scope:n,template:f,resolve:{translations:[c.serviceName,e=>e.loadBundle("features/course/content-market/content-market")]}});n.dismissCallback=()=>{e(t),a.dismiss()}}}$.$inject=["$q","$rootScope","$stateParams","$window","DSCacheFactory",l.e,c.serviceName,d.b,u.b,m.d,r.m.serviceName,r.S.serviceName,r.U.serviceName,r.L.serviceName,g.b,v.g,y.b,S.b];i.module(A,[l.b,u.a,m.b,v.d,r.N]).service(P,$).config(["$compileProvider",e=>{e.aHrefSanitizationWhitelist(/^\s*(https?|mailto):/)}])},w9Zy:function(e,t,n){"use strict";n.d(t,"d",(function(){return m})),n.d(t,"e",(function(){return p})),n.d(t,"b",(function(){return h})),n.d(t,"c",(function(){return g})),n.d(t,"a",(function(){return f}));var a=n("D57K"),i=(n("NLMr"),n("71td")),r=n("Llzl"),s=n("5MwF"),o=n("9zo4"),l=n("0JpG"),c=n("lEL+"),d=n("TT9l"),u=n("aHpC");const m="ultra.services.BbOffcanvas",p="bbOffcanvas",h="OffCanvasPanelClosed",g="OffCanvasPanelOpened";let b=class{constructor(e,t,n,a,i,r){this.$compile=e,this.$q=t,this.$rootScope=n,this.accessibility=a,this.bbLocalize=i,this.timeout=r,this.document=document,this.openElements=[],this.openElementsPromise=[]}open(e){return this.openOffcanvas(e)}openOffcanvas(e){return this.$q.when(e.template).then((t=>{const n=i(t);if(n.length>1&&!s.a.production)throw new Error("Current page has multiple root element! Please refactor the page to have only one root element");n.attr("data-base-state-name",e.stateName),0===this.openElements.length&&1===this.openElementsPromise.length&&n.addClass("first");const a=e.scope||this.$rootScope,r=(a.$newOffcanvasScope||a.$new).apply(a);this.$rootScope.bbOffcanvasOpened=!1,this.bbOffcanvasOpening=!0;const l=e.opened,c=e.close,u=this;if(e.trapFocus=!1,e.open=()=>{e.disableFocusHandling||u.accessibility.applyAccessibilityHandlingForPanel(n)},o.a.isLastNavigationByKeyboard&&i("body").addClass("hide-focus-outline"),e.opened=function(){u.$compile(n)(r);const t=(...e)=>{u.$rootScope.bbOffcanvasOpened=!0,u.bbOffcanvasOpening=!1,l&&l.apply(this,e),o.a.isLastNavigationByKeyboard&&i("body").removeClass("hide-focus-outline"),u.$rootScope.$broadcast(g)};u.$rootScope.$$phase?t():u.$rootScope.$apply(t),u.accessibility.isElementInActivePanel(i(document.activeElement))||u.accessibility.focusCorrectElementOnPanel(n),n.hasClass("peek")&&n.hasClass("overlay-disabled")&&!e.disableFocusHandling&&u.enableFocusSkipLinks(r)},e.close=(...t)=>(n.hasClass("peek")&&n.hasClass("overlay-disabled")&&!e.disableFocusHandling&&this.disableFocusSkipLinks(),c.apply(this,t)),e.closed=()=>{e.disableFocusHandling||this.accessibility.revertAccessibilityHandling(),this.$rootScope.$broadcast(h)},e.overlay||n.addClass("overlay-disabled"),e.disableFocusHandling){n.addClass("focus-handling-disabled"),n.attr("role","region"),n.attr("aria-label",this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(r),key:"global.panel"}));const e=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(r),key:"global.focusJumpLink"});n.append('<button class="focus-skip-link focus-skip-link-disabled" tabindex="0">'+e+"</button>")}n.bbOffcanvas(e);const m=new f(n,this.accessibility);e.banner&&d.a.pushBanner({state:{stateName:e.stateName,panelClass:e.panelClass},orphan:()=>{m.setBanner()(void 0)},adopt:m.setBanner()}),m.open();const p=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(r),key:"global.close"}),b=n.find(".bb-close");return b&&b.length>0&&(b[0].setAttribute("aria-label",p),b[0].setAttribute("analytics-id",`bb-close.${e.pageTitle}`),n.find(".top-border").length>0&&b.addClass("has-top-border")),n.attr("data-page-title",this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(r),key:e.pageTitle})),m}))}addBbOffcanvasElement(e){this.openElements.push(e),this.synchronizeOffcanvasDepth()}addBbOffcanvasElementPromise(e,t){this.openElementsPromise.push(this.$q.when(e)),this.openElementsPromise[this.openElementsPromise.length-1].then((e=>{e.name=t,this.addBbOffcanvasElement(e),this.openElementsPromise.pop()}),(()=>{this.openElementsPromise.pop()}))}close(e){for(;0!==this.openElements.length;){const t=this.openElements.pop();if(this.synchronizeOffcanvasDepth(),t.close(),this.$rootScope.bbOffcanvasOpened&&t.name===e)break}this.$rootScope.$broadcast(h)}synchronizeOffcanvasDepth(){i(this.document.body).attr("bb-offcanvas-depth",this.openElements.length)}getElement(e){let t;return t=this.openElementsPromise.length?this.$q.all(this.openElementsPromise):this.$q.when(),t.then((()=>this.openElements.filter((t=>t.name===e))[0]))}getTopElement(){return this.getNthElementFromTop(0)}getNthElementFromTop(e){let t=null;return this.openElementsPromise.length>e?t=this.openElementsPromise[this.openElementsPromise.length-e-1]:this.openElements.length>e&&(t=this.openElements[this.openElements.length-e-1]),this.$q.when(t)}getCoursePanel(){let e;return e=this.openElementsPromise.length?this.$q.all(this.openElementsPromise):this.$q.when(),e.then((()=>this.openElements.filter((e=>{const t=e.name.match(/base\.[A-Za-z]+\.peek\.course\.[A-Za-z]+\.peek$/);return t&&0!==t.length}))[0]))}showTopPanelCloseButton(){this.getTopElement().then((e=>{e&&e.showCloseButton()}))}expandTopPanel(){this.getTopElement().then((e=>{e&&!e.isPanelExpanded()&&e.expandPanel()}))}shrinkTopPanel(){return this.getTopElement().then((e=>{e&&e.isPanelExpanded()&&e.expandPanel()}))}safeFocus(e){if(this.bbOffcanvasOpening){const t=this.$rootScope.$watch((()=>this.bbOffcanvasOpening),(n=>{!1===n&&(t(),this.timeout((()=>{e.focus()}),this.$rootScope,0,!1))}))}else this.timeout((()=>{e.focus()}),this.$rootScope,0,!1);this.accessibility.isFocusDelayed=!1}enableFocusSkipLinks(e){this.$q.all([this.getTopElement(),this.getNthElementFromTop(1)]).then((t=>{const[n,a]=t;if(null!=n&&null!=a){const t=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(e),key:"global.focusJumpLabel",noWrap:!0,params:{pageTitle:a.getElement().attr("data-page-title")}}),i=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(e),key:"global.focusJumpLabel",noWrap:!0,params:{pageTitle:n.getElement().attr("data-page-title")}});n.enableFocusSkipLink(a,t),a.enableFocusSkipLink(n,i)}}))}disableFocusSkipLinks(){this.getTopElement().then((e=>{e&&e.disableFocusSkipLink()})),this.getNthElementFromTop(1).then((e=>{e&&e.disableFocusSkipLink()}))}};b=Object(a.a)([Object(a.c)(0,Object(u.b)("$compile")),Object(a.c)(1,Object(u.b)("$q")),Object(a.c)(2,Object(u.b)("$rootScope")),Object(a.c)(3,Object(u.b)(o.c)),Object(a.c)(4,Object(u.b)(l.serviceName)),Object(a.c)(5,Object(u.b)(c.b))],b);class f{constructor(e,t,n){this.element=e,this.accessibility=t,this.name=n}getElement(){return this.element}open(){this.element.addClass("hide-in-background"),this.element.bbOffcanvas("open")}close(){this.element.bbOffcanvas("remove")}setBanner(){return i(this.element)[0].setBanner}expandPanel(){this.element.bbOffcanvas("expandPanel")}isPanelExpanded(){return this.element.hasClass("full")}hideCloseButton(){this.element.find(".bb-close").addClass("bb-close-hide")}showCloseButton(){this.element.find(".bb-close.bb-close-hide").removeClass("bb-close-hide")}enableFocusSkipLink(e,t){this.element.find(".focus-skip-link").removeClass("focus-skip-link-disabled").attr("aria-label",t).on("click.focusSkip",(()=>{this.element.hasClass("peek")?this.accessibility.revertAccessibilityHandling():(this.accessibility.applyAccessibilityHandlingForPanel(e.getElement()),this.accessibility.focusCorrectElementOnPanel(e.getElement()))}))}disableFocusSkipLink(){this.element.find(".focus-skip-link").addClass("focus-skip-link-disabled").off("click.focusSkip")}}r.module(m,[o.b,l.moduleName,c.a]).service(p,b)},w9mJ:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var a=n("Llzl");const i="ultra.service.promiseQueue",r="promiseQueue";class s{constructor(){this.queue=[],this.processing=!1,this.MAX_QUEUE_LENGTH=2e3}enqueue(e){this.queue.length<this.MAX_QUEUE_LENGTH?(this.queue.push(e),this.processQueue()):console.error("Maximum queue length reached. Item was not enqueued.")}enqueueArray(e){if(this.queue.length>0)throw Error("Queue is not currently empty. Cannot queue new array.");if(e.length>this.MAX_QUEUE_LENGTH)throw Error("Too many items to queue. "+e.length+" exceeds maximum of "+this.MAX_QUEUE_LENGTH);e.forEach((e=>{this.queue.push(e)})),this.processQueue()}processQueue(e){if(this.processing)return;const t=this.queue.shift();if(t){this.processing=!0;let n=e;try{t(e).then((e=>{n=e})).finally((()=>{this.processing=!1,this.processQueue(n)}))}catch(e){throw this.processing=!1,e}}}_processQueue(){return this.processQueue()}}class o{constructor(){this.queues=Object.create(null)}getQueue(e){let t=this.queues[e];return t||(t=this.queues[e]=new s),t}}a.module(i,[]).service(r,o)},wDWF:function(e,t,n){"use strict";function a(e){if(!e)return 0;let t=5381,n=e.length;for(;n;)t=33*t^e.charCodeAt(--n);return t>>>0}n.d(t,"a",(function(){return a}))},wQOJ:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return c}));var a=n("D57K"),i=n("5MwF"),r=n("Q/M7"),s=n("aHpC"),o=n("Fvsw");const l="ultra.services.institutionApi",c="institutionApi";var d;!function(e){e.V1="1.0",e.V2="2.0"}(d||(d={}));let u=class{constructor(e,t,n){this.$http=e,this.$q=t,this.context=n,this.getUserCanEdit=e=>this.canEditFetch(e).then((({canEdit:e})=>e),(()=>!1)),this.getUserCanView=e=>this.canEditFetch(e).then((({ipHasVisible:e})=>e>0),(()=>!1)),this.getEffectiveVariantIdWithPermissions=()=>{const e=this.context.getBrand(),t=e.isDefault?null:e.portalBrandId;return this.getEffectivePageVariantId(t).then((e=>this.canEditFetch(e).then((({canEdit:t,ipHasVisible:n})=>({variantId:e,canEdit:t,canView:n>0}))))).catch((()=>({variantId:void 0,canEdit:!1,canView:!1})))},this.getModuleIsVisible=e=>this.getModuleVisibility(e).then((({visible:e})=>e),(()=>!1)),this.getHealth=()=>{if(this.ipHealthPromise)return this.ipHealthPromise;const e=r.c(i.a.institutionApiBasePath+"/health");return this.ipHealthPromise=this.$http.get(e,this._getConfig())},this._getConfig=()=>({headers:{Accept:`application/json; version=${d.V2.toString()}`}})}importIP(){return Promise.all([n.e(3),n.e(35),n.e(37)]).then(n.bind(null,"26Ar")).then((({default:e})=>e))}canEditFetch(e){return this.$q.when(this.importIP().then((t=>t.pageService.canEditFetch(d.V2,e))))}getEffectivePageVariantId(e){return this.$q.when(this.importIP().then((t=>t.pageService.getEffectivePageVariantId(e))))}getModuleVisibility(e){return this.$q.when(this.importIP().then((t=>t.moduleService.getModuleVisibility(e))))}};u=Object(a.a)([Object(a.c)(0,Object(s.b)("$http")),Object(a.c)(1,Object(s.b)("$q")),Object(a.c)(2,Object(s.b)(o.b))],u);angular.module(l,[o.a]).service(c,u)},wWlP:function(e,t,n){"use strict";const a=(()=>{const e=[],t=[];function n(){return e[e.length-1]}function a(){const e=n();t.forEach((t=>t(e)))}return{add:function(t,n){e.push({key:t,value:n}),a()},addTopListener:function(e){t.push(e)},get:function(t){let n;for(let a=0;a<e.length;a++)if(t===e[a].key){n=e[a];break}return n},keys:function(){const t=[];for(let n=0;n<e.length;n++)t.push(e[n].key);return t},top:n,remove:function(t){let n=-1;for(let a=0;a<e.length;a++)if(t===e[a].key){n=a;break}const i=e.splice(n,1)[0];return a(),i},removeTop:function(){const t=e.splice(e.length-1,1)[0];return a(),t},length:function(){return e.length}}})();t.a=a},wylW:function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return u}));var a=n("D57K"),i=n("aHpC"),r=n("tQ/B"),s=n("TnpK"),o=n("Qbdf"),l=n("0JpG"),c=n("ZQFV");const d="course-grades-student-tab",u="CourseGradebookStudentTitleHandler";let m=class extends r.a{constructor(e,t,n,a,i,r){super(e,t,n,a,i),this.$injector=e,this.$rootScope=t,this.ultraState=n,this.bbLocalize=a,this.currentCourse=i,this.$q=r}process(e,t,n){const a=t===c.L.Progress?"course.content.progress.pageTitle":"base.nav.grades";return this.$q.all([this.bbLocalize.translate({key:a,locale:this.bbLocalize.getLocale(this.$rootScope)}),super.getUltraPageName()]).then((([e,t])=>{this.$rootScope.index.title=[e,n,t,this.currentCourse.course.name].filter((e=>!!e)).join(" / ")}))}};m=Object(a.a)([Object(a.c)(0,Object(i.b)("$injector")),Object(a.c)(1,Object(i.b)("$rootScope")),Object(a.c)(2,Object(i.b)(s.d)),Object(a.c)(3,Object(i.b)(l.serviceName)),Object(a.c)(4,Object(i.b)(o.e)),Object(a.c)(5,Object(i.b)("$q"))],m),Object(r.d)(u,m)},"x+T+":function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return o}));var a=n("Llzl"),i=n("pjml");const r="ultra.service.entitlementCache",s="entitlementCache",o="SYSTEM_ENTITLEMENTS";class l{constructor(e,t,n){this.$q=e,this.CourseModel=t,this.EntitlementModel=n,this.entitlements=new Map,this.entitlementDefers=new Map}fetchSystemEntitlements(){return this.EntitlementModel.$collection().$fetch().$asPromise()}fetchCourseEntitlements(e){return this.CourseModel.$new(e).entitlements.$fetch().$asPromise()}loadCourseEntitlements(e){if(!e)return this.$q.resolve();if(this.hasCachedCourseEntitlements(e))return this.$q.resolve();const t=this.$q.defer();if(!this.entitlementDefers.has(e)){let t;this.entitlementDefers.set(e,new Set),t=e===o?this.fetchSystemEntitlements():this.fetchCourseEntitlements(e),t.then((t=>{const n=t.filter((e=>e.hasEntitlement())).map((e=>e.uid));this.entitlements.set(e,new Set(n)),this.entitlementDefers.get(e).forEach((e=>e.resolve()))}),(t=>this.entitlementDefers.get(e).forEach((e=>e.reject(t))))).finally((()=>this.entitlementDefers.delete(e)))}return this.entitlementDefers.get(e).add(t),t.promise}getCachedCourseEntitlements(e){return this.hasCachedCourseEntitlements(e)?this.entitlements.get(e):new Set}hasCachedCourseEntitlements(e){return this.entitlements.has(e)}clearEntitlementCache(e){this.entitlements.delete(e)}}l.$inject=["$q",i.m.serviceName,i.y.serviceName];a.module(r,[i.N]).service(s,l)},x9Ok:function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return l})),n.d(t,"a",(function(){return d}));var a=n("D57K"),i=n("Llzl"),r=n("aHpC"),s=n("ZzR9");const o="ultra.components.services.route.routeListener",l="routeListener";let c=class{constructor(e){this.$rootScope=e}addRouteListener(){this.$rootScope.$on(s.b.$stateChangeSuccess,((e,t,n)=>{const a=t.name;u.emitRouteEvent(d.Changed,a,n)})),this.$rootScope.$on(s.b.$stateChangeStart,((e,t,n)=>{const a=t.name;u.emitRouteEvent(d.Changing,a,n)}))}};c=Object(a.a)([Object(a.c)(0,Object(r.b)("$rootScope"))],c);var d;i.module(o,[]).service(l,c),function(e){e[e.Changed=0]="Changed",e[e.Changing=1]="Changing"}(d||(d={}));const u=new class{constructor(){this.subscribers={[d.Changed]:[],[d.Changing]:[]},this.subscribe(((e,t)=>{this.currentRoute={currentRouteName:e,currentParams:t}}))}subscribe(e,t=d.Changed){return this.subscribers[t].push(e),()=>{this.subscribers[t]=this.subscribers[t].filter((t=>t!==e))}}emitRouteEvent(e,t,n){this.subscribers[e].forEach((e=>e(t,n)))}getCurrentRoute(){return this.currentRoute}};t.b=u},xjJw:function(e,t,n){var a=n("ziER"),i=n("5JeM"),r=new a({id:"icon-small-calendar",use:"icon-small-calendar-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-calendar"><path d="M1 15h14V2H1v13zM5 1v1h6V1H5zM5 12h1M1 6h14M5 9h1M10 12h1M10 9h1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(r);e.exports=r},y3by:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n("nmzr"),i=n("Llzl"),r=n("0JpG"),s=n("TnpK");const o="ultra.course.content-market.router";i.module(o,[r.moduleName,s.b]).config([s.c,e=>{e.peekState(a.i.CONTENT_MARKET,{url:"/contentmarket?parentId&positionBefore&positionAfter&position",require:()=>Promise.all([n.e(31),n.e(86),n.e(161),n.e(616)]).then(n.bind(null,"NZF1")),resolve:{translations:["$q",r.serviceName,(e,t)=>e.all([t.loadBundle("features/course/content-market/content-market"),t.loadBundle("features/course/books-and-tools/books-and-tools")])]},panelClass:"full",pageTitle:"course.contentMarket.contentMarketName",peekStates:["partner-tool",a.C.LTI],params:{mode:null}})}])},yA26:function(e,t,n){"use strict";n.r(t),n.d(t,"moduleName",(function(){return o})),n.d(t,"controllerName",(function(){return l})),n.d(t,"template",(function(){return c})),n.d(t,"requireName",(function(){return d})),n.d(t,"BbOffcanvasController",(function(){return u})),n.d(t,"Controller",(function(){return m}));var a=n("D57K"),i=n("Llzl"),r=n("w9Zy"),s=n("aHpC");const o="ultra.controllers.bbOffcanvas",l="BbOffcavasController",c="",d="components/services/bb-offcanvas/bb-offcanvas-controller";let u=class{constructor(e,t,n){const a=t.open({template:e.template,trapFocus:e.trapFocus,panelClass:e.panelClass||"peek",pageTitle:e.pageTitle,anchor:e.anchor,showType:e.showType,container:e.container,scope:e.scope||n,close:e.close,closed:e.closed,open:e.open,opened:e.opened,overlay:null==e.overlay||e.overlay,stateName:e.stateName,disableFocusHandling:!!e.disableFocusHandling,banner:e.banner});t.addBbOffcanvasElementPromise(a,e.stateName)}};u=Object(a.a)([Object(a.c)(0,Object(s.b)("offCanvasArgs")),Object(a.c)(1,Object(s.b)(r.e)),Object(a.c)(2,Object(s.b)("$scope"))],u);class m extends u{}i.module(o,[r.d]).controller(l,u)},yC9S:function(e,t,n){"use strict";(function(e){n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return o}));var a=n("Llzl"),i=n("nsO7");class r{static OnRootScope(e,t,n){return r.unbindOnDestroy(e,e.$root.$on(t,n))}static OnScope(e,t,n){return r.unbindOnDestroy(e,e.$on(t,n))}static unbindOnDestroy(e,t){return e.$on("$destroy",t),t}static OnWindow(t,n,a){const s=e(window);s.on(t,n);const o=Object(i.once)((()=>s.off(t,n)));return r.unbindOnDestroy(a,o),o}}function s(e){return t=>{if(!e.module&&!e.moduleName)throw Error("Component must define a module or moduleName");(e.module?e.module:a.module(e.moduleName,e.requireModules||[])).component(e.componentName,a.extend(e,{controller:t}))}}class o{constructor(e){this.$ngRedux=e}$onInit(){this.unsubscribeRedux=this.$ngRedux.connect(this.mapStateToProps.bind(this),this.selectActions()||this.mapDispatchToActions.bind(this))(((e,t)=>{this.componentWillReceiveState(e),this.actions=t,this.props=e}))}$onDestroy(){this.unsubscribeRedux()}selectActions(){return{}}mapDispatchToActions(e){return{}}}}).call(this,n("71td"))},yCC5:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return r})),n.d(t,"e",(function(){return s})),n.d(t,"a",(function(){return o})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return c})),n.d(t,"Ub",(function(){return d})),n.d(t,"Vb",(function(){return u})),n.d(t,"h",(function(){return m})),n.d(t,"i",(function(){return p})),n.d(t,"j",(function(){return h})),n.d(t,"k",(function(){return g})),n.d(t,"u",(function(){return b})),n.d(t,"v",(function(){return f})),n.d(t,"D",(function(){return v})),n.d(t,"U",(function(){return y})),n.d(t,"kb",(function(){return S})),n.d(t,"vb",(function(){return C})),n.d(t,"Eb",(function(){return E})),n.d(t,"t",(function(){return I})),n.d(t,"w",(function(){return k})),n.d(t,"y",(function(){return w})),n.d(t,"x",(function(){return T})),n.d(t,"A",(function(){return O})),n.d(t,"E",(function(){return A})),n.d(t,"F",(function(){return P})),n.d(t,"H",(function(){return x})),n.d(t,"z",(function(){return $})),n.d(t,"s",(function(){return N})),n.d(t,"Yb",(function(){return D})),n.d(t,"I",(function(){return L})),n.d(t,"J",(function(){return j})),n.d(t,"P",(function(){return M})),n.d(t,"Q",(function(){return G})),n.d(t,"B",(function(){return R})),n.d(t,"C",(function(){return B})),n.d(t,"N",(function(){return F})),n.d(t,"O",(function(){return U})),n.d(t,"R",(function(){return _})),n.d(t,"S",(function(){return z})),n.d(t,"T",(function(){return q})),n.d(t,"K",(function(){return H})),n.d(t,"L",(function(){return V})),n.d(t,"M",(function(){return W})),n.d(t,"W",(function(){return K})),n.d(t,"G",(function(){return Y})),n.d(t,"l",(function(){return J})),n.d(t,"m",(function(){return Z})),n.d(t,"n",(function(){return Q})),n.d(t,"p",(function(){return X})),n.d(t,"o",(function(){return ee})),n.d(t,"q",(function(){return te})),n.d(t,"V",(function(){return ne})),n.d(t,"X",(function(){return ae})),n.d(t,"cb",(function(){return ie})),n.d(t,"hb",(function(){return re})),n.d(t,"eb",(function(){return se})),n.d(t,"fb",(function(){return oe})),n.d(t,"r",(function(){return le})),n.d(t,"gb",(function(){return ce})),n.d(t,"jb",(function(){return de})),n.d(t,"db",(function(){return ue})),n.d(t,"Y",(function(){return me})),n.d(t,"Z",(function(){return pe})),n.d(t,"ib",(function(){return he})),n.d(t,"bb",(function(){return ge})),n.d(t,"ab",(function(){return be})),n.d(t,"lb",(function(){return fe})),n.d(t,"mb",(function(){return ve})),n.d(t,"nb",(function(){return ye})),n.d(t,"pb",(function(){return Se})),n.d(t,"ob",(function(){return Ce})),n.d(t,"qb",(function(){return Ee})),n.d(t,"rb",(function(){return Ie})),n.d(t,"sb",(function(){return ke})),n.d(t,"tb",(function(){return we})),n.d(t,"ub",(function(){return Te})),n.d(t,"wb",(function(){return Oe})),n.d(t,"Cb",(function(){return Ae})),n.d(t,"yb",(function(){return Pe})),n.d(t,"Ab",(function(){return xe})),n.d(t,"xb",(function(){return $e})),n.d(t,"zb",(function(){return Ne})),n.d(t,"Bb",(function(){return De})),n.d(t,"Db",(function(){return Le})),n.d(t,"Fb",(function(){return je})),n.d(t,"Gb",(function(){return Me})),n.d(t,"Jb",(function(){return Ge})),n.d(t,"Ob",(function(){return Re})),n.d(t,"Lb",(function(){return Be})),n.d(t,"Pb",(function(){return Fe})),n.d(t,"Rb",(function(){return Ue})),n.d(t,"Ib",(function(){return _e})),n.d(t,"Qb",(function(){return ze})),n.d(t,"Nb",(function(){return qe})),n.d(t,"Kb",(function(){return He})),n.d(t,"Mb",(function(){return Ve})),n.d(t,"Hb",(function(){return We})),n.d(t,"Wb",(function(){return Ke})),n.d(t,"Sb",(function(){return Ye})),n.d(t,"Tb",(function(){return Je})),n.d(t,"Xb",(function(){return Ze})),n.d(t,"Zb",(function(){return Qe})),n.d(t,"ac",(function(){return Xe})),n.d(t,"cc",(function(){return et})),n.d(t,"dc",(function(){return tt})),n.d(t,"bc",(function(){return nt})),n.d(t,"ec",(function(){return at})),n.d(t,"fc",(function(){return it})),n.d(t,"gc",(function(){return rt})),n.d(t,"hc",(function(){return st})),n.d(t,"ic",(function(){return ot})),n.d(t,"jc",(function(){return lt})),n.d(t,"kc",(function(){return ct})),n.d(t,"lc",(function(){return dt})),n.d(t,"mc",(function(){return ut})),n.d(t,"nc",(function(){return mt})),n.d(t,"oc",(function(){return pt})),n.d(t,"pc",(function(){return ht})),n.d(t,"qc",(function(){return gt})),n.d(t,"rc",(function(){return bt})),n.d(t,"sc",(function(){return ft})),n.d(t,"tc",(function(){return vt})),n.d(t,"uc",(function(){return yt})),n.d(t,"wc",(function(){return St})),n.d(t,"vc",(function(){return Ct})),n.d(t,"xc",(function(){return Et})),n.d(t,"yc",(function(){return It})),n.d(t,"zc",(function(){return kt}));const a="AnalyticsEventModel",i="AnalyticsForLearnModel",r="AnnotationsModel",s="AnnouncementModel",o="AllyModel",l="AssessmentDetail",c="AssessmentExceptionModel",d="Question",u="QuestionAttempt",m="BlockedUserModel",p="BrandModel",h="CalendarModel",g="CalendarItemModel",b="CourseCalendarsModel",f="CourseCalendarItemModel",v="CourseDueDateCalendarItemModel",y="DueDateCalendarItemModel",S="InstitutionCalendarItemModel",C="OfficeHoursModel",E="PersonalCalendarItemModel",I="CourseModel",k="CourseCollab",w="CourseCollabUltra",T="CourseCollabSession",O="CourseContentModel",A="CourseEngagementParticipant",P="CourseEngagementUserStateModel",x="CourseExportModel",$="CourseConditionalReleaseModel",N="ConversionTaskModel",D="ScheduledTaskModel",L="CourseForumModel",j="CourseForumCountModel",M="CourseMessageModel",G="CourseMessageFolderModel",R="CourseConversationModel",B="CourseConversationMessageModel",F="CourseMembershipModel",U="CourseMembershipInviteModel",_="CoursePreferenceModel",z="CourseRole",q="CourseScheduleModel",H="CourseGroupModel",V="CourseGroupAssociationModel",W="CourseIndicatorModel",K="ExternalCourse",Y="CourseEntitlementModel",J="CloudDriveModel",Z="CloudDriveContent",Q="CloudDriveDownloadMessage",X="CloudDriveTask",ee="CloudDriveMeModel",te="CollabUltraPing",ne="EntitlementModel",ae="FileModel",ie="GradeAttemptModel",re="GradeGroupAttemptModel",se="GradeCategoryModel",oe="GradeColumnModel",le="ColumnSummaryModel",ce="GradeDetailModel",de="GradeSchemaModel",ue="GradeBulkViewModel",me="GradebookModel",pe="GradebookSettingsModel",he="GradeNotationModel",ge="GradedQuestionAttemptModel",be="GradedOriginalityModel",fe="InstitutionRoleModel",ve="LanguagesModel",ye="LtiDomainConfigModel",Se="LtiSettingsModel",Ce="LtiPlacementModel",Ee="MyPreferenceModel",Ie="NotificationModel",ke="NotificationGeneralSettingsModel",we="NotificationSettingModel",Te="NotificationSettingsContainerModel",Oe="PartnerModel",Ae="PartnerStatusModel",Pe="PartnerCourseModel",xe="PartnerLinkedCourseModel",$e="PartnerContentIdModel",Ne="PartnerGradeModel",De="PartnerSettingsModel",Le="PartnerToolModel",je="PredictCourseModel",Me="PredictCourseSearch",Ge="PredictFavoriteModel",Re="PredictPreferences",Be="PredictInstitutionPreference",Fe="PredictSettingsModel",Ue="PredictSystemSettingsModel",_e="PredictDynamicOptionModel",ze="PredictStudentModel",qe="PredictPermissionsModel",He="PredictFtueModel",Ve="PredictNoteModel",We="PredictCustomFieldSettingsModel",Ke="RiskBucketDistributionModel",Ye="PrivacyPolicyModel",Je="ProctoringServiceModel",Ze="Rubric",Qe="ScormReportItemModel",Xe="StreamModel",et="SystemInfoModel",tt="SystemPreferenceModel",nt="StudentPreviewModel",at="TargetedNotificationModel",it="TelemetryActivityVsGradeModel",rt="TelemetryContentActivityInDetailModel",st="TelemetryCourseActivityModel",ot="TelemetryCourseGradesModel",lt="TelemetryCourseNotificationsModel",ct="TelemetryDiscussionActivityModel",dt="TelemetryDiscussionXrayModel",ut="TelemetryMultimediaActivityInDetailModel",mt="TelemetryMultimediaStatisticsModel",pt="TelemetryNotificationsModel",ht="TelemetryNotificationUsersModel",gt="TelemetryStudentActivityModel",bt="TelemetryStudentGradesModel",ft="TelemetrySufficientDataModel",vt="TermModel",yt="ThemeModel",St="ToolAvailabilityModel",Ct="ToolsModel",Et="TrialSupportTicketsModel",It="UploadingFile",kt="UserModel"},yDoS:function(e,t,n){},yGso:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n("Llzl"),i=n("k9iv"),r=n("0JpG"),s=n("w9Zy"),o=n("Fvsw"),l=n("ZzN+"),c=n("pjml"),d=n("TnpK");const u="ultra.base.courses.routes";a.module(u,[i.b,r.moduleName,o.a,s.d,c.N,d.b,l.a]).config([d.c,e=>{e.peekState("external",{abstract:!0}).peekState("external.create",{url:"/external/create",resolve:{translations:[r.serviceName,e=>e.loadBundle("features/base/courses/external/external-course")]},require:()=>Promise.all([n.e(36),n.e(55),n.e(174)]).then(n.bind(null,"hwlu")),pageTitle:"course.external.panelTitleAdd"}).peekState("external.edit",{url:"/external/edit/:id",resolve:{translations:[r.serviceName,e=>e.loadBundle("features/base/courses/external/external-course")]},require:()=>Promise.all([n.e(36),n.e(55),n.e(174)]).then(n.bind(null,"hwlu")),pageTitle:"course.external.panelTitleEdit"}).peekState("external.description",{url:"/external/description/:courseId",resolve:{currentCourse:["$stateParams",c.m.serviceName,c.z.serviceName,(e,t,n)=>{const a=e.courseId;return n.$new(a).$fetch().$asPromise().then((e=>{const n=t.$new();return n.id=e.id,n.name=e.title,n.description=e.description,n.displayName=e.title,n}))}],translations:[r.serviceName,e=>e.loadBundle("features/course/description/course-description")]},require:()=>n.e(170).then(n.bind(null,"8WQs")),pageTitle:"course.description.header"})}])},yXB1:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n("Llzl"),i=n("0JpG"),r=n("TnpK");const s="ultra.course.exports.router";a.module(s,[r.b,i.moduleName]).config([r.c,e=>{e.peekState("exports",{url:"/exportsPanel",resolve:{translations:[i.serviceName,e=>e.loadBundle("features/course/exports/course-export")]},require:()=>Promise.all([n.e(77),n.e(717)]).then(n.bind(null,"m+3A")),pageTitle:"course.export.exportPanel.head"})}])},yZnR:function(e,t){e.exports='<bb-modal id="max-size-warning-modal" class="notification max-size-warning-modal"\n         modal-title-key="components.directives.fileUpload.maxSizeWarningTitle"\n         analytics-id-tag-prefix="max-size-warning-modal"\n         modal-aria-type="alertdialog"\n         >\n  <div name="modal-contents">\n    <p class="warning-message" bb-translate="components.directives.fileUpload.maxSizeWarningMessage" translate-values="{maxFileSize: calculateSizeInMib(maxFileSize)}"></p>\n    <div class="files-info">\n      <ul class="files-info-list">\n        <li ng-repeat="file in overSizedFiles">\n          <p class="file-info" bb-translate="components.directives.fileUpload.maxSizeWarningFiles" translate-values="{fileName: file.name, fileSize: calculateSizeInMib(file.size)}"></p>\n        </li>\n      </ul>\n    </div>\n    <p class="alternate-storage-info">\n      <span bb-translate translate-values="{alternateStorage}">\n        {{shouldRecommendAltStorageLocations ? \'components.directives.fileUpload.maxSizeWarningAlternateStorage\' : \'components.directives.fileUpload.maxSizeWarningNoAlternateStorage\'}}\n      </span>\n      <span ng-if="shouldIncludeSupportLink" ng-bind-html="supportLink"></span>\n    </p>\n  </div>\n  <button name="modal-footer-button-primary" class="button js-primary-button" ng-click="closeModal()" analytics-id="components.directives.fileUpload.maxSizeWarningPrimary">\n      <bb-translate>components.directives.fileUpload.maxSizeWarningPrimary</bb-translate>\n  </button>\n</bb-modal>\n'},"yo/t":function(e,t){e.exports='<div>\n  <div class="notification-container {{::toastStatus()}}">\n    <div class="close-notification">&times;</div>\n    <div class="progress-indicator icon">\n      <i class="{{::toastIcon()}}"></i>\n    </div>\n    <span class="progress-status {{::toastClass()}}">\n    </span>\n  </div>\n</div>\n'},yytE:function(e,t){e.exports='<bb-modal class="notification"\n          modal-title-key="course.content.ltiNeedsApprovalTitle"\n          analytics-id-tag-prefix="course.content.ltiNeedsApproval">\n  <div name="modal-contents">\n    <p ng-if="hasEmail" bb-translate>course.content.ltiNeedsApprovalDescription</p>\n    <p ng-if="hasEmail"><a href="mailto:{{ ::email }}" analytics-id="components.services.lti.needsApproval.email.link">{{ ::email }}</a></p>\n    <p ng-if="!hasEmail" bb-translate>course.content.ltiNeedsApprovalDescriptionNoEmail</p>\n  </div>\n  <button name="modal-footer-button-primary"\n          ng-click="$parent.$dismiss()"\n          class="button js-primary-button"\n          analytics-id="global.ok"\n          bb-translate>global.ok</button>\n</bb-modal>'},z6Q5:function(e,t,n){"use strict";var a=n("nsO7"),i=n("Llzl"),r=n("5MwF"),s=n("lEL+");const o=[];function l(){return o[o.length-1]}n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return u}));const c="ultra.service.batch-utility-rest-api",d="ultra.service.batch-utility-rest-api.service",u="batch-utility-rest-api-param",m=[];function p(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}class h{constructor(e,t,n,a){this.position=e,this.deferred=t,this.reqConfig=n,this.token=a}}let g=0;i.module(c,["ng",s.a]).config(["$httpProvider",function(e){e.interceptors.push(["$injector","$log",(e,t)=>{const n={};return{request(s){const o=e.get("$q");if(s.params&&s.params[u]&&new RegExp("^"+p(s.params[u].baseUrl)).test(s.url)){const c=o.defer(),d=s.params[u];return delete s.params[u],d.trackId=d.trackId||""+g++,Object.prototype.hasOwnProperty.call(n,d.trackId)||(n[d.trackId]={token:d,queue:[]},d.sendDeferred.promise.then((l=d.trackId,function(){const s=n[l],o=new RegExp("^"+p(s.token.baseUrl));!r.a.features.batchRestAPI&&s.token.batchUrl===r.a.apiBasePath+"/v1/utilities/batch"||1===s.queue.length?(delete n[l],e.get("$q").all(s.queue.map((t=>{const n=function(e){return t.deferred.resolve(i.extend({},t.reqConfig,{method:"JSONP",cache:{get:()=>[e.status,e.data,e.headers]}})),{statusCode:e.status,body:e.data,method:t.reqConfig.method,headers:{},relativeUrl:t.reqConfig.url.replace(r.a.apiBasePath+"/","")}};return e.get("$http")(t.reqConfig).then(n,n)}))).then((e=>{s.token.finalDeferred.resolve(e)}))):s.queue.length>1?e.get("$http")({method:"PUT",url:s.token.batchUrl,data:s.queue.map(((e,n)=>{const i=e.reqConfig;return t.debug(`${i.method} ${i.url} will be sent by batch request "${s.token.batchUrl}?xb=${s.token.trackId}[${n}]"`),{method:i.method,relativeUrl:i.url.replace(o,"")+"?"+a(i.params).omitBy(a.isUndefined).map(((e,t)=>`${encodeURIComponent(t)}=${encodeURIComponent(e)}`)).value().join("&"),body:i.data}})),params:{xb:l}}).then((e=>{s.queue.forEach((t=>{const n=t.reqConfig,a=e.data[t.position];t.deferred.resolve(i.extend({},n,{method:"JSONP",cache:{get:()=>[a.statusCode,a.body,a.headers]}}))})),s.token.finalDeferred.resolve(e.data),delete n[l]})):(s.token.finalDeferred.resolve([]),delete n[l])}))),n[d.trackId].queue.push(new h(n[d.trackId].queue.length,c,s,d)),c.promise}var l;return o.when(s)}}}])}]).config(["$provide",function(e){e.decorator("$http",["$delegate",function(e){const t=function(t){var n;return m.length>0&&(t.params=t.params||{},Object.prototype.hasOwnProperty.call(t.params,u)||(t.params[u]=a.last(m))),l()&&l().$emit("BEFORE_REQUEST",t),void 0!==(n=(t.params||{})[u])&&(n.totalRequests=(n.totalRequests||0)+1),e(t)};return function(...e){a.each(e,(function(e){t[e]=function(n,a){return t(i.extend({},a||{},{method:e,url:n}))}}))}("get","delete","head","jsonp"),function(...e){a.each(e,(function(e){t[e]=function(n,a,r){return t(i.extend({},r||{},{method:e,url:n,data:a}))}}))}("post","put","patch"),function(...n){a.each(n,(function(n){Object.defineProperty(t,n,{enumerable:!0,get:()=>e[n],set(t){e[n]=t}})}))}("defaults","pendingRequests"),t}])}]).factory(d,["$rootScope","$q","$log",s.b,function(e,t,n,i){const s={performBatch(e,t,n){const a=this.newToken.apply(this,Array.prototype.slice.call(arguments).splice(1));m.push(a);const i=this.awaitBatch(e);return a.autoSend=!0,i()},awaitBatch(e){if(0===m.length)throw new Error("No batch token in current context! Please invoke in the callstack of performBatch");const i=a.last(m);return i.autoSend=!1,()=>{let r;a.last(m)!==i&&m.push(i),i.autoSend=!0;try{r=e(i)}catch(e){n.error(e)}return m.pop(),i.autoSend&&i.send(),r?t.resolve(r):i.finalDeferred.promise}},newToken(e=r.a.apiBasePath+"/v1/utilities/batch",n=r.a.apiBasePath+"/"){const a=t.defer();return{send(){return this.totalRequests?this.sendDeferred.resolve():this.finalDeferred.resolve([]),this.finalDeferred.promise},sendDeferred:t.defer(),finalDeferred:a,batchUrl:e,baseUrl:n,autoSend:!1,promise:a.promise,totalRequests:0}}};return s}])},zFCC:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return o}));var a=n("nsO7"),i=n("Llzl"),r=n("lEL+");const s="ultra.service.intersectionobserver.directive",o="bbIntersectionObserver";i.module(s,[r.a]).directive(o,[function(){return{restrict:"A",scope:!1,controller:["$scope","$element",r.b,function(e,t,n){if("IntersectionObserver"in window){const t=[],i=new IntersectionObserver((r=>{a(r).map((e=>({entry:e,data:a.find(t,(t=>t.el===e.target))}))).each((({entry:e,data:n})=>{n.fn(n.el,n.scope,e)&&(a.remove(t,(t=>t.el===e.target)),i.unobserve(e.target))})),n(a.noop,e)}),{root:null,rootMargin:"0px",threshold:0});e.$on("$destroy",(function(){i.disconnect()})),Object.assign(this,{link(e,n,r){n.$on("$destroy",(()=>{i.unobserve(e),a.remove(t,(t=>t.el===e))})),i.observe(e),t.push({el:e,scope:n,fn:r})},unlink(e){i.unobserve(e),a.remove(t,(t=>t.el===e))}})}else Object.assign(this,{link(e,t,n){n(e,t,{isIntersecting:!0,boundingClientRect:void 0,intersectionRatio:void 0,intersectionRect:void 0,rootBounds:void 0,target:e,time:void 0})},unlink:a.noop})}]}}])},zIHT:function(e,t){e.exports='<bb-modal id="student-preview-modal" role="alertdialog" class="notification" bb-translate-attrs="{\'aria-label\': \'components.services.studentPreview.modalTitleKey\'}"\n          modal-title-key="{{::courseOrgTokenPrefix}}.studentPreview.modalTitleKey" aria-describedby="first-time-confimation"\n          analytics-id-tag-prefix="course.outline.studentPreview.firstTimeConfirmation">\n  <div name="modal-contents">\n    <bb-svg-icon size="custom" icon="preview-user-avatar"></bb-svg-icon>\n    <p id="first-time-info" bb-translate>\n      {{::courseOrgTokenPrefix}}.studentPreview.firstTimeConfirmation\n    </p>\n  </div>\n  <button name="modal-footer-button-primary"\n          type="button"\n          class="button js-discard-changes js-primary-button"\n          ng-click="$parent.$close()"\n          analytics-id="course.outline.studentPreview.firstTimeConfirmation.startPreview.button">\n    <span bb-translate="components.services.studentPreview.startPreview"></span>\n  </button>\n  <button name="modal-footer-button-secondary"\n          type="button"\n          class="button button--secondary js-cancel-discard js-secondary-button"\n          ng-click="$parent.$dismiss()"\n          analytics-id="course.outline.studentPreview.cancel.button">\n    <span bb-translate="components.services.studentPreview.cancel"></span>\n  </button>\n</bb-modal>\n'},zJP2:function(e,t,n){"use strict";var a=n("9OUN"),i=n("IbyE"),r=n("oPIA"),s=n("td+C"),o=n("TWlR");t.a=new class{constructor(e){this.integrationService=e,this.registerProctoringProvider=(e,t)=>e.proctoringPlacementHandle?this.hasIntegration(e.proctoringPlacementHandle)?(console.warn(`Cannot register provider: ${e.proctoringPlacementHandle} already registered`),void this.integrationService.sendMessage({type:r.I,proctoringPlacementHandle:e.proctoringPlacementHandle,status:r.p.Failure,error:r.Z.ExistingRegistration,errorMessage:"proctoringPlacementHandle already registered"},t)):(this.addIntegration({proctoringPlacementHandle:e.proctoringPlacementHandle,integrationId:t.id}),void this.integrationService.sendMessage({type:r.I,proctoringPlacementHandle:e.proctoringPlacementHandle,status:r.p.Success},t)):(console.warn("Cannot register provider: proctoringPlacementHandle was not specified"),void this.integrationService.sendMessage({type:r.I,proctoringPlacementHandle:e.proctoringPlacementHandle,status:r.p.Failure,error:r.Z.MissingPlacementHandle,errorMessage:"proctoringPlacementHandle was not provided"},t)),this.listeners=new Map}init(e){this.integrationService.addIntegrationMessageType(r.I,this.registerProctoringProvider),this.correlatedMessenger=Object(o.a)(r.J,{}),this.ngRedux=e,this.subscribeToRedux(e)}getProctoringIntegration(e){return this.listeners.get(e)}addIntegration(e){this.listeners.set(e.proctoringPlacementHandle,e)}hasIntegration(e){return void 0!==this.getProctoringIntegration(e)}subscribeToRedux(e){e.connect(null,(e=>Object(a.b)({loadProctoringServices:i.V.proctoringServices.loadProctoringServices},e)))(this)}async loadAvailableProctoringServices(){return await this.loadProctoringServices(),i.Yb.proctoringServices.getAvailableProctoringServices(this.ngRedux.getState())}async loadAvailableProctoringServicesWithIntegration(){return(await this.loadAvailableProctoringServices()).filter((e=>this.hasIntegration(e.handle)))}async loadProctoringService(e){if(!e)return Promise.resolve(void 0);await this.loadProctoringServices();return i.Yb.proctoringServices.getProctoringServices(this.ngRedux.getState()).find((t=>t.handle===e))}async promptIntegrationToSaveSettings(e,t,n,a){const i=this.getProctoringIntegration(e);if(!i)throw new Error(`No proctoring UEF integration registered for ${e}, or it is currently unavailable.`);return this.correlatedMessenger.sendMessage({type:r.J,courseUuid:t,contentId:n,enabled:a,proctoringPlacementHandle:e},i.integrationId)}}(s.a)},zPsu:function(e,t,n){"use strict";var a=n("tN4z"),i=n("ERkP"),r=n("4JTD"),s=n("7nmT"),o=n("uDfI"),l=n("hQuh"),c=n("SToD"),d=n("dJc8"),u=n("zGdY"),m=n("MC1S");const p=["StudentActivityAvailable","StudentGradeDataAvailable","StudentsFallingBehind","StudentsFallingBehindAbsent","StudentsFallingBehindFailing","StudentsFallingBehindAbsentFailing","NoRecentActivity","GradeAtRisk_GradeInLowest","GradeAtRisk_GradeBelowThreshold","GradeLowered","LowActivity","PerformanceIncreased_GradeIncreased","PerformanceIncreased_ActivityIncreased","HighActivity","HighGrade","Calendar","BlogEntryPosted","BlogEntryEdited","BlogEntryComment","JournalEntryPosted","JournalEntryEdited","JournalEntryComment","WikiEntryPosted","WikiEntryEdited","WikiEntryComment"],h={version:1,settings:p.map((e=>({id:e,isEnabled:!0,isEditable:!0})))};var g=n("9EWH");const b="NN",f="ultraui.stream.admin.settings";var v,y;!function(e){e.Email="EM",e.Mobile="MO",e.Stream="DA"}(v||(v={})),function(e){e.DefaultOn="defaultOn",e.DefaultOff="defaultOff",e.AlwaysOn="alwaysOn",e.AlwaysOff="alwaysOff",e.NotApplicable="notApplicable"}(y||(y={}));const S=e=>{let t;t=e&&e.value?JSON.parse(e.value):w();const n=[];return t.settings.forEach((e=>{n.push({context:u.Eb.Course,source:b,event:e.id,method:v.Stream,isEnabled:e.isEnabled,isEditable:e.isEditable})})),C(n)},C=e=>{const t={};return e.forEach((e=>{const n=I(e),a="ns.admin.description."+n.toLowerCase().replace(/_/g,".");if(Object.prototype.hasOwnProperty.call(t,n))t[n].modalities[e.method]={...e,isDirty:!1};else{const i={};i[e.method]={...e,isDirty:!1},t[n]={key:n,title:a,modalities:i}}})),t},E=e=>Object.values(e).filter((e=>e.key.startsWith("COURSE_"))),I=e=>e.context.toString()+"_"+e.source+"_"+e.event,k=(e,t,n)=>{const a=E(e);return null!=t?E(e).sort(((e,a)=>{const i=n(e.title),r=n(a.title);return t===m.SortDirection.Ascending?i.localeCompare(r):r.localeCompare(i)})):a},w=()=>{const e={version:1,settings:[]};return p.forEach((t=>{e.settings.push({id:t,isEnabled:!0,isEditable:!0})})),e},T=e=>{const t=e.split("_NN_").pop();return void 0===t||p.indexOf(t)<0};var O=n("jZnR");class A extends i.PureComponent{render(){const{localize:e,defaultSetting:t,modality:n,onChange:a,analyticsId:r,classes:s}=this.props,{translate:o}=e;return t===y.NotApplicable?i.createElement("div",{className:s.notApplicable},o("ns.admin.modality.option.notApplicable")):i.createElement(m.Dropdown,{defaultSelectedKey:t,options:[{key:y.DefaultOn,text:o("ns.admin.modality.option.defaultOn"),className:"js-default-on"},{key:y.DefaultOff,text:o("ns.admin.modality.option.defaultOff"),className:"js-default-off"},{key:y.AlwaysOn,text:o("ns.admin.modality.option.alwaysOn"),className:"js-always-on"},{key:y.AlwaysOff,text:o("ns.admin.modality.option.alwaysOff"),className:"js-always-off"}],onChanged:e=>{let t,i;switch(e.key.toString()){case"defaultOff":t=!1,i=!0;break;case"alwaysOn":t=!0,i=!1;break;case"alwaysOff":t=!1,i=!1;break;default:t=!0,i=!0}a(n,t,i)},label:o("ns.admin.dropdownLabel"),analyticsId:`${r}`})}}const P=Object(c.a)(Object(d.a)((e=>Object(O.a)({notApplicable:{color:e.palette.text.secondary,fontStyle:"italic"}})),{name:"NotificationMenu"})(A));class x extends i.PureComponent{render(){const{localize:e,key:t,modalityList:n,onChange:a,analyticsId:r,classes:s}=this.props,{translate:o}=e;return i.createElement("table",{className:s.accordionSetting},i.createElement("tbody",null,i.createElement("tr",{className:s.accordionModality},i.createElement("td",{className:s.accordionModalityName},o("ns.admin.modality.type.stream")),i.createElement("td",{className:s.accordionModalityOption},i.createElement(P,{key:t,modality:v.Stream,defaultSetting:n[0],onChange:a,analyticsId:`${r}.streamMenu`}))),i.createElement("tr",{className:s.accordionModality},i.createElement("td",{className:s.accordionModalityName},o("ns.admin.modality.type.email")),i.createElement("td",{className:s.accordionModalityOption},i.createElement(P,{key:t,modality:v.Email,defaultSetting:n[1],onChange:a,analyticsId:`${r}.emailMenu`}))),i.createElement("tr",{className:s.accordionModality},i.createElement("td",{className:s.accordionModalityName},o("ns.admin.modality.type.mobile")),i.createElement("td",{className:s.accordionModalityOption},i.createElement(P,{key:t,modality:v.Mobile,defaultSetting:n[2],onChange:a,analyticsId:`${r}.mobileMenu`})))))}}const $=Object(c.a)(Object(d.a)((e=>Object(O.a)({accordionSetting:{width:"100%"},accordionModality:{height:"62px",borderBottom:`1px solid ${e.palette.secondary.light}`,"&:last-child":{borderBottom:"none"}},accordionModalityName:{paddingLeft:"20px"},accordionModalityOption:{width:"180px",paddingRight:"20px"}})),{name:"AccordionTabContent"})(x));var N=n("/n7R"),D=n("8jBL"),L=n("np6O");class j extends i.PureComponent{render(){const{analyticsId:e,ariaLabel:t,content:n,classes:a}=this.props,r="notificationSettingsTooltip";return i.createElement(N.AnalyticsTooltip,{title:n,id:r,analyticsId:`${e}.tooltip`},i.createElement("div",{className:a.iconButtonWrapper},i.createElement(L.AnalyticsIconButton,{className:"tooltip-button","aria-label":t,"aria-description":r,"data-is-visible":!0,analyticsId:`${e}.tooltipButton`},i.createElement(D.Information,null))))}}const M=Object(d.a)((e=>Object(O.a)({iconButtonWrapper:{"& .tooltip-button":{color:e.palette.secondary.main,[e.breakpoints.up("md")]:{color:e.palette.text.secondary}}}})),{name:"NotificationSettingsTooltipBase"})(j);var G=n("5Jir");const R=i.createContext({});var B=n("IbyE"),F=n("7kIc"),U=n("7O4Y");const _="notificationSetttings.adminPanel";class z extends i.Component{constructor(e){super(e),this.onSettingChange=(e,t,n,a)=>{const{t:i}=this.props,r=((e,t,n,a,i)=>{const r={...e},s=Object(g.a)(r[t].modalities[n.toString()],(e=>{e.isEnabled=a,e.isEditable=i,e.isDirty=!0}));if(r[t].modalities[n.toString()]=s,T(t)){const s=t.split("_");s[0]="ORG";const o=s.join("_"),l=Object(g.a)(e[o].modalities[n.toString()],(e=>{e.isEditable=i,e.isEnabled=a,e.isDirty=!0}));r[o].modalities[n.toString()]=l}return r})(this.state.notificationSettingsMap,n,a,e,t);this.setState((e=>({notificationSettingsMap:r,notificationSettingsList:k(r,e.sortDirection,i)})),(()=>{this.props.onSettingChange()}))},this.getModalitySetting=e=>e?e.isEditable?e.isEnabled?y.DefaultOn:y.DefaultOff:e.isEnabled?y.AlwaysOn:y.AlwaysOff:y.NotApplicable,this.createTableRows=e=>{const{t}=this.props;return e.map((e=>({key:e.key,cells:[i.createElement("span",null,t(e.title)),i.createElement(P,{key:e.key,modality:v.Stream,defaultSetting:this.getModalitySetting(e.modalities[v.Stream]),onChange:(t,n,a)=>this.onSettingChange(n,a,e.key,t),analyticsId:"notificationSetttings.adminPanel.streamMenu"}),i.createElement(P,{key:e.key,modality:v.Email,defaultSetting:this.getModalitySetting(e.modalities[v.Email]),onChange:(t,n,a)=>this.onSettingChange(n,a,e.key,t),analyticsId:"notificationSetttings.adminPanel.emailMenu"}),i.createElement(P,{key:e.key,modality:v.Mobile,defaultSetting:this.getModalitySetting(e.modalities[v.Mobile]),onChange:(t,n,a)=>this.onSettingChange(n,a,e.key,t),analyticsId:"notificationSetttings.adminPanel.mobileMenu"})]})))},this.createAccordionTabs=e=>{const{t}=this.props;return e.map((e=>i.createElement(m.AccordionTab,{key:e.key,title:t(e.title),expanded:!1,showExpander:!0,borderSize:F.Separator.Thin,className:this.props.classes.accordionNotificationTab,contents:i.createElement($,{key:e.key,onChange:(t,n,a)=>this.onSettingChange(n,a,e.key,t),modalityList:[this.getModalitySetting(e.modalities[v.Stream]),this.getModalitySetting(e.modalities[v.Email]),this.getModalitySetting(e.modalities[v.Mobile])],analyticsId:"notificationSetttings.adminPanel.accordionTabContent"}),analyticsId:"notificationSetttings.adminPanel.accordianTab"})))},this.handleTitleSort=e=>{const{t}=this.props;this.setState((n=>({sortDirection:e,notificationSettingsList:k(n.notificationSettingsMap,e,t)})))},this.saveChanges=e=>{(e=>Object.keys(e).some((t=>Object.keys(e[t].modalities).some((n=>e[t].modalities[n].isDirty)))))(e)&&(this.props.persistAdminNotificationMethodSettings((e=>Object.keys(e).reduce(((t,n)=>(T(n)&&Object.keys(e[n].modalities).forEach((a=>{const i=e[n].modalities[a];!0===i.isDirty&&t.push(Object(g.a)(i,(e=>{delete e.isDirty})))})),t)),[]))(e)),this.props.persistAdminRegistrySettings((e=>{const t={version:1,settings:Object.keys(e).reduce(((t,n)=>{if(!T(n)){const a=n.split("_NN_").pop(),i=e[n].modalities[v.Stream];t.push({id:a,isEnabled:i.isEnabled,isEditable:i.isEditable})}return t}),[])};return{key:f,value:JSON.stringify(t)}})(e))),this.props.closePanel()},this.onSpinner=()=>i.createElement("div",{className:this.props.classes.spinnerWrapper},i.createElement(m.Spinner,{size:m.SpinnerSize.xLarge})),this.footer=()=>{const{t:e}=this.props;return i.createElement(m.BbPanelFooter,{primaryButtonProps:{text:e("ns.admin.save"),onClick:()=>this.saveChanges(this.state.notificationSettingsMap)},secondaryButtonProps:{text:e("ns.admin.cancel"),onClick:this.props.closePanel},analyticsId:"notificationSetttings.adminPanel.panelFooter"})},this.state={sortDirection:m.SortDirection.Ascending,isLoading:!0,notificationSettingsMap:{},notificationSettingsList:[]}}onRender(){var e;const{t,classes:n}=this.props,a=[{key:"notification",name:t("ns.admin.notification"),onSort:this.handleTitleSort},{key:"stream",name:t("ns.admin.modality.type.stream")},{key:"email",name:t("ns.admin.modality.type.email")},{key:"mobile",name:t("ns.admin.modality.type.mobile")}],r=this.createTableRows(this.state.notificationSettingsList),s=this.createAccordionTabs(this.state.notificationSettingsList);return(null===(e=this.props.UltraWindowSize)||void 0===e?void 0:e.isLargeBreakpoint())?i.createElement(m.SortableTable,{hasActionableCells:!0,headers:a,rows:r,tableName:t("ns.admin.title"),analyticsId:"notificationSetttings.adminPanel.sortableTable"}):i.createElement("ul",{className:n.accordionTabList},s)}render(){const{t:e,classes:t}=this.props,{isLoading:n}=this.state,a=n?this.onSpinner():this.onRender(),r=n?null:this.footer(),s=e("ns.admin.pageHelpUrl");return i.createElement(R.Provider,{value:{}},i.createElement("div",{className:Object(U.a)("react-container",t.adminPanelWrapper)},i.createElement("div",{className:t.headerWrapper},i.createElement(m.BbPanelHeader,{type:m.BbPanelType.full,title:e("ns.admin.title"),panelContentRight:i.createElement(M,{content:e("ns.admin.tooltipContent"),ariaLabel:e("ns.admin.tooltipAriaLabel"),analyticsId:_}),analyticsId:"notificationSetttings.adminPanel.panelHeader",navMenuAriaLabel:e("global.navigationMenu")})),a,i.createElement("div",{className:t.pageHelpWrapper},i.createElement(m.PageHelp,{url:s,className:"notification-admin-page-help",analyticsId:"notificationSetttings.adminPanel.pageHelp"})),r))}componentDidMount(){const{loadAdminNotificationSettings:e,loadAdminRegistrySettings:t}=this.props;e(),t({key:f})}static getDerivedStateFromProps(e,t){if(!e.isSystemPreferenceLoading&&t.isLoading&&e.adminNotificationSettings.length>0){const t={...C(e.adminNotificationSettings),...S(e.adminRegistrySettings)},{t:n}=e;return{notificationSettingsMap:t,notificationSettingsList:k(t,m.SortDirection.Ascending,n),isLoading:!1}}return null}}const q=Object(o.b)((e=>({adminNotificationSettings:B.Yb.notificationMethodSetting.getAdminNotificationMethodSettings(e),adminRegistrySettings:B.Yb.systemPreference.getSystemPreferenceByKey(e,f),isSystemPreferenceLoading:B.Yb.systemPreference.isSystemPreferenceLoading(e,f)})),{loadAdminNotificationSettings:B.V.notificationMethodSetting.loadAdminNotificationMethodSettings,persistAdminNotificationMethodSettings:B.V.notificationMethodSetting.persistAdminNotificationMethodSettings,loadAdminRegistrySettings:B.V.systemPreference.loadSystemPreference,persistAdminRegistrySettings:B.V.systemPreference.persistSystemPreference})(Object(l.a)(Object(G.windowResizingResponsiveComponentWrapper)(Object(d.a)((e=>Object(O.a)({accordionNotificationTab:{backgroundColor:e.palette.background.default,marginBottom:"12px"},accordionTabList:{overflow:"auto",listStyle:"none",margin:"0",padding:"20px"},adminPanelWrapper:{position:"absolute",left:0,right:0,top:0,bottom:0,display:"flex",flexDirection:"column",backgroundColor:e.palette.background.b3,"& .ms-Panel-header":{[e.breakpoints.up("md")]:{padding:"0 30px"}},"& .bb-AccordionTab-Title-Container":{fontWeight:e.typography.fontWeightSemiBold,padding:"12px 20px"},"& .bb-SortableTable":{padding:"30px"},"& .bb-SortableTableHeaderCell":{borderTop:"none"},"& .ms-Dropdown-label":{position:"absolute",width:"1px",height:"1px",margin:"-1px",padding:"0",overflow:"hidden",border:"0"}},headerWrapper:{backgroundColor:e.palette.background.default},spinnerWrapper:{position:"absolute",left:"50%",top:"50%",marginLeft:"-25px"},pageHelpWrapper:{transition:"top 250ms cubic-bezier(0.55, 0, 0.1, 1)","text-align":"right","z-index":"9999","margin-top":"-38px","pointer-events":"none","& .notification-admin-page-help":{position:"relative",right:"32px",top:"-10px",a:{"pointer-events":"auto"}}}})),{name:"NotificationAdminPanel"})(z)))),H=e=>class extends i.PureComponent{render(){return i.createElement(V.Consumer,null,(t=>i.createElement(e,{...t,...this.props})))}},V=i.createContext({});var W=n("nbDY"),K=n.n(W);class Y extends K.a{}Y.Guest=new Y("GUEST"),Y.Instructor=new Y("INSTRUCTOR"),Y.Student=new Y("STUDENT"),Y.Dual=new Y("DUAL"),Y.None=new Y("NONE");var J=Y;const Z={InstitutionAnnouncements:{id:"InstitutionAnnouncements",displayKey:"ns.streams.category.InstitutionAnnouncements"},CourseAnnouncements:{id:"CourseAnnouncements",displayKey:"ns.streams.category.CourseAnnouncements"},GradedItemDue:{id:"GradedItemDue",displayKey:"ns.streams.category.GradedItemDue"},NewMessages:{id:"NewMessages",displayKey:"ns.streams.category.NewMessages"},NewContent:{id:"NewContent",displayKey:"ns.streams.category.NewContent"},GradesPosted:{id:"GradesPosted",displayKey:"ns.streams.category.GradesPosted"},NewGradeableItems:{id:"NewGradeableItems",displayKey:"ns.streams.category.NewGradeableItems"},GradesNeedReconciling:{id:"GradesNeedReconciling",displayKey:"ns.streams.category.GradesNeedReconciling"},StudentPerformanceAlert:{id:"StudentPerformanceAlert",displayKey:"ns.streams.category.StudentPerformanceAlert"},Discussion:{id:"Discussion",displayKey:"ns.streams.category.Discussion"},GradesAndActivity:{id:"GradesAndActivity",displayKey:"ns.streams.category.GradesAndActivity"},Calendar:{id:"Calendar",displayKey:"ns.streams.category.Calendar"},CourseAvailable:{id:"CourseAvailable",displayKey:"ns.streams.category.CourseAvailable"},Blog:{id:"Blog",displayKey:"ns.streams.category.Blog"},Journal:{id:"Journal",displayKey:"ns.streams.category.Journal"},Wiki:{id:"Wiki",displayKey:"ns.streams.category.Wiki"}};var Q=n("fEQk"),X=n("0x+l");const ee=e=>Object(O.a)({accordionTitleContainer:{display:"flex",alignItems:"center",boxShadow:`0 -1px 0 0 ${e.palette.background.b9} inset`},accordionTitleContents:{flex:"1 1 auto"},accordionContents:{borderBottom:`1px solid ${e.palette.border.main}`},accordionIconButton:{height:"58px"},styledAccordionList:{listStyle:"none",margin:0}});let te=0;class ne extends i.Component{constructor(){super(...arguments),this.onClick=e=>{e.stopPropagation(),e.preventDefault(),this.props.onToggle()}}render(){return i.createElement(L.AnalyticsIconButton,{className:Object(U.a)("js-accordion-expander",this.props.classes.accordionIconButton),onClick:this.onClick,"aria-label":this.props.expanderAriaLabel,"aria-expanded":this.props.open,analyticsId:`${this.props.analyticsId}.${this.props.open?"close":"open"}.items.button`},this.props.open?i.createElement(X.ArrowUp,null):i.createElement(X.ArrowDown,null))}}const ae=Object(d.a)(ee,{name:"AccordionExpander"})(ne);class ie extends i.PureComponent{constructor(e){super(e),this.state={id:"accordion_"+te},te+=1}render(){const{contents:e,expanded:t,onToggle:n,showExpander:a,className:r,title:s,expanderAriaLabelledBy:o,analyticsId:l,expanderAriaLabel:c,classes:d}=this.props,{id:u}=this.state;return i.createElement("li",{className:`js-${r}`},i.createElement("div",{className:d.accordionTitleContainer},i.createElement("div",{className:d.accordionTitleContents},s),a&&i.createElement(ae,{open:t,onToggle:n,analyticsId:l,expanderAriaLabel:c})),t&&i.createElement("div",{className:d.accordionContents,id:`${u}_content`,"aria-labelledby":o},e))}}const re=Object(d.a)(ee,{name:"AccordionTab"})(ie),se=e=>Object(O.a)({categoryCheckbox:{margin:"8px 0",width:"100%"},categoryTriStateCheckboxStyles:{margin:"0"},categoryLabelStyles:{"& span:nth-of-type(2)":{fontSize:"16px",fontWeight:e.typography.fontWeightSemiBold,fontFamily:e.typography.fontFamily,paddingRight:"26px"}},categoryCheckboxStyles:{margin:"12px 0"},categoryList:{listStyle:"none"},categoryListItem:{display:"flex",alignItems:"center",":not(:last-child)":{boxShadow:`0 -1px 0 0 ${e.palette.border.main} inset`}}});class oe extends i.PureComponent{constructor(){super(...arguments),this.onToggle=(e,t)=>{const{definition:n,onSettingsUpdated:a}=this.props;if(a){const e={...this.props.currentSettings};e[n.id]={...e[n.id],isEnabled:t},a(e)}}}render(){var e;const{definition:t,localize:n,currentSettings:r,analyticsId:s,classes:o}=this.props,{translate:l}=n,c=null===(e=t.displayKey.split(".").pop())||void 0===e?void 0:e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),d=!!(r&&r[t.id]&&r[t.id].isEnabled);return i.createElement("li",{className:o.categoryListItem,key:t.id},i.createElement(a.AnalyticsFormControlLabel,{label:l(t.displayKey),className:Object(U.a)(`js-${c}-checkbox`,o.categoryCheckbox),htmlFor:`stream-settings-item-${t.id}`,control:i.createElement(a.AnalyticsCheckbox,{id:`stream-settings-item-${t.id}`,onChange:this.onToggle,checked:d,analyticsId:`${s}.${d?"disable":"enable"}.checkbox`}),analyticsId:`${s}.${d?"disable":"enable"}.label`}))}}const le=Object(c.a)(H(Object(d.a)(se,{name:"StreamSettingsItem"})(oe)));class ce extends i.PureComponent{constructor(e){super(e),this.onAccordionToggle=()=>{1!==this.props.availableNotifications.length&&this.setState((e=>({isOpen:!e.isOpen})))},this.onCategoryToggle=()=>{const e=this.getTriStateCheckboxState(),t={...this.props.currentSettings};this.props.availableNotifications.forEach((n=>{t[n.id]={...t[n.id],isEnabled:e===Q.CheckStateTypesEnum.PARTIAL||e===Q.CheckStateTypesEnum.UNCHECKED}})),this.props.onSettingsUpdated(t)},this.getTriStateCheckboxState=()=>{const e=this.props.availableNotifications.reduce(((e,t)=>e+(this.props.currentSettings&&this.props.currentSettings[t.id]&&this.props.currentSettings[t.id].isEnabled?1:0)),0);return e===this.props.availableNotifications.length?Q.CheckStateTypesEnum.CHECKED:e?Q.CheckStateTypesEnum.PARTIAL:Q.CheckStateTypesEnum.UNCHECKED},this.state={isOpen:!1}}getAccordionId(){return this.props.category.id.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}renderCheckbox(){const{localize:e,analyticsId:t,classes:n}=this.props,{translate:r}=e,s=this.getTriStateCheckboxState()===Q.CheckStateTypesEnum.CHECKED,o=this.getAccordionId();return i.createElement(a.AnalyticsFormControlLabel,{label:r(this.props.category.displayKey),className:Object(U.a)(`js-${o}-category`,n.categoryCheckboxStyles,n.categoryLabelStyles),htmlFor:`stream-setting-label-${o}`,control:i.createElement(a.AnalyticsCheckbox,{id:`stream-setting-label-${o}`,onChange:this.onCategoryToggle,checked:s,analyticsId:`${t}.item.${s?"disable":"enable"}.checkbox`}),analyticsId:`${t}.item.${s?"disable":"enable"}.label`})}renderTristateCheckbox(e){const{localize:t,analyticsId:n,classes:r}=this.props,{translate:s}=t,o=this.getTriStateCheckboxState(),l=this.getAccordionId(),c=o!==Q.CheckStateTypesEnum.CHECKED?"enable":"disable";return i.createElement(a.AnalyticsFormControlLabel,{label:s("ns.streams.category.itemWithMultipleContent",{categoryName:s(this.props.category.displayKey),numContents:e}),className:Object(U.a)(`js-${l}-category`,r.categoryTriStateCheckboxStyles,r.categoryLabelStyles),htmlFor:`stream-setting-id-${l}`,control:i.createElement(a.AnalyticsCheckbox,{id:`stream-setting-id-${l}`,checked:this.getTriStateCheckboxState()===Q.CheckStateTypesEnum.CHECKED,indeterminate:this.getTriStateCheckboxState()===Q.CheckStateTypesEnum.PARTIAL,onChange:this.onCategoryToggle,analyticsId:`${n}.category.${c}.checkbox`}),analyticsId:`${n}.category.${c}.label`})}renderTitle(){const{availableNotifications:e}=this.props,t=e.length;return t>1?this.renderTristateCheckbox(t):this.renderCheckbox()}renderContents(){return i.createElement("ul",{className:this.props.classes.categoryList},this.props.availableNotifications.map((e=>i.createElement(le,{definition:e,key:e.id,analyticsId:`${this.props.analyticsId}.${e.displayKey.replace(" ","")}`}))))}render(){const e=this.props.availableNotifications.length>0,t=this.props.availableNotifications.length>1;if(!e)return null;const{translate:n}=this.props.localize;return i.createElement(re,{title:this.renderTitle(),contents:this.renderContents(),className:this.getAccordionId(),expanded:this.state.isOpen,onToggle:this.onAccordionToggle,showExpander:t,expanderAriaLabel:n(this.props.category.displayKey),analyticsId:`${this.props.analyticsId}.category.tab`})}}const de=Object(c.a)(H(Object(d.a)(se,{name:"StreamSettingsCategory"})(ce)));class ue extends i.PureComponent{constructor(){super(...arguments),this.filterSettings=e=>{const t={membership:this.getCurrentMembership(),settingsMap:this.props.notificationSettingsMap};return zt.filter((n=>n.category===e&&n.isStreamSettingVisible(t)))}}render(){return i.createElement("ul",{className:this.props.classes.styledAccordionList},Object.values(Z).map((e=>i.createElement(de,{key:e.id,category:e,availableNotifications:this.filterSettings(e),analyticsId:`notificationSettings.stream.panel.categoryList.item.${e.displayKey.replace(" ","")}`}))))}getCurrentMembership(){return this.props.userEnrolledInCourse?this.props.isInstructor&&!this.props.isStudent?J.Instructor:!this.props.isInstructor&&this.props.isStudent?J.Student:this.props.isGuest?J.Guest:J.Dual:J.None}}const me=Object(c.a)(H(Object(d.a)(ee,{name:"StreamSettingsList"})(ue)));class pe extends i.PureComponent{constructor(e){super(e),this.onSettingsUpdated=e=>{this.setState({currentSettings:e}),this.props.onSettingsUpdated(e)};const t=C(e.adminNotificationSettings);this.state={currentSettings:e.currentSettings,notificationSettingsMap:t}}componentDidMount(){const{loadAdminRegistrySettings:e}=this.props;e({key:f})}static getDerivedStateFromProps(e,t){if(!e.isSystemPreferenceLoading&&e.adminNotificationSettings.length>0){const n={...C(e.adminNotificationSettings),...S(e.adminRegistrySettings)};return{currentSettings:t.currentSettings,notificationSettingsMap:n}}return null}getHelpMessage(){const{t:e,userEnrolledInCourse:t,isInstructor:n,isGuest:a,isStudent:i}=this.props;return e(t?a&&!i&&!n?"ns.panel.helpMessage.guest":n?"ns.panel.helpMessage.instructor":"ns.panel.helpMessage.student":"ns.panel.helpMessage.noEnrollment")}render(){const{t:e}=this.props;return i.createElement(V.Provider,{value:{currentSettings:this.state.currentSettings,onSettingsUpdated:this.onSettingsUpdated,isInstructor:this.props.isInstructor,isStudent:this.props.isStudent,isGuest:this.props.isGuest,userEnrolledInCourse:this.props.userEnrolledInCourse}},i.createElement("h2",{className:this.props.classes.panelTitle},e("ns.panel.title")),i.createElement("div",null,this.getHelpMessage()),!this.props.isSystemPreferenceLoading&&this.state.notificationSettingsMap?i.createElement(me,{notificationSettingsMap:this.state.notificationSettingsMap}):i.createElement("div",{className:this.props.classes.spinnerWrapper},i.createElement(m.Spinner,{size:m.SpinnerSize.xLarge})))}}const he=Object(o.b)((e=>({adminRegistrySettings:B.Yb.systemPreference.getSystemPreferenceByKey(e,f),isSystemPreferenceLoading:B.Yb.systemPreference.isSystemPreferenceLoading(e,f)})),{loadAdminRegistrySettings:B.V.systemPreference.loadSystemPreference})(Object(l.a)(Object(d.a)((e=>Object(O.a)({panelTitle:{fontSize:"20px !important",fontWeight:e.typography.fontWeightSemiBold,fontFamily:e.typography.fontFamily+" !important",marginBottom:"17px !important",lineHeight:"28px !important"},spinnerWrapper:{position:"absolute",left:"50%",top:"50%",marginLeft:"-25px"}})),{name:"StreamSettingsPanel"})(pe))),ge=e=>t=>Ie(e,t.settingsMap)&&(t.membership===J.Dual||t.membership===J.Student),be=e=>t=>Ie(e,t.settingsMap)&&(t.membership===J.Dual||t.membership===J.Instructor),fe=e=>t=>Ie(e,t.settingsMap)&&t.membership!==J.None&&t.membership!==J.Guest,ve=e=>t=>Ie(e,t.settingsMap),ye=e=>t=>ke(e,t),Se=e=>(t,n)=>we(e,t,n);var Ce;!function(e){e.Announcement="bb-announcement",e.Blog="bb_blog",e.Calendar="bb_calendar",e.Grades="bb_mygrades",e.Message="bb_message",e.Nautilus="bb-nautilus",e.Wiki="bb_Wiki",e.Telemetry="bb_tel"}(Ce||(Ce={}));const Ee=(e,t)=>t.some((t=>t.includes(e))),Ie=(e,t)=>{if(!e||0===e.length)return!0;for(let n=0;n<e.length;n+=1){const a=e[n],i=t[Te(a)];if(i){const e=i.modalities[v.Stream];if(e&&e.isEditable)return!0}}return!1},ke=(e,t)=>{if(!e)return!1;for(const n of e){const e=t.find((e=>n===`${e.source}:${e.event}`&&v.Stream===e.method));if(e&&e.isEnabled)return!0}return!1},we=(e,t,n)=>{if(!e||0===e.length)return t;const a=e.reduce(((e,t)=>{const a=n.find((e=>t===`${e.source}:${e.event}`&&v.Stream===e.method));return a&&e.push(a),e}),[]);return a.length&&a.every((e=>!e.isEditable))?a.some((e=>e.isEnabled)):t},Te=e=>"COURSE_"+e.replace(":","_");var Oe,Ae;!function(e){e.BlogEntryComment="NN:BlogEntryComment",e.BlogEntryEdited="NN:BlogEntryEdited",e.BlogEntryPosted="NN:BlogEntryPosted",e.Calendar="NN:Calendar",e.GradeAtRisk_GradeBelowThreshold="NN:GradeAtRisk_GradeBelowThreshold",e.GradeAtRisk_GradeInLowest="NN:GradeAtRisk_GradeInLowest",e.GradeLowered="NN:GradeLowered",e.HighActivity="NN:HighActivity",e.HighGrade="NN:HighGrade",e.JournalEntryComment="NN:JournalEntryComment",e.JournalEntryEdited="NN:JournalEntryEdited",e.JournalEntryPosted="NN:JournalEntryPosted",e.LowActivity="NN:LowActivity",e.NoRecentActivity="NN:NoRecentActivity",e.PerformanceIncreased_ActivityIncreased="NN:PerformanceIncreased_ActivityIncreased",e.PerformanceIncreased_GradeIncreased="NN:PerformanceIncreased_GradeIncreased",e.StudentActivityAvailable="NN:StudentActivityAvailable",e.StudentGradeDataAvailable="NN:StudentGradeDataAvailable",e.StudentsFallingBehind="NN:StudentsFallingBehind",e.StudentsFallingBehindAbsent="NN:StudentsFallingBehindAbsent",e.StudentsFallingBehindAbsentFailing="NN:StudentsFallingBehindAbsentFailing",e.StudentsFallingBehindFailing="NN:StudentsFallingBehindFailing",e.WikiEntryComment="NN:WikiEntryComment",e.WikiEntryEdited="NN:WikiEntryEdited",e.WikiEntryPosted="NN:WikiEntryPosted"}(Oe||(Oe={})),function(e){e.AssessmentAttemptAvailableResent="TE:TE_AVAIL_RESEND",e.AssessmentAvailable="TE:TE_AVAIL",e.AssessmentDue="TE:DUE",e.AssessmentNeedsGrading="TE:TE_SUBMIT",e.AssesmentOverdue="TE:OVERDUE",e.GroupAssessmentNeedsGrading="TE:TE_GT_SUBMIT",e.LateAssessmentNeedsGrading="TE:TE_SUBMIT_LATE",e.LateGroupAssessmentNeedsGrading="TE:TE_GT_SUBMIT_LATE",e.PeerSubmissionAttemptAvailableResent="PS:PS_AVAIL_RESEND",e.PeerSubmissionAvailable="PS:PS_AVAIL",e.PeerSubmissionDue="PS:DUE",e.PeerSubmissionNeedsGrading="PS:PS_SUBMIT",e.PeerSubmissionOverdue="PS:OVERDUE",e.LatePeerSubmissionNeedsGrading="PS:PS_SUBMIT_LATE",e.PeerEvaluationAttemptAvailableResent="PE:PE_AVAIL_RESEND",e.PeerEvaluationAvailable="PE:PE_AVAIL",e.PeerEvaluationDue="PE:DUE",e.PeerEvaluationNeedsGrading="PE:PE_SUBMIT",e.PeerEvaluationOverdue="PE:OVERDUE",e.LatePeerEvaluationNeedsGrading="PE:PE_SUBMIT_LATE",e.AssignmentAvailable="AS:AS_AVAIL",e.AssignmentAvailableResend="AS:AS_AVAIL_RESEND",e.AssignmentDue="AS:DUE",e.AssignmentNeedsGrading="AS:AS_ATTEMPT",e.AssignmentOverdue="AS:OVERDUE",e.GroupAssignmentAvailable="AS:AS_GA_AVAIL",e.GroupAssignmentAvailableResend="AS:AS_GA_AVAIL_RESEND",e.GroupAssignmentNeedsGrading="AS:AS_GA_ATTEMPT",e.LateAssignmentNeedsGrading="AS:AS_LATE_ATTEMPT",e.LateGroupAssignmentNeedsGrading="AS:AS_GA_LATE_ATTEMPT",e.BlogNeedsGrading="BL:BL_ATTEMPT",e.GroupBlogNeedsGrading="BL:BL_GR_ATTEMPT",e.ForumNeedsGrading="DF:DF_ATTEMPT",e.GroupForumNeedsGrading="DF:DF_GR_ATTEMPT",e.GroupThreadNeedsGrading="DT:DT_GR_ATTEMPT",e.ThreadNeedsGrading="DT:DT_ATTEMPT",e.GradebookAttemptUpdate="GB:GB_ATT_UPDATED",e.GradebookItemDue="GB:DUE",e.GradebookItemOverdue="GB:OVERDUE",e.GradebookNeedsReconciliation="GB:GB_NEEDS_RECON",e.ManualGradeCleared="GB:GB_GRA_CLEARED",e.ManualGradeUpdated="GB:GB_GRA_UPDATED",e.GroupJournalNeedsGrading="JN:JN_GR_ATTEMPT",e.JournalNeedsGrading="JN:JN_ATTEMPT",e.LateScormItemNeedsGrading="SC:SC_SUBMIT_LATE",e.ScormItemAvailable="SC:SC_AVAIL",e.ScormItemDue="SC:DUE",e.ScormItemOverdue="SC:OVERDUE",e.ScormItemNeedsGrading="SC:SC_SUBMIT",e.ScormItemGradeUpdated="SC:SC_GRA_UPDATED",e.SurveyAvailable="SU:SU_AVAIL",e.SurveyDue="SU:DUE",e.SurveyOverdue="SU:OVERDUE",e.SurveySubmitted="SU:SU_SUBMIT",e.GroupWikiNeedsGrading="WK:WK_GR_ATTEMPT",e.WikiNeedsGrading="WK:WK_ATTEMPT",e.AnnouncementAvailable="AN:AN_AVAIL",e.ContentAvailable="CO:CO_AVAIL",e.CourseAvailable="CR:CR_AVAIL",e.CourseMessageReceived="CM:CM_RCVD",e.QuotaAvailable="QU:QU_AVAIL"}(Ae||(Ae={}));const Pe=[Ae.AnnouncementAvailable],xe={id:"InstitutionAnnouncements",category:Z.InstitutionAnnouncements,displayKey:"",canHandle:e=>Ee(e.type,[Ae.AnnouncementAvailable])&&e.providerId===Ce.Announcement,defaultSetting:ye(Pe),isStreamEntryVisible:Se(Pe),isStreamSettingVisible:ve(Pe)},$e=[Ae.AssessmentDue,Ae.AssignmentDue,Ae.ScormItemDue,Ae.SurveyDue,Ae.GradebookItemDue,Ae.PeerSubmissionDue,Ae.PeerEvaluationDue],Ne=[Ae.AssesmentOverdue,Ae.AssignmentOverdue,Ae.ScormItemOverdue,Ae.SurveyOverdue,Ae.GradebookItemOverdue,Ae.PeerSubmissionOverdue,Ae.PeerEvaluationOverdue],De={id:"GradedItemDue",category:Z.GradedItemDue,displayKey:"ns.streams.definition.GradedItemDue.GradedItemDue",canHandle:e=>Ee(e.type,$e),defaultSetting:ye($e),isStreamEntryVisible:Se($e),isStreamSettingVisible:ge($e)},Le={id:"GradedItemOverdue",category:Z.GradedItemDue,displayKey:"ns.streams.definition.GradedItemDue.GradedItemOverdue",canHandle:e=>Ee(e.type,Ne),defaultSetting:ye(Ne),isStreamEntryVisible:Se(Ne),isStreamSettingVisible:ge(Ne)},je=[Ae.AssessmentAvailable,Ae.AssignmentAvailable,Ae.AssessmentAttemptAvailableResent,Ae.AssignmentAvailableResend,Ae.GroupAssignmentAvailable,Ae.GroupAssignmentAvailableResend,Ae.PeerSubmissionAvailable,Ae.PeerSubmissionAttemptAvailableResent,Ae.PeerEvaluationAvailable,Ae.PeerEvaluationAttemptAvailableResent],Me=[Ae.SurveyAvailable,Ae.QuotaAvailable,Ae.ContentAvailable,Ae.ScormItemAvailable],Ge={id:"NewAssessmentsAdded",category:Z.NewContent,displayKey:"ns.streams.definition.NewContent.NewAssessmentsAdded",canHandle:e=>Ee(e.type,je),defaultSetting:ye(je),isStreamEntryVisible:Se(je),isStreamSettingVisible:fe(je)},Re={id:"NewContentAdded",category:Z.NewContent,displayKey:"ns.streams.definition.NewContent.NewContentAdded",canHandle:e=>Ee(e.type,Me)&&"resource/x-bb-forumlink"!==e.contentHandler,defaultSetting:ye(Me),isStreamEntryVisible:Se(Me),isStreamSettingVisible:fe(Me)},Be=[Ae.GradebookAttemptUpdate,Ae.ManualGradeUpdated,Ae.ManualGradeCleared,Ae.ScormItemGradeUpdated],Fe={id:"GradesPosted",category:Z.GradesPosted,displayKey:"",canHandle:e=>Ee(e.type,[Ae.GradebookAttemptUpdate,Ae.ManualGradeUpdated,Ae.ManualGradeCleared,Ae.ScormItemGradeUpdated])||Ce.Grades===e.type,defaultSetting:ye(Be),isStreamEntryVisible:Se(Be),isStreamSettingVisible:ge(Be)},Ue=[Ae.GroupAssignmentNeedsGrading,Ae.GroupBlogNeedsGrading,Ae.GroupForumNeedsGrading,Ae.GroupJournalNeedsGrading,Ae.GroupThreadNeedsGrading,Ae.GroupWikiNeedsGrading,Ae.AssessmentNeedsGrading,Ae.AssignmentNeedsGrading,Ae.GroupAssessmentNeedsGrading,Ae.LateGroupAssessmentNeedsGrading,Ae.BlogNeedsGrading,Ae.ForumNeedsGrading,Ae.JournalNeedsGrading,Ae.LateAssessmentNeedsGrading,Ae.LateAssignmentNeedsGrading,Ae.LateGroupAssignmentNeedsGrading,Ae.LateScormItemNeedsGrading,Ae.ScormItemNeedsGrading,Ae.ThreadNeedsGrading,Ae.WikiNeedsGrading,Ae.PeerSubmissionNeedsGrading,Ae.LatePeerSubmissionNeedsGrading,Ae.PeerEvaluationNeedsGrading,Ae.LatePeerEvaluationNeedsGrading],_e={id:"NewGradeableItems",category:Z.NewGradeableItems,displayKey:"",canHandle:e=>Ee(e.type,Ue),defaultSetting:ye(Ue),isStreamEntryVisible:Se(Ue),isStreamSettingVisible:be(Ue)},ze=[Oe.StudentActivityAvailable],qe=[Oe.StudentGradeDataAvailable],He=[Oe.StudentsFallingBehind],Ve=[Oe.StudentsFallingBehindAbsent],We=[Oe.StudentsFallingBehindFailing],Ke=[Oe.StudentsFallingBehindAbsentFailing],Ye={id:"StudentActivityAvailable",category:Z.StudentPerformanceAlert,displayKey:"ns.streams.definition.StudentPerformanceAlert.StudentActivityAvailable",isStreamEntryVisible:Se(ze),isStreamSettingVisible:be(ze),canHandle:e=>e.type.includes(Ce.Telemetry)&&"SufficientActivityData"===e.telemetryNotificationType,defaultSetting:ye(ze)},Je={id:"StudentGradeDataAvailable",category:Z.StudentPerformanceAlert,displayKey:"ns.streams.definition.StudentPerformanceAlert.StudentGradeDataAvailable",isStreamEntryVisible:Se(qe),isStreamSettingVisible:be(qe),canHandle:e=>e.type.includes(Ce.Telemetry)&&"SufficientGradeData"===e.telemetryNotificationType,defaultSetting:ye(qe)},Ze={id:"StudentsFallingBehind",category:Z.StudentPerformanceAlert,displayKey:"ns.streams.definition.StudentPerformanceAlert.StudentsFallingBehind",isStreamEntryVisible:Se(He),isStreamSettingVisible:be(He),canHandle:e=>e.type.includes(Ce.Telemetry)&&"StudentsInTrouble"===e.telemetryNotificationType&&!!e.studentsInTrouble&&"0"!==e.studentsInTrouble.studentsInTrouble&&"0"===e.studentsInTrouble.studentsInTroubleAbsent&&"0"===e.studentsInTrouble.studentsInTroubleFailing,defaultSetting:ye(He)},Qe={id:"StudentsFallingBehindAbsent",category:Z.StudentPerformanceAlert,displayKey:"ns.streams.definition.StudentPerformanceAlert.StudentsFallingBehindAbsent",isStreamEntryVisible:Se(Ve),isStreamSettingVisible:be(Ve),canHandle:e=>e.type.includes(Ce.Telemetry)&&"StudentsInTrouble"===e.telemetryNotificationType&&!!e.studentsInTrouble&&"0"!==e.studentsInTrouble.studentsInTrouble&&"0"!==e.studentsInTrouble.studentsInTroubleAbsent&&"0"===e.studentsInTrouble.studentsInTroubleFailing,defaultSetting:ye(Ve)},Xe={id:"StudentsFallingBehindFailing",category:Z.StudentPerformanceAlert,displayKey:"ns.streams.definition.StudentPerformanceAlert.StudentsFallingBehindFailing",isStreamEntryVisible:Se(We),isStreamSettingVisible:be(We),canHandle:e=>e.type.includes(Ce.Telemetry)&&"StudentsInTrouble"===e.telemetryNotificationType&&!!e.studentsInTrouble&&"0"!==e.studentsInTrouble.studentsInTrouble&&"0"===e.studentsInTrouble.studentsInTroubleAbsent&&"0"!==e.studentsInTrouble.studentsInTroubleFailing,defaultSetting:ye(We)},et={id:"StudentsFallingBehindAbsentFailing",category:Z.StudentPerformanceAlert,displayKey:"ns.streams.definition.StudentPerformanceAlert.StudentsFallingBehindAbsentFailing",isStreamEntryVisible:Se(Ke),isStreamSettingVisible:be(Ke),canHandle:e=>e.type.includes(Ce.Telemetry)&&"StudentsInTrouble"===e.telemetryNotificationType&&!!e.studentsInTrouble&&"0"!==e.studentsInTrouble.studentsInTrouble&&"0"!==e.studentsInTrouble.studentsInTroubleAbsent&&"0"!==e.studentsInTrouble.studentsInTroubleFailing,defaultSetting:ye(Ke)},tt=[Oe.NoRecentActivity],nt=[Oe.GradeAtRisk_GradeBelowThreshold,Oe.GradeAtRisk_GradeInLowest],at=[Oe.GradeLowered],it=[Oe.LowActivity],rt=[Oe.PerformanceIncreased_ActivityIncreased,Oe.PerformanceIncreased_GradeIncreased],st=[Oe.HighActivity],ot=[Oe.HighGrade],lt={id:"NoRecentActivity",category:Z.GradesAndActivity,displayKey:"ns.streams.definition.GradesAndActivity.NoRecentActivity",isStreamEntryVisible:Se(tt),isStreamSettingVisible:ge(tt),canHandle:e=>!(!e.type.includes(Ce.Telemetry)||"NoRecentActivity"!==e.telemetryNotificationType),defaultSetting:ye(tt)},ct={id:"GradeAtRisk",category:Z.GradesAndActivity,displayKey:"ns.streams.definition.GradesAndActivity.GradeAtRisk",isStreamEntryVisible:Se(nt),isStreamSettingVisible:ge(nt),canHandle:e=>!(!e.type.includes(Ce.Telemetry)||"GradeInLowest"!==e.telemetryNotificationType&&"GradeBelowThreshold"!==e.telemetryNotificationType),defaultSetting:ye(nt)},dt={id:"GradeLowered",category:Z.GradesAndActivity,displayKey:"ns.streams.definition.GradesAndActivity.GradeLowered",isStreamEntryVisible:Se(at),isStreamSettingVisible:ge(at),canHandle:e=>!(!e.type.includes(Ce.Telemetry)||"GradeDropped"!==e.telemetryNotificationType),defaultSetting:ye(at)},ut={id:"LowActivity",category:Z.GradesAndActivity,displayKey:"ns.streams.definition.GradesAndActivity.LowActivity",isStreamEntryVisible:Se(it),isStreamSettingVisible:ge(it),canHandle:e=>!(!e.type.includes(Ce.Telemetry)||"ActivityInLowest"!==e.telemetryNotificationType),defaultSetting:ye(it)},mt={id:"PerformanceIncreased",category:Z.GradesAndActivity,displayKey:"ns.streams.definition.GradesAndActivity.PerformanceIncreased",isStreamEntryVisible:Se(rt),isStreamSettingVisible:ge(rt),canHandle:e=>!(!e.type.includes(Ce.Telemetry)||"GradeIncreased"!==e.telemetryNotificationType&&"ActivityIncreased"!==e.telemetryNotificationType),defaultSetting:ye(rt)},pt={id:"HighActivity",category:Z.GradesAndActivity,displayKey:"ns.streams.definition.GradesAndActivity.HighActivity",isStreamEntryVisible:Se(st),isStreamSettingVisible:ge(st),canHandle:e=>!(!e.type.includes(Ce.Telemetry)||"ActivityInHighest"!==e.telemetryNotificationType),defaultSetting:ye(st)},ht={id:"HighGrade",category:Z.GradesAndActivity,displayKey:"ns.streams.definition.GradesAndActivity.HighGrade",isStreamEntryVisible:Se(ot),isStreamSettingVisible:ge(ot),canHandle:e=>!(!e.type.includes(Ce.Telemetry)||"GradeInHighest"!==e.telemetryNotificationType),defaultSetting:ye(ot)},gt=[Oe.Calendar],bt={id:"Calendar",category:Z.Calendar,displayKey:"",isStreamEntryVisible:Se(gt),isStreamSettingVisible:ve(gt),canHandle:e=>Ce.Calendar===e.type,defaultSetting:ye(gt)},ft=[Ae.CourseAvailable],vt={id:"CourseAvailable",category:Z.CourseAvailable,displayKey:"",canHandle:e=>Ee(e.type,ft),defaultSetting:ye(ft),isStreamEntryVisible:Se(ft),isStreamSettingVisible:ve(ft)},yt=[Oe.BlogEntryPosted],St=[Oe.BlogEntryEdited],Ct=[Oe.BlogEntryComment],Et={id:"BlogEntryPosted",category:Z.Blog,displayKey:"ns.streams.definition.Blog.BlogEntryPosted",isStreamEntryVisible:Se(yt),isStreamSettingVisible:fe(yt),canHandle:e=>Ce.Blog===e.type&&"BL_EP"===e.eventType,defaultSetting:ye(yt)},It={id:"BlogEntryEdited",category:Z.Blog,displayKey:"ns.streams.definition.Blog.BlogEntryEdited",isStreamEntryVisible:Se(St),isStreamSettingVisible:fe(St),canHandle:e=>Ce.Blog===e.type&&"BL_EE"===e.eventType,defaultSetting:ye(St)},kt={id:"BlogEntryComment",category:Z.Blog,displayKey:"ns.streams.definition.Blog.BlogEntryComment",isStreamEntryVisible:Se(Ct),isStreamSettingVisible:be(Ct),canHandle:e=>Ce.Blog===e.type&&"BL_CP"===e.eventType,defaultSetting:ye(Ct)},wt=[Oe.JournalEntryPosted],Tt=[Oe.JournalEntryEdited],Ot=[Oe.JournalEntryComment],At={id:"JournalEntryPosted",category:Z.Journal,displayKey:"ns.streams.definition.Journal.JournalEntryPosted",isStreamEntryVisible:Se(wt),isStreamSettingVisible:fe(wt),canHandle:e=>Ce.Blog===e.type&&"JR_EP"===e.eventType,defaultSetting:ye(wt)},Pt={id:"JournalEntryEdited",category:Z.Journal,displayKey:"ns.streams.definition.Journal.JournalEntryEdited",isStreamEntryVisible:Se(Tt),isStreamSettingVisible:fe(Tt),canHandle:e=>Ce.Blog===e.type&&"JR_EE"===e.eventType,defaultSetting:ye(Tt)},xt={id:"JournalEntryComment",category:Z.Journal,displayKey:"ns.streams.definition.Journal.JournalEntryComment",isStreamEntryVisible:Se(Ot),isStreamSettingVisible:be(Ot),canHandle:e=>Ce.Blog===e.type&&"JR_CP"===e.eventType,defaultSetting:ye(Ot)},$t=[Oe.WikiEntryPosted],Nt=[Oe.WikiEntryEdited],Dt=[Oe.WikiEntryComment],Lt={id:"WikiEntryPosted",category:Z.Wiki,displayKey:"ns.streams.definition.Wiki.WikiEntryPosted",isStreamEntryVisible:Se($t),isStreamSettingVisible:fe($t),canHandle:e=>Ce.Wiki===e.type&&"EP"===e.eventType,defaultSetting:ye($t)},jt={id:"WikiEntryEdited",category:Z.Wiki,displayKey:"ns.streams.definition.Wiki.WikiEntryEdited",isStreamEntryVisible:Se(Nt),isStreamSettingVisible:fe(Nt),canHandle:e=>Ce.Wiki===e.type&&"EE"===e.eventType,defaultSetting:ye(Nt)},Mt={id:"WikiEntryComment",category:Z.Wiki,displayKey:"ns.streams.definition.Wiki.WikiEntryComment",isStreamEntryVisible:Se(Dt),isStreamSettingVisible:fe(Dt),canHandle:e=>Ce.Wiki===e.type&&"CP"===e.eventType,defaultSetting:ye(Dt)},Gt=[Ae.GradebookNeedsReconciliation],Rt={id:"GradesNeedReconciling",category:Z.GradesNeedReconciling,displayKey:"",canHandle:e=>Ee(e.type,Gt),defaultSetting:ye(Gt),isStreamEntryVisible:Se(Gt),isStreamSettingVisible:be(Gt)},Bt=[Ae.ContentAvailable],Ft={id:"NewDiscussionForum",category:Z.Discussion,displayKey:"ns.streams.definition.Discussion.NewDiscussionForum",canHandle:e=>Ee(e.type,Bt)&&"resource/x-bb-forumlink"===e.contentHandler,defaultSetting:ye(Bt),isStreamEntryVisible:Se(Bt),isStreamSettingVisible:fe(Bt)},Ut=[Ae.AnnouncementAvailable],_t={InstitutionAnnouncements:xe,CourseAnnouncements:{id:"CourseAnnouncements",category:Z.CourseAnnouncements,displayKey:"",canHandle:e=>Ee(e.type,Ut)&&e.providerId===Ce.Nautilus,defaultSetting:ye(Ut),isStreamEntryVisible:Se(Ut),isStreamSettingVisible:ve(Ut)},GradedItemDue:De,GradedItemOverdue:Le,NewAssessmentsAdded:Ge,NewContentAdded:Re,GradesPosted:Fe,NewGradeableItems:_e,GradesNeedReconciling:Rt,StudentActivityAvailable:Ye,StudentGradeDataAvailable:Je,StudentsFallingBehind:Ze,StudentsFallingBehindAbsent:Qe,StudentsFallingBehindFailing:Xe,StudentsFallingBehindAbsentFailing:et,NewDiscussionForum:Ft,NoRecentActivity:lt,GradeAtRisk:ct,GradeLowered:dt,LowActivity:ut,PerformanceIncreased:mt,HighActivity:pt,HighGrade:ht,Calendar:bt,CourseAvailable:vt,BlogEntryPosted:Et,BlogEntryEdited:It,BlogEntryComment:kt,JournalEntryPosted:At,JournalEntryEdited:Pt,JournalEntryComment:xt,WikiEntryPosted:Lt,WikiEntryEdited:jt,WikiEntryComment:Mt},zt=Object.values(_t);n.d(t,"g",(function(){return qt})),n.d(t,"f",(function(){return Ht})),n.d(t,"e",(function(){return Vt})),n.d(t,"b",(function(){return f})),n.d(t,"a",(function(){return b})),n.d(t,"d",(function(){return h})),n.d(t,"c",(function(){return zt}));const qt=(e,t,n)=>{const l=i.createElement(r.a,{locale:n.locale,babelfishInstance:n.babelfishInstance,babelfishFormatInstance:n.babelfishFormatInstance,bundlesToLoad:["notification-settings/locales/[locale]/ns.json"],isRtl:n.isRtl},i.createElement(o.a,{store:t},i.createElement(a.AnalyticsJssThemeProvider,{theme:"light",isRtl:n.isRtl},i.createElement(he,{adminNotificationSettings:n.adminNotificationSettings,currentSettings:n.currentSettings,onSettingsUpdated:n.onSettingsUpdated,isGuest:n.isGuest,isInstructor:n.isInstructor,isStudent:n.isStudent,userEnrolledInCourse:n.userEnrolledInCourse}))));s.render(l,e)},Ht=(e,t,n)=>{const l=i.createElement(r.a,{locale:n.locale,babelfishInstance:n.babelfishInstance,babelfishFormatInstance:n.babelfishFormatInstance,bundlesToLoad:["notification-settings/locales/[locale]/ns.json"],isRtl:n.isRtl},i.createElement(o.a,{store:t},i.createElement(a.AnalyticsJssThemeProvider,{theme:"light",isRtl:n.isRtl},i.createElement(q,{closePanel:n.closePanel,onSettingChange:n.onSettingChange}))));s.render(l,e)},Vt=e=>{s.unmountComponentAtNode(e)}},zXZW:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n("Llzl"),i=n("4HXK");const r="ultra.services.errorHandler",s=["$delegate","$injector",(e,t)=>{let n;return Object.assign((function(a,r){e(a,r),n||(n=t.get(i.b)),"undefined"!=typeof NREUM&&NREUM.noticeError(a)}),e)}];a.module(r,[i.a]).config(["$provide",e=>{e.decorator("$exceptionHandler",s)}])},zYa8:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n("Llzl"),i=n("ERkP"),r=n("1ZbL");function s(e,t,n){const s={Class:t=>i.createElement(e,{...t}),attributes:["color","className","titleAccess"],withErrorModalBoundary:!1};a.module(t,[]).component(n,Object(r.a)(s))}},zlFc:function(e,t){e.exports='<bb-modal id="notification-modal-api-error"\n          class="notification"\n          modal-title-key="components.services.error-modal.error-forbidden.title"\n          analytics-id-tag-prefix="components.services.error-modal.error-forbidden">\n  <div name="modal-contents">\n    <p bb-translate>components.services.error-modal.error-forbidden.description</p>\n    <pre>{{ response | json }}</pre>\n    <bb-session-debug-modal-button></bb-session-debug-modal-button>\n  </div>\n  <button name="modal-footer-button-primary"\n          ng-click="$parent.$dismiss()"\n          class="button js-primary-button"\n          analytics-id="components.services.error-modal.dismiss"\n          bb-translate>components.services.error-modal.dismiss</button>\n</bb-modal>\n'},zoPb:function(e,t,n){"use strict";n.r(t),n.d(t,"ConversionContentCategory",(function(){return d})),n.d(t,"ConversionReportStatus",(function(){return a})),n.d(t,"ConversionQueueTaskStatus",(function(){return i})),n.d(t,"serviceName",(function(){return u}));var a,i,r=n("yCC5"),s=n("Rjd/"),o=n("nkTj"),l=n("nbDY"),c=n.n(l);class d extends c.a{constructor(e,t,n){super(e),this.category=e,this.categoryKey=t,this.categoryImage=n,this.mediumIconsByCategory={Assessment:"test",Announcements:"announcements",Blog:"blog",Course:"course",CourseLink:"link",CourseSettings:"settings",DiscussionBoard:"discussion",Gradebook:"grades",Group:"groups",Message:"messages",ReleaseSettings:"settings",Rubric:"rubric",TableOfContents:"content-collection",Wiki:"wiki",Content:"document-blank"}}getLocalizableCategoryNameKey(){return this.categoryKey}getMediumCategoryIconOrDefault(){return this.mediumIconsByCategory[this.category]||"document-blank"}getCategoryIconName(){return this.categoryImage?this.categoryImage:"document-blank"}}d.Assessment=new d("Assessment","ultra.convert.category.assessment","test"),d.Announcements=new d("Announcements","ultra.convert.category.announcements","announcement"),d.Blog=new d("Blog","ultra.convert.category.blog","blog"),d.Collab=new d("Collab","ultra.convert.category.collab"),d.Course=new d("Course","ultra.convert.category.course","course"),d.CourseLink=new d("CourseLink","ultra.convert.category.courseLink","link"),d.CourseSettings=new d("CourseSettings","ultra.convert.category.courseSettings","settings"),d.Content=new d("Content","ultra.convert.category.content","document-blank"),d.ContentSettings=new d("ContentSettings","ultra.convert.category.contentSettings","settings"),d.DiscussionBoard=new d("DiscussionBoard","ultra.convert.category.discussionBoard","discussion"),d.Gradebook=new d("Gradebook","ultra.convert.category.gradebook","grades"),d.Group=new d("Group","ultra.convert.category.group","groups"),d.Message=new d("Message","ultra.convert.course.message.unsupported","messages"),d.ProgressTracking=new d("ProgressTracking","ultra.convert.category.progressTracking"),d.ReleaseSettings=new d("ReleaseSettings","ultra.convert.category.releaseSettings","settings"),d.Rubric=new d("Rubric","ultra.convert.category.rubric","rubric"),d.TableOfContents=new d("TableOfContents","ultra.convert.category.tableOfContents","content-collection"),d.Task=new d("Task","ultra.convert.category.task"),d.Wiki=new d("Wiki","ultra.convert.category.wiki","wiki"),function(e){e.Success="Success",e.Failure="Failure",e.Partial="Partial",e.Unavailable="Unavailable"}(a||(a={})),function(e){e.Waiting="WAITING",e.Assigned="ASSIGNED",e.Running="RUNNING",e.Complete="COMPLETE",e.CompleteErrors="COMPLETE_ERRORS",e.Incomplete="INCOMPLETE"}(i||(i={}));const u=r.s;s.a.factory(u,["restmod",o.c,(e,t)=>e.model().mix({$config:{primaryKey:"taskId"}})])}});