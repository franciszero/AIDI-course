!function(a,b){function c(a,b,c,d){for(var e=0,f=b.length;f>e;e++)ea(a,b[e],c,d)}function d(a,b,d,e,f,g){var h,i=fa.setFilters[b.toLowerCase()];return i||ea.error(b),(a||!(h=f))&&c(a||"*",e,h=[],f),h.length>0?i(h,d,g):[]}function e(a,e,f,g,h){for(var i,j,k,l,m,n,o,p,q=0,r=h.length,s=S.POS,t=new RegExp("^"+s.source+"(?!"+y+")","i"),u=function(){for(var a=1,c=arguments.length-2;c>a;a++)arguments[a]===b&&(i[a]=b)};r>q;q++){for(s.exec(""),a=h[q],l=[],k=0,m=g;i=s.exec(a);)p=s.lastIndex=i.index+i[0].length,p>k&&(o=a.slice(k,i.index),k=p,n=[e],I.test(o)&&(m&&(n=m),m=g),(j=O.test(o))&&(o=o.slice(0,-5).replace(I,"$&*")),i.length>1&&i[0].replace(t,u),m=d(o,i[1],i[2],n,m,j));m?(l=l.concat(m),(o=a.slice(k))&&")"!==o?I.test(o)?c(o,l,f,g):ea(o,e,f,g?g.concat(m):m):w.apply(f,l)):ea(a,e,f,g)}return 1===r?f:ea.uniqueSort(f)}function f(a,b,c){for(var d,e,f,g=[],h=0,i=K.exec(a),j=!i.pop()&&!i.pop(),k=j&&a.match(J)||[""],l=fa.preFilter,m=fa.filter,n=!c&&b!==p;null!=(e=k[h])&&j;h++)for(g.push(d=[]),n&&(e=" "+e);e;){j=!1,(i=I.exec(e))&&(e=e.slice(i[0].length),j=d.push({part:i.pop().replace(H," "),captures:i}));for(f in m)!(i=S[f].exec(e))||l[f]&&!(i=l[f](i,b,c))||(e=e.slice(i.shift().length),j=d.push({part:f,captures:i}));if(!j)break}return j||ea.error(a),g}function g(a,b,c){var d=b.dir,e=u++;return a||(a=function(a){return a===c}),b.first?function(b,c){for(;b=b[d];)if(1===b.nodeType)return a(b,c)&&b}:function(b,c){for(var f,g=e+"."+l,h=g+"."+k;b=b[d];)if(1===b.nodeType){if((f=b[x])===h)return b.sizset;if("string"==typeof f&&0===f.indexOf(g)){if(b.sizset)return b}else{if(b[x]=h,a(b,c))return b.sizset=!0,b;b.sizset=!1}}}}function h(a,b){return a?function(c,d){var e=b(c,d);return e&&a(e===!0?c:e,d)}:b}function i(a,b,c){for(var d,e,f=0;d=a[f];f++)fa.relative[d.part]?e=g(e,fa.relative[d.part],b):(d.captures.push(b,c),e=h(e,fa.filter[d.part].apply(null,d.captures)));return e}function j(a){return function(b,c){for(var d,e=0;d=a[e];e++)if(d(b,c))return!0;return!1}}var k,l,m,n,o,p=a.document,q=p.documentElement,r="undefined",s=!1,t=!0,u=0,v=[].slice,w=[].push,x=("sizcache"+Math.random()).replace(".",""),y="[\\x20\\t\\r\\n\\f]",z="(?:\\\\.|[-\\w]|[^\\x00-\\xa0])+",A=z.replace("w","w#"),B="([*^$|!~]?=)",C="\\["+y+"*("+z+")"+y+"*(?:"+B+y+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+A+")|)|)"+y+"*\\]",D=":("+z+")(?:\\((?:(['\"])((?:\\\\.|[^\\\\])*?)\\2|((?:[^,]|\\\\,|(?:,(?=[^\\[]*\\]))|(?:,(?=[^\\(]*\\))))*))\\)|)",E=":(nth|eq|gt|lt|first|last|even|odd)(?:\\((\\d*)\\)|)(?=[^-]|$)",F=y+"*([\\x20\\t\\r\\n\\f>+~])"+y+"*",G="(?=[^\\x20\\t\\r\\n\\f])(?:\\\\.|"+C+"|"+D.replace(2,7)+"|[^\\\\(),])+",H=new RegExp("^"+y+"+|((?:^|[^\\\\])(?:\\\\.)*)"+y+"+$","g"),I=new RegExp("^"+F),J=new RegExp(G+"?(?="+y+"*,|$)","g"),K=new RegExp("^(?:(?!,)(?:(?:^|,)"+y+"*"+G+")*?|"+y+"*(.*?))(\\)|$)"),L=new RegExp(G.slice(19,-6)+"\\x20\\t\\r\\n\\f>+~])+|"+F,"g"),M=/^(?:#([\w\-]+)|(\w+)|\.([\w\-]+))$/,N=/[\x20\t\r\n\f]*[+~]/,O=/:not\($/,P=/h\d/i,Q=/input|select|textarea|button/i,R=/\\(?!\\)/g,S={ID:new RegExp("^#("+z+")"),CLASS:new RegExp("^\\.("+z+")"),NAME:new RegExp("^\\[name=['\"]?("+z+")['\"]?\\]"),TAG:new RegExp("^("+z.replace("[-","[-\\*")+")"),ATTR:new RegExp("^"+C),PSEUDO:new RegExp("^"+D),CHILD:new RegExp("^:(only|nth|last|first)-child(?:\\("+y+"*(even|odd|(([+-]|)(\\d*)n|)"+y+"*(?:([+-]|)"+y+"*(\\d+)|))"+y+"*\\)|)","i"),POS:new RegExp(E,"ig"),needsContext:new RegExp("^"+y+"*[>+~]|"+E,"i")},T={},U=[],V={},W=[],X=function(a){return a.sizzleFilter=!0,a},Y=function(a){return function(b){return"input"===b.nodeName.toLowerCase()&&b.type===a}},Z=function(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}},$=function(a){var b=!1,c=p.createElement("div");try{b=a(c)}catch(d){}return c=null,b},_=$(function(a){a.innerHTML="<select></select>";var b=typeof a.lastChild.getAttribute("multiple");return"boolean"!==b&&"string"!==b}),aa=$(function(a){a.id=x+0,a.innerHTML="<a name='"+x+"'></a><div name='"+x+"'></div>",q.insertBefore(a,q.firstChild);var b=p.getElementsByName&&p.getElementsByName(x).length===2+p.getElementsByName(x+0).length;return o=!p.getElementById(x),q.removeChild(a),b}),ba=$(function(a){return a.appendChild(p.createComment("")),0===a.getElementsByTagName("*").length}),ca=$(function(a){return a.innerHTML="<a href='#'></a>",a.firstChild&&typeof a.firstChild.getAttribute!==r&&"#"===a.firstChild.getAttribute("href")}),da=$(function(a){return a.innerHTML="<div class='hidden e'></div><div class='hidden'></div>",a.getElementsByClassName&&0!==a.getElementsByClassName("e").length?(a.lastChild.className="e",1!==a.getElementsByClassName("e").length):!1}),ea=function(a,b,c,d){c=c||[],b=b||p;var e,f,g,h,i=b.nodeType;if(1!==i&&9!==i)return[];if(!a||"string"!=typeof a)return c;if(g=ha(b),!g&&!d&&(e=M.exec(a)))if(h=e[1]){if(9===i){if(f=b.getElementById(h),!f||!f.parentNode)return c;if(f.id===h)return c.push(f),c}else if(b.ownerDocument&&(f=b.ownerDocument.getElementById(h))&&ia(b,f)&&f.id===h)return c.push(f),c}else{if(e[2])return w.apply(c,v.call(b.getElementsByTagName(a),0)),c;if((h=e[3])&&da&&b.getElementsByClassName)return w.apply(c,v.call(b.getElementsByClassName(h),0)),c}return la(a,b,c,d,g)},fa=ea.selectors={cacheLength:50,match:S,order:["ID","TAG"],attrHandle:{},createPseudo:X,find:{ID:o?function(a,b,c){if(typeof b.getElementById!==r&&!c){var d=b.getElementById(a);return d&&d.parentNode?[d]:[]}}:function(a,c,d){if(typeof c.getElementById!==r&&!d){var e=c.getElementById(a);return e?e.id===a||typeof e.getAttributeNode!==r&&e.getAttributeNode("id").value===a?[e]:b:[]}},TAG:ba?function(a,b){return typeof b.getElementsByTagName!==r?b.getElementsByTagName(a):void 0}:function(a,b){var c=b.getElementsByTagName(a);if("*"===a){for(var d,e=[],f=0;d=c[f];f++)1===d.nodeType&&e.push(d);return e}return c}},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(R,""),a[3]=(a[4]||a[5]||"").replace(R,""),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),"nth"===a[1]?(a[2]||ea.error(a[0]),a[3]=+(a[3]?a[4]+(a[5]||1):2*("even"===a[2]||"odd"===a[2])),a[4]=+(a[6]+a[7]||"odd"===a[2])):a[2]&&ea.error(a[0]),a},PSEUDO:function(a){var b,c=a[4];return S.CHILD.test(a[0])?null:(c&&(b=K.exec(c))&&b.pop()&&(a[0]=a[0].slice(0,b[0].length-c.length-1),c=b[0].slice(0,-1)),a.splice(2,3,c||a[3]),a)}},filter:{ID:o?function(a){return a=a.replace(R,""),function(b){return b.getAttribute("id")===a}}:function(a){return a=a.replace(R,""),function(b){var c=typeof b.getAttributeNode!==r&&b.getAttributeNode("id");return c&&c.value===a}},TAG:function(a){return"*"===a?function(){return!0}:(a=a.replace(R,"").toLowerCase(),function(b){return b.nodeName&&b.nodeName.toLowerCase()===a})},CLASS:function(a){var b=T[a];return b||(b=T[a]=new RegExp("(^|"+y+")"+a+"("+y+"|$)"),U.push(a),U.length>fa.cacheLength&&delete T[U.shift()]),function(a){return b.test(a.className||typeof a.getAttribute!==r&&a.getAttribute("class")||"")}},ATTR:function(a,b,c){return b?function(d){var e=ea.attr(d,a),f=e+"";if(null==e)return"!="===b;switch(b){case"=":return f===c;case"!=":return f!==c;case"^=":return c&&0===f.indexOf(c);case"*=":return c&&f.indexOf(c)>-1;case"$=":return c&&f.substr(f.length-c.length)===c;case"~=":return(" "+f+" ").indexOf(c)>-1;case"|=":return f===c||f.substr(0,c.length+1)===c+"-"}}:function(b){return null!=ea.attr(b,a)}},CHILD:function(a,b,c,d){if("nth"===a){var e=u++;return function(a){var b,f,g=0,h=a;if(1===c&&0===d)return!0;if(b=a.parentNode,b&&(b[x]!==e||!a.sizset)){for(h=b.firstChild;h&&(1!==h.nodeType||(h.sizset=++g,h!==a));h=h.nextSibling);b[x]=e}return f=a.sizset-d,0===c?0===f:f%c===0&&f/c>=0}}return function(b){var c=b;switch(a){case"only":case"first":for(;c=c.previousSibling;)if(1===c.nodeType)return!1;if("first"===a)return!0;c=b;case"last":for(;c=c.nextSibling;)if(1===c.nodeType)return!1;return!0}}},PSEUDO:function(a,b,c,d){var e=fa.pseudos[a]||fa.pseudos[a.toLowerCase()];return e||ea.error("unsupported pseudo: "+a),e.sizzleFilter?e(b,c,d):e}},pseudos:{not:X(function(a,b,c){var d=ka(a.replace(H,"$1"),b,c);return function(a){return!d(a)}}),enabled:function(a){return a.disabled===!1},disabled:function(a){return a.disabled===!0},checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,a.selected===!0},parent:function(a){return!fa.pseudos.empty(a)},empty:function(a){var b;for(a=a.firstChild;a;){if(a.nodeName>"@"||3===(b=a.nodeType)||4===b)return!1;a=a.nextSibling}return!0},contains:X(function(a){return function(b){return(b.textContent||b.innerText||ja(b)).indexOf(a)>-1}}),has:X(function(a){return function(b){return ea(a,b).length>0}}),header:function(a){return P.test(a.nodeName)},text:function(a){var b,c;return"input"===a.nodeName.toLowerCase()&&"text"===(b=a.type)&&(null==(c=a.getAttribute("type"))||c.toLowerCase()===b)},radio:Y("radio"),checkbox:Y("checkbox"),file:Y("file"),password:Y("password"),image:Y("image"),submit:Z("submit"),reset:Z("reset"),button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},input:function(a){return Q.test(a.nodeName)},focus:function(a){var b=a.ownerDocument;return a===b.activeElement&&(!b.hasFocus||b.hasFocus())&&!(!a.type&&!a.href)},active:function(a){return a===a.ownerDocument.activeElement}},setFilters:{first:function(a,b,c){return c?a.slice(1):[a[0]]},last:function(a,b,c){var d=a.pop();return c?a:[d]},even:function(a,b,c){for(var d=[],e=c?1:0,f=a.length;f>e;e+=2)d.push(a[e]);return d},odd:function(a,b,c){for(var d=[],e=c?0:1,f=a.length;f>e;e+=2)d.push(a[e]);return d},lt:function(a,b,c){return c?a.slice(+b):a.slice(0,+b)},gt:function(a,b,c){return c?a.slice(0,+b+1):a.slice(+b+1)},eq:function(a,b,c){var d=a.splice(+b,1);return c?a:d}}};fa.setFilters.nth=fa.setFilters.eq,fa.filters=fa.pseudos,ca||(fa.attrHandle={href:function(a){return a.getAttribute("href",2)},type:function(a){return a.getAttribute("type")}}),aa&&(fa.order.push("NAME"),fa.find.NAME=function(a,b){return typeof b.getElementsByName!==r?b.getElementsByName(a):void 0}),da&&(fa.order.splice(1,0,"CLASS"),fa.find.CLASS=function(a,b,c){return typeof b.getElementsByClassName===r||c?void 0:b.getElementsByClassName(a)});try{v.call(q.childNodes,0)[0].nodeType}catch(ga){v=function(a){for(var b,c=[];b=this[a];a++)c.push(b);return c}}var ha=ea.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return b?"HTML"!==b.nodeName:!1},ia=ea.contains=q.compareDocumentPosition?function(a,b){return!!(16&a.compareDocumentPosition(b))}:q.contains?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b.parentNode;return a===d||!!(d&&1===d.nodeType&&c.contains&&c.contains(d))}:function(a,b){for(;b=b.parentNode;)if(b===a)return!0;return!1},ja=ea.getText=function(a){var b,c="",d=0,e=a.nodeType;if(e){if(1===e||9===e||11===e){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=ja(a)}else if(3===e||4===e)return a.nodeValue}else for(;b=a[d];d++)c+=ja(b);return c};ea.attr=function(a,b){var c,d=ha(a);return d||(b=b.toLowerCase()),fa.attrHandle[b]?fa.attrHandle[b](a):_||d?a.getAttribute(b):(c=a.getAttributeNode(b),c?"boolean"==typeof a[b]?a[b]?b:null:c.specified?c.value:null:null)},ea.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)},[0,0].sort(function(){return t=0}),q.compareDocumentPosition?m=function(a,b){return a===b?(s=!0,0):(a.compareDocumentPosition&&b.compareDocumentPosition?4&a.compareDocumentPosition(b):a.compareDocumentPosition)?-1:1}:(m=function(a,b){if(a===b)return s=!0,0;if(a.sourceIndex&&b.sourceIndex)return a.sourceIndex-b.sourceIndex;var c,d,e=[],f=[],g=a.parentNode,h=b.parentNode,i=g;if(g===h)return n(a,b);if(!g)return-1;if(!h)return 1;for(;i;)e.unshift(i),i=i.parentNode;for(i=h;i;)f.unshift(i),i=i.parentNode;c=e.length,d=f.length;for(var j=0;c>j&&d>j;j++)if(e[j]!==f[j])return n(e[j],f[j]);return j===c?n(a,f[j],-1):n(e[j],b,1)},n=function(a,b,c){if(a===b)return c;for(var d=a.nextSibling;d;){if(d===b)return-1;d=d.nextSibling}return 1}),ea.uniqueSort=function(a){var b,c=1;if(m&&(s=t,a.sort(m),s))for(;b=a[c];c++)b===a[c-1]&&a.splice(c--,1);return a};var ka=ea.compile=function(a,b,c){var d,e,g,h=V[a];if(h&&h.context===b)return h;for(e=f(a,b,c),g=0;d=e[g];g++)e[g]=i(d,b,c);return h=V[a]=j(e),h.context=b,h.runs=h.dirruns=0,W.push(a),W.length>fa.cacheLength&&delete V[W.shift()],h};ea.matches=function(a,b){return ea(a,null,null,b)},ea.matchesSelector=function(a,b){return ea(b,null,null,[a]).length>0};var la=function(a,b,c,d,f){a=a.replace(H,"$1");var g,h,i,j,m,n,o,p,q,r=a.match(J),s=a.match(L),t=b.nodeType;if(S.POS.test(a))return e(a,b,c,d,r);if(d)g=v.call(d,0);else if(r&&1===r.length){if(s.length>1&&9===t&&!f&&(r=S.ID.exec(s[0]))){if(b=fa.find.ID(r[1],b,f)[0],!b)return c;a=a.slice(s.shift().length)}for(p=(r=N.exec(s[0]))&&!r.index&&b.parentNode||b,q=s.pop(),n=q.split(":not")[0],i=0,j=fa.order.length;j>i;i++)if(o=fa.order[i],r=S[o].exec(n)){if(g=fa.find[o]((r[1]||"").replace(R,""),p,f),null==g)continue;n===q&&(a=a.slice(0,a.length-q.length)+n.replace(S[o],""),a||w.apply(c,v.call(g,0)));break}}if(a)for(h=ka(a,b,f),l=h.dirruns++,null==g&&(g=fa.find.TAG("*",N.test(a)&&b.parentNode||b)),i=0;m=g[i];i++)k=h.runs++,h(m,b)&&c.push(m);return c};p.querySelectorAll&&!function(){var a,b=la,c=/'|\\/g,d=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,e=[],f=[":active"],g=q.matchesSelector||q.mozMatchesSelector||q.webkitMatchesSelector||q.oMatchesSelector||q.msMatchesSelector;$(function(a){a.innerHTML="<select><option selected></option></select>",a.querySelectorAll("[selected]").length||e.push("\\["+y+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)"),a.querySelectorAll(":checked").length||e.push(":checked")}),$(function(a){a.innerHTML="<p test=''></p>",a.querySelectorAll("[test^='']").length&&e.push("[*^$]="+y+"*(?:\"\"|'')"),a.innerHTML="<input type='hidden'>",a.querySelectorAll(":enabled").length||e.push(":enabled",":disabled")}),e=e.length&&new RegExp(e.join("|")),la=function(a,d,f,g,h){if(!(g||h||e&&e.test(a)))if(9===d.nodeType)try{return w.apply(f,v.call(d.querySelectorAll(a),0)),f}catch(i){}else if(1===d.nodeType&&"object"!==d.nodeName.toLowerCase()){var j=d.getAttribute("id"),k=j||x,l=N.test(a)&&d.parentNode||d;j?k=k.replace(c,"\\$&"):d.setAttribute("id",k);try{return w.apply(f,v.call(l.querySelectorAll(a.replace(J,"[id='"+k+"'] $&")),0)),f}catch(i){}finally{j||d.removeAttribute("id")}}return b(a,d,f,g,h)},g&&($(function(b){a=g.call(b,"div");try{g.call(b,"[test!='']:sizzle"),f.push(fa.match.PSEUDO.source,fa.match.POS.source,"!=")}catch(c){}}),f=new RegExp(f.join("|")),ea.matchesSelector=function(b,c){if(c=c.replace(d,"='$1']"),!(ha(b)||f.test(c)||e&&e.test(c)))try{var h=g.call(b,c);if(h||a||b.document&&11!==b.document.nodeType)return h}catch(i){}return ea(c,null,null,[b]).length>0})}(),a.ReadSpeaker.Sizzle=ea}(window),ReadSpeaker.popup.runPopup=function(a,b,c){function d(){rspkr.preventDefault(),rspkr.ui.LoadIndicator.show(),rspkr.popup.closePopup(void 0,!0),rspkr.ui.Tools.Translation.translate($rs.getAttr(this,"data-rs-itemval"))}if(1===c)rspkr.pl.releaseAdapter(),$rs.removeClass($rs.arr(".rs_textselection"),"rs_textselection"),rspkr.popup.lastSelectedText=null,rspkr.popup.closePopup(void 0,!0),rspkr.u.Detach&&rspkr.u.Detach.supported()&&rspkr.u.Detach.check(),window.readpage(rspkr.findHref(),rspkr.findExpContainer());else if(2===c){if(rspkr.preventDefault(a),!rspkr.popup.container.langpicker){var e=rspkr.cfg.item("general.transLangs"),f=[];if(e&&Object.size(e)){for(var g in e)e.hasOwnProperty(g)&&f.push({action:d,params:[g,e[g]],value:g,key:g});rspkr.c.sorting.sortArrayByObjKey(f,"key"),rspkr.popup.container.langpicker=new rspkr.u.ContextMenu({triggerElm:$rs.findIn(b,".rspopup_translation"),triggerEvent:"mouseup",items:f,preOpen:!0}),rspkr.Lang.updateUi(rspkr.popup.container.popup),rspkr.popup.container.langpicker.reflow()}}}else if(3===c){rspkr.ui.LoadIndicator.show();var h=rspkr.Lang.getUiLang()||rspkr.getParam("lang",rspkr.findHref());rspkr.popup.closePopup(void 0,!0),rspkr.ui.Tools.Dictionary.dictionary(h)}},ReadSpeaker.Common=function(){var a={revision:"1476"},b={onAdapterReady:[],onInit:[],onCoreLoaded:[],onModsLoaded:[],onAfterModsLoaded:[],onAfterExtraModsLoaded:[],onConfigLoaded:[],onLangLoaded:[],onLangUpdated:[],onUiUpdated:[],onDOMReady:[],onReady:[],onSelectedText:[],onDeselectedText:[],onBeforeQueueExecuted:[],onAfterQueueExecuted:[],onBeforeSettingsOpened:[],onSettingsInitialized:[],onSettingsChanged:[],onSettingsLoaded:[],onSettingsClosed:[],onSpeedChanged:[],onBeforeLightboxOpened:[],onLightboxClosed:[],onLightboxFontChanged:[],onTextModeLoaded:[],onVoiceParamsSet:[],onMouseTrackerOpened:[],onMouseTrackerClosed:[],onDownloadLoaded:[],onFocusIn:[],onFocusOut:[],onUIInitialized:[],onUIBeforePlay:[],onUIAfterPlay:[],onUIPause:[],onUISliderMove:[],onUIStop:[],onUIShowPlayer:[],onUIClosePlayer:[],onResized:[],onDragDropFinished:[],onResizeFinished:[],onAPIPlay:[],onAPIPause:[],onAPIStop:[],onAPIVolumeUp:[],onAPIVolumeDown:[],onAPIMute:[],onAPIFastForward:[],onAPIRewind:[],onAPISetVolume:[],onAPISetProgress:[],onAPIGetProgress:[],onAPIInitAdapter:[],onAPIReleaseAdapter:[],onAPIReloadAdapter:[],onSectionRead:[],onLazyLoadFinished:[],onBeforeSyncInit:[],onAfterSyncInit:[],onBeforeSync:[],onAfterSync:[],onBeforeSyncExit:[],onAfterSyncExit:[],onBeforeContentChange:[],onAfterContentChange:[],onBeforeGetAudioLink:[],onBeforeParamsSet:[],onAfterParamsSet:[],onAudioLoadError:[],onVolumeAdjusted:[],onChunkResume:[],onBeforeToolsOpen:[],onAfterToolsOpen:[],onBeforeToolsClose:[],onAfterToolsClose:[],onToolsInitialized:[],onToolClicked:[]},c={speed:function(a,b){if(!isNaN(parseInt(a)))return parseInt(a);var c=parseInt(b||rspkr.pub.Config.item("general.defaultSpeedValue")||100),d=parseInt(rspkr.pub.Config.item("general.defaultSlowSpeedValue")||c-25),e=parseInt(rspkr.pub.Config.item("general.defaultFastSpeedValue")||c+25);switch(a){case"slow":return d;case"medium":return c;case"fast":return e;default:return c}}},d={sortArrayByObjKey:function(a,b,c){return $rs.isArray(a)&&"string"==typeof b?(c=c||"asc",a.sort(function(a,d){var e=a[b].toLowerCase(),f=d[b].toLowerCase();return f>e?"asc"===c?-1:1:e>f?"asc"===c?1:-1:0}),a):null}},e={audioLink:null,params:{},tempParams:{},postContent:"",postLink:null,processedDocument:null,saveLink:null,selectedHTML:"",selectedText:"",selectedRange:null,selectedDocument:document,sync:"wordsent",syncLink:null,browser:{name:"",version:"",OS:"",html5AudioFormat:"",html5Support:!1,html5Priority:!1,syncContainer:""},setParams:function(a){function b(a,b){for(var c=0,d=a.length;d>c;c++)if(this[c]===b)return c;return-1}if(rspkr.log("[rspkr.c.data.setParams] "+a),"string"==typeof a){this.params={};var c="",d="",f="",g=a.split("?");rspkr.cfg.item("general.servercall",g[0]);for(var h=g[1].split(/[;&]/),i=0;i<h.length;i++)if(c=h[i].split("="),c&&2==c.length){d=decodeURIComponent(c[0]);var j=c[1];if(f=decodeURIComponent(c[1]),"url"!=d||f.length){if("url"==d)j=encodeURIComponent(decodeURIComponent(f));else if("lang"==d&&2==f.length)e.params.lang=rspkr.Lang.formatLangCode(f);else if("readid"==d||"readclass"==d){for(var k=j.split(","),l=[],m=0;m<k.length;m++)-1==b(l,k[m])&&l.push(k[m]);j=l.join(",")}}else j=encodeURIComponent(document.location.href);this.params[d]=j}this.params.rsjs_ver=rspkr.getVersion(),this.params.synccontainer=this.browser.syncContainer,this.params.url||(this.params.url=document.location.href),this.params.readid=this.params.readid||"",rspkr.cfg.item("general.userDefinedLang")&&(this.params.lang=rspkr.cfg.item("general.userDefinedLang")),rspkr.cfg.item("general.userDefinedVoice")&&(this.params.voice=rspkr.cfg.item("general.userDefinedVoice")),(rspkr.c.data.selectedText||rspkr.c.data.selectedHTML)&&(delete this.params.readid,delete this.params.readclass),rspkr.Common.dispatchEvent("onAfterParamsSet")}},setRegion:function(){var a=rspkr.getRSBtns(),b=a.length?a[0]:void 0;if(b){var c=$rs.findIn(b,".rsbtn_play"),d=$rs.isArray(c)?$rs.getAttr(c[0],"href"):$rs.getAttr(c,"href"),e=document.createElement("a");$rs.setAttr(e,"href",d);var f=e.hostname.split(".")[0].split("-");f.length>1&&"readspeaker"===e.hostname.split(".")[1]&&(rspkr.pub.Config.item("general.region",f[1]),rspkr.log("[rspkr.c.data.setRegion] Setting region to "+f[1]))}},setWrapiUrl:function(){if(!rspkr.pub.Config.item("general.wrapiUrl")){var a=rspkr.pub.Config.item("general.region"),b="https://app-%REGION%.readspeaker.com/webreader/v1/".replace("%REGION%",a||"eu");rspkr.pub.Config.item("general.wrapiUrl",b),rspkr.log("[rspkr.c.data.setWrapiUrl] Setting Wrapi URL to "+b)}},mergeTempParams:function(a){return Object.size(e.tempParams)?(rspkr.cfg.mergeObj(e.tempParams,a),e.tempParams=[],a):a},setDefaultValues:function(){rspkr.log("[rspkr.c.data.setDefaultValues] Called!"),rspkr.Common.data.selectedHTML="",rspkr.Common.data.saveLink=null},setPostContent:function(a){if("string"==typeof a){var b;b="textsel"===a?this.selectedHTML:rspkr.cfg.item("general.postSettings.useExistingMarkup")===!0?e.getReadingContent(!1):e.getReadingContent(rspkr.hl&&rspkr.hl.Restore.hasMarkup()),rspkr.cfg.item("general.parseMathJax")===!0&&(b=this.parseMathJax(b)),this.postContent=n.encode(b)}},searchLangAttr:function(a){if(a.hasAttribute&&(a.hasAttribute("lang")||a.hasAttribute("xml:lang")))return a.getAttribute("lang");for(var b=a.parentNode,c=document.getElementsByTagName("body")[0];b&&b!==c;){if(b.hasAttribute&&b.hasAttribute("lang"))return b.getAttribute("lang");if(b.hasAttribute&&b.hasAttribute("xml:lang"))return b.getAttribute("xml:lang");b=b.parentNode}return""},searchVoiceAttr:function(a){return a.getAttribute&&/voice-family/i.test(a.getAttribute("style"))?a.getAttribute("style"):a.parentNode&&a.parentNode!==document.body?this.searchVoiceAttr(a.parentNode):""},getDefaultReadElements:function(){var a=[],b=[];rspkr.c.data.params.hasOwnProperty("readid")&&rspkr.c.data.params.readid&&rspkr.c.data.params.readid.length&&(b=b.concat(("#"+rspkr.c.data.params.readid.split(",").join(",#")).split(","))),rspkr.c.data.params.hasOwnProperty("readclass")&&rspkr.c.data.params.readclass.length&&(b=b.concat(("."+rspkr.c.data.params.readclass.split(",").join(",.")).split(",")));var c=$rs.getReadingFrames(window);if(rspkr.cfg.item("general.readidOrder")&&rspkr.cfg.item("general.usePost"))for(var d=0;d<b.length;d++)c.forEach(function(c){try{var e=$rs.get(b[d],c.document);$rs.isArray(e)&&e.length?a=a.concat(e):$rs.isArray(e)||a.push(e)}catch(f){}});else c.forEach(function(c){try{var d=$rs.get(b.join(","),c.document);$rs.isArray(d)?a=a.concat(d):a.push(d)}catch(e){}});return a=$rs.isArray(a)?a:[a],rspkr.math&&rspkr.math.check(a),a},getReadingContent:function(a){var b=[],c="";a===!0&&rspkr.hl.engine.useTextNodeMarkup!==!0&&rspkr.hl.sync.fullCleanUp(),b=e.getDefaultReadElements(),$rs.isArray(b)||(b=[b]);for(var d,f=0;d=b[f];f++){var g;g=d.nodeName&&"TABLE"==d.nodeName?"TABLE":"DIV";for(var h=d.attributes,i="",j=h.length;j--;){var k=h[j];"data-"!==k.name.substr(0,5)&&(i+=" "+k.name+'="'+k.value+'"')}c+="<"+g+i+">"+d.innerHTML+"</"+g+">"}return c=e.cleanSkippedContent(c)},cleanSkippedContent:function(a,b){function c(a){for(var b,d=a.childNodes,e=0;b=d[e];e++)rs.hl.clientMarkup.skipHidden(b)!==!0?c(b):b.innerHTML=""}b||(b={});var d=document.createElement("div");d.innerHTML=a.replace(/style=/gi,"rs_ztylez=").replace(/ font-family:.*?;/gi,"");var e=$rs.findIn(d,b.cleanAllSkipped?".rs_skip, .rs_skip_always":".rs_skip.rs_preserve");!$rs.isArray(e)&&(e=[e]);for(var f,g=0;f=e[g];g++)f.innerHTML="";return(b.cleanHidden||rs.hl.engine.useTextNodeMarkup!==!0&&rs.cfg.item("general.skipHiddenContent"))&&(d.style.position="absolute",d.style.left="10000px",document.body.appendChild(d),c(d),document.body.removeChild(d)),d.innerHTML.replace(/rs_ztylez=/gi,"style=")},parseMathJax:function(a){var b,c,d,e,f,g=document.createElement("div"),h=window.MathJax;if(g.innerHTML=a,c=$rs.findIn(g,".MathJax")){b=$rs.findIn(c,".math"),$rs.isArray(b)&&0===b.length&&(b=c),b=$rs.isArray(b)?b:[b];for(var i=b.length-1;i>=0;i--)"object"==typeof b[i]&&(f=document.createElement("div"),mjaxObj=h.Hub.getJaxFor(b[i].id),f.innerHTML=mjaxObj.originalText,d=$rs.closest(b[i],"div.MathJax_Display"),$rs.hasClass(b[i],"math")?(b[i].parentNode.parentNode.replaceChild(f,b[i].parentNode),d&&d.tagName&&d.parentNode.replaceChild(f,d)):d?d.parentNode.replaceChild(f,d):b[i].parentNode.replaceChild(f,b[i]));e=g.getElementsByTagName("script");for(var j=e.length-1;j>=0;j--)e[j].type&&"math/mml"===e[j].type&&e[j].parentNode.removeChild(e[j]);return g.innerHTML}return a},clearSelectedText:function(){var a=$rs.getReadingFrames(window);a.forEach(function(a){try{a.getSelection?a.getSelection().removeAllRanges():a.document.selection&&a.document.selection.empty()}catch(b){}})},setSelectedText:function(a){function b(a,c){c&&(rspkr.c.data.tmpNodeOffset=0);var d=a.childNodes;if(d&&d.length)for(var e=0;e<d.length;e++)3===d[e].nodeType?(d[e]===rspkr.c.data.selectedRange.startContainer&&(rspkr.c.data.selectionBackupData.startOffsetNormalized=rspkr.c.data.tmpNodeOffset+rspkr.c.data.selectedRange.startOffset),d[e]===rspkr.c.data.selectedRange.endContainer&&(rspkr.c.data.selectionBackupData.endOffsetNormalized=rspkr.c.data.tmpNodeOffset+rspkr.c.data.selectedRange.endOffset),rspkr.c.data.tmpNodeOffset+=d[e].textContent.length):b(d[e])}this.selectedText="";var c,d,e=a&&a.view?a.view.document:this.getDocumentElement();if(e.getSelection){if(d=e.getSelection(),!d.isCollapsed){if(d.getRangeAt){var f=d.getRangeAt(0),g=d.getRangeAt(d.rangeCount-1);c=e.createRange(),c.setStart(f.startContainer,f.startOffset),c.setEnd(g.endContainer,g.endOffset)}else c=e.createRange(),c.setStart(d.anchorNode,d.anchorOffset),c.setEnd(d.focusNode,d.focusOffset);if(c){var h=c.cloneContents(),i=e.createElement("div");i.appendChild(h.cloneNode(!0)),this.selectedText=i.innerHTML,rspkr.math&&rspkr.math.check([i])}else this.selectedText=d}if(this.selectedRange=c,rspkr.hl.engine.useTextNodeMarkup&&c){if(this.selectionBackupData={startContainer:c.startContainer,endContainer:c.endContainer,startOffset:c.startOffset,endOffset:c.endOffset},"rs_textnode"===this.selectedRange.startContainer.parentNode.className&&this.selectedRange.startContainer.parentNode.parentNode.childNodes.length>1&&(this.selectionBackupData.startNodePosition=Array.prototype.indexOf.call(this.selectedRange.startContainer.parentNode.parentNode.childNodes,this.selectedRange.startContainer.parentNode)),this.selectedRange.endContainer!==this.selectedRange.startContainer&&"rs_textnode"===this.selectedRange.endContainer.parentNode.className&&this.selectedRange.endContainer.parentNode.parentNode.childNodes.length>1&&(this.selectionBackupData.endNodePosition=Array.prototype.indexOf.call(this.selectedRange.endContainer.parentNode.parentNode.childNodes,this.selectedRange.endContainer.parentNode)),this.selectedRange.startContainer.parentNode.nodeName.toLowerCase()===rspkr.c.data.browser.syncContainer.toLowerCase()){var j=$rs.closest(this.selectedRange.startContainer,".rs_textnode");this.selectionBackupData.startNodePosition=Array.prototype.indexOf.call(j.parentNode.childNodes,j),b(j,!0)}if(this.selectedRange.endContainer!==this.selectedRange.startContainer&&this.selectedRange.endContainer.parentNode.nodeName.toLowerCase()===rspkr.c.data.browser.syncContainer.toLowerCase()){var j=$rs.closest(this.selectedRange.endContainer,".rs_textnode");this.selectionBackupData.endNodePosition=Array.prototype.indexOf.call(j.parentNode.childNodes,j),b(j,!0)}delete rspkr.c.data.tmpNodeOffset}else delete this.selectionBackupData}else e.selection?(d=e.selection,c=d.createRange(),c&&c.htmlText&&c.text&&c.text.length?this.selectedText=c.htmlText:c&&c.text?this.selectedText=c.text:this.selectedText="",this.selectedRange=c.duplicate()):e.getSelection&&(this.selectedText=e.getSelection());e.getSelection&&e.getSelection().rangeCount>0?this.selectedText.length&&e.getSelection().getRangeAt&&e.getSelection().getRangeAt(0)&&e.getSelection().getRangeAt(0).toString().length&&a?(this.selectedDocument=e,k("onSelectedText",e.defaultView,[a])):(this.selectedText="",k("onDeselectedText",e.defaultView,["empty"])):this.selectedText.length&&a?(this.selectedDocument=e,k("onSelectedText",e.defaultView,[a])):k("onDeselectedText",e.defaultView,["empty"]),rspkr.log("[rspkr.c.setSelectedText] Selected text length is "+this.selectedText.length)},getDocumentElement:function(){var a=window.getSelection();if(a.isCollapsed||a.rangeCount<1)for(var b=$rs.getReadingFrames(window),c=0;c<b.length;c++){var d=b[c];try{if(d.getSelection&&d.getSelection().rangeCount>0&&!d.getSelection().isCollapsed)return d.document}catch(e){rspkr.log("Error getting document:"+e,3)}}return window.document},getParam:function(a){return this.params&&this.params[a]&&void 0!==this.params[a]?this.params[a]:null},getParams:function(){return this.params},getPostContent:function(){return this.postContent},getSelectedText:function(){return this.selectedText},getParamObject:function(a){var b,c,d={};for(b in this.params)this.params.hasOwnProperty(b)&&(d[b]=this.params[b]);for(b in a)a.hasOwnProperty(b)&&(d[b]=a[b]);return c=this.getSpeedParam(d.speed),isNaN(c)||(d.speed=c),d},getSpeedParam:function(a){var b=c.speed(rspkr.Common.Settings.get("hlspeed"),a?a:void 0);return 100!==b&&(a=b),a},getAudioLink:function(a,b,c){rspkr.devt("onBeforeGetAudioLink",window),b="undefined"!=typeof b?b:rspkr.HL,this.audioLink=null;var d=(this.getParamObject(a),!1);if(rspkr.math&&rspkr.math.found()&&rspkr.math.addParams(),rspkr.hl.engine.useTextNodeMarkup!==!0||this.selectedText.length||this.selectedHTML.length)this.selectedText.length?(b.clientMarkup.preProcess.init(),a.sync="user",a.syncalignuser=rspkr.st.get("hl"),this.setPostContent("textsel"),d=!0,c!==!0&&(this.audioLink=m.issuePost(this.getParamObject(a)))):rspkr.cfg.item("general.premarkup")===!0?(a.sync="user",this.setPostContent("nosel"),d=rspkr.pub.Config.item("general.usePost")===!0,c!==!0&&(rspkr.pub.Config.item("general.usePost")===!0?this.audioLink=m.issuePost(this.getParamObject(a)):this.audioLink=f(this.getParamObject(a)))):rspkr.pub.Config.item("general.usePost")===!0?(rspkr.mobile()&&rs.cfg.item("general.postSettings.useExistingMarkup")===!0?(a.sync="user",""!==this.selectedHTML||""!==this.selectedText?this.setPostContent("textsel"):this.setPostContent("nosel")):(a.sync="wordsent",this.setPostContent("nosel")),d=!0,c!==!0&&(this.audioLink=m.issuePost(this.getParamObject(a)))):(a.sync="wordsent",c!==!0&&(this.audioLink=f(this.getParamObject(a))));else if(b.clientMarkup.preProcess.init(),a.sync="user",this.setPostContent("nosel"),d=!0,c!==!0)return this.audioLink=m.issuePost(this.getParamObject(a)),{link:this.audioLink,params:this.getParamObject(a),usePost:!0};return rspkr.log("[rspkr.c.data.getAudioLink] Audio link: "+this.audioLink),c===!0?(this.audioLink=f(this.getParamObject(a)),{link:this.audioLink,params:this.getParamObject(a),usePost:d}):this.audioLink},setSettingsChanged:function(a,b,c){"hlspeed"===a&&(rspkr.c.data.settingsChanged=!0)},settingsChanged:!1,getSaveData:function(a,b){rspkr.log("[rspkr.c.data.getSaveData]"),a=a||"link",b=b||!1;var d=this.saveLink;if(!this.saveLink||this.settingsChanged||b){if(b&&rspkr.c.data.setParams(b),!rspkr.c.data.params.customerid){var e=$rs.get("."+rspkr.cfg.item("ui.rsbtnClass"));e=$rs.isArray(e)&&e.length?e[0]:e,e&&rspkr.c.data.setParams($rs.getAttr($rs.findIn(e,".rsbtn_play"),"href"))}var g,h={},i={audioformat:"mp3"};this.settingsChanged=!1,"iOS"!==this.browser.OS&&"dialog"===a&&(i.save="1");for(g in this.params)this.params.hasOwnProperty(g)&&(h[g]=this.params[g]);for(g in i)i.hasOwnProperty(g)&&(h[g]=i[g]);h.speed=c.speed(rspkr.st.get("hlspeed"),h.speed),this.selectedHTML.length?(this.setPostContent("textsel"),d=m.issuePost(h)):rspkr.cfg.item("general.usePost")===!0?(this.setPostContent("nosel"),
d=m.issuePost(h)):d=f(h),b||(this.saveLink=d)}return d}},f=function(a){var b="";if("undefined"!=typeof rspkr.cfg.item("general.servercall"))b=rspkr.cfg.item("general.servercall")+"?";else{var c=$rs.get("."+rspkr.cfg.item("ui.rsbtnClass"));c=$rs.isArray(c)?c[0]:c,b=$rs.getAttr($rs.findIn(c,".rsbtn_play"),"href").split("?")[0]+"?"}for(var d in a)a.hasOwnProperty(d)&&a[d]&&(b+=d+"="+a[d]+"&");b=b.substr(0,b.length-1);var e=rs.cfg.item("general.customProxy")?rs.cfg.item("general.customProxy")+encodeURIComponent(b):b;return e},g=function(){var b=rspkr.cfg.item("extraMods")||[],c=([a.major,a.minor,a.update,a.revision].join("."),0),d=0;"Explorer"==rs.c.data.browser.name&&rs.c.data.browser.version<=8;for(var e in b)if(b.hasOwnProperty(e)){if(rspkr.mobile()&&b[e].mobile===!1)continue;d++,rspkr.log("[rspkr.c.loadExtraMods] Loading in additional mod: "+e),rspkr.rsload.load({id:"rsmod_"+e,type:"js"===b[e].type?"text/javascript":"text/css",src:(b[e].revDir?rspkr.revPath:"")+rspkr.rootNS+"."+e+"."+b[e].type,cb:function(){c++,c===d&&rs.devt("onAfterExtraModsLoaded",window)},async:!0})}},h={init:function(){rspkr.br.init(),e.browser=rspkr.br.info}},i={create:function(a,b,c,d,e){if(window.rsConf&&window.rsConf.general&&window.rsConf.general.noCookie||rspkr.cfg&&rspkr.cfg.item("general.noCookie"))return!1;c=-1===c?c:rspkr.pub&&rspkr.pub.Config?rspkr.pub.Config.item("general.cookieLifetime"):"",d=d||rspkr.pub&&rspkr.pub.Config?rspkr.pub.Config.item("general.cookiePath"):"",e=e||rspkr.pub&&rspkr.pub.Config?rspkr.pub.Config.item("general.cookieDomain"):"";var f;if(c){var g=new Date;g.setTime(g.getTime()+c),f="; expires="+g.toGMTString()}else f="";var h=d?"; path="+d:"",i=e?"; domain="+e:"",j=a+"="+b+f+h+i;return j+="https:"===document.location.protocol?"; SameSite=None; Secure":"; SameSite=Lax",document.cookie=j},read:function(a){for(var b=a+"=",c=document.cookie.split(";"),d=0;d<c.length;d++){for(var e=c[d];" "==e.charAt(0);)e=e.substring(1,e.length);if(0==e.indexOf(b))return e.substring(b.length,e.length)}return void 0},readKey:function(a,b){var c,d=this.read(a);if(d){d=d.split("&");for(var e=0,f=d.length;f>e;e++)if(c=d[e].split("="),c[0]==b)return c[1]}return void 0},readKeyAll:function(a){var b,c=this.read(a),d={};if(c){c=c.split("&");for(var e=0,f=c.length;f>e;e++)b=c[e].split("="),d[b[0]]=b[1];return d}return void 0},createSub:function(a,b,c,d,e){if("object"==typeof b){var f=[];for(var g in b)f.push(g+"="+b[g]);return this.create(a,f.join("&"),c,d,e)}this.create(a,b.toString(),c,d,e)},updateKey:function(a,b,c,d,e,f){if(window.rsConf&&window.rsConf.general&&window.rsConf.general.noCookie||rspkr.cfg&&rspkr.cfg.item("general.noCookie"))return!1;c=c.toString();var g,h=decodeURIComponent(this.read(a)),i={},j=!1;h=h&&"null"!=h&&"undefined"!=h?h.indexOf("=")>-1&&-1==h.indexOf("&")?[h]:h.split("&"):[];for(var k=0,l=h.length;l>k;k++)g=h[k].split("="),g[0]==b&&(g[1]=c,j=!0),g.length>1&&g[1].length&&(i[g[0]]=g[1]);return!j&&c.length&&(i[b]=c),this.createSub(a,i,d,e,f)},erase:function(a,b,c){this.create(a,"",-1,b,c)}},j=function(a,c){$rs.isArray(c)||(c=[c]);for(var d=0,e=c.length;e>d;d++)b[a].push(c[d])},k=function(a,c,d){if(b[a]){d=d||[];if(rspkr.displog[a]=rspkr.displog[a]?++rspkr.displog[a]:1,!b[a].length)return rspkr.log("[rspkr.c] Dispatched event: "+a+" - no handlers to call.",2),!0;rspkr.log("[rspkr.c] Dispatching event: "+a,1);for(var e in b[a].reverse())if(b[a].hasOwnProperty(e)&&"function"==typeof b[a][e])try{"__self__"===c&&(c=b[a][e]),b[a][e].apply(c,d)}catch(f){rspkr.log("[rspkr.c._dispatchEvent] Error: "+f.message,3),this.isok=!1}else if("object"==typeof b[a][e])try{var g=b[a][e];g.func.apply(g.context||window,g.params||d)}catch(f){this.isok=!1}}else rspkr.log("[rspkr.c] Undefined event: "+a,3)},l=function(a,c){if(/function|object/i.test(typeof c)){var d;$rs.isArray(c)||(c=[c]);for(var e=0,f=c.length;f>e;e++)if(d=c[e],b[a])for(var g=b[a].length-1;g>=0;g--)d===b[a][g]&&b[a].splice(g,1)}else b[a]&&(b[a]=[])},m={getPostData:function(a){a=e.mergeTempParams(a);var b=rspkr.c.post.getRsCall(!1),c=e.getSelectedText().length?"selectedhtml_base64":"html_base64",d=[];a[c]=e.getPostContent();for(var f in a)a.hasOwnProperty(f)&&d.push(f+"="+encodeURIComponent(decodeURIComponent(a[f])));return{rsCall:b,params:a,data:d.join("&")}},getRsCall:function(a,b){var c,d,e,f,g=b,h=rspkr.c.data.params;if(c="undefined"!=typeof rspkr.cfg.item("general.servercall")?rspkr.cfg.item("general.servercall")+"?":function(){var a=$rs.get("."+rspkr.cfg.item("ui.rsbtnClass"));return a=$rs.isArray(a)?a[0]:a,$rs.getAttr($rs.findIn(a,".rsbtn_play"),"href").split("?")[0]+"?"}(),d=function(a){var b="string"==typeof a&&a.length?a.split("/").pop():rspkr.pub.Config.item("general.rsent");return b.replace("?","")}(c),c=c&&c.match(/[^\/]*\/\/[^\/]*/),a===!0){var i=rspkr.cfg.item("general.iframeproxy")?rspkr.cfg.item("general.iframeproxy"):"/enterprise/iframeproxy.php";e=c?c.pop()+i+"?rsent="+d+"&version="+rspkr.pub.Config.item("general.proxyVersion"):rspkr.pub.Config.item("general.protocol")+"//"+rspkr.pub.Config.item("general.subdomain")+"."+rspkr.pub.Config.item("general.domain")+i+"?rsent="+rspkr.pub.Config.item("general.rsent")+"&version="+rspkr.pub.Config.item("general.proxyVersion"),e+="&randid="+g,h.customerid&&(e+="&customerid="+h.customerid)}else e=c.pop()+"/cgi-bin/"+d,e+="?logid="+h.customerid+"&ver="+rspkr.meta.version;return e+=h.wrc?"&wrc="+h.wrc:"",f=rs.cfg.item("general.customProxy")?rs.cfg.item("general.customProxy")+encodeURIComponent(e):e},issuePost:function(a){rspkr.log("[rspkr.c] Using POST"),document.getElementById("ReadSpeakerPostIframe")||this.createIframe(),a=e.mergeTempParams(a);var b,c=Math.random(),d=this.createForm(a);b=rspkr.c.post.getRsCall(!0,c),d.action=b;var f=document.createElement("textarea");return e.getSelectedText().length>1?f.setAttribute("name","selectedhtml_base64"):f.setAttribute("name","html_base64"),f.innerHTML=e.getPostContent(),d.appendChild(f),setTimeout(function(){document.body.appendChild(d),d.submit(),document.body.removeChild(d)},0),b+"&listen=1&randid="+c},createForm:function(a){var b,c=document.createElement("form");c.target="ReadSpeakerPostIframe"+rspkr.cfg.item("general.random"),c.method="post";for(var d in a)b=document.createElement("input"),b.setAttribute("name",d),"url"===d?b.setAttribute("value",decodeURIComponent(a[d])):b.setAttribute("value",a[d]),c.appendChild(b);return b=document.createElement("input"),b.setAttribute("name","output"),b.setAttribute("value","audiolink"),c.appendChild(b),c},createIframe:function(){if(!rspkr.cfg.item("general.random")){for(var a="",b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",c=0;20>c;c++)a+=b.charAt(Math.floor(Math.random()*b.length));rspkr.cfg.item("general.random",a)}var d=null;if(document.selection)try{d=document.createElement('<iframe name="ReadSpeakerPostIframe'+rspkr.cfg.item("general.random")+'">')}catch(e){d=document.createElement("iframe")}else d=document.createElement("iframe");d.setAttribute("name","ReadSpeakerPostIframe"+rspkr.cfg.item("general.random")),d.setAttribute("id","ReadSpeakerPostIframe"),d.style.display="none",d.style.position="absolute",d.setAttribute("sandbox","allow-scripts"),d.style.display="none";var f=document.getElementsByTagName("body"),g=null;f.length&&(g=f.item(0)),g&&g.appendChild(d)},removeIframe:function(){document.getElementById("ReadSpeakerPostIframe")}},n={encode:function(a){if("function"==typeof btoa)return btoa(encodeURIComponent(a).replace(/%([0-9A-F]{2})/g,function(a,b){return String.fromCharCode("0x"+b)}));for(var b=encodeURIComponent(a),c=0,d=0,e=[];c<b.length;c++)b.charCodeAt(c)!="%".charCodeAt(0)?e[d]=b.charCodeAt(c):(e[d]=parseInt("0x"+b.charAt(c+1)+b.charAt(c+2)),c+=2),d++;var f,g=e.length,h=(4*parseInt((g+2)/3),new String),i=parseInt(g/3),j=g-3*i;for(c=0;3*i>c;c+=3)f=this.chars(e[c]>>2),h+=f,f=this.chars((3&e[c])<<4|e[c+1]>>4),h+=f,f=this.chars((15&e[c+1])<<2|e[c+2]>>6),h+=f,f=this.chars(63&e[c+2]),h+=f;return 1==j&&(h+=this.chars(e[c]>>2),h+=this.chars((3&e[c])<<4),h+="=",h+="="),2==j&&(h+=this.chars(e[c]>>2),h+=this.chars((3&e[c])<<4|e[c+1]>>4),h+=this.chars((15&e[c+1])<<2),h+="="),h},decode:function(a){if("function"==typeof atob)return decodeURIComponent(atob(a).split("").map(function(a){return"%"+("00"+a.charCodeAt(0).toString(16)).slice(-2)}).join(""));for(var b="",c="",d=0,e=0,f="",g=a.length;g>d;)if(-1!=this.value(a[d])){f=a.substring(d,d+4),e=0;for(var h=0;4>h;h++)"="==f[h]&&e++;for(h=0;3-e>h;h++){0==h?c=this.value(f[0])<<2|(48&this.value(f[1]))>>4:1==h?c=(15&this.value(f[1]))<<4|(60&this.value(f[2]))>>2:2==h&&(c=(3&this.value(f[2]))<<6|this.value(f[3]));var i=c.toString(16);1==i.length&&(i="0"+i),b+="%"+i}d+=4}else d++;return decodeURIComponent(b)},value:function(a){var b=a.charCodeAt(0);return b>="A".charCodeAt(0)&&b<="Z".charCodeAt(0)?b-"A".charCodeAt(0):b>="a".charCodeAt(0)&&b<="z".charCodeAt(0)?b-"a".charCodeAt(0)+26:b>="0".charCodeAt(0)&&b<="9".charCodeAt(0)?b-"0".charCodeAt(0)+52:b=="+".charCodeAt(0)?62:b=="/".charCodeAt(0)?63:-1},chars:function(a){return 26>a?String.fromCharCode(a+"A".charCodeAt(0)):52>a?String.fromCharCode(a+"a".charCodeAt(0)-26):62>a?String.fromCharCode(a+"0".charCodeAt(0)-52):62==a?"+":63==a?"/":String.fromCharCode(0)}},o={findFirstRSButton:function(a){a=a||document.body;var b=$rs.get("a, .rsbtn_play");b=$rs.isArray(b)?b:[b];for(var c=0,d=b.length;d>c;c++){if($rs.hasClass(b[c],"rsbtn_play"))return b[c];if($rs.getAttr(b[c],"href")&&-1!==$rs.getAttr(b[c],"href").indexOf(rspkr.pub.Config.item("general.domain")+"/cgi-bin/"+rspkr.pub.Config.item("general.rsent")))return b[c];if($rs.getAttr(b[c],"href")&&/customerid=/i.test($rs.getAttr(b[c],"href"))&&/lang=/i.test($rs.getAttr(b[c],"href"))&&/(readid|readclass)/i.test($rs.getAttr(b[c],"href")))return b[c]}return!1},createShortcuts:function(){var a=window.ReadSpeaker;a.Common&&(a.c=a.Common),a.c&&(a.evt=a.c.addEvent,a.devt=a.c.dispatchEvent),a.c&&a.c.Settings&&(a.c.s=a.c.Settings),a.c.s&&(a.st=a.c.s),a.lib&&(a.l=a.lib),a.l&&a.lib.Facade&&(a.l.f=a.lib.Facade),a.l&&a.l.f&&a.l.f.adapter&&(a.l.f.a=a.l.f.adapter),a.modmap&&(a.m=a.modmap),a.PlayerAPI&&(a.pl=a.PlayerAPI),a.HL&&(a.hl=a.HL),a.ui&&(a.u=a.ui),a.ui&&a.ui.DragDrop&&(a.u.dd=a.ui.DragDrop),a.ui&&a.ui.Tools&&(a.u.t=a.ui.Tools)},fileExists:function(a,b,c){var d=this,e=!1;c=c||[],window.XMLHttpRequest?d.xmlHttpReq=new XMLHttpRequest:window.ActiveXObject&&(d.xmlHttpReq=new ActiveXObject("Microsoft.XMLHTTP")),d.xmlHttpReq.open("HEAD",a,!0),d.xmlHttpReq.onreadystatechange=function(){4===d.xmlHttpReq.readyState&&(200===d.xmlHttpReq.status&&(e=!0),"function"==typeof b&&(c.unshift(e,a),b.apply(window,c)))},d.xmlHttpReq.send()}};return{meta:a,init:function(){k("onInit",window),b.onInit=[],j("onUIShowPlayer",rspkr.Common.data.setDefaultValues),j("onSettingsChanged",rspkr.Common.data.setSettingsChanged),j("onAfterModsLoaded",g)},addEvent:function(a,b){j(a,b)},clearEvent:l,base64:n,buildReadSpeakerCall:function(a){return f(a)},data:e,Detect:h,dispatchEvent:function(a,b,c){k(a,b,c)},post:m,cookie:i,converter:c,sorting:d,findFirstRSButton:o.findFirstRSButton,decodeEntities:function(a){var b,c=document.createElement("p");return c.innerHTML=a,b=c.textContent||c.innerText,c=null,b},e:b,createShortcuts:o.createShortcuts,fileExists:o.fileExists}}(),ReadSpeaker.modmap={products:{all:[],custom:function(){var a=[];return a.push(["Custom","text/javascript",!0]),a},customCss:function(){var a=[];return a.push(["Custom","text/css",!0]),a},dr:function(){var a=[];return a.push(["DocReader.AutoAdd","text/javascript"]),a},fr:function(){var a=[];return a.push(["formReader","text/javascript"]),a},expl:function(){var a=this.all;return a.push(["PlayerAPI","text/javascript"],["XP","text/javascript"],["ui","text/javascript",["ui","ui.Lightbox","ui.Slider"]]),a},wr:function(){var a=this.all;return a},embhl:function(){return this.wr.call(this)},combined:function(){var a=[];return a}}},ReadSpeaker.PlayerAPI=function(){var a={revision:"1476"},b={html5:{prioritize:!0,audioFormat:null,check:function(){return rspkr.c.data.browser.html5Support?(this.audioFormat=rspkr.c.data.browser.html5AudioFormat,this.prioritize=rspkr.c.data.browser.html5Priority,!0):!1}},webAudio:{prioritize:!0,audioFormat:"flv",check:function(){return window.AudioContext||window.webkitAudioContext?"Firefox"===rspkr.Browser.info.name&&rspkr.Browser.info.version<40?!1:window.AudioContext||window.webkitAudioContext:!1}}},c="",d=function(){c=b.webAudio.check()&&b.webAudio.prioritize?"webAudio":b.html5.check()&&b.html5.prioritize?"html5":b.webAudio.check()?"webAudio":b.html5.check()?"html5":"fallback","html5"===rspkr.params.forceAdapter&&(c="html5"),"webAudio"===rspkr.params.forceAdapter&&(c="webAudio"),rspkr.pl[c]&&rspkr.pl[c].adapter?(rspkr.log("[rspkr.pl] Using adapter "+c,1),e(f,rspkr.pl[c].adapter)):(rspkr.log("[rspkr.pl] No adapter detected - using fallback!",3),e(f,rspkr.pl.fallback.adapter)),"function"==typeof rspkr.pl[c].init&&rspkr.pl[c].init()},e=function(a,b){for(var c in b)a[c]=b[c]},f={meta:a,init:function(){rspkr.log("[rspkr.pl] Initialized!"),rspkr.Common.addEvent("onModsLoaded",function(){rspkr.Common.Detect.init(),rspkr.PlayerAPI.setAdapter()})},setAdapter:function(){d()},getProduct:function(){return ReadSpeaker.HL?ReadSpeaker.HL:ReadSpeaker.XP?ReadSpeaker.XP:!1}};return f}(),rspkr.PlayerAPI.fallback=function(){var a={adapter:"fallback"};return{init:function(){ReadSpeaker.log("PlayerAPI.fallback heartbeat!")},adapter:a}}(),ReadSpeaker.Common.Settings=function(){var a={revision:"1476"},b={form:{key:"data-rsform-key",prev:"data-rsform-prev",valyes:"data-rsform-trueval",valno:"data-rsform-falseval"}},c={},d=[],e=function(a){return rspkr.Common.cookie.readKey(rspkr.pub.Config.item("general.cookieName"),a)||rspkr.pub.Config.item("settings."+a)},f=function(){return rspkr.Common.cookie.readKeyAll(rspkr.pub.Config.item("general.cookieName"))},g=function(a,b){var c=e(a);if(b!==c){var d=rspkr.c.cookie.updateKey(rspkr.cfg.item("general.cookieName"),a,b);return rspkr.cfg.item("settings."+a,b),rspkr.devt("onSettingsChanged",window,[a,b,c]),d}return null},h=function(){for(var a=["ReadSpeakerHL","ReadSpeakerHLicon","ReadSpeakerHLspeed"],b="",c=0,d=a.length;d>c;c++)(b=rspkr.Common.cookie.read(a[c]))&&(rspkr.Common.cookie.updateKey(rspkr.pub.Config.item("general.cookieName"),a[c].substr(11).toLowerCase(),b),rspkr.Common.cookie.erase(a[c]),rspkr.log("[rspkr.st] Transferred legacy cookie."));rspkr.Common.cookie.read(rspkr.pub.Config.item("general.cookieName"))&&rspkr.Common.cookie.updateKey(rspkr.pub.Config.item("general.cookieName"),"hlspeed",rspkr.Common.converter.speed(e("hlspeed")||100))},i={controls:{xp:function(a){return rspkr.st.r().expandPhrase(a)},helpButton:'<img src="'+rspkr.baseUrl+'img/help.png" alt="" border="0" />',select:function(a,c,d,e,f){var g=[],h="hl"!==a?!1:j(rspkr.c.data.getParam("lang"));g.push('<label for="',e,'">',this.xp(c.phrase),"</label>"),g.push('<select id="',e,'" name="',e,'" ',b.form.prev,'="',d,'" ',b.form.key,'="',a,'">');for(var i=0,k=c.options.length;k>i;i++)("hl"!==a||!h||/\bsent|none/i.test(c.options[i].value))&&("hl"===a&&h&&"sent"===c.options[i].value&&"none"!==d&&(d="sent"),g.push('<option value="',c.options[i].value,'"',d===c.options[i].value?' selected="selected"':"",c.options[i].dims?' data-rsform-dims="'+c.options[i].dims.join(",")+'"':"",c.options[i].hides?' data-rsform-hides="'+c.options[i].hides.join(",")+'"':"",">",this.xp(c.options[i].phrase),"</option>"));return g.push("</select>"),c.info&&(g.push('<div id="rscontainer_',e,'" class="rsform-info-container" aria-live="polite">',this.xp(c.info),"</div>"),rspkr.evt("onSettingsLoaded",{func:rspkr.st.r().handlers.info,context:rspkr.st.r().handlers,params:[e]})),f!==!0&&rspkr.evt("onSettingsLoaded",{func:rspkr.st.r().handlers.select,context:rspkr.st.r().handlers,params:[e]}),g.join("")},checkbox:function(a,c,d,e){var f=d===c.options.truevalue;return rspkr.evt("onSettingsLoaded",{func:rspkr.st.r().handlers.checkbox,context:rspkr.st.r().handlers,params:[e]}),['<fieldset class="rsform-checkbox-label" aria-level="2">','<input type="checkbox" id="',e,'" name="',e,'"',f?' checked="checked"':"",b.form.valyes,'="',c.options.truevalue,'" ',b.form.valno,'="',c.options.falsevalue,'"'," ",b.form.prev,'="',d,'" ',b.form.key,'="',a,'"'," />",'<label for="'+e+'">',this.xp(c.phrase),"</label>","</fieldset>"].join("")},radio:function(a,c,d,e){var f=[];f.push('<fieldset class="rsform-radio-label %c" aria-level="2">'.replace("%c",c["class"]||"")),f.push('<legend class="rs_skip">',this.xp(c.phrase)),f.push("</legend>");for(var g=0,h=c.options.length;h>g;g++)f.push('<label for="',e,"_",g,'">'),f.push('<input type="radio" id="',e,"_",g,'" name="',e,'" title="',this.xp(c.phrase),": ",this.xp(c.options[g].phrase),'" value="',c.options[g].value,'"'),f.push(" ",b.form.prev,'="',d,'" ',b.form.key,'="',a,'"'),f.push(d===c.options[g].value?' checked="checked"':""),c.options[g].dims&&f.push(' data-rsform-dims="',c.options[g].dims.join(","),'"'),f.push(" />"),f.push(' <span class="rs_skip">',this.xp(c.options[g].phrase),"</span></label>");return c.info&&(f.push('<div id="rscontainer_',e,'" class="rsform-info-container" aria-live="polite">',this.xp(c.info),"</div>"),rspkr.evt("onSettingsLoaded",{func:rspkr.st.r().handlers.info,context:rspkr.st.r().handlers,params:[e]})),f.push("</fieldset>"),rspkr.evt("onSettingsLoaded",{func:rspkr.st.r().handlers.radio,context:rspkr.st.r().handlers,params:[e,g]}),f.join("")},number:function(a,c,d,e){var f=[],g=c.phrase?"":"no-legend";return c["class"]&&(g+=" "+c["class"]),f.push('<fieldset class="rsform-number-label %c" aria-level="2">'.replace("%c",g)),c.phrase&&f.push('<legend class="rs_skip">%p</legend>'.replace("%p",this.xp(c.phrase))),c.phrase_before&&(f.push('<label for="%id" class="rsform-number-row">'.replace("%id",e)),f.push(this.xp(c.phrase_before)),f.push("</label>")),f.push('<input type="number" id="%id" class="rsform-number-row" %k %u %m %s />'.replace("%id",e).replace("%k",b.form.key+'="'+a+'"').replace("%u",c.unitfactor?'data-unit-conversion-factor="'+c.unitfactor+'"':"").replace("%m",c.min?' min="'+c.min+'"':"").replace("%s",c.step?' step="'+c.step+'"':"")),c.phrase_after&&(f.push('<label for="%id" class="rsform-number-row">'.replace("%id",e)),f.push(this.xp(c.phrase_after)),f.push("</label>")),f.push("</fieldset>"),rspkr.evt("onSettingsLoaded",{func:rspkr.st.r().handlers.number,context:rspkr.st.r().handlers,params:[e]}),f.join("")},info:function(a,b){return['<div class="rsform-infotext">',this.xp(b.phrase),"</div>"].join("")},slider_h:function(a,d,e,f){return rspkr.evt("onSettingsLoaded",{func:rspkr.st.r().handlers.slider_h,context:rspkr.st.r().handlers,params:[d,f,e]}),c[f]=d,['<span class="rsform-slider-label">',this.xp(d.phrase),"</span>",'<span id="',f,'" class="rsform-slider rsimg" ',b.form.key,'="',a,'" ',b.form.prev,'="',e,'"></span>'].join("")},colorpicker:function(a,c,d,e){var f=[];f.push('<fieldset class="rsform-colorlist-label" aria-level="2">'),f.push("<legend>",this.xp(c.phrase),"</legend>"),f.push('<ul id="',e,'" class="rsform-colorlist" ',b.form.prev,'="',d,'" ',b.form.key,'="',a,'">');for(var g=0,h=c.options.length;h>g;g++)f.push("<li",d===c.options[g].value?' class="rsform-colorlist-active"':"",">"),f.push('<a href="javascript: void(0);"'),f.push(d===c.options[g].value?' tabIndex="0"':' tabIndex="-1"'),f.push(d===c.options[g].value?' aria-pressed="true"':' aria-pressed="false"'),f.push(' title="'+this.xp(c.phrase)+": "+this.xp(c.options[g].phrase)+'"'),f.push(' data-rsform-value="',c.options[g].value,'"'),("underline"===c.options[g].value||"none"===c.options[g].value)&&(f.push(' class="'),"underline"===c.options[g].value&&f.push("rsform-colorlist-style-underline "),"none"===c.options[g].value&&f.push("rsform-colorlist-style-none "),f.push('"')),f.push(' role="button"><span class="rsform-colorlist-box"></span>'),f.push('<span class="rsform-colorlist-label'),/#/.test(c.options[g].value)&&f.push(" rsform-colorlist-style-color"),f.push('">',this.xp(c.options[g].phrase),"</span></a>"),f.push("</li>");return f.push("</ul>"),f.push('<div class="rs_clearfix"></div>'),c.info&&(f.push('<div id="rscontainer_',e,'" class="rsform-info-container" aria-live="polite">',this.xp(c.info),"</div>"),rspkr.evt("onSettingsLoaded",{func:rspkr.st.r().handlers.info,context:rspkr.st.r().handlers,params:[e]})),f.push("</fieldset>"),rspkr.evt("onSettingsLoaded",{func:rspkr.st.r().handlers.colorpicker,context:rspkr.st.r().handlers,params:[e]}),f.join("")},restore:function(a,b,c,d){var e=['<input type="button" id="',d,'" value="',this.xp("ph_"+a),'" class="rsdialog-button" role="button"></input>'];return b.info&&(e.push('<div id="rscontainer_',d,'" class="rsform-info-container" aria-live="polite">',this.xp(b.info),"</div>"),rspkr.evt("onSettingsLoaded",{func:rspkr.st.r().handlers.info,context:rspkr.st.r().handlers,params:[d]})),rspkr.evt("onSettingsLoaded",{func:rspkr.st.r().handlers.restore,context:rspkr.st.r().handlers,params:[d]}),e.join("")},infobox:function(a,b,c,d){var e=[];return e.push('<label for="',d,'">',this.xp(b.phrase),"</label>"),b.info&&(e.push('<div id="rscontainer_',d,'" class="rsform-info-container" aria-live="polite">',this.xp(b.info),"</div>"),rspkr.evt("onSettingsLoaded",{func:rspkr.st.r().handlers.info,context:rspkr.st.r().handlers,params:[d]})),e.join("")}},handlers:{info:function(a){$rs.regEvent($rs.get("#rstoggle_"+a),"click",this.changed.info)},infoToggle:function(){var a=$rs.closest(this,".rsform-row"),b=$rs.findIn(a,".rsform-info-container");if($rs.isArray(b)&&b.length||"object"==typeof b){var c="none"===$rs.css(b,"display");$rs.css(b,"display",c?"block":"none"),$rs.setAttr(this,"aria-expanded",c);var d=$rs.findIn(this,".rsbtn_btnlabel");d&&!$rs.getAttr(this,"data-label-orig")&&$rs.setAttr(this,"data-label-orig",d.innerHTML),d&&c?d.innerHTML=$rs.getAttr(this,"data-label-orig")+" - "+rspkr.Lang.getPhrase("helptextabove"):d.innerHTML=$rs.getAttr(this,"data-label-orig")}},select:function(a){$rs.regEvent($rs.get("#"+a),"change",this.changed.select)},checkbox:function(a){$rs.regEvent($rs.get("#"+a),"click",this.changed.checkbox)},radio:function(a,b){for(var c=0;b>c;c++)$rs.regEvent($rs.get("#"+a+"_"+c),"click",this.changed.radio)},number:function(a){$rs.regEvent($rs.get("#"+a),"change",this.changed.number)},slider_h:function(a,b,c){var e=new ReadSpeaker.ui.Slider,f={};if(a.options)for(var g in a.options)a.options.hasOwnProperty(g)&&(f[g]=rspkr.st.r().expandPhrase(a.options[g]));f.initval=a.converter?a.converter(c)/(200/a.options.steps):c/(200/a.options.steps)||0,f.start=function(){},f.drop=this.changed.slider_h,e.init($rs.get("#"+b),f),d[b]=e,rspkr.evt("onResizeFinished",function(a){a===$rs.get("#rslightbox_contentcontainer")&&e.rerender()})},colorpicker:function(a){$rs.regEvent("#"+a+" li a","keydown",function(a){var b,c=$rs.closest(this,"li");if(37===a.keyCode?b=c.previousSibling:39===a.keyCode&&(b=c.nextSibling),b){var d=$rs.findIn(b,"a");d.focus(),d.click()}}),$rs.regEvent("#"+a+" li a","click",this.changed.colorpicker),$rs.css($rs.get("#"+a),"display","block"),$rs.arr("#"+a+" li").forEach(function(a){var b=a.querySelector("a").getAttribute("data-rsform-value");/#/.test(b)&&(a.querySelector(".rsform-colorlist-box").style.backgroundColor=b),"underline"===b&&(a.querySelector(".rsform-colorlist-label").style.textDecoration=b)})},restore:function(a){$rs.regEvent("#"+a,"click",function(){rspkr.ui.Lightbox.ToolbarHelper.reset();var a=rspkr.cfg["default"]("settings");for(var c in a)if(a.hasOwnProperty(c)){var e=a[c];if("hlspeed"===c&&(e=rspkr.Common.converter.speed(e)),rspkr.st.r().handlers.updateSetting(c,e),f=$rs.get('input[data-rsform-key="'+c+'"][type="number"]'),!$rs.isArray(f)){"popupclosetime"===c&&(e>0?(f.value=e/1e3,f.disabled=!1,$rs.get('input[value="popupcloseon"]').checked=!0):(f.value=void 0,f.disabled=!0,$rs.get('input[value="popupcloseoff"]').checked=!0)),$rs.setAttr(f,b.form.prev,e);continue}var f=$rs.arr("input["+b.form.key+"='"+c+"']");if(f.length){for(var g=0;g<f.length;g++)$rs.getAttr(f[g],"value")===e&&(f[g].checked=!0),$rs.setAttr(f[g],b.form.prev,e);continue}if(f=$rs.get("select[data-rsform-key='"+c+"']"),!$rs.isArray(f)){f.value=e,$rs.setAttr(f,b.form.prev,e);continue}if(f=$rs.get("ul[data-rsform-key='"+c+"']"),!$rs.isArray(f)){var h=$rs.findIn(f,".rsform-colorlist-active");$rs.removeClass(h,"rsform-colorlist-active");var i=$rs.findIn(f,"a[data-rsform-value='"+e+"']"),j=i.parentNode;$rs.addClass(j,"rsform-colorlist-active"),$rs.setAttr(f,b.form.prev,e);continue}if(f=$rs.get('.rsform-slider[data-rsform-key="'+c+'"]'),!$rs.isArray(f)){var k=d[$rs.getAttr(f,"id")];k.jumpTo(e/(200/k.getConf().steps)),$rs.setAttr(f,b.form.prev,e)}}rspkr.Common.Settings.r().handlers.changed.afterdim()})},changed:{dimmed:[],hidden:[],disable:function(a,b){b=b||"dimmed";var c=$rs.findIn(a,"input, select, textarea, ul.rsform-colorlist, button");if($rs.isArray(c)||(c=[c]),$rs.addClass(a,b),"dimmed"===b)for(var d,e=0;d=c[e];e++)switch(d.tagName.toLowerCase()){case"ul":for(var f,g=$rs.findIn(d,"a"),h=0;f=g[h];h++)f.disabled=!0,$rs.setAttr(f,"disabled","");break;default:d.disabled=!0,$rs.setAttr(d,"disabled","")}},enable:function(a,b){b=b||"dimmed";var c=$rs.findIn(a,"input, select, textarea, ul.rsform-colorlist, button");if($rs.isArray(c)||(c=[c]),$rs.removeClass(a,b),"dimmed"===b)for(var d,e=0;d=c[e];e++)switch(d.tagName.toLowerCase()){case"ul":for(var f,g=$rs.findIn(d,"a"),h=0;f=g[h];h++)f.disabled=!1,f.removeAttribute("disabled");break;default:d.disabled=!1,d.removeAttribute("disabled")}},add:function(a,b,c,d){a[b]||(a[b]=[]);for(var e=0,f=c.length;f>e;e++)this.disable($rs.get("#rscontrol_"+c[e]),d),a[b].push($rs.get("#rscontrol_"+c[e]))},release:function(a,b,c){if(a[b]){for(var d=0,e=a[b].length;e>d;d++)this.enable(a[b][d],c);a[b]=[]}},dim:function(a,b){this.undim(a),this.add(this.dimmed,a,$rs.isArray(b)?b:[b],"dimmed")},undim:function(a){this.release(this.dimmed,a,"dimmed")},afterdim:function(){for(var a,b,c=$rs.get("#rslightbox_content .rsform-row"),d=0,e=c.length;e>d;d++)b=$rs.getAttr(c[d],"data-rsform-type"),a=this.dimmees[b]?this.dimmees[b](c[d]):null,"string"==typeof a?this.dim(c[d].id.replace("rscontrol_",""),a.split(",")):1===a&&this.undim(c[d].id.replace("rscontrol_",""))},addButtonEvents:function(a){$rs.regEvent($rs.get("#rslightbox_buttons .rssettings-button-close"),"click",a.hide)},dimmees:{radio:function(a){for(var b,c=$rs.findIn(a,'input[type="radio"]'),d=!1,e=0,f=c.length;f>e;e++)if(c[e].checked){b=c[e];break}return b&&(d=$rs.getAttr(b,"data-rsform-dims")||1),d},select:function(a){for(var b,c=$rs.findIn(a,"option"),d=!1,e=0,f=c.length;f>e;e++)if(c[e].selected){b=c[e];break}return b&&(d=$rs.getAttr(b,"data-rsform-dims")||1),d}},info:function(a){if(!$rs.hasClass(a.target.parentNode,"dimmed")&&!$rs.hasClass(a.target.parentNode.parentNode,"dimmed")){var b=$rs.get("#"+$rs.getAttr(this,"data-rsform-toggles"));$rs.css(b,"display","none"===$rs.css(b,"display")?"block":"none")}return!1},select:function(a){return this.value!==$rs.getAttr(this,b.form.prev)&&rspkr.st.r().handlers.updateSetting.apply(rspkr.st.r().handlers,[$rs.getAttr(this,b.form.key),this.value,this]),!0},checkbox:function(a){var c=this.checked?$rs.getAttr(this,b.form.valyes):$rs.getAttr(this,b.form.valno);return c!==$rs.getAttr(this,b.form.prev)&&rspkr.st.r().handlers.updateSetting.apply(rspkr.st.r().handlers,[$rs.getAttr(this,b.form.key),c,this]),!0},radio:function(a){return this.value!==$rs.getAttr(this,b.form.prev)&&(rspkr.st.r().handlers.updateSetting.apply(rspkr.st.r().handlers,[$rs.getAttr(this,b.form.key),this.value,this]),$rs.setAttr($rs.findIn($rs.closest(this,".rsform-row"),'input[name="'+this.name+'"]'),b.form.prev,this.value)),!0},number:function(a){(parseInt(this.value)<parseInt(this.min)||!this.value.length)&&(this.value=this.min);var c=this.value*($rs.getAttr(this,"data-unit-conversion-factor")||1);rspkr.st.r().handlers.updateSetting.apply(rspkr.st.r().handlers,[$rs.getAttr(this,b.form.key),c,this])},slider_h:function(a,d){var e=d.parent,f=c[d.rsid],g=f.converter?f.converter(parseInt(a))*(200/f.options.steps):parseInt(a)*(200/f.options.steps),h=$rs.getAttr(e,b.form.prev);g!==h&&rspkr.st.r().handlers.updateSetting.apply(rspkr.st.r().handlers,[$rs.getAttr(e,b.form.key),g,e])},colorpicker:function(a){a.originalEvent&&a.originalEvent.preventDefault&&a.originalEvent.preventDefault();var c=$rs.closest(a.target,".rsform-row"),d=a.target.parentNode.parentNode,e=a.target.parentNode;if(!$rs.hasClass(c,"dimmed")&&$rs.getAttr(a.target,"data-rsform-value")!==$rs.getAttr(d,b.form.prev)){$rs.removeClass($rs.findIn(d,"li"),"rsform-colorlist-active"),rspkr.st.r().handlers.updateSetting.apply(rspkr.st.r().handlers,[$rs.getAttr(d,b.form.key),$rs.getAttr(a.target,"data-rsform-value"),d]),$rs.addClass(e,"rsform-colorlist-active"),$rs.setAttr($rs.findIn(d,"a"),"aria-pressed","false"),$rs.setAttr($rs.findIn(e,"a"),"aria-pressed","true");for(var f,g=$rs.findIn(d,"a"),h=0;f=g[h];h++)$rs.setAttr(f,"tabIndex","-1");$rs.setAttr(a.target,"tabIndex",0)}}},updateSetting:function(a,c,d){if(rspkr.log("[rspkr.st] Setting updated: "+a+" | New value: "+c),g(a,c),d){var e=$rs.closest(d,".rsform-row"),f=$rs.css(e,"background-color");rspkr.u.hl(e,function(){$rs.css(this,"background-color",f)}),$rs.setAttr($rs.get(d),b.form.prev,c)}}},initializers:{popupclosetime:function(a,b,c){var d=rspkr.st.get("popupclosetime")||rspkr.cfg.item("general.popupCloseTime")||rspkr.cfg["default"]("settings.popupCloseTime")||1e4;d>0?($rs.findIn(".rs_popupclose",'input[value="popupcloseon"]').checked=!0,$rs.findIn(".rs_popupclosetime",'input[type="number"]').value=d/1e3,$rs.findIn(".rs_popupclosetime",'input[type="number"]').disabled=!1):($rs.findIn(".rs_popupclose",'input[value="popupcloseoff"]').checked=!0,$rs.findIn(".rs_popupclosetime",'input[type="number"]').value=null,$rs.findIn(".rs_popupclosetime",'input[type="number"]').disabled=!0);var e=function(){"popupcloseon"===this.value?(rspkr.st.set("popupclosetime",1e4),$rs.findIn(".rs_popupclosetime",'input[type="number"]').value=10):(rspkr.st.set("popupclosetime",-1),$rs.findIn(".rs_popupclosetime",'input[type="number"]').value=null)},f=function(){rspkr.cfg.item("general.popupCloseTime",1e3*this.value)};$rs.unregEvent($rs.findIn(".rs_popupclose",'input[type="radio"]'),"change",e),$rs.regEvent($rs.findIn(".rs_popupclose",'input[type="radio"]'),"change",e),$rs.unregEvent($rs.findIn(".rs_popupclosetime",'input[type="number"]'),"change",f),$rs.regEvent($rs.findIn(".rs_popupclosetime",'input[type="number"]'),"change",f)}},expandSentence:function(a){var b=a.match(/ph_[a-z_0-9]*/gi);if(b){for(var c=0,d=b.length;d>c;c++)b[c]=[b[c],this.expandPhrase(b[c])];for(c=0;c<b.length;c++)a=a.replace(b[c][0],b[c][1]);return a}return a},expandPhrase:function(a){return"string"==typeof a&&"ph_"===a.substr(0,3)?(a=a.substr(3),rspkr.Lang.getPhrase(a)||a):a},row:function(a,b,c){if(/hlword|hltoggle/i.test(a)&&j(rspkr.c.data.getParam("lang")))return"";var d,e=rspkr.cfg.item("ui.settings.formrow").join("\n"),f={},g=ReadSpeaker.getID();return d=this.controls[b.type](a,b,c,g),f.rsCONTROL_IDrs=a,f.rsCONTROLrs=d,f.rsCONTROL_TYPErs=b.type,f.rsCONTROL_CLASSESrs=b.classes?b.classes.join(" "):"",f.rsINFOTOGGLERrs=/rsform-info-container/i.test(d)?'<fieldset class="rsbtn_btnlabel_fieldset" aria-level="2"><button type="button" class="rsform-info-toggle rs_skip" title="'+this.controls.xp("ph_togglehelpfor")+": "+this.controls.xp(b.phrase)+'" aria-expanded="false"><span class="rsicn rsicn-help" aria-hidden="true"></span><span class="rsbtn_btnlabel">'+this.controls.xp("ph_togglehelpfor")+": "+this.controls.xp(b.phrase)+"</span></button></fieldset>":"",f.rsCONTROL_ARIAHIDDENrs=b.ariahidden===!0?'aria-hidden="true"':"",this.initializers.hasOwnProperty(a)&&rspkr.Common.addEvent("onSettingsLoaded",this.initializers[a].bind(void 0,b,c,g)),this.replaceTokens(e,f)},group:function(a){if(a.desktop!==!1||rspkr.mobile()){var b=rspkr.cfg.item("ui.settings.formsection").join("\n"),c={},d=[];
for(var f in a.items)a.items.hasOwnProperty(f)&&null!==a.items[f]&&d.push(this.row(f,a.items[f],e(f)));return c.rsSECTION_IDrs=ReadSpeaker.getID(),c.rsSECTION_HEADINGrs=this.controls.xp(a.phrase),c.rsSECTION_ROWSrs=d.join("\n"),c.rsCONTROL_ARIAHIDDENrs=a.ariahidden===!0?'aria-hidden="true"':"",this.replaceTokens(b,c)}},replaceTokens:function(a,b){var c=a;for(var d in b)b.hasOwnProperty(d)&&(c=c.replace(new RegExp(d,"igm"),b[d]));return c}},j=function(a){for(var b=rspkr.item("general.sentOnlyLang")||[],c=0,d=b.length;d>c;c++)if(a&&b[c]==a.toLowerCase())return!0;return!1},k=function(){$rs.regEvent($rs.get(".rsform-info-toggle"),"click",i.handlers.infoToggle)},l={init:function(){l.setVoice()},setVoice:function(){function a(a){var b=a?$rs.getAttr(a,"href"):rspkr.findHref();if(rspkr.cfg.item("general.saveLangVoice")&&rspkr.st.get("langvoice"))c=rspkr.st.get("langvoice").split(",").shift(),d=rspkr.st.get("langvoice").split(",").pop(),b=rspkr.setParam("lang",c,b),b=rspkr.setParam("voice",d,b),a?$rs.setAttr(a,"href",b):rspkr.cfg.item("general.popupHref",b);else if(c=rspkr.getParam("lang",b),rspkr.getParam("voice",b)){if(f[c].voice&&f[c].voice!==rspkr.getParam("voice",b))b=rspkr.setParam("voice",f[c].voice,b),a?$rs.setAttr(a,"href",b):rspkr.cfg.item("general.popupHref",b);else if($rs.isArray(f[c])&&f[c].length){for(var e=!0,g=0,h=f[c].length;h>g;g++)if(f[c][g].voice===rspkr.getParam("voice",b)){e=!1;break}e&&(b=rspkr.setParam("voice",f[c][0].voice,b),a?$rs.setAttr(a,"href",b):rspkr.cfg.item("general.popupHref",b))}}else d=(f[c][0]||f[c]).voice||"",d&&(b=rspkr.setParam("voice",d,b),a?$rs.setAttr(a,"href",b):rspkr.cfg.item("general.popupHref",b))}if(rspkr.features.voicesettings){var b,c,d,e=rspkr.getRSBtns(),f=rspkr.cfg.item("general.readingLangs");if(Object.size(f)){if(e.length)for(var g=0,h=e.length;h>g;g++)b=$rs.findIn(e[g],".rsbtn_play"),a(b);else a();rspkr.devt("onVoiceParamsSet","__self__",[c,d])}}}},m={reading:{phrase:"ph_reading",items:{hlspeed:{phrase:"ph_speed",type:"slider_h",info:"ph_hlspeedinfo",options:{handleClass:"rsbtn_speed_handle rsimg",dir:"h",steps:40,initval:20,labelDragHandle:"ph_speed",labelStart:"ph_slow",labelEnd:"ph_fast"}}},desktop:!1},highlighting:{phrase:"ph_highlighting",items:{hltoggle:{phrase:"ph_showhighlighting",type:"radio",info:"ph_hltoggleinfo",options:[{value:"hlon",phrase:"ph_on"},{value:"hloff",phrase:"ph_off",dims:["hl","hlword","hlsent","hltext"]}],ariahidden:!0},hl:{phrase:"ph_highlightingoptions",type:"select",info:"ph_hloptionsinfo",options:[{value:"wordsent",phrase:"ph_wordsent"},{value:"sent",phrase:"ph_sentonly",dims:["hlword"]},{value:"word",phrase:"ph_wordonly",dims:["hlsent"]},{value:"none",phrase:"ph_nohighlighting",dims:["hlword","hlsent","hltext"]}],ariahidden:!0},hlword:{phrase:"ph_wordcolor",type:"colorpicker",info:"ph_hlwordinfo",options:[{value:"#beffd6",phrase:"ph_lightgreen"},{value:"#a4cbff",phrase:"ph_lightblue"},{value:"#ffffcc",phrase:"ph_lightyellow"},{value:"#ffff00",phrase:"ph_yellow"},{value:"#ffffff",phrase:"ph_white"},{value:"#000000",phrase:"ph_black"},{value:"#770000",phrase:"ph_darkred"},{value:"#ED0000",phrase:"ph_red"},{value:"underline",phrase:"ph_underline"},{value:"none",phrase:"ph_none"}],ariahidden:!0},hlsent:{phrase:"ph_sentcolor",type:"colorpicker",info:"ph_hlsentinfo",options:[{value:"#beffd6",phrase:"ph_lightgreen"},{value:"#a4cbff",phrase:"ph_lightblue"},{value:"#ffffcc",phrase:"ph_lightyellow"},{value:"#ffff00",phrase:"ph_yellow"},{value:"#ffffff",phrase:"ph_white"},{value:"#000000",phrase:"ph_black"},{value:"#770000",phrase:"ph_darkred"},{value:"#ED0000",phrase:"ph_red"},{value:"underline",phrase:"ph_underline"},{value:"none",phrase:"ph_none"}],ariahidden:!0},hltext:{phrase:"ph_textcolor",type:"colorpicker",info:"ph_hltextinfo",options:[{value:"#003f00",phrase:"ph_darkgreen"},{value:"#0000aa",phrase:"ph_darkblue"},{value:"#ffff00",phrase:"ph_yellow"},{value:"#ffffff",phrase:"ph_white"},{value:"#000000",phrase:"ph_black"},{value:"#a4cbff",phrase:"ph_lightblue"}],ariahidden:!0}},ariahidden:!0},textsettings:{phrase:"ph_textsettings",items:{lbfontsize:{phrase:"ph_fontsize",type:"select",info:"ph_fontsizeinfo",options:[{value:"0.8",phrase:"-1"},{value:"1.0",phrase:"ph_normal"},{value:"1.2",phrase:"+1"},{value:"1.4",phrase:"+2"},{value:"1.6",phrase:"+3"},{value:"1.8",phrase:"+4"},{value:"2.0",phrase:"+5"},{value:"4.0",phrase:"+6"},{value:"6.0",phrase:"+7"}],ariahidden:!0},fontface:{phrase:"ph_fontface",type:"select",info:"ph_fontfaceinfo",options:[{value:"serif",phrase:"Times New Roman"},{value:"sansserif",phrase:"Arial"},{value:"cursive",phrase:"Comic Sans"},{value:"monospace",phrase:"Courier New"},{value:"dyslexic",phrase:"Open Dyslexic"}],ariahidden:!0},textstyle:{phrase:"ph_textstyle",type:"select",info:"ph_textstyleinfo",options:[{value:"blackyellow",phrase:"ph_blackyellow"},{value:"blackwhite",phrase:"ph_blackwhite"},{value:"blackblue",phrase:"ph_blackblue"},{value:"blackpink",phrase:"ph_blackpink"},{value:"redyellow",phrase:"ph_redyellow"},{value:"redwhite",phrase:"ph_redwhite"},{value:"redblue",phrase:"ph_redblue"},{value:"blueyellow",phrase:"ph_blueyellow"},{value:"bluewhite",phrase:"ph_bluewhite"},{value:"bluepink",phrase:"ph_bluepink"},{value:"yellowblack",phrase:"ph_yellowblack"},{value:"blueblack",phrase:"ph_blueblack"}],ariahidden:!0}},ariahidden:!0},general:{phrase:"ph_general",items:{hlscroll:{phrase:"ph_autoscroll",type:"radio",info:"ph_hlscrollinfo",options:[{value:"scrollon",phrase:"ph_on"},{value:"scrolloff",phrase:"ph_off"}],ariahidden:!0},hlicon:{phrase:"ph_popupbutton",type:"radio",info:"ph_hliconinfo",options:[{value:"iconon",phrase:"ph_on"},{value:"iconoff",phrase:"ph_off",dims:["popupclose","popupclosetime"]}],mobile:!1},popupclose:{type:"radio",phrase:"ph_popupclose",info:"ph_popupcloseinfo","class":"rs_popupclose",options:[{value:"popupcloseon",phrase:"ph_popupcloseon"},{value:"popupcloseoff",phrase:"ph_popupcloseoff",dims:["popupclosetime"]}],mobile:!1},popupclosetime:{type:"number",phrase_before:"ph_popupclosetime",phrase_after:"ph_popupclosetimeseconds","class":"rs_popupclosetime",min:1,step:1,unitfactor:1e3,mobile:!1},hlprivacy:{phrase:"ph_privacy",type:"infobox",info:"ph_privacyinfo"}}},restore:{phrase:"ph_hlrestore",items:{hlrestore:{phrase:"ph_hlrestore",info:"ph_hlrestoreinfo",type:"restore"}}}};return{meta:a,r:function(){return i},e:b,init:function(){h(),rspkr.Common.dispatchEvent("onSettingsInitialized"),rspkr.log("[rspkr.st] Initialized!"),rspkr.Common.addEvent("onSettingsLoaded",{func:rspkr.Common.Settings.r().handlers.changed.afterdim,context:rspkr.Common.Settings.r().handlers.changed,params:[]}),rspkr.Common.addEvent("onSettingsLoaded",{func:k,context:this,params:[]}),rspkr.Common.addEvent("onSettingsChanged",{func:rspkr.Common.Settings.r().handlers.changed.afterdim,context:rspkr.Common.Settings.r().handlers.changed,params:[]}),rspkr.Common.addEvent("onAfterModsLoaded",{func:l.init,context:this,params:[]})},get:function(a){return e(a)},getAll:function(){return f()},getSettingsConf:function(){return m},set:function(a,b){return g(a,b)},getHTML:function(a){var b=rspkr.cfg,c=[],d=b.item("ui.settings.form").join("\n"),e={},f=b.getSettingsConf(),g=["textsettings"];for(var h in f)if(f.hasOwnProperty(h)&&null!==f[h]&&(a===!0||-1===g.indexOf(h))){for(var j in f[h].items)f[h].items.hasOwnProperty(j)&&f[h].items[j]&&f[h].items[j].mobile===!1&&rspkr.mobile()&&delete f[h].items[j];c.push(i.group(f[h]))}return e.rsSETTINGS_HEADINGrs=i.controls.xp("ph_settings"),e.rsSECTIONS_STARTrs="",e.rsSECTIONSrs=c.join(""),e.rsSECTIONS_ENDrs="",i.replaceTokens(d,e)},getButtons:function(){var a=rspkr.cfg,b=a.item("ui.settings.formbuttons").join("\n"),c={};return c.rsSETTINGS_BUTTON_CLOSErs=i.controls.xp("ph_close"),c.rsSETTINGS_BUTTON_CLOSE_DIALOGrs=i.controls.xp("ph_closedialog"),i.replaceTokens(b,c)}}}(),window.ReadSpeaker.Common.Player=function(){var a=function(a,b){a&&($rs.removeClass(a,"rsloading rspaused rsstopped rsplaying rsidle"),$rs.addClass(a,b))},b={open:function(){rspkr.ui.getActivePlayer()&&rspkr.ui.getActivePlayer().pause(),rspkr.c.dispatchEvent("onBeforeSettingsOpened",window,[]);var a=/rsversion/i.test(document.location.href)?'<span id="rs_versioninfo">webReader %major%.%minor%.%update% (%full%)</span>'.replace("%major%",rspkr.meta.obj.major).replace("%minor%",rspkr.meta.obj.minor).replace("%update%",rspkr.meta.obj.update).replace("%full%",rspkr.meta.version):"";rspkr.ui.Lightbox.show(rspkr.st.getHTML()+a,rspkr.st.getButtons(),!0,function(a){$rs.css("#rsform_wrapper","font-size",rspkr.st.get("lbfontsize")+"em");var c=$rs.get("rslightbox_closer");$rs.regEvent(c,"click",b.close),rspkr.ui.addClickEvents()},!1,"[fontplus fontminus] [volume speed textsettings]",{cssDimensions:rspkr.mobile()?!0:!1,reopenActivePlayer:rspkr.mobile()?!0:!1,customFont:!0,customTextStyle:!0});var c=$rs.arr(".rsbtn_tool_settings button.rsbtn_tool");$rs.setAttr(c,"aria-expanded",!0),rspkr.c.dispatchEvent("onSettingsLoaded",window,[]),rspkr.cfg.execCallback("cb.ui.settingsopened")},close:function(){var a=$rs.get("rslightbox_closer");$rs.unregEvent(a,"click",b.close),rspkr.c.dispatchEvent("onSettingsClosed",window,[])}},c=function(){};return{init:c,setStateClass:a,settings:b}}(),rspkr.Lang=function(){var a=["ar_ar","ca_es","da_dk","de_de","en_us","en_uk","es_es","eu_es","fi_fi","fo_fo","fr_fr","fr_be","fr_ca","gl_es","is_is","it_it","ja_jp","ko_kr","lv_lv","nl_nl","no_nb","pl_pl","pt_pt","pt_br","sv_se","zh_cn","zh_tw"],b={},c={},d=void 0,e=function(){void 0===d&&window.ReadSpeaker.Common.addEvent("onReady",function(){p(void 0,{load:!0,updateUi:!0,force:!1})})},f=function(){return rspkr.cfg.item("general.fallbacklang")||"en_us"},g=function(b){if(b=b.toLowerCase().replace("-","_"),"en"===b&&(b="en_us"),"es"===b&&(b="es_es"),"sv"===b&&(b="sv_se"),"en_gb"===b&&(b="en_uk"),2===b.length&&a.indexOf(b+"_"+b)>=0&&(b=b+"_"+b),-1===a.indexOf(b))for(var c=0;c<a.length;c++)if(a[c].substring(0,2)===b.substring(0,2)){b=a[c];break}return-1===a.indexOf(b)&&(b="en_us"),b},h=function(a){switch(a.toLowerCase()){case"en_sc":case"en_au":return"en_uk";case"es_co":case"es_mx":case"es_us":return"es_es";case"nl_be":return"nl_nl";case"sv_fi":return"sv_se";default:return a}},i=function(d,e){if(!c[d]){if(b[d])return void(e.updateUi&&m(e.container,d));if(c[d]=!0,-1===a.indexOf(d))return k(d),c[d]=!1,void(e.updateUi&&m(e.container,d));var g;window.XMLHttpRequest&&(g=new XMLHttpRequest),window.ActiveXObject&&(g=new ActiveXObject("Microsoft.XMLHTTP"));var h=rspkr.baseUrl+rspkr.revPath+"lang/"+d+".json";g.open("GET",h,!0),g.onreadystatechange=function(){if(4===g.readyState&&200===g.status)try{var a={};a[d]=JSON.parse(g.response||g.responseText),l(a),j(d),k(d),c[d]=!1,rspkr.devt("onLangLoaded"),e.updateUi&&m(e.container,d),e.key&&q(key)}catch(b){rspkr.log("[rspkr.Lang.loadLang] Could not load language: "+d,3),c[d]=!1}else 4===g.readyState&&404===g.status&&(rspkr.log("[rspkr.Lang.loadLang] Could not load language: "+d,3),c[d]=!1,d!==f()&&p(f(),{load:!0}))},g.send()}},j=function(a){if(a&&rspkr.phrases)for(var c=0;100>c;c++){var d=rspkr.mapPhrase((c+10).toString(36)),e=rspkr.getPhrase(d,a,!0);if(!e)break;b[a][d]=e}},k=function(a){var b=rspkr.cfg.item("phrases."+a);if(b&&"object"==typeof b){var c={};c[a]=b,l(c)}},l=function(a){for(var c in a){a.hasOwnProperty(c)&&b.hasOwnProperty(c)||(b[c]={});for(var d in a[c])a[c].hasOwnProperty(d)&&(b[c][d]=a[c][d])}},m=function(a,c){var d=!!c;if("string"==typeof a&&$rs.arr(a).length&&(a=$rs.arr(a)),"string"==typeof a)return void rspkr.log('[rspkr.Lang.updateUi] Can\'t find element(s) "%c"'.replace("%c",a),2);if(a||(a=document),c=c?g(c):o(),!b[c])return i(c,{updateUi:!0,container:a}),!0;$rs.isArray(a)||(a=[a]);for(var e=[],f=0;f<a.length;f++)a[f].hasAttribute&&a[f].hasAttribute("data-rslang")&&e.push(a[f]),e=e.concat([].slice.call(document.querySelectorAll("[data-rslang]")));for(var h,j=0;h=e[j];j++){var k=h.getAttribute("data-rslang").split(","),l=h.getAttribute("data-rslangfilter"),m={general:{filter:"default"}};if(l)if(l=l.split(","),1===l.length)m.general.filter=l[0];else for(var n=0;n<l.length;n++){var p=l[n].split(":"),r=p[0].split("/");2!==p.length&&rspkr.log("[rspkr.Lang.updateUi] Malformed filter attribute: "+l[n],3);for(var s=0;s<r.length;s++)m[r[s]]||(m[r[s]]={}),m[r[s]].filter=p[1]}for(var t=0;t<k.length;t++){var u=k[t].split(":"),v=u[0].split("/");2!==u.length&&rspkr.log("[rspkr.Lang.updateUi] Malformed data attribute: "+k[t],3);for(var w,s=0;w=v[s];s++)m[v[s]]||(m[v[s]]={}),m[v[s]].key=u[1]}for(var x in m)if(m.hasOwnProperty(x)&&m[x].key){var y=m[x].filter||m.general.filter||"default";filteredTranslation=rspkr.Lang.filters[y].call(void 0,q(m[x].key,c),c),"alt"===x&&h.setAttribute("alt",filteredTranslation),"title"===x&&h.setAttribute("title",filteredTranslation),"arialabel"===x&&h.setAttribute("aria-label",filteredTranslation),"content"===x&&(h.innerHTML=filteredTranslation)}}rspkr.devt("onUiUpdated"),d&&rspkr.devt("onLangUpdated")},n=function(){if(rspkr.cfg.item("general.uiLang"))return rspkr.cfg.item("general.uiLang");var a,b=rs.findHref();return b&&(a=rs.getParam("uilang",b))?a:b&&(a=rs.getParam("lang",b))?a:f()},o=function(){return d||p()},p=function(a,b){return b&&b.force===!1&&d?void 0:(d=a&&b.force===!0?a:g(h(a||n())).toLowerCase(),b&&b.load!==!1&&i(d,b),d)},q=function(a,c){c||(c=o());var d=b[c]?"*"===a?b[c]:b[c][a]:void 0;if(!d){var e=f();return c===e?void 0:b[e]?q(a,e):void i(e,{updateUi:!1,key:a})}return d};return{dependency:["pub.Config"],extendPhrases:l,formatLangCode:g,getFallbackLang:f,getPhrase:q,getUiLang:o,init:e,mapUiLang:h,setUiLang:p,updateUi:m,filters:{"default":function(a,b){return a}}}}(),rspkr.HL=function(){var a={revision:"1476"},b=[],c="",d={CURRENT:1,READY:1,STOPPED:2,PLAYING:3,RELOAD:4,setState:function(a){this.CURRENT=a,rspkr.log("[rspkr.hl.html5.States.setState] Changing state from "+this.CURRENT+" to "+a,1)}},e={CURRENT:0,DEFAULT:0,SERVER_MARKUP:1,CLIENT_MARKUP:2},f=function(a){a||(a=window.document);var b=rspkr.Common.data.browser.syncContainer.replace(/(:|\.|\[|\]|,)/g,"\\$1");return $rs.arr(b+".sync_sent,"+b+".sync_word,"+b+".sync_sent_highlighted,"+b+".sync_word_highlighted,"+b+".sync_user,"+b+".synctemp,"+b+'[class*="ffsent"]',a)},g={firstRun:0,previousWord:{},previousSent:{},lastWord:null,selectionRange:null,selectionHTML:null,selectedWordsRange:[],oldSentHL:[],oldSentHLClass:[],skipHidden:function(a){return a&&rs.cfg.item("general.skipHiddenContent")===!0&&a.style?!$rs.isVisible(a):!1},skipAlways:function(a){return a&&rs.item("general.enableSkipAlways")===!0?a.className&&/rs_skip_always/i.test(a.className)?!0:a.parentElement&&a.parentElement!==document.body?rs.hl.clientMarkup.skipAlways(a.parentElement):!1:!1}},h={sync:function(a,b){for(var c=!1,d=$rs.getReadingFrames(window),e=null,f=0;f<d.length;f++)try{if(e=d[f].document.getElementById("sync"+b))break}catch(g){}var h=rspkr.Common.Settings,i=rspkr.HL,j=i.customHL&&!i.customHL.active()||i.customHL&&i.customHL.active()&&"bghlon"===h.get("enlargebghl");0==(2&a)&&(c=0!=(1&a)?!0:!1),e&&e.className.replace("word","")!==e.className?(c||rspkr.hl.css.wordOff(),i.customHL&&i.customHL.active()&&i.customHL.wordHL(e,a),i.customHL&&!i.customHL.active()&&rspkr.hl.css.wordOn(e)):e&&e.className.replace("sent","")!=e.className&&(c||rspkr.hl.css.sentOff(),i.customHL&&i.customHL.active()&&i.customHL.sentHL(e,a),j&&rspkr.hl.css.sentOn(e)),e&&i.Scroll.execScroll(e)},preProcess:{setRestoreContent:function(){rspkr.log("[Servermarkup.preProcess.setRestoreContent] Called!");var a=rspkr.Common.data.getParam("readid"),b=document.getElementById(a).innerHTML;rspkr.Common.data.setRestoreContent(b)}},postProcess:{fullCleanUp:function(){rspkr.log("[Servermarkup.postProcess.fullCleanUp] Called!"),rspkr.hl.engine.useTextNodeMarkup!==!0&&rspkr.HL.Restore.all()},lightCleanUp:function(){rspkr.log("[Servermarkup.postProcess.lightCleanUp] Called!");var a=[],b=$rs.getReadingFrames(window);b.forEach(function(b){try{a=a.concat(rspkr.hl.getSyncContainers(b.document))}catch(c){}}),rspkr.hl.css.sentOff(a),rspkr.hl.css.wordOff(a)}}},i=function(a){rspkr.log("[rspkr.HL.cleanUpHandler] String is: "+a),"userclick"===a||"nosel"===a?rspkr.HL.sync.fullCleanUp():rspkr.HL.sync.lightCleanUp()},j=function(a,b){for(var c in b)a[c]=b[c]},k={cls:".rs_preserve",testElem:null,elementShelter:[],formShelter:[],formData:function(a,b,c,d,e){this.name=a,this.type=b,this.value=c,this.checked=d,this.selectedIndex=e,this.selectedOptions=[]},findPreserveElements:function(a){function b(a,b){for(var c=b.parentNode;c;){if(c===a)return!0;c=c.parentNode}return!1}if(!a)return[];var c=[];if(a.childNodes){var d=$rs.findIn(a,rspkr.HL.Preserve.cls);d=$rs.isArray(d)?d:[d];for(var e=0;e<d.length;e++){for(var f=!0,g=0;g<d.length;g++)if(d[g]!==d[e]&&b(d[g],d[e])){f=!1;break}f&&c.push(d[e])}}return c},moveToShelter:function(a){rspkr.HL.Preserve.cls=rspkr.cfg.item("general.preserveElements")?rspkr.cfg.item("general.preserveElements"):rspkr.HL.Preserve.cls,rspkr.log("[rspkr.HL.Preserve.moveToShelter]");var b=[],c=[],d=null,e=[];e=rspkr.HL.Preserve.findPreserveElements(a);var f=$rs.findIn(a,"input, select, textarea");for(f&&!$rs.isArray(f)&&(f=[f]),k=0;k<f.length;k++){var g=new rspkr.HL.Preserve.formData(f[k].name,f[k].type,f[k].value,f[k].checked,f[k].selectedIndex);if("select-multiple"==f[k].type){for(var h=f[k].options,i=[],j=0;j<h.length;j++)i.push(h[j].selected);g.selectedOptions=i}c.push(g)}rspkr.log("[rspkr.hl.Preserve] Saved formdata from "+f.length+" elements.");for(var k=0,l=e.length;l>k;k++)d=$rs.get(e[k]).cloneNode(!1),e[k].parentNode.insertBefore(d,e[k]),b.push($rs.detach(e[k]));rspkr.log("[rspkr.hl.Preserve] Moved "+k+" nodes to the shelter."),rspkr.HL.Preserve.elementShelter.push(b),rspkr.HL.Preserve.formShelter.push(c)},restoreFromShelter:function(a){var b,c,d=[];if(rspkr.log("[rspkr.HL.Preserve.restoreFromShelter]"),rspkr.HL.Preserve.elementShelter.length&&(c=rspkr.HL.Preserve.elementShelter.shift(),c.length)){d=rspkr.HL.Preserve.findPreserveElements(a);for(var e=0,f=d.length;f>e;e++)b=c.shift(),b&&d[e].parentNode.insertBefore(b,d[e]),d[e].parentNode.removeChild(d[e])}if(rspkr.HL.Preserve.formShelter.length){var g=$rs.findIn(a,"input, select, textarea");g&&!$rs.isArray(g)&&(g=[g]);var h=rspkr.HL.Preserve.formShelter.shift();if(g.length&&h.length&&g.length===h.length)for(e=0;e<g.length;e++)if(g[e].name===h[e].name)switch(g[e].type){case"textarea":case"text":case"password":g[e].value=h[e].value;break;case"radio":h[e].checked===!0&&(g[e].checked=!0);break;case"checkbox":g[e].checked=h[e].checked;break;case"select-one":g[e].selectedIndex=h[e].selectedIndex;break;case"select-multiple":for(var i=g[e].options,j=0;j<i.length;j++)i[j].selected=h[e].selectedOptions[j]}}},clearShelter:function(){rspkr.log("[rspkr.HL.Preserve.clearShelter]"),rspkr.HL.Preserve.elementShelter=[],rspkr.HL.Preserve.formShelter=[]}},l={Storage:{readClass:[],readId:[],restoreContent:[]},all:function(){rspkr.log("[rspkr.HL.Restore.all]");var a=rspkr.HL.Restore.Storage,b=[],c=null;if(!rspkr.cfg.item("general.premarkup")){if(rspkr.c.dispatchEvent("onBeforeContentChange",window),a.restoreContent.length){if((a.readId.length||a.readClass.length)&&a.restoreContent.length){var d=$rs.flatten(a.readClass),e=$rs.flatten(a.readId);d&&(d=d.length>1||0===d.length?d:d[0].split(",")),e&&(e=e.length>1||0===e.length?e:e[0].split(","));var f=d.length?("."+d.join(",.")).split(","):[];f=e.length?f.concat(("#"+e.join(",#")).split(",")):f;var g=$rs.getReadingFrames(window),b=[];if(rspkr.cfg.item("general.readidOrder")&&rspkr.cfg.item("general.usePost"))for(var h=0,i=f.length;i>h;h++)g.forEach(function(a){try{var c=$rs.get(f[d],a.document);b.push(c)}catch(d){}});else g.forEach(function(a){try{var c=$rs.arr(f.join(","),a.document);b=b.concat(c)}catch(d){}});b=$rs.isArray(b)?b:[b],b=$rs.flatten(b);for(var c,j=0;c=b[j];j++)/sync_(word|sent)/gi.test(c.innerHTML)===!0&&(rspkr.HL.Preserve.moveToShelter(c),c.innerHTML=a.restoreContent[j],rspkr.HL.Preserve.restoreFromShelter(c))}}else rspkr.log("No stored content exists!",2);rspkr.c.dispatchEvent("onAfterContentChange",window)}a.readId.length=0,a.readClass.length=0,a.restoreContent.length=0},checkContent:function(){rspkr.log("[rspkr.hl.Restore.checkContent]",1),rspkr.hl.engine.useTextNodeMarkup!==!0&&this.hasMarkup()===!1&&rspkr.hl.State.CURRENT==rspkr.hl.State.STOPPED&&rspkr.HL.Type.CURRENT==rspkr.HL.Type.SERVER_MARKUP&&(this.clearRestoreContent(),this.setRestoreContent(),rspkr.pl.releaseAdapter(),rspkr.hl.State.setState(rspkr.hl.State.RELOAD))},hasMarkup:function(){var a=rspkr.HL.Restore.Storage,b=[],c=null,d=$rs.flatten(a.readClass),e=$rs.flatten(a.readId);d&&(d=d.length>1||0===d.length?d:d[0].split(",")),e&&(e=e.length>1||0===e.length?e:e[0].split(","));var f=d.length?("."+d.join(",.")).split(","):[];if(f=e.length?f.concat(("#"+e.join(",#")).split(",")):f,rspkr.cfg.item("general.readidOrder")&&rspkr.cfg.item("general.usePost"))for(var g=0;g<f.length;g++){var h=$rs.arr(f[g]);h.length&&(b=b.concat(h))}else b=$rs.get(f.join(",")),b=$rs.isArray(b)?b:[b],b=$rs.flatten(b);if($rs.isArray(b)||(b=[b]),b.length&&a.restoreContent.length)for(var c,g=0;c=b[g];g++)if(/sync_(word|sent)/gi.test(c.innerHTML))return!0;return!1},clearRestoreContent:function(){rspkr.log("[rspkr.HL.Restore.clearRestoreContent] Called!")},setRestoreContent:function(){if(rspkr.log("[rspkr.HL.Restore.setRestoreContent] Called!"),"Explorer"===rs.c.data.browser.name&&rs.c.data.browser.version<=9)for(var a,b=document.body.getElementsByTagName("style"),c=0;a=b[c];c++){a.parentNode.removeChild(a),document.getElementsByTagName("head")[0].appendChild(a);var d=a.innerHTML;if(-1!=d.indexOf("@import")){for(var e,f,g,h=d.split("\n"),i=0;g=h[i];i++)if("@import"===g.substring(0,7)){e=g;for(var j=g.replace(/;/g,"").replace("@import ","").replace("url(","").replace(")","").replace(/\"/g,"").replace(/\'/g,"").split(" "),k=0;k<j.length;k++){var l=j[k].replace(/ /g,"");if(l){f=l;break}}break}var m=a.sheet?a.sheet:a.styleSheet;m.insertRule?m.insertRule(g,0):m.addImport&&m.addImport(f)}}var n=rspkr.HL.Restore.Storage,o=[],p=n.restoreContent;if(0===n.readClass.length&&0===n.readId.length&&rspkr.HL.Restore.getReadData(),0==n.readClass.length&&0==n.readId.length)rspkr.log("ERR: Could not set restore content or find the read area data",3);else{var q=$rs.flatten(n.readClass),r=$rs.flatten(n.readId);q&&(q=q.length>1||0===q.length?q:q[0].split(",")),r&&(r=r.length>1||0===r.length?r:r[0].split(","));var s=q.length?("."+q.join(",.")).split(","):[];s=r.length?s.concat(("#"+r.join(",#")).split(",")):s;var t=$rs.getReadingFrames(window);if(rspkr.cfg.item("general.readidOrder")&&rspkr.cfg.item("general.usePost")){for(var u=0,v=s.length;v>u;u++)t.forEach(function(a){try{var b=$rs.arr(s[c],a.document);o=o.concat(b)}catch(c){}});o=$rs.flatten(o)}else t.forEach(function(a){try{var b=$rs.arr(s.join(","),a.document);o=o.concat(b)}catch(c){}}),o=$rs.flatten(o);$rs.isArray(o)||(o=[o]),n.restoreContent=[];for(var a,i=0;a=o[i];i++)/sync_(word|sent|user)/gi.test(a.innerHTML)===!1?n.restoreContent.push(a.innerHTML):p.length&&p[i]?n.restoreContent.push(p[i]):n.restoreContent.push(a.innerHTML)}},getReadData:function(){rspkr.log("[rspkr.HL.Restore.getReadData]");var a,b=rspkr.HL.Restore.Storage;a=rspkr.ui.getActivePlayer()?$rs.findIn(rspkr.ui.getActivePlayer().getContainer(),".rsbtn_play"):$rs.findIn($rs.get("."+rs.ui.rsbtnClass),".rsbtn_play"),$rs.isArray(a)||(a=[a]);for(var c=0,d=a.length;d>c;c++){var e=a[c].getAttribute("href").match(/readspeaker.?.com\/cgi-bin\/.*rsent/gi);if(rspkr.cfg.item("general.servercall")&&(e=e?e:a[c].getAttribute("href").indexOf(rspkr.cfg.item("general.servercall"))>-1),a[c].getAttribute("href")&&-1!==(a[c].getAttribute("href").indexOf(rspkr.cfg.item("general.domain")+"/cgi-bin/"+rspkr.cfg.item("general.rsent"))||e)&&"rsSaveBtn"!==a[c].id&&"rs_selimg"!==a[c].id){if(-1!==a[c].getAttribute("href").search(/readclass=[^&]+/gi)){var f=a[c].getAttribute("href").match(/readclass=[^&]+/gi)[0].replace("readclass=",""),g=f.split(",");rspkr.HL.Restore.Storage.readClass.push(g)}if(-1!==a[c].getAttribute("href").search(/readid=[^&]+/gi)){var f=a[c].getAttribute("href").match(/readid=[^&]+/gi)[0].replace("readid=",""),h=f.split(",");rspkr.HL.Restore.Storage.readId.push(h)}}}0===b.readClass.length&&0===b.readId.length&&(rspkr.c.data.params.hasOwnProperty("readid")?b.readId.push([rspkr.c.data.params.readid]):rspkr.c.data.params.hasOwnProperty("readclass")&&b.readClass.push([rspkr.c.data.params.readclass]))}},m={currentSpan:null,timer:null,useScroll:!1,userScrollTimer:null,stopped:!0,getScrollY:function(){var a=0;return"number"==typeof document.pageYOffset?a=document.pageYOffset:document.documentElement&&document.documentElement.scrollTop&&document.documentElement.scrollTop>0?a=document.documentElement.scrollTop:document.body&&document.body.scrollTop&&(a=document.body.scrollTop),a},getWindowHeight:function(){var a=0;return"number"==typeof window.innerHeight?a=window.innerHeight:document.documentElement&&document.documentElement.clientHeight&&document.documentElement.clientHeight>0?a=document.documentElement.clientHeight:document.body&&document.body.clientHeight&&(a=document.body.clientHeight),a+30},userScroll:function(){rspkr.HL.Scroll.timer&&(clearTimeout(rspkr.HL.Scroll.timer),rspkr.HL.Scroll.timer=null),rspkr.HL.Scroll.userScrollTimer&&clearTimeout(rspkr.HL.Scroll.userScrollTimer),rspkr.HL.Scroll.userScrollTimer=setTimeout(function(){rspkr.HL.Scroll.userScrollTimer=null},5e3),rspkr.ui.ScrollControls&&rspkr.ui.ScrollControls.check()},stopTimer:function(){rspkr.log("[rspkr.Hl.Scroll.stopTimer] Called!"),rspkr.HL.Scroll.timer&&(clearTimeout(rspkr.HL.Scroll.timer),clearInterval(rspkr.ui.scroll.INTERVAL),rspkr.HL.Scroll.timer=null),rspkr.HL.Scroll.stopped=!0},initScroll:function(){"scrollon"==rspkr.Common.Settings.get("hlscroll")?(rspkr.log("[rspkr.HL.Sroll.initScroll] Scroll initiated!"),rspkr.HL.Scroll.useScroll=!0,rspkr.evt("onUIClosePlayer",rspkr.HL.Scroll.stopTimer),rspkr.evt("onUIStop",rspkr.HL.Scroll.stopTimer),rspkr.evt("onUIPause",rspkr.HL.Scroll.stopTimer),rspkr.evt("onAfterSyncExit",rspkr.HL.Scroll.stopTimer),rspkr.evt("onUISliderMove",rspkr.HL.Scroll.userScroll),rspkr.evt("onFocusIn",rspkr.HL.Scroll.userScroll),rspkr.evt("onFocusOut",rspkr.HL.Scroll.userScroll),document.addEventListener?document.addEventListener("scroll",function(){setTimeout(function(){rspkr.HL.Scroll.userScroll()},0)},!1):document.attachEvent?document.attachEvent("onscroll",rspkr.HL.Scroll.userScroll):document.onscroll=rspkr.HL.Scroll.userScroll):this.useScroll=!1},execScroll:function(a){if(this.useScroll){var b=$rs.get("#rslightbox_contentcontainer");b&&!$rs.isArray(b)&&$rs.isVisible(b)||(this.currentSpan=a,this.stopped===!0&&(this.stopped=!1),this.timer||(rspkr.log("[rspkr.hl.Scroll] execScroll"),this.timer=setTimeout(function(){rspkr.HL.Scroll.timer=null,rspkr.HL.Scroll.triggerScroll(rspkr.HL.Scroll.currentSpan)},500)))}},triggerScroll:function(a){rspkr.log("[rspkr.HL.Scroll.triggerScroll] timer: "+rspkr.hl.Scroll.userScrollTimer+", stopped: "+rspkr.HL.Scroll.stopped),rspkr.HL.Scroll.userScrollTimer||rspkr.HL.Scroll.stopped!==!1||(rspkr.u.scroll.scrollToElm(a),rspkr.ui.ScrollControls&&rspkr.ui.ScrollControls.check())}},n=function(){rspkr.log("[rspkr.HL.addEvents]");var a=rspkr.Common.addEvent;a("onUIClosePlayer",rspkr.HL.sync.lightCleanUp),a("onUIClosePlayer",function(){rspkr.hl.State.setState(rspkr.hl.State.READY)}),a("onUIStop",function(){rspkr.hl.State.setState(rspkr.hl.State.STOPPED)}),rspkr.evt("onAPIStop",rspkr.HL.sync.lightCleanUp),rspkr.pl&&rspkr.pl.setEvents&&"function"==typeof rspkr.pl.setEvents&&rspkr.pl.setEvents.apply(this,[]),rspkr.hl.engine.useTextNodeMarkup!==!0&&(a("onUIBeforePlay",function(){rspkr.hl.Restore.checkContent()}),a("onUIClosePlayer",rspkr.HL.cleanUpHandler))},o={init:function(){if(rspkr.c.dispatchEvent("onBeforeSyncInit",window),p.hlChanged=!1,"textNode"===c||rspkr.Common.data.selectedText.length>0||rspkr.Common.data.selectedHTML.length>0)rspkr.log("[rspkr.HL._sync.init] client markup"),rspkr.HL.Type.CURRENT=rspkr.HL.Type.CLIENT_MARKUP,g.firstRun=1,"textNode"===c||("explorer"==c?document.selection.empty():g.preProcess.identifyElementsReplacementNode(rspkr.Common.data.selectedDocument)),rspkr.HL.markedUpHTML.length=0;else if(rspkr.log("[rspkr.HL._sync.init] server markup"),rspkr.HL.Type.CURRENT=rspkr.HL.Type.SERVER_MARKUP,"none"!=rspkr.Common.data.sync){var a=(rspkr.HL.Restore.Storage,[]),b=[],d=[];rspkr.c.data.params.hasOwnProperty("readid")&&rspkr.c.data.params.readid.length&&(d=d.concat(("#"+rspkr.c.data.params.readid.split(",").join(",#")).split(","))),rspkr.c.data.params.hasOwnProperty("readclass")&&rspkr.c.data.params.readclass.length&&(d=d.concat(("."+rspkr.c.data.params.readclass.split(",").join(",.")).split(",")));var e=$rs.getReadingFrames(window);if(rspkr.cfg.item("general.readidOrder")&&rspkr.cfg.item("general.usePost"))for(var f=0;f<d.length;f++)for(var h=0;h<e.length;h++)try{var i=$rs.get(d[f],e[h].document);i.length&&(a=a.concat(i))}catch(j){}else for(var k=0;k<e.length;k++)try{var l=$rs.get(d.join(","),e[k].document);l=$rs.isArray(l)?l:[l],l=$rs.flatten(l),a=a.concat(l)}catch(j){}$rs.isArray(a)||(a=[a]);var m;if(/webAudio/i.test(rspkr.PlayerAPI.adapter)&&rspkr.HL.markedUpHTML.length!==a.length){var n="<!--RSPEAK_STOP-->";m=rspkr.HL.markedUpHTML.join("").split(n);for(var o,q=0;o=m[q];q++)o+=n}else m=rspkr.HL.markedUpHTML;for(var r,f=0;r=a[f];f++){var s;s=r.nodeName&&"TABLE"==r.nodeName?document.createElement("TABLE"):document.createElement("DIV"),s.innerHTML=m[f],b.push(s)}if(rspkr.log("[rspkr.HL.sync.init] readElements length: "+a.length),!rspkr.cfg.item("general.premarkup")){rspkr.c.dispatchEvent("onBeforeContentChange",window);for(var f=0;f<a.length;f++)rspkr.HL.Preserve.moveToShelter(a[f]),a[f].innerHTML=b[f].innerHTML,rspkr.HL.Preserve.restoreFromShelter(a[f]);rspkr.c.dispatchEvent("onAfterContentChange",window),rspkr.HL.Preserve.clearShelter()}rspkr.HL.markedUpHTML.length=0}else rspkr.HL.markedUpHTML.length=0;rspkr.c.post.removeIframe(),rspkr.c.dispatchEvent("onAfterSyncInit",window)},lightCleanUp:function(){rspkr.log("[rspkr.HL._sync.lightCleanUp] Called! "+rspkr.HL.Type.CURRENT),rspkr.HL.customHL&&rspkr.HL.customHL.active()&&rspkr.HL.customHL.cleanUp(),rspkr.HL.Type.CURRENT==rspkr.HL.Type.CLIENT_MARKUP&&p.hlChanged===!0?g.postProcess.settingsCleanUp():rspkr.HL.Type.CURRENT==rspkr.HL.Type.CLIENT_MARKUP&&p.hlChanged===!1||rspkr.Common.data.selectedText.length?(rspkr.HL.Type.CURRENT===rspkr.HL.Type.SERVER_MARKUP&&h.postProcess.lightCleanUp(),g.postProcess.lightCleanUp()):rspkr.HL.Type.CURRENT==rspkr.HL.Type.SERVER_MARKUP&&h.postProcess.lightCleanUp()},fullCleanUp:function(){rspkr.log("[rspkr.HL._sync.fullCleanUp] Called!"),rspkr.HL.customHL&&rspkr.HL.customHL.active()&&rspkr.HL.customHL.cleanUp(),rspkr.HL.Type.CURRENT==rspkr.HL.Type.CLIENT_MARKUP&&g.postProcess.fullCleanUp(),h.postProcess.fullCleanUp()},setId:function(a){rspkr.log("[rspkr.HL._sync.setId] Called!")},setClass:function(a){rspkr.log("[rspkr.HL._sync.setClass] Called!")},setContent:function(a){rspkr.log("[rspkr.HL._sync.setContent] Called!"),rspkr.HL.markedUpHTML.push(a)},execute:function(a,b){var c=rspkr.Common.Settings;if("none"!==c.get("hl")&&"hloff"!==c.get("hltoggle")){if(rspkr.HL.Type.CURRENT==rspkr.HL.Type.SERVER_MARKUP){for(var d=$rs.getReadingFrames(window,[window]),e=null,f=0;f<d.length;f++)try{var g=$rs.findIn(d[f].document,"#sync"+b);if(g){e=g;break}}catch(h){}if(e){var i=$rs.hasClass(e,"sync_sent")?"sent":"word";if("sent"===c.get("hl")&&"word"===i)return;if("word"===c.get("hl")&&"sent"===i)return}}rspkr.c.dispatchEvent("onBeforeSync",window,[a,b]),rspkr.HL.Type.CURRENT==rspkr.HL.Type.CLIENT_MARKUP?rspkr.HL.clientMarkup.sync(a,b):rspkr.HL.serverMarkup.sync(a,b),rspkr.c.dispatchEvent("onAfterSync",window,[a,b])}}},p={enums:{sent:"sync_sent",sent_hl:"sync_sent_highlighted",word:"sync_word",word_hl:"sync_word_highlighted",textSelectionStyle:"border-bottom: dotted 1px #aaa;"
},word_index:null,sent_index:null,hlChanged:!1,setHL:function(){var a=rspkr.pub.Config,b=rspkr.Common.Settings.get("hlword")||a.item("settings.hlword"),c=rspkr.Common.Settings.get("hlsent")||a.item("settings.hlsent"),d=rspkr.Common.Settings.get("hltext")||a.item("settings.hltext");if(this.updateHL("hlword",b,null),this.updateHL("hlsent",c,null),this.updateHL("hltext",d,null),!rspkr.mobile())for(var e=$rs.getReadingFrames(window),f=0;f<e.length;f++)try{rspkr.hl.css.setRule("sent",".rs_textselection .sync_sent",a.item("settings.textselection")||p.enums.textSelectionStyle)}catch(g){}},updateHL:function(a,b,d){if(d=d||null,"hlspeed"===a&&b!==d&&(p.hlChanged=!0),b===d||"hl"!==a&&"hltoggle"!==a||(p.hlChanged=!0,rspkr.HL.sync.lightCleanUp()),b!==d&&("hl"===a&&"none"!==b||"hltoggle"===a&&"hlon"===b)){var e=$rs.getReadingFrames(window);e.forEach(function(a){try{p.setTextStyle("word",rspkr.Common.Settings.get("hlword")),p.setTextStyle("sent",rspkr.Common.Settings.get("hlsent")),p.setTextStyle("hltext",rspkr.Common.Settings.get("hltext"))}catch(b){}}),p.hlChanged=!0,rspkr.HL.Type.CURRENT===rspkr.HL.Type.CLIENT_MARKUP&&rspkr.PlayerAPI.releaseAdapter()}if(/hltext|hlword|hlsent|hlscroll/i.test(a)&&b!=d)if("hlscroll"==a)rspkr.HL.Scroll.initScroll();else{for(var f=$rs.getReadingFrames(window),h=0;h<f.length;h++)try{var i=f[h].document;window.rspkr.HL.settings.setTextStyle(a,b),i.addEventListener("readystatechange",function(c){try{("complete"==c.target.readyState||"loaded"==c.target.readyState)&&window.rspkr.HL.settings.setTextStyle(a,b)}catch(d){}})}catch(j){}"explorer"==c&&(g.selectionRange&&"wordsent"===rspkr.st.get("hl")&&"hlsent"==a&&(g.selectionRange.execCommand("backcolor",0,rspkr.Common.Settings.get("hlsent")),g.selectionRange.execCommand("forecolor",0,rspkr.Common.Settings.get("hltext"))),g.lastWord&&("sent"==rspkr.st.get("hl")?g.lastWord.execCommand("backcolor",0,rspkr.Common.Settings.get("hlsent")):g.lastWord.execCommand("backcolor",0,rspkr.Common.Settings.get("hlword")),g.lastWord.execCommand("forecolor",0,rspkr.Common.Settings.get("settings.hltext"))))}},setTextStyle:function(a,b){var c=/word/.test(a)?"word":"sent",d="background-color";if(/underline/.test(b))d="text-decoration",b+=" ; background-color: none";else if(/none/.test(b))d="background",b+=" ; text-decoration: none; background-color: none";else if("hltext"===a){var e=b,f=p.getStyleString(rspkr.Common.Settings.get("hlsent"),e),g=p.getStyleString(rspkr.Common.Settings.get("hlword"),e);b=f,rspkr.HL.css.setRule("word","."+p.enums.word_hl,d+": "+g)}else b+="; text-decoration: none; color: "+rspkr.Common.Settings.get("hltext");rspkr.HL.css.setRule(c,"."+p.enums[c+"_hl"],d+": "+b)},getStyleString:function(a,b){var c=/underline|none/i.test(a)?"none":a,d=/underline/i.test(a)?"underline":"none";return c+"; text-decoration: "+d+"; color: "+b}};return{meta:a,init:function(){var a=rspkr.Common.addEvent;a("onAfterModsLoaded",function(){a("onAPIInitAdapter",rspkr.HL.Restore.setRestoreContent),rspkr.HL.addEvents(),rspkr.HL.Scroll.initScroll(),/forceTextNodeHL/i.test(document.location.href)?(rspkr.cfg.item("general.usePost",!0),c="textNode","Explorer"===rspkr.c.data.browser.name&&console.warn("Warning. Forcing textNode HL engine with Internet Explorer. Proceed at your own risk."),"webAudio"!==rspkr.pl.adapter&&console.warn("Warning. Forcing textNode HL engine with HTML5 Audio adapter. Proceed at your own risk."),rspkr.item("general.iframeReading")===!0&&console.warn("Warning. Forcing textNode HL engine with Iframe reading turned on. Proceed at your own risk.")):c="Explorer"===rspkr.c.data.browser.name||/disableTextNodeHL/i.test(document.location.href)||rspkr.item("general.usePost")!==!0||"webAudio"!==rspkr.pl.adapter||rspkr.item("general.disableTextNodeHL")===!0||rspkr.item("general.iframeReading")===!0?document.selection&&(rspkr.Common.data.browser.version<9||document.documentMode<9)?"explorer":"gecko":"textNode",rspkr.log("[rspkr.hl] Using engine "+c),j(g,rspkr.HL.engine[c].clientExtension),rspkr.HL.engine[c].clientExtension.init(),rspkr.HL.html5&&window.addEventListener&&window.addEventListener("message",rspkr.HL.html5.receiveMessage,!1,!0)}),p.setHL(),a("onSettingsChanged",{func:p.updateHL,context:p}),rspkr.HL.chunking={html5support:function(){var a=document.createElement("audio");return!!a.canPlayType}(),close:function(){var a=$rs.get(".rsresume");$rs.isArray(a)||(a=[a]);for(var b,c=0;b=a[c];c++)b.parentElement.removeChild(b)},silence:function(){rspkr.HL.chunking.entracte&&rspkr.HL.chunking.entracte.src&&(rspkr.HL.chunking.entracte.pause(),rspkr.HL.chunking.entracte.currentTime&&(rspkr.HL.chunking.entracte.currentTime=0))},kill:function(){rspkr.HL.chunking.timer&&clearTimeout(rspkr.HL.chunking.timer),rspkr.HL.chunking.continueHref=null,rspkr.HL.chunking.stall=null,rspkr.HL.chunking.chunkEnded=null,rspkr.HL.chunking.currentChunkNumber=1,rspkr.HL.chunking.entracte&&"function"==typeof rspkr.HL.chunking.entracte.removeAttribute&&rspkr.HL.chunking.entracte.removeAttribute("src")},destroy:function(){rspkr.HL.chunking.silence(),rspkr.HL.chunking.close(),rspkr.HL.chunking.kill()}},rspkr.HL.chunking.currentChunkNumber=1,a("onChunkResume",function(){if(rspkr.HL.chunking.continueHref){rspkr.HL.chunking.silence();var a=rspkr.ui.getActivePlayer().getContainer();if($rs.hasClass(a,"rsautopaused")||!$rs.hasClass(a,"rspaused")){if(rspkr.HL.chunking.stall)return void setTimeout(function(){rspkr.c.dispatchEvent("onChunkResume",window)},250);$rs.removeClass(a,"rsautopaused"),clearTimeout(rspkr.HL.chunking.timer);var b=rspkr.HL.chunking.continueHref.replace("%{AUDIOFORMAT}",rspkr.Common.data.browser.html5AudioFormat),c=rspkr.HL.chunking.continueHref.replace("%{AUDIOFORMAT}","html5iframe");rspkr.HL.chunking.continueHref=void 0,rspkr.HL.html5.audioUrl=b.replace(/&amp;/g,"&"),rspkr.HL.html5.frameUrl=c.replace(/&amp;/g,"&"),rspkr.HL.html5.initSyncFrame(),rspkr.HL.html5.initAudio(),rspkr.ui.getActivePlayer().play(),rspkr.HL.chunking.currentChunkNumber++}}}),rspkr.log("[rspkr.HL] Initialized!")},addEvents:function(){n()},cleanUpHandler:function(a){i(a)},getSyncContainers:f,clientMarkup:g,serverMarkup:h,markedUpHTML:b,Preserve:k,Restore:l,Scroll:m,State:d,sync:o,settings:p,Type:e}}(),rspkr.HL.engine||(rspkr.HL.engine={}),rspkr.HL.engine.explorer=function(){var a={name:"explorer",firstRun:0,previousWord:{},previousSent:{},selectionRange:null,selectionHTML:null,selectedWordsRange:[],wordsRangeClasses:[],originalParentContent:"",originalParent:null,init:function(){rspkr.HL.engine.useTextNodeMarkup=!1},preProcess:{bookMarkIndex:1,endNode:null,endOffset:null,excludednodes:["table","tr","select","option","textarea","ul","ol","dl","thead","tbody","tfoot","colgroup","script","map","optgroup","style","noscript"],firstRun:0,inc:0,numberOfSelections:0,startNode:null,startOffset:null,init:function(){this.numberOfSelections++;var a=this.buildMarkup(rspkr.Common.data.selectedRange);a.replace(/  +/g," "),rspkr.Common.data.selectedHTML=a,rspkr.hl.clientMarkup.originalParent=rspkr.c.data.selectedRange.parentElement(),rspkr.hl.clientMarkup.originalParentContent=rspkr.c.data.selectedRange.parentElement().innerHTML},buildMarkup:function(a){for(var b=rspkr.c.data.getParam("lang"),c=!1,d=null,e=rspkr.cfg.item("general.sentOnlyLang"),f=0;f<e.length;f++)if(b&&b.toLowerCase()===e[f]){c=!0;break}var g=a.duplicate(),f=0,h="",i=1,j=0,k=0,l="",m="",n=null;a.moveStart("word",-1),a.moveStart("word",1),g.isEqual(a)||a.moveStart("word",-1),g=a.duplicate(),a.moveEnd("word",1),a.moveEnd("word",-1),g.isEqual(a)||a.moveEnd("word",1),rspkr.HL.clientMarkup.selectionRange=a.duplicate();var o=a.parentElement(),p=a.duplicate();for(p.collapse(!1),g=a.duplicate(),g.collapse(),c&&(d=a.text.split(new RegExp(decodeURIComponent("%e3%80%81")+"|"+decodeURIComponent("%e3%80%82")+"|"+decodeURIComponent("%DB%94")+"|"+decodeURIComponent("%D8%8C"))));a.inRange(g)&&0!=a.compareEndPoints("EndToEnd",g)&&(k++,f++,!(f>1e4));){if(c){if(g=a.duplicate(),!d[k-1])break;g.findText(d[k-1])}else g.collapse(!1),g.expand("word",1);l="",m="",p.collapse(!1);var q=g.duplicate();if(q.collapse(!1),0==p.compareEndPoints("StartToStart",q)&&0==p.compareEndPoints("EndToEnd",q)&&q.htmlText==p.htmlText&&/\W/.test(q.text)){if(j++,2>j)g.move("character",1);else if(4>j)g.move("character",2);else if(6>j)g.move("word",1);else if(8>j)g.move("word",2);else if(10>j)g.move("sentence",1);else{if(!(12>j))break;g.move("sentence",2)}g.collapse(!1)}else{if(j=0,-1===k)return g;rspkr.HL.clientMarkup.selectedWordsRange[k]=g.duplicate();var r=g.text,s=g.htmlText;g.collapse(!1);var t;1===i?(n=g.duplicate(),t=this.iterateParentTree(n.parentElement(),document.body,o,0)):t=this.iterateParentTree(g.parentElement(),n.parentElement(),o,0);for(var u=this.iterateParentTree(n.parentElement(),g.parentElement(),o,0),v=g.parentElement(),w=0;t>w&&20>w;w++)v.className.match("sync_")||(l=v.outerHTML.match("<[^>]*>")[0]+l),v=v.parentElement;for(var v=n.parentElement(),w=0;u>w&&20>w;w++)v.className.match("sync_")||(m+="</"+v.tagName+">"),v=v.parentElement;(0!=t||0!=u)&&(n=g.duplicate()),1===i?(h+=l,i=0):h+=m+l,""!=s.replace("sync_sent_highlighted","")&&(h+="<"+rspkr.Common.data.browser.syncContainer+' class="sync_user" id="sync'+k+'">'+r+"</"+rspkr.Common.data.browser.syncContainer+">"),p=g.duplicate()}}h+="<!-- f -->";for(var u=this.iterateParentTree(n.parentElement(),document.body,o,0),v=n.parentElement(),w=0;u>w;w++)v.className.match("sync_")||(h+="</"+v.tagName+">"),v=v.parentElement;return g.collapse(),h},iterateParentTree:function(a,b,c,d){for(var e=b;e;){if(a==c||a==e)return d;e=e.parentElement}return d++,this.iterateParentTree(a.parentElement,b,c,d)}},postProcess:{lightCleanUp:function(){rspkr.log("[clientMarkup.postProcess.lightCleanUp] called!");var a=rspkr.hl.getSyncContainers();if(rspkr.hl.css.sentOff(a),rspkr.hl.css.wordOff(a),!rspkr.HL.chunking.continueHref&&!rspkr.mobile())for(h=a.length-1;h>-1;h--)a[h].removeAttribute("id"),a[h].removeAttribute("color");var b=rspkr.HL.clientMarkup.previousWord.range,c=rspkr.HL.clientMarkup.previousWord.forecolor,d=rspkr.HL.clientMarkup.previousWord.backcolor,e=rspkr.HL.clientMarkup.previousSent.range,f=rspkr.HL.clientMarkup.previousSent.forecolor,g=rspkr.HL.clientMarkup.previousSent.backcolor;if(b&&b.length)for(var h=0,i=b.length;i>h;h++)d[h]&&(b[h].execCommand("backcolor",0,d[h]),c[h]&&b[h]&&b[h].execCommand("forecolor",0,c[h]));if(e&&e.length)for(var h=0,i=e.length;i>h;h++)g[h]&&(e[h].execCommand("backcolor",0,g[h]),f[h]&&e[h]&&e[h].execCommand("forecolor",0,f[h]));rspkr.hl.clientMarkup.lastWord=null},settingsCleanUp:function(){this.lightCleanUp()},fullCleanUp:function(){if(rspkr.log("[ClientMarkup.postProcess.fullCleanUp] called!"),rspkr.hl.clientMarkup.originalParent){var a=rspkr.hl.clientMarkup.originalParent;rspkr.hl.Preserve.moveToShelter(a),a.innerHTML=rspkr.hl.clientMarkup.originalParentContent,rspkr.hl.Preserve.restoreFromShelter(a)}else this.lightCleanUp();rspkr.hl.clientMarkup.selectedWordsRange=[],rspkr.hl.clientMarkup.selectionRange=null,rspkr.hl.clientMarkup.originalParentContent="",rspkr.hl.clientMarkup.originalParent=null,rspkr.hl.clientMarkup.lastWord=null}},sync:function(a,b){var c,d=!1,e=rspkr.Common.Settings,f=rspkr.HL;if(0===(2&a)&&(d=0!=(1&a)?!0:!1),1===this.firstRun&&(this.previousWord.range=[],this.previousWord.backcolor=[],this.previousWord.forecolor=[],this.previousSent.range=[],this.previousSent.backcolor=[],this.previousSent.forecolor=[]),c=this.selectedWordsRange[b],1===this.firstRun){if(this.firstRun=0,this.previousSent.range.length){for(var g=0,h=this.previousSent.range.length;h>g;g++)this.previousSent.range[g].execCommand("backcolor",0,this.previousSent.backcolor[g]),this.previousSent.forecolor[g]&&this.previousSent.range[g].execCommand("forecolor",0,this.previousSent.forecolor[g]);this.previousSent.range=[],this.previousSent.backcolor=[],this.previousSent.forecolor=[]}if(f.clientMarkup.selectionRange&&"wordsent"===st.get("hl")&&(this.previousSent.range.push(f.clientMarkup.selectionRange),this.previousSent.backcolor.push(f.clientMarkup.selectionRange.queryCommandValue("backcolor")),this.previousSent.forecolor.push(f.clientMarkup.selectionRange.queryCommandValue("forecolor")),this.selectionRange.execCommand("backcolor",0,e.get("hlsent")),this.selectionRange.execCommand("forecolor",0,e.get("hltext"))),!d&&this.previousWord.range.length){for(var g=0;g<this.previousWord.range.length;g++)"word"==e.get("hl")||"sent"==e.get("hl")?this.previousWord.range[g].execCommand("backcolor",0,this.previousWord.backcolor[g]):this.previousWord.range[g].execCommand("backcolor",0,e.get("hlsent")),this.previousWord.range[g].execCommand("forecolor",0,this.previousWord.forecolor[g]);this.previousWord.range=[],this.previousWord.backcolor=[],this.previousWord.forecolor=[]}this.previousWord.backcolor.push(c.queryCommandValue("backcolor")),this.previousWord.forecolor.push(c.queryCommandValue("forecolor")),this.previousWord.range.push(c)}"sent"==rspkr.st.get("hl")?(f.customHL&&f.customHL.active()&&f.customHL.sentHL(c,a),c.execCommand("backcolor",0,e.get("hlsent"))):(f.customHL&&f.customHL.active()&&f.customHL.wordHL(c,a),c.execCommand("backcolor",0,e.get("hlword"))),this.lastWord=c,f.customHL&&f.customHL.active(),c.execCommand("forecolor",0,e.get("hltext"))}};return{clientExtension:a}}(),rspkr.HL.engine.gecko=function(){var a={name:"gecko",init:function(){rspkr.HL.engine.useTextNodeMarkup=!1},preProcess:{bookMarkIndex:1,endNode:null,endOffset:null,excludednodes:["table","tr","select","option","textarea","ul","ol","dl","thead","tbody","tfoot","colgroup","script","map","optgroup","style","noscript"],firstRun:0,inc:0,numberOfSelections:0,startNode:null,startOffset:null,sentenceDividers:[", ",". ","! ","? ",decodeURIComponent("%e3%80%81"),decodeURIComponent("%e3%80%82"),decodeURIComponent("%DB%94"),decodeURIComponent("%D8%8C")],init:function(){this.numberOfSelections++;var a="",b=rspkr.Common.data.selectedRange;rspkr.Common.data.processedDocument=rspkr.Common.data.selectedDocument,this.startNode=b.startContainer,this.endNode=b.endContainer,this.startOffset=this.modifyOffsetStartOfWord(this.startNode,b.startOffset),this.endOffset=this.modifyOffsetEndOfWord(this.endNode,b.endOffset);var c=rspkr.Common.data.processedDocument||document;a=this.buildMarkup(b.commonAncestorContainer,c),a.replace(/  +/g," "),c.getSelection().removeAllRanges(),rspkr.Common.data.selectedHTML=a},addMarkup:function(a,b){this.numberOfSelections++,this.startNode=a,this.endtNode=a,this.startOffset=0,this.endOffset=0,b===!0&&this.sentenceDividers.splice(this.sentenceDividers.indexOf(", "),1);var c=this.buildMarkup(a);c.replace(/  +/g," "),rspkr.Common.data.processedDocument&&rspkr.Common.data.processedDocument.getSelection().removeAllRanges(),rspkr.Common.data.selectedHTML=c},addMarkupNoSelection:function(a){this.startNode=a,this.endtNode=a,this.startOffset=0,this.endOffset=0,this.bookMarkIndex=this.getHighestBookmarkIndex()+1;var b=this.buildMarkup(a,document);b.replace(/  +/g," ")},getHighestBookmarkIndex:function(){var a=$rs.arr("[id^=sync]");return a.length+100},buildMarkup:function(a,b){b=b||document,this.firstRun=1;var c="",d=this.inc,e=!1;if(rspkr.cfg.item("general.searchLang")!==!1&&(a.nodeType===a.ELEMENT_NODE?e=rspkr.c.data.searchLangAttr(a):a.nodeType===a.TEXT_NODE&&(e=rspkr.c.data.searchLangAttr(a.parentNode))),3==a.nodeType)c+=this.textMarkup(a);else{var f,g="";if((a instanceof SVGElement||!$rs.hasClass(a,rspkr.u.rsbtnClass))&&a.hasChildNodes())for(f=0;f<a.childNodes.length;f++){var h=a.childNodes.item(f);if(h==this.startNode&&(this.inc=1),a==this.startNode&&f==this.startOffset&&(this.inc=1),8!=h.nodeType&&(g+=this.buildMarkup(h,b)),a==this.endNode&&f==this.endOffset){this.inc=0;break}if(h==this.endNode){this.inc=0;break}}var i=!0;if(null!=$rs.getAttr(a,"id")&&(i=$rs.getAttr(a,"id").replace("sync","")===$rs.getAttr(a,"id")),(d||this.inc)&&(a instanceof SVGElement||!a.className||a.className.replace("sync","")===a.className&&i)){for(var j=b.createElement("div"),k=a.cloneNode(!0),l=k.attributes,m=0;m<l.length;m++)"data-"===l[m].name.substr(0,5)&&k.removeAttribute(l[m].name);rs.hl.clientMarkup.skipHidden(a)===!0&&$rs.addClass(k,"rs_skip_always"),j.appendChild(k);var n=j.innerHTML.match("<[^>]*>");n&&n.length?(c+=n[0],c+=g,c+="</"+a.nodeName+">"):c+=g}else c+=g;if(a.hasChildNodes())for(f=0;f<a.childNodes.length;f++){if(a===this.endNode&&f===this.endOffset){this.inc=0;break}if(h===this.endNode){this.inc=0;break}}}return""!==e&&e!==!1&&""!==c&&(c="<"+rspkr.Common.data.browser.syncContainer+' lang="'+e+'">'+c+"</"+rspkr.Common.data.browser.syncContainer+">"),c},textMarkup:function(a){var b,c=!0,d="",e="",f="",g=a.nodeValue;if(!g.replace(/[\r\n\t ]+/gm,"").length)return g;if(a===this.startNode&&-1!==this.startOffset&&a===this.endNode&&-1!==this.endOffset?(e=a.nodeValue.substring(0,this.startOffset),g=a.nodeValue.substring(this.startOffset,this.endOffset),f=a.nodeValue.substring(this.endOffset),this.inc=1):a===this.startNode&&-1!==this.startOffset?(e=a.nodeValue.substring(0,this.startOffset),g=a.nodeValue.substring(this.startOffset),this.inc=1):a===this.endNode&&-1!==this.endOffset&&(g=a.nodeValue.substring(0,this.endOffset),f=a.nodeValue.substring(this.endOffset),this.inc=1),!this.inc)return"";for(var b=0;b<this.excludednodes.length;b++)if(a.parentNode&&a.parentNode.nodeName.toLowerCase()===this.excludednodes[b]){c=!1,d=this.htmlencode(g);break}if(c&&(d=this.markupSentences(this.htmlencode(g),null)),a===this.endNode&&-1!==this.endOffset&&(this.inc=0),rs.hl.clientMarkup.skipAlways(a)&&(d='<span class="rs_skip_always">'+d+"</span>"),c&&a.parentNode&&""!==g){var h=this.createReplacementNode(e+d+f,getComputedStyle(a.parentNode,null));a.parentNode.insertBefore(h,a),a.parentNode.removeChild(a)}return d},markupSentences:function(a){var b=this.splitString(a,this.sentenceDividers);if(!b||!a.replace(/[\r\n\t ]+/gm,"").length)return"";for(var c="",d="",e=!1,f=0;f<b.length;f++){for(;$rs.arr("#sync"+this.bookMarkIndex).length;)this.bookMarkIndex++;c+="<"+rspkr.Common.data.browser.syncContainer+' class="sync_user sync_sent ffsent'+this.numberOfSelections+" cj"+this.numberOfSelections+'" ',c+='id="sync'+this.bookMarkIndex+'">',this.bookMarkIndex++,this.endsWithSpace(b[f])?(e=!0,d=b[f].slice(0,-1)):d=b[f],c+=this.markupWords(d),e===!0&&(c+=" "),c+="</"+rspkr.Common.data.browser.syncContainer+">",e=!1}return c},markupWords:function(a){var b=this.splitString(a," ");if(!b)return"";for(var c="",d="",e=!1,f=0;f<b.length;f++){for(;$rs.arr("#sync"+this.bookMarkIndex).length;)this.bookMarkIndex++;c+="<"+rspkr.Common.data.browser.syncContainer+' class="sync_user sync_word ck'+this.numberOfSelections+'"',c+=' id="sync'+this.bookMarkIndex+'">',this.bookMarkIndex++,this.endsWithSpace(b[f])?(e=!0,d=b[f].slice(0,-1)):d=b[f],c+=d,c+="</"+rspkr.Common.data.browser.syncContainer+">",e===!0&&(c+=" "),e=!1}return c},trim:function(a){return a.replace(/^\s+|\s+$/g,"")},htmlencode:function(a){var b=rspkr.Common.data.processedDocument?rspkr.Common.data.processedDocument:document,c=b.createElement("div"),d=document.createTextNode(a);return c.appendChild(d),c.innerHTML},identifyElementsReplacementNode:function(a){if(a.tagName&&a.tagName.toLowerCase()==rspkr.Common.data.browser.syncContainer&&a.id&&(rspkr.HL.clientMarkup.selectedWordsRange[a.id]=a),a.hasChildNodes())for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];this.identifyElementsReplacementNode(c)}},createReplacementNode:function(a,b){var c=rspkr.Common.data.processedDocument||document,d=c.createElement(rspkr.Common.data.browser.syncContainer);return d.innerHTML=a,d.setAttribute("class","synctemp rs_textselection cl"+this.numberOfSelections),d},modifyOffsetStartOfWord:function(a,b){for(var c=new Array(" ",", ",". ","! ","? ",decodeURIComponent("%e3%80%81"),decodeURIComponent("%e3%80%82"),decodeURIComponent("%DB%94"),decodeURIComponent("%D8%8C"));a.nodeValue&&0!=b;){for(var d=0;d<c.length;d++)if(breakstr=c[d],0==a.nodeValue.substring(b).indexOf(breakstr))return b;b--}return b},modifyOffsetEndOfWord:function(a,b){for(var c=new Array(" ",", ",". ","! ","? ",decodeURIComponent("%e3%80%81"),decodeURIComponent("%e3%80%82"),decodeURIComponent("%DB%94"),decodeURIComponent("%D8%8C"));a.nodeValue&&b!=a.nodeValue.length;){for(var d=0;d<c.length;d++)if(breakstr=c[d],0==a.nodeValue.substring(b-1).indexOf(breakstr))return b;b++}return b},splitString:function(a,b){for(var c=new Array(""),d=0,e=0;e<a.length;e++){for(var f=0;f<b.length;f++){for(var g=b[f],h=!0,i=0;i<g.length;i++)if(a.length-(e+i)<0||g[g.length-i-1]!=a[e-i-1]){h=!1;break}h&&(d++,c[d]="")}c[d]+=a[e]}return c},endsWithSpace:function(a){var b=" ";return-1!==a.indexOf(b,a.length-b.length)}},postProcess:{cleanUpSpans:function(){rspkr.log("[ClientMarkup.postProcess.cleanUpSpans] called!");for(var a,b=rspkr.Common.data.processedDocument||document,c=rspkr.hl.getSyncContainers(b),d=c.length-1;d>-1;d--)a=b.createDocumentFragment(),a.textContent=c[d].textContent,c[d].parentNode.replaceChild(a,c[d])},lightCleanUp:function(){rspkr.log("[ClientMarkup.postProcess.lightCleanUp] called!!");var a=rspkr.Common.data.processedDocument||document,b=rspkr.hl.getSyncContainers(a);rspkr.hl.css.sentOff(b),rspkr.hl.css.wordOff(b)},settingsCleanUp:function(){rspkr.log("[ClientMarkup.postProcess.settingsCleanUp] called!");var a=rspkr.HL.clientMarkup.previousWord.element,b=rspkr.HL.clientMarkup.previousSent.element;a.length&&(rspkr.HL.clientMarkup.previousWord.element=[]),b.length&&(rspkr.HL.clientMarkup.previousSent.element=[])},fullCleanUp:function(){rspkr.log("[ClientMarkup.postProcess.fullCleanUp] called!");var a=rspkr.HL.clientMarkup.previousWord.element,b=rspkr.HL.clientMarkup.previousSent.element;a&&a.length&&(rspkr.HL.clientMarkup.previousWord.element=[]),b&&b.length&&(rspkr.HL.clientMarkup.previousSent.element=[]),this.cleanUpSpans(),rspkr.Common.data.selectedHTML="",rspkr.Common.data.processedDocument=null}},sync:function(a,b){var c,d=!1,e=rspkr.Common.Settings,f=!rspkr.HL.customHL.active()||rspkr.HL.customHL.active()&&"bghlon"===e.get("enlargebghl"),g=rspkr.HL;if(0===(2&a)&&(d=0!==(1&a)?!0:!1),this.previousSent||(this.previousSent={},this.firstRun=1),1===this.firstRun&&(this.previousSent.element=[]),rspkr.hl.engine.useTextNodeMarkup?rspkr.HL.engine.textNode.clientExtension.highlight(b,d):(c=this.selectedWordsRange["sync"+b],c&&c.className&&c.className.replace("word","")!==c.className?(d||rspkr.hl.css.wordOff(),"sent"===e.get("hl")?f&&rspkr.hl.css.sentOn(c):(g.customHL&&rspkr.HL.customHL.active()&&g.customHL.wordHL(c,a),f&&rspkr.hl.css.wordOn(c))):c&&c.className.replace("sent","")!==c.className&&/sent/gi.test(rspkr.st.get("hl"))&&(d||rspkr.hl.css.sentOff(),g.customHL&&g.customHL.active()&&g.customHL.sentHL(c,a),f&&rspkr.hl.css.sentOn(c))),c&&g.Scroll.execScroll(c),rspkr.hl.engine.useTextNodeMarkup!==!0&&1===this.firstRun){var h=rspkr.ui.getActivePlayer()&&rspkr.ui.getActivePlayer().pb&&rspkr.ui.getActivePlayer().pb.lazyLoad.isLazyLoad||"1"===rspkr.st.get("tapread"),i=c&&/sync_word[_highlighted]*/i.test(c.className);if(!(h&&i||(this.firstRun=0,this.previousSent.element.length>0&&(this.previousSent.element=[]),"wordsent"!=e.get("hl"))))for(var j=h&&$rs.hasClass(c,"sync_sent")?[$rs.get("#sync"+b)]:$rs.arr("ffsent"+this.preProcess.numberOfSelections+" "),k=0;k<j.length;k++)this.previousSent.element[k]=j[k];if(!rspkr.mobile()){var l=rspkr.st.get("hlsent")||cfg.item("settings.hlsent");rspkr.hl.css.setRule("sent",".rs_textselection .sync_sent_highlighted",(rspkr.cfg.item("settings.textselection")||rspkr.HL.settings.enums.textSelectionStyle)+l)}}}};return{clientExtension:a}}(),rspkr.HL.css=function(){var a={word:{},sent:{}},b=function(b,c,d){if("string"==typeof d){var e=d.split(";");d={};for(var f=0;f<e.length;f++)if(e[f].length&&/:/.test(e[f])){var g=e[f].split(":");d[g[0].trim()]=g[1].trim()}}a[b][c]=d},c=function(b,c){delete a[b][c]},d=function(b,c){$rs.addClass(b,c||"sync_word_highlighted"),Object.keys(a.word).forEach(function(b){$rs.css($rs.arr(b),a.word[b])})},e=function(b,c){Object.keys(a.word).forEach(function(b){Object.keys(a.word[b]).forEach(function(a){$rs.css($rs.arr(b),a,/Explorer/.test(rspkr.c.data.browser.name)?"":null)})}),c||(c=["sync_word_highlighted"]),"Array"===c.constructor||(c=[c]),b||(b=$rs.arr("."+c.join(", ."))),$rs.removeClass(b,c.join(" "))},f=function(b,c){$rs.addClass(b,c||"sync_sent_highlighted"),Object.keys(a.sent).forEach(function(b){$rs.css($rs.arr(b),a.sent[b])})},g=function(b,c){Object.keys(a.sent).forEach(function(b){Object.keys(a.sent[b]).forEach(function(a){$rs.css($rs.arr(b),a,/Explorer/.test(rspkr.c.data.browser.name)?"":null)})}),c||(c=["sync_sent_highlighted"]),"Array"===c.constructor||(c=[c]),b||(b=$rs.arr("."+c.join(", ."))),$rs.removeClass(b,c.join(" "))};return{setRule:b,removeRule:c,wordOn:d,wordOff:e,sentOn:f,sentOff:g,styles:a}}(),window.ReadSpeaker.HL.html5={States:{BEGIN:0,STOPPED:1,USER_START_NOT_READY:2,USER_START_PLAYING:3,NOT_PLAYING:4,CURRENT:0,setState:function(a){this.CURRENT=a,rspkr.log("[rspkr.hl.html5.States.setState] Changing state from "+this.CURRENT+" to "+a,1)}},Events:{canPlay:!1,durationChange:!1,syncReady:!1,eventTimer:null,onCanPlay:function(){return rspkr.log("onCanPlay fired!",1),this.canPlay=!0,this.checkCompletion(),this.eventTimer=setTimeout(function(){rspkr.log("[rspkr.hl.html5.Events] Timer triggered. Starting playback.",1),rspkr.hl.html5.Events.resetAll(),rspkr.hl.html5.refresh()},2500),!1},checkCompletion:function(){this.canPlay&&this.durationChange&&this.syncReady&&(clearTimeout(this.eventTimer),this.eventTimer=null,rspkr.hl.html5.Events.resetAll(),rspkr.hl.html5.refresh())},onDurationChange:function(){rspkr.log("onDurationChange fired!",1),this.durationChange=!0,this.checkCompletion(),this.eventTimer=setTimeout(function(){rspkr.log("[rspkr.hl.html5.Events] Timer triggered. Starting playback.",1),rspkr.hl.html5.Events.resetAll(),rspkr.hl.html5.refresh()},2500)},onSyncReady:function(){rspkr.log("onSyncReady fired!",1),this.syncReady=!0,this.checkCompletion(),this.eventTimer=setTimeout(function(){rspkr.log("[rspkr.hl.html5.Events] Timer triggered. Starting playback.",1),rspkr.hl.html5.Events.resetAll(),rspkr.hl.html5.refresh()},2500)},resetAll:function(){this.canPlay=!1,this.durationChange=!1,this.syncReady=!1,this.onEndedDone=!1},onEnded:function(){this.onEndedDone!==!0&&(this.onEndedDone=!0,rs.HL.chunking.continueHref?window.rshlcontinue():window.rshlexit("false"))}},lastcurrenttime:-1,currentsyncindex:0,lastevent:null,lastlastevent:null,lastlastlastevent:null,synclist:[],synclistindex:0,audioUrl:null,backupUrl:null,frameUrl:null,timer:null,postMessageData:[],handlers:{init:function(){rspkr.log("[rspkr.HL.html5.handlers.init]"),rspkr.HL.html5.cronologyCheck={proxyCallsDone:!1,errorOccured:!1,quarantine:[]},rspkr.HL.html5.rshlendCall=!1;var a=Math.random(),b={};b.audioformat=rspkr.Common.data.browser.html5AudioFormat,b.requestgrouptype="html5iframe",b.requestgroup=a,b.chunk=1,rspkr.HL.html5.backupUrl=rspkr.Common.data.getAudioLink(b),"string"!=typeof rspkr.HL.html5.backupUrl&&rspkr.HL.html5.backupUrl.link&&(rspkr.HL.html5.backupUrl=rspkr.HL.html5.backupUrl.link),(rspkr.cfg.item("general.usePost")===!0||rspkr.Common.data.selectedText.length||rspkr.Common.data.selectedHTML.length)&&"iOS"!==rspkr.Common.data.browser.OS&&"Android"!==rspkr.Common.data.browser.OS&&"Windows Phone"!==rspkr.Common.data.browser.OS?rspkr.HL.html5.timer=setTimeout(function(){rspkr.HL.html5.initSyncFrame(b),rspkr.HL.html5.initAudio(),clearTimeout(rspkr.HL.html5.timer)},2e3):(rspkr.log("Normal audio init!"),rspkr.HL.html5.initSyncFrame(b),rspkr.HL.html5.initAudio())},play:function(){rspkr.log("[rspkr.HL.html5.handlers.play]"),rspkr.HL.Type.CURRENT===rspkr.HL.Type.CLIENT_MARKUP&&rspkr.hl.html5.States.CURRENT===rspkr.hl.html5.States.STOPPED?(rspkr.hl.html5.States.setState(rspkr.hl.html5.States.BEGIN),rspkr.PlayerAPI.playerRef.pause(),rspkr.HL.html5.handlers.runPostMessages()):rspkr.HL.Type.CURRENT===rspkr.HL.Type.SERVER_MARKUP&&rspkr.hl.html5.States.CURRENT===rspkr.hl.html5.States.STOPPED?rspkr.hl.State.setState(rspkr.hl.State.RELOAD)?this.init():(rspkr.hl.html5.States.setState(rspkr.hl.html5.States.BEGIN),rspkr.PlayerAPI.playerRef.pause(),rspkr.HL.html5.handlers.runPostMessages()):(rspkr.hl.html5.States.CURRENT=rspkr.hl.html5.States.USER_START_PLAYING,rspkr.hl.html5.refresh())},pause:function(){rspkr.hl.html5.States.setState(rspkr.hl.html5.States.NOT_PLAYING),rspkr.hl.html5.lastcurrenttime=0},release:function(){rspkr.log("[rspkr.HL.html5.handlers.release]"),rspkr.HL.html5.synclist=[],rspkr.HL.html5.synclistindex=0,rspkr.HL.html5.currentsyncindex=0,rspkr.HL.html5.lastcurrenttime=-1,rspkr.HL.html5.audioUrl=null,rspkr.HL.html5.backupUrl=null,rspkr.HL.html5.frameUrl=null,rspkr.HL.html5.postMessageData=[],rspkr.HL.html5.endTimestamp=void 0,rspkr.HL.html5.Events.resetAll(),rspkr.PlayerAPI.playerRef=null;var a=document.getElementById("ReadSpeaker_sync_iframe");a&&(a.src="about:blank")},stop:function(){rspkr.hl.html5.States.setState(rspkr.hl.html5.States.STOPPED),rspkr.HL.html5.lastcurrenttime=-1,rspkr.HL.html5.currentsyncindex=0},restart:function(){rspkr.hl.html5.lastcurrenttime=-1,rspkr.hl.html5.currentsyncindex=0},updateTime:function(){rspkr.log("[rspkr.HL.html5.handlers.updateTime]"),rspkr.hl.html5.States.setState(rspkr.hl.html5.States.NOT_PLAYING),rspkr.HL.html5.lastcurrenttime=rspkr.PlayerAPI.playerRef.currentTime,rspkr.HL.html5.currentsyncindex=0,rspkr.HL.html5.handlers.setCurrentSyncIndex(),rspkr.hl.html5.States.setState(rspkr.hl.html5.States.USER_START_PLAYING)},runPostMessages:function(){rspkr.log("[rspkr.HL.html5.handlers.runPostMessages]");var a=rspkr.HL.html5.postMessageData;for(var b in a)null!==a[b-1]&&"rshlsetContent"===a[b]?rspkr.HL.sync.setContent(rspkr.Common.base64.decode(a[b-1])):null!==a[b-1]&&"rshlsetId"===a[b]?rspkr.HL.sync.setId(a[b-1]):"rshlinit"===a[b]?(rspkr.HL.sync.init(),rspkr.pl.playPromise(rspkr.PlayerAPI.playerRef),rspkr.HL.html5.refresh()):"rshlend"===a[b]},setCurrentSyncIndex:function(){if(rspkr.HL.html5.synclist.length&&rspkr.HL.html5.synclist[rspkr.HL.html5.currentsyncindex])for(;rspkr.HL.html5.synclist[rspkr.HL.html5.currentsyncindex]&&1*rspkr.HL.html5.synclist[rspkr.HL.html5.currentsyncindex][0]-1e3*rspkr.PlayerAPI.playerRef.currentTime<=20;)rspkr.HL.html5.currentsyncindex++},totalTime:function(){var a=rspkr.PlayerAPI.playerRef;if(a){if("Opera"===rspkr.Common.data.browser.name||!a.buffered||!a.buffered.end)return a.duration&&"infinity"!==a.duration.toString.toLowerCase()&&"NaN"!==a.duration?a.duration:a.currentTime+15;try{return a.buffered.length?a.buffered.end(a.buffered.length-1):a.buffered.end(0)}catch(b){return a.duration&&"infinity"!==a.duration.toString().toLowerCase()&&"NaN"!==a.duration?a.duration:a.currentTime+15}}}},initAudio:function(){rspkr.HL.html5.audioUrl||(rspkr.HL.html5.audioUrl=rspkr.HL.html5.backupUrl),rspkr.log("[rspkr.html5.initAudio] Audio URL: "+rspkr.HL.html5.audioUrl,1),(/windows phone|ios|android/i.test(rspkr.c.data.browser.OS)||/safari/i.test(rspkr.c.data.browser.name))&&"object"==typeof window.rspkr.audio&&null!==window.rspkr.audio?(rspkr.audio.src=rspkr.HL.html5.audioUrl,rspkr.PlayerAPI.playerRef=rspkr.audio,rspkr.log("[rs.hl.initAudio] Reusing existing audio element.",4)):(rspkr.PlayerAPI.playerRef=new Audio(rspkr.HL.html5.audioUrl),rspkr.mobile()&&/safari/i.test(rspkr.c.data.browser.name)&&(rspkr.audio=rspkr.PlayerAPI.playerRef));var a=rspkr.PlayerAPI.playerRef;a.loop=!1,a.preload="auto",a.volume=parseFloat((rspkr.st.get("hlvol")||100)/100),rspkr.devt("onVolumeAdjusted",window),(rspkr.mobile()||/safari/i.test(rspkr.c.data.browser.name))&&rspkr.pl.playPromise(rspkr.PlayerAPI.playerRef,void 0,void 0,!0),a.addEventListener("canplay",function(){rspkr.hl.html5.Events.onCanPlay()},!1),a.addEventListener("durationchange",function(){rspkr.log("[rspkr.hl.html5.initAudio] Durationchange occurred",1),1===rspkr.HL.html5.handlers.totalTime()&&rspkr.PlayerAPI.playerRef.paused===!0?rspkr.HL.html5.initAudio():0===rspkr.HL.html5.handlers.totalTime()?(rspkr.pl.playPromise(rspkr.pl.playerRef),
rspkr.hl.html5.Events.onDurationChange()):rspkr.hl.html5.Events.onDurationChange()},!1),rspkr.pl.checkNetworkStatus(),rspkr.hl.html5.States.setState(rspkr.hl.html5.States.BEGIN)},initSyncFrame:function(a){if("none"!==rspkr.Common.data.sync){var b=null;document.getElementById("ReadSpeaker_sync_iframe")?b=document.getElementById("ReadSpeaker_sync_iframe"):(b=document.createElement("iframe"),b.setAttribute("id","ReadSpeaker_sync_iframe"),b.setAttribute("title","ReadSpeaker_sync_iframe"),b.setAttribute("aria-hidden","true"),b.setAttribute("sandbox","allow-same-origin allow-scripts"),b.height=0,b.width=0,b.style.display="none",document.body.appendChild(b)),rspkr.HL.html5.frameUrl||rspkr.cfg.item("general.usePost")!==!0&&!rspkr.Common.data.selectedText.length&&!rspkr.Common.data.selectedHTML.length?rspkr.HL.html5.frameUrl||(a.audioformat="html5iframe",rspkr.HL.html5.frameUrl=rspkr.Common.data.getAudioLink(a)):rspkr.HL.html5.frameUrl=rspkr.HL.html5.backupUrl+"sync",rspkr.log("[rspkr.HL.html5.initSyncFrame] Audio URL: "+rspkr.HL.html5.frameUrl),rspkr.HL.html5.frameUrl&&(b.src=rspkr.HL.html5.frameUrl,b.type="text/javascript")}else rspkr.hl.html5.States.setState(rspkr.hl.html5.States.USER_START_PLAYING),rspkr.pl.playPromise(rspkr.PlayerAPI.playerRef)},removeSyncFrame:function(){var a=document.getElementById("ReadSpeaker_sync_iframe");a&&a.parentNode.removeChild(a)},receiveMessage:function(a){var b=!0;if(rspkr.cfg.item("general.servercall")){var c=document.createElement("a");$rs.setAttr(c,"href",rspkr.cfg.item("general.servercall")),b=!a.origin.match(c.hostname)}var d=document.createElement("a");d.href=a.origin,d=d.hostname;var e=["\\.readspeaker\\.com$","^79\\.136\\.80\\.","^173\\.205\\.5\\.(19[3-9]|2[0-4][0-9]|25[0-4])$","^2001\\:668\\:1F\\:2A","^2001\\:9b0\\:2\\:703","\\."+rspkr.cfg.item("general.domain").replace(".","\\\\.")+"$"],f=new RegExp("("+e.join("|")+")","gi");if((d.match(f)||!b)&&"string"==typeof a.data){if(rspkr.HL.html5.postMessageData.push(a.data),/android|ios|windows phone/i.test(rspkr.Common.data.browser.OS)||"rshlfinished"!==a.data||(rspkr.HL.html5.timer&&clearTimeout(rspkr.HL.html5.timer),rspkr.HL.html5.initSyncFrame(),rspkr.HL.html5.initAudio()),"rshlend"===a.data)rspkr.hl.html5.lastevent&&rspkr.hl.html5.lastevent.data&&!isNaN(rspkr.hl.html5.lastevent.data)&&(rspkr.HL.html5.synclist[rspkr.HL.html5.synclistindex]=[rspkr.HL.html5.lastevent.data,"rshlend",0],rspkr.HL.html5.synclistindex++),rspkr.HL.html5.rshlendCall=!0,rspkr.c.post.removeIframe(),rspkr.HL.html5.removeSyncFrame();else{if("rshlaudio"===a.data)return url=rs.cfg.item("general.customProxy")?rs.cfg.item("general.customProxy")+encodeURIComponent(rspkr.HL.html5.lastevent.data):rspkr.HL.html5.lastevent.data,void(rspkr.HL.html5.audioUrl=url);if("rshlhtml5sync"===a.data){var g=rspkr.HL.html5.lastevent.data,h=document.createElement("a");if(h.href=g,"http:"!==h.protocol&&"https:"!==h.protocol)return;return url=rs.cfg.item("general.customProxy")?rs.cfg.item("general.customProxy")+encodeURIComponent(g):g,void(rspkr.HL.html5.frameUrl=url)}if("rshlaudio"===a.data)return;if(null!==rspkr.HL.html5.lastevent&&"rshlsetContent"===a.data)rspkr.HL.html5.synclist=[],rspkr.HL.html5.synclistindex=0,rspkr.HL.sync.setContent(rspkr.Common.base64.decode(rspkr.HL.html5.lastevent.data));else if(null!==rspkr.HL.html5.lastevent&&"rshlsetId"===a.data)rspkr.HL.sync.setId(rspkr.HL.html5.lastevent.data);else if(null!==rspkr.HL.html5.lastevent&&"rshlReplace"===a.data){if(rspkr.HL.html5.lastevent.data.match(/class=[^&|,]+/gi)){var i=rspkr.HL.html5.lastevent.data.match(/class=[^&|,]+/gi)[0].replace("class=","");rspkr.HL.sync.setClass(i)}if(rspkr.HL.html5.lastevent.data.match(/id=[^&|,]+/gi)){var j=rspkr.HL.html5.lastevent.data.match(/id=[^&|,]+/gi)[0].replace("id=","");rspkr.HL.sync.setId(j)}}else"rshlinit"===a.data?(rspkr.HL.sync.init(),rspkr.hl.html5.Events.onSyncReady()):null!==rspkr.HL.html5.lastlastlastevent&&null!==rspkr.HL.html5.lastlastevent&&null!==rspkr.HL.html5.lastevent&&"rshlsync"===a.data?(rspkr.HL.html5.synclist[rspkr.HL.html5.synclistindex]=[rspkr.HL.html5.lastlastlastevent.data,rspkr.HL.html5.lastlastevent.data,rspkr.HL.html5.lastevent.data],rspkr.HL.html5.synclistindex++):null!==rspkr.HL.html5.lastevent&&"rshlcontinue"===a.data?(rs.HL.chunking.continueHref=rspkr.HL.html5.lastevent.data,rs.HL.chunking.continueTime=rspkr.HL.html5.lastlastevent&&!isNaN(rspkr.HL.html5.lastlastevent.data)?rspkr.HL.html5.lastlastevent.data:-1,/ios|android|windows phone/i.test(rspkr.c.data.browser.OS)&&(rspkr.HL.chunking.continueTime=-1)):"rshlresume"===a.data&&(rspkr.HL.html5.synclist.length=0,rspkr.HL.html5.synclistindex=0,rspkr.HL.html5.currentsynclistindex=0,rspkr.HL.html5.currentsyncindex=0)}rspkr.HL.html5.lastlastlastevent=rspkr.HL.html5.lastlastevent,rspkr.HL.html5.lastlastevent=rspkr.HL.html5.lastevent,rspkr.HL.html5.lastevent=a}},refresh:function(){var a,b=rspkr.PlayerAPI.playerRef,c=rspkr.HL.html5;return b&&c.States.CURRENT!==c.States.STOPPED?(c.States.CURRENT===c.States.NOT_PLAYING&&setTimeout(function(){c.refresh()},500),b.currentTime>0&&parseInt(c.lastcurrenttime)>parseInt(Math.ceil(b.currentTime))?(rspkr.log("[rspkr.hl.html5.refresh] An error has occurred. Player is stopped.",2),void rspkr.ui.getActivePlayer().stop()):(c.lastcurrenttime=b.currentTime,b.currentTime&&c.endTimestamp&&1e3*b.currentTime>=parseFloat(c.endTimestamp)&&rspkr.hl.html5.Events.onEnded(),void(c.States.CURRENT===c.States.BEGIN?(rspkr.hl.html5.States.setState(c.States.USER_START_NOT_READY),setTimeout(function(){c.refresh()},200)):c.States.CURRENT===c.States.USER_START_NOT_READY?c.handlers.totalTime()>0&&(rspkr.HL.html5.rshlendCall||c.synclist[c.currentsyncindex]&&c.synclist[c.currentsyncindex][0]<1e3*c.handlers.totalTime())?(rspkr.hl.html5.States.setState(c.States.USER_START_PLAYING),rspkr.pl.playPromise(b),setTimeout(function(){c.refresh()},50)):0===c.handlers.totalTime()?(rspkr.pl.playPromise(b),setTimeout(function(){c.refresh()},250)):c.synclist[c.currentsyncindex]?1*c.synclist[c.currentsyncindex][0]-1e3*b.currentTime<=20?setTimeout(function(){c.refresh()},0):(a=1*c.synclist[c.currentsyncindex][0]-1e3*b.currentTime-20,a>75?setTimeout(function(){c.refresh()},75):0>a?setTimeout(function(){c.refresh()},0):setTimeout(function(){c.refresh()},a)):setTimeout(function(){c.refresh()},75):c.States.CURRENT===c.States.USER_START_PLAYING&&(c.currentsyncindex===c.synclist.length-1&&c.synclist[c.currentsyncindex].length&&"rshlend"===c.synclist[c.currentsyncindex][1]&&(c.endTimestamp=c.synclist[c.currentsyncindex][0],c.currentsyncindex++),c.synclist[c.currentsyncindex]&&1*c.synclist[c.currentsyncindex][0]-20<1e3*b.currentTime?(rspkr.HL.sync.execute(c.synclist[c.currentsyncindex][1],c.synclist[c.currentsyncindex][2]),c.currentsyncindex++,c.synclist[c.currentsyncindex]?1*c.synclist[c.currentsyncindex][0]-1e3*b.currentTime<=20?setTimeout(function(){c.refresh()},0):(a=1*c.synclist[c.currentsyncindex][0]-1e3*b.currentTime-20,a>75?setTimeout(function(){c.refresh()},75):0>a?setTimeout(function(){c.refresh()},0):setTimeout(function(){c.refresh()},a)):setTimeout(function(){c.refresh()},75)):c.synclist[c.currentsyncindex]?1*c.synclist[c.currentsyncindex][0]-1e3*b.currentTime<=20?setTimeout(function(){c.refresh()},0):(a=1*c.synclist[c.currentsyncindex][0]-1e3*b.currentTime-20,a>75?setTimeout(function(){c.refresh()},75):0>a?setTimeout(function(){c.refresh()},0):setTimeout(function(){c.refresh()},a)):setTimeout(function(){c.refresh()},75))))):void rspkr.log("[rspkr.hl.html5.refresh] Audio is undefined or player is stopped",2)}},ReadSpeaker.HL.customHL=function(){return{active:function(){return!1}}}(),window.ReadSpeaker.HL.webAudio={audioUrl:null,handlers:{init:function(){rspkr.log("rspkr.hl.webAudio.handlers.init",4);var a={audioformat:"flv"};rspkr.br.info.fetchSupport||(a.chunk=1);var b=rspkr.c.data.getAudioLink(a,void 0,!0),c=null;rspkr.hl.webAudio.audioUrl=b.link||"",b.usePost===!0&&(c=rspkr.c.post.getPostData(b.params)),rspkr.hl.webAudio.initAudio(),rspkr.c.clearEvent("onWebAudioSync",rspkr.hl.webAudio.sync.poll),rspkr.evt("onWebAudioSync",rspkr.hl.webAudio.sync.poll),rspkr.pl.loader.load(rspkr.hl.webAudio.audioUrl,c||void 0)},play:function(){rspkr.pl.audio.play()},pause:function(){rspkr.pl.audio.pause()},stop:function(){rspkr.pl.audio.stop()}},initAudio:function(){rspkr.log("initAudio url: "+rspkr.hl.webAudio.audioUrl,4),rspkr.devt("onVolumeAdjusted",window)},clearHighlighted:function(){return rspkr.hl.css.wordOff(),rspkr.hl.css.sentOff(),!0},sync:{index:0,q:[],started:!1,timer:null,item:function(a){null!==a&&"function"==typeof window[a[0]]&&window[a[0]].apply(window,a.slice(1))},poll:function(a){rspkr.hl.webAudio.sync.started||(rspkr.hl.webAudio.sync.started=!0);var b=rspkr.hl.webAudio.sync.q[rspkr.hl.webAudio.sync.index],c=0;b&&0!==a&&a>b.time-c&&(rspkr.hl.webAudio.sync.index++,rspkr.hl.webAudio.sync.item(b.data))},stopPoll:function(){rspkr.hl.webAudio.sync.started=!1},restart:function(){rspkr.hl.webAudio.sync.stopPoll(),rspkr.hl.webAudio.sync.index=0},reinit:function(){rspkr.hl.webAudio.sync.stopPoll(),rspkr.hl.webAudio.sync.index=0,rspkr.hl.webAudio.sync.q=[]}}},ReadSpeaker.HL.customHL=function(){return{active:function(){return!1}}}(),String.prototype.substrSearch=function(a,b){return this.substr(a,this.indexOf(b,a)-a)},Element.prototype.insertChildAtIndex=function(a,b){(b||0)>=this.childNodes.length?this.appendChild(a):this.insertBefore(a,this.childNodes[b])},Text.prototype&&"function"!=typeof Text.prototype.contains&&(Text.prototype.contains=function(){return!1}),Element.prototype.containsExt=function(a){return this.contains(a)?!0:a.parentNode&&this.contains(a.parentNode)?!0:!1},rspkr.HL.engine.textNode=function(){var a={name:"textNode",enums:{level:{SENT:1,WORD:2}},init:function(){rspkr.HL.engine.useTextNodeMarkup=!0},preProcess:{excludedNodes:["br","select","option","textarea","colgroup","script","map","optgroup","style","noscript","#comment"],excludedClasses:["rsbtn"],init:function(){a.postProcess.fullCleanUp(),a.preProcess.idGen.reset(),rspkr.hl.sentOnlyLang=rspkr.hl.sentOnlyLang||-1!==rspkr.cfg.item("general.sentOnlyLang").indexOf(rspkr.c.data.getParam("lang")),rspkr.c.data.selectedRange?(this.textSelection.finetuneRange(),this.textSelection.injectMarkup(rspkr.c.data.selectedRange)):this.readArea.injectMarkup(rspkr.c.data.getDefaultReadElements())},idGen:{create:function(){return"sync"+ ++a.preProcess.id},reset:function(){a.preProcess.id=0}},readArea:{injectMarkup:function(b){if(!rspkr.cfg.item("general.premarkup")){rspkr.c.dispatchEvent("onBeforeContentChange",window),$rs.isArray(b)||(b=[b]);for(var c,d=0;c=b[d];d++)for(var e,f=c.childNodes,g=0;e=f[g];g++)if(3===e.nodeType){var h=a.preProcess.common.wrap.textNode(e);h&&c.replaceChild(h.replace,e)}else{if(-1!==a.preProcess.excludedNodes.indexOf(e.nodeName.toLowerCase())||e instanceof SVGElement||e.className&&$rs.arraySearch(e.className.split(" "),a.preProcess.excludedClasses)||$rs.hasClass(e,"rs_skip"))continue;rs.hl.clientMarkup.skipHidden(e)===!0?(!$rs.hasClass(e,"rs_skip")&&$rs.addClass(e,"tmp_skip"),$rs.addClass(e,"rs_skip")):a.preProcess.readArea.injectMarkup(e)}}}},textSelection:{finetuneRange:function(){var a=rspkr.c.data.selectionBackupData&&(rspkr.c.data.selectionBackupData.startContainer===rspkr.c.data.selectionBackupData.endContainer||!document.body.containsExt(rspkr.c.data.selectionBackupData.startContainer)&&!document.body.containsExt(rspkr.c.data.selectionBackupData.endContainer)&&rspkr.c.data.selectedRange.startContainer===rspkr.c.data.selectedRange.endContainer);if(rspkr.c.data.selectionBackupData&&!document.body.containsExt(rspkr.c.data.selectionBackupData.startContainer)){var b=(rspkr.c.data.selectedRange.startContainer,rspkr.c.data.selectedRange.startContainer.childNodes.length&&!isNaN(rspkr.c.data.selectionBackupData.startNodePosition)?rspkr.c.data.selectedRange.startContainer.childNodes[rspkr.c.data.selectionBackupData.startNodePosition]:rspkr.c.data.selectedRange.startContainer.childNodes[0]);if(isNaN(rspkr.c.data.selectionBackupData.startOffsetNormalized))for(var c=0,d=rspkr.c.data.selectionBackupData.startContainer.parentNode.childNodes,e=0;e<d.length;e++){if(3===d[e].nodeType&&d[e]===rspkr.c.data.selectionBackupData.startContainer){rspkr.c.data.selectedRange.setStart(b,c+rspkr.c.data.selectionBackupData.startOffset),a&&rspkr.c.data.selectedRange.setEnd(b,c+rspkr.c.data.selectionBackupData.endOffset);break}c+=d[e].textContent.length}else rspkr.c.data.selectedRange.setStart(b,rspkr.c.data.selectionBackupData.startOffsetNormalized),a&&rspkr.c.data.selectedRange.setEnd(b,rspkr.c.data.selectionBackupData.endOffsetNormalized)}if(!a&&rspkr.c.data.selectionBackupData&&!document.body.containsExt(rspkr.c.data.selectionBackupData.endContainer)){var b=(rspkr.c.data.selectedRange.endContainer,rspkr.c.data.selectedRange.endContainer.childNodes.length&&!isNaN(rspkr.c.data.selectionBackupData.endNodePosition)?rspkr.c.data.selectedRange.endContainer.childNodes[rspkr.c.data.selectionBackupData.endNodePosition]:rspkr.c.data.selectedRange.endContainer.childNodes[0]);if(isNaN(rspkr.c.data.selectionBackupData.endOffsetNormalized))for(var c=0,d=rspkr.c.data.selectionBackupData.endContainer.parentNode.childNodes,e=0;e<d.length;e++){if(3===d[e].nodeType&&d[e]===rspkr.c.data.selectionBackupData.endContainer){a&&rspkr.c.data.selectedRange.setStart(b,c+rspkr.c.data.selectionBackupData.startOffset),rspkr.c.data.selectedRange.setEnd(b,c+rspkr.c.data.selectionBackupData.endOffset);break}c+=d[e].textContent.length}else a&&rspkr.c.data.selectedRange.setStart(b,rspkr.c.data.selectionBackupData.startOffsetNormalized),rspkr.c.data.selectedRange.setEnd(b,rspkr.c.data.selectionBackupData.endOffsetNormalized)}},injectMarkup:function(b,c,d){if(!b&&!c)return void rspkr.log("[rspkr.HL.engine.textNode] Text-selection highlighting called without a range or element.",3);rspkr.c.dispatchEvent("onBeforeContentChange",window);var e;b?(a.preProcess.textSelection.postContent="",this.range=b,this.startContainer=b.startContainer,this.endContainer=b.endContainer,this.passedStartContainer=!1,this.passedEndContainer=!1,d={start:this.modifyOffsetStartOfWord(this.startContainer,b.startOffset),end:this.modifyOffsetEndOfWord(this.endContainer,b.endOffset)},e=3===b.commonAncestorContainer.nodeType?[b.commonAncestorContainer]:b.commonAncestorContainer.childNodes):c&&(e=c.childNodes);for(var f,g=0;f=e[g];g++){if(!this.passedStartContainer){if(!this.startContainer.contains(f)&&!f.contains(this.startContainer))continue;f===this.startContainer&&(this.passedStartContainer=!0)}if(this.passedEndContainer)break;f===this.endContainer&&(this.passedEndContainer=!0);var h={start:0,end:0};if(f.nodeValue&&(h.end=f.nodeValue.length),f.innerText&&(h.end=f.innerText.length),f.contains(this.startContainer)&&(h.start=d.start),f.contains(this.endContainer)&&(h.end=d.end),3===f.nodeType){var i=rs.hl.clientMarkup.skipAlways(f),j=a.preProcess.common.wrap.textNode(f,h,i);j&&(j.disableReplacement!==!0&&f.parentNode.replaceChild(j.replace,f),a.preProcess.textSelection.postContent+=j.postContent+" ")}else{if(-1!==a.preProcess.excludedNodes.indexOf(f.nodeName.toLowerCase())||f instanceof SVGElement||f.className&&$rs.arraySearch(f.className.split(" "),a.preProcess.excludedClasses))continue;if(rs.hl.clientMarkup.skipHidden(f)===!0)!$rs.hasClass(f,"rs_skip_always")&&$rs.addClass(f,"tmp_skip_always"),$rs.addClass(f,"rs_skip_always");else{for(var k,l=f.attributes,m="",n=0;k=l[n];n++)"data-"===k.name.substring(0,5)&&"data-mathml"!==k.name&&(m+=" "+k.name+'="'+k.value+'"');var o="<%e%i%c%a>".replace("%e",f.nodeName).replace("%i",f.id?' id="'+f.id+'"':"").replace("%c",f.className?' class="'+f.className+'"':"").replace("%a",m);a.preProcess.textSelection.postContent+=o;var p=f.getAttribute("aria-label")||f.title||f.getAttribute("alt"),q=["body","p","nav","section"];p&&-1===q.indexOf(f.nodeName.toLowerCase())?a.preProcess.textSelection.postContent+=$rs.createElm("div",{content:p}).outerHTML:a.preProcess.textSelection.injectMarkup(void 0,f,h),a.preProcess.textSelection.postContent+="</%e>".replace("%e",f.nodeName)}}}b&&(window.getSelection().removeAllRanges(),rspkr.c.data.selectedHTML=a.preProcess.textSelection.postContent||$rs.createElm("div").outerHTML)},wordDelimiters:new Array(" ",", ",". ","! ","? ",decodeURIComponent("%e3%80%81"),decodeURIComponent("%e3%80%82"),decodeURIComponent("%DB%94"),decodeURIComponent("%D8%8C")),modifyOffsetStartOfWord:function(a,b){for(;a.nodeValue&&0!==b;){for(var c=0;c<this.wordDelimiters.length;c++)if(0===a.nodeValue.substring(b).indexOf(this.wordDelimiters[c]))return b;b--}return b},modifyOffsetEndOfWord:function(a,b){for(;a.nodeValue&&b!==a.nodeValue.length;){for(var c=0;c<this.wordDelimiters.length;c++)if(0===a.nodeValue.substring(b-1).indexOf(this.wordDelimiters[c]))return b;b++}return b}},common:{wrap:{textNode:function(b,c,d){if(b.textContent.trim().length){var e,f,g=!!c,h="",i="",j=0,k=a.preProcess.common.split.sentences(b.textContent);g&&rspkr.cfg.item("general.searchLang")!==!1&&(e=rspkr.c.data.searchLangAttr(b),f=rspkr.c.data.searchVoiceAttr(b));for(var l,m=0;l=k[m];m++)if(g&&(j+l.length<c.start||j>c.end)){j+=l.length;var n=b.textContent.substrSearch(j,k[m+1]);j+=n.length,h+=l+n}else{var o="",p=0,q=a.preProcess.common.split.words(l);q=q.filter(function(a){return a.length});for(var r,s=0;r=q[s];s++){var t=j+p;g&&(t<c.start||t>=c.end)?(o+=r,p+=r.length):(p+=r.length,o+=r.trim().length?a.preProcess.common.wrap.text(r,{level:a.enums.level.WORD}).replace:r)}var u=a.preProcess.common.wrap.text(o,{level:a.enums.level.SENT,search:g});if(h+=u.replace,g)if(e||f||d){var v=$rs.createElm("div",{content:u.postContent});e&&v.setAttribute("lang",e),f&&v.setAttribute("style",f),d&&$rs.addClass(v,"rs_skip_always"),i+=v.outerHTML}else i+=u.postContent;if(j+=l.length,m<k.length-1){var n=b.textContent.substrSearch(j,k[m+1]);j+=n.length,h+=n}else j+1<b.textContent.length&&(h+=b.textContent.substr(p))}var w={};return w.replace=$rs.createElm(rs.c.data.browser.syncContainer,{cls:"rs_textnode",content:h}),g&&(w.postContent=i),rspkr.cfg.item("general.premarkup")&&(w.disableReplacement=!0),w}},text:function(b,c){var d={};if(c.search===!0){var e=$rs.createElm("div"),f=$rs.createElm("div"),g=$rs.createElm(rs.c.data.browser.syncContainer,{cls:"sync_user sync_sent",id:a.preProcess.idGen.create()}),h=$rs.createElm("div");for(e.innerHTML=b;e.hasChildNodes();)if(3===e.childNodes[0].nodeType)g.hasChildNodes()?h.appendChild(e.childNodes[0]):f.appendChild(e.childNodes[0]);else{for(;h.hasChildNodes();)g.appendChild(h.childNodes[0]);g.appendChild(e.childNodes[0])}d.replace=f.innerHTML+g.outerHTML+h.innerHTML,d.postContent=g.outerHTML+" "}else{var i=$rs.createElm(rs.c.data.browser.syncContainer,{content:b,cls:c.level===a.enums.level.SENT?"sync_sent":"sync_word",id:a.preProcess.idGen.create()});d.replace=i.outerHTML}return d}},split:{sentences:function(a){var b,c=decodeURIComponent("A-Za-z%5CxAA%5CxB5%5CxBA%5CxC0-%5CxD6%5CxD8-%5CxF6%5CxF8-%5Cu02C1%5Cu02C6-%5Cu02D1%5Cu02E0-%5Cu02E4%5Cu02EC%5Cu02EE%5Cu0370-%5Cu0374%5Cu0376%5Cu0377%5Cu037A-%5Cu037D%5Cu0386%5Cu0388-%5Cu038A%5Cu038C%5Cu038E-%5Cu03A1%5Cu03A3-%5Cu03F5%5Cu03F7-%5Cu0481%5Cu048A-%5Cu0527%5Cu0531-%5Cu0556%5Cu0559%5Cu0561-%5Cu0587%5Cu05D0-%5Cu05EA%5Cu05F0-%5Cu05F2%5Cu0620-%5Cu064A%5Cu066E%5Cu066F%5Cu0671-%5Cu06D3%5Cu06D5%5Cu06E5%5Cu06E6%5Cu06EE%5Cu06EF%5Cu06FA-%5Cu06FC%5Cu06FF%5Cu0710%5Cu0712-%5Cu072F%5Cu074D-%5Cu07A5%5Cu07B1%5Cu07CA-%5Cu07EA%5Cu07F4%5Cu07F5%5Cu07FA%5Cu0800-%5Cu0815%5Cu081A%5Cu0824%5Cu0828%5Cu0840-%5Cu0858%5Cu08A0%5Cu08A2-%5Cu08AC%5Cu0904-%5Cu0939%5Cu093D%5Cu0950%5Cu0958-%5Cu0961%5Cu0971-%5Cu0977%5Cu0979-%5Cu097F%5Cu0985-%5Cu098C%5Cu098F%5Cu0990%5Cu0993-%5Cu09A8%5Cu09AA-%5Cu09B0%5Cu09B2%5Cu09B6-%5Cu09B9%5Cu09BD%5Cu09CE%5Cu09DC%5Cu09DD%5Cu09DF-%5Cu09E1%5Cu09F0%5Cu09F1%5Cu0A05-%5Cu0A0A%5Cu0A0F%5Cu0A10%5Cu0A13-%5Cu0A28%5Cu0A2A-%5Cu0A30%5Cu0A32%5Cu0A33%5Cu0A35%5Cu0A36%5Cu0A38%5Cu0A39%5Cu0A59-%5Cu0A5C%5Cu0A5E%5Cu0A72-%5Cu0A74%5Cu0A85-%5Cu0A8D%5Cu0A8F-%5Cu0A91%5Cu0A93-%5Cu0AA8%5Cu0AAA-%5Cu0AB0%5Cu0AB2%5Cu0AB3%5Cu0AB5-%5Cu0AB9%5Cu0ABD%5Cu0AD0%5Cu0AE0%5Cu0AE1%5Cu0B05-%5Cu0B0C%5Cu0B0F%5Cu0B10%5Cu0B13-%5Cu0B28%5Cu0B2A-%5Cu0B30%5Cu0B32%5Cu0B33%5Cu0B35-%5Cu0B39%5Cu0B3D%5Cu0B5C%5Cu0B5D%5Cu0B5F-%5Cu0B61%5Cu0B71%5Cu0B83%5Cu0B85-%5Cu0B8A%5Cu0B8E-%5Cu0B90%5Cu0B92-%5Cu0B95%5Cu0B99%5Cu0B9A%5Cu0B9C%5Cu0B9E%5Cu0B9F%5Cu0BA3%5Cu0BA4%5Cu0BA8-%5Cu0BAA%5Cu0BAE-%5Cu0BB9%5Cu0BD0%5Cu0C05-%5Cu0C0C%5Cu0C0E-%5Cu0C10%5Cu0C12-%5Cu0C28%5Cu0C2A-%5Cu0C33%5Cu0C35-%5Cu0C39%5Cu0C3D%5Cu0C58%5Cu0C59%5Cu0C60%5Cu0C61%5Cu0C85-%5Cu0C8C%5Cu0C8E-%5Cu0C90%5Cu0C92-%5Cu0CA8%5Cu0CAA-%5Cu0CB3%5Cu0CB5-%5Cu0CB9%5Cu0CBD%5Cu0CDE%5Cu0CE0%5Cu0CE1%5Cu0CF1%5Cu0CF2%5Cu0D05-%5Cu0D0C%5Cu0D0E-%5Cu0D10%5Cu0D12-%5Cu0D3A%5Cu0D3D%5Cu0D4E%5Cu0D60%5Cu0D61%5Cu0D7A-%5Cu0D7F%5Cu0D85-%5Cu0D96%5Cu0D9A-%5Cu0DB1%5Cu0DB3-%5Cu0DBB%5Cu0DBD%5Cu0DC0-%5Cu0DC6%5Cu0E01-%5Cu0E30%5Cu0E32%5Cu0E33%5Cu0E40-%5Cu0E46%5Cu0E81%5Cu0E82%5Cu0E84%5Cu0E87%5Cu0E88%5Cu0E8A%5Cu0E8D%5Cu0E94-%5Cu0E97%5Cu0E99-%5Cu0E9F%5Cu0EA1-%5Cu0EA3%5Cu0EA5%5Cu0EA7%5Cu0EAA%5Cu0EAB%5Cu0EAD-%5Cu0EB0%5Cu0EB2%5Cu0EB3%5Cu0EBD%5Cu0EC0-%5Cu0EC4%5Cu0EC6%5Cu0EDC-%5Cu0EDF%5Cu0F00%5Cu0F40-%5Cu0F47%5Cu0F49-%5Cu0F6C%5Cu0F88-%5Cu0F8C%5Cu1000-%5Cu102A%5Cu103F%5Cu1050-%5Cu1055%5Cu105A-%5Cu105D%5Cu1061%5Cu1065%5Cu1066%5Cu106E-%5Cu1070%5Cu1075-%5Cu1081%5Cu108E%5Cu10A0-%5Cu10C5%5Cu10C7%5Cu10CD%5Cu10D0-%5Cu10FA%5Cu10FC-%5Cu1248%5Cu124A-%5Cu124D%5Cu1250-%5Cu1256%5Cu1258%5Cu125A-%5Cu125D%5Cu1260-%5Cu1288%5Cu128A-%5Cu128D%5Cu1290-%5Cu12B0%5Cu12B2-%5Cu12B5%5Cu12B8-%5Cu12BE%5Cu12C0%5Cu12C2-%5Cu12C5%5Cu12C8-%5Cu12D6%5Cu12D8-%5Cu1310%5Cu1312-%5Cu1315%5Cu1318-%5Cu135A%5Cu1380-%5Cu138F%5Cu13A0-%5Cu13F4%5Cu1401-%5Cu166C%5Cu166F-%5Cu167F%5Cu1681-%5Cu169A%5Cu16A0-%5Cu16EA%5Cu1700-%5Cu170C%5Cu170E-%5Cu1711%5Cu1720-%5Cu1731%5Cu1740-%5Cu1751%5Cu1760-%5Cu176C%5Cu176E-%5Cu1770%5Cu1780-%5Cu17B3%5Cu17D7%5Cu17DC%5Cu1820-%5Cu1877%5Cu1880-%5Cu18A8%5Cu18AA%5Cu18B0-%5Cu18F5%5Cu1900-%5Cu191C%5Cu1950-%5Cu196D%5Cu1970-%5Cu1974%5Cu1980-%5Cu19AB%5Cu19C1-%5Cu19C7%5Cu1A00-%5Cu1A16%5Cu1A20-%5Cu1A54%5Cu1AA7%5Cu1B05-%5Cu1B33%5Cu1B45-%5Cu1B4B%5Cu1B83-%5Cu1BA0%5Cu1BAE%5Cu1BAF%5Cu1BBA-%5Cu1BE5%5Cu1C00-%5Cu1C23%5Cu1C4D-%5Cu1C4F%5Cu1C5A-%5Cu1C7D%5Cu1CE9-%5Cu1CEC%5Cu1CEE-%5Cu1CF1%5Cu1CF5%5Cu1CF6%5Cu1D00-%5Cu1DBF%5Cu1E00-%5Cu1F15%5Cu1F18-%5Cu1F1D%5Cu1F20-%5Cu1F45%5Cu1F48-%5Cu1F4D%5Cu1F50-%5Cu1F57%5Cu1F59%5Cu1F5B%5Cu1F5D%5Cu1F5F-%5Cu1F7D%5Cu1F80-%5Cu1FB4%5Cu1FB6-%5Cu1FBC%5Cu1FBE%5Cu1FC2-%5Cu1FC4%5Cu1FC6-%5Cu1FCC%5Cu1FD0-%5Cu1FD3%5Cu1FD6-%5Cu1FDB%5Cu1FE0-%5Cu1FEC%5Cu1FF2-%5Cu1FF4%5Cu1FF6-%5Cu1FFC%5Cu2071%5Cu207F%5Cu2090-%5Cu209C%5Cu2102%5Cu2107%5Cu210A-%5Cu2113%5Cu2115%5Cu2119-%5Cu211D%5Cu2124%5Cu2126%5Cu2128%5Cu212A-%5Cu212D%5Cu212F-%5Cu2139%5Cu213C-%5Cu213F%5Cu2145-%5Cu2149%5Cu214E%5Cu2183%5Cu2184%5Cu2C00-%5Cu2C2E%5Cu2C30-%5Cu2C5E%5Cu2C60-%5Cu2CE4%5Cu2CEB-%5Cu2CEE%5Cu2CF2%5Cu2CF3%5Cu2D00-%5Cu2D25%5Cu2D27%5Cu2D2D%5Cu2D30-%5Cu2D67%5Cu2D6F%5Cu2D80-%5Cu2D96%5Cu2DA0-%5Cu2DA6%5Cu2DA8-%5Cu2DAE%5Cu2DB0-%5Cu2DB6%5Cu2DB8-%5Cu2DBE%5Cu2DC0-%5Cu2DC6%5Cu2DC8-%5Cu2DCE%5Cu2DD0-%5Cu2DD6%5Cu2DD8-%5Cu2DDE%5Cu2E2F%5Cu3005%5Cu3006%5Cu3031-%5Cu3035%5Cu303B%5Cu303C%5Cu3041-%5Cu3096%5Cu309D-%5Cu309F%5Cu30A1-%5Cu30FA%5Cu30FC-%5Cu30FF%5Cu3105-%5Cu312D%5Cu3131-%5Cu318E%5Cu31A0-%5Cu31BA%5Cu31F0-%5Cu31FF%5Cu3400-%5Cu4DB5%5Cu4E00-%5Cu9FCC%5CuA000-%5CuA48C%5CuA4D0-%5CuA4FD%5CuA500-%5CuA60C%5CuA610-%5CuA61F%5CuA62A%5CuA62B%5CuA640-%5CuA66E%5CuA67F-%5CuA697%5CuA6A0-%5CuA6E5%5CuA717-%5CuA71F%5CuA722-%5CuA788%5CuA78B-%5CuA78E%5CuA790-%5CuA793%5CuA7A0-%5CuA7AA%5CuA7F8-%5CuA801%5CuA803-%5CuA805%5CuA807-%5CuA80A%5CuA80C-%5CuA822%5CuA840-%5CuA873%5CuA882-%5CuA8B3%5CuA8F2-%5CuA8F7%5CuA8FB%5CuA90A-%5CuA925%5CuA930-%5CuA946%5CuA960-%5CuA97C%5CuA984-%5CuA9B2%5CuA9CF%5CuAA00-%5CuAA28%5CuAA40-%5CuAA42%5CuAA44-%5CuAA4B%5CuAA60-%5CuAA76%5CuAA7A%5CuAA80-%5CuAAAF%5CuAAB1%5CuAAB5%5CuAAB6%5CuAAB9-%5CuAABD%5CuAAC0%5CuAAC2%5CuAADB-%5CuAADD%5CuAAE0-%5CuAAEA%5CuAAF2-%5CuAAF4%5CuAB01-%5CuAB06%5CuAB09-%5CuAB0E%5CuAB11-%5CuAB16%5CuAB20-%5CuAB26%5CuAB28-%5CuAB2E%5CuABC0-%5CuABE2%5CuAC00-%5CuD7A3%5CuD7B0-%5CuD7C6%5CuD7CB-%5CuD7FB%5CuF900-%5CuFA6D%5CuFA70-%5CuFAD9%5CuFB00-%5CuFB06%5CuFB13-%5CuFB17%5CuFB1D%5CuFB1F-%5CuFB28%5CuFB2A-%5CuFB36%5CuFB38-%5CuFB3C%5CuFB3E%5CuFB40%5CuFB41%5CuFB43%5CuFB44%5CuFB46-%5CuFBB1%5CuFBD3-%5CuFD3D%5CuFD50-%5CuFD8F%5CuFD92-%5CuFDC7%5CuFDF0-%5CuFDFB%5CuFE70-%5CuFE74%5CuFE76-%5CuFEFC%5CuFF21-%5CuFF3A%5CuFF41-%5CuFF5A%5CuFF66-%5CuFFBE%5CuFFC2-%5CuFFC7%5CuFFCA-%5CuFFCF%5CuFFD2-%5CuFFD7%5CuFFDA-%5CuFFDC");if("Safari"===rspkr.c.data.browser.name){var d=new RegExp("([.,?!])\\s*(?=["+c+"])","g");b=a.replace(d,"$1|").split("|")}else{var d=new RegExp("(?<=[^A-Z].[,.?]) +(?=["+c.toUpperCase()+"])","g");b=a.split(d)}return b},words:function(a){return a.split(/(\s+)/)}}}},highlight:function(a,b){if(a){var c=rspkr.Common.Settings.get("hl");if("none"!==c){var d=document.querySelector("#sync"+a),e=$rs.hasClass(d,"sync_sent");!e||"sent"!==c&&"wordsent"!==c||(!b&&rspkr.hl.css.sentOff(),rspkr.hl.css.sentOn(d),rspkr.hl.customHL.active()&&rspkr.hl.customHL.sentHL(d,b)),e||rspkr.hl.sentOnlyLang!==!1||"word"!==c&&"wordsent"!==c||(!b&&rspkr.hl.css.wordOff(),rspkr.hl.css.wordOn(d),rspkr.hl.customHL.active()&&rspkr.hl.customHL.wordHL(d,b)),d&&rspkr.hl.Scroll.execScroll(d)}}},postProcess:{lightCleanUp:function(){rspkr.c.data.selectedHTML="",rspkr.hl.css.sentOff(),rspkr.hl.css.wordOff()},settingsCleanUp:function(){this.lightCleanUp()},fullCleanUp:function(){if(this.lightCleanUp(),!rspkr.cfg.item("general.premarkup")){rspkr.c.dispatchEvent("onBeforeContentChange",window),$rs.removeClass(".tmp_skip","rs_skip"),$rs.removeClass(".tmp_skip","tmp_skip"),$rs.removeClass(".tmp_skip_always","rs_skip_always"),$rs.removeClass(".tmp_skip_always","tmp_skip_always");for(var a=document.querySelectorAll(".rs_textnode"),b=0;b<a.length;b++){var c=document.createTextNode(a[b].textContent);a[b].parentNode.replaceChild(c,a[b])}}}},sync:rspkr.HL.engine.gecko.clientExtension.sync.bind(rspkr.HL.engine.gecko)};return{clientExtension:a}}(),ReadSpeaker.q(function(){ReadSpeaker.HL.customHL=function(){var a,b,c,d=function(){return"enlargeon"===rspkr.st.get("enlarge")&&!rspkr.mobile()},e=function(d){a||(a=document.createElement("div"),a.id="rs_enlargeHL_box",a.className="unselectable","Explorer"===ReadSpeaker.c.data.browser.name&&ReadSpeaker.c.data.browser.version<8&&(a.className+=" rs_enlargeHL_legacy"),b=document.createElement("div"),b.id="rs_enlargeHL_box_content",c=document.createElement("div"),c.id="rs_enlargeHL_box_toolbar",c.innerHTML=m(),a.appendChild(c),a.appendChild(b),f(),j(),document.body.appendChild(a),n(),rspkr.evt("onUIPause",function(){$rs.removeClass(c,"rsplaying")}),rspkr.evt("onUIAfterPlay",function(){$rs.addClass(c,"rsplaying")}),rspkr.Lang.updateUi(a)),a.style.display="block",$rs.addClass($rs.findIn(a,"#rs_enlargeHL_box_toolbar"),"rsplaying")},f=function(){a&&($rs.css(a,{"z-index":rspkr.ui.utils.getMaxZ(),background:ReadSpeaker.Common.Settings.get("hlsent"),color:ReadSpeaker.Common.Settings.get("hltext")}),rspkr.hl.css.setRule("word","#rs_enlargeHL_box .sync_word.enlarge_word_highlighted","color: "+ReadSpeaker.Common.Settings.get("hltext")+"; background: "+ReadSpeaker.Common.Settings.get("hlword")))},g=function(c,d){var f=c.innerHTML;if(/\S/.test(f)){ReadSpeaker.log("_sentHL ("+d+"): "+f,5),e(),b.innerHTML=1===Number(d)?b.innerHTML+f:f;for(var g=ReadSpeaker.Common.data.browser.syncContainer,h=a.getElementsByTagName(g),i=0;i<h.length;i++)/^custom_/.test(h[i].id)||(h[i].id="custom_"+h[i].id)}},h=function(c,d){var f=c.innerHTML;if(/\S/.test(f)){ReadSpeaker.log("_wordHL ("+d+"): "+f,5),e(),1!==parseInt(d)&&rspkr.hl.css.wordOff($rs.findIn(a,".enlarge_word_highlighted"),"enlarge_word_highlighted");var i=$rs.findIn(a,"#custom_"+c.id);if($rs.isArray(i)){var j=c;if(c.innerHTML){for(;j.parentNode;){if(/\bsync_sent|ffsent/.test(j.parentNode.className))return ReadSpeaker.log("---> Remitting to _sentHL",5),g(j.parentNode),void h(c,d);j=j.parentNode}b.innerHTML=c.innerHTML,i=$rs.findIn(a,c.id).id="custom_"+c.id,h(c,d)}else b.innerHTML=f}else rspkr.hl.css.wordOn(i,"enlarge_word_highlighted")}},i=function(){a&&(a.style.display="none",b.innerHTML="")},j=function(){rspkr.hl.css.wordOff(),rspkr.hl.css.sentOff(),d()?(rspkr.hl.css.removeRule("word",".sync_word"),rspkr.hl.css.removeRule("word",".sync_word_highlighted"),rspkr.hl.css.removeRule("sent",".sync_sent"),rspkr.hl.css.setRule("sent",".sync_sent_highlighted","border: solid 1px Black; margin-left: -1px; margin-right: -1px;")):rspkr.HL.settings.setHL()},k=function(a){a=a?"enlargeon":"enlargeoff",rspkr.log("[rspkr.HL.customHL] "+a),(rspkr.st.get("enlarge")||"enlargeon"===a)&&rspkr.st.set("enlarge",a)},l=['<button class="rslightbox-tool rsicn rsicn-play small-icon rs-enlarge-play" data-rs-action="play" data-rslang="title/arialabel:pause"><span class="rsbtn_btnlabel" data-rslang="content:pause"></span></button>','<button class="rslightbox-tool rsicn rsicn-stop small-icon rs-enlarge-stop" data-rs-action="stop" data-rslang="title/arialabel:stop"><span class="rsbtn_btnlabel" data-rslang="content:stop"></span></button>','<div class="toolbar-group">','	<button class="rslightbox-tool rsicn rsicn-font-plus rs-enlarge-plus" accesskey="+" data-rs-action="fontplus" data-rslang="title/arialabel:fontsizeplus"><span class="rsbtn_btnlabel" data-rslang="content:fontsizeplus"></span></button>','	<button class="rslightbox-tool rsicn rsicn-font-minus rs-enlarge-minus" accesskey="-" data-rs-action="fontminus" data-rslang="title/arialabel:fontsizeminus"><span class="rsbtn_btnlabel" data-rslang="content:fontsizeminus"></span></button>',"</div>"],m=function(){return l.join("\n")},n=function(){$rs.regEvent($rs.findIn(c,".rslightbox-tool.rs-enlarge-play"),"click",o),$rs.regEvent($rs.findIn(c,".rslightbox-tool.rs-enlarge-stop"),"click",r),$rs.regEvent($rs.findIn(c,".rslightbox-tool.rs-enlarge-plus"),"click",s.toolbarClick),$rs.regEvent($rs.findIn(c,".rslightbox-tool.rs-enlarge-minus"),"click",s.toolbarClick)},o=function(b){$rs.hasClass(c,"rsplaying")?q():p(),rspkr.Lang.updateUi(a)},p=function(){$rs.addClass(c,"rsplaying"),rspkr.u.getActivePlayer().play();var a=$rs.findIn(c,".rs-enlarge-play");a.setAttribute("data-rslang","title/arialabel:pause"),$rs.findIn(a,".rsbtn_btnlabel").setAttribute("data-rslang","content:pause")},q=function(){$rs.removeClass(c,"rsplaying"),rspkr.u.getActivePlayer().pause();var a=$rs.findIn(c,".rs-enlarge-play");a.setAttribute("data-rslang","title/arialabel:resume"),$rs.findIn(a,".rsbtn_btnlabel").setAttribute("data-rslang","content:resume")},r=function(a){$rs.removeClass(c,"rsplaying"),rspkr.u.getActivePlayer().stop()},s={min:function(){return rspkr.cfg.item("general.fontSizes.enlarge.min")||20},max:function(){return rspkr.cfg.item("general.fontSizes.enlarge.max")||100},increment:function(){return rspkr.cfg.item("general.fontSizes.enlarge.increment")||4},toolbarClick:function(a){var b=$rs.getAttr(this,"data-rs-action");"string"==typeof b&&b.length&&s.toolbar[b]&&"function"==typeof s.toolbar[b]&&s.toolbar[b].apply(this,[a])},getFontSize:function(){var a=parseInt($rs.css(b,"font-size"));return isNaN(a)&&(a=50),a},setFontSize:function(a){var c=parseInt(Math.round(100*a)/100);$rs.css(b,"font-size",c+"px"),$rs.css(b,"line-height",1.4*c+"px")},toolbar:{fontplus:function(){var a=s.getFontSize();a<s.max()&&s.setFontSize(a+=s.increment())},fontminus:function(){var a=s.getFontSize();a>s.min()&&s.setFontSize(a-=s.increment())}}};return ReadSpeaker.c.addEvent("onSettingsChanged",function(){f(),d()||i(),j()}),{active:d,sentHL:g,wordHL:h,cleanUp:i,enlarge:k}}()}),ReadSpeaker.q(function(){rspkr.HL.customHL.active()||rspkr.HL.customHL.enlarge(!1)}),ReadSpeaker.ui=function(){var a={revision:"1476"},b=null,c=[],d="",e={ui:{rsbtnClass:"rsbtn",progressHandleClass:"rsbtn_progress_handle rsimg",progressDir:"h",volumeHandleClass:"rsbtn_volume_handle rsimg",volumeDir:"v",settingsListenButton:!0,player:['	<span class="rsbtn_exp_inner">','		<button type="button" class="rsbtn_pause rsbtn_player_item" title="Pause"><i class="rsicn rsicn-pause" aria-hidden="true"></i><span class="rsbtn_btnlabel">Pause</span></button>','		<button type="button" class="rsbtn_stop rsbtn_player_item" title="Stop"><i class="rsicn rsicn-stop" aria-hidden="true"></i><span class="rsbtn_btnlabel">Stop</span></button>','		<span class="rsbtn_progress_container rsbtn_player_item rsloading">','			<span class="rsbtn_progress_played"></span>',"		</span>",'		<button type="button" class="rsbtn_volume rsbtn_player_item" title="Volume" aria-expanded="false"><i class="rsicn rsicn-volume" aria-hidden="true"></i><span class="rsbtn_btnlabel">Volume</span></button>','		<span class="rsbtn_volume_container">','			<span class="rsbtn_volume_slider"></span>',"		</span>",'		<button type="button" class="rsbtn_dl rsbtn_player_item" title="Download MP3"><i class="rsicn rsicn-download" aria-hidden="true"></i><span class="rsbtn_btnlabel">Download mp3</span></button>','		<button type="button" class="rsbtn_closer rsbtn_player_item" title="Close Player"><i class="rsicn rsicn-cross" aria-hidden="true"></i><span class="rsbtn_btnlabel">Close</span></button>',"	</span>"],
player31:['<span class="rsbtn_exp_inner">','	<button type="button" class="rsbtn_pause rsbtn_player_item" data-rslang="title/arialabel:pause"><span class="rsicn rsicn-pause" aria-hidden="true"></span><span class="rsbtn_btnlabel" data-rslang="content:pause"></span></button>','	<button type="button" class="rsbtn_stop rsbtn_player_item" data-rslang="title/arialabel:stop"><span class="rsicn rsicn-stop" aria-hidden="true"></span><span class="rsbtn_btnlabel" data-rslang="content:stop"></span></button>','	<span class="rsbtn_progress_container rsbtn_player_item rsloading">','		<span class="rsbtn_progress_played"></span>',"	</span>",'	<button type="button" class="rsbtn_rewind rsbtn_player_item" data-rslang="title/arialabel:skipbackwards" data-rslangfilter="skipBtns"><span class="rsicn rsicn-backward2" aria-hidden="true"></span><span class="rsbtn_btnlabel" data-rslang="content:skipbackwards" data-rslangfilter="skipBtns"></span></button>','	<button type="button" class="rsbtn_forward rsbtn_player_item" data-rslang="title/arialabel:skipforwards" data-rslangfilter="skipBtns"><span class="rsicn rsicn-forward3" aria-hidden="true"></span><span class="rsbtn_btnlabel" data-rslang="content:skipforwards" data-rslangfilter="skipBtns"></span></button>','	<button type="button" class="rsbtn_volume rsbtn_player_item" aria-expanded="false" data-rslang="title/arialabel:volume"><span class="rsicn rsicn-volume" aria-hidden="true" aria-haspopup="true"></span><span class="rsbtn_btnlabel" data-rslang="content:volume"></span></button>','	<span class="rsbtn_volume_container rsbtn_dropdown">','		<span class="rsbtn_volume_slider rsbtn_slider"></span>',"	</span>",'	<button type="button" class="rsbtn_speed rsbtn_player_item" aria-expanded="false" aria-haspopup="true" data-rslang="title/arialabel:speed"><span class="rsicn rsicn-meter"></span><span class="rsbtn_btnlabel" data-rslang="content:speed"></span></button>','	<span class="rsbtn_speed_container rsbtn_dropdown">','		<span class="rsbtn_speed_slider rsbtn_slider"></span>',"	</span>",'	<button type="button" class="rsbtn_dl rsbtn_player_item" title="Download MP3" data-rslang="title/arialabel:download"><span class="rsicn rsicn-download" aria-hidden="true"></span><span class="rsbtn_btnlabel" data-rslang="content:download"></span></button>','	<button type="button" class="rsbtn_closer rsbtn_player_item" data-rslang="title/arialabel:closeplayer"><span class="rsicn rsicn-cross" aria-hidden="true"></span><span class="rsbtn_btnlabel" data-rslang="content:closeplayer"></span></button>',"</span>"],listenBtn:['<div id="readspeaker_button_settings" class="rs_skip rsbtn rs_preserve readspeaker_button_settings rs_notools">','	<a class="rsbtn_play" href="">','		<span class="rsbtn_left rsimg rspart">','			<span class="rsbtn_text">',"				<span>rsLISTENrs</span>","			</span>","		</span>",'		<span class="rsbtn_right rsimg rsplay rspart"></span>',"	</a>","</div>"],toolpanel:['<div class="rsbtn_toolpanel">','	<div class="rsbtn_tools">','		<div class="rsbtn_tools_inner">','			<span class="rsbtn_powered rsimg"><span class="rsbtn_btnlabel">ph_speechenabled</span></span>','			<div class="rsbtn_toolcontainer">','				<ul class="rsbtn_toollist">','					<li class="rsbtn_tool_settings"><button type="button" class="rsbtn_tool first-child" title="ph_settings" data-rs-tool="settings"><i class="rsicn rsicn-cogs" aria-hidden="true" aria-haspopup="dialog"></i><span class="rsbtn_btnlabel">ph_settings</span></button></li>','					<li class="rsbtn_tool_voice_settings"><button type="button" class="rsbtn_tool" title="ph_readinglanguage" data-rs-tool="voicesettings" aria-haspopup="true"><i class="rsicn rsicn-voice-settings" aria-hidden="true"></i><span class="rsbtn_btnlabel">ph_readinglanguage</span></button></li>','					<li class="rsbtn_tool_read_hover"><button type="button" class="rsbtn_tool" title="ph_readonhover" data-rs-tool="readhover"><i class="rsicn rsicn-read-hover" aria-hidden="true"></i><span class="rsbtn_btnlabel">ph_readonhover</span></button></li>','					<li class="rsbtn_tool_enlarge"><button type="button" class="rsbtn_tool" title="ph_enlargetext" data-rs-tool="enlarge"><i class="rsicn rsicn-enlarged-text" aria-hidden="true"></i><span class="rsbtn_btnlabel">ph_enlargetext</span></button></li>','					<li class="rsbtn_tool_simple_view"><button type="button" class="rsbtn_tool" title="ph_simpleview" data-rs-tool="simpleview" aria-haspopup="dialog"><i class="rsicn rsicn-pop-out" aria-hidden="true"></i><span class="rsbtn_btnlabel">ph_simpleview</span></button></li>','					<li class="rsbtn_tool_pagemask"><button type="button" class="rsbtn_tool" title="ph_pagemask" data-rs-tool="pagemask"><i class="rsicn rsicn-pagemask" aria-hidden="true"></i><span class="rsbtn_btnlabel">ph_pagemask</span></button></li>','					<li class="rsbtn_tool_translate"><button type="button" class="rsbtn_tool" title="ph_translation" data-rs-tool="translation" aria-haspopup="true" aria-haspopup="dialog"><i class="rsicn rsicn-translate" aria-hidden="true"></i><span class="rsbtn_btnlabel">ph_translation</span></button></li>','					<li class="rsbtn_tool_dict"><button type="button" class="rsbtn_tool" title="ph_wordlookup" data-rs-tool="lookup"><i class="rsicn rsicn-book" aria-hidden="true" aria-haspopup="dialog"></i><span class="rsbtn_btnlabel">ph_wordlookup</span></button></li>','					<li class="rsbtn_tool_help"><button type="button" class="rsbtn_tool last-child" title="ph_help" data-rs-tool="help" aria-haspopup="dialog"><i class="rsicn rsicn-help" aria-hidden="true"></i><span class="rsbtn_btnlabel">ph_help</span></button></li>',"				</ul>","			</div>","		</div>","	</div>","</div>"],toolpanel31:['<div class="rsbtn_toolpanel">','	<div class="rsbtn_tools">','		<div class="rsbtn_tools_inner">','			<span class="rsbtn_powered rsimg">','				<span class="rsbtn_btnlabel" data-rslang="title/arialabel:speechenabled,content:speechenabled" data-rslangfilter="content:speechEnabledLink,title/arialabel:speechEnabledTitle"></span>',"			</span>",'			<div class="rsbtn_toolcontainer">','				<ul class="rsbtn_toollist">','					<li class="rsbtn_tool_settings"><button type="button" class="rsbtn_tool first-child" data-rslang="title/arialabel:settings" data-rs-tool="settings" data-rs-tooltip="." aria-haspopup="dialog"><span class="rsicn rsicn-cogs" aria-hidden="true"></span><span class="rsbtn_btnlabel" data-rslang="content:settings"></span></button></li>','					<li class="rsbtn_tool_voice_settings"><button type="button" class="rsbtn_tool" data-rslang="title/arialabel:readinglanguage" data-rs-tool="voicesettings" aria-haspopup="true" data-rs-tooltip="."><span class="rsicn rsicn-voice-settings" aria-hidden="true"></span><span class="rsbtn_btnlabel" data-rslang="content:readinglanguage"></span></button></li>','					<li class="rsbtn_tool_read_hover"><button type="button" class="rsbtn_tool" data-rslang="title/arialabel:readonhover" data-rs-tool="readhover" data-rs-tooltip="."><span class="rsicn rsicn-read-hover" aria-hidden="true"></span><span class="rsbtn_btnlabel" data-rslang="content:readonhover"></span></button></li>','					<li class="rsbtn_tool_enlarge"><button type="button" class="rsbtn_tool" data-rslang="title/arialabel:enlargetext" data-rs-tool="enlarge" data-rs-tooltip="."><span class="rsicn rsicn-enlarged-text" aria-hidden="true"></span><span class="rsbtn_btnlabel" data-rslang="content:enlargetext"></span></button></li>','					<li class="rsbtn_tool_text_mode"><button type="button" class="rsbtn_tool" data-rslang="title/arialabel:textmode" data-rs-tool="textmode" data-rs-tooltip="." aria-haspopup="dialog"><span class="rsicn rsicn-pop-out" aria-hidden="true"></span><span class="rsbtn_btnlabel" data-rslang="content:textmode"></span></button></li>','					<li class="rsbtn_tool_pagemask"><button type="button" class="rsbtn_tool" data-rslang="title/arialabel:pagemask" data-rs-tool="pagemask" data-rs-tooltip="."><span class="rsicn rsicn-pagemask" aria-hidden="true"></span><span class="rsbtn_btnlabel" data-rslang="content:pagemask"></span></button></li>','					<li class="rsbtn_tool_translate"><button type="button" class="rsbtn_tool" data-rslang="title/arialabel:translation" data-rs-tool="translation" aria-haspopup="true" data-rs-tooltip="." data-rs-direction="url"><span class="rsicn rsicn-translate" aria-hidden="true"></span><span class="rsbtn_btnlabel" data-rslang="content:translation"></span></button></li>','					<li class="rsbtn_tool_dict"><button type="button" class="rsbtn_tool" data-rslang="title/arialabel:dictionary" data-rs-tool="dictionary" data-rs-tooltip="." aria-haspopup="dialog"><span class="rsicn rsicn-book" aria-hidden="true"></span><span class="rsbtn_btnlabel" data-rslang="content:dictionary"></span></button></li>','					<li class="rsbtn_tool_download"><button type="button" class="rsbtn_tool" data-rslang="title/arialabel:download" data-rs-tool="download" data-rs-tooltip="." aria-haspopup="dialog"><span class="rsicn rsicn-download" aria-hidden="true"></span><span class="rsbtn_btnlabel" data-rslang="content:download"></span></button></li>','					<li class="rsbtn_tool_help"><button type="button" class="rsbtn_tool last-child" data-rslang="title/arialabel:help" data-rs-tool="help" data-rs-tooltip="." aria-haspopup="dialog"><span class="rsicn rsicn-help" aria-hidden="true"></span><span class="rsbtn_btnlabel" data-rslang="content:help"></span></button></li>',"				</ul>","			</div>","		</div>","	</div>","</div>"],settings:{form:['<div id="rsform_wrapper" dir="ltr">','	<h1 class="rs_preserve">rsSETTINGS_HEADINGrs</h1>','	<form id="rssettings_form" class="rsform rs_preserve">',"		rsSECTIONS_STARTrs","		rsSECTIONSrs","		rsSECTIONS_ENDrs","	</form>","</div>"],formsection:['<fieldset id="rsSECTION_IDrs" class="rsform-section" rsCONTROL_ARIAHIDDENrs>',"	<legend>rsSECTION_HEADINGrs</legend>","	rsSECTION_ROWSrs","</fieldset>"],formrow:['	<div class="rsform-row rsCONTROL_CLASSESrs" id="rscontrol_rsCONTROL_IDrs" data-rsform-type="rsCONTROL_TYPErs" rsCONTROL_ARIAHIDDENrs>',"		rsINFOTOGGLERrs","		rsCONTROLrs","	</div>"],formbuttons:['		<a class="rssettings-button-close rsdialog-button" href="javascript:void(0);" title="rsSETTINGS_BUTTON_CLOSE_DIALOGrs" role="button">rsSETTINGS_BUTTON_CLOSErs</a>']},overlay:{overlayStyles:["position: absolute","top: 0","left: 0","bottom: 0","width: 100%","background-color: #fff","opacity: 0.7","filter: alpha(opacity=50)","z-index: 1001"],contentStyles:["position: fixed","width: 700px","height: 700px","z-index: 10002","display: block"],contentTemplate:['<div id="rslightbox_toolbar"></div>','<div id="rslightbox_closer_container">','	<a id="rslightbox_fullscreen" href="javascript:void(0);" data-rslang="title/arialabel:fullscreen" role="button" tabIndex="0"><span class="rsbtn_btnlabel" data-rslang="content:fullscreen"></span></a>','	<a id="rslightbox_closer" href="javascript:void(0);" data-rslang="title/arialabel:closedialog" role="button" tabIndex="0"><span class="rsbtn_btnlabel" data-rslang="content:closedialog"></span></a>',"</div>",'<div id="rs_lightboxplayer" class="rshidden rs_preserve rs_skip"></div>','<div id="rslightbox_content"></div>','<div id="rslightbox_dragbar"></div>','<div id="rslightbox_resizer"></div>','<div id="rslightbox_buttons" class="rsform-buttons"></div>','<div id="rslightbox_logo" class="rsimg"></div>']},dldialog:['<div id="rslightbox_content_inner">','	<div class="rsdl_textwrapper">',"		<h2>rsTERMS_OF_USE_HEADINGrs</h2>","		rsTERMS_OF_USE_BODYrs","	</div>","</div>"],dlbuttons:['		<a id="rsdl_button_accept" class="rsdialog-button" href="javascript:void(0);" title="rsTERMS_OF_USE_ACCEPTrs" role="button">rsTERMS_OF_USE_ACCEPTrs</a>','		<a id="rsdl_button_decline" class="rsdialog-button" href="javascript:void(0);" title="rsTERMS_OF_USE_DECLINErs" role="button">rsTERMS_OF_USE_DECLINErs</a>']}},f=function(){return b},g=function(a){a instanceof Object&&"function"==typeof a.getContainer&&(b=a)},h=function(a){function b(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return JSON.stringify(a)===JSON.stringify({})}var c=window.navigator.userAgent,a=a||0;if((-1!==c.indexOf("MSIE ")||-1!==c.indexOf("Trident/")||-1!==c.indexOf("Edge/"))&&"complete"!==document.readyState&&10>a)return void setTimeout(function(){h(a+1,50)});rspkr.log("[rspkr.ui] Attempting to add click events.");var d=$rs.get(".rsbtn."+rspkr.ui.rsbtnClass+" .rsbtn_play"),e=null;$rs.isArray(d)||(d=[d]);for(var f=0,g=d.length;g>f;f++)if($rs.unregEvent(d[f],"click",ReadSpeakerDefer.clickhandler),e=d[f]?$rs.getAttr(d[f],"data-rsevent-id"):"_bogus_",$rs.addClass($rs.findIn(d[f],".rsbtn_left .rsbtn_text span"),"rsbtn_label"),d[f].href&&d[f].href.indexOf("?")>-1&&b(rspkr.c.data.params)&&(rspkr.c.data.setParams(d[f].href),rspkr.c.data.getParam("uilang")&&rspkr.cfg.item("general.uiLang",rspkr.c.data.getParam("uilang"))),rspkr.l.f.eq.store[e]&&rspkr.l.f.eq.store[e].click)rspkr.log("[rspkr.ui] Click event already existed on "+d[f],2);else{$rs.regEvent(d[f],"click",function(a){rspkr.preventDefault(a),window.readpage(this,null,{isClick:!0})}),rspkr.ui.addFocusHandler(d[f],!0,d[f].parentNode),rspkr.log("[rspkr.ui] Added click event to: "+d[f],1);try{$rs.getAttr(d[f],"role")||$rs.setAttr(d[f],"role","button")}catch(i){rspkr.log("[rspkr.ui] Could not add role attribute.",2)}}rspkr.tools&&rspkr.tools.toggler&&rspkr.tools.toggler.add(),rspkr.ui.Detach&&rspkr.ui.Detach.init()},i=function(a){var b=$rs.arr("a");a=a.replace(/https?:/gi,"");for(var c=0,d=b.length;d>c;c++)if(b[c].href&&"string"==typeof b[c].href&&b[c].href.replace(/https?:/gi,"")===a)return b[c];return!1},j=function(a){a=a||rspkr.getRSBtns()[0];for(var b in c)if(c[b]&&c[b].getContainer&&c[b].getContainer()===a)return c[b];var d=rspkr.mobile()?new rspkr.Mobile.ui.Player(a):new rspkr.ui.Player(a);return c.push(d),d},k=function(){if(rspkr.log("[rspkr.ui] Initiating global callbacks"),rspkr.ui.rsbtnClass="default"===rspkr.skin?"rsbtn":rspkr.skin.toLowerCase(),window.readpage=function(a,b,c){if(c=c||{},rspkr.cfg.item("ui.preventPlaybackFocus",!0),!rspkr.requestBlocker.isEnabled()){if(!rspkr.mobile()){if((!a||$rs.isArray(a))&&(a=rspkr.findHref()),!a)return rspkr.log("[readpage] No valid href to call to server",3),!1;a&&b&&"lightbox"!==c.source&&!rspkr.cfg.item("general.popupHref")&&rspkr.cfg.item("general.popupHref",a)}if(a.nodeType&&$rs.closest(a,".rsloading")&&rspkr.ui.getActivePlayer())return;if(rspkr.ui.initrun)return c.isClick===!0&&rspkr.createAudio(),"webAudio"!==rspkr.pl.adapter||c.source||(c.source="fullpage",c.noCleanUp=!0),rspkr.ui.showPlayer(a,b,c),!0}var d=rspkr.requestBlocker.getReason();return d&&window.alert(d),rspkr.log("[rspkr.ui] The player is being blocked."),!1},window.rshlexit=function(a){rspkr.HL.chunking.destroy(),(void 0===a||"false"===a)&&b.stop(),rspkr.c.dispatchEvent("onBeforeSyncExit",window),setTimeout(function(){rspkr.c.dispatchEvent("onAfterSyncExit",window)},1e3)},window.rshlinit=w().sync.init,window.rshlsetContent=w().sync.setContent,window.rshlsetId=w().sync.setId,window.rshlsync=function(a,b){for(var c=a.split(","),d=b.split(","),e=0,f=a.length;f>e;e++)w().sync.execute(c[e],d[e])},window.rshlcontinue=function(){function a(a){if(!rspkr.HL.chunking.entracte.src){var b=encodeURIComponent(decodeURIComponent(rs.Lang.getPhrase(a))),c={noads:1};for(var d in rspkr.c.data.params)rspkr.c.data.params.hasOwnProperty(d)&&(c[d]=rspkr.c.data.params[d]);var e=rspkr.Common.data.selectedText,f=rspkr.Common.data.selectedHTML;rspkr.Common.data.selectedText=b,rspkr.Common.data.selectedHTML="",c.text=b,c.output="audio";var g=rspkr.c.buildReadSpeakerCall(c);rspkr.HL.chunking.entracte.src=g,rspkr.Common.data.selectedText=e,rspkr.Common.data.selectedHTML=f}rspkr.HL.chunking.entracte.volume=parseFloat((rspkr.st.get("hlvol")||100)/100),rspkr.pl.playPromise(rspkr.HL.chunking.entracte)}if(rspkr.HL.chunking){rspkr.log("[rspkr.ui.rshlcontinue]",1),rspkr.HL.chunking.chunkEnded=!0;var b,c=rspkr.HL.html5.synclist[rspkr.HL.html5.synclist.length-2][2];if(lastSyncContainer=$rs.get(".sync_word_highlighted"),$rs.isArray(lastSyncContainer)&&(lastSyncContainer=$rs.get("#sync"+c)),$rs.isArray(lastSyncContainer)&&!lastSyncContainer.length){var d=0;document.body&&document.body.scrollTop?d=document.body.scrollTop:document.documentElement&&document.documentElement.scrollTop?d=document.documentElement.scrollTop:window.pageYOffset&&(d=window.pageYOffset),b={left:rs.ui.viewport.width/2,top:rs.ui.viewport.height/2+d}}else b=$rs.offset(lastSyncContainer);if(!rspkr.HL.chunking.continueHref)return void rspkr.log("[rshlcontinue] No continue href found!",3);var e=rspkr.cfg.item("cb.chunking.pause",void 0,!0);if("-1"===String(rspkr.HL.chunking.continueTime))if(rspkr.log("[rspkr.ui.rshlcontinue] Waiting for user interaction",1),rs.ui.getActivePlayer().pause(),$rs.addClass(rspkr.ui.getActivePlayer().getContainer(),"rsautopaused"),a("chunkcontinue"),e&&"function"==typeof e)rspkr.log("[rspkr.ui.rshlcontinue] Running custom callback",1),e();else{rspkr.log("[rspkr.ui.rshlcontinue] Showing default continue button",1);var f=document.createElement("div");f.innerHTML="<span>"+rspkr.Lang.getPhrase("chunkbutton")+"</span>",$rs.addClass(f,rspkr.ui.rsbtnClass+" rspopup rsresume"),$rs.regEvent(f,"click",function(a){rspkr.c.dispatchEvent("onChunkResume",window)}),document.body.appendChild(f),f.style.display="block",b.left+=15;var g=b.left+$rs.width(f)-$rs.width(window);g>0&&(b.left-=g),f.style.left=b.left+"px",f.style.top=b.top+15+"px"}else if("0"===String(rspkr.HL.chunking.continueTime))rspkr.log("[rspkr.ui.rshlcontinue] Autoplay",1),rspkr.c.dispatchEvent("onChunkResume",window);else{if(isNaN(rspkr.HL.chunking.continueTime))return void rspkr.log("[rspkr.ui.rshlcontinue] Invalid time parameter!",3);rspkr.log("[rspkr.ui.rshlcontinue] Autoplay with "+rspkr.HL.chunking.continueTime+" seconds delay",1),rspkr.HL.chunking.continueTime>=5&&a("chunkwait"),e&&"function"==typeof e&&e(rspkr.HL.chunking.continueTime),rspkr.HL.chunking.stall=!0,setTimeout(function(){rspkr.HL.chunking.stall=!1},1e3*rspkr.HL.chunking.continueTime),rspkr.HL.chunking.timer=setTimeout(function(){rspkr.c.dispatchEvent("onChunkResume",window)},1e3*rspkr.HL.chunking.continueTime)}}},rspkr.mobile())$rs.regEvent(document.body,"touchstart",function(a){return rspkr.ui.setPointerPos(a),!0}),$rs.regEvent(document.body,"touchend",function(a){return rspkr.ui.setPointerPos(a),rspkr.c.data.setSelectedText(a),!0}),$rs.regEvent(document,"selectionchange",function(a){return rspkr.c.data.setSelectedText(a),!0});else{if($rs.regEvent(document.body,"mousedown",function(a){return rspkr.ui.setPointerPos(a),!0}),document.addEventListener("mouseup",function(a){"opera"===rspkr.c.data.browser.name.toLowerCase()?setTimeout(function(){rspkr.c.data.setSelectedText(a)},50):rspkr.c.data.setSelectedText(a)}),"complete"===document.readyState||"loaded"===document.readyState){var a=$rs.getReadingFrames();a.forEach(function(a){try{a.document.addEventListener("mouseup",function(a){setTimeout(function(){rspkr.c.data.setSelectedText(a)},150)})}catch(b){}})}else document.addEventListener("readystatechange",function(a){if("complete"===a.target.readyState||"loaded"===a.target.readyState){var b=$rs.getReadingFrames();b.forEach(function(a){try{a.document.addEventListener("mouseup",function(a){setTimeout(function(){rspkr.c.data.setSelectedText(a)},150)})}catch(b){}})}});$rs.regEvent(document.body,"keydown",rspkr.ui.setPointerPos),$rs.regEvent(document.body,"keyup",function(a){return rspkr.c.data.setSelectedText(a),!0})}},l=function(){if(document.removeEventListener?document.removeEventListener("click",window.ReadSpeakerDefer.clickhandler,!1):document.detachEvent&&document.detachEvent("onclick",window.ReadSpeakerDefer.clickhandler),ReadSpeakerDefer.deferred){var a=ReadSpeakerDefer.deferred,b=null;if(a.tagName&&"a"!==a.tagName.toLowerCase()){for(b=a;"body"!==b.tagName.toLowerCase()&&(b=b.parentNode,"a"!==b.tagName.toLowerCase()););a=b}a.href?(rspkr.log('[rspkr.ui] Activating deferred readpage: readpage("'+a.href+"\", '"+a.target+"')"),rspkr.ui.showPlayer(a.href,a.target,a.options)):ReadSpeakerDefer.isRSLink(a)&&(rspkr.log("[rspkr.ui] Activating deferred element: "+a),$rs.removeClass(a.parentNode,"rsdeferred"),rspkr.ui.showPlayer(a)),ReadSpeakerDefer.deferred=null}},m=function(a,c,d){rspkr.log("[rspkr.ui.showPlayer]"),rspkr.popup&&rspkr.popup.closePopup(),$rs.removeClass($rs.arr(".rs_textselection"),"rs_textselection");var e="string"==typeof a?i(a):a,f=e?$rs.closest(e,".rsexpanded"):void 0;if(f=$rs.hasClass(f,"pre-expanded")?void 0:f,(rspkr.pl.playerRef||rspkr.audio&&"suspended"!==rspkr.audio.state)&&f&&!$rs.isArray(f)&&rspkr.ui.getActivePlayer()&&1===rspkr.HL.chunking.currentChunkNumber&&rspkr.ui.getActivePlayer().getContainer()===f&&!rspkr.popup.newTextSelected())return rspkr.log("Player already active, calling Player.restart() instead"),rspkr.Common.Player.setStateClass(rspkr.ui.getActivePlayer().getContainer(),"rsloading"),void rspkr.ui.getActivePlayer().restart();d&&d.noCleanUp&&d.noCleanUp===!0||rspkr.c.data.selectedText.length||rspkr.c.data.selectedHTML.length||rspkr.HL.sync.fullCleanUp(),rspkr.HL.sync.lightCleanUp(),rspkr.pl.releaseAdapter(),rspkr.HL.chunking.destroy(),rspkr.HL.chunking.html5support&&!rspkr.HL.chunking.entracte&&(rspkr.HL.chunking.entracte=rs.audio?rs.audio:new Audio,(rspkr.mobile()||/safari/i.test(window.navigator.userAgent))&&rspkr.pl.playPromise(rspkr.HL.chunking.entracte,void 0,void 0,!0)),rspkr.c.dispatchEvent("onBeforeParamsSet",window,[e]);var g="string"==typeof a?a:$rs.getAttr(e,"href"),h=null,k=document.createElement("a");if(g&&"string"==typeof g&&(k.href=g,g=k.href),rspkr.c.data.selectedHTML="",rspkr.c.data.setParams(g),$rs.getAttr(e,"data-target")){var l=$rs.getAttr(e,"data-target"),m=$rs.get(l);"object"==typeof m&&(c=m)}c?(h=$rs.get(c),$rs.addClass(h,rspkr.ui.rsbtnClass+" rsfloating")):h=$rs.closest(e,"div."+rspkr.ui.rsbtnClass);var n=j(h);if((b&&b!==n||b&&g!==b.getHref())&&(b.close(!0),rspkr.c.dispatchEvent("onUIClosePlayer",b.getContainer(),[rspkr.c.data.selectedText.length?"textsel":"nosel"])),"string"==typeof a&&rspkr.hl.engine.useTextNodeMarkup===!1){var o=g.match(/readid=[^&]+/gi),p=g.match(/readclass=[^&]+/gi);o&&o.length&&rspkr.HL.Restore.Storage.readId.push(o[0].replace("readid=","").split(",")),p&&p.length&&rspkr.HL.Restore.Storage.readClass.push(p[0].replace("readclass=","").split(","))}var q=b,r=q?q.getID():null;return rspkr.c.dispatchEvent("onUIShowPlayer",window,[r,n.getID()]),n.setHref(g),b=n,n.show(!1,d),b},n=function(a,b,c){c=c||a,void 0===b&&(b=!0),$rs.focusIn&&"function"==typeof $rs.focusIn&&($rs.focusIn(a,function(){p(c),b===!0&&(o=a),rspkr.Common.dispatchEvent("onFocusIn",window,[a,c])}),$rs.focusOut(a,function(){q(c),rspkr.Common.dispatchEvent("onFocusOut",window,[a,c])}))},o=null,p=function(a){$rs.addClass(a,"rsfocus")},q=function(a){$rs.removeClass(a,"rsfocus")},r=function(){!rspkr.cfg.item("ui.preventPlaybackFocus")&&o&&$rs.isVisible(o)&&-1!==o.tabIndex&&(rspkr.log("[rspkr.ui.updateFocus] "+o.outerHTML),s(o))},s=function(a){$rs.focus&&"function"==typeof $rs.focus&&a&&$rs.focus(a)},t={update:function(a,c,d){"hlspeed"===a&&c!==d&&(0===c&&(c=5,rspkr.st.set("hlspeed",c)),a=a.replace("hl",""),rspkr.c.converter[a]&&"function"==typeof rspkr.c.converter[a]&&(c=rspkr.c.converter[a](c)),rspkr.c.data[a]=c,b&&b.stop(),rspkr.pl.releaseAdapter())}},u=function(a,b,c,d,e,f){$rs.css(a,"background-color","rgb("+b+","+c+","+d+")"),e>d?(d+=10,window.setTimeout(function(){u(a,b,c,d,e,f)},50)):f&&"function"==typeof f&&f.apply(a,[])},v={INTERVAL:null,STEPS:25,scrollToElm:function(a){$rs.isVisible(a)&&this.initScroll(a)},scrollToAnchor:function(a){for(var b=a,c=$rs.get("a"),d=null,e=0;e<c.length;e++){var f=c[e];if(f.name&&f.name===b){d=f;break}}this.initScroll(d)},initScroll:function(a){if(!a)return void(document.location.hash=a);if(rspkr.item("ui.elementAutoScroll"))for(var b=a.parentElement;b!==document.body;){if(b.scrollHeight>b.clientHeight){var c="Explorer"==rspkr.c.data.browser.name&&rspkr.c.data.browser.version<=7,d=c?a.offsetTop:a.offsetTop-b.offsetTop;c?a.offsetLeft:a.offsetLeft-b.offsetLeft;if(b.scrollTop>d||d+a.offsetHeight>b.clientHeight){var e,f=b.scrollTop,g=d-f;if(window.requestAnimationFrame){var h=1e3;window.requestAnimationFrame(function r(a){e||(e=a);var c=a-e,d=Math.min(c/h,1);b.scrollTop=f+g*d,h>c&&window.requestAnimationFrame(r)})}else{clearInterval(rspkr.u.scroll.INTERVAL);var i=b.scrollTop,j=d-i,k=j/rspkr.u.scroll.STEPS,l=0;rspkr.u.scroll.INTERVAL=setInterval(function(){b.scrollTop=i+l*k,l++,l>=rspkr.u.scroll.STEPS&&(b.scrollTop=d,clearInterval(rspkr.u.scroll.INTERVAL))},10)}}if(!(b.clientHeight<$rs.height(window)))break;return void rspkr.u.scroll.scrollToElm(b)}b=b.parentElement}for(var m=a.offsetLeft,n=a.offsetTop,o=a;o.offsetParent&&o.offsetParent!==document.body;)o=o.offsetParent,m+=o.offsetLeft,n+=o.offsetTop;n-=200,rs.cfg.item("ui.autoscrollOffset")&&!isNaN(rs.cfg.item("ui.autoscrollOffset"))&&(n-=rs.cfg.item("ui.autoscrollOffset")),clearInterval(rspkr.u.scroll.INTERVAL);var p=rspkr.u.scroll.getCurrentYPos(),q=parseInt((n-p)/rspkr.u.scroll.STEPS);rspkr.u.scroll.INTERVAL=setInterval(function(){rspkr.u.scroll.scrollWindow(q,n,a)},10)},getCurrentYPos:function(){return document.body&&document.body.scrollTop?document.body.scrollTop:document.documentElement&&document.documentElement.scrollTop?document.documentElement.scrollTop:window.pageYOffset?window.pageYOffset:0},scrollWindow:function(a,b,c){var b=Math.max(b,0),d=rspkr.u.scroll.getCurrentYPos(),e=b>d;window.scrollTo(0,d+a);var f=rspkr.u.scroll.getCurrentYPos(),g=b>f;(e!==g||d===f||!e&&!g)&&(window.scrollTo(0,b),clearInterval(rspkr.u.scroll.INTERVAL),"string"==typeof c&&(location.hash=c),rspkr.ui.ScrollControls&&rspkr.ui.ScrollControls.check())}},w=function(){return rspkr.XP?rspkr.XP:rspkr.HL},x=function(a,b){"string"==typeof a&&(a=$rs.get(a)),$rs.isArray(a)||(a=[a]);for(var c=0;c<a.length;c++)rspkr.mobile()?j(a[c]).show(!0,{preventPlay:!0}):j(a[c]).show(!0),$rs.removeClass(a[c],"rsstopped rsplaying"),$rs.addClass(a[c],"rspaused"),b&&!rspkr.mobile()&&a[c].getElementsByClassName("rsbtn_play")[0].focus()},y=function(){var a=rs.cfg.item("ui.animate");if(a){var b,c=15,d=500;"object"==typeof a?(a.id&&(b=$rs.get(a.id)),a.count&&(c=a.count),a.interval&&(d=a.interval)):"string"==typeof a&&(b=$rs.get(a)),("boolean"==typeof a&&a||$rs.isArray(b)&&0===b.length||!b)&&(b=$rs.get("."+rs.ui.rsbtnClass)),$rs.isArray(b)||(b=[b]);var e=c,f=window.setInterval(function(){0===e&&($rs.removeClass(b,"rsanimate"),clearInterval(f)),e--%2===1?$rs.addClass(b,"rsanimate"):$rs.removeClass(b,"rsanimate")},d)}},z=function(){if(rspkr.cfg.item("ui.toolpanel31")&&rspkr.notools()!==!0){var a,b=rspkr.getRSBtns("rs_addtools"),c=$rs.createElm("div",{content:rspkr.cfg.item("ui.toolpanel31").join("\n")});rspkr.Lang.filters.speechEnabledLink=function(a,b){var c=$rs.createElm("div",{content:a}),d=c.querySelector("a");return d&&(d.href="https://www.readspeaker.com/?ref="+encodeURIComponent(document.location.href)),d&&d.setAttribute("target","_blank"),c.innerHTML},rspkr.Lang.filters.speechEnabledTitle=function(a,b){var c=$rs.createElm("div",{content:a+" (%nw)".replace("%nw",rspkr.Lang.getPhrase("newwindow",b))});return c.textContent};for(var d=0,e=b.length;e>d;d++)if(b[d]){if(!$rs.isArray($rs.findIn(b[d],".rsbtn_toolpanel"))&&$rs.findIn(b[d],".rsbtn_toolpanel").tagName)continue;a=c.childNodes[0].cloneNode(!0);for(var f=$rs.findIn(a,".rsbtn_toollist .rsbtn_tool"),g=0;g<f.length;g++){var h=$rs.getAttr(f[g],"data-rs-tool");"translation"===h&&(h="translation_toolbar"),"dictionary"===h&&(h="dictionary_toolbar"),rspkr.features[h]===!1&&f[g].parentNode.parentNode.removeChild(f[g].parentNode)}rspkr.item("ui.zIndexToolPanel")&&(a.style.zIndex=rspkr.item("ui.zIndexToolPanel")),b[d].appendChild(a),rspkr.Lang.updateUi(a),B.add(a)}return a}},A=function(){var a=null,b=function(b){a&&a.close(),a=b};return{add:b,getActive:function(){return a}}}(),B=function(){var a=[],b=function(b){a.push(b)},c=function(){for(var b=0,c=a.length;c>b;b++)rspkr.tools.close.apply(a[b],[])},d=function(){rspkr.cfg.mergeDefault(e)};return{init:d,add:b,closeAll:c}}(),C={maxZ:null,getMaxZ:function(a){if(null!==C.maxZ&&a!==!0)return C.maxZ;if(document.defaultView&&document.defaultView.getComputedStyle){for(var b,c=document.getElementsByTagName("*"),d=0,e=5e3,f=0,g=c.length;g>f&&e>f;f++)b=document.defaultView.getComputedStyle(c[f],null).getPropertyValue("z-index"),!isNaN(parseInt(b))&&parseInt(b)>d&&(d=parseInt(b));return C.maxZ=d}return C.maxZ=1e6},populatePhrases:function(a,b){var c,d,e=b||rs.Lang.getUiLang(),f={};if(c=a.match(/\[\[ph_[^\]]*\]\]/gi),c.length)for(var g=0,h=c.length;h>g;g++)d=c[g].replace("[[","").replace("]]",""),f[d]=rspkr.Lang.getPhrase(d.replace("ph_",""),e)||d.replace("ph_","");for(var i in f)f.hasOwnProperty(i)&&(a=a.replace(new RegExp("\\[\\["+i+"\\]\\]","gi"),f[i]));return a},isTouchDevice:function(){return"ontouchstart"in window||navigator.MaxTouchPoints>0||navigator.msMaxTouchPoints>0},playerInViewport:function(a){if(!a)var b=rspkr.ui.getActivePlayer(),a=b?b.getContainer():void 0;if(!a)return!1;var c=a.getBoundingClientRect();return c.top>0&&c.bottom<rspkr.ui.viewport.height&&c.left>0&&c.right<rspkr.ui.viewport.width}};return{meta:a,dependency:["pub.Config"],initrun:!1,init:function(){var a=rspkr.Common.addEvent;a("onAfterModsLoaded",k),a("onReady",[rspkr.tools.toggler.add,h,l,y]),a("onSettingsChanged",t.update),a("onAfterSyncInit",r),this.initrun=!0,rspkr.Common.dispatchEvent("onUIInitialized"),B.init(),rspkr.log("[rspkr.ui] Initialized!")},addFocusHandler:function(a,b,c){n(a,b,c)},focus:function(a){s(a)},updateFocus:function(){r()},settings:t,rsbtnClass:d,addClickEvents:function(){h()},addTools:z,initGlobalCallbacks:function(){k()},processDeferred:function(){l()},showPlayer:function(a,b,c){return m(a,b,c)},expand:function(a,b){x(a,b)},pointerX:0,pointerY:0,setPointerPos:function(a){return a.pageX&&(rspkr.ui.pointerX=a.pageX),a.pageY&&(rspkr.ui.pointerY=a.pageY),a.originalEvent&&a.originalEvent.touches&&a.originalEvent.touches[0]&&a.originalEvent.touches[0].pageX&&(rspkr.ui.pointerX=a.originalEvent.touches[0].pageX),a.originalEvent&&a.originalEvent.touches&&a.originalEvent.touches[0]&&a.originalEvent.touches[0].pageY&&(rspkr.ui.pointerY=a.originalEvent.touches[0].pageY),!0},viewport:{width:$rs.width(window),height:$rs.height(window)},hl:function(a,b){var c=255,d=255,e=100,f=255;window.setTimeout(function(){u(a,c,d,e,f,b)},200)},scroll:v,activePlayer:b,getActivePlayer:f,setActivePlayer:g,menus:A,toolPanels:B,utils:C}}(),ReadSpeaker.ui.Tools=function(){var a=null,b=null,c=[],d={click:function(a){rspkr.preventDefault(a);var b=$rs.getAttr(this,"data-rs-tool"),c=$rs.closest(this,"."+rs.ui.rsbtnClass);c&&$rs.hasClass(c,"disable-"+b)||(rspkr.ui.Tools.accessibility.isAccessKey(a)&&rspkr.ui.Tools.accessibility.storeSelection(),rspkr.c.dispatchEvent("onToolClicked",window,[this]),d.register(this),b&&d[b]&&d[b].apply(this,[a]))},mouseenter:function(){d.register(this)},register:function(b){a=$rs.closest(b,"."+rspkr.u.rsbtnClass)},enlarge:function(){rspkr.u.Tools.Enlarge.toggle()},help:function(a){rspkr.u.Tools.Help.open(a)},dictionary:function(a){var c,d=$rs.findIn(b,"a.rsbtn_play"),e=$rs.isArray(d)?rspkr.findHref():d.href;e&&"string"==typeof e&&e.length&&(c=rspkr.getParam("lang",e),rspkr.u.Tools.Dictionary.dictionary.apply(this,[c]))},pagemask:function(a){rspkr.u.Tools.MouseTracker.start("mask",a)},readhover:function(a){rspkr.u.Tools.ReadHover.toggle()},settings:function(){rspkr.c.Player.settings.open()},textmode:function(a){rspkr.u.Tools.TextMode.start.apply(this,[a])},translation:function(a){rspkr.ui.Tools.accessibility.restoreSelection()},voicesettings:function(){},download:function(a){rspkr.ui.Tools.Download.download()}},e={settings:"s",textmode:"v",pagemask:"m",enlarge:"e",readhover:"h",help:"i",voicesettings:"r",download:"d"},f={storedSelection:void 0,isAccessKey:function(a){return"Safari"===rspkr.c.data.browser.name?!0:a&&0===a.clientX&&0===a.clientY&&0===a.screenX&&0===a.screenY},storeSelection:function(){
var a=rspkr.c.data,b=rspkr.ui.Tools.accessibility.storedSelection={};(a.selectedText||a.selectedHTML||a.selectedRange)&&(b.text=rspkr.c.data.selectedText,b.html=rspkr.c.data.selectedHTML,b.range=rspkr.c.data.selectedRange)},restoreSelection:function(){var a=rspkr.ui.Tools.accessibility.storedSelection;if(a&&a.range){if(window.getSelection){var b=window.getSelection();b.removeAllRanges(),b.addRange(a.range)}rspkr.c.data.selectedText=a.text,rspkr.c.data.selectedHTML=a.html,rspkr.c.data.selectedRange=a.range,a=void 0}}},g={register:function(a){var b,e=$rs.rsid(a);if(!c[e]){if(b=$rs.findIn(a,".rsbtn_tool"),$rs.isArray(b)||(b=[b]),b.length)for(var f=0,g=b.length;g>f;f++)$rs.regEvent(b[f],"click",d.click),$rs.regEvent(b[f],"mouseenter",d.mouseenter);c[e]={element:a,initialized:!0}}}},h=function(a){b=a,rspkr.devt("onToolsInitialized","__self__",[a]),rspkr.accessKeys=rspkr.accessKeys||{},btns=$rs.findIn(a,".rsbtn_tool"),$rs.isArray(btns)||(btns=[btns]);for(var c=0,d=btns.length;d>c;c++){var f=btns[c].getAttribute("data-rs-tool");f&&e[f]&&!rspkr.accessKeys[e[f]]&&(btns[c].accessKey=e[f],rspkr.accessKeys[e[f]]=1)}},i=function(){rspkr.Common.addEvent("onBeforeToolsOpen",[g.register,h])};return{init:i,btns:function(){return c},lastButton:function(){return a},accessibility:f}}(),ReadSpeaker.ui.Lightbox=function(){var a,b,c,d,e,f,g=null,h=null,i=null,j=null,k=[],l=!1,m={cssDimensions:!1,customFont:!1,customTextStyle:!1},n=null,o={},p=function(a,b){if(!rspkr.mobile()&&(l||a===!0)){var c={width:$rs.outerWidth(j),height:$rs.outerHeight(j)},d={width:$rs.width(window),height:$rs.height(window)},e=f&&(f.width!==d.width||f.height!==d.height),g=!isNaN(parseFloat(j.style.top))||!isNaN(parseFloat(j.style.left));(!g||b||e)&&(j.style.top=c.height>=d.height?"fixed"===j.style.position?"0px":$rs.scrollTop(document)+"px":d.height/2-parseFloat(j.style.height)/2+"px",j.style.left=c.width>=d.width?"fixed"===j.style.position?"0px":$rs.scrollLeft(document)+"px":d.width/2-parseFloat(j.style.width)/2+"px"),f=d}},q=function(a){var b=$rs.findIn(j,"#rslightbox_content"),c=$rs.findIn(j,"#rslightbox_buttons");if(b&&c&&$rs.hasClass(j,"has-buttons")){var d=c.getBoundingClientRect();b.style.paddingBottom=d.height+"px"}},r=function(a){27===a.keyCode&&rspkr.ui.Lightbox.hide()},s={},t=function(a){var b=$rs.get("rslightbox_fullscreen");$rs.hasClass(b,"maximized")?($rs.removeClass(b,"maximized"),$rs.removeClass(j,"fullscreen"),$rs.setAttr(b,"title",rspkr.Lang.getPhrase("fullscreen")),$rs.findIn(b,".rsbtn_btnlabel").innerHTML=rspkr.Lang.getPhrase("fullscreen"),j.style.top=s.top,j.style.left=s.left,j.style.width=s.width,j.style.height=s.height,s={},p(),u()):($rs.addClass(b,"maximized"),$rs.addClass(j,"fullscreen"),$rs.setAttr(b,"title",rspkr.Lang.getPhrase("fullscreenrestore")),$rs.findIn(b,".rsbtn_btnlabel").innerHTML=rspkr.Lang.getPhrase("fullscreenrestore"),s.top=j.style.top,s.left=j.style.left,s.width=j.style.width,s.height=j.style.height,j.style.top=null,j.style.left=null,j.style.width=null,j.style.height=null,p(),v())},u=function(){rspkr.mobile()||rspkr.u.dd&&(rspkr.u.dd.add(j,{dragHandle:$rs.findIn(j,"#rslightbox_dragbar"),constrain:!0}),rspkr.u.dd.add(j,{dragHandle:$rs.findIn(j,"#rslightbox_resizer"),constrain:!0,type:rspkr.u.dd.types.resize}))},v=function(){rspkr.u.dd&&(rspkr.u.dd.remove(j,"dragdrop"),rspkr.u.dd.remove(j,"resize"))};return{dependency:["pub.Config"],init:function(){var a=ReadSpeaker.pub.Config;g=a.item("ui.overlay.contentStyles"),h=a.item("ui.overlay.contentTemplate"),rspkr.ui.Lightbox.ToolbarHelper.init(),rspkr.log("[rspkr.ui.Lightbox] Heartbeat!")},show:function(b,f,s,t,v,w,x){document.activeElement&&(e=document.activeElement),rspkr.c.dispatchEvent("onBeforeLightboxOpened",window,[]),rspkr.c.data.clearSelectedText(),rspkr.popup.closePopup(void 0,!0);var y={},z=rspkr.getID();rspkr.cfg.mergeObj(m,y),x&&"object"==typeof x&&rspkr.cfg.mergeObj(x,y),o=y,n=rspkr.u.getActivePlayer();for(var A,B=$rs.arr("a, area, button, input, object, select, textarea, [tabIndex]"),C=0;A=B[C];C++)-1===A.tabIndex||$rs.closest(A,"#rslightbox_contentcontainer")||(k.push([A,A.tabIndex]),A.tabIndex=-1);if("Explorer"!==rs.c.data.browser.name||6!==rs.c.data.browser.version){var D,E,F,G,H=$rs.get("body > *");for(D=0,E=H.length;E>D;D++)F=H[D],F.id&&"rslightbox_contentcontainer"===F.id||"script"===F.tagName.toLowerCase()||(G=F.getAttribute("aria-hidden"),G&&F.setAttribute("data-original-aria-hidden",G),F.setAttribute("aria-hidden","true"))}b=b||"",s=s||!1,rspkr.ui.Overlay.show({click:rspkr.ui.Lightbox.hide}),j?j.style.display="":(j=document.createElement("div"),j.id="rslightbox_contentcontainer","default"!==rspkr.skin&&$rs.addClass(j,rspkr.skin),j.innerHTML=h.join("\n"),$rs.setAttr(j,"style",g.join(";")),$rs.setAttr(j,"role","dialog"),$rs.setAttr(j,"aria-modal",!0),document.body.appendChild(j),$rs.css("#rslightbox_content","overflow","auto"),rspkr.evt("onSettingsLoaded",{func:rspkr.st.r().handlers.changed.addButtonEvents,context:rspkr.st.r().handlers.changed,params:[this]})),$rs.setAttr("#rslightbox_contentcontainer","data-rs-dialog-id",z);var I=$rs.get("#rs_lightboxplayer");void 0!==$rs.getAttr(I,"data-rs-set-by")&&void 0!==$rs.getAttr(j,"data-rs-dialog-id")&&$rs.getAttr(I,"data-rs-set-by")!==$rs.getAttr(j,"data-rs-dialog-id")&&(I.removeAttribute("data-rs-lang"),I.removeAttribute("data-rs-voice"),I.removeAttribute("data-rs-cid"),I.removeAttribute("data-rs-stt"),I.removeAttribute("data-rs-stp"),I.removeAttribute("data-rs-set-by")),$rs.get("#rslightbox_toolbar").innerHTML=rspkr.u.Lightbox.ToolbarHelper.getTools(w);var J=$rs.get("rslightbox_closer");rspkr.ui.addFocusHandler(J,!1),$rs.regEvent(J,"click",function(a){rspkr.preventDefault(a),rspkr.ui.Lightbox.hide(a)}),$rs.regEvent(document.body,"keyup",r);var K=$rs.get("rslightbox_fullscreen");!$rs.isArray(K)&&rspkr.mobile()?K.parentElement.removeChild(K):rspkr.ui.addFocusHandler(K,!1),$rs.unregEvent(K,"click"),$rs.regEvent(K,"click",function(a){rspkr.preventDefault(a),rspkr.ui.Lightbox.toggleFullscreen(a)});var L;if((L=document.documentElement)&&document.all&&(L.style.overflowX=L.style.overflowY="hidden"),b!==i||s){var M=rspkr.Lang.getPhrase("closedialog");if($rs.setAttr(J,"title",M),$rs.findIn(J,".rsbtn_btnlabel").innerHTML=M,$rs.get("#rslightbox_content").innerHTML="",$rs.css("#rslightbox_content","height","auto"),/^http/i.test(b)){if(!$rs.findIn("#rslightbox_content","iframe").length){var N=document.createElement("iframe");N.src=b,N.className="rslightbox-iframe",$rs.setAttr(N,"sandbox",""),void 0===v&&(v=2e3),$rs.get("#rslightbox_content").appendChild(N)}}else if("<"===b.substr(0,1)){if($rs.get("#rslightbox_content").innerHTML=b,y.cssDimensions&&j.removeAttribute("style"),y.customFontSize&&($rs.get("#rslightbox_content_inner").style.fontSize=(rspkr.st.get("lbfontsize")||"1.0")+"em"),y.customFont?$rs.css("#rslightbox_content","fontFamily",rspkr.cfg.item("fontmap."+rspkr.st.get("fontface"))||"sans-serif"):$rs.css("#rslightbox_content","fontFamily","inherit"),y.customTextStyle){var O=rspkr.cfg.item("textstyles."+rspkr.st.get("textstyle")).split(","),P=O.shift(),Q=O.shift();$rs.css("#rslightbox_content","color",P||"#000"),$rs.css("#rslightbox_content","background",Q||"#fff")}else $rs.css("#rslightbox_content","color","inherit"),$rs.css("#rslightbox_content","background","inherit");$rs.findIn(j,"#rslightbox_toolbar")?($rs.addClass(j,"has-tools"),$rs.addClass($rs.get("#rslightbox_toolbar"),"rs_skip rs_preserve")):$rs.removeClass(j,"has-tools")}$rs.get("#rslightbox_buttons").innerHTML=f,f&&f.length&&parseInt($rs.css("#rslightbox_buttons","height"))>0&&"none"!==$rs.css("#rslightbox_buttons","display")?$rs.addClass(j,"has-buttons"):$rs.removeClass(j,"has-buttons"),i=b,"ar_ar"===rspkr.Lang.getUiLang()&&(-1===j.className.indexOf("rtl")&&(j.className=(j.className+" rtl").replace(/^\s+|\s+$/g,"")),$rs.setAttr($rs.findIn(j,"legend"),"align","right"))}j.style["z-index"]=rspkr.ui.utils.getMaxZ(!0)+1,rspkr.u.Lightbox.ToolbarHelper.addEvents(j),a=void 0===v||isNaN(v)||v===!1?$rs.get("#rslightbox_content").clientHeight:v;for(var R,S=$rs.findIn("#rslightbox_content",".rsform-row"),D=0;D<S.length;D++){R=$rs.findIn(S[D],"input, a, select"),$rs.isArray(R)||(R=[R]);for(var E=0;E<R.length;E++)rspkr.ui.addFocusHandler(R[E],!1,S[D])}$rs.findIn(j,".rsdialog-button-close")&&$rs.regEvent($rs.findIn(j,".rsdialog-button-close"),"click",rspkr.ui.Lightbox.hide);var T=$rs.findIn("#rslightbox_buttons",".rssettings-button-close");rspkr.ui.addFocusHandler(T,!1),$rs.regEvent(T,"click",function(a){rspkr.preventDefault(a)}),setTimeout(function(){var a=$rs.arr(".rsicn-play, .rssettings-button-close")[0];rspkr.ui.focus(a)},200),rspkr.cfg.item("ui.preventLightboxResize")||$rs.regEvent(window.document.documentElement,"resize",p),u(),rspkr.evt("onResized",function(a){a===j&&(p(),q())}),rspkr.c.clearEvent("onLightboxFontChanged",q),rspkr.evt("onLightboxFontChanged",q),q(),"function"==typeof t&&t.apply(this,[j,z]);var U=$rs.css("html","overflow");U?$rs.setAttr("html","data-rs-prev-overflow",U):($rs.setAttr("html","data-rs-prev-overflow-x",$rs.css("html","overflow-x")),$rs.setAttr("html","data-rs-prev-overflow-y",$rs.css("html","overflow-y"))),$rs.css("html","overflow","hidden"),c="enlargeon"===rs.st.get("enlarge"),c&&rs.st.set("enlarge","enlargeoff"),rspkr.u.t.ReadHover&&(d=rspkr.u.t.ReadHover.active(),d&&rspkr.u.t.ReadHover.stop()),rspkr.cfg.item("ui.preventLightboxResize")||$rs.regEvent(window,"resize",p),l=!0,p(),rspkr.Lang.updateUi(j),rspkr.ui.LoadIndicator&&rspkr.ui.LoadIndicator.hide({keepOverlay:!0}),rspkr.u.Lightbox.ToolbarHelper.setPlayerState(void 0)},hide:function(a,b){for(var f;k.length;)f=k.pop(),0===f[1]?f[0].removeAttribute("tabindex"):f[0].tabIndex=f[1];if("Explorer"!==rs.c.data.browser.name||6!==rs.c.data.browser.version)for(var g,h=$rs.get("body > *"),i=0,m=h.length;m>i;i++)f=h[i],g=f.getAttribute("data-original-aria-hidden"),g?(f.setAttribute("aria-hidden",g),f.removeAttribute("data-original-aria-hidden")):f.removeAttribute("aria-hidden");var q=$rs.arr(".rsbtn_tool_settings button.rsbtn_tool");$rs.setAttr(q,"aria-expanded",!1),$rs.findIn(j,".rsdialog-button-close")&&$rs.unregEvent($rs.findIn(j,".rsdialog-button-close"),"click"),rspkr.u.Lightbox.ToolbarHelper.removeEvents(j),rspkr.u.Lightbox.ToolbarHelper.stopPlay(),b!==!0&&rspkr.preventDefault(a),rspkr.ui.Overlay.hide({type:"fullscreen"}),$rs.unregEvent(window,"resize",p),j.style.display="none",$rs.unregEvent($rs.get("#rslightbox_closer"),"click",rspkr.ui.Lightbox.hide),$rs.unregEvent(document.body,"keyup",r);var s;(s=document.documentElement)&&document.all&&(s.style.overflowX=s.style.overflowY="auto"),rspkr.ui.Detach&&!rspkr.ui.Detach.isDetached()&&rspkr.ui.updateFocus(),v();var t=$rs.getAttr("html","data-rs-prev-overflow");t?$rs.css("html","overflow",t):($rs.css("html","overflow-x",$rs.getAttr("html","data-rs-prev-overflow-x")),$rs.css("html","overflow-y",$rs.getAttr("html","data-rs-prev-overflow-y"))),c&&(rs.st.set("enlarge","enlargeon"),c=!1),rspkr.u.t.ReadHover&&d&&rspkr.u.t.ReadHover.start(),rspkr.c.clearEvent("onUIStop",rspkr.u.Lightbox.ToolbarHelper.stopPlay),rspkr.u.activePlayer=null,rspkr.c.dispatchEvent("onSettingsClosed",window,[]),rspkr.c.dispatchEvent("onLightboxClosed",window,[]),l=!1,$rs.unregEvent(window,"resize",p),o.reopenActivePlayer&&o.reopenActivePlayer===!0&&"object"==typeof n&&window.readpage(n.getHref(),null,{preventPlay:!0}),e&&e.focus()},reposition:p,toggleFullscreen:t,revertPostState:function(a){return"boolean"==typeof a&&(b=a),b}}}(),ReadSpeaker.ui.Accessibility=function(){var a=!1,b=function(){function b(){a||(a=!0,c.init(),HighContrast.init(),rspkr.log("[rspkr.ui.Accessibility] Heartbeat!"))}function d(){var a=window.navigator.userAgent;-1!==a.indexOf("MSIE ")||-1!==a.indexOf("Trident/")||-1!==a.indexOf("Edge/")?"complete"===document.readyState&&b():("complete"===document.readyState||"interactive"===document.readyState)&&b()}document.onreadystatechange=function(){d()},d()},c=function(){var a,b=".",c=!1,d="durl",e=function(e){function f(a,b){b=b.split("");for(var c=b.length-1;c>=0;c--)a.indexOf(b[c])>=0&&b.splice(c,1);return a.split("").concat(b)}if(e=e||window.event){var g;if(e.target&&$rs.getAttr(e.target,"data-rs-tooltip"))g=e.target;else if(e.target&&$rs.hasClass(e.target,"rsbtn_tool_menu_item")){var h=$rs.closest(e.target,'li[class^="rsbtn_tool_"]'),i=h?$rs.findIn(h,"button.rsbtn_tool"):void 0;i&&$rs.getAttr(i,"data-rs-tooltip")&&(g=i)}if(c&&g){var j=$rs.getAttr(g,"data-rs-tooltip");if(j===b){var k=$rs.findIn(g,".rsbtn_btnlabel");$rs.isArray(k)?$rs.getAttr(g,"title")&&(j=$rs.getAttr(g,"title")):j=k.innerText}a||(a=document.createElement("div"),$rs.setAttr(a,"role","tooltip"),a.id="readspeaker_tooltip",a.className="rs_tooltip",$rs.setAttr(a,"aria-hidden",!0),document.body.appendChild(a)),a.innerHTML=j,a.style.zIndex=rspkr.ui.utils.getMaxZ(!0)+20,a.style.display="block";for(var l,m,n=$rs.offset(g),o=$rs.width(g),p=$rs.height(g),q=$rs.width(a),r=$rs.height(a),s=$rs.getAttr(g,"data-rs-direction")?f($rs.getAttr(g,"data-rs-direction"),d):d.split("");s.length&&!l;){var t=s.shift();switch(t){case"l":if(n.left<q+5)continue;m=n.left-q-5+"px",l=n.top+p/2-r/2+"px";break;case"r":if(n.left+o+q+5>rspkr.ui.viewport.width)continue;m=n.left+o+5+"px",l=n.top+p/2-r/2+"px";break;case"u":if(n.top-$rs.scrollTop(document)<r+10||n.left+o/2-q/2<0)continue;m=n.left+o/2-q/2+"px",l=n.top-r-10+"px";break;case"d":default:if(n.top-$rs.scrollTop(document)+p+r+5>rspkr.ui.viewport.height||n.left+o/2-q/2<0)continue;m=n.left+o/2-q/2+"px",l=n.top+p+5+"px"}}a.style.left=m,a.style.top=l}}},f=function(b){a&&(a.style.display="none")},g=function(){if(!rspkr.features.tooltips)return!1;$rs.regEvent(document,"keydown",function(a){a&&9===a.keyCode?(c=!0,setTimeout(function(){c=!1},100)):!a||"Escape"!==a.key&&27!==a.keyCode||f()});var a=window.navigator.userAgent,b=a.indexOf("MSIE ");b>0&&parseInt(a.substring(b+5,a.indexOf(".",b)),10)<10?(document.body.onfocus=e,document.body.onfocusout=f):(document.body&&document.body.addEventListener("focus",e,!0),document.body&&document.body.addEventListener("blur",f,!0))};return{init:g}}();return HighContrast=function(){var a=!1,b=function(){if(/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)){var b=document.getElementsByTagName("html");a=null!=b[0].getAttribute("hc")}else{var c=document.createElement("div");c.style.color="rgb(31, 41, 59)",document.body.appendChild(c),strColor=document.defaultView?document.defaultView.getComputedStyle(c,null).color:c.currentStyle.color,strColor=strColor.replace(/ /g,""),document.body.removeChild(c),a="rgb(31,41,59)"!==strColor}return rspkr.log("[ReadSpeaker.q] High Contrast Mode = "+a,1),a},c=function(){return $rs.addClass(document.body,"rs_highcontrast"),ReadSpeaker.q(function(){rspkr.hl.css.setRule("word",".sync_word_highlighted","position: relative;"),rspkr.hl.css.setRule("word",".sync_word_highlighted:before",'content: ""; position: absolute; border: solid 2px '+(rspkr.Common.Settings.get("hlword")||"Red")+"; left: -2px; top: -1px; right: -2px; bottom: -1px;"),rspkr.hl.css.setRule("sent",".sync_sent_highlighted","border-bottom: solid 1px "+(rspkr.Common.Settings.get("hlword")||"Red")+";"),rspkr.hl.css.setRule("word",".enlarge_word_highlighted","position: relative;"),rspkr.hl.css.setRule("word",".enlarge_word_highlighted:before",'content: ""; position: absolute; border: solid 2px '+(rspkr.Common.Settings.get("hlword")||"Red")+"; left: -2px; top: -1px; right: -2px; bottom: -1px;")}),!0},d=function(){var a=rspkr.pub.Config.getSettingsConf();return a.highlighting&&a.highlighting.items&&(delete a.highlighting.items.hltext,delete a.highlighting.items.hlword,delete a.highlighting.items.hlsent,delete a.textsettings.items.textstyle),!0},e=function(){b()&&(c(),d())};return{init:e}}(),{dependency:["Common","pub.Config"],init:b}}(),ReadSpeaker.ui.ContextMenu=function(a){var b=!1,c=null,d=null,e='<span id="[[id]]" class="[[class]]" role="menu">[[items]]</span>',f="rsbtn_tool_menu",g='<a class="rsbtn_tool_menu_item[[classes]]" href="javascript: void(0);" data-rs-itemid="[[id]]" data-rs-itemval="[[value]]" data-rslang="title/arialabel/content:[[key]]" role="menuitem">[[text]][[label]]</a>',h={triggerElm:null,triggerEvent:"click",items:[],rtl:!1,preOpen:!1},i={},j={},k={hover:{on:function(){$rs.unregEvent(i.triggerElm,"mouseenter"),$rs.regEvent(i.triggerElm,"mouseenter",l.open)},off:function(){$rs.unregEvent(i.triggerElm,"mouseleave"),$rs.regEvent(i.triggerElm,"mouseleave",l.close)}},click:{on:function(){$rs.unregEvent(i.triggerElm,"click"),$rs.regEvent(i.triggerElm,"click",l.toggle)},off:function(){}},mousedown:{on:function(){$rs.unregEvent(i.triggerElm,"mousedown"),$rs.regEvent(i.triggerElm,"mousedown",l.toggle)},off:function(){}},mouseup:{on:function(){$rs.unregEvent(i.triggerElm,"mouseup"),$rs.regEvent(i.triggerElm,"mouseup",l.toggle)},off:function(){}},keyboard:{timer:void 0,menuActive:!1,eventsRegistered:!1,on:function(){$rs.unregEvent($rs.findIn(i.triggerElm,"button"),"focus"),$rs.regEvent($rs.findIn(i.triggerElm,"button"),"focus",function(a){if(k.keyboard.menuActive){k.keyboard.menuActive=!1;for(var b,d,e=$rs.findIn($rs.closest(this,".rsbtn_toollist"),".rsbtn_tool"),f=0;d=e[f];f++)if(d===this){b=e[f-1];break}b&&b.focus()}else l.open(),k.keyboard.eventsRegistered||(k.keyboard.eventsRegistered=!0,$rs.unregEvent(document,"keydown",k.keyboard.keydown),$rs.regEvent(document,"keydown",k.keyboard.keydown)),$rs.setAttr(i.triggerElm,"data-rs-menu-selected",0),$rs.addClass($rs.findIn(c,".rsbtn_tool_menu_item")[0],"hover"),$rs.findIn(c,".rsbtn_tool_menu_item")[0].focus(),k.keyboard.menuActive=!0})},off:function(){$rs.unregEvent($rs.findIn(i.triggerElm,".rsbtn_tool_menu_item"),"blur"),$rs.regEvent($rs.findIn(i.triggerElm,".rsbtn_tool_menu_item"),"blur",function(){k.keyboard.timer=setTimeout(function(){$rs.hasClass(document.activeElement,"rsbtn_tool_menu_item")?clearTimeout(k.keyboard.timer):(l.close(),$rs.unregEvent(document,"keydown",k.keyboard.keydown),k.keyboard.eventsRegistered=!1,$rs.removeClass($rs.findIn(c,".rsbtn_tool_menu_item"),"hover"),k.keyboard.menuActive=!1)},100)}),$rs.unregEvent($rs.findIn(i.triggerElm,"button"),"blur"),$rs.regEvent($rs.findIn(i.triggerElm,"button"),"blur",function(a){$rs.hasClass(document.activeElement,"rsbtn_tool_menu_item")||(k.keyboard.menuActive=!1)})},keydown:function(a){var b=$rs.findIn(c,".rsbtn_tool_menu_item"),d=$rs.getAttr(i.triggerElm,"data-rs-menu-selected");38===a.keyCode||40===a.keyCode?(rspkr.preventDefault(a),rspkr.ui.Tools.accessibility.isAccessKey(a)&&rspkr.ui.Tools.accessibility.storeSelection(),d=38===a.keyCode?Math.max(--d,0):Math.min(++d,b.length-1),$rs.setAttr(i.triggerElm,"data-rs-menu-selected",d),$rs.removeClass(b,"hover"),$rs.addClass(b[d],"hover"),b[d].focus(),rspkr.ui.Tools.accessibility.restoreSelection()):13===a.keyCode}}},l={exec:function(a){var b=j[$rs.getAttr(this,"data-rs-itemid")];b&&b.action&&"function"==typeof b.action&&b.action.apply(this,b.params),k.keyboard.menuActive=!1,l.close(a)},render:function(){for(var a,b="",d=rspkr.getID(),h=0,m=i.items.length;m>h;h++)a=rspkr.getID(),b+=g.replace("[[classes]]",i.items[h].active&&i.items[h].active===!0?" active":"").replace("[[id]]",a).replace("[[text]]",i.items[h].text||"").replace("[[key]]",i.items[h].key||"").replace("[[label]]",i.items[h].active&&i.items[h].active===!0?' <span class="rsbtn_btnlabel"> - '+rspkr.Lang.getPhrase("selected")+"</span>":"").replace("[[value]]",i.items[h].value||a),j[a]=i.items[h];i.triggerElm.insertAdjacentHTML("beforeend",e.replace("[[id]]",d).replace("[[items]]",b).replace("[[class]]",f)),c=document.getElementById(d),i.rtl&&$rs.addClass(c,"rtl"),k[i.triggerEvent].off(),$rs.regEvent($rs.findIn(c,".rsbtn_tool_menu_item"),"mouseup",l.exec),$rs.regEvent($rs.findIn(c,".rsbtn_tool_menu_item"),"keyup",function(a){13===a.keyCode&&l.exec.bind(this)()}),i.preOpen&&l.open()},open:function(a){return b?!1:(rspkr.u.menus.add(l),i.triggerElm.style.zIndex=1,$rs.addClass(c,"open"),$rs.setAttr($rs.findIn(i.triggerElm,"button"),"aria-expanded","true"),$rs.remove("#"+c.id+" .rsbtn_tool_menu_item_placeholder"),l.position(),void(b=!0))},close:function(a){return b?($rs.removeClass(c,"open"),$rs.setAttr($rs.findIn(i.triggerElm,"button"),"aria-expanded","false"),i.triggerElm.style.zIndex="",c.removeAttribute("style"),void(b=!1)):!1},toggle:function(a){rspkr.preventDefault(a),b?l.close(a):l.open(a)},position:function(a){function b(a,b){if(a){if(a>$rs.height(c))return!0;var d=c.getElementsByTagName("a"),e=Math.floor(a/$rs.height(d[0])),f=Math.ceil(d.length/e);if(e=Math.ceil(d.length/f),5>e&&d.length>=5)return!1;if($rs.css(c,"display","block"),$rs.css(c,"grid-template-columns",null),$rs.css(c,"grid-template-rows",null),$rs.css(c,"display","grid"),$rs.css(c,"grid-template-columns","repeat(%x, %wpx)".replace("%x",f).replace("%w",$rs.width(d[0]))),$rs.css(c,"grid-template-rows","repeat(%x, %hpx)".replace("%x",e).replace("%h",$rs.height(d[0]))),d.length%f)for(var g,h=0;h<d.length%f;h++)g=document.createElement("a"),g.className="rsbtn_tool_menu_item_placeholder",c.appendChild(g);return!0}return b?b>=$rs.width(c):!1}$rs.css(c,"display","block");var d=$rs.offset(c),e="95%",f=0,g="auto",h="auto",j=({width:$rs.outerWidth(c),height:$rs.outerHeight(c)},{top:d.top-$rs.scrollTop(document)-$rs.height(i.triggerElm),bottom:$rs.scrollTop(document)+rspkr.u.viewport.height-d.top,left:d.left+$rs.width(i.triggerElm),right:rspkr.u.viewport.width-d.left});b(j.bottom,void 0)||b(j.top,void 0)&&(e="auto")&&(g="95%"),i.rtl?b(void 0,j.left)&&(f="auto")&&(h="95%"):b(void 0,j.right)||b(void 0,j.left)&&(f="auto")&&(h="0"),$rs.css(c,{left:f,right:h,top:e,bottom:g})},set:function(a){for(var b=$rs.findIn(c,".rsbtn_tool_menu_item"),e=null,f=0,g=b.length;g>f;f++)$rs.getAttr(b[f],"data-rs-itemval")===a&&(e=b[f]);if(e){var h=$rs.findIn(c,".rsbtn_tool_menu_item.active");return h&&$rs.removeClass(h,"active"),$rs.addClass(e,"active"),d=a,!0}return!1}},m=function(a){for(var b in h)i[b]=a.hasOwnProperty(b)?a[b]:h[b];var c=$rs.findIn(i.triggerElm,"."+f);if($rs.isArray(c)&&!c.length){if(!i.triggerElm)return rspkr.log("Context element lacks trigger element. Fail...",3),!1;i.triggerEvent&&k[i.triggerEvent]&&"function"==typeof k[i.triggerEvent].on&&(l.render(),k[i.triggerEvent].on.apply(this,[])),k.keyboard.on.apply(this,[]),k.keyboard.off.apply(this,[])}};return m(a),{getConf:function(){return i},close:l.close,setValue:l.set,reflow:l.position}},ReadSpeaker.ui.Detach=function(){var a,b={},c=!0,d=function(){if(rspkr.features.detachment===!1)return!1;if("Explorer"===ReadSpeaker.Common.data.browser.name&&parseInt(ReadSpeaker.Common.data.browser.version)<11)return rspkr.features.detachment=!1,!1;if(/ios|iphone|ipad|ipod|android|windows phone/i.test(navigator.userAgent)&&rspkr.params.hasOwnProperty("mobile")&&rspkr.params.mobile===!1)return rspkr.features.detachment=!1,!1;var a=document.createElement("div");try{if(a.style.position="fixed","fixed"!==a.style.position)return rspkr.features.detachment=!1,!1}catch(b){return rspkr.features.detachment=!1,!1}return rspkr.features.detachment===!0?!0:void 0},e=function(){return"Explorer"!==ReadSpeaker.Common.data.browser.name&&!$rs.hasClass(b.active,"rs_rtl_transformed")},f=function(){if(!d())return!1;window.rsConf&&window.rsConf.ui&&window.rsConf.ui.playbackDetach&&(c=!1);var a=ReadSpeaker.pub.Config,e=$rs.get("."+(a.item("ui.rsbtnClass")||"rsbtn"));$rs.isArray(e)||(e=[e]),b.players=e,b.playerCount=e.length,e.length&&c&&1===b.playerCount&&(b.active=e[0],setTimeout(function(){$rs.isVisible(b.active)&&!j()&&l()},1e3));var f=function(){if(!c||1!==b.playerCount){var a=rspkr.ui.getActivePlayer();b.active=a.getContainer(),h()}};ReadSpeaker.Common.clearEvent("onUIBeforePlay",f),ReadSpeaker.Common.addEvent("onUIBeforePlay",f);var g=function(){c&&1===b.playerCount||m(!0)};ReadSpeaker.Common.clearEvent("onUIClosePlayer",g),ReadSpeaker.Common.addEvent("onUIClosePlayer",g);var i=function(){if(b.replacement||!b.active||$rs.hasClass(b.active,"rsdetached")){var a=k();a.parentElement||b.active.parentElement.insertBefore(a,b.active)}else{var c=$rs.get("#rsbtn_detach_clone");!$rs.isArray(c)&&(c=[c]);for(var d=c.length-1;d>=0;d--)c[d].parentElement.removeChild(c[d])}};ReadSpeaker.Common.clearEvent("onAfterContentChange",i),ReadSpeaker.Common.addEvent("onAfterContentChange",i),$rs.unregEvent(window,"scroll",h),$rs.regEvent(window,"scroll",h),ReadSpeaker.Common.addEvent("onDragDropFinished",function(a){a===b.active&&q(a)}),rspkr.log("[rspkr.ui.Detach] Heartbeat!")},g=function(){b={},f()},h=function(a){if(b.active&&$rs.isVisible(b.active)){var c=j();b.replacement&&c?m():b.replacement||c||l()}},i=function(a,b){return window.getComputedStyle?window.getComputedStyle(a)[b]:a.currentStyle?a.currentStyle[b]:$rs.css(a,b)},j=function(){var a;if(b.replacement)if(b.replacement.parentElement)a=b.replacement.getBoundingClientRect();else{var c=k();a=c.getBoundingClientRect()}else a=b.active.getBoundingClientRect();if(a.top===a.bottom||a.left===a.right)return!1;var d=a.top>=0&&a.left>=0&&a.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&a.right<=(window.innerWidth||document.documentElement.clientWidth);return d},k=function(){var a=$rs.get("#rsbtn_detach_clone");if($rs.isArray(a)){if(b.replacement)return b.replacement;if(a.length>1){for(var c=a.length-1;c>0;c--)a[c].parentElement.removeChild(a[c]);return a[0]}return!1}return a},l=function(){if(rspkr.features.detachment&&!b.replacement&&!$rs.hasClass(b.active,"transitioning")){var c=b.active.getBoundingClientRect();if(!a){a=$rs.clone(b.active,!1,!0),$rs.css(a,"width","auto"),$rs.css(a,"height",c.height+"px");for(var d,f=["position","left","right","top","bottom","margin-left","margin-right","margin-top","margin-bottom"],g=0;d=f[g];g++){var h=i(b.active,d);"auto"!==h&&$rs.css(a,d,h)}for(a.className="",a.id="rsbtn_detach_clone";a.hasChildNodes();)a.removeChild(a.lastChild)}b.replacement=a,b.active.parentElement.insertBefore(b.replacement,b.active);var j=b.replacement.getBoundingClientRect();0===j.width&&$rs.css(b.replacement,"width",c.width+"px"),ReadSpeaker.ui.DragDrop.add(b.active,{dragHandle:r.get(b.active),constrain:!0}),$rs.css(b.active,"zIndex",rspkr.ui.utils.getMaxZ(!0)+10);var k,l;b.lastX?(k=b.lastX,l=b.lastY):ReadSpeaker.Common.Settings.get("detachPosition")?(k=ReadSpeaker.Common.Settings.get("detachPosition").split(",").shift(),l=ReadSpeaker.Common.Settings.get("detachPosition").split(",").pop()):ReadSpeaker.pub.Config.item("ui.detachDefaultPosition")?(k=ReadSpeaker.pub.Config.item("ui.detachDefaultPosition").split(",").shift(),l=ReadSpeaker.pub.Config.item("ui.detachDefaultPosition").split(",").pop()):(k=150,l=150);var m=b.active.style.position;b.active.style.position="absolute";var n=$rs.width(b.active),o=$rs.height(b.active);if(b.active.style.position=m,k=Math.min(k,$rs.width(window)-n-5),l=Math.min(l,$rs.height(window)-o-5),e()){var p=-1*(k-c.left),q=-1*(l-c.top);$rs.css(b.active,"left",k+"px"),$rs.css(b.active,"top",l+"px"),$rs.css(b.active,"transform","translate("+p+"px,"+q+"px)"),$rs.css(b.active,"-webkit-transform","translate("+p+"px,"+q+"px)"),$rs.addClass(b.active,"rsdetached"),void b.active.offsetHeight,$rs.addClass(b.active,"transitioning"),$rs.css(b.active,"transform","translate(0px,0px)"),$rs.css(b.active,"-wekbit-transform","translate(0px,0px)"),setTimeout(function(){$rs.removeClass(b.active,"transitioning"),b.active.style.transform=null,b.active.style.WebkitTransform=null,rspkr.ui.updateFocus()},250)}else $rs.addClass(b.active,"rsdetached"),$rs.css(b.active,"left",k+"px"),$rs.css(b.active,"top",l+"px"),rspkr.ui.updateFocus()}},m=function(a){if(!b.replacement)return void(a&&delete b.active);if(rspkr.features.detachment&&b.active&&b.replacement&&!$rs.hasClass(b.active,"transitioning"))if(ReadSpeaker.ui.DragDrop.remove(b.active,"dragdrop"),b.lastX=parseInt($rs.css(b.active,"left")),b.lastY=parseInt($rs.css(b.active,"top")),e()){var c=k();$rs.css(b.active,"position","absolute"),$rs.css(b.active,"left",$rs.scrollLeft(document)+b.lastX+"px"),$rs.css(b.active,"top",$rs.scrollTop(document)+b.lastY+"px"),$rs.addClass(b.active,"transitioning");var d=c.offsetLeft-b.active.offsetLeft,f=c.offsetTop-b.active.offsetTop;$rs.css(b.active,"transform","translate("+d+"px,"+f+"px)"),$rs.css(b.active,"-webkit-transform","translate("+d+"px,"+f+"px)"),setTimeout(function(){n(),a&&delete b.active},250)}else n(),a&&delete b.active},n=function(){b.active&&(ReadSpeaker.ui.DragDrop.remove(b.active,"dragdrop"),b.active.style.zIndex=null,b.active.style.transform=null,b.active.style.WebkitTransform=null,b.active.style.position=null,$rs.css(b.active,"left","auto"),$rs.css(b.active,"top","auto"),$rs.removeClass(b.active,"rsdetached"),$rs.removeClass(b.active,"transitioning"));var a=k();a&&a.parentElement.removeChild(a),delete b.replacement},o=function(){return rspkr.features.detachment&&!!b.active},p=function(a){return rspkr.features.detachment||a?(!b.active&&b.players.length&&(b.active=b.players[0],j()||l()),b.active):void 0},q=function(a){var b=parseInt($rs.css(a,"left"))+","+parseInt($rs.css(a,"top"));ReadSpeaker.Common.Settings.set("detachPosition",b)},r={get:function(a){function b(a){function b(a,b){var d=p();if(d){var e=Math.min(Math.max(parseInt($rs.css(d,"left"))+(a||0),0),rspkr.ui.viewport.width-$rs.width(d)-1)+"px",f=Math.min(Math.max(parseInt($rs.css(d,"top"))+(b||0),$rs.height(c)),rspkr.ui.viewport.height-$rs.height(d))+"px";$rs.css(d,{left:e,top:f}),q(d)}}var d=10,e=5,f={38:function(a){b(0,-(a?e*d:d),a)},40:function(a){b(0,a?e*d:d,a)},37:function(a){b(-(a?e*d:d),0,a)},39:function(a){b(a?e*d:d,0,a)}};a&&a.keyCode&&f[a.keyCode]&&(a.originalEvent&&a.originalEvent.preventDefault&&a.originalEvent.preventDefault(),f[a.keyCode].call(void 0,a.originalEvent.shiftKey))}if(rspkr.features.detachment&&a){var c=$rs.findIn(a,".rsbtn_dragbar");if($rs.isArray(c)&&!c.length){var d=document.createElement("div"),e='<div><span class="rsbtn_btnlabel">rsLABELrs</span><span class="rsicn rsicn-grippie" aria-hidden="true"></span></div>';d.innerHTML=rspkr.cfg.item("ui.detachDragbarMarkup")||e,d.childNodes.length&&d.childNodes[0].nodeType===Node.ELEMENT_NODE||(d.innerHTML=e),d.innerHTML=d.innerHTML.replace("rsLABELrs",rspkr.Lang.getPhrase("moveplayerwebreader")),c=a.appendChild(d.childNodes[0]),$rs.addClass(c,"rsbtn_dragbar"),$rs.setAttr(c,"tabIndex","0"),$rs.setAttr(c,"role","button"),$rs.setAttr(c,"aria-grabbed","false");var f=document.createElement("div");f.innerHTML='<button tabindex="-1" accesskey="u" class="rsbtn_focusforward" aria-hidden="true">.</button>',$rs.regEvent(f.childNodes[0],"click",function(a){c.focus()}),f.childNodes[0].style.display="none",c.appendChild(f.childNodes[0]),$rs.regEvent(c,"keydown",b)}return c}}};return{dependency:["Common","Common.Settings","pub.Config"],getDetachedPlayer:p,init:f,reinit:g,isDetached:o,supported:d,check:h}}(),ReadSpeaker.ui.DragDrop=function(){var a={dragdrop:"dragdrop",resize:"resize"},b=[],c={element:null,dragHandle:null,dragParent:document.body,constrain:!0,type:a.dragdrop,resizeDir:"se"},d={width:300,height:300},e={},f=function(a){var b={};for(var d in c)c.hasOwnProperty(d)&&(b[d]=a.hasOwnProperty(d)?a[d]:c[d]);return b},g=function(a,c){try{if("object"!=typeof a)throw new Error("Invalid target element provided.");var d=f(c),e="rs_"+rspkr.getID();if(!j[d.type])throw new Error("Invalid type.");$rs.setAttr(a,"data-rs-dragdrop-"+d.type,e),d.element=a,b[e]=d,j.add(d)}catch(g){rspkr.log("[rspkr.u.DragDrop] Could not add element: "+g.message,3)}},h=function(a){for(var c in b)if(b.hasOwnProperty(c)&&c===a)return b[c];return null},i=function(a,c){c=c||"dragdrop";var d=$rs.getAttr(a,"data-rs-dragdrop-"+c);if(d){var e=h(d);if(e)return j.remove(e),delete b[d],!0}return!1},j={add:function(a){e.mousedown=function(b){j.mousedown.apply(this,[b,a])},$rs.regEvent(a.dragHandle,"mousedown",e.mousedown)},remove:function(a){$rs.unregEvent(a.dragHandle,"mousedown",e.mousedown)},mousedown:function(a,b){$rs.addClass("html","unselectable"),$rs.addClass(b.element,"dragged"),
$rs.setAttr(b.dragHandle,"aria-grabbed",!0),b.initialLeft=a.pageX,b.initialTop=a.pageY,e.mousemove=function(a){j[b.type].mousemove.apply(this,[a,b])},e.mouseup=function(a){j.mouseup.apply(this,[a,b])},$rs.regEvent(b.dragParent,"mousemove",e.mousemove),$rs.regEvent(b.dragParent,"mouseup",e.mouseup)},mouseup:function(b,c){$rs.removeClass("html","unselectable"),$rs.removeClass(c.element,"dragged"),$rs.setAttr(c.dragHandle,"aria-grabbed",!1),$rs.unregEvent(c.dragParent,"mousemove",e.mousemove),$rs.unregEvent(c.dragParent,"mouseup",e.mouseup),c.type===a.dragdrop?rspkr.devt("onDragDropFinished","__self__",[c.element]):rspkr.devt("onResizeFinished","__self__",[c.element])},dragdrop:{mousemove:function(a,b){if(1===a.originalEvent.buttons){var c=parseFloat(b.element.style.left)+(a.pageX-b.initialLeft),d=parseFloat(b.element.style.top)+(a.pageY-b.initialTop),e=$rs.width(window)-parseFloat(b.element.style.width),f=$rs.height(window)-parseFloat(b.element.style.height);b.constrain&&(c>e&&(c=e),d>f&&(d=f),0>c&&(c=0),0>d&&(d=0)),b.element.style.left=c+"px",b.element.style.top=d+"px",b.initialLeft=a.pageX,b.initialTop=a.pageY}}},resize:{mousemove:function(a,b){var c=parseFloat(b.element.style.width)+(a.pageX-b.initialLeft),e=parseFloat(b.element.style.height)+(a.pageY-b.initialTop),f=$rs.width(window)-parseFloat(b.element.style.left),g=$rs.height(window)-parseFloat(b.element.style.top);b.constrain&&(c<d.width&&(c=d.width),c>f&&(c=f),e<d.height&&(e=d.height),e>g&&(e=g)),b.element.style.width=c+"px",b.element.style.height=e+"px",b.initialLeft=a.pageX,b.initialTop=a.pageY,rspkr.devt("onResized","__self__",[b.element,c,e])}}},k=function(){rspkr.log("[rspkr.u.DragDrop] DragDrop Initialized!",1)};return{init:k,add:g,get:h,remove:i,elms:function(){return b},types:a}}(),ReadSpeaker.ui.Lightbox.ToolbarHelper=function(){var a={play:{html:'<button class="rslightbox-tool rslightbox-tool-play rsicn rsicn-play" data-rs-action="play" data-rslang="title/arialabel:readdialog"><span class="rsbtn_btnlabel" data-rslang="content:readdialog"></span></button>',handlers:{click:function(a){h.playback.play.apply(this,[a])}}},stop:{html:'<button class="rslightbox-tool rslightbox-tool-stop rsicn rsicn-stop" data-rs-action="stop" data-rslang="title/arialabel:stopreaddialog"><span class="rsbtn_btnlabel" data-rslang="content:stopreaddialog"></span></button>',handlers:{click:function(a){h.playback.stop.apply(this,[a])}}},fontplus:{html:'<button class="rslightbox-tool rsicn rsicn-font-plus" accesskey="+" data-rs-action="fontplus" data-rslang="title/arialabel:fontsizeplus"><span class="rsbtn_btnlabel" data-rslang="content:fontsizeplus"></span></button>',handlers:{click:function(a){h.fontSize.fontplus.apply(this,[a])}}},fontminus:{html:'<button class="rslightbox-tool rsicn rsicn-font-minus" accesskey="-" data-rs-action="fontminus" title="rsLIGHTBOX_TOOLBAR_MINUSrs" data-rslang="title/arialabel:fontsizeminus"><span class="rsbtn_btnlabel" data-rslang="content:fontsizeminus"></span></button>',handlers:{click:function(a){h.fontSize.fontminus.apply(this,[a])}}},volume:{html:'<button class="rslightbox-tool rsicn rsicn-volume" data-rs-action="volume" data-rslang="title/arialabel:volume"><span class="rsbtn_btnlabel" data-rslang="content:volume"></span></button>',handlers:{click:function(a){h.volume.open.apply(this,[a])}},mobile:!1},speed:{html:'<button class="rslightbox-tool rsicn rsicn-meter" data-rs-action="speed" data-rslang="title/arialabel:speed"><span class="rsbtn_btnlabel" data-rslang="content:speed"></span></button>',handlers:{click:function(a){h.speed.open.apply(this,[a])}}},textsettings:{html:'<button class="rslightbox-tool rsicn rsicn-text-settings" data-rs-action="textsettings" data-rslang="title/arialabel:textsettings"><span class="rsbtn_btnlabel" data-rslang="content:textsettings"></span></button>',handlers:{click:function(a){h.textsettings.open.apply(this,[a])}}},groupstart:{html:'<div class="toolbar-group">'},groupend:{html:"</div>"}},b=function(b,c){if(/stop/i.test(b)||(b="stop "+b),/play/i.test(b)||(b="play "+b),b&&b.length){if(c)for(var d in c)c.hasOwnProperty(d)&&(a[d]=c[d]);b=b.replace(/\[/gi," groupstart ").replace(/\]/gi," groupend ").replace("  "," ").trim();for(var e=b.split(" "),f="",g=0,h=e.length;h>g;g++)a[e[g]]&&a[e[g]].mobile===!1&&rspkr.mobile()||a[e[g]]&&(f+=a[e[g]].html);return f}return""},c=function(b){var c=$rs.getAttr(this,"data-rs-action");"string"==typeof c&&c.length&&a[c]&&a[c].handlers&&a[c].handlers[b.type]&&"function"==typeof a[c].handlers[b.type]&&a[c].handlers[b.type].apply(this,[b])},d=function(a){$rs.regEvent($rs.findIn(a,".rslightbox-tool"),"click",c)},e=function(a){$rs.unregEvent($rs.findIn(a,".rslightbox-tool"),"click",c)},f=function(b,c){return a=b,_phraseMap=c,!0},g=function(a){"playing"===a?$rs.addClass("#rslightbox_toolbar","rsplaying"):$rs.removeClass("#rslightbox_toolbar","rsplaying"),"paused"===a?$rs.addClass("#rslightbox_toolbar","rspaused"):$rs.removeClass("#rslightbox_toolbar","rspaused"),"stopped"===a?$rs.addClass("#rslightbox_toolbar","rsstopped"):$rs.removeClass("#rslightbox_toolbar","rsstopped")},h={playback:{playing:-1,pause:function(){rs.ui.getActivePlayer().pause(),g("paused"),$rs.get(".rslightbox-tool-play").setAttribute("data-rslang","title/arialabel:resume"),$rs.get(".rslightbox-tool-play span").setAttribute("data-rslang","content:resume"),rspkr.Lang.updateUi(document.getElementById("rslightbox_toolbar")),h.playback.playing=0},resume:function(){rs.ui.getActivePlayer().play(),g("playing"),$rs.get(".rslightbox-tool-play").setAttribute("data-rslang","title/arialabel:pause"),$rs.get(".rslightbox-tool-play span").setAttribute("data-rslang","content:pause"),rspkr.Lang.updateUi(document.getElementById("rslightbox_toolbar")),h.playback.playing=1},play:function(a){if(1===h.playback.playing)return void h.playback.pause();if(0===h.playback.playing)return void h.playback.resume();h.playback.stop();var b=rs.findHref();if(b){b=b.replace(/(readid|readclass)=.+?(&amp;|&|$)/gi,""),b=rspkr.setParam("readid","rslightbox_content",b),b=rspkr.setParam("url","",b),_revertPostState=!rs.cfg.item("general.usePost"),rs.cfg.item("general.usePost",!0),g("playing"),rspkr.Lang.updateUi(document.getElementById("rslightbox_toolbar"));for(var c=$rs.get("#rs_lightboxplayer"),d=$rs.findIn(rspkr.u.Tools.lastButton(),"a.rsbtn_play"),e=d.href?d.href:rspkr.findHref(),f=[{attr:"lang",param:"lang",setDefault:!0,defaultVal:rspkr.getParam("lang",e)},{attr:"voice",param:"voice",setDefault:!0,defaultVal:rspkr.getParam("voice",e)},{attr:"cid",param:"customerid",setDefault:!1},{attr:"stt",param:"stattype",setDefault:!1},{attr:"stp",param:"statparam",setDefault:!1}],i=0,j=f.length;j>i;i++)$rs.getAttr(c,"data-rs-"+f[i].attr)&&$rs.getAttr(c,"data-rs-"+f[i].attr).length?b=rspkr.setParam(f[i].param,$rs.getAttr(c,"data-rs-"+f[i].attr),b):f[i].setDefault&&f[i].defaultVal&&(b=rspkr.setParam(f[i].param,f[i].defaultVal,b));"function"==typeof Array.prototype.indexOf&&-1===rspkr.c.e.onUIStop.indexOf(h.playback.stop)&&rspkr.evt("onUIStop",h.playback.stop),window.readpage(b,"rs_lightboxplayer",{source:"lightbox"}),rspkr.preventDefault(a),h.playback.playing=1,$rs.get(".rslightbox-tool-play").setAttribute("data-rslang","title/arialabel:pause"),$rs.get(".rslightbox-tool-play span").setAttribute("data-rslang","content:pause"),rspkr.Lang.updateUi(document.getElementById("rslightbox_toolbar"))}},stop:function(){if($rs.hasClass("#rslightbox_toolbar","rsplaying")||$rs.hasClass("#rslightbox_toolbar","rspaused")){var a=rspkr.ui.getActivePlayer();a&&"rs_lightboxplayer"!==a.getID()&&a.getContainer()&&"rs_lightboxplayer"!==a.getContainer().id||(h.playback.playing=-1,a&&a.close(),rspkr.u.Lightbox.revertPostState()&&rs.cfg.item("general.usePost",!1),rspkr.u.Lightbox.revertPostState(!1),g("stopped"),$rs.get(".rslightbox-tool-play").setAttribute("data-rslang","title/arialabel:playfromstart"),$rs.get(".rslightbox-tool-play span").setAttribute("data-rslang","content:playfromstart"),rspkr.Lang.updateUi(document.getElementById("rslightbox_toolbar")))}}},fontSize:{initSize:"1.0",min:function(){return rspkr.cfg.item("general.fontSizes.min")||.8},max:function(){return rspkr.cfg.item("general.fontSizes.max")||1.6},increment:function(){return rspkr.cfg.item("general.fontSizes.increment")||.2},getFontSize:function(){var a=parseFloat((document.getElementById("rslightbox_content_inner")||document.getElementById("rsform_wrapper")).style.fontSize);return isNaN(a)&&(a=h.fontSize.initSize),a},setFontSize:function(a){var b=a&&"string"==typeof a&&a.indexOf("em")>-1?a.replace("em",""):parseFloat(Math.round(100*a)/100);(document.getElementById("rslightbox_content_inner")||document.getElementById("rsform_wrapper")).style.fontSize=b+"em",rspkr.st.set("lbfontsize",b),rspkr.devt("onLightboxFontChanged",window)},fontplus:function(){var a=h.fontSize.getFontSize();a<h.fontSize.max()&&h.fontSize.setFontSize(a+=h.fontSize.increment())},fontminus:function(){var a=h.fontSize.getFontSize();a>h.fontSize.min()&&h.fontSize.setFontSize(a-=h.fontSize.increment())},reset:function(){h.fontSize.setFontSize(h.fontSize.initSize)}},volume:{initVol:100,markup:['<div class="rsform-row formrow"><label for="rslightbox_volume_slider">rsVOLUMErs</label>','	<div id="rslightbox_volume_slider_container" class="rslightbox_slider_container rslightbox_volume_container"></div>',"</div>"],open:function(){i.open(h.volume.markup.join("").replace("rsVOLUMErs",rspkr.Lang.getPhrase("volume")),h.volume.opened,"volume")},opened:function(a){var b=new rspkr.u.Slider,c={},d=rspkr.st.get("hlvol")||h.volume.initVol;c.initval=parseInt(d)/100*10,c.steps=10,c.handleClass="rsbtn_volume_handle",c.labelDragHandle="slidervolumedesc",c.start=function(){},c.drop=function(a,b){h.volume.changed(a,b)},b.init($rs.get("#rslightbox_volume_slider_container"),c)},changed:function(a,b){rspkr.st.set("hlvol",10*a),rspkr.pl.setVolume(10*a)},reset:function(){h.volume.changed(parseInt(h.volume.initVol)/100*10)}},speed:{markup:['<div class="rsform-row formrow"><label for="rslightbox_speed_slider">rsSPEEDrs</label>','	<div id="rslightbox_speed_slider_container" class="rslightbox_slider_container rslightbox_speed_container"></div>',"</div>"],open:function(){i.open(h.speed.markup.join("").replace("rsSPEEDrs",rspkr.Lang.getPhrase("speed")),h.speed.opened,"speed")},opened:function(a){var b=new rspkr.u.Slider,c={},d=rspkr.cfg.getSettingsConf().reading.items.hlspeed,e=rspkr.st.get("hlspeed");if(d.options)for(var f in d.options)d.options.hasOwnProperty(f)&&(c[f]=rspkr.st.r().expandPhrase(d.options[f]));c.initval=d.converter?d.converter(e)/(200/d.options.steps):e/(200/d.options.steps)||0,c.start=function(){},c.drop=function(a,b){h.speed.changed(a,b,d)},c.labelDragHandle="speed",b.init($rs.get("#rslightbox_speed_slider_container"),c)},changed:function(a,b,c){var d=rspkr.ui.getActivePlayer()&&rspkr.ui.getActivePlayer().getContainer()&&$rs.hasClass(rspkr.ui.getActivePlayer().getContainer(),"rsplaying")||rspkr.mobile()&&document.getElementById("rsmpl_container")&&$rs.hasClass(document.getElementById("rsmpl_container"),"rsplaying"),e=c.converter?c.converter(parseInt(a))*(200/c.options.steps):parseInt(a)*(200/c.options.steps);rspkr.st.set("hlspeed",e),rspkr.Common.dispatchEvent("onSpeedChanged"),rspkr.pl.releaseAdapter(),d&&h.playback.play()}},textsettings:{markup:['<div class="rsform-row formrow">rslbfontsizers</div>','<div class="rsform-row formrow">rsfontfacers</div>','<div class="rsform-row formrow">rstextstylers</div>'],open:function(){for(var a,b=rspkr.cfg.getSettingsConf().textsettings.items,c=h.textsettings.markup.join(""),d=rspkr.st,e=["lbfontsize","fontface","textstyle"],f=0;f<e.length;f++)b[e[f]]&&(a="lbfontsize"===e[f]?parseFloat(d.get(e[f])).toFixed(1):d.get(e[f]),c=c.replace("rs"+e[f]+"rs",d.r().controls.select(e[f],b[e[f]],a,e[f])));i.open(c,h.textsettings.opened,"textsettings")},opened:function(){$rs.unregEvent("#rslightbox_toolbar_submenu select","change",h.textsettings.changed),$rs.regEvent("#rslightbox_toolbar_submenu select","change",h.textsettings.changed)},changed:function(){var a=$rs.getAttr(this,rspkr.st.e.form.key);switch(rspkr.st.r().handlers.updateSetting.apply(rspkr.st.r().handlers,[a,this.value,this]),a){case"lbfontsize":h.fontSize.setFontSize(this.value);break;case"fontface":h.textsettings.setFontFace(this.value);break;case"textstyle":h.textsettings.setTextStyle(this.value)}},setFontFace:function(a){$rs.css("#rslightbox_content","fontFamily",rspkr.cfg.item("fontmap."+a)),rspkr.devt("onLightboxFontChanged",window)},setTextStyle:function(a){var b=rspkr.cfg.item("textstyles."+a).split(","),c=b.shift(),d=b.shift();$rs.css("#rslightbox_content","color",c||"#000"),$rs.css("#rslightbox_content","background",d||"#fff"),rspkr.devt("onLightboxFontChanged",window)},reset:function(){h.textsettings.setFontFace(rspkr.cfg["default"]("settings.fontface")),h.textsettings.setTextStyle(rspkr.cfg["default"]("settings.textstyle"))}}},i={markup:['<div id="rslightbox_toolbar_submenu" data-tool="">','	<div class="inner-container"></div>','	<div id="rslightbox_toolbar_submenu_closer"><button class="rsbtn_close" data-rslang="title/arialabel:close"><span class="rsicn rsicn-arrow-up"></span><span class="rsbtn_btnlabel"></span></button></div>',"</div>"],open:function(a,b,c){if(!$rs.arr("#rslightbox_toolbar_submenu").length){var d=document.createElement("div");d.innerHTML=i.markup.join(""),$rs.get("#rslightbox_contentcontainer").insertBefore(d.firstChild,$rs.get("#rslightbox_closer_container")),$rs.regEvent("#rslightbox_toolbar_submenu_closer .rsbtn_close","click",i.close),rspkr.c.clearEvent("onLightboxClosed",i.close),rspkr.evt("onLightboxClosed",i.close)}return c===$rs.getAttr($rs.get("#rslightbox_toolbar_submenu"),"data-tool")?void i.close():($rs.setAttr($rs.get("#rslightbox_toolbar_submenu"),"data-tool",c),$rs.get("#rslightbox_toolbar_submenu .inner-container").innerHTML=a,$rs.css($rs.get("#rslightbox_toolbar_submenu"),"display","block"),$rs.regEvent("#rslightbox_content","click",i.close),"function"==typeof b&&b.apply(this,[$rs.get("#rslightbox_toolbar_submenu")]),rspkr.Lang.updateUi("#rslightbox_toolbar_submenu"),void $rs.css("#rslightbox_toolbar_submenu","display","block"))},close:function(a){$rs.unregEvent("#rslightbox_content","click",i.close),$rs.css($rs.get("#rslightbox_toolbar_submenu"),"display","none"),$rs.get("#rslightbox_toolbar_submenu").removeAttribute("data-tool"),"function"==typeof a&&a.apply(this,[$rs.get("#rslightbox_toolbar_submenu")])}},j=function(){},k=function(){for(var a in h)h.hasOwnProperty(a)&&"function"==typeof h[a].reset&&h[a].reset()};return{reset:k,init:j,getTools:b,setAvailableTools:f,addEvents:d,removeEvents:e,stopPlay:h.playback.stop,setPlayerState:g}}(),window.ReadSpeaker.ui.LoadIndicator=function(){var a,b=function(a){return"object"==typeof a&&a.nodeName?a:"object"==typeof a&&a.getContainer?a.getContainer():"string"==typeof conf.player&&(a=$rs.arr(conf.player))&&a.length?a[0]:void 0},c=function(){rspkr.features.loaderscreen===!0&&(rspkr.ui.Overlay.show(),a||(a=$rs.createElm("div",{id:"rs_loadindicator_fullscreen",attributes:{"aria-hidden":!0},content:['<div class="rs_spinner rs_spinner1"></div>','<div class="rs_spinner rs_spinner2"></div>','<div class="rs_spinner rs_spinner3"></div>'].join(""),parent:document.body})),a.style.display="block",a.style.zIndex=rspkr.ui.utils.getMaxZ(!0)+10)},d=function(a){if(rspkr.features.loaderplayer===!0){var c=b(a.player);if(c&&$rs.isVisible(c)){var d=$rs.findIn(c,".rsbtn_play"),e=$rs.findIn(c,".rsbtn_exp_inner"),f=$rs.findIn(c,".rs-player-loadindicator");$rs.isArray(f)&&(f=$rs.createElm("div",{cls:"rs-player-loadindicator",content:'<div class="rsbtn-progress"></div><div class="rsbtn-loading"></div>',parent:e})),f.style.left=$rs.isArray(d)?"0":-1*$rs.width(d)+"px",f.style.display="block",$rs.findIn(f,".rsbtn-progress").style.display="none",$rs.findIn(f,".rsbtn-loading").style.display="block"}}},e=function(a){rspkr.features.progressbar!==!0&&g();var c=b(a.player);if(c&&a&&a.progress){var d=$rs.findIn(c,".rs-player-loadindicator");if(!$rs.isArray(d)){$rs.findIn(d,".rsbtn-loading").style.display="none";var e=$rs.findIn(d,".rsbtn-progress");e.style.display="block",e.style.width=0===a.progress[0]?"0%":Math.round(a.progress[0]/a.progress[1]*100)+"%"}}},f=function(a){a=a||{},!a.player||void 0!==typeof a.fullscreen&&a.fullscreen===!0?c():d(a)},g=function(b){b=b||{},b.keepOverlay!==!0&&rspkr.ui.Overlay.hide({type:"fullscreen"}),a&&(a.style.display="none"),$rs.css($rs.arr(".rs-player-loadindicator"),"display","none")},h=function(){ReadSpeaker.Common.addEvent("onUIStop",function(){$rs.css($rs.arr(".rsbtn-progress, .rsbtn-loading"),"display","none")})};return{hide:g,init:h,show:f,update:e}}(),window.ReadSpeaker.ui.Overlay=function(){var a,b=function(b){b=b||{},a?a.style.display="":a=$rs.createElm("div",{id:"rs_overlay",attributes:{"aria-hidden":!0},parent:document.body}),b.click&&"function"==typeof b.click&&$rs.regEvent(a,"click",b.click)},c=function(a){var b;if("object"==typeof a.player&&a.player.getContainer&&(b=a.player.getContainer()),"string"==typeof a.player&&(b=$rs.arr(a.player))&&b.length&&(b=b[0]),b){$rs.removeClass(b,"rsloading");var c=$rs.findIn(b,".rsbtn_status_overlay");$rs.isArray(c)&&(c=$rs.createElm("span",{cls:"rsbtn_status_overlay",content:'<span class="rsbtn_status"></span>',parent:$rs.findIn(b,".rsbtn_exp_inner")}));var d=$rs.findIn(b,".rsbtn_status");if(d.innerHTML="",a.message&&"nosound"===a.message)$rs.createElm("a",{cls:"rsbtn_nosound",content:rspkr.Lang.getPhrase("nosound"),click:function(a){return _activePlayer.nosound()}});else if(a.message&&"loaderror"===a.message){d.innerHTML=rspkr.Lang.getPhrase("loaderror")||"An error has occurred, try again";var e=rspkr.c.data.getSaveData("link");$rs.createElm("a",{cls:"rsbtn_loaderror",content:rspkr.Lang.getPhrase("nosoundlink")||"[?]",href:e,attributes:{target:"_blank"},click:function(a){rspkr.preventDefault(a);var b="<iframe src='"+e+"' style='height:100%;width:100%;border:0;'></iframe>";rspkr.ui.Lightbox.show(b,null,!1,null,300)},parent:d})}else a.message&&(d.innerHTML=a.message);c.style.display="inline",rspkr.ui.LoadIndicator.hide()}},d=function(a){a=a||{},a.player&&a.fullscreen!==!0?c(a):b(a)},e=function(b){b=b||{},"player"!==b.type&&(a&&(a.style.display="none"),$rs.unregEvent(a,"click")),"fullscreen"!==b.type&&$rs.css($rs.arr(".rsbtn_status_overlay"),"display","none")};return{hide:e,show:d}}(),window.ReadSpeaker.ui.PieTimer=function(){var a,b,c,d,e,f,g=0,h=Math.PI,i=null,j={size:24,time:3e3},k=['<svg width="[[size]]" height="[[size]]" viewbox="0 0 [[size]] [[size]]">','<path id="rspie_timer_loader" transform="translate([[halfsize]], [[halfsize]])"/>',"</svg>"],l=function(){g++;var a=g*h/180,d=Math.sin(a)*(c/2),f=Math.cos(a)*-(c/2),j=g>180?1:0,k="M 0 0 v -"+c/2+" A "+c/2+" "+c/2+" 1 "+j+" 1 "+d+" "+f+" z";b.setAttribute("d",k),360>g?i=setTimeout(l,e):g=0},m=function(g,h){if(!g||!g.nodeType||g.nodeType!==Node.ELEMENT_NODE)return!1;o();var i={};rspkr.cfg.mergeObj(j,i),h&&"object"==typeof h&&rspkr.cfg.mergeObj(h,i),a=g,c=i.size,d=i.time,e=d/360,f=g.appendChild(n(c)),b=$rs.get("#rspie_timer_loader",g.ownerDocument),l()},n=function(a){var b=document.createElement("div"),c=k.join("").replace(/\[\[size\]\]/gi,a).replace(/\[\[halfsize\]\]/gi,a/2);return b.innerHTML=c,b.children[0]},o=function(){a&&f&&(a.removeChild(f),f=null),window.clearTimeout(i),g=0};return{start:m,draw:l,stop:o}}(),ReadSpeaker.ui.Player=function(a){var b=a,c=function(){return b},d=rspkr.getID(),e=this,f=null,g=!1,h=[],i=0,j=!1,k=null,l=!1,m={_play:null,_pause:null,_stop:null,_vol:null,_settings:null,_dl:null,_closer:null,_get:function(a,b){var d;return a="_"+a,d=c()?this[a]&&this[a].length?this[a]:this[a]=$rs.findIn(c(),b):null,$rs.isArray(d)&&!d.length?null:d},play:function(){return this._get("play",".rsbtn_play")},pause:function(){return this._get("pause",".rsbtn_pause")},stop:function(){return this._get("stop",".rsbtn_stop")},vol:function(){return this._get("vol",".rsbtn_volume")},speed:function(){return this._get("speed",".rsbtn_speed")},settings:function(){return this._get("settings",".rsbtn_settings")},dl:function(){return this._get("dl",".rsbtn_dl")},rewind:function(){return this._get("rewind",".rsbtn_rewind")},forward:function(){return this._get("forward",".rsbtn_forward")},closer:function(){return this._get("closer",".rsbtn_closer")},nosound:function(){return this._get("nosound",".rsbtn_nosound")},setPlayPause:function(a){rspkr.log("[rspkr.ui.Player.setPlayPause("+a+")]");var b=a?$rs.hasClass(c(),"rsstopped")?"playfromstart":"resume":"pause";$rs.setAttr(this.pause(),"data-rslang","title/arialabel:"+b),$rs.setAttr($rs.findIn(this.pause(),".rsbtn_btnlabel"),"data-rslang","content:"+b),rspkr.Lang.updateUi(this.pause())}},n={progress:{dragging:!1}},o=[],p=function(){if(0===$rs.findIn(b,".rsbtn_exp").length){var a=document.createElement("div");a.className="rsbtn_exp rsimg rspart",a.innerHTML+=rspkr.cfg.item("ui.player31").join("\n");var d=$rs.findIn(c(),".rsbtn_play");d.length>1&&(d=d[0]),!$rs.isArray(d)&&d.tagName&&d.tagName.length?d.parentNode.insertBefore(a,d.nextSibling):c().appendChild(a)}m.stop()&&$rs.setAttr(m.stop(),"accessKey","x"),m.dl()&&!rspkr.features.download_player&&m.dl().parentNode.removeChild(m.dl()),m.speed()&&!rspkr.features.speedbutton&&m.speed().parentElement.removeChild(m.speed()),m.rewind()&&!rspkr.features.skipbuttons&&m.rewind().parentElement.removeChild(m.rewind()),m.forward()&&!rspkr.features.skipbuttons&&m.forward().parentElement.removeChild(m.forward()),rspkr.Lang.filters.skipBtns=function(a,b){var c=parseInt(rspkr.cfg.item("general.skipIntervalSec"))||5;if("ja_jp"===b){var d=String(c).split("");c="";for(var e=0;e<d.length;e++)c+=String.fromCharCode(parseInt("FF1"+d[e],16))}return a.replace("$s",c)},rspkr.Lang.updateUi(a)},q={beforeSyncFn:function(){l=!0,rspkr.pl.getProgress.apply(rspkr.pl,[!0,s,e])},beforeSyncExitFn:function(){rspkr.c.clearEvent("onBeforeSyncInit",q.beforeSyncFn),rspkr.c.clearEvent("onBeforeSyncExit",q.beforeSyncExitFn),rspkr.pl.getProgress.apply(rspkr.pl,[!1,s,e])},play:function(){rspkr.c.dispatchEvent("onUIBeforePlay"),rspkr.log("[rspkr.ui.handlers.play]"),o.progress&&o.progress.disabled(!1);var a=$rs.hasClass(c(),"rsstopped");if(rspkr.Common.Player.setStateClass(c(),"rsloading"),$rs.addClass($rs.findIn(c(),".rsbtn_progress_container"),"rsloading"),rspkr.ui.LoadIndicator.show({player:c()}),m.setPlayPause(!1),!rspkr.ui.getActivePlayer()||rspkr.ui.getActivePlayer().getContainer()!=c()){rspkr.ui.getActivePlayer()&&rspkr.ui.getActivePlayer().close();var b=$rs.findIn(c(),".rsbtn_play");return void window.readpage(b)}a&&(rspkr.pl.playerRef||rspkr.audio&&"suspended"!==rspkr.audio.state)?rspkr.pl.restart():rspkr.pl.play(),l&&rspkr.pl.getProgress.apply(rspkr.pl,[!0,s,e]),rspkr.c.addEvent("onBeforeSyncInit",q.beforeSyncFn),rspkr.c.addEvent("onBeforeSyncExit",q.beforeSyncExitFn),rspkr.c.dispatchEvent("onUIAfterPlay"),rspkr.cfg.execCallback("cb.ui.play",c());var d=rs.cfg.item("ui.playbackFocus")?$rs.get(rs.cfg.item("ui.playbackFocus")):m.pause();d&&rspkr.ui.utils.playerInViewport(d)&&d.focus()},pause:function(){rspkr.log("[rspkr.ui.handlers.pause]"),rspkr.Common.Player.setStateClass(c(),"rspaused"),m.setPlayPause(!0),rspkr.pl.pause(),rspkr.pl.getProgress(!1),rspkr.c.dispatchEvent("onUIPause"),rspkr.cfg.execCallback("cb.ui.pause",c()),rspkr.log("ReadSpeaker.ui.pause")},stop:function(){rspkr.log("[rspkr.ui.handlers.stop]"),o.progress&&o.progress.disabled(!0),rspkr.Common.Player.setStateClass(c(),"rsstopped"),$rs.removeClass($rs.findIn(c(),".rsbtn_progress_container"),"rsloading"),m.setPlayPause(!0),$rs.setAttr(c(),"data-readspeaker-current",0),o.progress&&(o.progress.jumpTo(0),r(0)),rspkr.pl.stop(),rspkr.pl.getProgress(!1),rspkr.c.dispatchEvent("onUIStop",c()),rspkr.cfg.execCallback("cb.ui.stop",c()),rspkr.cfg.item("ui.preventPlaybackFocus")||document.getElementById("rslightbox_contentcontainer")&&$rs.isVisible(document.getElementById("rslightbox_contentcontainer"))||rspkr.ui.utils.playerInViewport()&&m.pause().focus(),rspkr.HL.chunking.currentChunkNumber>1&&(rspkr.HL.chunking.destroy(),rspkr.pl.hasOwnProperty("releaseAdapter")&&rspkr.pl.releaseAdapter()),rspkr.log("ReadSpeaker.ui.stop")},openDropdown:function(a,b){rspkr.preventDefault(a);var d="vol"===b?"volume":"speed",e=$rs.findIn(c(),".rsbtn_"+d+"_container"),f=$rs.findIn(c(),".rsbtn_"+d),g=(a.originalEvent,function(a){for(var b,c=$rs.arr(".rsbtn_dropdown"),d=0;b=c[d];d++)a&&b===a||($rs.css(b,"display","none"),$rs.unregEvent(document.body,"click",h),$rs.unregEvent(document.body,"keyup",h))}),h=function(a){var b=a.originalEvent,c=b.srcElement||b.originalTarget,i=$rs.closest(c,".rsbtn_"+d+"_container");("click"===a.type&&(void 0===i||$rs.isArray(i)&&!i.length)||"keyup"===a.type&&27===a.keyCode)&&($rs.css(e,"display","none"),$rs.unregEvent(document.body,"click",h),$rs.unregEvent(document.body,"keyup",h)),$rs.setAttr(f,"aria-expanded",!1),g(i)};g(e),$rs.css(e,"left",f.offsetLeft+"px"),$rs.css(e,"display","none"===$rs.css(e,"display")?"block":"none"),$rs.css(e,"zIndex",rspkr.u.utils.getMaxZ(!0)+20),"block"===$rs.css(e,"display")?($rs.regEvent(document.body,"click",h),$rs.regEvent(document.body,"keyup",h)):($rs.unregEvent(document.body,"click",h),$rs.unregEvent(document.body,"keyup",h));var i={keyCode:13},j=$rs.findIn(e,".keyLink");try{o[b].startDragKeys(j,i)}catch(a){rspkr.log("[rspkr.ui.handlers."+b+"] Error accessing object _sliders['"+b+"']")}return"block"===$rs.css(e,"display")?$rs.setAttr(f,"aria-expanded",!0):$rs.setAttr(f,"aria-expanded",!1),!1},vol:function(a){q.openDropdown(a,"vol")},speed:function(a){q.openDropdown(a,"speed")},settings:function(){},closeSettings:function(){var a=$rs.get("rslightbox_closer");$rs.unregEvent(a,"click",q.closeSettings),rspkr.c.dispatchEvent("onSettingsClosed",window,[])},close:function(a){a=a||!1;var b=rspkr.pl;rspkr.HL.chunking.destroy(),a||rspkr.cfg.execCallback("cb.ui.beforeclose",c()),b.hasOwnProperty("releaseAdapter")&&rspkr.pl.releaseAdapter(),$rs.setAttr(c(),"data-readspeaker-current",0),o.progress&&(o.progress.jumpTo(0),r(0)),$rs.removeClass(c(),"rsstopped rsplaying rspaused rsexpanded rsloading"),$rs.hasClass(c(),"rsfloating")&&$rs.removeClass(c(),rspkr.ui.rsbtnClass),m.setPlayPause(!0),$rs.css(c(),"width","auto"),delete rspkr.displog.onVolumeAdjusted,a||(rspkr.c.dispatchEvent("onUIClosePlayer",c(),["userclick"]),rspkr.cfg.execCallback("cb.ui.close",c()),rspkr.log("ReadSpeaker.ui.close: "+c())),rspkr.cfg.item("ui.preventPlaybackFocus")||a||rspkr.ui.Detach.isDetached()||rspkr.ui.focus($rs.findIn($rs.get(c()),".rsbtn_play")),$rs.setAttr($rs.findIn(c(),"a.rsbtn_play"),"aria-expanded",!1)},dl:function(a){$rs.hasClass(c(),"rsplaying")&&this.pause();var b=$rs.getAttr($rs.findIn(c(),".rsbtn_play"),"href"),d=b?rspkr.c.data.getSaveData("dialog",b):rspkr.c.data.getSaveData("dialog"),e=/ios/i.test(rspkr.c.data.browser.OS);rspkr.log("[rspkr.ui.handlers.dl] Savelink: "+d),rspkr.u.Lightbox.show(this.getDlDialog(),this.getDlButtons(e,d),!0,function(){var a=$rs.get("#rsdl_button_accept"),b=$rs.get("#rsdl_button_decline");a&&$rs.regEvent(a,"click",function(b){rspkr.u.Lightbox.hide(b);var c="iOS"!==rspkr.c.data.browser.OS;if(c){var e=null;if(document.getElementById("dliframe"))e=document.getElementById("dliframe");else{if(document.selection)try{e=document.createElement('<iframe name="dliframe">')}catch(f){e=document.createElement("iframe")}else e=document.createElement("iframe");$rs.setAttr(e,"name","dliframe"),$rs.setAttr(e,"id","dliframe"),/Explorer/i.test(rspkr.c.data.browser.name)||$rs.setAttr(e,"sandbox","allow-same-origin allow-scripts allow-downloads"),$rs.css(e,"display","none"),$rs.css(e,"position","absolute");var g=$rs.get("body");if(g=$rs.isArray(g)?g[0]:g,!g)return;g.appendChild(e)}return $rs.setAttr(e,"src",d),!1}return $rs.setAttr(a,"href",d),!0}),b&&($rs.regEvent(b,"click",function(a){rspkr.preventDefault(a),rspkr.u.Lightbox.hide(a)}),setTimeout(function(){rspkr.ui.focus(b)},200)),rspkr.c.dispatchEvent("onDownloadLoaded",window,[])},!1,"[fontplus fontminus] [volume speed textsettings]",{customFont:!0,customTextStyle:!0,customFontSize:!0})},rewind:function(a){rspkr.pl.rewind()},forward:function(a){rspkr.pl.forward()},getDlDialog:function(){var a=rspkr.cfg.item("ui.dldialog").join("\n"),b={};return b.rsTERMS_OF_USE_HEADINGrs=rspkr.Lang.getPhrase("touheading"),b.rsTERMS_OF_USE_BODYrs=rspkr.Lang.getPhrase("toubody"),'<div id="rslightbox_content_inner">'+rspkr.st.r().replaceTokens(a,b)+"</div>"},getDlButtons:function(a,b){var c=rspkr.cfg.item("ui.dlbuttons").join("\n"),d={};if(d.rsTERMS_OF_USE_ACCEPTrs=rspkr.Lang.getPhrase("touaccept"),d.rsTERMS_OF_USE_DECLINErs=rspkr.Lang.getPhrase("toudecline"),c=rspkr.st.r().replaceTokens(c,d),a&&b){var e,f=document.createElement("div");f.innerHTML=c,e=$rs.findIn(f,"#rsdl_button_accept"),e&&(e.href=b,$rs.setAttr(e,"target","_blank"),$rs.setAttr(e,"download",""),c=f.innerHTML)}return c},nosound:function(){var a=rspkr.c.data.getSaveData("link");return $rs.setAttr(m.nosound(),"href",a),!0}},r=function(a){a=a>100?100:a;var b=$rs.findIn(c(),".rsbtn_progress_played");"object"==typeof b&&$rs.css(b,"width",a+"%"),rspkr.cfg.execCallback("cb.ui.progresschanged",c(),[a])},s=function(a){if(a.length){rspkr.features.progressbar&&rspkr.ui.LoadIndicator.update({player:c(),progress:a});var b=parseInt(a[0]),d=parseInt(a[1]),e=0==d?0:Math.round(b/d*100),f=t(b),g=t(d);if(rspkr.features.seekbar){var h=$rs.findIn(c(),".rsbtn_progress_container");if(o.progress&&(o.progress.setCurrentValue(e),!n.progress.dragging||!$rs.isArray($rs.findIn(h,".rskeycontrolled")))){o.progress.jumpTo(e),r(e);var i=$rs.findIn(c(),".rsbtn_current_time"),j=$rs.findIn(c(),".rsbtn_total_time");i&&(i.innerHTML=f),j&&(j.innerHTML=g)}}rspkr.cfg.execCallback("cb.ui.timeupdated",c(),[f,g]),rspkr.log("[rspkr.player.updateProgress] current time: "+b+" total time: "+d),$rs.setAttr(c(),"data-readspeaker-current",b),$rs.setAttr(c(),"data-readspeaker-buffered",d),a[0]>0&&($rs.removeClass(h,"rsloading"),rspkr.Common.Player.setStateClass(c(),"rsplaying"))}},t=function(a){a/=1e3;var b=parseInt(a%60),c=parseInt(a/60%60),d=parseInt(a/60/60%60);return u(d)+":"+u(c)+":"+u(b)},u=function(a){return 10>a?"0"+a:a.toString()},v=function(){n.progress.dragging=!0},w=function(a,b){if(rspkr.log("_dropProgress ("+a+")",5),a){var d=a/100*$rs.getAttr(c(),"data-readspeaker-buffered")/1e3;rspkr.pl.setProgress(d)}n.progress.dragging=!1},x=function(a){w(a)},y=function(a,b){return rspkr.log("_dropVolume, "+a,5),a=0>a?0:10*a,o.vol&&o.vol.jumpTo(a/10),rspkr.pl.setVolume(a),rspkr.st.set("hlvol",a),rspkr.cfg.execCallback("cb.ui.volumechanged",c(),[a]),!1},z=function(a){var b=rspkr.ui.getActivePlayer()&&rspkr.ui.getActivePlayer().getContainer()&&$rs.hasClass(rspkr.ui.getActivePlayer().getContainer(),"rsplaying")||rspkr.mobile()&&document.getElementById("rsmpl_container")&&$rs.hasClass(document.getElementById("rsmpl_container"),"rsplaying"),c=Math.round(5+a/40*195);rspkr.ui.getActivePlayer()&&rspkr.ui.getActivePlayer().stop(),rspkr.pl.releaseAdapter(),rspkr.HL.sync.fullCleanUp(),rspkr.st.set("hlspeed",c),rspkr.Common.dispatchEvent("onSpeedChanged"),setTimeout(function(){if(b&&rspkr.ui.getActivePlayer()){var a=$rs.findIn(rspkr.ui.getActivePlayer().getContainer(),".rsbtn_play");a||(a=rspkr.findHref()),window.readpage(a)}},500)},A=function(a,b){if("keyLink"===a.className){var d="";$rs.hasClass(b,"rsbtn_volume_handle")?d="vol":$rs.hasClass(b,"rsbtn_progress_handle")&&(d="progress");var e={keyCode:13};o[d].startDragKeys(a,e)}else if($rs.hasClass(b,"rsbtn_volume")){var e={keyCode:13},f=$rs.findIn(c(),".rsbtn_volume_container"),g=$rs.findIn(f,".keyLink");o.vol.startDragKeys(g,e)}},B=function(a,b){if("keyLink"===a.className){var c="";$rs.hasClass(b,"rsbtn_volume_handle")?c="vol":$rs.hasClass(b,"rsbtn_progress_handle")&&(c="progress"),o[c].releaseElement(),n.progress.dragging=!1}},C=function(a,b){h.push([a,b||[]])};return{init:function(){g?this.show():C(this.show)},show:function(a,e){var g=a?!0:!1,h=$rs.hasClass(c(),"rsexpanded");
if(f=$rs.rsid(b),b.id=d=b.id||rspkr.getID(),ui=rspkr.ui,$rs.hasClass(b,rspkr.ui.rsbtnClass)||$rs.addClass(b,rspkr.ui.rsbtnClass),"rsbtn"!==rspkr.ui.rsbtnClass&&$rs.addClass(b,"rsbtn"),p(),e&&e.source&&"lightbox"!==e.source&&rspkr.ui.Overlay.hide(),"fallback"===rspkr.pl.adapter&&(rspkr.ui.Overlay.show({player:rspkr.ui.getActivePlayer(),message:"nosound"}),$rs.addClass(c(),"rsstopped")),$rs.addClass(b,"rsexpanded"),!j&&!h){if(m.stop()){var i=function(a){rspkr.preventDefault(a),q.stop()};$rs.unregEvent(m.stop(),"click",i),$rs.regEvent(m.stop(),"click",i),ui.addFocusHandler(m.stop())}if(m.pause()){var k=function(a){rspkr.preventDefault(a),$rs.hasClass(b,"rsplaying")||$rs.hasClass(b,"rsloading")?q.pause():($rs.hasClass(b,"rsstopped")||$rs.hasClass(b,"rspaused"))&&q.play()};$rs.unregEvent(m.pause(),"click",k),$rs.regEvent(m.pause(),"click",k),ui.addFocusHandler(m.pause())}if(m.closer()){var l=function(a){rspkr.preventDefault(a),q.close()};$rs.unregEvent(m.closer(),"click",l),$rs.regEvent(m.closer(),"click",l),ui.addFocusHandler(m.closer())}if(m.vol()){var n=function(a){rspkr.preventDefault(a),q.vol(a)};$rs.unregEvent(m.vol(),"click",n),$rs.regEvent(m.vol(),"click",n),ui.addFocusHandler(m.vol())}if(m.speed()){var r=function(a){rspkr.preventDefault(a),q.speed(a)};$rs.unregEvent(m.speed(),"click",r),$rs.regEvent(m.speed(),"click",r),ui.addFocusHandler(m.speed())}if(m.dl()){var s=function(a){return rspkr.preventDefault(a),q.dl(a)};$rs.unregEvent(m.dl(),"click",s),$rs.regEvent(m.dl(),"click",s),ui.addFocusHandler(m.dl())}if(m.rewind()){var t=function(a){return rspkr.preventDefault(a),q.rewind(a)};$rs.unregEvent(m.rewind(),"click",t),$rs.regEvent(m.rewind(),"click",t),ui.addFocusHandler(m.rewind())}if(m.forward()){var u=function(a){return rspkr.preventDefault(a),q.forward(a)};$rs.unregEvent(m.forward(),"click",u),$rs.regEvent(m.forward(),"click",u),ui.addFocusHandler(m.forward())}var C=rspkr.cfg;$rs.setAttr(c(),"data-readspeaker-current",0),$rs.setAttr(c(),"data-readspeaker-buffered",0);var D=$rs.findIn($rs.get(b),".rsbtn_progress_container");if(!$rs.isArray(D))if(rspkr.features.seekbar===!0){$rs.addClass(b,"has-progressbar"),o.progress=new rspkr.ui.Slider,o.progress.init(D,{handleClass:C.item("ui.progressHandleClass")||"rsbtn_progress_handle rsimg",dir:C.item("ui.progressDir")||"h",nudge:5,start:v,dragging:w,click:x,labelDragHandle:"sliderseek"});var E=$rs.findIn($rs.get(b),".rsbtn_progress_handle a");ui.addFocusHandler(E,!1,E.parentNode);var F=$rs.findIn(b,".rsbtn_rewind"),G=$rs.findIn(b,".rsbtn_forward");F&&F.parentElement&&F.parentElement.removeChild(F),G&&G.parentElement&&G.parentElement.removeChild(G)}else D.parentElement.removeChild(D);if(!$rs.isArray($rs.findIn($rs.get(b),".rsbtn_volume_slider"))){var H=rspkr.st.get("hlvol")||"100",I=parseInt(H)/100*10;o.vol=new rspkr.ui.Slider,o.vol.init($rs.findIn(b,".rsbtn_volume_slider"),{handleClass:C.item("ui.volumeHandleClass")||"rsbtn_volume_handle rsimg",dir:C.item("ui.volumeDir")||"v",steps:10,nudge:1,initval:I,dragging:y,click:y,labelDragHandle:"slidervolumedesc"});var J=$rs.findIn($rs.get(b),".rsbtn_volume_handle a");ui.addFocusHandler(J,!1,J.parentNode),rspkr.Common.addEvent("onAPISetVolume",function(){o.vol.setCurrentValue(parseInt(rspkr.st.get("hlvol"))/100*10),o.vol.rerender()})}if(!$rs.isArray($rs.findIn($rs.get(b),".rsbtn_speed_slider"))){var K=rspkr.st.get("hlspeed")||100,L=Math.round(K/200*41-1);o.speed=new rspkr.ui.Slider,o.speed.init($rs.findIn(b,".rsbtn_speed_slider"),{handleClass:C.item("ui.speedHandleClass")||"rsbtn_speed_handle rsimg",dir:C.item("ui.speedDir")||"v",steps:40,nudge:1,initval:L,drop:z,labelDragHandle:"speed"});var M=$rs.findIn($rs.get(b),".rsbtn_speed_handle a");ui.addFocusHandler(M,!1,M.parentNode),rspkr.Common.addEvent("onSpeedChanged",function(){o.speed.setCurrentValue(Math.round(rspkr.st.get("hlspeed")/200*41-1)),o.speed.rerender()})}rspkr.Common.addEvent("onFocusIn",A),rspkr.Common.addEvent("onFocusOut",B),rspkr.cfg.execCallback("cb.ui.open",b),j=!0}"0"!=$rs.getAttr(c(),"data-readspeaker-current")&&(rspkr.pl.releaseAdapter(),$rs.setAttr(c(),"data-readspeaker-current",0)),"fallback"===rspkr.pl.adapter||g?(o.progress&&o.progress.disabled(!0),rspkr.Common.Player.setStateClass(c(),"rsstopped"),$rs.removeClass($rs.findIn(c(),".rsbtn_progress_container"),"rsloading")):(q.play(),!rspkr.cfg.item("ui.preventPlaybackFocus")&&$rs.isVisible(m.pause())&&rspkr.ui.focus(m.pause())),$rs.setAttr($rs.findIn(b,"a.rsbtn_play"),"aria-expanded",!0)},close:function(a){q.close(a)},stop:function(){q.stop()},nosound:function(){return q.nosound()},pause:function(){q.pause()},play:function(){q.play()},dl:function(a){q.dl(a)},rewind:function(a){q.rewind(a)},forward:function(a){q.forward(a)},closeSettings:function(){q.closeSettings()},vol:function(a){q.vol(a)},speed:function(a){q.speed(a)},restart:function(){rspkr.pl.restart()},updateProgress:function(a){s(a)},setProgress:function(a){w(a)},getContainer:c,getID:function(){return d},getWidth:function(){return i},setHref:function(a){k=a},getHref:function(){return k}}},ReadSpeaker.ui.ScrollControls=function(){var a,b=!1,c=['<span class="rsbtn_btnlabel" data-rslang="content:popupcontrols"></span>','<span class="rsicn rsicn-rslogo-2019"></span>','<button type="button" class="rsbtn_scroll_playpause" data-rslang="title/arialabel:pause"><span class="rsicn rsicn-pause" aria-hidden="true"></span></button>','<button type="button" class="rsbtn_scroll_togglescroll" aria-hidden="true" data-rslang="title/arialabel:autoscroll">','	<span class="rsbtn_scroll_label" data-rslang="content:autoscroll"></span>: ','	<span class="rsbtn_scroll_state" data-rslang="content:on"></span>',"</button>",'<button type="button" class="rsbtn_scroll_close" data-rslang="title/arialabel:close"><span class="rsicn rsicn-cross" aria-hidden="true"></span></button>','<div aria-hidden="true" class="rsbtn_focusforward"><button accesskey="c" tabindex="-1" aria-hidden="true"></button></div>'].join("\n"),d=function(){b=!0},e=function(){b=!1},f=function(){h()},g=function(){rspkr.Common.addEvent("onUIBeforePlay",d),rspkr.Common.addEvent("onUIAfterPlay",h),rspkr.Common.addEvent("onUIStop",m),rspkr.Common.addEvent("onUIClosePlayer",m),rspkr.Common.addEvent("onUIAfterPlay",function(){o(void 0,"play")}),rspkr.Common.addEvent("onUIPause",function(){o(void 0,"pause")});var a=$rs.getReadingFrames(window);a.forEach(function(a){try{a.addEventListener("scroll",f)}catch(b){}})},h=function(){if(b&&!rspkr.mobile()&&rspkr.features.scrollcontrols){var a=$rs.get("#rslightbox_contentcontainer");if(a&&!$rs.isArray(a)&&$rs.isVisible(a))return void l();var c=rspkr.ui.getActivePlayer(),d=c?c.getContainer():void 0;d&&(i(d)&&"scrolloff"!==rspkr.st.get("hlscroll")?i(d)&&l():k())}},i=function(a){var b=a.getBoundingClientRect(),c=b.top-(rs.cfg.item("ui.autoscrollOffset")||0)>=0&&b.left>=0&&b.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&b.right<=(window.innerWidth||document.documentElement.clientWidth);return c},j=function(){if(rspkr.HL.customHL.active()){var b=rspkr.cfg.item("ui.ScrollControls.horizontal")||"right",c=rspkr.cfg.item("ui.ScrollControls.vertical")||"top";d="17px",a.style.right=a.style.left=a.style.top=a.style.bottom="auto",a.style[b]=d,a.style[c]=d}else{var b=rspkr.cfg.item("ui.ScrollControls.horizontal")||"right",c=rspkr.cfg.item("ui.ScrollControls.vertical")||"bottom",d="17px";a.style.right=a.style.left=a.style.top=a.style.bottom="auto",a.style[b]=d,a.style[c]=d}},k=function(){if(!a||"none"===a.style.display){if(!a){a=document.createElement("div"),a.id="rsbtn_scrollcontrols",a.className="unselectable",a.innerHTML=c,$rs.setAttr(a,"tabindex","0"),$rs.regEvent($rs.findIn(a,".rsbtn_scroll_playpause"),"click",o),$rs.regEvent($rs.findIn(a,".rsbtn_scroll_close"),"click",p),$rs.regEvent($rs.findIn(a,".rsbtn_scroll_togglescroll"),"click",n),$rs.regEvent($rs.findIn(a,".rsbtn_focusforward"),"click",function(b){a.focus()}),document.body.appendChild(a),rspkr.Lang.updateUi(a);var b=function(){var b=a.querySelector(".rsbtn_scroll_togglescroll");b.style.width="auto",$rs.findIn(b,"span.rsbtn_scroll_state").innerHTML=rspkr.Lang.getPhrase("on");var c=b.getBoundingClientRect().width;$rs.findIn(b,"span.rsbtn_scroll_state").innerHTML=rspkr.Lang.getPhrase("off");var d=b.getBoundingClientRect().width;b.style.width=Math.max(c,d)+4+"px"};rspkr.c.addEvent("onLangUpdated",b),b()}n(void 0,rspkr.st.get("hlscroll")),j(),a.style.zIndex=rspkr.ui.utils.getMaxZ(!0),a.style.display=""}},l=function(){a&&(a.style.display="none")},m=function(){l(),e()},n=function(b,c){if(a){var d=$rs.findIn(a,".rsbtn_scroll_togglescroll"),e=$rs.getAttr(d,"data-scroll-state");"scrollon"===c&&(e="scrolloff"),"scrolloff"===c&&(e="scrollon"),e&&"scrollon"!==e?($rs.setAttr(d,"data-scroll-state","scrollon"),$rs.addClass(d,"enabled"),rspkr.st.set("hlscroll","scrollon"),$rs.setAttr($rs.findIn(d,"span.rsbtn_scroll_state"),"data-rslang","content:on")):($rs.setAttr(d,"data-scroll-state","scrolloff"),$rs.removeClass(d,"enabled"),rspkr.st.set("hlscroll","scrolloff"),$rs.setAttr($rs.findIn(d,"span.rsbtn_scroll_state"),"data-rslang","content:off")),rspkr.Lang.updateUi(d)}},o=function(b,c){if(a){var d=$rs.findIn(a,".rsbtn_scroll_playpause"),e=$rs.getAttr(d,"data-playback-state"),f=rspkr.ui.getActivePlayer();$rs.findIn(d,".rsbtn_btnlabel");"play"===c&&(e="pause"),"pause"===c&&(e="play"),$rs.removeClass($rs.findIn(d,".rsicn"),"rsicn-play rsicn-pause"),e&&"play"!==e?($rs.setAttr(d,"data-playback-state","play"),$rs.addClass($rs.findIn(d,".rsicn"),"rsicn-pause"),d.setAttribute("data-rslang","title/arialabel:pause"),!c&&f.play()):($rs.setAttr(d,"data-playback-state","pause"),$rs.addClass($rs.findIn(d,".rsicn"),"rsicn-play"),d.setAttribute("data-rslang","title/arialabel:play"),!c&&f.pause()),rspkr.Lang.updateUi(d)}},p=function(a){var b=rspkr.cfg.item("ui.preventPlaybackFocus");b||rspkr.cfg.item("ui.preventPlaybackFocus",!0),rspkr.ui.getActivePlayer()&&rspkr.ui.getActivePlayer().stop(),b||rspkr.cfg.item("ui.preventPlaybackFocus",!1)};return{check:h,init:g,kill:m,position:j}}(),ReadSpeaker.ui.Slider=function(){var a,b,c,d,e,f,g,h=this,i="data-readspeaker-slider-id-",j="data-readspeaker-slider-parent-",k={click:null,dir:"h",dragging:null,drop:null,handleClass:"",height:0,initval:-1,labelDragHandle:"",labelEnd:"",labelStart:"",left:0,nudge:1,start:null,steps:-1,stepsize:-1,top:0,width:0},l={rsid:void 0,parent:void 0,ref:void 0},m='<a href="javascript:void(0);" role="slider" class="keyLink">&#160;</a>',n="display:block; border:0;",o=20,p=!1,q=0;return this.initElement=function(a){if(!p){"string"==typeof a&&(a=document.getElementById(a)),a.innerHTML+=m,a.querySelector("a").style=n;var b=a.getElementsByTagName("a"),c=b[b.length-1],d=k.steps>-1?k.steps:100;c.relatedElement=a,c.style.position="relative",$rs.setAttr(c,"data-rslang","title/arialabel:"+k.labelDragHandle);try{$rs.setAttr(c,"aria-orientation","h"===k.dir?"horizontal":"vertical"),$rs.setAttr(c,"aria-valuemin",0),$rs.setAttr(c,"aria-valuemax",d),$rs.setAttr(c,"aria-valuenow",k.initval||0)}catch(e){}q=k.initval,$rs.regEvent(a,"mousedown",this.startDragMouse),$rs.regEvent(c,"click",function(a){rspkr.preventDefault(a)}),$rs.regEvent(c,"keyup",this.startDragKeys),$rs.regEvent(c,"dragstart",function(a){rspkr.preventDefault(a)}),$rs.regEvent(a,"touchstart",this.touchStart),$rs.regEvent(l.parent,"mousedown",this.mouseClick)}},this.mouseClick=function(a){if(!p&&!$rs.hasClass(l.ref,"dragged")){var b=h.findPos(a.target),e=a.clientX-(b.left-k.left),f=a.clientY-(b.top-k.top);c=b.left,d=b.top;var g=h.getCurrentVal({left:e,top:f});return"function"==typeof k.click&&k.click(g,l),!1}},this.findPos=function(a){var b,c=b=0;if(a.offsetParent){do c+=a.offsetLeft,b+=a.offsetTop;while(a=a.offsetParent);return{left:c,top:b}}},this.startDragMouse=function(c){if(rspkr.log("[rspkr.ui.Slider] startDragMouse"),!p){h.startDrag(this);var d=c||window.event;a=d.clientX,b=d.clientY,$rs.regEvent(document.body,"mousemove",h.dragMouse),$rs.regEvent(document.body,"mouseup",h.releaseElement)}return rspkr.preventDefault(c),!1},this.startDragKeys=function(a){var b=a||window.event;rspkr.log("[rspkr.ui.Slider] startDragKeys "+b.keyCode),h.startDrag(this.relatedElement),e=f=0,$rs.regEvent(document.body,"keydown",h.dragKeys),$rs.regEvent(document.body,"keypress",h.switchKeyEvents),$rs.addClass(this.relatedElement,"rskeycontrolled"),rspkr.preventDefault(a)},this.touchStart=function(c){return c=c.originalEvent,rspkr.log("[rspkr.ui.Slider] touchStart"),p||(h.startDrag(c.target),a=c.touches[0].pageX,b=c.touches[0].pageY,$rs.regEvent(c.target,"touchmove",h.touchMove),$rs.regEvent(c.target,"touchend",h.releaseElement)),!1},this.startDrag=function(a){a.relatedElement&&(a=a.relatedElement),rspkr.log("[rspkr.ui.Slider] startDrag"),g&&h.releaseElement(),c=a.offsetLeft,d=a.offsetTop,g=a,$rs.addClass(g,"dragged"),"function"==typeof k.start&&k.start(l)},this.dragMouse=function(c){var d=c||window.event,e=d.clientY-b,f=d.clientX-a;return h.setPosition(f,e),h.valueChanged=!0,!1},this.touchMove=function(c){c=c.originalEvent?c.originalEvent:c,rspkr.preventDefault(c);var d=c.touches[0].pageY-b,e=c.touches[0].pageX-a;return h.setPosition(e,d),h.valueChanged=!0,!1},this.dragKeys=function(a){if(p)return!1;var b=a||window.event,c=b.keyCode;switch(c){case 37:case 63234:h.valueChanged=!0,q-=k.nudge,"v"===k.dir?f+=o:e-=o;break;case 38:case 63232:h.valueChanged=!0,q+=k.nudge,"v"===k.dir?f-=.5*o:e+=.5*o;break;case 39:case 63235:h.valueChanged=!0,q+=k.nudge,"v"===k.dir?f-=o:e+=o;break;case 40:case 63233:h.valueChanged=!0,q-=k.nudge,"v"===k.dir?f+=.5*o:e-=.5*o;break;case 13:case 27:return h.releaseElement(),!1;case 9:return h.releaseElement(),!0;default:return rspkr.log("[rspkr.ui.Slider] return TRUE"),!0}return h.valueChanged===!0&&(rspkr.c.dispatchEvent("onUISliderMove"),h.setPosition(e,f),"function"==typeof k.dragging&&k.dragging(h.getCurrentVal({skipValueCalculation:!0}),l)),rspkr.preventDefault(a),rspkr.log("[rspkr.ui.Slider] ready to return!"),!1},this.setPosition=function(a,b){var e,f=!1,i=a,j=c,m=k.left,n=k.width,o="left";"v"===k.dir&&(i=b,j=d,m=k.top,n=k.height,o="top"),e=j+i,k.stepsize>-1&&((e+m)%k.stepsize?e=k.stepsize*Math.ceil(e/k.stepsize)+m:f=!0),e>n+m?e=n+m:m>e&&(e=m),f||(g.style[o]=e+"px","function"==typeof k.dragging&&k.dragging(h.getCurrentVal(),l))},this.switchKeyEvents=function(){$rs.unregEvent(document.body,"keydown",h.dragKeys),$rs.unregEvent(document.body,"keypress",h.switchKeyEvents),$rs.regEvent(document.body,"keypress",h.dragKeys)},this.releaseElement=function(){rspkr.log("[rspkr.ui.Slider] releaseElement"),$rs.unregEvent(document.body,"mousemove",h.dragMouse),$rs.unregEvent(document.body,"mouseup",h.releaseElement),$rs.unregEvent(document.body,"keypress",h.dragKeys),$rs.unregEvent(document.body,"keypress",h.switchKeyEvents),$rs.unregEvent(document.body,"keydown",h.dragKeys),$rs.unregEvent(g,"touchmove",h.touchMove),$rs.unregEvent(g,"touchend",h.releaseElement),$rs.removeClass(g,"dragged"),$rs.removeClass(g,"rskeycontrolled"),$rs.removeClass(g,"rsmousecontrolled");var a=h.getCurrentVal();return $rs.setAttr($rs.findIn(g,"a.keyLink"),"aria-valuenow",a),g=null,"function"==typeof k.drop&&h.valueChanged===!0&&k.drop(a,l),h.valueChanged=!1,rs.ui.getActivePlayer()&&rs.ui.getActivePlayer().setProgress(),!1},this.getCurrentVal=function(a){var b,c=k.width,d="left",e=k.left;"v"===k.dir&&(c=k.height,d="top",e=k.top);var f,g=k.steps>-1?k.steps:100,h=k.stepsize>-1?k.stepsize:c/g;if(a)a=a[d];else{var i=$rs.css(l.ref,d);if(!i)return void 0;a=i.replace(/px/i,"")}return f=Math.round(a)-e,b=Math.round(f/h),"v"===k.dir&&(b=g-b),rspkr.log("[rspkr.ui.Slider] currentval: "+b),a&&a.skipValueCalculation||isNaN(b)?q=Math.max(Math.min(q,g),0):(q=b,b)},this.setSize=function(){var a=l.parent,b={width:function(){return $rs.width(a)},height:function(){return $rs.height(a)}};k.width=b.width(),k.height=b.height(),k.steps>-1&&(k.stepsize=("h"===k.dir?k.width:k.height)/k.steps),k.initval>-1&&this.jumpTo(k.initval)},this.jumpTo=function(a){if(isNaN(a))return!1;var b=-1,c=101,d=a;if(k.steps>-1&&(a=Math.round(a),c=k.steps+1),a>b&&c>a){var e=k.width,f=k.left,g="left";"v"===k.dir&&(e=k.height,f=k.top,g="top",a=c-1-a);var h=e/(c-1),i=h*a;l.ref.style[g]=i+f+"px",$rs.setAttr($rs.findIn(l.ref,"a.keyLink"),"aria-valuenow",d)}},{rerender:function(){isNaN(q)||(k.initval=q),h.setSize()},init:function(a,b){if("string"==typeof a&&(a=document.getElementById(a)),a){var c=a.id||i+Math.floor(2e4*Math.random());if(a.setAttribute&&a.setAttribute(i,j+c),"object"==typeof b)for(var d in b)b.hasOwnProperty(d)&&void 0!==k[d]&&(k[d]=b[d]);var e,f=!1;"rsbtn_volume_slider"===a.className&&"jquery"===rspkr.l.f.currentLib()&&parseFloat(jQuery.fn.jquery)<1.5&&(e=a.parentNode.style.display,a.parentNode.style.display="block",f=!0),f&&(a.parentNode.style.display=e);var g=document.createElement("span");g.setAttribute(i,c),g.className=k.handleClass||"rsbtn_progress_handle rsimg",a.appendChild(g),l.rsid=c,l.parent=a,l.ref=g,o=k.stepsize>-1?k.stepsize:o;var m=$rs.css(g,"left");m&&(k.left=parseInt(m.replace(/px/i,"")));var n=$rs.css(g,"top");n&&(k.top=parseInt(n.replace(/px/i,"")));var p;k.labelStart&&(p=document.createElement("span"),p.className="slider-label-start",p.innerHTML=k.labelStart,a.appendChild(p)),k.labelEnd&&(p=document.createElement("span"),p.className="slider-label-end",p.innerHTML=k.labelEnd,a.appendChild(p)),h.setSize(),h.initElement(g)}},jumpTo:h.jumpTo,setCurrentValue:function(a){q=a},getInstance:function(){return l},getContainer:function(){return l.parent},getConf:function(){return k},releaseElement:function(){h.releaseElement()},startDragKeys:function(a,b){h.startDragKeys.call(a,b)},disabled:function(){if(!arguments)return p;p=arguments[0];var a=this.getInstance(),b=a&&a.ref?$rs.findIn(a.ref,"a"):void 0;b&&(arguments[0]?($rs.setAttr(b,"disabled",""),b.tabIndex=-1,$rs.addClass(b,"rsdisabled")):(b.removeAttribute("disabled"),b.removeAttribute("tabIndex"),$rs.removeClass(b,"rsdisabled")))}}},ReadSpeaker.ui.Tools.Dictionary=function(){var a=["ar_ar","de_de","da_dk","en","ca_es","es","es_es","eu_es","gl_es","fi_fi","fr_fr","is_is","it_it","ja_jp","ko_kr","lv_lv","nl_nl","no_nb","pt","sv_se","zh_cn"],b=['<button class="rsdialog-button-close rsdialog-button" data-rs-action="dismiss" title="rsLIGHTBOX_CLOSE_DIALOGrs">rsLIGHTBOX_CLOSErs</button>'],c={customFont:!0,customTextStyle:!0,customFontSize:!0},d={createElement:function(a){var b;if(a.id&&(b=document.getElementById(a.id)))return b;if(b=a.type?document.createElement(a.type):document.createElement("div"),a.id&&(b.id=a.id),a["class"]&&(b.className=a["class"]),a.value&&(b.value=a.value),a.click&&$rs.regEvent(b,"click",a.click),a.attributes&&$rs.isArray(a.attributes))for(var c=0,d=a.attributes.length;d>c;c++)a.attributes[c].indexOf("=")>-1&&$rs.setAttr(b,a.attributes[c].split("=").shift(),a.attributes[c].split("=").pop());if(a.content)if("object"==typeof a.content){var e=document.createElement("div");e.appendChild(a.content),b.innerHTML=e.innerHTML}else b.innerHTML=a.content;return a.container?a.container.appendChild(b):document.body.appendChild(b),b},addServerMarkup:function(a){var b=document.createElement("div"),c=d.createElement({"class":"rs-dictionary server-markup",container:b}),e=d.createElement({"class":"rs-dictionary-toprow",container:c,attributes:["role=heading","aria-level=2"]}),f='<a href="'+a.source+'" target="_blank">'+rspkr.Lang.getPhrase("source")+": "+rspkr.Lang.getPhrase("wiktionary")+"</a>";return d.createElement({type:"span","class":"rs-dictionary-source",content:" ("+f+")",container:e}),d.createElement({type:"span","class":"rs-dictionary-query",content:a.query,container:e}),d.createElement({"class":"rs-dictionary-definition",content:a.markup.replace(/H3/gi,"H2"),container:c}),b.innerHTML},createDictMarkup:function(a){if(a.markup&&a.markup.length)return d.addServerMarkup(a);var b,c,e,f,g,h,i,j,k,l=document.createElement("div");for(e=0,f=a.definitions.length;f>e;e++){for(b=a.definitions[e],g=document.createElement("div"),h=d.createElement({type:"span","class":"rs-dictionary-toprow",container:g,attributes:["role=heading","aria-level=2"]}),i=d.createElement({type:"ol",attributes:["type=a"],"class":"rs-dictionary-definition-list",container:g}),$rs.isArray(b.definition)||(b.definition=[b.definition]),d.createElement({type:"span",content:Number(e+1).toString()+".","class":"rs-dictionary-index",container:h}),d.createElement({type:"span",content:b.word,"class":"rs-dictionary-word",container:h}),d.createElement({type:"span",content:b["class"],"class":"rs-dictionary-class",container:h}),b.pronunciation&&b.pronunciation.length,1,j=0,k=b.definition.length;k>j;j++)d.createElement({type:"li",content:b.definition[j],"class":"rs-dictionary-definition-item",container:i});c=g.innerHTML.split("</span>").join("</span>\n"),d.createElement({"class":"rs-dictionary",content:c,container:l})}return l.innerHTML.replace(/H3/gi,"H2")},triggerLuMsg:function(a){$rs.regEvent($rs.findIn(a,".rslightbox-trmessage-button"),"click",function(){rspkr.st.set("lu_agreed","1"),$rs.remove($rs.findIn(a,".rslightbox-trmessage"))})},errorMessages:{unsupportedLanguage:function(c,d,g){for(var h,i="",j=0,k=a.length;k>j;j++)h=rspkr.Lang.getPhrase(a[j])||a[j],h&&(i+="<li>"+h+"</li>");rspkr.u.Lightbox.show(e()+"<p>"+rspkr.Lang.getPhrase("languagenotsupported")+": "+rspkr.Lang.getPhrase(c)+"</p><p>"+rspkr.Lang.getPhrase("supportedlanguages")+":</p><ul>"+i+"</ul></div>",rspkr.st.r().replaceTokens(b.join(""),{rsLIGHTBOX_CLOSErs:rspkr.Lang.getPhrase("close"),rsLIGHTBOX_CLOSE_DIALOGrs:rspkr.Lang.getPhrase("closedialog")}),!0,g,!1,f(),d)},notFound:function(a,c,d){rspkr.u.Lightbox.show(e()+(rspkr.Lang.getPhrase("wordnotfound")||"").replace("%s",a.trim())+"</div>",rspkr.st.r().replaceTokens(b.join(""),{rsLIGHTBOX_CLOSErs:rspkr.Lang.getPhrase("close"),rsLIGHTBOX_CLOSE_DIALOGrs:rspkr.Lang.getPhrase("closedialog")}),!0,d,!1,f(),c)},loadError:function(a,c){rspkr.u.Lightbox.show(e()+(rspkr.Lang.getPhrase("loaderror")||"")+"</div>",rspkr.st.r().replaceTokens(b.join(""),{rsLIGHTBOX_CLOSErs:rspkr.Lang.getPhrase("close"),rsLIGHTBOX_CLOSE_DIALOGrs:rspkr.Lang.getPhrase("closedialog")}),!0,c,!1,f(),a)},noSelection:function(a,c){rspkr.u.Lightbox.show(e()+rspkr.Lang.getPhrase("selectionrequireddict")+"</div>",rspkr.st.r().replaceTokens(b.join(""),{rsLIGHTBOX_CLOSErs:rspkr.Lang.getPhrase("close"),rsLIGHTBOX_CLOSE_DIALOGrs:rspkr.Lang.getPhrase("closedialog")}),!0,c,!1,f(),a)},xhrError:function(a,c,d){rspkr.log("[Tools.Dictionary] Error looking up text: "+a.message,3),rspkr.u.Lightbox.show(e()+(rspkr.Lang.getPhrase("loaderror")||"")+"<br />Error: "+a.message+"</div>",rspkr.st.r().replaceTokens(b.join(""),{rsLIGHTBOX_CLOSErs:rspkr.Lang.getPhrase("close"),rsLIGHTBOX_CLOSE_DIALOGrs:rspkr.Lang.getPhrase("closedialog")}),!0,d,!1,null,c)}},dictionary:function(g,h,i,j){if(i=rspkr.cfg.mergeObj(i,c)||c,-1===a.indexOf(g)&&-1===a.indexOf(g.substr(0,2)))return d.errorMessages.unsupportedLanguage(g,i,j);var k=h||rspkr.c.data.getSelectedText(),l=document.createElement("div");if(l.innerHTML=k,k=(l.innerText||l.textContent).split(/\s/).shift(),k=k.replace(/[\?\.\,\;\:\-\!]/,"").trim(),"string"==typeof k&&k.length){var m,n=this.tagName?$rs.closest(this,"li"):null,o=rspkr.cfg.item("general.wrapiUrl"),p=rspkr.findHref(),q=p?rspkr.getParam("customerid",p):void 0,r=("cat=Dict&w=[[text]]&l=[[source]]&cid="+q+"&url="+encodeURIComponent(document.location.href)).replace("[[text]]",encodeURIComponent(k.trim())).replace("[[source]]",g.substr(0,2));n&&$rs.addClass(n,"rsbtn_tool_spinner"),window.XMLHttpRequest&&(m=new XMLHttpRequest),rspkr.c.data.clearSelectedText(),m.onreadystatechange=function(){if(4===this.readyState&&200===this.status){var a=JSON.parse(this.responseText),c="";$rs.removeClass(n,"rsbtn_tool_spinner"),"1"!==rspkr.st.get("lu_agreed")&&(c=['<div class="rs_skip rs_preserve">','	<div class="rslightbox-trmessage rs_skip" lang="'+rspkr.Lang.getUiLang().substr(0,2)+'" role="note">','		<div class="rslightbox-trmessage-text">'+rspkr.Lang.getPhrase("dictionarymessage")+"</div>",'		<div class="rslightbox-trmessage-buttons"><button type="button" class="rslightbox-trmessage-button">'+rspkr.Lang.getPhrase("iunderstand")+"</button></div>","	</div>","</div>"].join("")),rspkr.u.Lightbox.show(e()+c+d.createDictMarkup(a)+"</div>",rspkr.st.r().replaceTokens(b.join(""),{rsLIGHTBOX_CLOSErs:rspkr.Lang.getPhrase("close"),rsLIGHTBOX_CLOSE_DIALOGrs:rspkr.Lang.getPhrase("closedialog")}),!0,function(a){$rs.findIn(a,".rslightbox-trmessage")&&d.triggerLuMsg(a),"function"==typeof j&&j.apply(this,[a])},!1,f(),i)}else{if(4===this.readyState&&404===this.status)return $rs.removeClass(n,"rsbtn_tool_spinner"),d.errorMessages.notFound(k,i,j);if(4===this.readyState)return $rs.removeClass(n,"rsbtn_tool_spinner"),d.errorMessages.loadError(i,j)}}.bind(m);try{m.open("GET",o+"?"+r,!0),m.send()}catch(s){return d.errorMessages.xhrError(s,i,j)}}else d.errorMessages.noSelection(i,j)}},e=function(){return'<div id="rslightbox_content_inner"><h1 class="rs_skip">'+rspkr.Lang.getPhrase("dictionary")+"</h1>"},f=function(){return"[fontplus fontminus] [volume speed textsettings]"},g=function(b){var c=$rs.findIn(b,"a.rsbtn_play"),d=$rs.isArray(c)?rspkr.findHref():c.href;if(!d){var e=rspkr.getRSBtns();d=e.length?$rs.getAttr($rs.findIn(e[0],".rsbtn_play"),"href"):d}if(d&&"string"==typeof d&&d.length){var f=rspkr.getParam("lang",d);if(-1===a.indexOf(f)&&-1===a.indexOf(f.substr(0,2))){rspkr.log("[Dictionary] Dictionary tool not supported by language "+f+", removing button",1);var g=$rs.findIn(b,".rsbtn_tool_dict");$rs.isArray(g)||g&&g.parentElement.removeChild(g),g=$rs.findIn(b,".rsmpl-dictionary"),$rs.isArray(g)||g&&g.parentElement.removeChild(g)}}};return ReadSpeaker.Common.addEvent("onToolsInitialized",function(a,b){rspkr.features.dictionary_toolbar===!0&&g(a,b)}),{init:g,dictionary:d.dictionary}}(),ReadSpeaker.ui.Tools.Download=function(){var a=function(){var a=$rs.closest(this,"."+rspkr.ui.rsbtnClass),b=rspkr.ui.getActivePlayer();if(b)b.dl();else{var c=$rs.getAttr($rs.findIn(a,".rsbtn_play"),"href"),d=c?rspkr.c.data.getSaveData("dialog",c):rspkr.c.data.getSaveData("dialog"),e=rspkr.cfg.item("ui.dldialog").join("\n"),f={};f.rsTERMS_OF_USE_HEADINGrs=rspkr.Lang.getPhrase("touheading"),f.rsTERMS_OF_USE_BODYrs=rspkr.Lang.getPhrase("toubody"),e=rspkr.st.r().replaceTokens(e,f);var g=rspkr.cfg.item("ui.dlbuttons").join("\n"),h={};h.rsTERMS_OF_USE_ACCEPTrs=rspkr.Lang.getPhrase("touaccept"),h.rsTERMS_OF_USE_DECLINErs=rspkr.Lang.getPhrase("toudecline"),g=rspkr.st.r().replaceTokens(g,h),rspkr.u.Lightbox.show(e,g,!0,function(){var a=$rs.get("#rsdl_button_accept"),b=$rs.get("#rsdl_button_decline");a&&$rs.regEvent(a,"click",function(b){rspkr.u.Lightbox.hide(b);var c="iOS"!==rspkr.c.data.browser.OS;if(c){var e=null;if(document.getElementById("dliframe"))e=document.getElementById("dliframe");else{if(document.selection)try{e=document.createElement('<iframe name="dliframe">')}catch(f){e=document.createElement("iframe")}else e=document.createElement("iframe");$rs.setAttr(e,"name","dliframe"),$rs.setAttr(e,"id","dliframe"),/Explorer/i.test(rspkr.c.data.browser.name)||$rs.setAttr(e,"sandbox","allow-same-origin allow-scripts allow-downloads allow-downloads-without-user-activation"),$rs.css(e,"display","none"),$rs.css(e,"position","absolute");var g=$rs.get("body");if(g=$rs.isArray(g)?g[0]:g,!g)return;g.appendChild(e)}return $rs.setAttr(e,"src",d),!1}return $rs.setAttr(a,"href",d),!0}),b&&($rs.regEvent(b,"click",function(a){rspkr.preventDefault(a),rspkr.u.Lightbox.hide(a)}),setTimeout(function(){rspkr.ui.focus(b)},200)),rspkr.c.dispatchEvent("onDownloadLoaded",window,[])},!1,"[fontplus fontminus] [volume speed textsettings]",{customFont:!0,customTextStyle:!0,customFontSize:!0})}},b=function(a){};return ReadSpeaker.Common.addEvent("onToolsInitialized",function(a,b){}),{download:a,init:b}}(),ReadSpeaker.ui.Tools.Enlarge=function(){var a=function(){rspkr.HL.customHL.enlarge(!rspkr.HL.customHL.active()),b.toggleStates(rspkr.HL.customHL.active())},b={toggleStates:function(a){var b='.rsbtn_tool[data-rs-tool="enlarge"]';if(a){var c=$rs.get(b+":not(.active)");$rs.addClass(c,"active"),$rs.setAttr(c,"aria-pressed","true")}else $rs.removeClass(b,"active"),$rs.setAttr(b,"aria-pressed","false")}},c=function(){b.toggleStates(rspkr.HL.customHL.active())};return ReadSpeaker.Common.addEvent("onToolsInitialized",function(){c()}),{init:c,toggle:a}}(),ReadSpeaker.ui.Tools.Help=function(){var a=["ar_ar","ca_es","da_dk","de_de","en_us","es_es","eu_es","fi_fi","fo_fo","fr_fr","gl_es","is_is","it_it","ja_jp","ko_kr","lv_lv","nb_no","nl_nl","pl_pl","pt_br","pt_pt","sv_se","zh_cn","zh_tw"],b=[],c=['<button class="rsdialog-button-close rsdialog-button" data-rs-action="dismiss" title="rsLIGHTBOX_CLOSE_DIALOGrs">rsLIGHTBOX_CLOSErs</button>'],d=function(a){if(b[a])return void _openHelp(a);var c;window.XMLHttpRequest&&(c=new XMLHttpRequest),window.ActiveXObject&&(c=new ActiveXObject("Microsoft.XMLHTTP"));var d=rspkr.baseUrl+rspkr.revPath+"wrhelp/json/"+a+".json";c.open("GET",d,!0),c.onreadystatechange=function(){if(4===c.readyState&&200===c.status)try{b[a]=JSON.parse(c.response),rspkr.log("[rspkr.ui.Tools.Help] Loaded WRHelp: "+a),_openHelp(a)}catch(d){rspkr.log("[rspkr.ui.Tools.Help] Could not load WRHelp: "+a,3)}},c.send()},e=function(a,b){if(!a)return!0;if(b&&!a[b])return!0;var c=b?a[b]:a;if(0===c.display)return!1;if(c.setting)return rspkr.cfg.item(c.setting);if(c.display_selector)return $rs.arr(c.display_selector).length;if(c.enabled_tool){for(var d,e=c.enabled_tool.split(","),f=0;d=e[f];f++)if(rspkr.features[d])return!0;return!1}return!0},f=function(a){if(!b[a])return rspkr.log("[rspkr.ui.Tools.Help] No content for "+a);for(var c,d=b[a],f="",g=d.meta&&d.meta.sections?d.meta.sections.split(","):Object.keys(d.content),h=0;c=g[h];h++)if(c=c.trim(),d.content.hasOwnProperty(c)&&e(d.content[c].meta)&&(d.content[c].hasOwnProperty("title")&&(f+="<h1>"+d.content[c].title+"</h1>"),d.content[c].hasOwnProperty("text")))if(d.content[c].text.join)for(var i,j=0;i=d.content[c].text[j];j++)e(d.content[c].meta,"key"+j)&&(f+=i);else e(d.content[c].meta,"key0")&&(f+=i);var k=/rsversion/i.test(document.location.href)?'<span id="rs_versioninfo">webReader %major%.%minor%.%update% (%full%)</span>'.replace("%major%",rspkr.meta.obj.major).replace("%minor%",rspkr.meta.obj.minor).replace("%update%",rspkr.meta.obj.update).replace("%full%",rspkr.meta.version):"";return f=f.replace(/\[\[IMG_URL\]\]/gi,rspkr.baseUrl+rspkr.revPath+"wrhelp/img/"+a),f='<div class="rshelp-container"'+(d.meta.dir?' dir="'+d.meta.dir+'"':"")+">"+f+"</div>"+k};return _openHelp=function(a){var b=f(a);rspkr.u.Lightbox.show('<div id="rslightbox_content_inner">'+b+"</div>",rspkr.st.r().replaceTokens(c.join("\n"),{rsLIGHTBOX_CLOSErs:rspkr.Lang.getPhrase("close"),rsLIGHTBOX_CLOSE_DIALOGrs:rspkr.Lang.getPhrase("closedialog")}),!0,null,!1,"[fontplus fontminus] [volume speed textsettings]",{customFont:!0,customTextStyle:!0,customFontSize:!0})},_open=function(){rspkr.ui.getActivePlayer()&&rspkr.ui.getActivePlayer().close();var c=rspkr.Lang.getUiLang();a.indexOf(c)<0&&(c=rspkr.Lang.getFallbackLang()),a.indexOf(c)<0&&(c="en_us"),b[c]?_openHelp(c):d(c)},{open:_open}}(),ReadSpeaker.ui.Tools.MouseTracker=function(){var a={mask:{height:70,min:10,max:250,increment:10},ruler:{height:100,min:10,max:300,increment:20}},b=!1,c="",d=!1,e=!1,f=!1,g=['<div id="rsmasking-container">','	<div id="rsmask-top"></div>','	<div id="rsmask-middle">','		<span class="rsicn rsicn-keyboard" aria-hidden="true"></span>',"	</div>",'	<div id="rsmask-tools">','		<div id="rsmask-tools-larger" role="button" data-rslang="title/arialabel:pagemaskplus"></div>','		<div id="rsmask-tools-smaller" role="button" data-rslang="title/arialabel:pagemaskminus"></div>','		<div id="rsmask-tools-close" role="button" data-rslang="title/arialabel:close"></div>',"	</div>",'	<div id="rsmask-bottom"></div>',"</div>"],h=!1,i=void 0,j=10,k=function(){b=!0,n[c].activate(),$rs.css("#rsmask-tools","display","block"),
$rs.regEvent("#rsmask-tools-close","click",l),$rs.regEvent("#rsmask-tools-larger","click",m.larger),$rs.regEvent("#rsmask-tools-smaller","click",m.smaller),$rs.regEvent(document.body,"mousemove",m.mousemove),$rs.regEvent(document,"keydown",m.keyboard),$rs.regEvent(window,"resize",function(a){n[c].resize()}),$rs.regEvent(window,"touchstart",function(a){d=!0,2===a.originalEvent.touches.length&&(e=!0)}),$rs.regEvent(window,"touchend",function(a){e&&n[c].resize(),e=!1}),rspkr.mobile()&&(i=$rs.height(window)/2),m.mousemove(),rspkr.st.set("hlscroll","scrolloff"),rspkr.devt("onMouseTrackerOpened",window)},l=function(){b=!1,n[c].inactivate(),$rs.css("#rsmask-tools","display","none"),$rs.unregEvent("#rsmask-tools-close, #rsmask-tools-larger, #rsmask-tools-smaller","click"),$rs.unregEvent(document.body,"mousemove"),$rs.unregEvent(document,"keydown"),$rs.unregEvent(window,"touchstart touchend"),rspkr.devt("onMouseTrackerClosed",window,[c])},m={mousemove:function(a){n[c].mousemove(a)},touchmove:function(a){d=!0;var b=a.originalEvent,e=b.targetTouches[0];b.preventDefault(),n[c].mousemove(e)},larger:function(b){m.resize(b,a[c].increment)},smaller:function(b){m.resize(b,-a[c].increment)},resize:function(b,d){var e=a[c];e.height+=d,e.height=d>0?e.height>e.max?e.max:e.height:e.height<e.min?e.min:e.height,n[c].mousemove(b),m.storeSize(e.height)},storeSize:function(a){rspkr.st.set(c+"h",a)},keyboard:function(a){n[c].keyboard(a)}},n={mask:{activate:function(){$rs.css("#rsmask-top, #rsmask-middle, #rsmask-bottom","display","block"),$rs.regEvent("#rsmask-middle","touchmove",m.touchmove)},inactivate:function(){$rs.css("#rsmask-top, #rsmask-middle, #rsmask-bottom","display","none"),$rs.unregEvent("#rsmask-middle","touchmove")},mousemove:function(b){var c;if(b&&b.clientY)c=b.clientY;else if(isNaN(i)){var e=$rs.get("#rsmask-middle");i=c=e&&!$rs.isArray(e)&&$rs.isVisible(e)?$rs.offset(e).top+$rs.height(e)/2:$rs.height(window)/2}else c=i;$rs.css("#rsmask-top","height",c-a.mask.height/2+"px"),$rs.css("#rsmask-middle",{top:c-a.mask.height/2+"px",height:a.mask.height+"px"}),$rs.css("#rsmask-bottom","height",(d?window.innerHeight:$rs.height(window))-c-a.mask.height/2+"px"),$rs.css("#rsmask-tools","top",c-$rs.outerHeight("#rsmask-tools")/2+"px"),b&&(i=c)},adjustbottom:function(){$rs.css("#rsmask-middle",{top:$rs.css("#rsmask-top","height"),height:a.mask.height+"px"}),$rs.css("#rsmask-bottom","height",(d?window.innerHeight:$rs.height(window))-($rs.height("#rsmask-top")+a.mask.height)+"px")},resize:function(){n.mask.adjustbottom()},keyboard:function(a){function b(){a.preventDefault&&a.preventDefault(),a.originalEvent&&a.originalEvent.preventDefault&&a.originalEvent.preventDefault()}var c=this,d={38:function(){i=Math.max(i-(a.originalEvent.shiftKey?10:1)*j,0),c.mousemove()},40:function(){i=Math.min(i+(a.originalEvent.shiftKey?10:1)*j,$rs.height(window)),c.mousemove()},187:function(){m.larger()},189:function(){m.smaller()},setup:function(){return this[107]=this[187],this[109]=this[189],this}}.setup();32===a.keyCode&&(h=!h,h?$rs.addClass($rs.findIn("#rsmask-middle",".rsicn-keyboard"),"active"):$rs.removeClass($rs.findIn("#rsmask-middle",".rsicn-keyboard"),"active"),b()),27===a.keyCode&&l(),h&&d[a.keyCode]&&(d[a.keyCode](),b())}}},o=function(){a.mask.height=parseInt(ReadSpeaker.Common.Settings.get("maskh")||70)};return ReadSpeaker.Common.addEvent("onToolsInitialized",function(){o()}),{init:o,start:function(a,d){if(!f){var e=document.createElement("div");e.innerHTML=g.join("\n"),rspkr.Lang.updateUi(e),document.body.appendChild(e.childNodes[0]),f=!0}return c.length&&a!==c&&l(),c.length&&b&&a===c?void l():(c=a,k(a),void(!rspkr.mobile()&&m.mousemove(d)))},inactivate:l,activate:k,isActive:function(){return b}}}(),ReadSpeaker.ui.Tools.ReadHover=function(){var a="hoverread",b="hoveron",c="hoveroff",d=/body|html|header|footer|section|textarea|input|option|button|svg/i,e=/rs_enlargeHL_box|rslightbox_contentcontainer|rspie_timer/i,f=/rsbtn.*|rs-outline|rs_textselection|rs-readhover-active/i,g=/sync_word|sync_sent|rs_textnode/i,h=!1,i=function(){return rspkr.st&&rspkr.st.get(a)===b},j=function(){i()?l():k()},k=function(a){return a!==!0?void o.setting(!0):(o.toggleStates(!0),void n.startTracking())},l=function(a){return a!==!0?void o.setting(!1):(o.toggleStates(!1),n.cleanup(),n.stopTracking(),void(rspkr.ui.getActivePlayer()&&rspkr.ui.getActivePlayer().stop()))},m=function(a){if(window.getSelection&&document.createRange){var b=document,c=window;a&&(b=a.ownerDocument,c=b.defaultView||b.parentWindow);var d=c.getSelection(),e=b.createRange();e.selectNodeContents(a),d.removeAllRanges(),d.addRange(e)}else if(document.selection&&document.body.createTextRange){var f=document.body.createTextRange();f.moveToElementText(a),f.select()}},n={lastMove:null,prevElement:null,delayTimer:null,hoverTimer:null,displayDelay:.5,alertDelaySec:1.5,alertDelayIntervalSec:1,currentDelaySec:0,trackingStarted:!1,startTracking:function(){if(!n.trackingStarted)if("complete"===document.readyState||"loaded"===document.readyState){for(var a=$rs.getReadingFrames(window),b=0;b<a.length;b++)try{$rs.regEvent(a[b],"mousemove",n.tracker)}catch(c){}n.trackingStarted=!0}else document.addEventListener("readystatechange",function(a){if("complete"===a.target.readyState||"loaded"===a.target.readyState){for(var b=$rs.getReadingFrames(window),c=0;c<b.length;c++)try{$rs.regEvent(b[c],"mousemove",n.tracker)}catch(d){}n.trackingStarted=!0}})},stopTracking:function(){if(n.trackingStarted){var a=$rs.getReadingFrames(window);if("complete"===document.readyState||"loaded"===document.readyState)for(var b=0;b<a.length;b++){try{$rs.unregEvent(a[b],"mousemove",n.tracker)}catch(c){}n.trackingStarted=!1}else document.addEventListener("readystatechange",function(a){if("complete"===a.target.readyState||"loaded"===a.target.readyState){for(var b=$rs.getReadingFrames(window),c=0;c<b.length;c++)try{$rs.unregEvent(b[c],"mousemove",n.tracker)}catch(d){}n.trackingStarted=!1}})}},tracker:function(a){n.track.apply(n.track,[a])},track:function(a,b,c){if(c=c||0,c>=4)return void n.leaveElm(n.prevElement);var h=a.originalEvent&&a.originalEvent.target?a.originalEvent.target:a.target;if(h=b||h,n.lastMove=a,h&&h!==n.prevElement)if(d.test(h.tagName)||e.test(h.id)||f.test(h.className)||g.test(h.className)||!n.hasText(h)){if(g.test(h.className))return void n.track(a,h.parentNode,c+1);n.leaveElm(n.prevElement)}else window.clearTimeout(n.delayTimer),n.enterElm(h),n.prevElement=h},hasText:function(a){if(a.hasChildNodes())for(var b=0,c=a.childNodes.length;c>b;b++){if(a.childNodes[b].nodeType&&3===a.childNodes[b].nodeType&&(a.childNodes[b].innerText||a.childNodes[b].textContent).replace(/^\s+|\s+$/g,"").length)return!0;if(a.childNodes[b].nodeType&&1===a.childNodes[b].nodeType&&n.hasText(a.childNodes[b]))return!0}return!1},enterElm:function(a){n.prevElement&&n.leaveElm(n.prevElement),$rs.addClass(a,"rs-outline");var b=document,c=window;a&&(b=a.ownerDocument,c=b.defaultView||b.parentWindow),n.delayTimer=c.setTimeout(function(){var b=o.injectPieTimer(!1,a);$rs.show(b),o.positionPieTimer(a,b),rspkr.u.PieTimer.start(b,{time:1e3*n.alertDelaySec})},1e3*n.displayDelay),n.hoverTimer=c.setTimeout(n.showCount,1e3*n.alertDelayIntervalSec)},leaveElm:function(a){var b=document,c=window;a&&(b=a.ownerDocument,c=b.defaultView||b.parentWindow),c.clearTimeout(n.delayTimer),n.prevElement&&($rs.removeClass(a,"rs-outline"),""===$rs.getAttr(a,"class")&&"function"==typeof a.removeAttribute&&a.removeAttribute("class"),o.getPieTimer()&&(rspkr.u.PieTimer.stop(),$rs.hide(o.getPieTimer())),n.prevElement=null,n.clearCount())},clearCount:function(){for(var a=$rs.getReadingFrames(window),b=0;b<a.length;b++)try{a[b].clearTimeout(n.hoverTimer)}catch(c){}n.currentDelaySec=0},showCount:function(){n.currentDelaySec=n.currentDelaySec+n.alertDelayIntervalSec,n.currentDelaySec<n.displayDelay+n.alertDelaySec?n.hoverTimer=window.setTimeout(n.showCount,1e3*n.alertDelayIntervalSec):n.readContent()},readContent:function(){n.clearCount();var a=n.prevElement;$rs.removeClass(a,"rs-outline"),$rs.removeClass($rs.arr(".rs-readhover-active"),"rs-readhover-active"),$rs.addClass(a,"rs-readhover-active"),o.getPieTimer()&&$rs.hide(o.getPieTimer()),m(a);var b=n.lastMove||!0;if(rs.c.data.setSelectedText(b),rspkr.HL.sync.fullCleanUp(),h!==!1)window.readpage(h);else{var c=rspkr.findHref(),d=rspkr.findExpContainer();if(!c||!d)return void rspkr.log("[rspkr.ui.Tools.ReadHover] Could not find href and/or player",3);window.readpage(c,d)}rspkr.log("[rspkr.ui.Tools.ReadHover] Starting playback!",4)},getID:function(){return"rs-poc-"+Math.random().toString(36).substring(7)},cleanup:function(a){n.clearCount(),rspkr.HL.sync.fullCleanUp(),$rs.removeClass($rs.arr(".rs-readhover-active"),"rs-readhover-active"),n.leaveElm(n.prevElement),rspkr.log("[rspkr.ui.Tools.ReadHover] Cleanup done!",4)}},o={setting:function(d){rspkr.st.set(a,d?b:c)},toggleStates:function(a){var b='.rsbtn_tool[data-rs-tool="readhover"]';if(a){var c=$rs.get(b+":not(.active)");$rs.addClass(c,"active"),$rs.setAttr(c,"aria-pressed","true")}else $rs.removeClass(b,"active"),$rs.setAttr(b,"aria-pressed","false")},injectPieTimer:function(a,b){var c=b?b.ownerDocument:document;if(c.getElementById("rspie_timer"))return c.getElementById("rspie_timer");var d=c.createElement("div");return d.id="rspie_timer",d.style.zIndex=rspkr.ui.utils.getMaxZ()+10,a!==!0&&c.body.appendChild(d),d},getPieTimer:function(){for(var a=null,b=$rs.getReadingFrames(window),c=0;c<b.length;c++)try{if(a=b[c].document.getElementById("rspie_timer"),pieElementnull)break}catch(d){}return a},positionPieTimer:function(a,b){if(a&&a.getBoundingClientRect){var c=a.ownerDocument,d=c.defaultView||c.parentWindow,e=a.getBoundingClientRect(),f=void 0!==d.pageXOffset?d.pageXOffset:(c.documentElement||c.body.parentNode||c.body).scrollLeft,g=void 0!==d.pageYOffset?d.pageYOffset:(c.documentElement||c.body.parentNode||c.body).scrollTop,h=f+e.left,i=g+e.top;b.style.left=""+h+"px",b.style.top=""+i+"px",b.style.position="absolute",b.style.display="none",$rs.show(b)}}},p=function(b){var g=b?$rs.findIn($rs.closest(b.target,"."+rspkr.cfg.item("ui.rsbtnClass")),".rsbtn_play"):$rs.get(".rsbtn_play:first");$rs.isArray(g)||"object"!=typeof g||(h=g),d=rspkr.cfg.item("settings.hover.excludeElem")?rspkr.cfg.item("settings.hover.excludeElem"):d,e=rspkr.cfg.item("settings.hover.excludeID")?rspkr.cfg.item("settings.hover.excludeID"):e,f=rspkr.cfg.item("settings.hover.excludeClass")?rspkr.cfg.item("settings.hover.excludeClass"):f,i()&&(h?k(!0):rspkr.st.set(a,c)),rspkr.cfg.item("ui.readHoverDelay")&&!isNaN(parseInt(rspkr.cfg.item("ui.readHoverDelay")))&&(n.displayDelay=parseInt(rspkr.cfg.item("ui.readHoverDelay"))),rspkr.cfg.item("ui.readHoverCountdown")&&!isNaN(parseInt(rspkr.cfg.item("ui.readHoverCountdown")))&&(n.alertDelaySec=parseInt(rspkr.cfg.item("ui.readHoverCountdown"))),rspkr.log("[rspkr.ui.Tools.ReadHover] Initialized!",4)};return ReadSpeaker.Common.addEvent("onToolsInitialized",function(){o.toggleStates(i())}),ReadSpeaker.Common.addEvent("onReady",function(){p()}),ReadSpeaker.Common.addEvent("onSettingsChanged",function(c,d){c===a&&(d===b?k(!0):l(!0))}),{init:p,start:k,stop:l,toggle:j,active:i}}(),ReadSpeaker.ui.Tools.TextMode=function(){var a="p|h[1-9]|em|strong|i|img|a|ul|li|table|thead|tbody|tfoot|tr|th|td",b=['<button class="rsdialog-button-close rsdialog-button" data-rs-action="dismiss" title="rsLIGHTBOX_CLOSE_DIALOGrs">rsLIGHTBOX_CLOSErs</button>'],c=function(a){var c,f=rspkr.ui.getActivePlayer();f&&f.close(),c='<div id="rslightbox_content_inner">'+e(d(this))+"</div>","string"==typeof c&&(rspkr.u.Lightbox.show("<div>"+c+"</div>",rspkr.st.r().replaceTokens(b.join("\n"),{rsLIGHTBOX_CLOSErs:rspkr.Lang.getPhrase("close"),rsLIGHTBOX_CLOSE_DIALOGrs:rspkr.Lang.getPhrase("closedialog")}),!0,null,!1,"[fontplus fontminus] [volume speed textsettings]",{customFont:!0,customTextStyle:!0,customFontSize:!0}),rspkr.devt("onTextModeLoaded",window))},d=function(a){if(rspkr.c.data.selectedText){var b=rspkr.c.data.cleanSkippedContent(rspkr.c.data.getSelectedText());return rspkr.c.data.clearSelectedText(),b}if(a){var c=$rs.findIn($rs.closest(a,"."+rspkr.u.rsbtnClass),"a.rsbtn_play"),d="",e=c&&c.href?c.href:rspkr.findHref();if(e&&(rspkr.c.data.setParams(e),d=rspkr.c.data.getReadingContent(),"string"==typeof d&&d.length))return rspkr.c.data.cleanSkippedContent(d,{cleanHidden:!0,cleanAllSkipped:!0})}return!1},e=function(b){if("string"==typeof b){var c=document.createElement("div");c.innerHTML=b;var d=$rs.findIn(c,".rs_skip");$rs.remove(d),b=c.innerHTML;new RegExp("<(?!"+a+")[^>]*>([^<]*)</[^>]*>","gi");return b=b.replace(/\b(id|class|style)=['"]?[^'"\b]*['"]?/gi,"")}return!1},f=function(){};return{init:f,start:c}}(),ReadSpeaker.ui.Tools.Translation=function(){var a=null,b=null,c=['<button class="rsdialog-button-close rsdialog-button" data-rs-action="dismiss" title="rsLIGHTBOX_CLOSE_DIALOGrs">rsLIGHTBOX_CLOSErs</button>'],d=['	<div class="rslightbox-bottom-banner">','		<a href="[[translateurl]]"><img class="rs-service-logo" alt="Powered by Google Translate" src="[[baseurl]]/googletranslate-powered.png" /></a>',"	</div>"],e={customFont:!0,customTextStyle:!0,customFontSize:!0},f={translate:function(a,h,i){i=rspkr.cfg.mergeObj(i,e)||e;var j=rspkr.c.data.cleanSkippedContent(rspkr.c.data.getSelectedText());if(j){if(j.length>5e3)return rspkr.u.Lightbox.show('<div id="rslightbox_content_inner">'+rspkr.Lang.getPhrase("translatelimit")+"</div>",rspkr.st.r().replaceTokens(c.join(""),{rsLIGHTBOX_CLOSErs:rspkr.Lang.getPhrase("close"),rsLIGHTBOX_CLOSE_DIALOGrs:rspkr.Lang.getPhrase("closedialog")}),!0,null,!1,g(),i),!1;b&&$rs.addClass(b,"rsbtn_tool_spinner"),"no_nb"===a&&(a="nb_no"),null===rspkr.c.data.getParam("customerid")&&rspkr.c.data.setParams(rspkr.findHref());var k,l=rspkr.cfg.item("general.wrapiUrl"),m=("cat=Translate&t=[[text]]&lout=[[target]]&cid="+rspkr.c.data.getParam("customerid")+"&url="+encodeURIComponent(document.location.href)).replace("[[text]]",encodeURIComponent(j.trim())).replace("[[target]]",a.substring(0,2));window.XMLHttpRequest&&(k=new XMLHttpRequest),rspkr.c.data.clearSelectedText(),k.onreadystatechange=function(){if(4===this.readyState&&200===this.status){var e=JSON.parse(this.responseText),j="";b&&$rs.removeClass(b,"rsbtn_tool_spinner"),rspkr.u.toolPanels.closeAll(),"1"!==rspkr.st.get("tr_agreed")&&(j=['<div class="rs_skip rs_preserve">','	<div class="rslightbox-trmessage" lang="'+rspkr.Lang.getUiLang().substr(0,2)+'" role="note">','		<div class="rslightbox-trmessage-text">'+rspkr.Lang.getPhrase("translationmessage")+"</div>",'		<div class="rslightbox-trmessage-buttons"><button type="button" class="rslightbox-trmessage-button">'+rspkr.Lang.getPhrase("iunderstand")+"</button></div>","	</div>","</div>"].join("")),rspkr.u.Lightbox.show('<div id="rslightbox_content_inner"><h1 class="rs_skip">'+rspkr.Lang.getPhrase("translation")+"</h1>"+j+e.data.translated_text+"</div>",rspkr.st.r().replaceTokens(c.join(""),{rsLIGHTBOX_CLOSErs:rspkr.Lang.getPhrase("close"),rsLIGHTBOX_CLOSE_DIALOGrs:rspkr.Lang.getPhrase("closedialog")})+d.join("").replace("[[baseurl]]",rspkr.baseUrl+"r/r"+rspkr.meta.obj.revision+"/img").replace("[[translateurl]]",rspkr.Lang.getPhrase("translateurl")),!0,function(b,c){f.prepare(b,a,h,c),$rs.findIn(b,".rslightbox-trmessage")&&f.triggerTrMsg(b)},!1,g(),i)}else 4===this.readyState&&403===this.status&&rspkr.log("[Tools.Translation] Could not translate text.",3)}.bind(k);try{k.open("GET",l+"?"+m,!0),k.send()}catch(n){rspkr.log("[Tools.Translation] Error translating text: "+n.message,3)}}else rspkr.u.toolPanels.closeAll(),rspkr.u.Lightbox.show('<h1 class="rs_skip">'+rspkr.Lang.getPhrase("translation")+'</h1><div id="rslightbox_content_inner">'+rspkr.Lang.getPhrase("selectionrequiredtrans")+"</div>",rspkr.st.r().replaceTokens(c.join(""),{rsLIGHTBOX_CLOSErs:rspkr.Lang.getPhrase("close"),rsLIGHTBOX_CLOSE_DIALOGrs:rspkr.Lang.getPhrase("closedialog")}),!0,null,!1,g(),i)},triggerTrMsg:function(a){$rs.regEvent($rs.findIn(a,".rslightbox-trmessage-button"),"click",function(){rspkr.st.set("tr_agreed","1"),$rs.remove($rs.findIn(a,".rslightbox-trmessage"))})},prepare:function(a,b,c,d){var e=$rs.get("#rs_lightboxplayer");e&&("en"===b&&(b="en_us"),"nb_no"===b&&(b="no_nb"),$rs.setAttr(e,"data-rs-set-by",d),$rs.setAttr(e,"data-rs-lang",b),$rs.setAttr(e,"data-rs-voice",c),$rs.setAttr(e,"data-rs-cid",rspkr.cfg.item("general.transCID")),$rs.setAttr(e,"data-rs-stt","translation"),$rs.setAttr(e,"data-rs-stp",rspkr.c.data.getParam("customerid")))}},g=function(){return"[fontplus fontminus] [volume speed textsettings]"},h=function(c){if(b=$rs.findIn(c,".rsbtn_tool_translate")){var d=rspkr.cfg.item("general.transLangs"),e=[];if(d&&Object.size(d)){for(var g in d)d.hasOwnProperty(g)&&e.push({action:f.translate,params:[g,d[g]],value:g,key:g});rspkr.c.sorting.sortArrayByObjKey(e,"key"),a=new rspkr.u.ContextMenu({triggerElm:b,triggerEvent:"hover",items:e}),rspkr.Lang.updateUi(b)}}};return ReadSpeaker.Common.addEvent("onToolsInitialized",function(a,b){rspkr.features.translation_toolbar===!0&&h(a,b)}),{getMenu:function(){return a},translate:f.translate}}(),ReadSpeaker.ui.Tools.VoiceSettings=function(){var a=null,b=null,c=null,d=null,e=null,f=0,g={switchLang:function(a,c,d){if(d=d||!1,d||b.setValue(a+"-"+c)){var e,f,g,h=$rs.findIn(rspkr.u.Tools.lastButton(),".rsbtn_play");if(!h||$rs.isArray(h)&&!h.length)f=rspkr.cfg.item("general.userDefinedLang")||rspkr.c.data.params.lang,g=rspkr.cfg.item("general.userDefinedVoice")||rspkr.c.data.params.voice,rspkr.cfg.item("general.userDefinedLang",a),rspkr.cfg.item("general.userDefinedVoice",c);else{if(e=$rs.getAttr(h,"href"),!e)return void rspkr.log("[VoiceSettings.switchLang] Could not find href",3);f=rspkr.getParam("lang",e),g=rspkr.getParam("voice",e),e=rspkr.setParam("lang",a,e),e=rspkr.setParam("voice",c,e),$rs.setAttr(h,"href",e)}(a!==f||c!==g)&&(rspkr.devt("onToolClicked",window,[this]),rspkr.u.getActivePlayer()&&rspkr.u.getActivePlayer().close()),rspkr.cfg.item("general.saveLangVoice")===!0&&rspkr.st.set("langvoice",a+","+c);var i=rspkr.findHref();i&&(i=rspkr.setParam("lang",a,i),i=rspkr.setParam("voice",c,i),rspkr.cfg.item("general.popupHref",i)),rspkr.cfg.item("settings.langvoice",a+(c?","+c:""))}}},h=function(){var b=$rs.findIn(a,".rsbtn_play"),c=rspkr.extractParams(b.href||"");return c},i=function(a){return c[a]||""},j=function(j){var k,l,m,n,o,p=$rs.findIn(j,".rsbtn_tool_voice_settings"),q=[],r=rspkr.cfg.item("general.readingLangs");if(p&&!$rs.isArray(p)){a=j,c=h(),d=i("lang"),e=i("voice");for(k in r)if(r.hasOwnProperty(k)){for(n=r[k],$rs.isArray(n)||(n=[n]),o||e||k!==d||(o={lang:k,voice:n[0].voice}),l=0,m=n.length;m>l;l++)f++,q.push({text:rspkr.st.r().expandSentence(n[l].phrase),action:g.switchLang,params:[k,n[l].voice],active:k===d&&n[l].voice===e,value:k+"-"+n[l].voice});rspkr.c.sorting.sortArrayByObjKey(q,"text")}f>1?b=new rspkr.u.ContextMenu({triggerElm:p,triggerEvent:"hover",items:q}):1>=f&&($rs.addClass(p,"rsdisabled"),$rs.setAttr($rs.findIn(p,".rsbtn_tool"),"tabIndex",-1)),o&&g.switchLang(o.lang,o.voice)}};return ReadSpeaker.Common.addEvent("onToolsInitialized",function(a,b){j(a,b)}),{init:j,getMenu:function(){return b},switchLang:g.switchLang}}(),ReadSpeaker.q(function(){if(!rspkr.cfg.item("general.forceLoadCoreWait")&&!rspkr.cfg.item("general.noCookie")){var a="_rspkrLoadCore",b=1,c=c||rspkr.cfg.item("general.cookiePath"),d=d||rspkr.cfg.item("general.cookieDomain"),e=c?"; path="+c:"",f=d?"; domain="+d:"",g=a+"="+b+e+f;g+="https:"===document.location.protocol?"; SameSite=None; Secure":"; SameSite=Lax",document.cookie=g}}),ReadSpeaker.q(function(){function a(){var a=rspkr.c.data.params,c=b();return rspkr.log("[rspkr] Settings string extracted: "+c,"1"),a[z]=c,!0}function b(){var a=q(r,10),b="hlon"===rspkr.st.get("hltoggle"),c=rspkr.st.get("hl");if(b&&-1!==c.indexOf("sent")){for(var d=rspkr.st.get("hlsent"),e=rspkr.cfg.getSettingsConf().highlighting.items.hlsent.options,f=!1,h=0;h<e.length;h++)if(d===e[h].value){f=q(h,10);break}a+=f!==!1?f:q("F",16)}else a+=q("E",16);if(b&&-1!==c.indexOf("word")){for(var j=rspkr.st.get("hlword"),l=rspkr.cfg.getSettingsConf().highlighting.items.hlword.options,f=!1,h=0;h<l.length;h++)if(j===l[h].value){f=q(h,10);break}a+=f!==!1?f:q("F",16)}else a+=q("E",10);if(b&&"none"!==c){for(var n=rspkr.st.get("hltext"),p=rspkr.cfg.getSettingsConf().highlighting.items.hltext.options,f=!1,h=0;h<p.length;h++)if(n===p[h].value){f=q(h,10);break}a+=f!==!1?f:q("F",16)}else a+=q("E",16);var s="";s+=g()?"1":"0",s+=i()?"1":"0",s+=k()?"1":"0",s+=m()?"1":"0",a+=q(s,2);var t="";t+=rspkr.ui.Tools.ReadHover&&rspkr.ui.Tools.ReadHover.active()?"1":"0",t+=o()?"1":"0",t+="enlargeon"===rspkr.st.get("enlarge")?"1":"0",t+="scrollon"===rspkr.cfg.item("settings.hlscroll")?"1":"0",a+=q(t,2),t="",t+=rspkr.cfg.item("general.usePost")===!0?"1":"0",t+=rspkr.cfg.item("general.noCookie")===!0?"1":"0",t+=rspkr.DocReader&&rspkr.DocReader.AutoAdd?"1":"0",t+=rspkr.mobile()?"1":"0",a+=q(t,2),t="",t+="default"===rspkr.skin?"1":"0",t+="0";var u="00";switch(rspkr.pl.adapter){case"webAudio":u="01";break;case"html5":u="10"}return t+=u,a+=q(t,2)}function c(a){return"function"==typeof Storage&&rspkr.cfg.item("general.noCookie")!==!0?localStorage.setItem(y+a,1):rspkr.st.set(a,1)}function d(a){return"function"==typeof Storage&&rspkr.cfg.item("general.noCookie")!==!0?"1"===localStorage.getItem(y+a):"1"===rspkr.st.get(a)}function e(a){return"function"==typeof Storage?localStorage.removeItem(y+a):rspkr.st.set(a,0)}function f(){return c(t)}function g(){return d(t)}function h(){return c(u)}function i(){return d(u)}function j(){return c(v)}function k(){return d(v)}function l(){return c(w)}function m(){return d(w)}function n(){return c(x)}function o(){return d(x)}function p(){e(t),e(u),e(v),e(w),e(x)}function q(a,b){var b=b||2;return parseInt(a,b).toString(s).toUpperCase()}var r="1",s=16,t="f",u="r",v="v",w="p",x="t",y="rspkrSettings_",z="wrc";rspkr.cfg.item("general.sendSettings")!==!1&&(rspkr.evt("onAfterParamsSet",a),rspkr.evt("onAPIFastForward",f),rspkr.evt("onAPIRewind",h),rspkr.evt("onAPISetVolume",j),rspkr.evt("onMouseTrackerClosed",l),rspkr.evt("onTextModeLoaded",n),rspkr.evt("onBeforeGetAudioLink",p))}),ReadSpeaker.math=function(){var a={revision:"1476"},b=!1,c=_rules=_xslrule="math",d=".MathJax, .MathJax_Preview, math, [id^=MathJax]";return _init=function(){},_enabled=function(){return rspkr.cfg.item("general.enableMathReading")===!0},_found=function(){return _enabled()?b:!1},_setParams=function(){return rspkr.c.data.params?(rspkr.c.data.params.dict=c,rspkr.c.data.params.rules=_rules,rspkr.c.data.params.xslrule=_xslrule,!0):!1},_check=function(a){if(!_enabled())return!1;if(!$rs.isArray(a))return!1;for(var c=0;c<a.length;c++)if(_checkElement(a[c]))return b=!0,_setParams();b=!1},_checkElement=function(a){var b=rspkr.cfg.item("general.MathSelector")||d,c=$rs.findIn(a,b);return c=$rs.isArray(c)?c:[c],c.length>0?!0:!1},{meta:a,init:_init,enabled:_enabled,check:_check,found:_found,addParams:_setParams}}(),ReadSpeaker.PlayerAPI.html5=function(){var a={adapter:"html5",playerRef:null,timerCallBack:null,timerContext:null,bufferedTime:null,play:function(){ReadSpeaker.log("[rspkr.pl.play]"),rspkr.HL.chunking.close(),rspkr.HL.chunking.chunkEnded?(rspkr.HL.chunking.chunkEnded=!1,rspkr.devt("onChunkResume",window)):this.playerRef?(rspkr.pl.playPromise(this.playerRef),rspkr.devt("onAPIPlay",window)):this.initAdapter()},mobilePause:function(a){!rspkr.pl.playbackStarted&&a.pause()},playPromise:function(a,b,c,d){var e=a.play();void 0!==e?e.then(function(){d?rs.pl.mobilePause(a):rspkr.pl.playbackStarted=!0,!d&&(a.muted=!1);var c=rspkr.ui.getActivePlayer(),e=c?rspkr.mobile()?c.getMobileContainer():c.getContainer():void 0;c&&e&&($rs.hasClass(e,"rspaused")?(c.pause(),$rs.removeClass($rs.findIn(e,".rsbtn_progress_container"),"rsloading")):$rs.hasClass(e,"rsstopped")?c.stop():$rs.hasClass(e,"rsexpanded")||rspkr.mobile()&&$rs.hasClass($rs.get("#rsmpl_container"),"rs_visible")||c.close()),b&&"function"==typeof b&&(d?rs.pl.mobilePause(a):rspkr.pl.playbackStarted=!0,b.call())})["catch"](function(a){rspkr.log("PlayPromise error: "+a,3),c&&"function"==typeof c&&c.call(a)}):"function"==typeof b&&b.call()},pause:function(){this.playerRef&&(rspkr.pl.playerRef.pause(),rspkr.devt("onAPIPause",window))},stop:function(){rspkr.pl.playerRef&&(rspkr.pl.playerRef.pause(),rspkr.pl.playerRef.readyState>0&&(rspkr.pl.playerRef.currentTime=0),rspkr.devt("onAPIStop",window))},restart:function(){this.playerRef&&(this.playerRef.pause(),this.playerRef.currentTime=0,rspkr.hl.html5.handlers.restart(),rspkr.hl.html5.States.setState(rspkr.hl.html5.States.USER_START_PLAYING),this.playerRef.play(),rspkr.hl.html5.refresh())},volUp:function(){this.playerRef&&(this.playerRef.volume=Math.min(1,this.playerRef.volume+.2),rspkr.st.set("hlvol",100*this.playerRef.volume),rspkr.devt("onAPIVolumeUp",window))},volDown:function(){this.playerRef&&(this.playerRef.volume=Math.max(0,this.playerRef.volume-.2),rspkr.st.set("hlvol",100*this.playerRef.volume),rspkr.devt("onAPIVolumeDown",window))},mute:function(){this.playerRef&&(this.playerRef.volume=0,rspkr.devt("onAPIMute",window))},forward:function(){if(this.playerRef){var a=parseInt(rspkr.cfg.item("general.skipIntervalSec"))||5;this.playerRef.currentTime+a<this.playerRef.duration?this.playerRef.currentTime+=a:this.playerRef.currentTime=this.playerRef.duration,rspkr.devt("onAPIFastForward",window)}},rewind:function(){if(this.playerRef){var a=parseInt(rspkr.cfg.item("general.skipIntervalSec"))||5;this.playerRef.currentTime-a>0?this.playerRef.currentTime-=a:this.playerRef.currentTime=0,rspkr.devt("onAPIRewind",window)}},setVolume:function(a){rspkr.log("[setVolume] "+a,4),this.playerRef&&(this.playerRef.volume=parseFloat(a/200),rspkr.devt("onAPISetVolume",window))},setProgress:function(a){if(this.playerRef&&!isNaN(this.playerRef.duration)){var b=parseInt(a),c=parseInt(ReadSpeaker.PlayerAPI.getProduct().html5.handlers.totalTime());c>b&&b<this.playerRef.duration?this.playerRef.currentTime=b:this.playerRef.currentTime=this.playerRef.duration,rspkr.HL&&rspkr.HL.html5&&rspkr.HL.html5.lastcurrenttime&&(rspkr.HL.html5.lastcurrenttime=0),rspkr.devt("onAPISetProgress",window)}},getProgress:function(a,b,c){if(this.playerRef){if(0==a)return void rspkr.pl.playerRef.removeEventListener("timeupdate",rspkr.pl.timer,!1);this.timerCallBack=b,this.timerContext=c||b,rspkr.pl.playerRef.addEventListener("timeupdate",rspkr.pl.timer,!1),rspkr.devt("onAPIGetProgress",window)}},timer:function(){if(rspkr.pl.playerRef){var a=rspkr.pl.playerRef,b=1e3*parseInt(a.currentTime);rspkr.pl.bufferedTime=1e3*parseInt(ReadSpeaker.PlayerAPI.getProduct().html5.handlers.totalTime());var c=[b,rspkr.pl.bufferedTime];if(rspkr.hl.html5&&rspkr.hl.html5.synclist&&rspkr.hl.html5.synclist[rspkr.hl.html5.synclist.length-1]){var d=rspkr.hl.html5.synclist[rspkr.hl.html5.synclist.length-1][0];rspkr.pl.bufferedTime>d&&(c=[b,d])}if("function"==typeof rspkr.pl.timerCallBack)try{rspkr.pl.timerCallBack.apply(rspkr.pl.timerContext,[c])}catch(e){rspkr.log("timeupdate error",2)}}},checkNetworkStatus:function(){var a=rs.pl.playerRef;rs.pl.errorCount=rs.pl.errorCount||0,rs.pl.networkStates=rs.pl.networkStates||[0,0,0,0],setTimeout(function(){if(a){if(rs.pl.networkStates[a.networkState]++,rs.pl.networkStates[4]=a.buffered&&a.buffered.length&&a.buffered.end(0)>0?a.buffered.end(0):!1,rs.pl.networkStates[5]=a.duration&&a.duration&&!isNaN(a.duration)&&a.duration>0?a.duration:!1,3===a.networkState)rs.pl.errorCount++,rs.pl.errorCount>10&&!rs.pl.networkStates[4]&&!rs.pl.networkStates[5]?(rspkr.log("[rspkr.pl] Cannot load audio!",3),rspkr.ui.Overlay.show({player:rspkr.ui.getActivePlayer(),message:"loaderror"}),rspkr.devt("onAudioLoadError",window)):rspkr.pl.checkNetworkStatus();else if(2===a.networkState){rs.pl.errorCount=0;var b=a.buffered.length?a.buffered.end(a.buffered.length-1):0,c=a.duration||0;(0==c||c>b)&&rspkr.pl.checkNetworkStatus()}else rs.pl.errorCount=0;rspkr.log(rs.pl.networkStates,5)}},rspkr.cfg.item("general.audioTimeout")||750)},initAdapter:function(){rspkr.devt("onAPIInitAdapter",window)},releaseAdapter:function(){if(rspkr.pl.playerRef){rspkr.pl.playerRef.pause();try{rspkr.pl.playerRef.readyState>0&&(rspkr.pl.playerRef.currentTime=0)}catch(a){}window.rshlexit(!0),rspkr.pl.playerRef=null,rspkr.devt("onAPIReleaseAdapter",window)}},reloadAdapter:function(){this.releaseAdapter(),this.initAdapter(),rspkr.devt("onAPIReloadAdapter",window)},setEvents:function(){rspkr.evt("onAPIInitAdapter",rspkr.HL.html5.handlers.init),rspkr.evt("onAPIPlay",rspkr.HL.html5.handlers.play),rspkr.evt("onAPIPause",rspkr.HL.html5.handlers.pause),rspkr.evt("onAPIStop",rspkr.HL.html5.handlers.stop),rspkr.evt("onAPIRewind",rspkr.HL.html5.handlers.updateTime),rspkr.evt("onAPISetProgress",rspkr.HL.html5.handlers.updateTime),rspkr.evt("onAPIReleaseAdapter",rspkr.HL.html5.handlers.release)}};return{init:function(){ReadSpeaker.log("PlayerAPI.html5 heartbeat!")},adapter:a}}(),ReadSpeaker.PlayerAPI.webAudio=function(){var a={adapter:"webAudio",playerRef:null,releaseAdapter:function(){rspkr.audio&&"suspended"!==rspkr.audio.state&&(rspkr.pl.audio.stop(),!/ios/i.test(rspkr.c.data.browser.OS)&&(rspkr.audio=null),rspkr.devt("onAPIReleaseAdapter",window))},playPromise:function(a,b){b&&"function"==typeof b&&b.call()},play:function(b,c){rspkr.audio?(a.audio.gainNode||this.createGain(),rspkr.pl.audio.state.current===rspkr.pl.audio.states.paused?rspkr.pl.audio.resume():b===!0?rspkr.pl.audio.restart():("fullpage"===c&&(rspkr.hl.sync.fullCleanUp(),rspkr.hl.clientMarkup.postProcess.cleanUpSpans&&rspkr.hl.clientMarkup.postProcess.cleanUpSpans()),rspkr.hl.webAudio.clearHighlighted(),rspkr.devt("onAPIInitAdapter",window))):this.initAdapter(),rspkr.devt("onAPIPlay",window)},pause:function(){rspkr.audio&&"running"===rspkr.audio.state&&(rspkr.pl.audio.pause(),rspkr.devt("onAPIPause",window))},stop:function(){rspkr.audio&&"running"===rspkr.audio.state&&(rspkr.pl.audio.stop(),rspkr.devt("onAPIStop",window))},restart:function(){rspkr.audio&&"running"===rspkr.audio.state&&rspkr.pl.audio.restart()},forward:function(){this.audio.jump.forward(),rspkr.devt("onAPIFastForward",window)},rewind:function(){this.audio.jump.back(),rspkr.devt("onAPIRewind",window)},setVolume:function(b){return rspkr.log("[setVolume] "+b,4),this.audio.volume=parseFloat(b/100),rspkr.devt("onAPISetVolume",window),a.audio&&a.audio.gainNode&&rspkr.audio?(a.audio.gainNode.gain.setValueAtTime(a.audio.volume,rspkr.audio.currentTime),!0):!1},initAdapter:function(){a.audio.volume=rspkr.st.get("hlvol")?rspkr.st.get("hlvol")/100:1,this.createAudioContext(),rspkr.devt("onAPIInitAdapter",window)},getProgress:function(a,b,c){if(rspkr.audio){if(a===!1&&b&&"function"==typeof b)return void rspkr.c.clearEvent("onWebAudioProgress",b);this.timerCallBack=b,this.timerContext=c||b,b&&"function"==typeof b&&(rspkr.c.clearEvent("onWebAudioProgress",b),rspkr.evt("onWebAudioProgress",b)),rspkr.devt("onAPIGetProgress",window)}},setProgress:function(b){if(rspkr.audio&&(!a.audio||a.audio.state.current!==a.audio.states.stopped&&a.audio.state.current!==a.audio.states.notStarted)){var c=1e3*rspkr.audio.currentTime,d=Math.min(1e3*parseInt(b),a.audio.time.bufferedMs);a.audio.pause(),a.audio.time.offset-=d-c,a.audio.resume(!0),rspkr.devt("onAPISetProgress",window)}},setEvents:function(){var b=rspkr.HL.webAudio.handlers;rspkr.evt("onAPIInitAdapter",b.init),rspkr.evt("onAPIPause",a.audio.pause),rspkr.evt("onAPIStop",a.audio.stop)},createAudioContext:function(){return rspkr.audio&&rspkr.audio.createBufferSource||(rspkr.audio=new(window.AudioContext||window.webkitAudioContext)),this.createGain(),rspkr.audio},createGain:function(){a.audio.gainNode=rspkr.audio.createGain(),a.audio.gainNode.connect(rspkr.audio.destination),a.audio.gainNode.gain.setValueAtTime(a.audio.volume,0)},loader:{audioArray:[],bodyPrevSize0:4,bufferCounter:0,currentAudioIndex:0,flushNext:!1,headerLength:9,lastSyncTime:0,
lastFlushTimestamp:0,lastTimestamp:0,postData:null,tagDelimiter:4,tagHeaderLength:11,tagTypes:{type_8:"audio",type_9:"video",type_18:"data",audio:8,video:9,data:18},timeOffset:0,type:"xhr",types:{xhr:{prevToken:"",stopped:[],init:function(b){a.loader.types.xhr.prevToken=b},start:function(b,c,d){if("string"==typeof b&&-1===a.loader.types.xhr.stopped.indexOf(d)){var e=rspkr.cfg.item("general.chunkLimit")||1e3;/chunk_limit=/i.test(b)||(b+=(/\?/i.test(b)?"&":"?")+"chunk_limit="+e);var f,g=new XMLHttpRequest,h=c&&"object"==typeof c?"POST":"GET";g.onload=function(){a.loader.types.xhr.loaded(g.response,d)},"POST"===h&&(/chunk_limit=/i.test(c.data)||(c.data+="&chunk_limit="+e),b=c.rsCall,f=c.data),g.responseType="arraybuffer",g.open(h,b),"POST"===h&&g.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),g.send(f)}},stop:function(){return a.loader.types.xhr.stopped.push(a.loader.types.xhr.prevToken),new Promise(function(a,b){a("User stopped XHR.")})},loaded:function(b,c){if(b&&-1===a.loader.types.xhr.stopped.indexOf(c)){var d=new Uint8Array(b);if(a.decode.headerOk(d.subarray(0,a.loader.headerLength)))for(var e,f=a.loader.headerLength+a.loader.bodyPrevSize0,g=0,h=d.length;h>g&&(e&&(f+=e.size+a.loader.tagDelimiter),f<d.length);g++)e=a.decode.getTag(d,f),a.loader.parseTag(e,c);else rspkr.ui.Overlay.show({player:rspkr.ui.getActivePlayer(),message:"loaderror"}),rspkr.devt("onAudioLoadError",window)}}},fetch:{index:0,buffer:[],headerOk:!1,offset:0,reader:null,start:function(b,c,d){var e={};a.loader.types.fetch.index=0,a.loader.types.fetch.buffer=null,a.loader.types.fetch.offset=0,a.audio.time.bufferedMs=0,c&&(b=c.rsCall,e={method:"POST",body:c.data}),fetch(b,e).then(function(a){return a.body}).then(function(e){e?(a.loader.types.fetch.reader=e.getReader(),a.loader.types.fetch.read(a.loader.types.fetch.reader)):(rspkr.log("Could not fetch stream. Falling back to xhr",2),rspkr.br.info.fetchSupport=!1,a.loader.start(a.loader.types.xhr,b,c,d))})["catch"](function(a){rspkr.log(a,"3")})},stop:function(){return a.loader.types.fetch.reader?a.loader.types.fetch.reader.cancel("Fetch stopped by user!"):void 0},read:function(b){var c,d=a.loader.types.fetch;return b.read().then(function(e){var f=e.value,g=e.done;f&&(c=d.buffer||new Uint8Array,d.buffer=new Uint8Array(c.length+f.length),d.buffer.set(c),d.buffer.set(f,c.length),0===d.index&&d.buffer.length>a.loader.headerLength&&(d.headerOk=a.decode.headerOk(d.buffer.subarray(0,a.loader.headerLength)),d.headerOk?d.index=a.loader.headerLength+a.loader.bodyPrevSize0:(rspkr.ui.Overlay.show({player:rspkr.ui.getActivePlayer(),message:"loaderror"}),rspkr.devt("onAudioLoadError",window))),d.headerOk&&d.extractTags()),g||d.read(b)})},extractTags:function(){for(var b,c,d=a.loader.types.fetch;d.buffer&&d.buffer.length&&d.index<d.buffer.length&&d.buffer.length>d.index+a.loader.tagHeaderLength&&(b=a.decode.getTagLength(d.buffer.subarray(d.index+1,d.index+4)),d.buffer.length>d.index+a.loader.tagHeaderLength+b);)c=a.decode.getTag(d.buffer,d.index),d.index+=a.loader.tagHeaderLength+b+a.loader.tagDelimiter,a.loader.parseTag(c)}}},load:function(b,c){a.loader.type=rspkr.br.info.fetchSupport?"fetch":"xhr";var d=rspkr.getID(),e=a.loader.types[a.loader.type];a.audio.state.current!==a.audio.states.notStarted?e.stop.apply(e,[]).then(function(f){a.loader.reinit(),a.loader.start(e,b,c,d)},function(a){rspkr.log(a.message,3)}):a.loader.start(e,b,c,d)},start:function(a,b,c,d){rspkr.audio.resume().then(function(){rspkr.audio.suspend().then(function(){"function"==typeof a.init&&a.init(d),a.start.apply(a,[b,c,d])})})},reinit:function(){a.audio.unschedule(),a.audio.buffers=[],a.loader.flushNext=!1,a.loader.timeOffset=0,a.loader.lastFlushTimestamp=0,a.loader.currentAudioIndex=0,a.audio.time.offset=null,a.loader.audioArray=[],rspkr.hl.webAudio.sync.reinit()},parseTag:function(b,c){if(b.type===a.loader.tagTypes.data){if(b.timestamp+a.loader.timeOffset===0)rspkr.hl.webAudio.sync.item(b.data);else if(rspkr.hl.webAudio.sync.q.length&&a.loader.audioArray.length>500&&null!==b.data&&b.data[0]&&"rshlsync"===b.data[0]&&b.data.length>2&&"s"===b.data[3].toLowerCase()&&(a.loader.flushNext=!0),null!==b.data&&b.data[0]&&/rshlexit|rshlcontinue/i.test(b.data[0])&&(a.loader.flushNext=!0,"rshlcontinue"===b.data[0])){var d=b.data[2].replace("%{AUDIOFORMAT}","flv");a.loader.types[a.loader.type].start.apply(a.loader.types[a.loader.type],[d,null,c]),a.loader.timeOffset+=b.timestamp}null!==b.data&&b.data[0]&&"rshlsync"===b.data[0]&&(a.loader.lastSyncTime=b.timestamp+a.loader.timeOffset,rspkr.hl.webAudio.sync.q.push({time:a.loader.lastSyncTime,data:b.data}))}if(b.type===a.loader.tagTypes.audio||b.type===a.loader.tagTypes.data&&null!==b.data&&b.data[0]&&"rshlexit"===b.data[0]){if(a.loader.flushNext&&a.loader.audioArray.length){if("function"==typeof Uint8Array.from)a.loader.audioArray=Uint8Array.from(a.loader.audioArray);else{for(var e=new ArrayBuffer(a.loader.audioArray.length),f=new Uint8Array(e),g=0,h=a.loader.audioArray.length;h>g;g++)f[g]=a.loader.audioArray[g];a.loader.audioArray=f}!function(b,c,d,e){rspkr.audio&&rspkr.audio.decodeAudioData(c.buffer,function(c){a.audio.buffer(b,c,d,e),a.audio.started||(a.audio.started=!0,a.audio.activate(function(b){a.event.start(),a.audio.play(0,0)},[]))},function(a){rspkr.log("Decode error: "+a,"3")})}(a.loader.currentAudioIndex++,a.loader.audioArray,a.loader.lastFlushTimestamp,null!==b.data&&b.data[0]&&"rshlexit"===b.data[0]),a.loader.audioArray=[],a.loader.flushNext=!1,a.loader.lastFlushTimestamp=b.timestamp+a.loader.timeOffset}else a.loader.flushNext=!1;if(b.type===a.loader.tagTypes.audio){a.loader.audioArray||(a.loader.audioArray=[]);var i;i="function"==typeof Array.from?Array.from(b.data):[].slice.call(b.data);for(var j=0;j<i.length;j++)a.loader.audioArray.push(i[j]);a.loader.lastTimestamp=b.timestamp}}}},event:{started:!1,stopped:!1,eventTimer:null,start:function(){a.event.started||(a.event.started=!0,a.event.stopped=!1,a.event.eventTimer=window.setTimeout(a.event.fire,0))},restart:function(){a.event.started=!1,a.event.stopped=!1,a.event.start()},stop:function(){window.clearTimeout(a.event.eventTimer),a.event.started=!1,a.event.stopped=!0},fire:function(){var b={current:a.audio.time.getCurrent(),buffered:a.audio.time.getBuffered()};rspkr.devt("onWebAudioSync",window,[b.current]),rspkr.devt("onWebAudioProgress",window,[[b.current,b.buffered]]),a.event.stopped===!1&&(a.event.eventTimer=window.setTimeout(a.event.fire,50))}},audio:{buffers:[],bufferQueue:[],bufferedTime:0,gainNode:null,volume:1,lastIndex:-1,playTimer:null,scheduledBuffers:[],started:!1,time:{bufferedMs:0,created:null,started:null,offset:null,played:0,paused:null,getCurrent:function(){switch(a.audio.state.current){case a.audio.states.paused:return a.audio.time.paused-a.audio.time.offset;case a.audio.states.playing:return 1e3*rspkr.audio.currentTime-a.audio.time.offset;default:return 0}},getBuffered:function(){return a.audio.time.bufferedMs}},states:{notStarted:0,playing:1,paused:2,stopped:3},state:{current:0,set:function(b){a.audio.state.current=b}},initVariables:function(){a.audio.bufferedTime=0,a.audio.bufferQueue=[],a.audio.lastIndex=-1,a.audio.started=!1},activate:function(a,b){rspkr.audio&&"suspended"===rspkr.audio.state&&rspkr.audio.resume().then(function(){"function"==typeof a&&a.apply(a,b)})},buffer:function(b,c,d,e){a.audio.buffers[b]={timestamp:d,buffer:c,isLast:e},a.audio.time.bufferedMs+=1e3*c.duration},schedule:function(b,c){var d,e=a.audio.buffers[b].buffer;if(b>a.audio.lastIndex+1){if(a.audio.bufferQueue[b]=e,!a.audio.bufferQueue[a.audio.lastIndex+1])return;b=a.audio.lastIndex+1,e=a.audio.bufferQueue[b]}if(!e)throw new Error("Could not schedule buffer. It was not found.");d=rspkr.audio.createBufferSource(),d.buffer=e,d.connect(a.audio.gainNode),0===a.audio.bufferedTime&&(a.audio.bufferedTime=rspkr.audio.currentTime+.01),d.start(Math.max(a.audio.bufferedTime,0),c),a.audio.bufferedTime+=d.buffer.duration-c,a.audio.scheduledBuffers.push(d),a.audio.buffers[b].isLast===!0&&d.addEventListener("ended",a.audio.end,!1),null===a.audio.time.offset&&(a.audio.time.offset=1e3*rspkr.audio.currentTime),a.audio.lastIndex=b},unschedule:function(){if(rspkr.audio){if(a.audio.scheduledBuffers.length)for(var b=0,c=a.audio.scheduledBuffers.length;c>b;b++)a.audio.scheduledBuffers[b].removeEventListener("ended",a.audio.end),a.audio.scheduledBuffers[b].disconnect(),a.audio.scheduledBuffers[b].stop(0),a.audio.scheduledBuffers[b]=null;a.audio.scheduledBuffers=[],window.clearTimeout(a.audio.playTimer),a.event.stop(),a.audio.initVariables()}else rspkr.log("Could not unschedule buffers. No audio context or audio context not running.",3)},restart:function(){a.audio.unschedule(),a.audio.time.offset=null,rspkr.hl.webAudio.sync.restart(),a.audio.play(0,0),a.event.restart()},play:function(b,c){if(a.audio.buffers[b]){a.audio.state.set(a.audio.states.playing),a.audio.schedule(b,c);var d=function(){a.audio.play(b+1,0)};a.audio.playTimer=window.setTimeout(d,0)}else a.audio.playTimer=window.setTimeout(function(){a.audio.play(b,c)},0);var e;!rspkr.mobile()&&rspkr.ui.getActivePlayer()?e=rspkr.ui.getActivePlayer().getContainer():rspkr.mobile()&&(e=document.getElementById("rsmpl_container")),e&&$rs.hasClass(e,"rspaused")&&a.audio.pause(),e&&$rs.hasClass(e,"rsstopped")&&a.audio.stop(),!rspkr.mobile()&&e&&!$rs.hasClass(e,"rsexpanded")&&a.audio.stop(),rspkr.mobile()&&e&&!$rs.isVisible(e)&&a.audio.stop(),rspkr.Common.Player.setStateClass(rspkr.ui.getActivePlayer().getContainer(),"rsplaying"),rspkr.mobile()&&e&&a.event.restart()},pause:function(){a.audio.unschedule(),a.audio.time.paused=1e3*rspkr.audio.currentTime,a.audio.state.set(a.audio.states.paused)},resume:function(b){if(a.audio.state.current!==a.audio.states.paused||!a.audio.buffers.length)throw new Error("No audio buffers to read from.");for(var c,d=null,e=null,f=0,g=0,h=a.audio.buffers.length;h>g&&!(a.audio.buffers[g].timestamp>a.audio.time.getCurrent());g++)d=a.audio.buffers[g];if(d){f=.001*(a.audio.time.getCurrent()-d.timestamp),c=d.timestamp+1e3*f;for(var i=0,j=rspkr.hl.webAudio.sync.q.length;j>i&&!(rspkr.hl.webAudio.sync.q[i]&&rspkr.hl.webAudio.sync.q[i].data&&"rshlsync"===rspkr.hl.webAudio.sync.q[i].data[0]&&rspkr.hl.webAudio.sync.q[i].time>c);i++)e=rspkr.hl.webAudio.sync.q[i];if(e&&(rspkr.hl.webAudio.sync.index=i-1,b===!0&&"s"!==e.data[3]))for(var k,l=rspkr.hl.webAudio.sync.index-1;l>=0;){if(k=rspkr.hl.webAudio.sync.q[l],k&&k.data&&"rshlsync"===k.data[0]&&"s"===k.data[3]){rspkr.hl.webAudio.sync.item(k.data);break}l--}a.audio.time.offset+=1e3*rspkr.audio.currentTime-a.audio.time.paused,a.audio.lastIndex=g>0?g-2:-1,a.event.restart(),a.audio.play(g-1,f)}},jump:{stepSizeSec:5,getStepMs:function(){return 1e3*(parseInt(rspkr.cfg.item("general.skipIntervalSec"))||a.audio.jump.stepSizeSec)},checkAudioState:function(){return!a.audio||a.audio.state.current!==a.audio.states.stopped&&a.audio.state.current!==a.audio.states.notStarted?!0:!1},back:function(){a.audio.jump.checkAudioState()&&(a.audio.time.getCurrent()-a.audio.jump.getStepMs()<0?a.audio.restart():(a.audio.pause(),a.audio.time.offset+=a.audio.jump.getStepMs(),a.audio.resume(!0)))},forward:function(){if(a.audio.jump.checkAudioState()){if(a.audio.time.getCurrent()+a.audio.jump.getStepMs()>a.audio.time.bufferedMs)return;a.audio.pause(),a.audio.time.offset-=a.audio.jump.getStepMs(),a.audio.resume(!0)}}},stop:function(b){a.audio.state.current!==a.audio.states.stopped&&a.audio.state.current!==a.audio.states.notStarted&&(a.event.stop(),a.audio.state.set(a.audio.states.stopped),a.audio.unschedule(),rspkr.hl.sync.lightCleanUp(),window.rshlexit(b||"true"))},end:function(){a.audio.stop("false")}},decode:{headerOk:function(a){var b="70,76,86,1,4,0,0,0,9";return a.join(",")===b},getTagLength:function(b){return a.utils.conv.arrToDec(b)},getTag:function(b,c){var d={type:[0,1],dataSize:[1,4],timestamp:[4,7],streamID:[9,11]},e=11,f={};for(var g in d)d.hasOwnProperty(g)&&(f[g]=a.utils.conv.arrToDec(b.subarray(c+d[g][0],c+d[g][1])));return f.data=a.decode.tags[a.loader.tagTypes["type_"+f.type]](b.subarray(c+e,c+e+(f.dataSize+1))),f.size=e+f.dataSize,f},isCuePoint:function(a){var b="2,0,10,111,110,67,117,101,80,111,105,110,116,10";return a.join(",")===b},uintToString:function(a){try{return decodeURIComponent(escape(String.fromCharCode.apply(null,a)))}catch(b){return String.fromCharCode.apply(null,a)}},tags:{data:function(b){var c,d=0,e=[],f=0,g=0;if(a.decode.isCuePoint(b.subarray(0,14))){for(f=0,c=b.subarray(18);d<c.length;)2===c[d]?(g=a.utils.conv.arrToDec(c.subarray(d+1,d+3)),e.push(a.decode.uintToString(c.subarray(d+3,d+3+g))),d=d+3+g):0===c[d]?(e.push(a.utils.conv.arrToDec(c.subarray(d+1,d+4))),d+=4):d++;return e}return null},audio:function(a){return a=a.subarray(0,a.length-1),a.subarray(1)}}},utils:{conv:{arrToDec:function(a){for(var b="",c=0,d=a.length;d>c;c++)b+=(1===a[c].toString(16).length?"0":"")+a[c].toString(16);return parseInt(b,16)}}},polyfills:{init:function(){a.polyfills.Uint8Array.join()},Uint8Array:{join:function(){Uint8Array.prototype.join||Object.defineProperty(Uint8Array.prototype,"join",{value:Array.prototype.join})}}}},b=!1,c=[];return{init:function(){rspkr.c.e.onWebAudioProgress||(rspkr.c.e.onWebAudioProgress=[]),rspkr.c.e.onWebAudioSync||(rspkr.c.e.onWebAudioSync=[]),a.polyfills.init(),rspkr.log("[PlayerAPI.webAudio heartbeat!]",4),rspkr.hl.sync.setId=function(a){b=!0},rspkr.hl.sync.setContent=function(a){b&&c.length&&(rspkr.hl.markedUpHTML.push(c.join("")),c=[]),c.push(a),b=!1},rspkr.evt("onBeforeSyncInit",function(){rspkr.hl.markedUpHTML.push(c.join("")),c=[]})},adapter:a}}();